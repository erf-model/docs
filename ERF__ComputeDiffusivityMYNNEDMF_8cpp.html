<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ERF: Source/PBL/ERF_ComputeDiffusivityMYNNEDMF.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ERF
   </div>
   <div id="projectbrief">Energy Research and Forecasting: An Atmospheric Modeling Code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('ERF__ComputeDiffusivityMYNNEDMF_8cpp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ERF_ComputeDiffusivityMYNNEDMF.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;algorithm&gt;</code><br />
<code>#include &lt;iostream&gt;</code><br />
<code>#include &lt;vector&gt;</code><br />
<code>#include &lt;cmath&gt;</code><br />
<code>#include &lt;functional&gt;</code><br />
<code>#include &lt;limits&gt;</code><br />
<code>#include &quot;<a class="el" href="ERF__SurfaceLayer_8H_source.html">ERF_SurfaceLayer.H</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ERF__DirectionSelector_8H_source.html">ERF_DirectionSelector.H</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ERF__Diffusion_8H_source.html">ERF_Diffusion.H</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ERF__Constants_8H_source.html">ERF_Constants.H</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ERF__TurbStruct_8H_source.html">ERF_TurbStruct.H</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ERF__PBLModels_8H_source.html">ERF_PBLModels.H</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for ERF_ComputeDiffusivityMYNNEDMF.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="ERF__ComputeDiffusivityMYNNEDMF_8cpp__incl.png" border="0" usemap="#aSource_2PBL_2ERF__ComputeDiffusivityMYNNEDMF_8cpp" alt=""/></div>
<map name="aSource_2PBL_2ERF__ComputeDiffusivityMYNNEDMF_8cpp" id="aSource_2PBL_2ERF__ComputeDiffusivityMYNNEDMF_8cpp">
<area shape="rect" title=" " alt="" coords="1800,5,2056,47"/>
<area shape="rect" title=" " alt="" coords="5,95,91,121"/>
<area shape="rect" title=" " alt="" coords="520,468,600,495"/>
<area shape="rect" title=" " alt="" coords="3054,468,3117,495"/>
<area shape="rect" title=" " alt="" coords="3217,468,3279,495"/>
<area shape="rect" title=" " alt="" coords="3414,95,3501,121"/>
<area shape="rect" title=" " alt="" coords="3525,95,3584,121"/>
<area shape="rect" href="ERF__SurfaceLayer_8H.html" title=" " alt="" coords="1712,169,1864,196"/>
<area shape="rect" href="ERF__Constants_8H.html" title=" " alt="" coords="2511,468,2644,495"/>
<area shape="rect" href="ERF__TurbStruct_8H.html" title=" " alt="" coords="21,393,155,420"/>
<area shape="rect" href="ERF__DirectionSelector_8H.html" title=" " alt="" coords="165,95,344,121"/>
<area shape="rect" href="ERF__Diffusion_8H.html" title=" " alt="" coords="1994,95,2121,121"/>
<area shape="rect" href="ERF__PBLModels_8H.html" title=" " alt="" coords="859,169,997,196"/>
<area shape="rect" title=" " alt="" coords="1190,468,1343,495"/>
<area shape="rect" title=" " alt="" coords="903,468,1062,495"/>
<area shape="rect" title=" " alt="" coords="331,319,487,345"/>
<area shape="rect" title=" " alt="" coords="1763,393,1909,420"/>
<area shape="rect" title=" " alt="" coords="1659,319,1808,345"/>
<area shape="rect" title=" " alt="" coords="1521,244,1706,271"/>
<area shape="rect" href="ERF__IndexDefines_8H.html" title=" " alt="" coords="1857,468,2010,495"/>
<area shape="rect" href="ERF__MOSTAverage_8H.html" title=" " alt="" coords="1338,244,1497,271"/>
<area shape="rect" href="ERF__TerrainMetrics_8H.html" title=" " alt="" coords="1373,319,1533,345"/>
<area shape="rect" href="ERF__MOSTStress_8H.html" title=" " alt="" coords="2237,319,2384,345"/>
<area shape="rect" href="ERF__PBLHeight_8H.html" title=" " alt="" coords="1985,244,2119,271"/>
<area shape="rect" href="ERF__MicrophysicsUtils_8H.html" title=" " alt="" coords="2773,393,2955,420"/>
<area shape="rect" title=" " alt="" coords="2516,543,2639,569"/>
<area shape="rect" title=" " alt="" coords="1869,543,1997,569"/>
<area shape="rect" title=" " alt="" coords="333,468,449,495"/>
<area shape="rect" href="ERF__DataStruct_8H.html" title=" " alt="" coords="863,319,1001,345"/>
<area shape="rect" title=" " alt="" coords="1681,543,1764,569"/>
<area shape="rect" title=" " alt="" coords="624,468,683,495"/>
<area shape="rect" title=" " alt="" coords="707,468,827,495"/>
<area shape="rect" href="ERF__AdvStruct_8H.html" title=" " alt="" coords="867,393,997,420"/>
<area shape="rect" href="ERF__DiffStruct_8H.html" title=" " alt="" coords="662,393,791,420"/>
<area shape="rect" href="ERF__SpongeStruct_8H.html" title=" " alt="" coords="483,393,637,420"/>
<area shape="rect" href="ERF__TurbPertStruct_8H.html" title=" " alt="" coords="1174,393,1333,420"/>
<area shape="rect" href="ERF__MYNNStruct_8H.html" title=" " alt="" coords="15,468,161,495"/>
<area shape="rect" title=" " alt="" coords="1368,468,1536,495"/>
<area shape="rect" href="ERF__TileNoZ_8H.html" title=" " alt="" coords="1663,468,1782,495"/>
<area shape="rect" href="ERF__MOSTRoughness_8H.html" title=" " alt="" coords="2289,393,2466,420"/>
<area shape="rect" href="ERF__Wstar_8H.html" title=" " alt="" coords="2490,393,2595,420"/>
<area shape="rect" href="ERF__MoistUtils_8H.html" title=" " alt="" coords="2409,319,2543,345"/>
<area shape="rect" title=" " alt="" coords="2704,468,2827,495"/>
<area shape="rect" title=" " alt="" coords="229,169,344,196"/>
<area shape="rect" title=" " alt="" coords="2347,169,2479,196"/>
<area shape="rect" href="ERF__EB_8H.html" title=" " alt="" coords="2655,169,2740,196"/>
<area shape="rect" title=" " alt="" coords="2893,244,3115,271"/>
<area shape="rect" title=" " alt="" coords="3139,244,3287,271"/>
<area shape="rect" title=" " alt="" coords="2555,244,2669,271"/>
<area shape="rect" title=" " alt="" coords="2694,244,2869,271"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0853d826a8a330e6967e3da5e973eed2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ERF__ComputeDiffusivityMYNNEDMF_8cpp.html#a0853d826a8a330e6967e3da5e973eed2">ComputeDiffusivityMYNNEDMF</a> (const MultiFab &amp;xvel, const MultiFab &amp;yvel, const MultiFab &amp;cons_in, MultiFab &amp;eddyViscosity, const Geometry &amp;geom, const <a class="el" href="structTurbChoice.html">TurbChoice</a> &amp;<a class="el" href="ERF__DiffSetup_8H.html#a4a8c0178282c029acc3d37ed429f9f58">turbChoice</a>, std::unique_ptr&lt; <a class="el" href="classSurfaceLayer.html">SurfaceLayer</a> &gt; &amp;SurfLayer, bool use_terrain_fitted_coords, bool use_moisture, int level, const BCRec *bc_ptr, bool, const std::unique_ptr&lt; MultiFab &gt; &amp;z_phys_nd, const <a class="el" href="structMoistureComponentIndices.html">MoistureComponentIndices</a> &amp;moisture_indices)</td></tr>
<tr class="separator:a0853d826a8a330e6967e3da5e973eed2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a0853d826a8a330e6967e3da5e973eed2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0853d826a8a330e6967e3da5e973eed2">&#9670;&nbsp;</a></span>ComputeDiffusivityMYNNEDMF()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ComputeDiffusivityMYNNEDMF </td>
          <td>(</td>
          <td class="paramtype">const MultiFab &amp;&#160;</td>
          <td class="paramname"><em>xvel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const MultiFab &amp;&#160;</td>
          <td class="paramname"><em>yvel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const MultiFab &amp;&#160;</td>
          <td class="paramname"><em>cons_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MultiFab &amp;&#160;</td>
          <td class="paramname"><em>eddyViscosity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Geometry &amp;&#160;</td>
          <td class="paramname"><em>geom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structTurbChoice.html">TurbChoice</a> &amp;&#160;</td>
          <td class="paramname"><em>turbChoice</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; <a class="el" href="classSurfaceLayer.html">SurfaceLayer</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>SurfLayer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>use_terrain_fitted_coords</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>use_moisture</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>level</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const BCRec *&#160;</td>
          <td class="paramname"><em>bc_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::unique_ptr&lt; MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>z_phys_nd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structMoistureComponentIndices.html">MoistureComponentIndices</a> &amp;&#160;</td>
          <td class="paramname"><em>moisture_indices</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;{</div>
<div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160;    Print()&lt;&lt;<span class="stringliteral">&quot;reached mynnedmf&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;    {</div>
<div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;      <span class="keywordtype">int</span> n=1;</div>
<div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;      <a class="code" href="ERF__ShocInterface_8H.html#ab8a9d2a7cbf2084043f890c3d0a68f57">Real</a> a=1;</div>
<div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;      <a class="code" href="ERF__ShocInterface_8H.html#ab8a9d2a7cbf2084043f890c3d0a68f57">Real</a> b=1;</div>
<div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160;      <a class="code" href="ERF__ShocInterface_8H.html#ab8a9d2a7cbf2084043f890c3d0a68f57">Real</a> c=1;</div>
<div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;      <a class="code" href="ERF__ShocInterface_8H.html#ab8a9d2a7cbf2084043f890c3d0a68f57">Real</a> d=1;</div>
<div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;      <a class="code" href="ERF__ShocInterface_8H.html#ab8a9d2a7cbf2084043f890c3d0a68f57">Real</a> <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01a9dd4e461268c8034f5c8564e155c67a6">x</a>=0;</div>
<div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160;<span class="preprocessor">#if 0</span></div>
<div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;      tridiag2_cc(n,&amp;a,&amp;b,&amp;c,&amp;d,&amp;x);</div>
<div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;      printf(<span class="stringliteral">&quot;ran tridiag2_cc with n=%d and got %g %g %g %g %g&quot;</span>,n,a,b,c,d,x);</div>
<div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160;    }</div>
<div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160; </div>
<div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160;    <span class="keyword">auto</span> mynn     = <a class="code" href="ERF__DiffSetup_8H.html#a4a8c0178282c029acc3d37ed429f9f58">turbChoice</a>.<a class="code" href="structTurbChoice.html#a11fd9429567c4dd4afa871170580aed0">pbl_mynn</a>;</div>
<div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;    <span class="keyword">auto</span> level2   = <a class="code" href="ERF__DiffSetup_8H.html#a4a8c0178282c029acc3d37ed429f9f58">turbChoice</a>.<a class="code" href="structTurbChoice.html#a475d862a63ab672577fc2429f535feb9">pbl_mynn_level2</a>;</div>
<div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160; </div>
<div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;    <a class="code" href="ERF__ShocInterface_8H.html#ab8a9d2a7cbf2084043f890c3d0a68f57">Real</a> Lt_alpha = (mynn.config == <a class="code" href="ERF__MYNNStruct_8H.html#a103de8b695a78549c43fa852d9c4dd25abe8de8e777a612742c642b372ab3dc9e">MYNNConfigType::CHEN2021</a>) ? 0.1 : 0.23;</div>
<div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160; </div>
<div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;    <span class="comment">// Dirichlet flags to switch derivative stencil</span></div>
<div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160;    <span class="keywordtype">bool</span> c_ext_dir_on_zlo = ( (bc_ptr[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>].lo(2) == <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af">ERFBCType::ext_dir</a>) );</div>
<div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;    <span class="keywordtype">bool</span> c_ext_dir_on_zhi = ( (bc_ptr[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>].lo(5) == <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af">ERFBCType::ext_dir</a>) );</div>
<div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160;    <span class="keywordtype">bool</span> u_ext_dir_on_zlo = ( (bc_ptr[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>].lo(2) == <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af">ERFBCType::ext_dir</a>) );</div>
<div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160;    <span class="keywordtype">bool</span> u_ext_dir_on_zhi = ( (bc_ptr[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>].lo(5) == <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af">ERFBCType::ext_dir</a>) );</div>
<div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;    <span class="keywordtype">bool</span> v_ext_dir_on_zlo = ( (bc_ptr[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a>].lo(2) == <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af">ERFBCType::ext_dir</a>) );</div>
<div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160;    <span class="keywordtype">bool</span> v_ext_dir_on_zhi = ( (bc_ptr[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a>].lo(5) == <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af">ERFBCType::ext_dir</a>) );</div>
<div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160; </div>
<div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;    <span class="comment">// Epsilon</span></div>
<div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;    <a class="code" href="ERF__ShocInterface_8H.html#ab8a9d2a7cbf2084043f890c3d0a68f57">Real</a> eps = <a class="code" href="namespacemodule__model__constants.html#a8aff14ee510fe368c6991bc969cb5721">std::numeric_limits&lt;Real&gt;::epsilon</a>();</div>
<div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160; </div>
<div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;<span class="preprocessor">#pragma omp parallel if (Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;    <span class="keywordflow">for</span> ( MFIter mfi(eddyViscosity,TilingIfNotGPU()); mfi.isValid(); ++mfi) {</div>
<div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160; </div>
<div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;        <span class="keyword">const</span> Box &amp;bx = mfi.growntilebox(1);</div>
<div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;        <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; cell_data = cons_in.array(mfi);</div>
<div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;        <span class="keyword">const</span> Array4&lt;Real      &gt;&amp; K_turb    = eddyViscosity.array(mfi);</div>
<div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;        <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; uvel      = <a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">xvel</a>.array(mfi);</div>
<div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;        <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; vvel      = <a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">yvel</a>.array(mfi);</div>
<div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160; </div>
<div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;        <span class="comment">// Compute some quantities that are constant in each column</span></div>
<div class="line"><a name="l04234"></a><span class="lineno"> 4234</span>&#160;        <span class="comment">// Sbox is shrunk to only include the interior of the domain in the vertical direction to compute integrals</span></div>
<div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160;        <span class="comment">// Box includes one ghost cell in each direction</span></div>
<div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;        <span class="keyword">const</span> Box &amp;dbx = geom.Domain();</div>
<div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;        Box sbx(bx.smallEnd(), bx.bigEnd());</div>
<div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160;        sbx.grow(2,-1);</div>
<div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160;        AMREX_ALWAYS_ASSERT(sbx.smallEnd(2) == dbx.smallEnd(2) &amp;&amp; sbx.bigEnd(2) == dbx.bigEnd(2));</div>
<div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160; </div>
<div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160;        <span class="keyword">const</span> GeometryData gdata = geom.data();</div>
<div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160; </div>
<div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160;        <span class="keyword">const</span> Box xybx = PerpendicularBox&lt;ZDir&gt;(bx, IntVect{0,0,0});</div>
<div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;        FArrayBox qintegral(xybx,2);</div>
<div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160;        qintegral.setVal&lt;RunOn::Device&gt;(0.0);</div>
<div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160;        FArrayBox qturb(bx,1); FArrayBox qturb_old(bx,1);</div>
<div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160;        <span class="keyword">const</span> Array4&lt;Real&gt; qint = qintegral.array();</div>
<div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160;        <span class="keyword">const</span> Array4&lt;Real&gt; qvel = qturb.array();</div>
<div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160; </div>
<div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160;        <span class="comment">// vertical integrals to compute lengthscale</span></div>
<div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160;        <span class="keywordflow">if</span> (use_terrain_fitted_coords) {</div>
<div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;            <span class="keyword">const</span> Array4&lt;Real const&gt; &amp;z_nd_arr = z_phys_nd-&gt;array(mfi);</div>
<div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;            <span class="keyword">const</span> <span class="keyword">auto</span> invCellSize = geom.InvCellSizeArray();</div>
<div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;            ParallelFor(bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;            {</div>
<div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;                qvel(i,j,k) = std::sqrt(2.0 * cell_data(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#ae15721db2cb4c2ab4732afe226bbba64">RhoKE_comp</a>) / cell_data(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>));</div>
<div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160;                AMREX_ASSERT_WITH_MESSAGE(qvel(i,j,k) &gt; 0.0, <span class="stringliteral">&quot;KE must have a positive value&quot;</span>);</div>
<div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160; </div>
<div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160;                <a class="code" href="ERF__ShocInterface_8H.html#ab8a9d2a7cbf2084043f890c3d0a68f57">Real</a> fac = (sbx.contains(i,j,k)) ? 1.0 : 0.0;</div>
<div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;                <span class="keyword">const</span> <a class="code" href="ERF__ShocInterface_8H.html#ab8a9d2a7cbf2084043f890c3d0a68f57">Real</a> Zval = <a class="code" href="ERF__TerrainMetrics_8H.html#a41f9b3a5604791daf44935b10a55a565">Compute_Zrel_AtCellCenter</a>(i,j,k,z_nd_arr);</div>
<div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;                <span class="keyword">const</span> <a class="code" href="ERF__ShocInterface_8H.html#ab8a9d2a7cbf2084043f890c3d0a68f57">Real</a> dz   = <a class="code" href="ERF__TerrainMetrics_8H.html#a32eeeb066c70da970aa6a60918515987">Compute_h_zeta_AtCellCenter</a>(i,j,k,invCellSize,z_nd_arr);</div>
<div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;                Gpu::Atomic::Add(&amp;qint(i,j,0,0), Zval*qvel(i,j,k)*dz*fac);</div>
<div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;                Gpu::Atomic::Add(&amp;qint(i,j,0,1),      qvel(i,j,k)*dz*fac);</div>
<div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;            });</div>
<div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160;            ParallelFor(bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160;            {</div>
<div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;                qvel(i,j,k) = std::sqrt(2.0 * cell_data(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#ae15721db2cb4c2ab4732afe226bbba64">RhoKE_comp</a>) / cell_data(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>));</div>
<div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160;                AMREX_ASSERT_WITH_MESSAGE(qvel(i,j,k) &gt; 0.0, <span class="stringliteral">&quot;KE must have a positive value&quot;</span>);</div>
<div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160; </div>
<div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160;                <span class="comment">// Not multiplying by dz: its constant and would fall out when we divide qint0/qint1 anyway</span></div>
<div class="line"><a name="l04272"></a><span class="lineno"> 4272</span>&#160; </div>
<div class="line"><a name="l04273"></a><span class="lineno"> 4273</span>&#160;                <a class="code" href="ERF__ShocInterface_8H.html#ab8a9d2a7cbf2084043f890c3d0a68f57">Real</a> fac = (sbx.contains(i,j,k)) ? 1.0 : 0.0;</div>
<div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160;                <span class="keyword">const</span> <a class="code" href="ERF__ShocInterface_8H.html#ab8a9d2a7cbf2084043f890c3d0a68f57">Real</a> Zval = gdata.ProbLo(2) + (k + 0.5)*gdata.CellSize(2);</div>
<div class="line"><a name="l04275"></a><span class="lineno"> 4275</span>&#160;                Gpu::Atomic::Add(&amp;qint(i,j,0,0), Zval*qvel(i,j,k)*fac);</div>
<div class="line"><a name="l04276"></a><span class="lineno"> 4276</span>&#160;                Gpu::Atomic::Add(&amp;qint(i,j,0,1),      qvel(i,j,k)*fac);</div>
<div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160;            });</div>
<div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;        }</div>
<div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160; </div>
<div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;        <a class="code" href="ERF__ShocInterface_8H.html#ab8a9d2a7cbf2084043f890c3d0a68f57">Real</a> dz_inv = geom.InvCellSize(2);</div>
<div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span>&amp; dxInv = geom.InvCellSizeArray();</div>
<div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;        <span class="keywordtype">int</span> izmin = geom.Domain().smallEnd(2);</div>
<div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160;        <span class="keywordtype">int</span> izmax = geom.Domain().bigEnd(2);</div>
<div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160; </div>
<div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160;        <span class="comment">// Spatially varying MOST</span></div>
<div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160;        <a class="code" href="ERF__ShocInterface_8H.html#ab8a9d2a7cbf2084043f890c3d0a68f57">Real</a> d_kappa   = <a class="code" href="ERF__Constants_8H.html#a0f51e1ef58cb9a3add46666cc98e6093">KAPPA</a>;</div>
<div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160;        <a class="code" href="ERF__ShocInterface_8H.html#ab8a9d2a7cbf2084043f890c3d0a68f57">Real</a> d_gravity = <a class="code" href="ERF__Constants_8H.html#ac2d0c304ab1117368778efcda612de43">CONST_GRAV</a>;</div>
<div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160; </div>
<div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span>&amp; t_mean_mf = SurfLayer-&gt;get_mac_avg(level,4); <span class="comment">// theta_v</span></div>
<div class="line"><a name="l04290"></a><span class="lineno"> 4290</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span>&amp; q_mean_mf = SurfLayer-&gt;get_mac_avg(level,3); <span class="comment">// q_v</span></div>
<div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span>&amp; u_star_mf = SurfLayer-&gt;get_u_star(level);</div>
<div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span>&amp; t_star_mf = SurfLayer-&gt;get_t_star(level);</div>
<div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span>&amp; q_star_mf = SurfLayer-&gt;get_q_star(level);</div>
<div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160; </div>
<div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span>&amp; tm_arr     = t_mean_mf-&gt;const_array(mfi);</div>
<div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span>&amp; qm_arr     = q_mean_mf-&gt;const_array(mfi);</div>
<div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span>&amp; u_star_arr = u_star_mf-&gt;const_array(mfi);</div>
<div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span>&amp; t_star_arr = t_star_mf-&gt;const_array(mfi);</div>
<div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span>&amp; q_star_arr = (use_moisture) ? q_star_mf-&gt;const_array(mfi) : Array4&lt;Real&gt;{};</div>
<div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160; </div>
<div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;        <span class="keyword">const</span> Array4&lt;Real const&gt; z_nd_arr = z_phys_nd-&gt;const_array(mfi);</div>
<div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160; </div>
<div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160;        ParallelFor(bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l04304"></a><span class="lineno"> 4304</span>&#160;        {</div>
<div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;            <span class="comment">// Compute some partial derivatives that we will need (second order)</span></div>
<div class="line"><a name="l04306"></a><span class="lineno"> 4306</span>&#160;            <span class="comment">// U and V derivatives are interpolated to account for staggered grid</span></div>
<div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160;            <span class="keyword">const</span> <a class="code" href="ERF__ShocInterface_8H.html#ab8a9d2a7cbf2084043f890c3d0a68f57">Real</a> met_h_zeta = use_terrain_fitted_coords ? <a class="code" href="ERF__TerrainMetrics_8H.html#a32eeeb066c70da970aa6a60918515987">Compute_h_zeta_AtCellCenter</a>(i,j,k,dxInv,z_nd_arr) : 1.0;</div>
<div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160;            <a class="code" href="ERF__ShocInterface_8H.html#ab8a9d2a7cbf2084043f890c3d0a68f57">Real</a> dthetadz, dudz, dvdz;</div>
<div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160;            <a class="code" href="ERF__PBLModels_8H.html#a1deabe90a1d943d577b1e8ce80a6b4b1">ComputeVerticalDerivativesPBL</a>(i, j, k,</div>
<div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160;                                          uvel, vvel, cell_data, izmin, izmax, dz_inv/met_h_zeta,</div>
<div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160;                                          c_ext_dir_on_zlo, c_ext_dir_on_zhi,</div>
<div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;                                          u_ext_dir_on_zlo, u_ext_dir_on_zhi,</div>
<div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160;                                          v_ext_dir_on_zlo, v_ext_dir_on_zhi,</div>
<div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;                                          dthetadz, dudz, dvdz,</div>
<div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;                                          moisture_indices);</div>
<div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160; </div>
<div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160;            <span class="comment">// Spatially varying MOST</span></div>
<div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160;            <a class="code" href="ERF__ShocInterface_8H.html#ab8a9d2a7cbf2084043f890c3d0a68f57">Real</a> theta0 = tm_arr(i,j,0);</div>
<div class="line"><a name="l04319"></a><span class="lineno"> 4319</span>&#160;            <a class="code" href="ERF__ShocInterface_8H.html#ab8a9d2a7cbf2084043f890c3d0a68f57">Real</a> qv0    = qm_arr(i,j,0);</div>
<div class="line"><a name="l04320"></a><span class="lineno"> 4320</span>&#160;            <a class="code" href="ERF__ShocInterface_8H.html#ab8a9d2a7cbf2084043f890c3d0a68f57">Real</a> surface_heat_flux = -u_star_arr(i,j,0) * t_star_arr(i,j,0);</div>
<div class="line"><a name="l04321"></a><span class="lineno"> 4321</span>&#160;            <a class="code" href="ERF__ShocInterface_8H.html#ab8a9d2a7cbf2084043f890c3d0a68f57">Real</a> surface_latent_heat{0};</div>
<div class="line"><a name="l04322"></a><span class="lineno"> 4322</span>&#160;            <span class="keywordflow">if</span> (use_moisture) {</div>
<div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160;                <span class="comment">// Compute buoyancy flux (Stull Eqn. 4.4.5d)</span></div>
<div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160;                surface_latent_heat = -u_star_arr(i,j,0) * q_star_arr(i,j,0);</div>
<div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160;                surface_heat_flux *= (1.0 + 0.61*qv0);</div>
<div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160;                surface_heat_flux += 0.61 * theta0 * surface_latent_heat;</div>
<div class="line"><a name="l04327"></a><span class="lineno"> 4327</span>&#160;            }</div>
<div class="line"><a name="l04328"></a><span class="lineno"> 4328</span>&#160; </div>
<div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;            <a class="code" href="ERF__ShocInterface_8H.html#ab8a9d2a7cbf2084043f890c3d0a68f57">Real</a> l_obukhov;</div>
<div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160;            <span class="keywordflow">if</span> (std::abs(surface_heat_flux) &gt; eps) {</div>
<div class="line"><a name="l04331"></a><span class="lineno"> 4331</span>&#160;                l_obukhov = -( theta0 * u_star_arr(i,j,0)*u_star_arr(i,j,0)*u_star_arr(i,j,0) )</div>
<div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;                           / ( d_kappa * d_gravity * surface_heat_flux );</div>
<div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160;                l_obukhov = std::numeric_limits&lt;Real&gt;::max();</div>
<div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160;            }</div>
<div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160; </div>
<div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160;            <span class="comment">// Surface-layer length scale (NN09, Eqn. 53)</span></div>
<div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;            AMREX_ASSERT(l_obukhov != 0);</div>
<div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160;            <span class="keywordtype">int</span> lk = amrex::max(k,0);</div>
<div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160;            <span class="keyword">const</span> <a class="code" href="ERF__ShocInterface_8H.html#ab8a9d2a7cbf2084043f890c3d0a68f57">Real</a> zval = use_terrain_fitted_coords ? <a class="code" href="ERF__TerrainMetrics_8H.html#a41f9b3a5604791daf44935b10a55a565">Compute_Zrel_AtCellCenter</a>(i,j,lk,z_nd_arr)</div>
<div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160;                                          : gdata.ProbLo(2) + (lk + 0.5)*gdata.CellSize(2);</div>
<div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;            <span class="keyword">const</span> <a class="code" href="ERF__ShocInterface_8H.html#ab8a9d2a7cbf2084043f890c3d0a68f57">Real</a> zeta = zval/l_obukhov;</div>
<div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160;            <a class="code" href="ERF__ShocInterface_8H.html#ab8a9d2a7cbf2084043f890c3d0a68f57">Real</a> l_S;</div>
<div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;            <span class="keywordflow">if</span> (zeta &gt;= 1.0) {</div>
<div class="line"><a name="l04345"></a><span class="lineno"> 4345</span>&#160;                l_S = <a class="code" href="ERF__Constants_8H.html#a0f51e1ef58cb9a3add46666cc98e6093">KAPPA</a>*zval/3.7;</div>
<div class="line"><a name="l04346"></a><span class="lineno"> 4346</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (zeta &gt;= 0) {</div>
<div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160;                l_S = <a class="code" href="ERF__Constants_8H.html#a0f51e1ef58cb9a3add46666cc98e6093">KAPPA</a>*zval/(1+2.7*zeta);</div>
<div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;                l_S = <a class="code" href="ERF__Constants_8H.html#a0f51e1ef58cb9a3add46666cc98e6093">KAPPA</a>*zval*std::pow(1.0 - 100.0 * zeta, 0.2);</div>
<div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;            }</div>
<div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160; </div>
<div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;            <span class="comment">// ABL-depth length scale (NN09, Eqn. 54)</span></div>
<div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;            <a class="code" href="ERF__ShocInterface_8H.html#ab8a9d2a7cbf2084043f890c3d0a68f57">Real</a> l_T;</div>
<div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160;            <span class="keywordflow">if</span> (qint(i,j,0,1) &gt; 0.0) {</div>
<div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160;                l_T = Lt_alpha*qint(i,j,0,0)/qint(i,j,0,1);</div>
<div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160;                l_T = std::numeric_limits&lt;Real&gt;::max();</div>
<div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160;            }</div>
<div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160; </div>
<div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160;            <span class="comment">// Buoyancy length scale (NN09, Eqn. 55)</span></div>
<div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160;            <a class="code" href="ERF__ShocInterface_8H.html#ab8a9d2a7cbf2084043f890c3d0a68f57">Real</a> l_B;</div>
<div class="line"><a name="l04362"></a><span class="lineno"> 4362</span>&#160;            <span class="keywordflow">if</span> (dthetadz &gt; 0) {</div>
<div class="line"><a name="l04363"></a><span class="lineno"> 4363</span>&#160;                <a class="code" href="ERF__ShocInterface_8H.html#ab8a9d2a7cbf2084043f890c3d0a68f57">Real</a> N_brunt_vaisala = std::sqrt(<a class="code" href="ERF__Constants_8H.html#ac2d0c304ab1117368778efcda612de43">CONST_GRAV</a>/theta0 * dthetadz);</div>
<div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160;                <span class="keywordflow">if</span> (zeta &lt; 0) {</div>
<div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;                    <a class="code" href="ERF__ShocInterface_8H.html#ab8a9d2a7cbf2084043f890c3d0a68f57">Real</a> <a class="code" href="namespaceMicVar__SatAdj.html#aa1c9c2ace8fed7315f565cd2230366d8aea3777efcbbb3712ce373924287c2cb3">qc</a> = <a class="code" href="ERF__Constants_8H.html#ac2d0c304ab1117368778efcda612de43">CONST_GRAV</a>/theta0 * surface_heat_flux * l_T; <span class="comment">// velocity scale</span></div>
<div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;                    <a class="code" href="namespaceMicVar__SatAdj.html#aa1c9c2ace8fed7315f565cd2230366d8aea3777efcbbb3712ce373924287c2cb3">qc</a> = std::pow(<a class="code" href="namespaceMicVar__SatAdj.html#aa1c9c2ace8fed7315f565cd2230366d8aea3777efcbbb3712ce373924287c2cb3">qc</a>,1.0/3.0);</div>
<div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;                    l_B = (1.0 + 5.0*std::sqrt(<a class="code" href="namespaceMicVar__SatAdj.html#aa1c9c2ace8fed7315f565cd2230366d8aea3777efcbbb3712ce373924287c2cb3">qc</a>/(N_brunt_vaisala * l_T))) * qvel(i,j,k)/N_brunt_vaisala;</div>
<div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160;                    l_B = qvel(i,j,k) / N_brunt_vaisala;</div>
<div class="line"><a name="l04370"></a><span class="lineno"> 4370</span>&#160;                }</div>
<div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;                l_B = std::numeric_limits&lt;Real&gt;::max();</div>
<div class="line"><a name="l04373"></a><span class="lineno"> 4373</span>&#160;            }</div>
<div class="line"><a name="l04374"></a><span class="lineno"> 4374</span>&#160; </div>
<div class="line"><a name="l04375"></a><span class="lineno"> 4375</span>&#160;            <span class="comment">// Master length scale</span></div>
<div class="line"><a name="l04376"></a><span class="lineno"> 4376</span>&#160;            <a class="code" href="ERF__ShocInterface_8H.html#ab8a9d2a7cbf2084043f890c3d0a68f57">Real</a> Lm;</div>
<div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160;            <span class="keywordflow">if</span> (mynn.config == <a class="code" href="ERF__MYNNStruct_8H.html#a103de8b695a78549c43fa852d9c4dd25abe8de8e777a612742c642b372ab3dc9e">MYNNConfigType::CHEN2021</a>) {</div>
<div class="line"><a name="l04378"></a><span class="lineno"> 4378</span>&#160;                Lm = std::pow(1.0/(l_S*l_S) + 1.0/(l_T*l_T) + 1.0/(l_B*l_B), -0.5);</div>
<div class="line"><a name="l04379"></a><span class="lineno"> 4379</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04380"></a><span class="lineno"> 4380</span>&#160;                <span class="comment">// NN09, Eqn 52</span></div>
<div class="line"><a name="l04381"></a><span class="lineno"> 4381</span>&#160;                Lm = 1.0 / (1.0/l_S + 1.0/l_T + 1.0/l_B);</div>
<div class="line"><a name="l04382"></a><span class="lineno"> 4382</span>&#160;            }</div>
<div class="line"><a name="l04383"></a><span class="lineno"> 4383</span>&#160; </div>
<div class="line"><a name="l04384"></a><span class="lineno"> 4384</span>&#160;            <span class="comment">// Calculate nondimensional production terms</span></div>
<div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160;            <a class="code" href="ERF__ShocInterface_8H.html#ab8a9d2a7cbf2084043f890c3d0a68f57">Real</a> shearProd  = dudz*dudz + dvdz*dvdz;</div>
<div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160;            <a class="code" href="ERF__ShocInterface_8H.html#ab8a9d2a7cbf2084043f890c3d0a68f57">Real</a> buoyProd   = -(<a class="code" href="ERF__Constants_8H.html#ac2d0c304ab1117368778efcda612de43">CONST_GRAV</a>/theta0) * dthetadz;</div>
<div class="line"><a name="l04387"></a><span class="lineno"> 4387</span>&#160;            <a class="code" href="ERF__ShocInterface_8H.html#ab8a9d2a7cbf2084043f890c3d0a68f57">Real</a> L2_over_q2 = Lm*Lm/(qvel(i,j,k)*qvel(i,j,k));</div>
<div class="line"><a name="l04388"></a><span class="lineno"> 4388</span>&#160;            <a class="code" href="ERF__ShocInterface_8H.html#ab8a9d2a7cbf2084043f890c3d0a68f57">Real</a> GM         = L2_over_q2 * shearProd;</div>
<div class="line"><a name="l04389"></a><span class="lineno"> 4389</span>&#160;            <a class="code" href="ERF__ShocInterface_8H.html#ab8a9d2a7cbf2084043f890c3d0a68f57">Real</a> GH         = L2_over_q2 * buoyProd;</div>
<div class="line"><a name="l04390"></a><span class="lineno"> 4390</span>&#160; </div>
<div class="line"><a name="l04391"></a><span class="lineno"> 4391</span>&#160;            <span class="comment">// Equilibrium (Level-2) q calculation follows NN09, Appendix 2</span></div>
<div class="line"><a name="l04392"></a><span class="lineno"> 4392</span>&#160;            <a class="code" href="ERF__ShocInterface_8H.html#ab8a9d2a7cbf2084043f890c3d0a68f57">Real</a> Rf  = level2.calc_Rf(GM, GH);</div>
<div class="line"><a name="l04393"></a><span class="lineno"> 4393</span>&#160;            <a class="code" href="ERF__ShocInterface_8H.html#ab8a9d2a7cbf2084043f890c3d0a68f57">Real</a> SM2 = level2.calc_SM(Rf);</div>
<div class="line"><a name="l04394"></a><span class="lineno"> 4394</span>&#160;            <a class="code" href="ERF__ShocInterface_8H.html#ab8a9d2a7cbf2084043f890c3d0a68f57">Real</a> qe2 = mynn.B1*Lm*Lm*SM2*(1.0-Rf)*shearProd;</div>
<div class="line"><a name="l04395"></a><span class="lineno"> 4395</span>&#160;            <a class="code" href="ERF__ShocInterface_8H.html#ab8a9d2a7cbf2084043f890c3d0a68f57">Real</a> qe  = (qe2 &lt; 0.0) ? 0.0 : std::sqrt(qe2);</div>
<div class="line"><a name="l04396"></a><span class="lineno"> 4396</span>&#160; </div>
<div class="line"><a name="l04397"></a><span class="lineno"> 4397</span>&#160;            <span class="comment">// Level 2 limiting (Helfand and Labraga 1988)</span></div>
<div class="line"><a name="l04398"></a><span class="lineno"> 4398</span>&#160;            <a class="code" href="ERF__ShocInterface_8H.html#ab8a9d2a7cbf2084043f890c3d0a68f57">Real</a> alphac  = (qvel(i,j,k) &gt; qe) ? 1.0 : qvel(i,j,k) / (qe + eps);</div>
<div class="line"><a name="l04399"></a><span class="lineno"> 4399</span>&#160; </div>
<div class="line"><a name="l04400"></a><span class="lineno"> 4400</span>&#160;            <span class="comment">// Level 2.5 stability functions</span></div>
<div class="line"><a name="l04401"></a><span class="lineno"> 4401</span>&#160;            <a class="code" href="ERF__ShocInterface_8H.html#ab8a9d2a7cbf2084043f890c3d0a68f57">Real</a> SM, SH, SQ;</div>
<div class="line"><a name="l04402"></a><span class="lineno"> 4402</span>&#160;            mynn.calc_stability_funcs(SM,SH,SQ,GM,GH,alphac);</div>
<div class="line"><a name="l04403"></a><span class="lineno"> 4403</span>&#160; </div>
<div class="line"><a name="l04404"></a><span class="lineno"> 4404</span>&#160;            <span class="comment">// Clip SM, SH following WRF</span></div>
<div class="line"><a name="l04405"></a><span class="lineno"> 4405</span>&#160;            SM = amrex::min(amrex::max(SM,mynn.SMmin), mynn.SMmax);</div>
<div class="line"><a name="l04406"></a><span class="lineno"> 4406</span>&#160;            SH = amrex::min(amrex::max(SH,mynn.SHmin), mynn.SHmax);</div>
<div class="line"><a name="l04407"></a><span class="lineno"> 4407</span>&#160; </div>
<div class="line"><a name="l04408"></a><span class="lineno"> 4408</span>&#160;            <span class="comment">// Finally, compute the eddy viscosity/diffusivities</span></div>
<div class="line"><a name="l04409"></a><span class="lineno"> 4409</span>&#160;            <span class="keyword">const</span> <a class="code" href="ERF__ShocInterface_8H.html#ab8a9d2a7cbf2084043f890c3d0a68f57">Real</a> <a class="code" href="namespaceMicVar__Kess.html#a82dcb2bcc4216c918036c4e28127276da89de8c3bfc941080efb960e5119fbd61">rho</a> = cell_data(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>);</div>
<div class="line"><a name="l04410"></a><span class="lineno"> 4410</span>&#160;            K_turb(i,j,k,<a class="code" href="namespaceEddyDiff.html#a3f912b3dbcd18dd6f4f0a85815a3ce47a61ed124b350a1b26da1bd26aebfa5f82">EddyDiff::Mom_v</a>)   = <a class="code" href="namespaceMicVar__Kess.html#a82dcb2bcc4216c918036c4e28127276da89de8c3bfc941080efb960e5119fbd61">rho</a> * Lm * qvel(i,j,k) * SM;</div>
<div class="line"><a name="l04411"></a><span class="lineno"> 4411</span>&#160;            K_turb(i,j,k,<a class="code" href="namespaceEddyDiff.html#a3f912b3dbcd18dd6f4f0a85815a3ce47a0af64d676c5c6f4312eb892f9a7a46cd">EddyDiff::Theta_v</a>) = <a class="code" href="namespaceMicVar__Kess.html#a82dcb2bcc4216c918036c4e28127276da89de8c3bfc941080efb960e5119fbd61">rho</a> * Lm * qvel(i,j,k) * SH;</div>
<div class="line"><a name="l04412"></a><span class="lineno"> 4412</span>&#160;            K_turb(i,j,k,<a class="code" href="namespaceEddyDiff.html#a3f912b3dbcd18dd6f4f0a85815a3ce47a937c191d351b2c26cd7ea07878978b94">EddyDiff::KE_v</a>)    = <a class="code" href="namespaceMicVar__Kess.html#a82dcb2bcc4216c918036c4e28127276da89de8c3bfc941080efb960e5119fbd61">rho</a> * Lm * qvel(i,j,k) * SQ;</div>
<div class="line"><a name="l04413"></a><span class="lineno"> 4413</span>&#160; </div>
<div class="line"><a name="l04414"></a><span class="lineno"> 4414</span>&#160;            <span class="comment">// TODO: implement partial-condensation scheme?</span></div>
<div class="line"><a name="l04415"></a><span class="lineno"> 4415</span>&#160;            <span class="comment">// Currently, implementation matches NN09 without rain (i.e.,</span></div>
<div class="line"><a name="l04416"></a><span class="lineno"> 4416</span>&#160;            <span class="comment">// the liquid water potential temperature is equal to the</span></div>
<div class="line"><a name="l04417"></a><span class="lineno"> 4417</span>&#160;            <span class="comment">// potential temperature.</span></div>
<div class="line"><a name="l04418"></a><span class="lineno"> 4418</span>&#160; </div>
<div class="line"><a name="l04419"></a><span class="lineno"> 4419</span>&#160;            <span class="comment">// NN09 gives the total water content flux; this assumes that</span></div>
<div class="line"><a name="l04420"></a><span class="lineno"> 4420</span>&#160;            <span class="comment">// all the species have the same eddy diffusivity</span></div>
<div class="line"><a name="l04421"></a><span class="lineno"> 4421</span>&#160;            <span class="keywordflow">if</span> (mynn.diffuse_moistvars) {</div>
<div class="line"><a name="l04422"></a><span class="lineno"> 4422</span>&#160;                K_turb(i,j,k,<a class="code" href="namespaceEddyDiff.html#a3f912b3dbcd18dd6f4f0a85815a3ce47a4166b9561a2ef0ad6d1b6d2c34cb9580">EddyDiff::Q_v</a>) = <a class="code" href="namespaceMicVar__Kess.html#a82dcb2bcc4216c918036c4e28127276da89de8c3bfc941080efb960e5119fbd61">rho</a> * Lm * qvel(i,j,k) * SH;</div>
<div class="line"><a name="l04423"></a><span class="lineno"> 4423</span>&#160;            }</div>
<div class="line"><a name="l04424"></a><span class="lineno"> 4424</span>&#160; </div>
<div class="line"><a name="l04425"></a><span class="lineno"> 4425</span>&#160;            K_turb(i,j,k,<a class="code" href="namespaceEddyDiff.html#a3f912b3dbcd18dd6f4f0a85815a3ce47a1fd996857fe3699ac7f9454e88d6ae76">EddyDiff::Turb_lengthscale</a>) = Lm;</div>
<div class="line"><a name="l04426"></a><span class="lineno"> 4426</span>&#160;        });</div>
<div class="line"><a name="l04427"></a><span class="lineno"> 4427</span>&#160;    }</div>
<div class="line"><a name="l04428"></a><span class="lineno"> 4428</span>&#160;}</div>
<div class="ttc" id="aERF__Constants_8H_html_a0f51e1ef58cb9a3add46666cc98e6093"><div class="ttname"><a href="ERF__Constants_8H.html#a0f51e1ef58cb9a3add46666cc98e6093">KAPPA</a></div><div class="ttdeci">constexpr amrex::Real KAPPA</div><div class="ttdef"><b>Definition:</b> ERF_Constants.H:20</div></div>
<div class="ttc" id="aERF__Constants_8H_html_ac2d0c304ab1117368778efcda612de43"><div class="ttname"><a href="ERF__Constants_8H.html#ac2d0c304ab1117368778efcda612de43">CONST_GRAV</a></div><div class="ttdeci">constexpr amrex::Real CONST_GRAV</div><div class="ttdef"><b>Definition:</b> ERF_Constants.H:21</div></div>
<div class="ttc" id="aERF__DataStruct_8H_html_a627f1f843904477f763577ad1460de01a9dd4e461268c8034f5c8564e155c67a6"><div class="ttname"><a href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01a9dd4e461268c8034f5c8564e155c67a6">Coord::x</a></div><div class="ttdeci">@ x</div></div>
<div class="ttc" id="aERF__DiffSetup_8H_html_a4a8c0178282c029acc3d37ed429f9f58"><div class="ttname"><a href="ERF__DiffSetup_8H.html#a4a8c0178282c029acc3d37ed429f9f58">turbChoice</a></div><div class="ttdeci">TurbChoice turbChoice</div><div class="ttdef"><b>Definition:</b> ERF_DiffSetup.H:2</div></div>
<div class="ttc" id="aERF__IndexDefines_8H_html_a27dcc910aeb002a0fd44727954dc0e49"><div class="ttname"><a href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a></div><div class="ttdeci">#define Rho_comp</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:36</div></div>
<div class="ttc" id="aERF__IndexDefines_8H_html_ae15721db2cb4c2ab4732afe226bbba64"><div class="ttname"><a href="ERF__IndexDefines_8H.html#ae15721db2cb4c2ab4732afe226bbba64">RhoKE_comp</a></div><div class="ttdeci">#define RhoKE_comp</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:38</div></div>
<div class="ttc" id="aERF__MYNNStruct_8H_html_a103de8b695a78549c43fa852d9c4dd25abe8de8e777a612742c642b372ab3dc9e"><div class="ttname"><a href="ERF__MYNNStruct_8H.html#a103de8b695a78549c43fa852d9c4dd25abe8de8e777a612742c642b372ab3dc9e">MYNNConfigType::CHEN2021</a></div><div class="ttdeci">@ CHEN2021</div></div>
<div class="ttc" id="aERF__PBLModels_8H_html_a1deabe90a1d943d577b1e8ce80a6b4b1"><div class="ttname"><a href="ERF__PBLModels_8H.html#a1deabe90a1d943d577b1e8ce80a6b4b1">ComputeVerticalDerivativesPBL</a></div><div class="ttdeci">AMREX_GPU_DEVICE AMREX_FORCE_INLINE void ComputeVerticalDerivativesPBL(int i, int j, int k, const amrex::Array4&lt; const amrex::Real &gt; &amp;uvel, const amrex::Array4&lt; const amrex::Real &gt; &amp;vvel, const amrex::Array4&lt; const amrex::Real &gt; &amp;cell_data, const int izmin, const int izmax, const amrex::Real &amp;dz_inv, const bool c_ext_dir_on_zlo, const bool c_ext_dir_on_zhi, const bool u_ext_dir_on_zlo, const bool u_ext_dir_on_zhi, const bool v_ext_dir_on_zlo, const bool v_ext_dir_on_zhi, amrex::Real &amp;dthetadz, amrex::Real &amp;dudz, amrex::Real &amp;dvdz, const MoistureComponentIndices &amp;moisture_indices)</div><div class="ttdef"><b>Definition:</b> ERF_PBLModels.H:181</div></div>
<div class="ttc" id="aERF__ShocInterface_8H_html_ab8a9d2a7cbf2084043f890c3d0a68f57"><div class="ttname"><a href="ERF__ShocInterface_8H.html#ab8a9d2a7cbf2084043f890c3d0a68f57">Real</a></div><div class="ttdeci">amrex::Real Real</div><div class="ttdef"><b>Definition:</b> ERF_ShocInterface.H:19</div></div>
<div class="ttc" id="aERF__TerrainMetrics_8H_html_a32eeeb066c70da970aa6a60918515987"><div class="ttname"><a href="ERF__TerrainMetrics_8H.html#a32eeeb066c70da970aa6a60918515987">Compute_h_zeta_AtCellCenter</a></div><div class="ttdeci">AMREX_FORCE_INLINE AMREX_GPU_DEVICE amrex::Real Compute_h_zeta_AtCellCenter(const int &amp;i, const int &amp;j, const int &amp;k, const amrex::GpuArray&lt; amrex::Real, AMREX_SPACEDIM &gt; &amp;cellSizeInv, const amrex::Array4&lt; const amrex::Real &gt; &amp;z_nd)</div><div class="ttdef"><b>Definition:</b> ERF_TerrainMetrics.H:47</div></div>
<div class="ttc" id="aERF__TerrainMetrics_8H_html_a41f9b3a5604791daf44935b10a55a565"><div class="ttname"><a href="ERF__TerrainMetrics_8H.html#a41f9b3a5604791daf44935b10a55a565">Compute_Zrel_AtCellCenter</a></div><div class="ttdeci">AMREX_GPU_DEVICE AMREX_FORCE_INLINE amrex::Real Compute_Zrel_AtCellCenter(const int &amp;i, const int &amp;j, const int &amp;k, const amrex::Array4&lt; const amrex::Real &gt; &amp;z_nd)</div><div class="ttdef"><b>Definition:</b> ERF_TerrainMetrics.H:381</div></div>
<div class="ttc" id="anamespaceBCVars_html_a00367571247ba920989360b94c156f4aa98ad22810fdfe9e585bc6481fc12454e"><div class="ttname"><a href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a></div><div class="ttdeci">@ yvel_bc</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:88</div></div>
<div class="ttc" id="anamespaceBCVars_html_a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec"><div class="ttname"><a href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a></div><div class="ttdeci">@ cons_bc</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:76</div></div>
<div class="ttc" id="anamespaceBCVars_html_a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4"><div class="ttname"><a href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a></div><div class="ttdeci">@ xvel_bc</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:87</div></div>
<div class="ttc" id="anamespaceERFBCType_html_a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af"><div class="ttname"><a href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af">ERFBCType::ext_dir</a></div><div class="ttdeci">@ ext_dir</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:209</div></div>
<div class="ttc" id="anamespaceEddyDiff_html_a3f912b3dbcd18dd6f4f0a85815a3ce47a0af64d676c5c6f4312eb892f9a7a46cd"><div class="ttname"><a href="namespaceEddyDiff.html#a3f912b3dbcd18dd6f4f0a85815a3ce47a0af64d676c5c6f4312eb892f9a7a46cd">EddyDiff::Theta_v</a></div><div class="ttdeci">@ Theta_v</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:176</div></div>
<div class="ttc" id="anamespaceEddyDiff_html_a3f912b3dbcd18dd6f4f0a85815a3ce47a1fd996857fe3699ac7f9454e88d6ae76"><div class="ttname"><a href="namespaceEddyDiff.html#a3f912b3dbcd18dd6f4f0a85815a3ce47a1fd996857fe3699ac7f9454e88d6ae76">EddyDiff::Turb_lengthscale</a></div><div class="ttdeci">@ Turb_lengthscale</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:180</div></div>
<div class="ttc" id="anamespaceEddyDiff_html_a3f912b3dbcd18dd6f4f0a85815a3ce47a4166b9561a2ef0ad6d1b6d2c34cb9580"><div class="ttname"><a href="namespaceEddyDiff.html#a3f912b3dbcd18dd6f4f0a85815a3ce47a4166b9561a2ef0ad6d1b6d2c34cb9580">EddyDiff::Q_v</a></div><div class="ttdeci">@ Q_v</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:179</div></div>
<div class="ttc" id="anamespaceEddyDiff_html_a3f912b3dbcd18dd6f4f0a85815a3ce47a61ed124b350a1b26da1bd26aebfa5f82"><div class="ttname"><a href="namespaceEddyDiff.html#a3f912b3dbcd18dd6f4f0a85815a3ce47a61ed124b350a1b26da1bd26aebfa5f82">EddyDiff::Mom_v</a></div><div class="ttdeci">@ Mom_v</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:175</div></div>
<div class="ttc" id="anamespaceEddyDiff_html_a3f912b3dbcd18dd6f4f0a85815a3ce47a937c191d351b2c26cd7ea07878978b94"><div class="ttname"><a href="namespaceEddyDiff.html#a3f912b3dbcd18dd6f4f0a85815a3ce47a937c191d351b2c26cd7ea07878978b94">EddyDiff::KE_v</a></div><div class="ttdeci">@ KE_v</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:177</div></div>
<div class="ttc" id="anamespaceMicVar__Kess_html_a82dcb2bcc4216c918036c4e28127276da89de8c3bfc941080efb960e5119fbd61"><div class="ttname"><a href="namespaceMicVar__Kess.html#a82dcb2bcc4216c918036c4e28127276da89de8c3bfc941080efb960e5119fbd61">MicVar_Kess::rho</a></div><div class="ttdeci">@ rho</div><div class="ttdef"><b>Definition:</b> ERF_Kessler.H:22</div></div>
<div class="ttc" id="anamespaceMicVar__SatAdj_html_aa1c9c2ace8fed7315f565cd2230366d8aea3777efcbbb3712ce373924287c2cb3"><div class="ttname"><a href="namespaceMicVar__SatAdj.html#aa1c9c2ace8fed7315f565cd2230366d8aea3777efcbbb3712ce373924287c2cb3">MicVar_SatAdj::qc</a></div><div class="ttdeci">@ qc</div><div class="ttdef"><b>Definition:</b> ERF_SatAdj.H:36</div></div>
<div class="ttc" id="anamespaceVars_html_a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c"><div class="ttname"><a href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a></div><div class="ttdeci">@ xvel</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:141</div></div>
<div class="ttc" id="anamespaceVars_html_a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6"><div class="ttname"><a href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a></div><div class="ttdeci">@ yvel</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:142</div></div>
<div class="ttc" id="anamespacemodule__model__constants_html_a8aff14ee510fe368c6991bc969cb5721"><div class="ttname"><a href="namespacemodule__model__constants.html#a8aff14ee510fe368c6991bc969cb5721">module_model_constants::epsilon</a></div><div class="ttdeci">real(c_double), parameter epsilon</div><div class="ttdef"><b>Definition:</b> ERF_module_model_constants.F90:12</div></div>
<div class="ttc" id="astructTurbChoice_html_a11fd9429567c4dd4afa871170580aed0"><div class="ttname"><a href="structTurbChoice.html#a11fd9429567c4dd4afa871170580aed0">TurbChoice::pbl_mynn</a></div><div class="ttdeci">MYNNLevel25 pbl_mynn</div><div class="ttdef"><b>Definition:</b> ERF_TurbStruct.H:381</div></div>
<div class="ttc" id="astructTurbChoice_html_a475d862a63ab672577fc2429f535feb9"><div class="ttname"><a href="structTurbChoice.html#a475d862a63ab672577fc2429f535feb9">TurbChoice::pbl_mynn_level2</a></div><div class="ttdeci">MYNNLevel2 pbl_mynn_level2</div><div class="ttdef"><b>Definition:</b> ERF_TurbStruct.H:382</div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="ERF__ComputeTurbulentViscosity_8cpp.html#ad777b96c0ad38487f5c5f9977a482fc2">ComputeTurbulentViscosity()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ERF__ComputeDiffusivityMYNNEDMF_8cpp_a0853d826a8a330e6967e3da5e973eed2_cgraph.png" border="0" usemap="#aERF__ComputeDiffusivityMYNNEDMF_8cpp_a0853d826a8a330e6967e3da5e973eed2_cgraph" alt=""/></div>
<map name="aERF__ComputeDiffusivityMYNNEDMF_8cpp_a0853d826a8a330e6967e3da5e973eed2_cgraph" id="aERF__ComputeDiffusivityMYNNEDMF_8cpp_a0853d826a8a330e6967e3da5e973eed2_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,232,83"/>
<area shape="rect" href="ERF__TerrainMetrics_8H.html#a32eeeb066c70da970aa6a60918515987" title=" " alt="" coords="285,5,505,32"/>
<area shape="rect" href="ERF__TerrainMetrics_8H.html#a41f9b3a5604791daf44935b10a55a565" title=" " alt="" coords="293,56,496,83"/>
<area shape="rect" href="ERF__PBLModels_8H.html#a1deabe90a1d943d577b1e8ce80a6b4b1" title=" " alt="" coords="280,107,509,133"/>
<area shape="rect" href="ERF__MoistUtils_8H.html#ac7f742c2dc11eeb2827422c9c5e32b2c" title=" " alt="" coords="557,107,648,133"/>
<area shape="rect" href="ERF__MoistUtils_8H.html#a81174ac45d8af790b5a6310c4d1369f6" title=" " alt="" coords="696,81,960,108"/>
<area shape="rect" href="ERF__MoistUtils_8H.html#a84e52f9faae4809d31ca76dd95aafa19" title=" " alt="" coords="763,132,893,159"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ERF__ComputeDiffusivityMYNNEDMF_8cpp_a0853d826a8a330e6967e3da5e973eed2_icgraph.png" border="0" usemap="#aERF__ComputeDiffusivityMYNNEDMF_8cpp_a0853d826a8a330e6967e3da5e973eed2_icgraph" alt=""/></div>
<map name="aERF__ComputeDiffusivityMYNNEDMF_8cpp_a0853d826a8a330e6967e3da5e973eed2_icgraph" id="aERF__ComputeDiffusivityMYNNEDMF_8cpp_a0853d826a8a330e6967e3da5e973eed2_icgraph">
<area shape="rect" title=" " alt="" coords="461,5,688,32"/>
<area shape="rect" href="ERF__ComputeTurbulentViscosity_8cpp.html#ad777b96c0ad38487f5c5f9977a482fc2" title=" " alt="" coords="213,5,413,32"/>
<area shape="rect" href="classERF.html#a96a272defae485c5b83fbc123a631f9f" title=" " alt="" coords="5,5,165,32"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_74389ed8173ad57b461b9d623a1f3867.html">Source</a></li><li class="navelem"><a class="el" href="dir_ae0b7467bb3c74d292c83ac9fdeb56bf.html">PBL</a></li><li class="navelem"><a class="el" href="ERF__ComputeDiffusivityMYNNEDMF_8cpp.html">ERF_ComputeDiffusivityMYNNEDMF.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
