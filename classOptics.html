<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ERF: Optics Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ERF
   </div>
   <div id="projectbrief">Energy Research and Forecasting: An Atmospheric Modeling Code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('classOptics.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classOptics-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Optics Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="Optics_8H_source.html">Optics.H</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for Optics:</div>
<div class="dyncontent">
<div class="center"><img src="classOptics__coll__graph.png" border="0" usemap="#aOptics_coll__map" alt="Collaboration graph"/></div>
<map name="aOptics_coll__map" id="aOptics_coll__map">
<area shape="rect" title=" " alt="" coords="2771,1344,2833,1371"/>
<area shape="rect" title=" " alt="" coords="2556,117,2624,144"/>
<area shape="rect" href="classCloudRadProps.html" title=" " alt="" coords="1013,277,1133,304"/>
<area shape="rect" title=" " alt="" coords="303,2507,341,2533"/>
<area shape="rect" href="classAerRadProps.html" title=" " alt="" coords="2537,1344,2643,1371"/>
<area shape="rect" href="classMam4__aer.html" title=" " alt="" coords="2332,595,2423,621"/>
<area shape="rect" href="classMamConstituents.html" title=" " alt="" coords="2061,1568,2199,1595"/>
<area shape="rect" href="structMamConstituents_1_1modes__t.html" title=" " alt="" coords="1719,2251,1921,2277"/>
<area shape="rect" href="structMamConstituents_1_1mode__component__t.html" title=" " alt="" coords="982,2299,1165,2341"/>
<area shape="rect" title=" " alt="" coords="568,2307,707,2333"/>
<area shape="rect" href="structMamConstituents_1_1modelist__t.html" title=" " alt="" coords="966,1771,1181,1797"/>
<area shape="rect" href="structMamConstituents_1_1aerlist__t.html" title=" " alt="" coords="1361,1907,1559,1933"/>
<area shape="rect" href="structMamConstituents_1_1aerosol__t.html" title=" " alt="" coords="535,1864,740,1891"/>
<area shape="rect" href="structMamConstituents_1_1gaslist__t.html" title=" " alt="" coords="1360,2205,1560,2232"/>
<area shape="rect" href="structMamConstituents_1_1gas__t.html" title=" " alt="" coords="547,2043,727,2069"/>
<area shape="rect" href="structPhysProp_1_1physprop__t.html" title=" " alt="" coords="992,1029,1155,1056"/>
<area shape="rect" title=" " alt="" coords="279,1401,365,1428"/>
<area shape="rect" title=" " alt="" coords="544,1528,731,1555"/>
<area shape="rect" title=" " alt="" coords="5,1394,144,1435"/>
<area shape="rect" title=" " alt="" coords="606,88,669,115"/>
<area shape="rect" title=" " alt="" coords="606,1212,669,1239"/>
<area shape="rect" title=" " alt="" coords="606,441,669,468"/>
<area shape="rect" href="classPhysProp.html" title=" " alt="" coords="1779,1415,1861,1441"/>
<area shape="rect" title=" " alt="" coords="257,1803,387,1829"/>
<area shape="rect" title=" " alt="" coords="1349,2338,1571,2379"/>
<area shape="rect" title=" " alt="" coords="1349,1662,1571,1703"/>
<area shape="rect" title=" " alt="" coords="1709,1830,1931,1871"/>
<area shape="rect" title=" " alt="" coords="963,1951,1184,1993"/>
<area shape="rect" title=" " alt="" coords="1709,2138,1931,2179"/>
<area shape="rect" title=" " alt="" coords="963,2207,1184,2249"/>
<area shape="rect" title=" " alt="" coords="1377,1293,1543,1334"/>
<area shape="rect" title=" " alt="" coords="55,1803,94,1829"/>
<area shape="rect" title=" " alt="" coords="1795,688,1845,715"/>
<area shape="rect" title=" " alt="" coords="606,1029,669,1056"/>
<area shape="rect" title=" " alt="" coords="614,680,661,707"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a3ec67cc89ceb33196552b89616728040"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOptics.html#a3ec67cc89ceb33196552b89616728040">Optics</a> ()=default</td></tr>
<tr class="separator:a3ec67cc89ceb33196552b89616728040"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadaf34955cffcf141d182624b38f7898"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOptics.html#aadaf34955cffcf141d182624b38f7898">Optics</a> (int ngases, char *<a class="el" href="classOptics.html#aba268b2221309fdc437349b1427c5c6d">gas_names</a>[])</td></tr>
<tr class="separator:aadaf34955cffcf141d182624b38f7898"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae33a3d262417ad9bb96adc3a32519e5f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOptics.html#ae33a3d262417ad9bb96adc3a32519e5f">~Optics</a> ()=default</td></tr>
<tr class="separator:ae33a3d262417ad9bb96adc3a32519e5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee82856b88240c428aefc6f47bf9500c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOptics.html#aee82856b88240c428aefc6f47bf9500c">get_cloud_optics_sw</a> (int ncol, int nlev, int nbnd, bool do_snow, const real2d &amp;cld, const real2d &amp;cldfsnow, const real2d &amp;iclwp, const real2d &amp;iciwp, const real2d &amp;icswp, const real2d &amp;lambdac, const real2d &amp;mu, const real2d &amp;dei, const real2d &amp;des, const real2d &amp;rel, const real2d &amp;rei, const real3d &amp;tau_out, const real3d &amp;ssa_out, const real3d &amp;asm_out, const real3d &amp;liq_tau_out, const real3d &amp;ice_tau_out, const real3d &amp;snw_tau_out)</td></tr>
<tr class="separator:aee82856b88240c428aefc6f47bf9500c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5f3fa679301f0ead8b8155626b2e710"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOptics.html#af5f3fa679301f0ead8b8155626b2e710">get_cloud_optics_lw</a> (int ncol, int nlev, int nbnd, bool do_snow, const real2d &amp;cld, const real2d &amp;cldfsnow, const real2d &amp;iclwp, const real2d &amp;iciwp, const real2d &amp;icswp, const real2d &amp;lambdac, const real2d &amp;mu, const real2d &amp;dei, const real2d &amp;des, const real2d &amp;rei, const real3d &amp;tau_out, const real3d &amp;liq_tau_out, const real3d &amp;ice_tau_out, const real3d &amp;snw_tau_out)</td></tr>
<tr class="separator:af5f3fa679301f0ead8b8155626b2e710"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf585c4bba33e85f0eb2f685c87b22a7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOptics.html#abf585c4bba33e85f0eb2f685c87b22a7">sample_cloud_optics_sw</a> (int ncol, int nlev, int ngpt, const int1d &amp;gpt2bnd, const real2d &amp;<a class="el" href="Modal__aero__wateruptake_8H.html#ab5bb37b4960757506d89345cedf81be6">pmid</a>, const real2d &amp;cld, const real2d &amp;cldfsnow, const real3d &amp;tau_bnd, const real3d &amp;ssa_bnd, const real3d &amp;asm_bnd, const real3d &amp;tau_gpt, const real3d &amp;ssa_gpt, const real3d &amp;asm_gpt)</td></tr>
<tr class="separator:abf585c4bba33e85f0eb2f685c87b22a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4a9d3efc9d464090f9a803bdab51ca1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOptics.html#aa4a9d3efc9d464090f9a803bdab51ca1">sample_cloud_optics_lw</a> (int ncol, int nlev, int ngpt, const int1d &amp;gpt2bnd, const real2d &amp;<a class="el" href="Modal__aero__wateruptake_8H.html#ab5bb37b4960757506d89345cedf81be6">pmid</a>, const real2d &amp;cld, const real2d &amp;cldfsnow, const real3d &amp;tau_bnd, const real3d &amp;tau_gpt)</td></tr>
<tr class="separator:aa4a9d3efc9d464090f9a803bdab51ca1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54463b4d74c22934fcbf36a7c95f0b3f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOptics.html#a54463b4d74c22934fcbf36a7c95f0b3f">set_aerosol_optics_sw</a> (int icall, int ncol, int nlev, int nswbands, real dt, const int1d &amp;night_indices, bool is_cmip6_volc, const real3d &amp;tau_out, const real3d &amp;ssa_out, const real3d &amp;asm_out, const real2d &amp;clear_rh)</td></tr>
<tr class="separator:a54463b4d74c22934fcbf36a7c95f0b3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecf608be7db530dc74beb0a03b2279f2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOptics.html#aecf608be7db530dc74beb0a03b2279f2">set_aerosol_optics_lw</a> (int icall, real dt, bool is_cmip6_volc, const real2d &amp;zi, const real3d &amp;tau, const real2d &amp;clear_rh)</td></tr>
<tr class="separator:aecf608be7db530dc74beb0a03b2279f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a078568b5fcba367944981fe065623e0c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOptics.html#a078568b5fcba367944981fe065623e0c">mcica_subcol_mask</a> (int ngpt, int ncol, int nlev, const real2d &amp;cldfrac, const bool3d &amp;iscloudy)</td></tr>
<tr class="separator:a078568b5fcba367944981fe065623e0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cbf46804754b07ab0ccf03e6db25207"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOptics.html#a6cbf46804754b07ab0ccf03e6db25207">combine_properties</a> (int nbands, int ncols, int nlevs, const real2d &amp;fraction1, const real3d &amp;property1, const real2d &amp;fraction2, const real3d &amp;property2, const real3d &amp;combined_property)</td></tr>
<tr class="separator:a6cbf46804754b07ab0ccf03e6db25207"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2472dd458109b58bc71cc44f57ff02f9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOptics.html#a2472dd458109b58bc71cc44f57ff02f9">initialize</a> (int <a class="el" href="classOptics.html#abb94e5d9dc89e539796740c6f0b9a229">ngas</a>, int <a class="el" href="Modal__aero__wateruptake_8H.html#a2292459107069ccc3da4140e6c360cff">nmodes</a>, int num_aeros, int nswbands, int nlwbands, int ncol, int nlev, int nrh, int top_lev, const std::vector&lt; std::string &gt; &amp;aero_names, const real2d &amp;zi, const real2d &amp;<a class="el" href="Modal__aero__wateruptake_8H.html#ab5bb37b4960757506d89345cedf81be6">pmid</a>, const real2d &amp;temp, const real2d &amp;qi, const real2d &amp;geom_radius)</td></tr>
<tr class="separator:a2472dd458109b58bc71cc44f57ff02f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad044034219080c4d8bc696c4c259cb4d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOptics.html#ad044034219080c4d8bc696c4c259cb4d">finalize</a> ()</td></tr>
<tr class="separator:ad044034219080c4d8bc696c4c259cb4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:abb94e5d9dc89e539796740c6f0b9a229"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOptics.html#abb94e5d9dc89e539796740c6f0b9a229">ngas</a></td></tr>
<tr class="separator:abb94e5d9dc89e539796740c6f0b9a229"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba268b2221309fdc437349b1427c5c6d"><td class="memItemLeft" align="right" valign="top">char **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOptics.html#aba268b2221309fdc437349b1427c5c6d">gas_names</a></td></tr>
<tr class="separator:aba268b2221309fdc437349b1427c5c6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a357f26f1bf42c917131a48782732ce03"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOptics.html#a357f26f1bf42c917131a48782732ce03">icecldoptics</a></td></tr>
<tr class="separator:a357f26f1bf42c917131a48782732ce03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87abc901496b039c596eed89b297a679"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOptics.html#a87abc901496b039c596eed89b297a679">liqcldoptics</a></td></tr>
<tr class="separator:a87abc901496b039c596eed89b297a679"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90c700e69b63c61c6275b12c63033334"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classCloudRadProps.html">CloudRadProps</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOptics.html#a90c700e69b63c61c6275b12c63033334">cloud_optics</a></td></tr>
<tr class="separator:a90c700e69b63c61c6275b12c63033334"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2153b2cf09af64100464587e8afb6d8f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classAerRadProps.html">AerRadProps</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOptics.html#a2153b2cf09af64100464587e8afb6d8f">aero_optics</a></td></tr>
<tr class="separator:a2153b2cf09af64100464587e8afb6d8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a3ec67cc89ceb33196552b89616728040"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ec67cc89ceb33196552b89616728040">&#9670;&nbsp;</a></span>Optics() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Optics::Optics </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">default</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aadaf34955cffcf141d182624b38f7898"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aadaf34955cffcf141d182624b38f7898">&#9670;&nbsp;</a></span>Optics() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Optics::Optics </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ngases</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>gas_names</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ae33a3d262417ad9bb96adc3a32519e5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae33a3d262417ad9bb96adc3a32519e5f">&#9670;&nbsp;</a></span>~Optics()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Optics::~Optics </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">default</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a6cbf46804754b07ab0ccf03e6db25207"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cbf46804754b07ab0ccf03e6db25207">&#9670;&nbsp;</a></span>combine_properties()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Optics::combine_properties </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nbands</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ncols</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlevs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>fraction1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>property1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>fraction2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>property2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>combined_property</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                                                                 {</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      <span class="comment">// Combined fraction (max of property 1 and 2)</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      real2d combined_fraction(<span class="stringliteral">&quot;combined_fraction&quot;</span>, ncols,nlevs);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      <span class="comment">// Combined fraction</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      parallel_for(SimpleBounds&lt;2&gt;(ncols, nlevs), YAKL_LAMBDA (<span class="keywordtype">int</span> icol, <span class="keywordtype">int</span> ilev) {</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;         combined_fraction(icol, ilev) = std::max(fraction1(icol, ilev), fraction2(icol, ilev));</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      });</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      <span class="comment">// Combine optical properties by weighting by amount of cloud and snow</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      yakl::memset(combined_property, 0.);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      parallel_for(SimpleBounds&lt;3&gt;(nlevs, ncols, nbands), YAKL_LAMBDA (<span class="keywordtype">int</span> ilev, <span class="keywordtype">int</span> icol, <span class="keywordtype">int</span> iband) {</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;         <span class="keywordflow">if</span> (combined_fraction(icol,ilev) &gt; 0) {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;              combined_property(iband,icol,ilev) = (</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                fraction1(icol,ilev) * property1(iband,icol,ilev)</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                + fraction2(icol,ilev) * property2(iband,icol,ilev)</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;              ) / combined_fraction(icol,ilev);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;         }</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;     });</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classOptics.html#af5f3fa679301f0ead8b8155626b2e710">get_cloud_optics_lw()</a>, and <a class="el" href="classOptics.html#aee82856b88240c428aefc6f47bf9500c">get_cloud_optics_sw()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classOptics_a6cbf46804754b07ab0ccf03e6db25207_icgraph.png" border="0" usemap="#aclassOptics_a6cbf46804754b07ab0ccf03e6db25207_icgraph" alt=""/></div>
<map name="aclassOptics_a6cbf46804754b07ab0ccf03e6db25207_icgraph" id="aclassOptics_a6cbf46804754b07ab0ccf03e6db25207_icgraph">
<area shape="rect" title=" " alt="" coords="259,31,459,57"/>
<area shape="rect" href="classOptics.html#af5f3fa679301f0ead8b8155626b2e710" title=" " alt="" coords="7,5,209,32"/>
<area shape="rect" href="classOptics.html#aee82856b88240c428aefc6f47bf9500c" title=" " alt="" coords="5,56,211,83"/>
</map>
</div>

</div>
</div>
<a id="ad044034219080c4d8bc696c4c259cb4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad044034219080c4d8bc696c4c259cb4d">&#9670;&nbsp;</a></span>finalize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Optics::finalize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;                      {</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;   <span class="comment">// nothing needs to be done here</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af5f3fa679301f0ead8b8155626b2e710"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5f3fa679301f0ead8b8155626b2e710">&#9670;&nbsp;</a></span>get_cloud_optics_lw()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Optics::get_cloud_optics_lw </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ncol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nbnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>do_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>cld</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>cldfsnow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>iclwp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>iciwp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>icswp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>lambdac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>mu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>dei</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>des</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>rei</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>tau_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>liq_tau_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>ice_tau_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>snw_tau_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                                                                                                                                    {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <span class="comment">// Temporary variables to hold absorption optical depth</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      real3d ice_tau(<span class="stringliteral">&quot;ice_tau&quot;</span>, nbnd, ncol, nlev);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      real3d liq_tau(<span class="stringliteral">&quot;liq_tau&quot;</span>, nbnd, ncol, nlev);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      real3d snow_tau(<span class="stringliteral">&quot;snow_tau&quot;</span>, nbnd, ncol, nlev);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      real3d cld_tau(<span class="stringliteral">&quot;cld_tau&quot;</span>, nbnd, ncol, nlev);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      real3d combined_tau(<span class="stringliteral">&quot;combined_tau&quot;</span>, nbnd, ncol, nlev);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="comment">// Initialize outputs</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      yakl::memset(tau_out, 0.);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      yakl::memset(liq_tau_out, 0.);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      yakl::memset(ice_tau_out, 0.);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      yakl::memset(snw_tau_out, 0.);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      <span class="comment">// Initialize local variables</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      yakl::memset(ice_tau, 0.);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      yakl::memset(liq_tau, 0.);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      yakl::memset(snow_tau, 0.);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      yakl::memset(cld_tau, 0.);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      yakl::memset(combined_tau, 0.);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <span class="comment">// Get ice optics</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classOptics.html#a357f26f1bf42c917131a48782732ce03">icecldoptics</a> == <span class="stringliteral">&quot;mitchell&quot;</span>) {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;         <a class="code" href="classOptics.html#a90c700e69b63c61c6275b12c63033334">cloud_optics</a>.<a class="code" href="classCloudRadProps.html#a1ab01da075a2a82b9fb4c341ff85e373">mitchell_ice_optics_lw</a>(ncol, nlev, iciwp, dei, ice_tau);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      }</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classOptics.html#a357f26f1bf42c917131a48782732ce03">icecldoptics</a> == <span class="stringliteral">&quot;ebertcurry&quot;</span>) {</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;         <a class="code" href="classEbertCurry.html#ae258a04b9aaba9ca0052793a2d57f05e">EbertCurry::ec_ice_optics_lw</a>(ncol, nlev, nbnd, cld, iclwp, iciwp, rei, ice_tau);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      }</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      <span class="comment">// Get liquid optics</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classOptics.html#a87abc901496b039c596eed89b297a679">liqcldoptics</a> == <span class="stringliteral">&quot;gammadist&quot;</span>) {</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;         <a class="code" href="classOptics.html#a90c700e69b63c61c6275b12c63033334">cloud_optics</a>.<a class="code" href="classCloudRadProps.html#a31a396f1997438a7cbb347767dca311a">gammadist_liq_optics_lw</a>(ncol, nlev, iclwp, lambdac, mu, liq_tau);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      }</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classOptics.html#a87abc901496b039c596eed89b297a679">liqcldoptics</a> == <span class="stringliteral">&quot;slingo&quot;</span>) {</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;         <a class="code" href="classSlingo.html#aedbfc95f917b864354b84a9a78d74c94">Slingo::slingo_liq_optics_lw</a>(ncol, nlev, nbnd, cld, iclwp, iciwp, liq_tau);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      }</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      <span class="comment">// Combined cloud optics</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      parallel_for(SimpleBounds&lt;3&gt;(nbnd, ncol, nlev), YAKL_LAMBDA (<span class="keywordtype">int</span> ibnd, <span class="keywordtype">int</span> icol, <span class="keywordtype">int</span> ilev) {</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;          cld_tau(ibnd, icol, ilev) = liq_tau(ibnd, icol, ilev) + ice_tau(ibnd, icol, ilev);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;       });</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      <span class="comment">// Get snow optics?</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      <span class="keywordflow">if</span> (do_snow) {</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;         <a class="code" href="classOptics.html#a90c700e69b63c61c6275b12c63033334">cloud_optics</a>.<a class="code" href="classCloudRadProps.html#a1ab01da075a2a82b9fb4c341ff85e373">mitchell_ice_optics_lw</a>(ncol, nlev, icswp, des, snow_tau);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;         <a class="code" href="classOptics.html#a6cbf46804754b07ab0ccf03e6db25207">combine_properties</a>(nbnd, ncol, nlev,</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                            cld, cld_tau, cldfsnow, snow_tau, combined_tau);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      }</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;         parallel_for(SimpleBounds&lt;3&gt;(nbnd, ncol, nlev), YAKL_LAMBDA (<span class="keywordtype">int</span> ibnd, <span class="keywordtype">int</span> icol, <span class="keywordtype">int</span> ilev) {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            combined_tau(ibnd,icol,ilev) = cld_tau(ibnd,icol,ilev);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;         });</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      }</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      <span class="comment">// Set output optics</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      parallel_for(SimpleBounds&lt;3&gt;(nbnd, ncol, nlev), YAKL_LAMBDA (<span class="keywordtype">int</span> ibnd, <span class="keywordtype">int</span> icol, <span class="keywordtype">int</span> ilev) {</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;         tau_out(icol,ilev,ibnd) = combined_tau(ibnd,icol,ilev);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;         liq_tau_out(icol,ilev,ibnd) = liq_tau(ibnd,icol,ilev);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;         ice_tau_out(icol,ilev,ibnd) = ice_tau(ibnd,icol,ilev);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;         snw_tau_out(icol,ilev,ibnd) = snow_tau(ibnd,icol,ilev);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;     });</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  }</div>
<div class="ttc" id="aclassCloudRadProps_html_a1ab01da075a2a82b9fb4c341ff85e373"><div class="ttname"><a href="classCloudRadProps.html#a1ab01da075a2a82b9fb4c341ff85e373">CloudRadProps::mitchell_ice_optics_lw</a></div><div class="ttdeci">void mitchell_ice_optics_lw(const int &amp;ncol, const int &amp;nlev, const real2d &amp;iciwpth, const real2d &amp;dei, real3d &amp;abs_od)</div><div class="ttdef"><b>Definition:</b> Cloud_rad_props.cpp:201</div></div>
<div class="ttc" id="aclassCloudRadProps_html_a31a396f1997438a7cbb347767dca311a"><div class="ttname"><a href="classCloudRadProps.html#a31a396f1997438a7cbb347767dca311a">CloudRadProps::gammadist_liq_optics_lw</a></div><div class="ttdeci">void gammadist_liq_optics_lw(const int &amp;ncol, const int &amp;nlev, const real2d &amp;iclwpth, const real2d &amp;lamc, const real2d &amp;pgam, real3d &amp;abs_od)</div><div class="ttdef"><b>Definition:</b> Cloud_rad_props.cpp:122</div></div>
<div class="ttc" id="aclassEbertCurry_html_ae258a04b9aaba9ca0052793a2d57f05e"><div class="ttname"><a href="classEbertCurry.html#ae258a04b9aaba9ca0052793a2d57f05e">EbertCurry::ec_ice_optics_lw</a></div><div class="ttdeci">static void ec_ice_optics_lw(int ncol, int nlev, int nlwbands, const real2d &amp;cldn, const real2d &amp;iclwpth, const real2d &amp;iciwpth, const real2d &amp;rei, const real3d &amp;abs_od)</div><div class="ttdef"><b>Definition:</b> Ebert_curry.H:114</div></div>
<div class="ttc" id="aclassOptics_html_a357f26f1bf42c917131a48782732ce03"><div class="ttname"><a href="classOptics.html#a357f26f1bf42c917131a48782732ce03">Optics::icecldoptics</a></div><div class="ttdeci">std::string icecldoptics</div><div class="ttdef"><b>Definition:</b> Optics.H:90</div></div>
<div class="ttc" id="aclassOptics_html_a6cbf46804754b07ab0ccf03e6db25207"><div class="ttname"><a href="classOptics.html#a6cbf46804754b07ab0ccf03e6db25207">Optics::combine_properties</a></div><div class="ttdeci">void combine_properties(int nbands, int ncols, int nlevs, const real2d &amp;fraction1, const real3d &amp;property1, const real2d &amp;fraction2, const real3d &amp;property2, const real3d &amp;combined_property)</div><div class="ttdef"><b>Definition:</b> Optics.cpp:248</div></div>
<div class="ttc" id="aclassOptics_html_a87abc901496b039c596eed89b297a679"><div class="ttname"><a href="classOptics.html#a87abc901496b039c596eed89b297a679">Optics::liqcldoptics</a></div><div class="ttdeci">std::string liqcldoptics</div><div class="ttdef"><b>Definition:</b> Optics.H:91</div></div>
<div class="ttc" id="aclassOptics_html_a90c700e69b63c61c6275b12c63033334"><div class="ttname"><a href="classOptics.html#a90c700e69b63c61c6275b12c63033334">Optics::cloud_optics</a></div><div class="ttdeci">CloudRadProps cloud_optics</div><div class="ttdef"><b>Definition:</b> Optics.H:93</div></div>
<div class="ttc" id="aclassSlingo_html_aedbfc95f917b864354b84a9a78d74c94"><div class="ttname"><a href="classSlingo.html#aedbfc95f917b864354b84a9a78d74c94">Slingo::slingo_liq_optics_lw</a></div><div class="ttdeci">static void slingo_liq_optics_lw(int ncol, int nlev, int nlwbands, const real2d &amp;cldn, const real2d &amp;iclwpth, const real2d &amp;iciwpth, const real3d &amp;abs_od)</div><div class="ttdef"><b>Definition:</b> Slingo.H:121</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classOptics_af5f3fa679301f0ead8b8155626b2e710_cgraph.png" border="0" usemap="#aclassOptics_af5f3fa679301f0ead8b8155626b2e710_cgraph" alt=""/></div>
<map name="aclassOptics_af5f3fa679301f0ead8b8155626b2e710_cgraph" id="aclassOptics_af5f3fa679301f0ead8b8155626b2e710_cgraph">
<area shape="rect" title=" " alt="" coords="5,123,208,149"/>
<area shape="rect" href="classOptics.html#a6cbf46804754b07ab0ccf03e6db25207" title=" " alt="" coords="257,5,457,32"/>
<area shape="rect" href="classEbertCurry.html#ae258a04b9aaba9ca0052793a2d57f05e" title=" " alt="" coords="288,57,427,98"/>
<area shape="rect" href="classCloudRadProps.html#a31a396f1997438a7cbb347767dca311a" title=" " alt="" coords="256,174,459,215"/>
<area shape="rect" href="classCloudRadProps.html#a1ab01da075a2a82b9fb4c341ff85e373" title=" " alt="" coords="712,111,893,153"/>
<area shape="rect" href="classSlingo.html#aedbfc95f917b864354b84a9a78d74c94" title=" " alt="" coords="291,239,423,281"/>
<area shape="rect" href="classCloudRadProps.html#a5772a63dc315f019d951785ebdb9c13d" title=" " alt="" coords="507,177,664,218"/>
<area shape="rect" href="classCloudRadProps.html#ab5a9764068553f94a590310ff990a97d" title=" " alt="" coords="721,177,885,218"/>
<area shape="rect" href="classLinInterp.html#adcd3fbce06341f370d0e7bcabb6a5e1c" title=" " alt="" coords="724,243,881,269"/>
<area shape="rect" href="classLinInterp.html#ae4ee554a1de89d9a85319088f81288e1" title=" " alt="" coords="958,123,1066,149"/>
<area shape="rect" href="classLinInterp.html#aad318a6d1364e9369ea02fe34542de24" title=" " alt="" coords="941,177,1083,204"/>
<area shape="rect" href="Modal__aero__wateruptake_8H.html#a19bf99811489ee1186302d8c72e52daa" title=" " alt="" coords="1131,123,1169,149"/>
</map>
</div>

</div>
</div>
<a id="aee82856b88240c428aefc6f47bf9500c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee82856b88240c428aefc6f47bf9500c">&#9670;&nbsp;</a></span>get_cloud_optics_sw()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Optics::get_cloud_optics_sw </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ncol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nbnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>do_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>cld</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>cldfsnow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>iclwp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>iciwp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>icswp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>lambdac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>mu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>dei</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>des</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>rel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>rei</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>tau_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>ssa_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>asm_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>liq_tau_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>ice_tau_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>snw_tau_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;                                                                                          {</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;      <span class="comment">//Temporary variables to hold cloud optical properties before combining into</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;      <span class="comment">// output arrays. Same shape as output arrays, so get shapes from output.</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;      real3d liq_tau(<span class="stringliteral">&quot;liq_tau&quot;</span>,nbnd, ncol, nlev);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;      real3d liq_tau_ssa(<span class="stringliteral">&quot;liq_tau_ssa&quot;</span>,nbnd, ncol, nlev);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;      real3d liq_tau_ssa_g(<span class="stringliteral">&quot;liq_tau_ssa_g&quot;</span>, nbnd, ncol, nlev);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;      real3d liq_tau_ssa_f(<span class="stringliteral">&quot;liq_tau_ssa_f&quot;</span>, nbnd, ncol, nlev);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;      real3d ice_tau(<span class="stringliteral">&quot;ice_tau&quot;</span>, nbnd, ncol, nlev);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;      real3d ice_tau_ssa(<span class="stringliteral">&quot;ice_tau_ssa&quot;</span>, nbnd, ncol, nlev);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;      real3d ice_tau_ssa_g(<span class="stringliteral">&quot;ice_tau_ssa_g&quot;</span>, nbnd, ncol, nlev);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      real3d ice_tau_ssa_f(<span class="stringliteral">&quot;ice_tau_ssa_f&quot;</span>, nbnd, ncol, nlev);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      real3d cld_tau(<span class="stringliteral">&quot;cld_tau&quot;</span>, nbnd, ncol, nlev);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      real3d cld_tau_ssa(<span class="stringliteral">&quot;cld_tau_ssa&quot;</span>, nbnd, ncol, nlev);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      real3d cld_tau_ssa_g(<span class="stringliteral">&quot;cld_tau_ssa_g&quot;</span>, nbnd, ncol, nlev);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      real3d cld_tau_ssa_f(<span class="stringliteral">&quot;cld_tau_ssa_f&quot;</span>, nbnd, ncol, nlev);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      real3d snow_tau(<span class="stringliteral">&quot;snow_tau&quot;</span>, nbnd, ncol, nlev );</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      real3d snow_tau_ssa(<span class="stringliteral">&quot;snow_tau_ssa&quot;</span>, nbnd, ncol, nlev);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      real3d snow_tau_ssa_g(<span class="stringliteral">&quot;snow_tau_ssa_g&quot;</span>, nbnd, ncol, nlev);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      real3d snow_tau_ssa_f(<span class="stringliteral">&quot;snow_tau_ssa_f&quot;</span>, nbnd, ncol, nlev);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      real3d combined_tau(<span class="stringliteral">&quot;combined_tau&quot;</span>, nbnd, ncol, nlev);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      real3d combined_tau_ssa(<span class="stringliteral">&quot;combined_tau_ssa&quot;</span>, nbnd, ncol, nlev);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      real3d combined_tau_ssa_g(<span class="stringliteral">&quot;combined_tau_ssa_g&quot;</span>, nbnd, ncol, nlev);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      real3d combined_tau_ssa_f(<span class="stringliteral">&quot;combined_tau_ssa_f&quot;</span>, nbnd, ncol, nlev);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      <span class="comment">// Initialize outputs</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      yakl::memset(tau_out, 0.);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      yakl::memset(ssa_out, 0.);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      yakl::memset(asm_out, 0.);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      yakl::memset(liq_tau_out, 0.);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      yakl::memset(ice_tau_out, 0.);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      yakl::memset(snw_tau_out, 0.);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      <span class="comment">// Initialize local variables</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      yakl::memset(ice_tau, 0.);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      yakl::memset(ice_tau_ssa, 0.);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      yakl::memset(ice_tau_ssa_g, 0.);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      yakl::memset(ice_tau_ssa_f, 0.);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      yakl::memset(liq_tau, 0.);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      yakl::memset(liq_tau_ssa, 0.);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      yakl::memset(liq_tau_ssa_g, 0.);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      yakl::memset(liq_tau_ssa_f, 0.);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      yakl::memset(snow_tau, 0.);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      yakl::memset(snow_tau_ssa, 0.);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      yakl::memset(snow_tau_ssa_g, 0.);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      yakl::memset(snow_tau_ssa_f, 0.);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      yakl::memset(combined_tau, 0.);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      yakl::memset(combined_tau_ssa, 0.);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      yakl::memset(combined_tau_ssa_g, 0.);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      yakl::memset(combined_tau_ssa_f, 0.);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      <span class="comment">// Get ice cloud optics</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classOptics.html#a357f26f1bf42c917131a48782732ce03">icecldoptics</a> == <span class="stringliteral">&quot;mitchell&quot;</span>) {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;         <a class="code" href="classOptics.html#a90c700e69b63c61c6275b12c63033334">cloud_optics</a>.<a class="code" href="classCloudRadProps.html#a32483def8d0d82a6d1cb57834fe04b7d">mitchell_ice_optics_sw</a>(</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            ncol, nlev, iciwp, dei,</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            ice_tau, ice_tau_ssa,</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            ice_tau_ssa_g, ice_tau_ssa_f);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      }</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classOptics.html#a357f26f1bf42c917131a48782732ce03">icecldoptics</a> == <span class="stringliteral">&quot;ebertcurry&quot;</span>) {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;         <a class="code" href="classEbertCurry.html#aed435ba6c3e2c62f6ba2d8111c7c2f08">EbertCurry::ec_ice_optics_sw</a>(ncol, nlev, nbnd, cld, iciwp, rei, ice_tau, ice_tau_ssa, ice_tau_ssa_g, ice_tau_ssa_f);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      <span class="comment">// Get liquid cloud optics</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classOptics.html#a87abc901496b039c596eed89b297a679">liqcldoptics</a> == <span class="stringliteral">&quot;gammadist&quot;</span>) {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;         <a class="code" href="classOptics.html#a90c700e69b63c61c6275b12c63033334">cloud_optics</a>.<a class="code" href="classCloudRadProps.html#adcaf1c142347cdcd3b761af9c7ee5c56">gammadist_liq_optics_sw</a>(</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            ncol, nlev, iclwp, lambdac, mu,</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            liq_tau, liq_tau_ssa,</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            liq_tau_ssa_g, liq_tau_ssa_f);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      }</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classOptics.html#a87abc901496b039c596eed89b297a679">liqcldoptics</a> == <span class="stringliteral">&quot;slingo&quot;</span>) {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;         <a class="code" href="classSlingo.html#ab37f1c288e0dcc71337629a65fb65e17">Slingo::slingo_liq_optics_sw</a>(</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            ncol, nlev, nbnd, cld, iclwp, rel,</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            liq_tau, liq_tau_ssa,</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;            liq_tau_ssa_g, liq_tau_ssa_f);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      }</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      <span class="comment">// Get snow cloud optics</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      <span class="keywordflow">if</span> (do_snow) {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;         <a class="code" href="classOptics.html#a90c700e69b63c61c6275b12c63033334">cloud_optics</a>.<a class="code" href="classCloudRadProps.html#a32483def8d0d82a6d1cb57834fe04b7d">mitchell_ice_optics_sw</a>(</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            ncol, nlev, icswp, des,</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            snow_tau, snow_tau_ssa,</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            snow_tau_ssa_g, snow_tau_ssa_f);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      }</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;         <span class="comment">// We are not doing snow optics, so set these to zero so we can still use</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;         <span class="comment">// the arrays without additional logic</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;         yakl::memset(snow_tau, 0.);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;         yakl::memset(snow_tau_ssa, 0.);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;         yakl::memset(snow_tau_ssa_g, 0.);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;         yakl::memset(snow_tau_ssa_f, 0.);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      }</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      <span class="comment">// Combine all cloud optics from CAM routines</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      parallel_for(SimpleBounds&lt;3&gt;(nbnd, ncol, nlev), YAKL_LAMBDA (<span class="keywordtype">int</span> ibnd, <span class="keywordtype">int</span> icol, <span class="keywordtype">int</span> ilev) {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;         cld_tau(ibnd, icol, ilev) = ice_tau(ibnd, icol, ilev) + liq_tau(ibnd, icol, ilev);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;         cld_tau_ssa(ibnd, icol, ilev) = ice_tau_ssa(ibnd, icol, ilev) + liq_tau_ssa(ibnd, icol, ilev);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;         cld_tau_ssa_g(ibnd, icol, ilev) = ice_tau_ssa_g(ibnd, icol, ilev) + liq_tau_ssa_g(ibnd, icol, ilev);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      });</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      <span class="keywordflow">if</span> (do_snow) {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;         <a class="code" href="classOptics.html#a6cbf46804754b07ab0ccf03e6db25207">combine_properties</a>( nbnd, ncol, nlev,</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            cld, cld_tau, cldfsnow, snow_tau, combined_tau);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;         <a class="code" href="classOptics.html#a6cbf46804754b07ab0ccf03e6db25207">combine_properties</a>( nbnd, ncol, nlev,</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            cld, cld_tau_ssa, cldfsnow, snow_tau_ssa, combined_tau_ssa);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;         <a class="code" href="classOptics.html#a6cbf46804754b07ab0ccf03e6db25207">combine_properties</a>( nbnd, ncol, nlev,</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            cld, cld_tau_ssa_g, cldfsnow, snow_tau_ssa_g, combined_tau_ssa_g);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      }</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        parallel_for(SimpleBounds&lt;3&gt;(nbnd, ncol, nlev), YAKL_LAMBDA (<span class="keywordtype">int</span> ibnd, <span class="keywordtype">int</span> icol, <span class="keywordtype">int</span> ilev) {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;           combined_tau(ibnd, icol, ilev) = cld_tau(ibnd, icol, ilev);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;           combined_tau_ssa(ibnd, icol, ilev) = cld_tau_ssa(ibnd, icol, ilev);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;           combined_tau_ssa_g(ibnd, icol, ilev) = cld_tau_ssa_g(ibnd, icol, ilev);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        });</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      }</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160; </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <span class="comment">// Copy to output arrays, converting to optical depth, single scattering</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      <span class="comment">// albedo, and assymmetry parameter from the products that the CAM routines</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      <span class="comment">// return. Make sure we do not try to divide by zero...</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      parallel_for(SimpleBounds&lt;3&gt;(nbnd, ncol, nlev), YAKL_LAMBDA (<span class="keywordtype">int</span> iband, <span class="keywordtype">int</span> icol, <span class="keywordtype">int</span> ilev) {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;          tau_out(icol,ilev,iband) = combined_tau(iband,icol,ilev);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;          <span class="keywordflow">if</span> (combined_tau(iband,icol,ilev) &gt; 0) {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;             ssa_out(icol,ilev,iband)</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                 = combined_tau_ssa(iband,icol,ilev) / combined_tau(iband,icol,ilev);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;          } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;             ssa_out(icol,ilev,iband) = 1.;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;          }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;          <span class="keywordflow">if</span> (combined_tau_ssa(iband,icol,ilev) &gt; 0) {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;             asm_out(icol,ilev,iband)</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                 = combined_tau_ssa_g(iband,icol,ilev) / combined_tau_ssa(iband,icol,ilev);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;          } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;             asm_out(icol,ilev,iband) = 0.;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;          }</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;          <span class="comment">// Re-order diagnostics outputs</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;          liq_tau_out(icol,ilev,iband) = liq_tau(iband,icol,ilev);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;          ice_tau_out(icol,ilev,iband) = ice_tau(iband,icol,ilev);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;          snw_tau_out(icol,ilev,iband) = snow_tau(iband,icol,ilev);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;     });</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; }</div>
<div class="ttc" id="aclassCloudRadProps_html_a32483def8d0d82a6d1cb57834fe04b7d"><div class="ttname"><a href="classCloudRadProps.html#a32483def8d0d82a6d1cb57834fe04b7d">CloudRadProps::mitchell_ice_optics_sw</a></div><div class="ttdeci">void mitchell_ice_optics_sw(const int &amp;ncol, const int &amp;nlev, const real2d &amp;iciwpth, const real2d &amp;dei, real3d &amp;tau, real3d &amp;tau_w, real3d &amp;tau_w_g, real3d &amp;tau_w_f)</div><div class="ttdef"><b>Definition:</b> Cloud_rad_props.cpp:141</div></div>
<div class="ttc" id="aclassCloudRadProps_html_adcaf1c142347cdcd3b761af9c7ee5c56"><div class="ttname"><a href="classCloudRadProps.html#adcaf1c142347cdcd3b761af9c7ee5c56">CloudRadProps::gammadist_liq_optics_sw</a></div><div class="ttdeci">void gammadist_liq_optics_sw(const int &amp;ncol, const int &amp;nlev, const real2d &amp;iclwpth, const real2d &amp;lamc, const real2d &amp;pgam, real3d &amp;tau, real3d &amp;tau_w, real3d &amp;tau_w_g, real3d &amp;tau_w_f)</div><div class="ttdef"><b>Definition:</b> Cloud_rad_props.cpp:87</div></div>
<div class="ttc" id="aclassEbertCurry_html_aed435ba6c3e2c62f6ba2d8111c7c2f08"><div class="ttname"><a href="classEbertCurry.html#aed435ba6c3e2c62f6ba2d8111c7c2f08">EbertCurry::ec_ice_optics_sw</a></div><div class="ttdeci">static void ec_ice_optics_sw(int ncol, int nlev, int nswbands, const real2d &amp;cldn, const real2d &amp;cicewp, const real2d &amp;rei, const real3d &amp;ice_tau, const real3d &amp;ice_tau_w, const real3d &amp;ice_tau_w_g, const real3d &amp;ice_tau_w_f)</div><div class="ttdef"><b>Definition:</b> Ebert_curry.H:11</div></div>
<div class="ttc" id="aclassSlingo_html_ab37f1c288e0dcc71337629a65fb65e17"><div class="ttname"><a href="classSlingo.html#ab37f1c288e0dcc71337629a65fb65e17">Slingo::slingo_liq_optics_sw</a></div><div class="ttdeci">static void slingo_liq_optics_sw(int ncol, int nlev, int nswbands, const real2d &amp;cldn, const real2d &amp;cliqwp, const real2d &amp;rel, const real3d &amp;liq_tau, const real3d &amp;liq_tau_w, const real3d &amp;liq_tau_w_g, const real3d &amp;liq_tau_w_f)</div><div class="ttdef"><b>Definition:</b> Slingo.H:12</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classOptics_aee82856b88240c428aefc6f47bf9500c_cgraph.png" border="0" usemap="#aclassOptics_aee82856b88240c428aefc6f47bf9500c_cgraph" alt=""/></div>
<map name="aclassOptics_aee82856b88240c428aefc6f47bf9500c_cgraph" id="aclassOptics_aee82856b88240c428aefc6f47bf9500c_cgraph">
<area shape="rect" title=" " alt="" coords="5,129,211,156"/>
<area shape="rect" href="classOptics.html#a6cbf46804754b07ab0ccf03e6db25207" title=" " alt="" coords="260,5,460,32"/>
<area shape="rect" href="classEbertCurry.html#aed435ba6c3e2c62f6ba2d8111c7c2f08" title=" " alt="" coords="291,122,429,163"/>
<area shape="rect" href="classCloudRadProps.html#adcaf1c142347cdcd3b761af9c7ee5c56" title=" " alt="" coords="259,239,461,281"/>
<area shape="rect" href="classCloudRadProps.html#a32483def8d0d82a6d1cb57834fe04b7d" title=" " alt="" coords="724,177,905,218"/>
<area shape="rect" href="classSlingo.html#ab37f1c288e0dcc71337629a65fb65e17" title=" " alt="" coords="294,57,426,98"/>
<area shape="rect" href="Modal__aero__wateruptake_8H.html#aa57b04e686127acffb20d2467a813542" title=" " alt="" coords="568,67,617,93"/>
<area shape="rect" href="classRadConstants.html#a7d32f7699c2933c60da5163952bfc4cb" title=" " alt="" coords="509,119,676,161"/>
<area shape="rect" href="classCloudRadProps.html#a2890fa11a8f395809fe215447e339c20" title=" " alt="" coords="514,242,671,283"/>
<area shape="rect" href="classCloudRadProps.html#ab5a9764068553f94a590310ff990a97d" title=" " alt="" coords="733,242,897,283"/>
<area shape="rect" href="classLinInterp.html#adcd3fbce06341f370d0e7bcabb6a5e1c" title=" " alt="" coords="736,308,893,335"/>
<area shape="rect" href="classLinInterp.html#ae4ee554a1de89d9a85319088f81288e1" title=" " alt="" coords="970,188,1078,215"/>
<area shape="rect" href="classLinInterp.html#aad318a6d1364e9369ea02fe34542de24" title=" " alt="" coords="953,243,1095,269"/>
<area shape="rect" href="Modal__aero__wateruptake_8H.html#a19bf99811489ee1186302d8c72e52daa" title=" " alt="" coords="1143,188,1181,215"/>
</map>
</div>

</div>
</div>
<a id="a2472dd458109b58bc71cc44f57ff02f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2472dd458109b58bc71cc44f57ff02f9">&#9670;&nbsp;</a></span>initialize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Optics::initialize </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ngas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nmodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num_aeros</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nswbands</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlwbands</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ncol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>top_lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>aero_names</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>zi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>pmid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>temp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>qi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>geom_radius</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;                                                                     {</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;   <a class="code" href="classOptics.html#a90c700e69b63c61c6275b12c63033334">cloud_optics</a>.<a class="code" href="classCloudRadProps.html#ac733936ee2d3e88f07631b30fc5758ef">initialize</a>();</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;   <a class="code" href="classOptics.html#a2153b2cf09af64100464587e8afb6d8f">aero_optics</a>.<a class="code" href="classAerRadProps.html#a4d708a6b6284e41f8dce29444416c810">initialize</a>(<a class="code" href="classOptics.html#abb94e5d9dc89e539796740c6f0b9a229">ngas</a>, <a class="code" href="Modal__aero__wateruptake_8H.html#a2292459107069ccc3da4140e6c360cff">nmodes</a>, num_aeros,</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;                          nswbands, nlwbands, ncol, nlev, nrh, top_lev,</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;                          aero_names, zi, <a class="code" href="Modal__aero__wateruptake_8H.html#ab5bb37b4960757506d89345cedf81be6">pmid</a>, temp, qi, geom_radius);</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;}</div>
<div class="ttc" id="aModal__aero__wateruptake_8H_html_a2292459107069ccc3da4140e6c360cff"><div class="ttname"><a href="Modal__aero__wateruptake_8H.html#a2292459107069ccc3da4140e6c360cff">nmodes</a></div><div class="ttdeci">int nmodes</div><div class="ttdef"><b>Definition:</b> Modal_aero_wateruptake.H:306</div></div>
<div class="ttc" id="aModal__aero__wateruptake_8H_html_ab5bb37b4960757506d89345cedf81be6"><div class="ttname"><a href="Modal__aero__wateruptake_8H.html#ab5bb37b4960757506d89345cedf81be6">pmid</a></div><div class="ttdeci">real2d pmid(:,:)</div></div>
<div class="ttc" id="aclassAerRadProps_html_a4d708a6b6284e41f8dce29444416c810"><div class="ttname"><a href="classAerRadProps.html#a4d708a6b6284e41f8dce29444416c810">AerRadProps::initialize</a></div><div class="ttdeci">void initialize(int ngas_, int nmodes_, int num_aeros_, int nswbands_, int nlwbands_, int ncol_, int nlev_, int nrh_, int top_lev_, const std::vector&lt; std::string &gt; &amp;aero_names_, const real2d &amp;zi_, const real2d &amp;pmid_, const real2d &amp;temp_, const real2d &amp;qi_, const real2d &amp;geom_radius)</div><div class="ttdef"><b>Definition:</b> Aero_rad_props.cpp:12</div></div>
<div class="ttc" id="aclassCloudRadProps_html_ac733936ee2d3e88f07631b30fc5758ef"><div class="ttname"><a href="classCloudRadProps.html#ac733936ee2d3e88f07631b30fc5758ef">CloudRadProps::initialize</a></div><div class="ttdeci">void initialize()</div><div class="ttdef"><b>Definition:</b> Cloud_rad_props.cpp:9</div></div>
<div class="ttc" id="aclassOptics_html_a2153b2cf09af64100464587e8afb6d8f"><div class="ttname"><a href="classOptics.html#a2153b2cf09af64100464587e8afb6d8f">Optics::aero_optics</a></div><div class="ttdeci">AerRadProps aero_optics</div><div class="ttdef"><b>Definition:</b> Optics.H:94</div></div>
<div class="ttc" id="aclassOptics_html_abb94e5d9dc89e539796740c6f0b9a229"><div class="ttname"><a href="classOptics.html#abb94e5d9dc89e539796740c6f0b9a229">Optics::ngas</a></div><div class="ttdeci">int ngas</div><div class="ttdef"><b>Definition:</b> Optics.H:87</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classOptics_a2472dd458109b58bc71cc44f57ff02f9_cgraph.png" border="0" usemap="#aclassOptics_a2472dd458109b58bc71cc44f57ff02f9_cgraph" alt=""/></div>
<map name="aclassOptics_a2472dd458109b58bc71cc44f57ff02f9_cgraph" id="aclassOptics_a2472dd458109b58bc71cc44f57ff02f9_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,132,83"/>
<area shape="rect" href="classCloudRadProps.html#ac733936ee2d3e88f07631b30fc5758ef" title=" " alt="" coords="180,5,364,32"/>
<area shape="rect" href="classAerRadProps.html#a4d708a6b6284e41f8dce29444416c810" title=" " alt="" coords="187,56,357,83"/>
<area shape="rect" href="Modal__aero__wateruptake_8H.html#ab5bb37b4960757506d89345cedf81be6" title=" " alt="" coords="245,107,299,133"/>
<area shape="rect" href="classMam4__aer.html#ad26a9b5e3fc355d5102328b86621b8df" title=" " alt="" coords="412,56,567,83"/>
</map>
</div>

</div>
</div>
<a id="a078568b5fcba367944981fe065623e0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a078568b5fcba367944981fe065623e0c">&#9670;&nbsp;</a></span>mcica_subcol_mask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Optics::mcica_subcol_mask </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ngpt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ncol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>cldfrac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool3d &amp;&#160;</td>
          <td class="paramname"><em>iscloudy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                                                                              {</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;   <span class="comment">// Local vars</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;   <span class="keyword">const</span> real cldmin = 1.0e-80;      <span class="comment">// min cloud fraction</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;   real2d cldf(<span class="stringliteral">&quot;cldf&quot;</span>,ncol,nlev);    <span class="comment">// cloud fraction clipped to cldmin</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;   real3d cdf(<span class="stringliteral">&quot;cdf&quot;</span>, ngpt, ncol, nlev);   <span class="comment">// random numbers</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160; </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;   <span class="comment">// clip cloud fraction</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;   parallel_for(SimpleBounds&lt;2&gt;(ncol, nlev), YAKL_LAMBDA (<span class="keywordtype">int</span> icol, <span class="keywordtype">int</span> ilev) {</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      cldf(icol,ilev) = cldfrac(icol,ilev);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      <span class="keywordflow">if</span> (cldf(icol,ilev) &lt; cldmin) cldf(icol,ilev) = 0.;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;   });</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160; </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;   amrex::RandomEngine engine;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;   <span class="comment">// Generate random numbers in each subcolumn at every level</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    parallel_for(SimpleBounds&lt;3&gt;(ngpt, ncol, nlev), YAKL_LAMBDA (<span class="keywordtype">int</span> isubcol, <span class="keywordtype">int</span> icol, <span class="keywordtype">int</span> ilev) {</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      cdf(isubcol,icol,ilev) = amrex::Random(engine);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;   });</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;   <span class="comment">// Maximum-Random overlap</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;   <span class="comment">// i) pick a random number for top layer.</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;   <span class="comment">// ii) walk down the column:</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;   <span class="comment">//    - if the layer above is cloudy, use the same random number as in the layer above</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;   <span class="comment">//    - if the layer above is clear, use a new random number</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;   parallel_for(SimpleBounds&lt;3&gt;(nlev, ncol, ngpt), YAKL_LAMBDA (<span class="keywordtype">int</span> k, <span class="keywordtype">int</span> i, <span class="keywordtype">int</span> isubcol) {</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;     <span class="keywordflow">if</span> (k &gt; 1) {</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        <span class="keywordflow">if</span> (cdf(isubcol,i,k-1) &gt; 1. - cldf(i,k-1) ) {</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;           cdf(isubcol,i,k) = cdf(isubcol,i,k-1);</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;           cdf(isubcol,i,k) = cdf(isubcol,i,k) * (1. - cldf(i,k-1));</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        }</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        iscloudy(isubcol,i,k) = cdf(isubcol,i,k) &gt;= 1.-cldf(i,k) ? true : <span class="keyword">false</span>;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;     }</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;   });</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classOptics.html#aa4a9d3efc9d464090f9a803bdab51ca1">sample_cloud_optics_lw()</a>, and <a class="el" href="classOptics.html#abf585c4bba33e85f0eb2f685c87b22a7">sample_cloud_optics_sw()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classOptics_a078568b5fcba367944981fe065623e0c_icgraph.png" border="0" usemap="#aclassOptics_a078568b5fcba367944981fe065623e0c_icgraph" alt=""/></div>
<map name="aclassOptics_a078568b5fcba367944981fe065623e0c_icgraph" id="aclassOptics_a078568b5fcba367944981fe065623e0c_icgraph">
<area shape="rect" title=" " alt="" coords="215,46,417,73"/>
<area shape="rect" href="classOptics.html#aa4a9d3efc9d464090f9a803bdab51ca1" title=" " alt="" coords="5,5,167,47"/>
<area shape="rect" href="classOptics.html#abf585c4bba33e85f0eb2f685c87b22a7" title=" " alt="" coords="5,71,167,112"/>
</map>
</div>

</div>
</div>
<a id="aa4a9d3efc9d464090f9a803bdab51ca1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4a9d3efc9d464090f9a803bdab51ca1">&#9670;&nbsp;</a></span>sample_cloud_optics_lw()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Optics::sample_cloud_optics_lw </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ncol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ngpt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int1d &amp;&#160;</td>
          <td class="paramname"><em>gpt2bnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>pmid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>cld</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>cldfsnow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>tau_bnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>tau_gpt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                                                       {</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      <span class="comment">//real(r8), dimension(ncol,nlev) :: combined_cld</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      real2d combined_cld(<span class="stringliteral">&quot;combined_cld&quot;</span>, ncol, nlev);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      <span class="comment">//logical, dimension(ngpt,ncol,nlev) :: iscloudy</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      bool3d iscloudy(<span class="stringliteral">&quot;iscloudy&quot;</span>, ngpt, ncol, nlev);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      <span class="comment">// Combine cloud and snow fractions for MCICA sampling</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      parallel_for(SimpleBounds&lt;2&gt;(ncol, nlev), YAKL_LAMBDA (<span class="keywordtype">int</span> icol, <span class="keywordtype">int</span> ilev) {</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;          combined_cld(icol,ilev) = std::max(cld(icol,ilev), cldfsnow(icol,ilev));</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      });</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      <span class="comment">// Get the stochastic subcolumn cloudy mask</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      <a class="code" href="classOptics.html#a078568b5fcba367944981fe065623e0c">mcica_subcol_mask</a>(ngpt, ncol, nlev, combined_cld, iscloudy);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      <span class="comment">// Map optics to g-points, selecting a single subcolumn for each</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      <span class="comment">// g-point. This implementation generates homogeneous clouds, but it would be</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      <span class="comment">// straightforward to extend this to handle horizontally heterogeneous clouds</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      <span class="comment">// as well.</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      parallel_for(SimpleBounds&lt;3&gt;(ngpt, nlev, ncol), YAKL_LAMBDA (<span class="keywordtype">int</span> igpt, <span class="keywordtype">int</span> ilev, <span class="keywordtype">int</span> icol) {</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;         <span class="keywordflow">if</span> (iscloudy(igpt,icol,ilev) &amp;&amp; combined_cld(icol,ilev) &gt; 0.) {</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;             tau_gpt(icol,ilev,igpt) = tau_bnd(icol,ilev,gpt2bnd(igpt));</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;         } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            tau_gpt(icol,ilev,igpt) = 0.;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;         }</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      });</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; }</div>
<div class="ttc" id="aclassOptics_html_a078568b5fcba367944981fe065623e0c"><div class="ttname"><a href="classOptics.html#a078568b5fcba367944981fe065623e0c">Optics::mcica_subcol_mask</a></div><div class="ttdeci">void mcica_subcol_mask(int ngpt, int ncol, int nlev, const real2d &amp;cldfrac, const bool3d &amp;iscloudy)</div><div class="ttdef"><b>Definition:</b> Optics.cpp:409</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classOptics_aa4a9d3efc9d464090f9a803bdab51ca1_cgraph.png" border="0" usemap="#aclassOptics_aa4a9d3efc9d464090f9a803bdab51ca1_cgraph" alt=""/></div>
<map name="aclassOptics_aa4a9d3efc9d464090f9a803bdab51ca1_cgraph" id="aclassOptics_aa4a9d3efc9d464090f9a803bdab51ca1_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,167,47"/>
<area shape="rect" href="classOptics.html#a078568b5fcba367944981fe065623e0c" title=" " alt="" coords="215,13,417,39"/>
</map>
</div>

</div>
</div>
<a id="abf585c4bba33e85f0eb2f685c87b22a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf585c4bba33e85f0eb2f685c87b22a7">&#9670;&nbsp;</a></span>sample_cloud_optics_sw()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Optics::sample_cloud_optics_sw </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ncol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ngpt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int1d &amp;&#160;</td>
          <td class="paramname"><em>gpt2bnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>pmid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>cld</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>cldfsnow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>tau_bnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>ssa_bnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>asm_bnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>tau_gpt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>ssa_gpt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>asm_gpt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                                                                              {</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      <span class="comment">//real(r8), dimension(ncol,nlev) :: combined_cld</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      real2d combined_cld(<span class="stringliteral">&quot;combined_cld&quot;</span>, ncol, nlev);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160; </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      <span class="comment">//logical, dimension(ngpt,ncol,nlev) :: iscloudy</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      bool3d iscloudy(<span class="stringliteral">&quot;iscloudy&quot;</span>, ngpt, ncol, nlev);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      <span class="comment">// Combined snow and cloud fraction</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      parallel_for(SimpleBounds&lt;2&gt;(ncol, nlev), YAKL_LAMBDA (<span class="keywordtype">int</span> icol, <span class="keywordtype">int</span> ilev) {</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;          combined_cld(icol,ilev) = std::max(cld(icol,ilev), cldfsnow(icol,ilev));</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      });</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160; </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      <span class="comment">// Get stochastic subcolumn cloud mask</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      <a class="code" href="classOptics.html#a078568b5fcba367944981fe065623e0c">mcica_subcol_mask</a>(ngpt, ncol, nlev, combined_cld, iscloudy);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      <span class="comment">// Generate subcolumns for homogeneous clouds</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      parallel_for(SimpleBounds&lt;3&gt;(ngpt, nlev, ncol), YAKL_LAMBDA (<span class="keywordtype">int</span> igpt, <span class="keywordtype">int</span> ilev, <span class="keywordtype">int</span> icol) {</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;          <span class="keywordflow">if</span> (iscloudy(igpt,icol,ilev) &amp;&amp; combined_cld(icol,ilev) &gt; 0.) {</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;             tau_gpt(icol,ilev,igpt) = tau_bnd(icol,ilev,gpt2bnd(igpt));</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;             ssa_gpt(icol,ilev,igpt) = ssa_bnd(icol,ilev,gpt2bnd(igpt));</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;             asm_gpt(icol,ilev,igpt) = asm_bnd(icol,ilev,gpt2bnd(igpt));</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;          } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;             tau_gpt(icol,ilev,igpt) = 0.;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;             ssa_gpt(icol,ilev,igpt) = 1.;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;             asm_gpt(icol,ilev,igpt) = 0.;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;          }</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;     });</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; }</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classOptics_abf585c4bba33e85f0eb2f685c87b22a7_cgraph.png" border="0" usemap="#aclassOptics_abf585c4bba33e85f0eb2f685c87b22a7_cgraph" alt=""/></div>
<map name="aclassOptics_abf585c4bba33e85f0eb2f685c87b22a7_cgraph" id="aclassOptics_abf585c4bba33e85f0eb2f685c87b22a7_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,167,47"/>
<area shape="rect" href="classOptics.html#a078568b5fcba367944981fe065623e0c" title=" " alt="" coords="215,13,417,39"/>
</map>
</div>

</div>
</div>
<a id="aecf608be7db530dc74beb0a03b2279f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aecf608be7db530dc74beb0a03b2279f2">&#9670;&nbsp;</a></span>set_aerosol_optics_lw()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Optics::set_aerosol_optics_lw </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>icall</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>is_cmip6_volc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>zi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>clear_rh</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                                                        {</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;   <span class="comment">// Get aerosol absorption optical depth from CAM routine</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;   yakl::memset(tau, 0.);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;   <a class="code" href="classOptics.html#a2153b2cf09af64100464587e8afb6d8f">aero_optics</a>.<a class="code" href="classAerRadProps.html#a6aabfa89e9a9d91bae79c7a0d91f17b3">aer_rad_props_lw</a>(is_cmip6_volc, icall, dt, zi, tau, clear_rh);</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;}</div>
<div class="ttc" id="aclassAerRadProps_html_a6aabfa89e9a9d91bae79c7a0d91f17b3"><div class="ttname"><a href="classAerRadProps.html#a6aabfa89e9a9d91bae79c7a0d91f17b3">AerRadProps::aer_rad_props_lw</a></div><div class="ttdeci">void aer_rad_props_lw(const bool &amp;is_cmip6_volc, const int &amp;list_idx, const real &amp;dt, const real2d &amp;zi, const real3d &amp;odap_aer, const real2d &amp;clear_rh)</div><div class="ttdef"><b>Definition:</b> Aero_rad_props.cpp:299</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classOptics_aecf608be7db530dc74beb0a03b2279f2_cgraph.png" border="0" usemap="#aclassOptics_aecf608be7db530dc74beb0a03b2279f2_cgraph" alt=""/></div>
<map name="aclassOptics_aecf608be7db530dc74beb0a03b2279f2_cgraph" id="aclassOptics_aecf608be7db530dc74beb0a03b2279f2_cgraph">
<area shape="rect" title=" " alt="" coords="5,1448,152,1490"/>
<area shape="rect" href="classAerRadProps.html#a6aabfa89e9a9d91bae79c7a0d91f17b3" title=" " alt="" coords="200,1448,363,1490"/>
<area shape="rect" href="Modal__aero__wateruptake_8H.html#a8a0c0dddc4a8389a14e6906b55d7cacf" title=" " alt="" coords="1436,561,1475,588"/>
<area shape="rect" href="classMamConstituents.html#aaaf1541dee704eca0b0186f75457e49b" title=" " alt="" coords="427,1350,593,1391"/>
<area shape="rect" href="classMamConstituents.html#a66c3525ddc3b20a3a9dba2d7dc5020f8" title=" " alt="" coords="427,1415,593,1456"/>
<area shape="rect" href="classMamConstituents.html#aa268eea91939bf42c29685aa43138d15" title=" " alt="" coords="427,1480,593,1522"/>
<area shape="rect" href="classMamConstituents.html#a278b01dd1df95acd2ad6a5c800caf719" title=" " alt="" coords="427,1546,593,1587"/>
<area shape="rect" href="classMamConstituents.html#ac0d794c0c89d7f87e444fc10e4ca76b6" title=" " alt="" coords="427,1611,593,1652"/>
<area shape="rect" href="classMamConstituents.html#abd92c92743d51efe2f17e68cbfaccee1" title=" " alt="" coords="427,1676,593,1718"/>
<area shape="rect" href="classMamConstituents.html#a5de90eaa3b6d493a7b12ce7df766fa6f" title=" " alt="" coords="427,1742,593,1783"/>
<area shape="rect" href="classMam4__aer.html#a9721da0af2c6b65da92a81c76f3bf43d" title=" " alt="" coords="411,1226,609,1253"/>
<area shape="rect" href="Modal__aero__wateruptake_8H.html#a732deb0c6f95544c2c323749f227bbd6" title=" " alt="" coords="990,957,1029,984"/>
<area shape="rect" href="classWaterVaporSat.html#a4dac5d0ff52b333add64a13539fca1c8" title=" " alt="" coords="433,789,587,816"/>
<area shape="rect" href="Modal__aero__wateruptake_8H.html#a352bc71b7a47b331f4f6b71b09e0401d" title=" " alt="" coords="491,1808,529,1834"/>
<area shape="rect" href="classPhysProp.html#a6d68ef1925d5f6b671c9f19012e03ee0" title=" " alt="" coords="679,1409,842,1436"/>
<area shape="rect" href="classPhysProp.html#a6e676bbfdadc5ca4317c868826168bf7" title=" " alt="" coords="657,1460,864,1486"/>
<area shape="rect" href="classPhysProp.html#ac78ce456f60120096570085d96025467" title=" " alt="" coords="691,1510,830,1537"/>
<area shape="rect" href="classPhysProp.html#a2e6aa40659bebbb92eff36707e84dbeb" title=" " alt="" coords="667,1561,854,1588"/>
<area shape="rect" href="classPhysProp.html#a4229d0c1f2685db59d5a233c51b86913" title=" " alt="" coords="673,1618,848,1645"/>
<area shape="rect" href="classMam4__aer.html#a1488790796a5a153be55af7d9a64d36a" title=" " alt="" coords="1159,1033,1304,1060"/>
<area shape="rect" href="Modal__aero__wateruptake_8H.html#ae5d285c0e71657c006da1c31ac41c548" title=" " alt="" coords="729,1226,792,1253"/>
<area shape="rect" href="classMamConstituents.html#af03978750c5679f6f44de935e49b7ef7" title=" " alt="" coords="677,1343,844,1384"/>
<area shape="rect" href="classMamConstituents.html#a2d427b9d796e14b4e713b58829034f56" title=" " alt="" coords="677,1110,844,1151"/>
<area shape="rect" href="classMamConstituents.html#a12e3884e2ae28840165e4aa8408add45" title=" " alt="" coords="677,1278,844,1319"/>
<area shape="rect" href="Modal__aero__wateruptake_8H.html#a3cd6f9e15171bc4f84f7293abef597cb" title=" " alt="" coords="727,1176,794,1202"/>
<area shape="rect" href="Modal__aero__wateruptake_8H.html#a9aa3077c8aba28c76a55a49b5ce9d5ec" title=" " alt="" coords="1603,473,1641,500"/>
<area shape="rect" href="classPhysProp.html#ab2337242b083bd5f434cb32720aff5a8" title=" " alt="" coords="912,1374,1107,1401"/>
<area shape="rect" href="classPhysProp.html#a0d29d8a473f08acf3a9083b54942b27b" title=" " alt="" coords="929,1426,1089,1467"/>
<area shape="rect" href="classPhysProp.html#aa435d3d01ec01519c8c6e4959fa58fcf" title=" " alt="" coords="925,1491,1093,1532"/>
<area shape="rect" href="classPhysProp.html#ace87b45eead8d9fd6a17eec2c3456a98" title=" " alt="" coords="922,1172,1097,1198"/>
<area shape="rect" href="Modal__aero__wateruptake_8H.html#a11260de6947324f76f836f37f6ec7eb6" title=" " alt="" coords="1192,1146,1271,1173"/>
<area shape="rect" href="classPhysProp.html#a81485201c08d1e2b8013f0bb88f44af7" title=" " alt="" coords="916,1273,1103,1300"/>
<area shape="rect" href="Modal__aero__wateruptake_8H.html#a4500ffa7f6c54c672531b679f4903f25" title=" " alt="" coords="1186,1248,1277,1274"/>
<area shape="rect" href="classPhysProp.html#a5872e2bb36e4c750385b349738f11e1c" title=" " alt="" coords="926,1324,1093,1350"/>
<area shape="rect" href="classWaterVaporSat.html#a071cc1a28405ce131d1c1bcb216d471a" title=" " alt="" coords="1155,840,1307,882"/>
<area shape="rect" href="classWaterVaporSat.html#a9d72a29e54869f42ec419639d6c3d70f" title=" " alt="" coords="681,891,840,932"/>
<area shape="rect" href="classWaterVaporSat.html#a65b6cc3dc802016e84bc19030f6ad65a" title=" " alt="" coords="686,378,835,419"/>
<area shape="rect" href="classWaterVaporSat.html#afae0dfb4f85c8ac528ff330ccfa182b2" title=" " alt="" coords="659,688,862,714"/>
<area shape="rect" href="classSatMethods.html#a25e9dd28dcfcfd4e060472815e8389fa" title=" " alt="" coords="1155,622,1308,663"/>
<area shape="rect" href="classWaterVaporSat.html#ad2bce1bf12d7f01fd354c36e17bfe635" title=" " alt="" coords="1375,790,1536,831"/>
<area shape="rect" href="classSatMethods.html#ac2fa5e55257c6021e9e7fd897f4950b7" title=" " alt="" coords="933,378,1086,419"/>
<area shape="rect" href="classSatMethods.html#add2fde8076c60c19ed9f4f78c9891e0e" title=" " alt="" coords="1155,247,1308,288"/>
<area shape="rect" href="classSatMethods.html#a1c4bb9729c75dd1160d45ae638635766" title=" " alt="" coords="1155,352,1308,394"/>
<area shape="rect" href="classSatMethods.html#a128ccad46f784c2d1aaeda372833dab6" title=" " alt="" coords="1381,312,1530,354"/>
<area shape="rect" href="classSatMethods.html#a9e929b8ac05dbeaa78dc158159f84758" title=" " alt="" coords="1367,116,1544,158"/>
<area shape="rect" href="classSatMethods.html#a87786f42b9d0601dc1d22f635906a76f" title=" " alt="" coords="1361,182,1549,223"/>
<area shape="rect" href="classSatMethods.html#a185a448ec1db160bc61f23cbda63f4bd" title=" " alt="" coords="1356,247,1555,288"/>
<area shape="rect" href="classSatMethods.html#a264a283910d028a29c374900fc03017f" title=" " alt="" coords="1367,495,1544,536"/>
<area shape="rect" href="classSatMethods.html#aac1daa9a38464e217df80a4f9613bcb3" title=" " alt="" coords="1361,378,1549,419"/>
<area shape="rect" href="Modal__aero__wateruptake_8H.html#ae7815a546266ee09cee1f18ee2a27d97" title=" " alt="" coords="990,637,1029,664"/>
</map>
</div>

</div>
</div>
<a id="a54463b4d74c22934fcbf36a7c95f0b3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54463b4d74c22934fcbf36a7c95f0b3f">&#9670;&nbsp;</a></span>set_aerosol_optics_sw()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Optics::set_aerosol_optics_sw </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>icall</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ncol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nswbands</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int1d &amp;&#160;</td>
          <td class="paramname"><em>night_indices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>is_cmip6_volc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>tau_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>ssa_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>asm_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>clear_rh</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                                                                                                                              {</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      <span class="comment">// NOTE: aer_rad_props expects 0:pver indexing on these! It appears this is to</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      <span class="comment">// account for the extra layer added above model top, but it is not entirely</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      <span class="comment">// clear. This is not done for the longwave, and it is not really documented</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      <span class="comment">// anywhere that I can find. Regardless, optical properties for the zero index</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      <span class="comment">// are set to zero in aer_rad_props_sw as far as I can tell.</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      <span class="comment">// NOTE: dimension ordering is different than for cloud optics!</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      <span class="comment">//real(r8), dimension(ncol,0:pver,nswbands) ::</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      real3d tau(<span class="stringliteral">&quot;tau&quot;</span>, ncol, nlev+1, nswbands);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      real3d tau_w(<span class="stringliteral">&quot;tau_w&quot;</span>, ncol, nlev+1, nswbands);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      real3d tau_w_g(<span class="stringliteral">&quot;tau_w_g&quot;</span>, ncol, nlev+1, nswbands);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      real3d tau_w_f(<span class="stringliteral">&quot;tau_w_f&quot;</span>, ncol, nlev+1, nswbands);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160; </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      <span class="comment">// Get aerosol absorption optical depth from CAM routine</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      yakl::memset(tau, 0.);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      yakl::memset(tau_w, 0.);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      yakl::memset(tau_w_g, 0.);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      yakl::memset(tau_w_f, 0.);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160; </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      int1d ic(<span class="stringliteral">&quot;icount&quot;</span>,1);</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      intHost1d ic_host(<span class="stringliteral">&quot;ic_host&quot;</span>,1);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      parallel_for(SimpleBounds&lt;1&gt;(ncol), YAKL_LAMBDA (<span class="keywordtype">int</span> i) {</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        <span class="keywordflow">if</span> (night_indices(i) &gt; 0) ++ic(1);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      });</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      ic.deep_copy_to(ic_host);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160; </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      <a class="code" href="classOptics.html#a2153b2cf09af64100464587e8afb6d8f">aero_optics</a>.<a class="code" href="classAerRadProps.html#a433097bd85637100b16f3e120e9d6fa1">aer_rad_props_sw</a>(icall, dt,</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;           ic_host(1), night_indices, is_cmip6_volc,</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;           tau, tau_w, tau_w_g, tau_w_f, clear_rh);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160; </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      <span class="comment">// Extract quantities from products</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      parallel_for(SimpleBounds&lt;3&gt;(ncol, nlev, nswbands), YAKL_LAMBDA (<span class="keywordtype">int</span> icol, <span class="keywordtype">int</span> ilev, <span class="keywordtype">int</span> iband) {</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        <span class="comment">// Copy cloud optical depth over directly</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        tau_out(icol,ilev,iband) = tau(icol,ilev,iband);</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <span class="comment">// Extract single scattering albedo from the product-defined fields</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        <span class="keywordflow">if</span> (tau(icol,ilev,iband) &gt; 0) {</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;          ssa_out(icol,ilev,iband) = tau_w(icol,ilev,iband) / tau(icol,ilev,iband);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;          ssa_out(icol,ilev,iband) = 1.;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        }</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160; </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        <span class="comment">// Extract assymmetry parameter from the product-defined fields</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        <span class="keywordflow">if</span> (tau_w(icol,ilev,iband) &gt; 0) {</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;          asm_out(icol,ilev,iband) = tau_w_g(icol,ilev,iband) / tau_w(icol,ilev,iband);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;           asm_out(icol,ilev,iband) = 0.;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        }</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;     });</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  }</div>
<div class="ttc" id="aclassAerRadProps_html_a433097bd85637100b16f3e120e9d6fa1"><div class="ttname"><a href="classAerRadProps.html#a433097bd85637100b16f3e120e9d6fa1">AerRadProps::aer_rad_props_sw</a></div><div class="ttdeci">void aer_rad_props_sw(const int &amp;list_idx, const real &amp;dt, const int &amp;nnite, const int1d &amp;idxnite, const bool is_cmip6_volc, const real3d &amp;tau, const real3d &amp;tau_w, const real3d &amp;tau_w_g, const real3d &amp;tau_w_f, const real2d &amp;clear_rh)</div><div class="ttdef"><b>Definition:</b> Aero_rad_props.cpp:42</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classOptics_a54463b4d74c22934fcbf36a7c95f0b3f_cgraph.png" border="0" usemap="#aclassOptics_a54463b4d74c22934fcbf36a7c95f0b3f_cgraph" alt=""/></div>
<map name="aclassOptics_a54463b4d74c22934fcbf36a7c95f0b3f_cgraph" id="aclassOptics_a54463b4d74c22934fcbf36a7c95f0b3f_cgraph">
<area shape="rect" title=" " alt="" coords="5,797,152,839"/>
<area shape="rect" href="classAerRadProps.html#a433097bd85637100b16f3e120e9d6fa1" title=" " alt="" coords="200,797,363,839"/>
<area shape="rect" href="Modal__aero__wateruptake_8H.html#a8a0c0dddc4a8389a14e6906b55d7cacf" title=" " alt="" coords="763,23,801,50"/>
<area shape="rect" href="classMamConstituents.html#aa268eea91939bf42c29685aa43138d15" title=" " alt="" coords="429,176,596,217"/>
<area shape="rect" href="classMamConstituents.html#a278b01dd1df95acd2ad6a5c800caf719" title=" " alt="" coords="429,241,596,283"/>
<area shape="rect" href="classMamConstituents.html#a6c4d7f8d8edc0d35828faf619d474c2b" title=" " alt="" coords="429,307,596,348"/>
<area shape="rect" href="classMamConstituents.html#aa1f6958b2ddfaf33e1561b53e3e026c3" title=" " alt="" coords="429,372,596,413"/>
<area shape="rect" href="classMamConstituents.html#ad7e9e541dea92292a381c1d645faef1b" title=" " alt="" coords="429,437,596,479"/>
<area shape="rect" href="classMamConstituents.html#a1e2eb8427b5f69fe79ffdbff599489da" title=" " alt="" coords="429,503,596,544"/>
<area shape="rect" href="classMamConstituents.html#aa8e7a68a039ef90b126879c91ac33086" title=" " alt="" coords="429,568,596,609"/>
<area shape="rect" href="classMamConstituents.html#a97b9fbaf5e3efd669c510507e3a4095c" title=" " alt="" coords="429,633,596,675"/>
<area shape="rect" href="classMamConstituents.html#ad7a049202ae9582047df1a88d0f973ae" title=" " alt="" coords="420,699,605,740"/>
<area shape="rect" href="classMamConstituents.html#a55dbbc44079a3d80b501dabb766c70f6" title=" " alt="" coords="423,764,602,805"/>
<area shape="rect" href="classMamConstituents.html#aa0f1152f17813847ba8f464828079065" title=" " alt="" coords="427,829,598,871"/>
<area shape="rect" href="classMamConstituents.html#af3443a17ef46a08705917692bd92bfae" title=" " alt="" coords="424,895,601,936"/>
<area shape="rect" href="classMamConstituents.html#a8d1e4789f9cd4438776ba0838c59f663" title=" " alt="" coords="427,960,599,1001"/>
<area shape="rect" href="classAerRadProps.html#a6a1e71160911bbc52d09bdbd73acb219" title=" " alt="" coords="423,1025,602,1067"/>
<area shape="rect" href="classMamConstituents.html#abd92c92743d51efe2f17e68cbfaccee1" title=" " alt="" coords="429,1091,596,1132"/>
<area shape="rect" href="classMamConstituents.html#a80c22c3ae9035880d179adca47c29b60" title=" " alt="" coords="411,1157,615,1183"/>
<area shape="rect" href="classMamConstituents.html#a5de90eaa3b6d493a7b12ce7df766fa6f" title=" " alt="" coords="949,1465,1116,1507"/>
<area shape="rect" href="classAerRadProps.html#af6e6827c17d2247b72337a35875ea0e0" title=" " alt="" coords="411,1309,614,1351"/>
<area shape="rect" href="classAerRadProps.html#a74842fff81711719376fc035b86dc1a7" title=" " alt="" coords="415,1375,610,1416"/>
<area shape="rect" href="classAerRadProps.html#a55507a56c5808f7480e42f4369cbf5a7" title=" " alt="" coords="415,1440,610,1481"/>
<area shape="rect" href="classMam4__aer.html#ad7ec661c28332eed1cbb43fa82c8fb92" title=" " alt="" coords="412,1207,613,1234"/>
<area shape="rect" href="Modal__aero__wateruptake_8H.html#a732deb0c6f95544c2c323749f227bbd6" title=" " alt="" coords="763,99,801,126"/>
<area shape="rect" href="classWaterVaporSat.html#a4dac5d0ff52b333add64a13539fca1c8" title=" " alt="" coords="435,74,590,101"/>
<area shape="rect" href="Modal__aero__wateruptake_8H.html#a352bc71b7a47b331f4f6b71b09e0401d" title=" " alt="" coords="493,1506,532,1533"/>
<area shape="rect" href="classAerRadProps.html#aa4241f4adcf62ef3c537a91bdfce66db" title=" " alt="" coords="429,1557,596,1599"/>
<area shape="rect" href="classPhysProp.html#ac78ce456f60120096570085d96025467" title=" " alt="" coords="713,183,851,210"/>
<area shape="rect" href="classPhysProp.html#a2e6aa40659bebbb92eff36707e84dbeb" title=" " alt="" coords="689,249,875,275"/>
<area shape="rect" href="classPhysProp.html#a8e24d22599eb28c794d6c013a77da88b" title=" " alt="" coords="708,307,856,348"/>
<area shape="rect" href="classPhysProp.html#a8ae236822c66b24d61542a7562dc2b36" title=" " alt="" coords="694,379,870,406"/>
<area shape="rect" href="classPhysProp.html#a4dc566af71334229d77cec2ff7c1b8a2" title=" " alt="" coords="691,445,873,471"/>
<area shape="rect" href="classPhysProp.html#a2c4ba9dc1730e16e61dd5de913f09229" title=" " alt="" coords="675,510,889,537"/>
<area shape="rect" href="classPhysProp.html#ababe9e1b22883f8f778de5642c51fb7e" title=" " alt="" coords="678,575,886,602"/>
<area shape="rect" href="classPhysProp.html#a5b9855835eec9368dd391c7e2bea62c8" title=" " alt="" coords="677,641,887,667"/>
<area shape="rect" href="classPhysProp.html#a8f01d8ce66699a90d6a9f11470d04e8f" title=" " alt="" coords="680,699,884,740"/>
<area shape="rect" href="classPhysProp.html#a619a541abfbda160eab3cfe9ea26c612" title=" " alt="" coords="663,767,901,794"/>
<area shape="rect" href="classPhysProp.html#a98cea076df018a4aaf83ea7c559674ec" title=" " alt="" coords="666,818,898,845"/>
<area shape="rect" href="classPhysProp.html#a10b14c12c1fafdc8e35b622fc816247e" title=" " alt="" coords="663,869,901,895"/>
<area shape="rect" href="classPhysProp.html#a014f63e66f91a28c359abf6ed245450b" title=" " alt="" coords="665,919,899,946"/>
<area shape="rect" href="classMam4__aer.html#a1488790796a5a153be55af7d9a64d36a" title=" " alt="" coords="709,970,855,997"/>
<area shape="rect" href="Modal__aero__wateruptake_8H.html#ae5d285c0e71657c006da1c31ac41c548" title=" " alt="" coords="751,1021,813,1047"/>
<area shape="rect" href="classMamConstituents.html#a4fd648d3960d01a223e78b1436280c13" title=" " alt="" coords="949,1228,1116,1269"/>
<area shape="rect" href="classMamConstituents.html#aca6158f69242c0ed4e434c16c4254cd0" title=" " alt="" coords="699,1291,865,1332"/>
<area shape="rect" href="classMamConstituents.html#a2d427b9d796e14b4e713b58829034f56" title=" " alt="" coords="949,1069,1116,1111"/>
<area shape="rect" href="classMamConstituents.html#a12e3884e2ae28840165e4aa8408add45" title=" " alt="" coords="949,1144,1116,1185"/>
<area shape="rect" href="classMam4__aer.html#adedd31f2c7c2a293e6f3dfc4818b175d" title=" " alt="" coords="694,1173,870,1215"/>
<area shape="rect" href="classMam4__aer.html#af2034bd10c39ba3bf5139d8d8c5b07ad" title=" " alt="" coords="695,1356,869,1397"/>
<area shape="rect" href="Modal__aero__wateruptake_8H.html#a3cd6f9e15171bc4f84f7293abef597cb" title=" " alt="" coords="749,1422,815,1449"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a2153b2cf09af64100464587e8afb6d8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2153b2cf09af64100464587e8afb6d8f">&#9670;&nbsp;</a></span>aero_optics</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classAerRadProps.html">AerRadProps</a> Optics::aero_optics</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classOptics.html#a2472dd458109b58bc71cc44f57ff02f9">initialize()</a>, <a class="el" href="classOptics.html#aecf608be7db530dc74beb0a03b2279f2">set_aerosol_optics_lw()</a>, and <a class="el" href="classOptics.html#a54463b4d74c22934fcbf36a7c95f0b3f">set_aerosol_optics_sw()</a>.</p>

</div>
</div>
<a id="a90c700e69b63c61c6275b12c63033334"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90c700e69b63c61c6275b12c63033334">&#9670;&nbsp;</a></span>cloud_optics</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classCloudRadProps.html">CloudRadProps</a> Optics::cloud_optics</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classOptics.html#af5f3fa679301f0ead8b8155626b2e710">get_cloud_optics_lw()</a>, <a class="el" href="classOptics.html#aee82856b88240c428aefc6f47bf9500c">get_cloud_optics_sw()</a>, and <a class="el" href="classOptics.html#a2472dd458109b58bc71cc44f57ff02f9">initialize()</a>.</p>

</div>
</div>
<a id="aba268b2221309fdc437349b1427c5c6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba268b2221309fdc437349b1427c5c6d">&#9670;&nbsp;</a></span>gas_names</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">char** Optics::gas_names</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a357f26f1bf42c917131a48782732ce03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a357f26f1bf42c917131a48782732ce03">&#9670;&nbsp;</a></span>icecldoptics</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string Optics::icecldoptics</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classOptics.html#af5f3fa679301f0ead8b8155626b2e710">get_cloud_optics_lw()</a>, and <a class="el" href="classOptics.html#aee82856b88240c428aefc6f47bf9500c">get_cloud_optics_sw()</a>.</p>

</div>
</div>
<a id="a87abc901496b039c596eed89b297a679"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87abc901496b039c596eed89b297a679">&#9670;&nbsp;</a></span>liqcldoptics</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string Optics::liqcldoptics</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classOptics.html#af5f3fa679301f0ead8b8155626b2e710">get_cloud_optics_lw()</a>, and <a class="el" href="classOptics.html#aee82856b88240c428aefc6f47bf9500c">get_cloud_optics_sw()</a>.</p>

</div>
</div>
<a id="abb94e5d9dc89e539796740c6f0b9a229"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb94e5d9dc89e539796740c6f0b9a229">&#9670;&nbsp;</a></span>ngas</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int Optics::ngas</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classOptics.html#a2472dd458109b58bc71cc44f57ff02f9">initialize()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>Source/Radiation/<a class="el" href="Optics_8H_source.html">Optics.H</a></li>
<li>Source/Radiation/<a class="el" href="Optics_8cpp.html">Optics.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classOptics.html">Optics</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
