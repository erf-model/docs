<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ERF: Source/PhysicsInterfaces/Radiation/ERF_OrbCosZenith.H File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ERF
   </div>
   <div id="projectbrief">Energy Research and Forecasting: An Atmospheric Modeling Code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('ERF__OrbCosZenith_8H.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ERF_OrbCosZenith.H File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;vector&gt;</code><br />
<code>#include &lt;cmath&gt;</code><br />
<code>#include &lt;<a class="el" href="ERF__Constants_8H_source.html">ERF_Constants.H</a>&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for ERF_OrbCosZenith.H:</div>
<div class="dyncontent">
<div class="center"><img src="ERF__OrbCosZenith_8H__incl.png" border="0" usemap="#aSource_2PhysicsInterfaces_2Radiation_2ERF__OrbCosZenith_8H" alt=""/></div>
<map name="aSource_2PhysicsInterfaces_2Radiation_2ERF__OrbCosZenith_8H" id="aSource_2PhysicsInterfaces_2Radiation_2ERF__OrbCosZenith_8H">
<area shape="rect" title=" " alt="" coords="10,5,237,47"/>
<area shape="rect" title=" " alt="" coords="5,95,68,121"/>
<area shape="rect" title=" " alt="" coords="92,95,155,121"/>
<area shape="rect" href="ERF__Constants_8H.html" title=" " alt="" coords="179,95,313,121"/>
<area shape="rect" title=" " alt="" coords="185,169,307,196"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="ERF__OrbCosZenith_8H__dep__incl.png" border="0" usemap="#aSource_2PhysicsInterfaces_2Radiation_2ERF__OrbCosZenith_8Hdep" alt=""/></div>
<map name="aSource_2PhysicsInterfaces_2Radiation_2ERF__OrbCosZenith_8Hdep" id="aSource_2PhysicsInterfaces_2Radiation_2ERF__OrbCosZenith_8Hdep">
<area shape="rect" title=" " alt="" coords="5,5,232,47"/>
<area shape="rect" href="ERF__Radiation_8H.html" title=" " alt="" coords="19,95,219,136"/>
<area shape="rect" href="ERF__Radiation_8cpp.html" title=" " alt="" coords="12,184,225,225"/>
</map>
</div>
</div>
<p><a href="ERF__OrbCosZenith_8H_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a11d147c64891830c9e79b3315b1b2e21"><td class="memItemLeft" align="right" valign="top">typedef double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a></td></tr>
<tr class="separator:a11d147c64891830c9e79b3315b1b2e21"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:af80fef8225bcd5a4894f83e3d1febabe"><td class="memItemLeft" align="right" valign="top">AMREX_GPU_HOST AMREX_FORCE_INLINE void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ERF__OrbCosZenith_8H.html#af80fef8225bcd5a4894f83e3d1febabe">orbital_decl</a> (<a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> &amp;calday, <a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> &amp;eccen, <a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> &amp;mvelpp, <a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> &amp;lambm0, <a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> &amp;obliqr, <a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> &amp;delta, <a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> &amp;eccf)</td></tr>
<tr class="separator:af80fef8225bcd5a4894f83e3d1febabe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcf5dcbbabe64b28d04883a62431f166"><td class="memItemLeft" align="right" valign="top">AMREX_GPU_HOST AMREX_FORCE_INLINE void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ERF__OrbCosZenith_8H.html#afcf5dcbbabe64b28d04883a62431f166">orbital_params</a> (int &amp;iyear_AD, <a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> &amp;eccen, <a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> &amp;obliq, <a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> &amp;mvelp, <a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> &amp;obliqr, <a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> &amp;lambm0, <a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> &amp;mvelpp)</td></tr>
<tr class="separator:afcf5dcbbabe64b28d04883a62431f166"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf51ad4c4efd214d3fb735056b440110"><td class="memItemLeft" align="right" valign="top">AMREX_GPU_HOST AMREX_FORCE_INLINE <a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ERF__OrbCosZenith_8H.html#acf51ad4c4efd214d3fb735056b440110">orbital_avg_cos_zenith</a> (<a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> &amp;jday, <a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> &amp;lat, <a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> &amp;lon, <a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> &amp;declin, <a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> &amp;dt_avg)</td></tr>
<tr class="separator:acf51ad4c4efd214d3fb735056b440110"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3bb13e315a679b4c285715ae7023b38"><td class="memItemLeft" align="right" valign="top">AMREX_GPU_HOST AMREX_FORCE_INLINE <a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ERF__OrbCosZenith_8H.html#aa3bb13e315a679b4c285715ae7023b38">orbital_cos_zenith</a> (<a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> &amp;jday, <a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> &amp;lat, <a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> &amp;lon, <a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> &amp;declin, <a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> dt_avg=-1., <a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> uniform_angle=-1., <a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> constant_zenith_angle_deg=-1.)</td></tr>
<tr class="separator:aa3bb13e315a679b4c285715ae7023b38"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="a11d147c64891830c9e79b3315b1b2e21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11d147c64891830c9e79b3315b1b2e21">&#9670;&nbsp;</a></span>real</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef double <a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="acf51ad4c4efd214d3fb735056b440110"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf51ad4c4efd214d3fb735056b440110">&#9670;&nbsp;</a></span>orbital_avg_cos_zenith()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AMREX_GPU_HOST AMREX_FORCE_INLINE <a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> orbital_avg_cos_zenith </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> &amp;&#160;</td>
          <td class="paramname"><em>jday</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> &amp;&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> &amp;&#160;</td>
          <td class="paramname"><em>lon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> &amp;&#160;</td>
          <td class="paramname"><em>declin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> &amp;&#160;</td>
          <td class="paramname"><em>dt_avg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;{</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="comment">// adjust latitude so that its tangent will be defined</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <a class="code" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> del;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="keywordflow">if</span> (lat ==  <a class="code" href="ERF__Constants_8H.html#ad51e17db99d11b190b2b57a23a518f7e">PIoTwo</a>) {</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        del = lat - <a class="code" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a>(1.0e-05);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (lat ==  -<a class="code" href="ERF__Constants_8H.html#ad51e17db99d11b190b2b57a23a518f7e">PIoTwo</a>) {</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        del = lat + <a class="code" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a>(1.0e-05);</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        del = lat;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    }</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160; </div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="comment">// adjust declination so that its tangent will be defined</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <a class="code" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> phi;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="keywordflow">if</span> (declin == <a class="code" href="ERF__Constants_8H.html#ad51e17db99d11b190b2b57a23a518f7e">PIoTwo</a>) {</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        phi = declin - <a class="code" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a>(1.0e-05);</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (declin == -<a class="code" href="ERF__Constants_8H.html#ad51e17db99d11b190b2b57a23a518f7e">PIoTwo</a>) {</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        phi = declin + <a class="code" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a>(1.0e-05);</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        phi = declin;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    }</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160; </div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="comment">// define the cosine of the half-day length</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="comment">// adjust for cases of all daylight or all night</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <a class="code" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> h;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <a class="code" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> cos_h = - std::tan(del) * std::tan(phi);</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="keywordflow">if</span> (cos_h &lt;= -1.0) {</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        h = <a class="code" href="ERF__Constants_8H.html#a988c4efd6fd0d855e241e77a73191428">PI</a>;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cos_h &gt;= 1.0) {</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        h = 0.0;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        h = std::acos(cos_h);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    }</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160; </div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="comment">// Define Local Time t and t + dt</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="comment">// adjust t to be between -pi and pi</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <a class="code" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> t1 = (jday - int(jday)) * 2.0*<a class="code" href="ERF__Constants_8H.html#a988c4efd6fd0d855e241e77a73191428">PI</a> + lon - <a class="code" href="ERF__Constants_8H.html#a988c4efd6fd0d855e241e77a73191428">PI</a>;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="keywordflow">if</span> (t1 &gt;=  <a class="code" href="ERF__Constants_8H.html#a988c4efd6fd0d855e241e77a73191428">PI</a>) {</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        t1 = t1 - 2.0*<a class="code" href="ERF__Constants_8H.html#a988c4efd6fd0d855e241e77a73191428">PI</a>;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (t1 &lt; -<a class="code" href="ERF__Constants_8H.html#a988c4efd6fd0d855e241e77a73191428">PI</a>) {</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        t1 = t1 + 2.0*<a class="code" href="ERF__Constants_8H.html#a988c4efd6fd0d855e241e77a73191428">PI</a>;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    }</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160; </div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <a class="code" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> dt = dt_avg / <a class="code" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a>(86400.0) * 2.0*<a class="code" href="ERF__Constants_8H.html#a988c4efd6fd0d855e241e77a73191428">PI</a>;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <a class="code" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> t2 = t1 + dt;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160; </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="comment">// Compute Cosine Solar Zenith angle</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="comment">// define terms needed in the cosine zenith angle equation</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <a class="code" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> aa = std::sin(lat) * std::sin(declin);</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <a class="code" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> bb = std::cos(lat) * std::cos(declin);</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160; </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="comment">// define the hour angle</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="comment">// force it to be between -h and h</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="comment">// consider the situation when the night period is too short</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <a class="code" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> tt1,tt2,tt3,tt4;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="keywordflow">if</span> ( (t2 &gt;= <a class="code" href="ERF__Constants_8H.html#a988c4efd6fd0d855e241e77a73191428">PI</a>) &amp;&amp; (t1 &lt;= <a class="code" href="ERF__Constants_8H.html#a988c4efd6fd0d855e241e77a73191428">PI</a>) &amp;&amp; (<a class="code" href="ERF__Constants_8H.html#a988c4efd6fd0d855e241e77a73191428">PI</a> - h &lt;= dt) ) {</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        tt2 = h;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        tt1 = std::min(std::max(t1,         -h),          h);</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        tt4 = std::min(std::max(t2, 2.0*<a class="code" href="ERF__Constants_8H.html#a988c4efd6fd0d855e241e77a73191428">PI</a> - h), 2.0*<a class="code" href="ERF__Constants_8H.html#a988c4efd6fd0d855e241e77a73191428">PI</a> + h);</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        tt3 = 2.0*<a class="code" href="ERF__Constants_8H.html#a988c4efd6fd0d855e241e77a73191428">PI</a> - h;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( (t2 &gt;= -<a class="code" href="ERF__Constants_8H.html#a988c4efd6fd0d855e241e77a73191428">PI</a>) &amp;&amp; (t1 &lt;= -<a class="code" href="ERF__Constants_8H.html#a988c4efd6fd0d855e241e77a73191428">PI</a>) &amp;&amp; (<a class="code" href="ERF__Constants_8H.html#a988c4efd6fd0d855e241e77a73191428">PI</a> - h &lt;= dt) ) {</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        tt2 = - 2.0*<a class="code" href="ERF__Constants_8H.html#a988c4efd6fd0d855e241e77a73191428">PI</a> + h;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        tt1 = std::min(std::max(t1, -2.0*<a class="code" href="ERF__Constants_8H.html#a988c4efd6fd0d855e241e77a73191428">PI</a> - h), -2.0*<a class="code" href="ERF__Constants_8H.html#a988c4efd6fd0d855e241e77a73191428">PI</a> + h);</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        tt4 = std::min(std::max(t2,          -h),           h);</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        tt3 = -h;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        <span class="keywordflow">if</span> (t2 &gt; <a class="code" href="ERF__Constants_8H.html#a988c4efd6fd0d855e241e77a73191428">PI</a>) {</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;            tt2 = std::min(std::max(t2 - 2.0*<a class="code" href="ERF__Constants_8H.html#a988c4efd6fd0d855e241e77a73191428">PI</a>, -h), h);</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (t2 &lt; - <a class="code" href="ERF__Constants_8H.html#a988c4efd6fd0d855e241e77a73191428">PI</a>) {</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;            tt2 = std::min(std::max(t2 + 2.0*<a class="code" href="ERF__Constants_8H.html#a988c4efd6fd0d855e241e77a73191428">PI</a>, -h), h);</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;            tt2 = std::min(std::max(t2         , -h), h);</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        }</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160; </div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        <span class="keywordflow">if</span> (t1 &gt; <a class="code" href="ERF__Constants_8H.html#a988c4efd6fd0d855e241e77a73191428">PI</a>) {</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;            tt1 = std::min(std::max(t1 - 2.0*<a class="code" href="ERF__Constants_8H.html#a988c4efd6fd0d855e241e77a73191428">PI</a>, -h), h);</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (t1 &lt; -<a class="code" href="ERF__Constants_8H.html#a988c4efd6fd0d855e241e77a73191428">PI</a>) {</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;            tt1 = std::min(std::max(t1 + 2.0*<a class="code" href="ERF__Constants_8H.html#a988c4efd6fd0d855e241e77a73191428">PI</a>, -h), h);</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;            tt1 = std::min(std::max(t1         , -h), h);</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        }</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        tt4 = 0.0;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        tt3 = 0.0;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    }</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160; </div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <span class="comment">// perform a time integration to obtain cosz if desired</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="comment">// output is valid over the period from t to t + dt</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="keywordflow">if</span> ( (tt2 &gt; tt1) || (tt4 &gt; tt3) ) {</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;       <span class="keywordflow">return</span> (aa * (tt2 - tt1) + bb * (sin(tt2) - sin(tt1))) / dt +</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;              (aa * (tt4 - tt3) + bb * (sin(tt4) - sin(tt3))) / dt;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        <span class="keywordflow">return</span> 0.0;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    }</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;}</div>
<div class="ttc" id="aERF__Constants_8H_html_a988c4efd6fd0d855e241e77a73191428"><div class="ttname"><a href="ERF__Constants_8H.html#a988c4efd6fd0d855e241e77a73191428">PI</a></div><div class="ttdeci">constexpr amrex::Real PI</div><div class="ttdef"><b>Definition:</b> ERF_Constants.H:6</div></div>
<div class="ttc" id="aERF__Constants_8H_html_ad51e17db99d11b190b2b57a23a518f7e"><div class="ttname"><a href="ERF__Constants_8H.html#ad51e17db99d11b190b2b57a23a518f7e">PIoTwo</a></div><div class="ttdeci">constexpr amrex::Real PIoTwo</div><div class="ttdef"><b>Definition:</b> ERF_Constants.H:7</div></div>
<div class="ttc" id="aERF__OrbCosZenith_8H_html_a11d147c64891830c9e79b3315b1b2e21"><div class="ttname"><a href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a></div><div class="ttdeci">double real</div><div class="ttdef"><b>Definition:</b> ERF_OrbCosZenith.H:9</div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="ERF__OrbCosZenith_8H.html#aa3bb13e315a679b4c285715ae7023b38">orbital_cos_zenith()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ERF__OrbCosZenith_8H_acf51ad4c4efd214d3fb735056b440110_icgraph.png" border="0" usemap="#aERF__OrbCosZenith_8H_acf51ad4c4efd214d3fb735056b440110_icgraph" alt=""/></div>
<map name="aERF__OrbCosZenith_8H_acf51ad4c4efd214d3fb735056b440110_icgraph" id="aERF__OrbCosZenith_8H_acf51ad4c4efd214d3fb735056b440110_icgraph">
<area shape="rect" title=" " alt="" coords="781,5,952,32"/>
<area shape="rect" href="ERF__OrbCosZenith_8H.html#aa3bb13e315a679b4c285715ae7023b38" title=" " alt="" coords="593,5,733,32"/>
<area shape="rect" href="classRadiation.html#a3eab5714d47ed767884a66a8dc1058df" title=" " alt="" coords="396,5,545,32"/>
<area shape="rect" href="classRadiation.html#a85e5c7a8f70d91d8762cc241dfda691a" title=" " alt="" coords="171,5,348,32"/>
<area shape="rect" href="classRadiation.html#a08fb496755efd8324cfb28931a4112c9" title=" " alt="" coords="5,5,123,32"/>
</map>
</div>

</div>
</div>
<a id="aa3bb13e315a679b4c285715ae7023b38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3bb13e315a679b4c285715ae7023b38">&#9670;&nbsp;</a></span>orbital_cos_zenith()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AMREX_GPU_HOST AMREX_FORCE_INLINE <a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> orbital_cos_zenith </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> &amp;&#160;</td>
          <td class="paramname"><em>jday</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> &amp;&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> &amp;&#160;</td>
          <td class="paramname"><em>lon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> &amp;&#160;</td>
          <td class="paramname"><em>declin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>dt_avg</em> = <code>-1.</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>uniform_angle</em> = <code>-1.</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>constant_zenith_angle_deg</em> = <code>-1.</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;{</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <span class="comment">// Constant zenith angle is true</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <span class="keywordflow">if</span> ( constant_zenith_angle_deg &gt;= 0. ) {</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        <span class="keywordflow">return</span> std::cos( constant_zenith_angle_deg * <a class="code" href="ERF__Constants_8H.html#a988c4efd6fd0d855e241e77a73191428">PI</a>/180. );</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    }</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160; </div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <span class="comment">// Uniform angle is true</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="keywordflow">if</span> ( uniform_angle &gt;= 0.) {</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        <span class="keywordflow">return</span> std::cos(uniform_angle);</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    }</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160; </div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="comment">// Perform the calculation of Orbital_Cos_Zenith</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="keywordtype">bool</span> use_dt_avg = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="keywordflow">if</span> (dt_avg &gt; 0.) {</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        use_dt_avg = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    }</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="comment">// If dt for the average cosz is specified, then call the shr_orb_avg_cosz</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="keywordflow">if</span> (use_dt_avg) {</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="ERF__OrbCosZenith_8H.html#acf51ad4c4efd214d3fb735056b440110">orbital_avg_cos_zenith</a>(jday, lat, lon, declin, dt_avg);</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        <span class="keywordflow">return</span>  std::sin(lat)*std::sin(declin) - std::cos(lat)*std::cos(declin) *</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                std::cos((jday-floor(jday))*<a class="code" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a>(2.0)*<a class="code" href="ERF__Constants_8H.html#a988c4efd6fd0d855e241e77a73191428">PI</a> + lon);</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    }</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;}</div>
<div class="ttc" id="aERF__OrbCosZenith_8H_html_acf51ad4c4efd214d3fb735056b440110"><div class="ttname"><a href="ERF__OrbCosZenith_8H.html#acf51ad4c4efd214d3fb735056b440110">orbital_avg_cos_zenith</a></div><div class="ttdeci">AMREX_GPU_HOST AMREX_FORCE_INLINE real orbital_avg_cos_zenith(real &amp;jday, real &amp;lat, real &amp;lon, real &amp;declin, real &amp;dt_avg)</div><div class="ttdef"><b>Definition:</b> ERF_OrbCosZenith.H:456</div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classRadiation.html#a3eab5714d47ed767884a66a8dc1058df">Radiation::run_impl()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ERF__OrbCosZenith_8H_aa3bb13e315a679b4c285715ae7023b38_cgraph.png" border="0" usemap="#aERF__OrbCosZenith_8H_aa3bb13e315a679b4c285715ae7023b38_cgraph" alt=""/></div>
<map name="aERF__OrbCosZenith_8H_aa3bb13e315a679b4c285715ae7023b38_cgraph" id="aERF__OrbCosZenith_8H_aa3bb13e315a679b4c285715ae7023b38_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,145,32"/>
<area shape="rect" href="ERF__OrbCosZenith_8H.html#acf51ad4c4efd214d3fb735056b440110" title=" " alt="" coords="193,5,364,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ERF__OrbCosZenith_8H_aa3bb13e315a679b4c285715ae7023b38_icgraph.png" border="0" usemap="#aERF__OrbCosZenith_8H_aa3bb13e315a679b4c285715ae7023b38_icgraph" alt=""/></div>
<map name="aERF__OrbCosZenith_8H_aa3bb13e315a679b4c285715ae7023b38_icgraph" id="aERF__OrbCosZenith_8H_aa3bb13e315a679b4c285715ae7023b38_icgraph">
<area shape="rect" title=" " alt="" coords="593,5,733,32"/>
<area shape="rect" href="classRadiation.html#a3eab5714d47ed767884a66a8dc1058df" title=" " alt="" coords="396,5,545,32"/>
<area shape="rect" href="classRadiation.html#a85e5c7a8f70d91d8762cc241dfda691a" title=" " alt="" coords="171,5,348,32"/>
<area shape="rect" href="classRadiation.html#a08fb496755efd8324cfb28931a4112c9" title=" " alt="" coords="5,5,123,32"/>
</map>
</div>

</div>
</div>
<a id="af80fef8225bcd5a4894f83e3d1febabe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af80fef8225bcd5a4894f83e3d1febabe">&#9670;&nbsp;</a></span>orbital_decl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AMREX_GPU_HOST AMREX_FORCE_INLINE void orbital_decl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> &amp;&#160;</td>
          <td class="paramname"><em>calday</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> &amp;&#160;</td>
          <td class="paramname"><em>eccen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> &amp;&#160;</td>
          <td class="paramname"><em>mvelpp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> &amp;&#160;</td>
          <td class="paramname"><em>lambm0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> &amp;&#160;</td>
          <td class="paramname"><em>obliqr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> &amp;&#160;</td>
          <td class="paramname"><em>delta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> &amp;&#160;</td>
          <td class="paramname"><em>eccf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;{</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160; </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <a class="code" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> lambm;  <span class="comment">// Lambda m, mean long of perihelion (rad)</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <a class="code" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> lmm;    <span class="comment">// Intermediate argument involving lambm</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <a class="code" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> lamb;   <span class="comment">// Lambda, the earths long of perihelion</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <a class="code" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> invrho; <span class="comment">// Inverse normalized sun/earth distance</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <a class="code" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> sinl;   <span class="comment">// Sine of lmm</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keyword">static</span> constexpr <a class="code" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> dayspy = <a class="code" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a>(365.0); <span class="comment">// Day per year</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="keyword">static</span> constexpr <a class="code" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> ve     = <a class="code" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a>( 80.5); <span class="comment">// Calday of vernal equinox</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">     Compute eccentricity factor and solar declination using</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">     day value where a round day (such as 213.0) refers to 0z at</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">     Greenwich longitude.</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">     Use formulas from Berger, Andre 1978: Long-Term Variations of Daily</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">     Insolation and Quaternary Climatic Changes. J. of the Atmo. Sci.</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">     35:2362-2367.</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">     To get the earths true longitude (position in orbit; lambda in Berger</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">     1978) which is necessary to find the eccentricity factor and declination,</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">     must first calculate the mean longitude (lambda m in Berger 1978) at</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">     the present day.  This is done by adding to lambm0 (the mean longitude</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">     at the vernal equinox, set as March 21 at noon, when lambda=0; in radians)</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">     an increment (delta lambda m in Berger 1978) that is the number of</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">     days past or before (a negative increment) the vernal equinox divided by</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">     the days in a model year times the 2*pi radians in a complete orbit.</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">    */</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    lambm = lambm0 + (calday - ve)*2.0*<a class="code" href="ERF__Constants_8H.html#a988c4efd6fd0d855e241e77a73191428">PI</a>/dayspy;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    lmm   = lambm  - mvelpp;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="comment">// The earths true longitude, in radians, is then found from</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="comment">// the formula in Berger 1978:</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    sinl  = std::sin(lmm);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    lamb  = lambm  + eccen*( 2.0*sinl + eccen*( 1.25*sin(2.0*lmm)</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                                              + eccen*((13.0/12.0)*std::sin(3.0*lmm) - 0.25*sinl)));</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">     Using the obliquity, eccentricity, moving vernal equinox longitude of</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">     perihelion (plus), and earths true longitude, the declination (delta)</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">     and the normalized earth/sun distance (rho in Berger 1978; actually inverse</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">     rho will be used), and thus the eccentricity factor (eccf), can be</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">     calculated from formulas given in Berger 1978.</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">    */</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    invrho = (1.0 + eccen*std::cos(lamb - mvelpp)) / (1.0 - eccen*eccen);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="comment">// Set solar declination and eccentricity factor</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    delta  = std::asin(std::sin(obliqr)*std::sin(lamb));</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    eccf   = invrho*invrho;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classRadiation.html#a3eab5714d47ed767884a66a8dc1058df">Radiation::run_impl()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ERF__OrbCosZenith_8H_af80fef8225bcd5a4894f83e3d1febabe_icgraph.png" border="0" usemap="#aERF__OrbCosZenith_8H_af80fef8225bcd5a4894f83e3d1febabe_icgraph" alt=""/></div>
<map name="aERF__OrbCosZenith_8H_af80fef8225bcd5a4894f83e3d1febabe_icgraph" id="aERF__OrbCosZenith_8H_af80fef8225bcd5a4894f83e3d1febabe_icgraph">
<area shape="rect" title=" " alt="" coords="593,5,692,32"/>
<area shape="rect" href="classRadiation.html#a3eab5714d47ed767884a66a8dc1058df" title=" " alt="" coords="396,5,545,32"/>
<area shape="rect" href="classRadiation.html#a85e5c7a8f70d91d8762cc241dfda691a" title=" " alt="" coords="171,5,348,32"/>
<area shape="rect" href="classRadiation.html#a08fb496755efd8324cfb28931a4112c9" title=" " alt="" coords="5,5,123,32"/>
</map>
</div>

</div>
</div>
<a id="afcf5dcbbabe64b28d04883a62431f166"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afcf5dcbbabe64b28d04883a62431f166">&#9670;&nbsp;</a></span>orbital_params()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AMREX_GPU_HOST AMREX_FORCE_INLINE void orbital_params </td>
          <td>(</td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>iyear_AD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> &amp;&#160;</td>
          <td class="paramname"><em>eccen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> &amp;&#160;</td>
          <td class="paramname"><em>obliq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> &amp;&#160;</td>
          <td class="paramname"><em>mvelp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> &amp;&#160;</td>
          <td class="paramname"><em>obliqr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> &amp;&#160;</td>
          <td class="paramname"><em>lambm0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> &amp;&#160;</td>
          <td class="paramname"><em>mvelpp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;{</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">    !-------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">    !</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">    ! Calculate earths orbital parameters using Dave Threshers formula which</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">    ! came from Berger, Andre.  1978  &quot;A Simple Algorithm to Compute Long-Term</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">    ! Variations of Daily Insolation&quot;.  Contribution 18, Institute of Astronomy</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">    ! and Geophysics, Universite Catholique de Louvain, Louvain-la-Neuve, Belgium</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">    !</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">    !-------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">    */</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keywordtype">int</span> poblen  = 47; <span class="comment">// # of elements in series wrt obliquity</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keywordtype">int</span> pecclen = 19; <span class="comment">// # of elements in series wrt eccentricity</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordtype">int</span> pmvelen = 78; <span class="comment">// # of elements in series wrt vernal equinox</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keyword">static</span> constexpr <a class="code" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> psecdeg = <a class="code" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a>(1.0)/<a class="code" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a>(3600.0); <span class="comment">// arc sec to deg conversion</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keyword">static</span> constexpr <a class="code" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> <a class="code" href="namespacemodule__model__constants.html#ae781b8adc0c255fc7085a1f26cd59e3f">degrad</a> = <a class="code" href="ERF__Constants_8H.html#a988c4efd6fd0d855e241e77a73191428">PI</a>/<a class="code" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a>(180.); <span class="comment">// degree to radian conversion factor</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="comment">// Cosine series data for computation of obliquity: amplitude (arc seconds),</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="comment">// rate (arc seconds/year), phase (degrees).</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="comment">// amplitudes for obliquity cos series</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    std::vector&lt;real&gt; obamp =  {-2462.2214466, -857.3232075, -629.3231835,</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                                 -414.2804924, -311.7632587,  308.9408604,</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                                 -162.5533601, -116.1077911,  101.1189923,</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                                  -67.6856209,   24.9079067,   22.5811241,</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                                  -21.1648355,  -15.6549876,   15.3936813,</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                                   14.6660938,  -11.7273029,   10.2742696,</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                                    6.4914588,    5.8539148,   -5.4872205,</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                                   -5.4290191,    5.1609570,    5.0786314,</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                                   -4.0735782,    3.7227167,    3.3971932,</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                                   -2.8347004,   -2.6550721,   -2.5717867,</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                                   -2.4712188,    2.4625410,    2.2464112,</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                                   -2.0755511,   -1.9713669,   -1.8813061,</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                                   -1.8468785,    1.8186742,    1.7601888,</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                                   -1.5428851,    1.4738838,   -1.4593669,</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                                    1.4192259,   -1.1818980,    1.1756474,</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                                   -1.1316126,    1.0896928};</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="comment">// rates for obliquity cosine series</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    std::vector&lt;real&gt; obrate = {31.609974, 32.620504, 24.172203,</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                                31.983787, 44.828336, 30.973257,</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                                43.668246, 32.246691, 30.599444,</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                                42.681324, 43.836462, 47.439436,</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                                63.219948, 64.230478,  1.010530,</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                                 7.437771, 55.782177,  0.373813,</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                                13.218362, 62.583231, 63.593761,</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                                76.438310, 45.815258,  8.448301,</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                                56.792707, 49.747842, 12.058272,</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                                75.278220, 65.241008, 64.604291,</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                                 1.647247,  7.811584, 12.207832,</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                                63.856665, 56.155990, 77.448840,</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                                 6.801054, 62.209418, 20.656133,</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                                48.344406, 55.145460, 69.000539,</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                                11.071350, 74.291298, 11.047742,</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                                 0.636717, 12.844549};</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="comment">// phases for obliquity cosine series</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    std::vector&lt;real&gt; obphas = {251.9025, 280.8325, 128.3057,</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                                292.7252,  15.3747, 263.7951,</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                                308.4258, 240.0099, 222.9725,</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                                268.7809, 316.7998, 319.6024,</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                                143.8050, 172.7351,  28.9300,</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                                123.5968,  20.2082,  40.8226,</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                                123.4722, 155.6977, 184.6277,</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                                267.2772,  55.0196, 152.5268,</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                                 49.1382, 204.6609,  56.5233,</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                                200.3284, 201.6651, 213.5577,</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                                 17.0374, 164.4194,  94.5422,</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                                131.9124,  61.0309, 296.2073,</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                                135.4894, 114.8750, 247.0691,</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                                256.6114,  32.1008, 143.6804,</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                                 16.8784, 160.6835,  27.5932,</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                                348.1074,  82.6496};</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="comment">// Cosine/sine series data for computation of eccentricity and fixed vernal</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="comment">// equinox longitude of perihelion (fvelp): amplitude,</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="comment">// rate (arc seconds/year), phase (degrees).</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="comment">// ampl for eccen/fvelp cos/sin series</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    std::vector&lt;real&gt; ecamp = { 0.01860798,  0.01627522, -0.01300660,</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                                0.00988829, -0.00336700,  0.00333077,</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                               -0.00235400,  0.00140015,  0.00100700,</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                                0.00085700,  0.00064990,  0.00059900,</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                                0.00037800, -0.00033700,  0.00027600,</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                                0.00018200, -0.00017400, -0.00012400,</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                                0.00001250};</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="comment">// rates for eccen/fvelp cos/sin series</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    std::vector&lt;real&gt; ecrate = { 4.2072050,  7.3460910, 17.8572630,</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                                17.2205460, 16.8467330,  5.1990790,</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                                18.2310760, 26.2167580,  6.3591690,</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                                16.2100160,  3.0651810, 16.5838290,</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                                18.4939800,  6.1909530, 18.8677930,</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                                17.4255670,  6.1860010, 18.4174410,</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                                 0.6678630};</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="comment">// phases for eccen/fvelp cos/sin series</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    std::vector&lt;real&gt; ecphas = { 28.620089, 193.788772, 308.307024,</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                                320.199637, 279.376984,  87.195000,</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                                349.129677, 128.443387, 154.143880,</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                                291.269597, 114.860583, 332.092251,</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                                296.414411, 145.769910, 337.237063,</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                                152.092288, 126.839891, 210.667199,</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                                 72.108838};</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="comment">// Sine series data for computation of moving vernal equinox longitude of</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="comment">// perihelion: amplitude (arc seconds), rate (arc sec/year), phase (degrees).</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="comment">// amplitudes for mvelp sine series</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    std::vector&lt;real&gt; mvamp = { 7391.0225890, 2555.1526947, 2022.7629188,</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                               -1973.6517951, 1240.2321818,  953.8679112,</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                                -931.7537108,  872.3795383,  606.3544732,</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                                -496.0274038,  456.9608039,  346.9462320,</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                                -305.8412902,  249.6173246, -199.1027200,</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                                 191.0560889, -175.2936572,  165.9068833,</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                                 161.1285917,  139.7878093, -133.5228399,</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                                 117.0673811,  104.6907281,   95.3227476,</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                                  86.7824524,   86.0857729,   70.5893698,</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                                 -69.9719343,  -62.5817473,   61.5450059,</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                                 -57.9364011,   57.1899832,  -57.0236109,</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                                 -54.2119253,   53.2834147,   52.1223575,</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                                 -49.0059908,  -48.3118757,  -45.4191685,</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                                 -42.2357920,  -34.7971099,   34.4623613,</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                                 -33.8356643,   33.6689362,  -31.2521586,</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                                 -30.8798701,   28.4640769,  -27.1960802,</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                                  27.0860736,  -26.3437456,   24.7253740,</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                                  24.6732126,   24.4272733,   24.0127327,</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                                  21.7150294,  -21.5375347,   18.1148363,</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                                 -16.9603104,  -16.1765215,   15.5567653,</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                                  15.4846529,   15.2150632,   14.5047426,</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                                 -14.3873316,   13.1351419,   12.8776311,</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                                  11.9867234,   11.9385578,   11.7030822,</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                                  11.6018181,  -11.2617293,  -10.4664199,</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                                  10.4333970,  -10.2377466,   10.1934446,</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                                 -10.1280191,   10.0289441,  -10.0034259};</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="comment">// rates for mvelp sine series</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    std::vector&lt;real&gt; mvrate = {31.609974, 32.620504, 24.172203,</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                                 0.636717, 31.983787,  3.138886,</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                                30.973257, 44.828336,  0.991874,</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                                 0.373813, 43.668246, 32.246691,</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                                30.599444,  2.147012, 10.511172,</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                                42.681324, 13.650058,  0.986922,</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                                 9.874455, 13.013341,  0.262904,</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                                 0.004952,  1.142024, 63.219948,</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                                 0.205021,  2.151964, 64.230478,</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                                43.836462, 47.439436,  1.384343,</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                                 7.437771, 18.829299,  9.500642,</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                                 0.431696,  1.160090, 55.782177,</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                                12.639528,  1.155138,  0.168216,</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                                 1.647247, 10.884985,  5.610937,</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                                12.658184,  1.010530,  1.983748,</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                                14.023871,  0.560178,  1.273434,</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                                12.021467, 62.583231, 63.593761,</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                                76.438310,  4.280910, 13.218362,</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                                17.818769,  8.359495, 56.792707,</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                                 8.448301,  1.978796,  8.863925,</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                                 0.186365,  8.996212,  6.771027,</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                                45.815258, 12.002811, 75.278220,</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                                65.241008, 18.870667, 22.009553,</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                                64.604291, 11.498094,  0.578834,</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                                 9.237738, 49.747842,  2.147012,</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                                 1.196895,  2.133898,  0.173168};</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="comment">// phases for mvelp sine series</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    std::vector&lt;real&gt; mvphas = {251.9025, 280.8325, 128.3057,</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                                348.1074, 292.7252, 165.1686,</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                                263.7951,  15.3747,  58.5749,</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                                 40.8226, 308.4258, 240.0099,</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                                222.9725, 106.5937, 114.5182,</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                                268.7809, 279.6869,  39.6448,</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                                126.4108, 291.5795, 307.2848,</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                                 18.9300, 273.7596, 143.8050,</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                                191.8927, 125.5237, 172.7351,</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                                316.7998, 319.6024,  69.7526,</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                                123.5968, 217.6432,  85.5882,</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                                156.2147,  66.9489,  20.2082,</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                                250.7568,  48.0188,   8.3739,</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                                 17.0374, 155.3409,  94.1709,</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                                221.1120,  28.9300, 117.1498,</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                                320.5095, 262.3602, 336.2148,</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                                233.0046, 155.6977, 184.6277,</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                                267.2772,  78.9281, 123.4722,</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                                188.7132, 180.1364,  49.1382,</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                                152.5268,  98.2198,  97.4808,</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                                221.5376, 168.2438, 161.1199,</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                                 55.0196, 262.6495, 200.3284,</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                                201.6651, 294.6547,  99.8233,</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                                213.5577, 154.1631, 232.7153,</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                                138.3034, 204.6609, 106.5938,</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                                250.4676, 332.3345,  27.3039};</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="comment">//---------------------------Local variables----------------------------------</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <a class="code" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> obsum;   <span class="comment">// Obliquity series summation</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <a class="code" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> cossum;  <span class="comment">// Cos series summation for eccentricity/fvelp</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <a class="code" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> sinsum;  <span class="comment">// Sin series summation for eccentricity/fvelp</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <a class="code" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> fvelp;   <span class="comment">// Fixed vernal equinox long of perihelion</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <a class="code" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> mvsum;   <span class="comment">// mvelp series summation</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <a class="code" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> beta;    <span class="comment">// Intermediate argument for lambm0</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <a class="code" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> years;   <span class="comment">// Years to time of interest ( pos &lt;=&gt; future)</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <a class="code" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> eccen2;  <span class="comment">// eccentricity squared</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <a class="code" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> eccen3;  <span class="comment">// eccentricity cubed</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <a class="code" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a> yb4_1950AD; <span class="comment">// number of years before 1950 AD</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="comment">// Check for flag to use input orbit parameters</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordflow">if</span> ( iyear_AD == <a class="code" href="ERF__Constants_8H.html#a432b0c6e52c518d2923bd05ba945f17d">ORB_UNDEF_INT</a> ) {</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        <span class="comment">// The AMIP II settings (for a 1995 orbit) are adopted</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        obliq  = 23.4441;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        eccen  = 0.016715;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        mvelp  = 102.7;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        eccen2 = eccen*eccen;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        eccen3 = eccen2*eccen;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    } <span class="keywordflow">else</span> {  <span class="comment">// Otherwise calculate based on years before present</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160; </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">          The following calculates the earths obliquity, orbital eccentricity</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">          (and various powers of it) and vernal equinox mean longitude of</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">          perihelion for years in the past (future = negative of years past),</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">          using constants (see parameter section) given in the program of:</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">          Berger, Andre.  1978  A Simple Algorithm to Compute Long-Term Variations</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">          of Daily Insolation.  Contribution 18, Institute of Astronomy and</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">          Geophysics, Universite Catholique de Louvain, Louvain-la-Neuve, Belgium.</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">          and formulas given in the paper (where less precise constants are also</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">          given):</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">          Berger, Andre.  1978.  Long-Term Variations of Daily Insolation and</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">          Quaternary Climatic Changes.  J. of the Atmo. Sci. 35:2362-2367</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">          The algorithm is valid only to 1,000,000 years past or hence.</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">          For a solution valid to 5-10 million years past see the above author.</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">          Algorithm below is better for years closer to present than is the</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">          5-10 million year solution.</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">          Years to time of interest must be negative of years before present</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">          (1950) in formulas that follow.</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">        */</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        yb4_1950AD = <a class="code" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a>(1950.0) - <a class="code" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a>(iyear_AD);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        years = - yb4_1950AD;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">          In the summations below, cosine or sine arguments, which end up in</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">          degrees, must be converted to radians via multiplication by degrad.</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">          Summation of cosine series for obliquity (epsilon in Berger 1978) in</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">          degrees. Convert the amplitudes and rates, which are in arc secs, into</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">          degrees via multiplication by psecdeg (arc seconds to degrees conversion</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">          factor).  For obliq, first term is Berger 1978 epsilon star; second</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">          term is series summation in degrees.</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">        */</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160; </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        obsum = 0.0;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i(0); i&lt;poblen; ++i) {</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            obsum = obsum + obamp[i]*psecdeg*std::cos( (obrate[i]*psecdeg*years + obphas[i]) * <a class="code" href="namespacemodule__model__constants.html#ae781b8adc0c255fc7085a1f26cd59e3f">degrad</a> );</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        }</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        obliq = <a class="code" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a>(23.320556) + obsum;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160; </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">          Summation of cosine and sine series for computation of eccentricity</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">          (eccen; e in Berger 1978) and fixed vernal equinox longitude of</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">          perihelion (fvelp; pi in Berger 1978), which is used for computation</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">          of moving vernal equinox longitude of perihelion.  Convert the rates,</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">          which are in arc seconds, into degrees via multiplication by psecdeg.</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">        */</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160; </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        cossum = 0.0;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i(0); i&lt;pecclen; ++i) {</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            cossum = cossum + ecamp[i]*std::cos( (ecrate[i]*psecdeg*years+ecphas[i]) * <a class="code" href="namespacemodule__model__constants.html#ae781b8adc0c255fc7085a1f26cd59e3f">degrad</a> );</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        }</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        sinsum = 0.0;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i(0); i&lt;pecclen; ++i) {</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            sinsum = sinsum + ecamp[i]*std::sin( (ecrate[i]*psecdeg*years+ecphas[i]) * <a class="code" href="namespacemodule__model__constants.html#ae781b8adc0c255fc7085a1f26cd59e3f">degrad</a> );</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        }</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160; </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        <span class="comment">// Use summations to calculate eccentricity</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160; </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        eccen2 = cossum*cossum + sinsum*sinsum;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        eccen  = std::sqrt(eccen2);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        eccen3 = eccen2*eccen;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160; </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <span class="comment">// A series of cases for fvelp, which is in radians.</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        <span class="keywordflow">if</span> (std::fabs(cossum) &lt;= 1.0e-8) {</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;            <span class="keywordflow">if</span> (sinsum == 0.0) {</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                fvelp = 0.0;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sinsum &lt;= 0.0) {</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                fvelp = 1.5*<a class="code" href="ERF__Constants_8H.html#a988c4efd6fd0d855e241e77a73191428">PI</a>;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sinsum &gt; 0.0) {</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                fvelp = 0.5*<a class="code" href="ERF__Constants_8H.html#a988c4efd6fd0d855e241e77a73191428">PI</a>;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            }</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cossum &lt;= 0.0) {</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            fvelp = std::atan(sinsum/cossum) + <a class="code" href="ERF__Constants_8H.html#a988c4efd6fd0d855e241e77a73191428">PI</a>;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            <span class="keywordflow">if</span> (sinsum &lt; 0.0) {</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                fvelp = std::atan(sinsum/cossum) + 2.0*<a class="code" href="ERF__Constants_8H.html#a988c4efd6fd0d855e241e77a73191428">PI</a>;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                fvelp = std::atan(sinsum/cossum);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;            }</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        }</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160; </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">          Summation of sin series for computation of moving vernal equinox long</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">          of perihelion (mvelp; omega bar in Berger 1978) in degrees.  For mvelp,</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">          first term is fvelp in degrees; second term is Berger 1978 psi bar</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">          times years and in degrees; third term is Berger 1978 zeta; fourth</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment">          term is series summation in degrees.  Convert the amplitudes and rates,</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment">          which are in arc seconds, into degrees via multiplication by psecdeg.</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">          Series summation plus second and third terms constitute Berger 1978</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">          psi, which is the general precession.</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">        */</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        mvsum = 0.0;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i(0); i&lt;pmvelen; ++i) {</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;            mvsum = mvsum + mvamp[i]*psecdeg*std::sin( (mvrate[i]*psecdeg*years + mvphas[i]) * <a class="code" href="namespacemodule__model__constants.html#ae781b8adc0c255fc7085a1f26cd59e3f">degrad</a>);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        }</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        mvelp = fvelp/<a class="code" href="namespacemodule__model__constants.html#ae781b8adc0c255fc7085a1f26cd59e3f">degrad</a> + <a class="code" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a>(50.439273)*psecdeg*years + <a class="code" href="ERF__OrbCosZenith_8H.html#a11d147c64891830c9e79b3315b1b2e21">real</a>(3.392506) + mvsum;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        <span class="comment">// Cases to make sure mvelp is between 0 and 360.</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            mvelp += 360.0;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        } <span class="keywordflow">while</span> (mvelp &lt; 0.0);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160; </div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;            mvelp -= 360.0;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        } <span class="keywordflow">while</span> (mvelp &gt;= 360.0);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160; </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    }  <span class="comment">// end of test on whether to calculate or use input orbital params</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="comment">// Orbit needs the obliquity in radians</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160; </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    obliqr = obliq*<a class="code" href="namespacemodule__model__constants.html#ae781b8adc0c255fc7085a1f26cd59e3f">degrad</a>;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160; </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">      180 degrees must be added to mvelp since observations are made from the</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">      earth and the sun is considered (wrongly for the algorithm) to go around</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">      the earth. For a more graphic explanation see Appendix B in:</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">      A. Berger, M. Loutre and C. Tricot. 1993.  Insolation and Earth Orbital</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">      Periods.  J. of Geophysical Research 98:10,341-10,362.</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">      Additionally, orbit will need this value in radians. So mvelp becomes</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">      mvelpp (mvelp plus pi)</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">    */</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160; </div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    mvelpp = (mvelp + 180.0)*<a class="code" href="namespacemodule__model__constants.html#ae781b8adc0c255fc7085a1f26cd59e3f">degrad</a>;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160; </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="comment">// Set up an argument used several times in lambm0 calculation ahead.</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160; </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    beta = std::sqrt(1.0 - eccen2);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160; </div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">      The mean longitude at the vernal equinox (lambda m nought in Berger</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">      1978; in radians) is calculated from the following formula given in</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">      Berger 1978.  At the vernal equinox the true longitude (lambda in Berger</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">      1978) is 0.</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">    */</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160; </div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    lambm0 = 2.0*( (.5*eccen + .125*eccen3)*(1.0 + beta)*std::sin(mvelpp)</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                   - .250*eccen2*(.5    + beta)*std::sin(2.0*mvelpp)</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                   + .125*eccen3*(1./3. + beta)*std::sin(3.0*mvelpp) );</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;}</div>
<div class="ttc" id="aERF__Constants_8H_html_a432b0c6e52c518d2923bd05ba945f17d"><div class="ttname"><a href="ERF__Constants_8H.html#a432b0c6e52c518d2923bd05ba945f17d">ORB_UNDEF_INT</a></div><div class="ttdeci">static constexpr int ORB_UNDEF_INT</div><div class="ttdef"><b>Definition:</b> ERF_Constants.H:96</div></div>
<div class="ttc" id="anamespacemodule__model__constants_html_ae781b8adc0c255fc7085a1f26cd59e3f"><div class="ttname"><a href="namespacemodule__model__constants.html#ae781b8adc0c255fc7085a1f26cd59e3f">module_model_constants::degrad</a></div><div class="ttdeci">real(c_double), parameter degrad</div><div class="ttdef"><b>Definition:</b> ERF_module_model_constants.F90:75</div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classRadiation.html#a3eab5714d47ed767884a66a8dc1058df">Radiation::run_impl()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ERF__OrbCosZenith_8H_afcf5dcbbabe64b28d04883a62431f166_icgraph.png" border="0" usemap="#aERF__OrbCosZenith_8H_afcf5dcbbabe64b28d04883a62431f166_icgraph" alt=""/></div>
<map name="aERF__OrbCosZenith_8H_afcf5dcbbabe64b28d04883a62431f166_icgraph" id="aERF__OrbCosZenith_8H_afcf5dcbbabe64b28d04883a62431f166_icgraph">
<area shape="rect" title=" " alt="" coords="593,5,713,32"/>
<area shape="rect" href="classRadiation.html#a3eab5714d47ed767884a66a8dc1058df" title=" " alt="" coords="396,5,545,32"/>
<area shape="rect" href="classRadiation.html#a85e5c7a8f70d91d8762cc241dfda691a" title=" " alt="" coords="171,5,348,32"/>
<area shape="rect" href="classRadiation.html#a08fb496755efd8324cfb28931a4112c9" title=" " alt="" coords="5,5,123,32"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_74389ed8173ad57b461b9d623a1f3867.html">Source</a></li><li class="navelem"><a class="el" href="dir_c5966e4c77938253f8e5309ef0179056.html">PhysicsInterfaces</a></li><li class="navelem"><a class="el" href="dir_92d0cc2068f59d5f91e0990cde77a08d.html">Radiation</a></li><li class="navelem"><a class="el" href="ERF__OrbCosZenith_8H.html">ERF_OrbCosZenith.H</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
