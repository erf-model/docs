<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ERF: IOManager Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ERF
   </div>
   <div id="projectbrief">Energy Research and Forecasting: An Atmospheric Modeling Code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('classIOManager.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classIOManager-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">IOManager Class Reference<div class="ingroups"><a class="el" href="group__Utilities.html">Utilities</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Input/Output manager.  
 <a href="classIOManager.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="IOManager_8H_source.html">IOManager.H</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for IOManager:</div>
<div class="dyncontent">
<div class="center"><img src="classIOManager__coll__graph.png" border="0" usemap="#IOManager_coll__map" alt="Collaboration graph"/></div>
<map name="IOManager_coll__map" id="IOManager_coll__map">
<area shape="rect" title="Input/Output manager." alt="" coords="5,95,99,121"/>
<area shape="rect" title=" " alt="" coords="21,5,83,32"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a42836f5ec9dc6352150e253e01acbdeb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIOManager.html#a42836f5ec9dc6352150e253e01acbdeb">IOManager</a> (ERF &amp;)</td></tr>
<tr class="separator:a42836f5ec9dc6352150e253e01acbdeb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1263e627ea878bbba9406b9b38f60d8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIOManager.html#aa1263e627ea878bbba9406b9b38f60d8">~IOManager</a> ()</td></tr>
<tr class="separator:aa1263e627ea878bbba9406b9b38f60d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7254c361d36c4e08117a3d486d84341"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIOManager.html#af7254c361d36c4e08117a3d486d84341">writePlotFile</a> (const std::string &amp;dir, std::ostream &amp;os, amrex::VisMF::How how)</td></tr>
<tr class="memdesc:af7254c361d36c4e08117a3d486d84341"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write all user-requested fields to disk.  <a href="classIOManager.html#af7254c361d36c4e08117a3d486d84341">More...</a><br /></td></tr>
<tr class="separator:af7254c361d36c4e08117a3d486d84341"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17056a1e637c37a4a424562529050d5d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIOManager.html#a17056a1e637c37a4a424562529050d5d">writeSmallPlotFile</a> (const std::string &amp;dir, std::ostream &amp;os, amrex::VisMF::How how)</td></tr>
<tr class="memdesc:a17056a1e637c37a4a424562529050d5d"><td class="mdescLeft">&#160;</td><td class="mdescRight">write small plotfile  <a href="classIOManager.html#a17056a1e637c37a4a424562529050d5d">More...</a><br /></td></tr>
<tr class="separator:a17056a1e637c37a4a424562529050d5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d90373f66fdbcacbf31bbe42fc2b4a8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIOManager.html#a7d90373f66fdbcacbf31bbe42fc2b4a8">checkPoint</a> (const std::string &amp;dir, std::ostream &amp;os, amrex::VisMF::How how, bool dump_old_default)</td></tr>
<tr class="memdesc:a7d90373f66fdbcacbf31bbe42fc2b4a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write checkpoint file.  <a href="classIOManager.html#a7d90373f66fdbcacbf31bbe42fc2b4a8">More...</a><br /></td></tr>
<tr class="separator:a7d90373f66fdbcacbf31bbe42fc2b4a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3027a0eeaebfb1ddc523d438b966652"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIOManager.html#ae3027a0eeaebfb1ddc523d438b966652">restart</a> (amrex::Amr &amp;papa, std::istream &amp;is, bool bReadSpecial)</td></tr>
<tr class="memdesc:ae3027a0eeaebfb1ddc523d438b966652"><td class="mdescLeft">&#160;</td><td class="mdescRight">restart using checkpoint file  <a href="classIOManager.html#ae3027a0eeaebfb1ddc523d438b966652">More...</a><br /></td></tr>
<tr class="separator:ae3027a0eeaebfb1ddc523d438b966652"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b7eea06a1e32b99bceee9942c8eb464"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIOManager.html#a6b7eea06a1e32b99bceee9942c8eb464">set_state_in_checkpoint</a> (amrex::Vector&lt; int &gt; &amp;state_in_checkpoint)</td></tr>
<tr class="memdesc:a6b7eea06a1e32b99bceee9942c8eb464"><td class="mdescLeft">&#160;</td><td class="mdescRight">set state in checkpoint  <a href="classIOManager.html#a6b7eea06a1e32b99bceee9942c8eb464">More...</a><br /></td></tr>
<tr class="separator:a6b7eea06a1e32b99bceee9942c8eb464"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21c83577ab05a3626e902b5f1825c6a3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIOManager.html#a21c83577ab05a3626e902b5f1825c6a3">setPlotVariables</a> ()</td></tr>
<tr class="memdesc:a21c83577ab05a3626e902b5f1825c6a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">setup the plot variables  <a href="classIOManager.html#a21c83577ab05a3626e902b5f1825c6a3">More...</a><br /></td></tr>
<tr class="separator:a21c83577ab05a3626e902b5f1825c6a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a458cd55e2e1e3cf2626b606f0ccfc223"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIOManager.html#a458cd55e2e1e3cf2626b606f0ccfc223">writeJobInfo</a> (const std::string &amp;dir)</td></tr>
<tr class="memdesc:a458cd55e2e1e3cf2626b606f0ccfc223"><td class="mdescLeft">&#160;</td><td class="mdescRight">write job information  <a href="classIOManager.html#a458cd55e2e1e3cf2626b606f0ccfc223">More...</a><br /></td></tr>
<tr class="separator:a458cd55e2e1e3cf2626b606f0ccfc223"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98b07fb4d16bd248d0b69ada41d85aac"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIOManager.html#a98b07fb4d16bd248d0b69ada41d85aac">createNCColumnFile</a> (const std::string &amp;colfile_name, const amrex::Real xloc, const amrex::Real yloc)</td></tr>
<tr class="memdesc:a98b07fb4d16bd248d0b69ada41d85aac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create 1D vertical column output for coupling.  <a href="classIOManager.html#a98b07fb4d16bd248d0b69ada41d85aac">More...</a><br /></td></tr>
<tr class="separator:a98b07fb4d16bd248d0b69ada41d85aac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae07f10c3fde49c1e5f59b0dea6659e2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIOManager.html#aae07f10c3fde49c1e5f59b0dea6659e2">writeToNCColumnFile</a> (const std::string &amp;colfile_name, const amrex::Real xloc, const amrex::Real yloc)</td></tr>
<tr class="memdesc:aae07f10c3fde49c1e5f59b0dea6659e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write a timestep to 1D vertical column output for coupling.  <a href="classIOManager.html#aae07f10c3fde49c1e5f59b0dea6659e2">More...</a><br /></td></tr>
<tr class="separator:aae07f10c3fde49c1e5f59b0dea6659e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a2d47c67a7993b7e4b7bace1fc06e792a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIOManager.html#a2d47c67a7993b7e4b7bace1fc06e792a">writeBuildInfo</a> (std::ostream &amp;os)</td></tr>
<tr class="memdesc:a2d47c67a7993b7e4b7bace1fc06e792a"><td class="mdescLeft">&#160;</td><td class="mdescRight">write build information  <a href="classIOManager.html#a2d47c67a7993b7e4b7bace1fc06e792a">More...</a><br /></td></tr>
<tr class="separator:a2d47c67a7993b7e4b7bace1fc06e792a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:aed10780741a2c90b7916a6353e560075"><td class="memItemLeft" align="right" valign="top">ERF &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a></td></tr>
<tr class="separator:aed10780741a2c90b7916a6353e560075"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Input/Output manager. </p>
<p>This class contains infrastructure to output solution fields during the simulation as well as code that reads a checkpoint file during a restarted simulation. By default the eqsys register the necessary fields during initialization and these fields are output into plot-file and checkpoint file formats based on output frequencies managed by SimTime. The user can request additional fields be output by setting appropriate parameters in the input file. The class also provides the ability to override output of the default fields and output a subset of those fields. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a42836f5ec9dc6352150e253e01acbdeb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42836f5ec9dc6352150e253e01acbdeb">&#9670;&nbsp;</a></span>IOManager()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">IOManager::IOManager </td>
          <td>(</td>
          <td class="paramtype">ERF &amp;&#160;</td>
          <td class="paramname"><em>erf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    : <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>(<a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>) {}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa1263e627ea878bbba9406b9b38f60d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1263e627ea878bbba9406b9b38f60d8">&#9670;&nbsp;</a></span>~IOManager()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">IOManager::~IOManager </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">default</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a7d90373f66fdbcacbf31bbe42fc2b4a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d90373f66fdbcacbf31bbe42fc2b4a8">&#9670;&nbsp;</a></span>checkPoint()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IOManager::checkPoint </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>os</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::VisMF::How&#160;</td>
          <td class="paramname"><em>how</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>dump_old_default</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write checkpoint file. </p>
<div class="fragment"><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;{</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.level == 0 &amp;&amp; amrex::ParallelDescriptor::IOProcessor()) {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    {</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      std::ofstream ERFHeaderFile;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      std::string FullPathERFHeaderFile = dir;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      FullPathERFHeaderFile += <span class="stringliteral">&quot;/ERFHeader&quot;</span>;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      ERFHeaderFile.open(FullPathERFHeaderFile.c_str(), std::ios::out);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      ERFHeaderFile &lt;&lt; <span class="stringliteral">&quot;Checkpoint version: &quot;</span> &lt;&lt; current_version &lt;&lt; std::endl;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      ERFHeaderFile.close();</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    }</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      <span class="comment">// store elapsed CPU time</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      std::ofstream CPUFile;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      std::string FullPathCPUFile = dir;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      FullPathCPUFile += <span class="stringliteral">&quot;/CPUtime&quot;</span>;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      CPUFile.open(FullPathCPUFile.c_str(), std::ios::out);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      CPUFile &lt;&lt; std::setprecision(15) &lt;&lt; <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.getCPUTime();</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      CPUFile.close();</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    }</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="comment">/*Not implemented for CUDA{</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">        // store any problem-specific stuff</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">        char * dir_for_pass = new char[dir.size() + 1];</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">        std::copy(dir.begin(), dir.end(), dir_for_pass);</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">        dir_for_pass[dir.size()] = &#39;\0&#39;;</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">        int len = dir.size();</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">        Vector&lt;int&gt; int_dir_name(len);</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">        for (int j = 0; j &lt; len; j++)</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">      int_dir_name[j] = (int) dir_for_pass[j];</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">        AMREX_FORT_PROC_CALL(PROBLEM_CHECKPOINT,problem_checkpoint)(int_dir_name.dataPtr(),</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">    &amp;len);</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">        delete [] dir_for_pass;</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">    }*/</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a98b07fb4d16bd248d0b69ada41d85aac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98b07fb4d16bd248d0b69ada41d85aac">&#9670;&nbsp;</a></span>createNCColumnFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IOManager::createNCColumnFile </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>colfile_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real&#160;</td>
          <td class="paramname"><em>xloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real&#160;</td>
          <td class="paramname"><em>yloc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create 1D vertical column output for coupling. </p>
<div class="fragment"><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;{</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;  <span class="comment">// TODO: Relax assumption of only a single level</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.parent-&gt;finestLevel() &gt; 0) {</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    amrex::Error(<span class="stringliteral">&quot;Cannot createNCColumnFile: present implementation assumes only a single level is present&quot;</span>);</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;  }</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;  <span class="comment">// Create file to which column data will be written every timestep</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;  <span class="keywordflow">if</span> (amrex::ParallelDescriptor::IOProcessor()) {</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <span class="keyword">auto</span> ncf = <a class="code" href="classncutils_1_1NCFile.html#a47bdccee2cc22a735ca715d9c88e4f6b">ncutils::NCFile::create</a>(colfile_name, NC_CLOBBER | NC_NETCDF4);</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <span class="keyword">const</span> std::string nt_name = <span class="stringliteral">&quot;ntime&quot;</span>;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <span class="keyword">const</span> std::string nh_name = <span class="stringliteral">&quot;nheight&quot;</span>;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <span class="comment">// Use one grow cell (on either side) to allow interpolation to boundaries</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> nheights = <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.geom.Domain().length(2) + 2;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    ncf.enter_def_mode();</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    ncf.put_attr(<span class="stringliteral">&quot;title&quot;</span>, <span class="stringliteral">&quot;ERF NetCDF Vertical Column Output&quot;</span>);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    ncf.put_attr(<span class="stringliteral">&quot;units&quot;</span>, <span class="stringliteral">&quot;mks&quot;</span>);</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    amrex::Vector&lt;amrex::Real&gt; loc = {xloc, yloc};</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    ncf.put_attr(<span class="stringliteral">&quot;location&quot;</span>, loc);</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    ncf.def_dim(nt_name, NC_UNLIMITED);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    ncf.def_dim(nh_name, nheights);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    ncf.def_var(<span class="stringliteral">&quot;times&quot;</span>, NC_FLOAT, {nt_name});</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    ncf.def_var(<span class="stringliteral">&quot;heights&quot;</span>, NC_FLOAT, {nh_name});</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    ncf.def_var(<span class="stringliteral">&quot;wrf_momentum_u&quot;</span>, NC_FLOAT, {nt_name, nh_name});</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    ncf.def_var(<span class="stringliteral">&quot;wrf_momentum_v&quot;</span>, NC_FLOAT, {nt_name, nh_name});</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    ncf.def_var(<span class="stringliteral">&quot;wrf_temperature&quot;</span>, NC_FLOAT, {nt_name, nh_name});</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    ncf.def_var(<span class="stringliteral">&quot;wrf_tflux&quot;</span>, NC_FLOAT, {nt_name});</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    ncf.exit_def_mode();</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="comment">// Put in the Z grid, but not any actual data yet</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    amrex::Real zmin = <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.geom.ProbLo(2);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    amrex::Real dz = <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.geom.CellSize(2);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    amrex::Vector&lt;amrex::Real&gt; zvalues(nheights, zmin-0.5*dz);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii &lt; nheights; ++ii) {</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;      zvalues[ii] += ii * dz;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    }</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    ncf.var(<span class="stringliteral">&quot;heights&quot;</span>).put(zvalues.data());</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    ncf.close();</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  }</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classIOManager_a98b07fb4d16bd248d0b69ada41d85aac_cgraph.png" border="0" usemap="#classIOManager_a98b07fb4d16bd248d0b69ada41d85aac_cgraph" alt=""/></div>
<map name="classIOManager_a98b07fb4d16bd248d0b69ada41d85aac_cgraph" id="classIOManager_a98b07fb4d16bd248d0b69ada41d85aac_cgraph">
<area shape="rect" title="Create 1D vertical column output for coupling." alt="" coords="5,31,240,57"/>
<area shape="rect" href="classncutils_1_1NCFile.html#a47bdccee2cc22a735ca715d9c88e4f6b" title=" " alt="" coords="288,31,452,57"/>
<area shape="rect" href="classncutils_1_1NCGroup.html#a3d53c2f625cc6fc286e76c9137b5b1b0" title="Name of this group." alt="" coords="500,5,676,32"/>
<area shape="rect" href="classncutils_1_1NCFile.html#aec0e1a7f0f93f2f806c0a0abaae66423" title=" " alt="" coords="505,56,671,83"/>
</map>
</div>

</div>
</div>
<a id="ae3027a0eeaebfb1ddc523d438b966652"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3027a0eeaebfb1ddc523d438b966652">&#9670;&nbsp;</a></span>restart()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IOManager::restart </td>
          <td>(</td>
          <td class="paramtype">amrex::Amr &amp;&#160;</td>
          <td class="paramname"><em>papa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::istream &amp;&#160;</td>
          <td class="paramname"><em>is</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>bReadSpecial</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>restart using checkpoint file </p>
<div class="fragment"><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;{</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="comment">// Let&#39;s check ERF checkpoint version first;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="comment">// trying to read from checkpoint; if nonexisting, set it to 0.</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="keywordflow">if</span> (input_version == -1) {</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keywordflow">if</span> (amrex::ParallelDescriptor::IOProcessor()) {</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;      std::ifstream ERFHeaderFile;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      std::string FullPathERFHeaderFile = papa.theRestartFile();</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      FullPathERFHeaderFile += <span class="stringliteral">&quot;/ERFHeader&quot;</span>;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      ERFHeaderFile.open(FullPathERFHeaderFile.c_str(), std::ios::in);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      <span class="keywordflow">if</span> (ERFHeaderFile.good()) {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        <span class="keywordtype">char</span> foo[256];</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <span class="comment">// first line: Checkpoint version: ?</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        ERFHeaderFile.getline(foo, 256, <span class="charliteral">&#39;:&#39;</span>);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        ERFHeaderFile &gt;&gt; input_version;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        ERFHeaderFile.close();</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        input_version = 0;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      }</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    }</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    amrex::ParallelDescriptor::Bcast(</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      &amp;input_version, 1, amrex::ParallelDescriptor::IOProcessorNumber());</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  }</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  AMREX_ASSERT(input_version &gt;= 0);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">    Deal here with new state descriptor types added, with corresponding</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">    input_version &gt; 0, if applicable</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  amrex::Vector&lt;int&gt; state_in_checkpoint(<a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.desc_lst.size(), 1);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <a class="code" href="classIOManager.html#a6b7eea06a1e32b99bceee9942c8eb464">set_state_in_checkpoint</a>(state_in_checkpoint);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.desc_lst.size(); ++i) {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keywordflow">if</span> (state_in_checkpoint[i] == 0) {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      <span class="keyword">const</span> amrex::Real ctime = <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.state[i - 1].curTime();</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.state[i].define(</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.geom.Domain(), <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.grids, <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.dmap, <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.desc_lst[i], ctime, <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.parent-&gt;dtLevel(<a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.level),</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        *(<a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.m_factory));</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.state[i] = <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.state[i - 1];</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  }</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.buildMetrics();</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  amrex::MultiFab&amp; S_new = <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.get_new_data(State_Type);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.Sborder.define(<a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.grids, <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.dmap, <a class="code" href="IndexDefines_8H.html#ad5195ac8f863f5a9a7eaa0db094f7639">NVAR</a>, <a class="code" href="IndexDefines_8H.html#aaf6046446c90ca7f5b9a7de90b661607">NUM_GROW</a>, amrex::MFInfo(), <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.Factory());</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="comment">// get the elapsed CPU time to now;</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.level == 0 &amp;&amp; amrex::ParallelDescriptor::IOProcessor()) {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">// get elapsed CPU time</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    std::ifstream CPUFile;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    std::string FullPathCPUFile = <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.parent-&gt;theRestartFile();</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    FullPathCPUFile += <span class="stringliteral">&quot;/CPUtime&quot;</span>;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    CPUFile.open(FullPathCPUFile.c_str(), std::ios::in);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    CPUFile &gt;&gt; <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.previousCPUTimeUsed;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    CPUFile.close();</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    amrex::Print() &lt;&lt; <span class="stringliteral">&quot;read CPU time: &quot;</span> &lt;&lt; <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.previousCPUTimeUsed &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  }</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="comment">/*Not implemented for CUDA</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">      if (level == 0)</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">      {</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">    // get problem-specific stuff -- note all processors do this,</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">    // eliminating the need for a broadcast</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">    std::string dir = parent-&gt;theRestartFile();</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">    char * dir_for_pass = new char[dir.size() + 1];</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">    std::copy(dir.begin(), dir.end(), dir_for_pass);</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">    dir_for_pass[dir.size()] = &#39;\0&#39;;</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">    int len = dir.size();</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">    Vector&lt;int&gt; int_dir_name(len);</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">    for (int j = 0; j &lt; len; j++)</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">        int_dir_name[j] = (int) dir_for_pass[j];</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">    AMREX_FORT_PROC_CALL(PROBLEM_RESTART,problem_restart)(int_dir_name.dataPtr(),</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">    &amp;len);</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">    delete [] dir_for_pass;</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">      }*/</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.level &gt; 0 &amp;&amp; <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.do_reflux) {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.flux_reg.define(</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.grids, papa.boxArray(<a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.level - 1), <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.dmap, papa.DistributionMap(<a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.level - 1),</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.geom, papa.Geom(<a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.level - 1), papa.refRatio(<a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.level - 1), <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.level, <a class="code" href="IndexDefines_8H.html#ad5195ac8f863f5a9a7eaa0db094f7639">NVAR</a>);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classIOManager_ae3027a0eeaebfb1ddc523d438b966652_cgraph.png" border="0" usemap="#classIOManager_ae3027a0eeaebfb1ddc523d438b966652_cgraph" alt=""/></div>
<map name="classIOManager_ae3027a0eeaebfb1ddc523d438b966652_cgraph" id="classIOManager_ae3027a0eeaebfb1ddc523d438b966652_cgraph">
<area shape="rect" title="restart using checkpoint file" alt="" coords="5,13,149,39"/>
<area shape="rect" href="classIOManager.html#a6b7eea06a1e32b99bceee9942c8eb464" title="set state in checkpoint" alt="" coords="197,5,359,47"/>
</map>
</div>

</div>
</div>
<a id="a6b7eea06a1e32b99bceee9942c8eb464"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b7eea06a1e32b99bceee9942c8eb464">&#9670;&nbsp;</a></span>set_state_in_checkpoint()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IOManager::set_state_in_checkpoint </td>
          <td>(</td>
          <td class="paramtype">amrex::Vector&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>state_in_checkpoint</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>set state in checkpoint </p>
<div class="fragment"><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;{</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.num_state_type; ++i) {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    state_in_checkpoint[i] = 1;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keywordflow">if</span> (i == Work_Estimate_Type) {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      state_in_checkpoint[i] = 0;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    }</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  }</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classIOManager.html#ae3027a0eeaebfb1ddc523d438b966652">restart()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classIOManager_a6b7eea06a1e32b99bceee9942c8eb464_icgraph.png" border="0" usemap="#classIOManager_a6b7eea06a1e32b99bceee9942c8eb464_icgraph" alt=""/></div>
<map name="classIOManager_a6b7eea06a1e32b99bceee9942c8eb464_icgraph" id="classIOManager_a6b7eea06a1e32b99bceee9942c8eb464_icgraph">
<area shape="rect" title="set state in checkpoint" alt="" coords="197,5,359,47"/>
<area shape="rect" href="classIOManager.html#ae3027a0eeaebfb1ddc523d438b966652" title="restart using checkpoint file" alt="" coords="5,13,149,39"/>
</map>
</div>

</div>
</div>
<a id="a21c83577ab05a3626e902b5f1825c6a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21c83577ab05a3626e902b5f1825c6a3">&#9670;&nbsp;</a></span>setPlotVariables()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IOManager::setPlotVariables </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>setup the plot variables </p>
<div class="fragment"><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;{</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2d47c67a7993b7e4b7bace1fc06e792a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d47c67a7993b7e4b7bace1fc06e792a">&#9670;&nbsp;</a></span>writeBuildInfo()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void IOManager::writeBuildInfo </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>os</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>write build information </p>
<div class="fragment"><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;{</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  std::string PrettyLine = std::string(78, <span class="charliteral">&#39;=&#39;</span>) + <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  std::string OtherLine = std::string(78, <span class="charliteral">&#39;-&#39;</span>) + <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  std::string SkipSpace = std::string(8, <span class="charliteral">&#39; &#39;</span>);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="comment">// build information</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  os &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot; ERF Build Information\n&quot;</span>;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  os &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160; </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;build date:    &quot;</span> &lt;&lt; amrex::buildInfoGetBuildDate() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;build machine: &quot;</span> &lt;&lt; amrex::buildInfoGetBuildMachine() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;build dir:     &quot;</span> &lt;&lt; amrex::buildInfoGetBuildDir() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;AMReX dir:     &quot;</span> &lt;&lt; amrex::buildInfoGetAMReXDir() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160; </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160; </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;COMP:          &quot;</span> &lt;&lt; amrex::buildInfoGetComp() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;COMP version:  &quot;</span> &lt;&lt; amrex::buildInfoGetCompVersion() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160; </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;C++ compiler:  &quot;</span> &lt;&lt; amrex::buildInfoGetCXXName() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;C++ flags:     &quot;</span> &lt;&lt; amrex::buildInfoGetCXXFlags() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160; </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;Link flags:    &quot;</span> &lt;&lt; amrex::buildInfoGetLinkFlags() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;Libraries:     &quot;</span> &lt;&lt; amrex::buildInfoGetLibraries() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160; </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160; </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 1; n &lt;= amrex::buildInfoGetNumModules(); n++) {</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    os &lt;&lt; amrex::buildInfoGetModuleName(n) &lt;&lt; <span class="stringliteral">&quot;: &quot;</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;       &lt;&lt; amrex::buildInfoGetModuleVal(n) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  }</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160; </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* githash1 = amrex::buildInfoGetGitHash(1);</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* githash2 = amrex::buildInfoGetGitHash(2);</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <span class="keywordflow">if</span> (strlen(githash1) &gt; 0) {</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;ERF       git hash: &quot;</span> &lt;&lt; githash1 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  }</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <span class="keywordflow">if</span> (strlen(githash2) &gt; 0) {</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;AMReX       git hash: &quot;</span> &lt;&lt; githash2 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  }</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160; </div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* buildgithash = amrex::buildInfoGetBuildGitHash();</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* buildgitname = amrex::buildInfoGetBuildGitName();</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <span class="keywordflow">if</span> (strlen(buildgithash) &gt; 0) {</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    os &lt;&lt; buildgitname &lt;&lt; <span class="stringliteral">&quot; git hash: &quot;</span> &lt;&lt; buildgithash &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  }</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot; ERF Compile time variables: \n&quot;</span>;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot; ERF Defines: \n&quot;</span>;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  os &lt;&lt; std::setw(35) &lt;&lt; std::left &lt;&lt; <span class="stringliteral">&quot;_OPENMP &quot;</span> &lt;&lt; std::setw(6) &lt;&lt; <span class="stringliteral">&quot;ON&quot;</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;     &lt;&lt; std::endl;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  os &lt;&lt; std::setw(35) &lt;&lt; std::left &lt;&lt; <span class="stringliteral">&quot;_OPENMP &quot;</span> &lt;&lt; std::setw(6) &lt;&lt; <span class="stringliteral">&quot;OFF&quot;</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;     &lt;&lt; std::endl;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160; </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="preprocessor">#ifdef MPI_VERSION</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  os &lt;&lt; std::setw(35) &lt;&lt; std::left &lt;&lt; <span class="stringliteral">&quot;MPI_VERSION &quot;</span> &lt;&lt; std::setw(6)</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;     &lt;&lt; MPI_VERSION &lt;&lt; std::endl;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  os &lt;&lt; std::setw(35) &lt;&lt; std::left &lt;&lt; <span class="stringliteral">&quot;MPI_VERSION &quot;</span> &lt;&lt; std::setw(6)</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;     &lt;&lt; <span class="stringliteral">&quot;UNDEFINED&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="preprocessor">#ifdef MPI_SUBVERSION</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  os &lt;&lt; std::setw(35) &lt;&lt; std::left &lt;&lt; <span class="stringliteral">&quot;MPI_SUBVERSION &quot;</span> &lt;&lt; std::setw(6)</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;     &lt;&lt; MPI_SUBVERSION &lt;&lt; std::endl;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  os &lt;&lt; std::setw(35) &lt;&lt; std::left &lt;&lt; <span class="stringliteral">&quot;MPI_SUBVERSION &quot;</span> &lt;&lt; std::setw(6)</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;     &lt;&lt; <span class="stringliteral">&quot;UNDEFINED&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160; </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="preprocessor">#ifdef NUM_ADV</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  os &lt;&lt; std::setw(35) &lt;&lt; std::left &lt;&lt; <span class="stringliteral">&quot;NUM_ADV=&quot;</span> &lt;&lt; <a class="code" href="IndexDefines_8H.html#ac7c21c1d1c96b568a7eefbe3c997238e">NUM_ADV</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  os &lt;&lt; std::setw(35) &lt;&lt; std::left &lt;&lt; <span class="stringliteral">&quot;NUM_ADV&quot;</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;     &lt;&lt; <span class="stringliteral">&quot;is undefined (0)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160; </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classIOManager_a2d47c67a7993b7e4b7bace1fc06e792a_icgraph.png" border="0" usemap="#classIOManager_a2d47c67a7993b7e4b7bace1fc06e792a_icgraph" alt=""/></div>
<map name="classIOManager_a2d47c67a7993b7e4b7bace1fc06e792a_icgraph" id="classIOManager_a2d47c67a7993b7e4b7bace1fc06e792a_icgraph">
<area shape="rect" title="write build information" alt="" coords="108,5,300,32"/>
<area shape="rect" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,60,32"/>
</map>
</div>

</div>
</div>
<a id="a458cd55e2e1e3cf2626b606f0ccfc223"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a458cd55e2e1e3cf2626b606f0ccfc223">&#9670;&nbsp;</a></span>writeJobInfo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IOManager::writeJobInfo </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>dir</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>write job information </p>
<div class="fragment"><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;{</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="comment">// job_info file with details about the run</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  std::ofstream jobInfoFile;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  std::string FullPathJobInfoFile = dir;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  FullPathJobInfoFile += <span class="stringliteral">&quot;/job_info&quot;</span>;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  jobInfoFile.open(FullPathJobInfoFile.c_str(), std::ios::out);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  std::string PrettyLine = <span class="stringliteral">&quot;===================================================&quot;</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                           <span class="stringliteral">&quot;============================\n&quot;</span>;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  std::string OtherLine = <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                          <span class="stringliteral">&quot;----------------------------\n&quot;</span>;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  std::string SkipSpace = <span class="stringliteral">&quot;        &quot;</span>;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160; </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <span class="comment">// job information</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot; ERF Job Information\n&quot;</span>;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;inputs file: &quot;</span> &lt;&lt; <a class="code" href="NCPlotFile_8H.html#aabaa127a3a319c1b86090d6c88568965">inputs_name</a> &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;number of MPI processes: &quot;</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;              &lt;&lt; amrex::ParallelDescriptor::NProcs() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;number of threads:       &quot;</span> &lt;&lt; omp_get_max_threads() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;CPU time used since start of simulation (CPU-hours): &quot;</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;              &lt;&lt; <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.getCPUTime() / 3600.0;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="comment">// plotfile information</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot; Plotfile Information\n&quot;</span>;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  time_t now = time(0);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="comment">// Convert now to tm struct for local timezone</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  tm* localtm = localtime(&amp;now);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;output data / time: &quot;</span> &lt;&lt; asctime(localtm);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  std::string currentDir = amrex::FileSystem::CurrentPath();</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;output dir:         &quot;</span> &lt;&lt; currentDir &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <span class="comment">// build information</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot; Build Information\n&quot;</span>;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;build date:    &quot;</span> &lt;&lt; amrex::buildInfoGetBuildDate() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;build machine: &quot;</span> &lt;&lt; amrex::buildInfoGetBuildMachine() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;build dir:     &quot;</span> &lt;&lt; amrex::buildInfoGetBuildDir() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;AMReX dir:     &quot;</span> &lt;&lt; amrex::buildInfoGetAMReXDir() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;COMP:          &quot;</span> &lt;&lt; amrex::buildInfoGetComp() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;COMP version:  &quot;</span> &lt;&lt; amrex::buildInfoGetCompVersion() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;FCOMP:         &quot;</span> &lt;&lt; amrex::buildInfoGetFcomp() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;FCOMP version: &quot;</span> &lt;&lt; amrex::buildInfoGetFcompVersion() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 1; n &lt;= amrex::buildInfoGetNumModules(); n++) {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    jobInfoFile &lt;&lt; amrex::buildInfoGetModuleName(n) &lt;&lt; <span class="stringliteral">&quot;: &quot;</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                &lt;&lt; amrex::buildInfoGetModuleVal(n) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  }</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* githash1 = amrex::buildInfoGetGitHash(1);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* githash2 = amrex::buildInfoGetGitHash(2);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="keywordflow">if</span> (strlen(githash1) &gt; 0) {</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;ERF       git hash: &quot;</span> &lt;&lt; githash1 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  }</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <span class="keywordflow">if</span> (strlen(githash2) &gt; 0) {</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;AMReX       git hash: &quot;</span> &lt;&lt; githash2 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  }</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* buildgithash = amrex::buildInfoGetBuildGitHash();</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* buildgitname = amrex::buildInfoGetBuildGitName();</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="keywordflow">if</span> (strlen(buildgithash) &gt; 0) {</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    jobInfoFile &lt;&lt; buildgitname &lt;&lt; <span class="stringliteral">&quot; git hash: &quot;</span> &lt;&lt; buildgithash &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="comment">// grid information</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot; Grid Information\n&quot;</span>;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="keywordtype">int</span> f_lev = <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.parent-&gt;finestLevel();</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= f_lev; i++) {</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot; level: &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;   number of boxes = &quot;</span> &lt;&lt; <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.parent-&gt;numGrids(i) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;   maximum zones   = &quot;</span>;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; AMREX_SPACEDIM; n++) {</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      jobInfoFile &lt;&lt; <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.parent-&gt;Geom(i).Domain().length(n) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      <span class="comment">// jobInfoFile &lt;&lt; parent-&gt;Geom(i).ProbHi(n) &lt;&lt; &quot; &quot;;</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    }</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  }</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160; </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot; Boundary conditions\n&quot;</span>;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  amrex::Vector&lt;std::string&gt; lo_bc_out(AMREX_SPACEDIM);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  amrex::Vector&lt;std::string&gt; hi_bc_out(AMREX_SPACEDIM);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  amrex::ParmParse pp(<span class="stringliteral">&quot;erf&quot;</span>);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  pp.getarr(<span class="stringliteral">&quot;lo_bc&quot;</span>, lo_bc_out, 0, AMREX_SPACEDIM);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  pp.getarr(<span class="stringliteral">&quot;hi_bc&quot;</span>, hi_bc_out, 0, AMREX_SPACEDIM);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <span class="comment">// these names correspond to the integer flags setup in the</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="comment">// Setup.cpp</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160; </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;   -x: &quot;</span> &lt;&lt; lo_bc_out[0] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;   +x: &quot;</span> &lt;&lt; hi_bc_out[0] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;   -y: &quot;</span> &lt;&lt; lo_bc_out[1] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;   +y: &quot;</span> &lt;&lt; hi_bc_out[1] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;   -z: &quot;</span> &lt;&lt; lo_bc_out[2] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;   +z: &quot;</span> &lt;&lt; hi_bc_out[2] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="keywordtype">int</span> mlen = 20;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160; </div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot; Species Information\n&quot;</span>;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  jobInfoFile &lt;&lt; std::setw(6) &lt;&lt; <span class="stringliteral">&quot;index&quot;</span> &lt;&lt; SkipSpace &lt;&lt; std::setw(mlen + 1)</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;name&quot;</span> &lt;&lt; SkipSpace &lt;&lt; std::setw(7) &lt;&lt; <span class="stringliteral">&quot;A&quot;</span> &lt;&lt; SkipSpace</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;              &lt;&lt; std::setw(7) &lt;&lt; <span class="stringliteral">&quot;Z&quot;</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  jobInfoFile &lt;&lt; OtherLine;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <span class="comment">// runtime parameters</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot; Inputs File Parameters\n&quot;</span>;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160; </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  amrex::ParmParse::dumpTable(jobInfoFile, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  jobInfoFile.close();</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classIOManager.html#af7254c361d36c4e08117a3d486d84341">writePlotFile()</a>, and <a class="el" href="classIOManager.html#a17056a1e637c37a4a424562529050d5d">writeSmallPlotFile()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classIOManager_a458cd55e2e1e3cf2626b606f0ccfc223_icgraph.png" border="0" usemap="#classIOManager_a458cd55e2e1e3cf2626b606f0ccfc223_icgraph" alt=""/></div>
<map name="classIOManager_a458cd55e2e1e3cf2626b606f0ccfc223_icgraph" id="classIOManager_a458cd55e2e1e3cf2626b606f0ccfc223_icgraph">
<area shape="rect" title="write job information" alt="" coords="272,31,451,57"/>
<area shape="rect" href="classIOManager.html#af7254c361d36c4e08117a3d486d84341" title="Write all user&#45;requested fields to disk." alt="" coords="23,5,206,32"/>
<area shape="rect" href="classIOManager.html#a17056a1e637c37a4a424562529050d5d" title="write small plotfile" alt="" coords="5,56,224,83"/>
</map>
</div>

</div>
</div>
<a id="af7254c361d36c4e08117a3d486d84341"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7254c361d36c4e08117a3d486d84341">&#9670;&nbsp;</a></span>writePlotFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IOManager::writePlotFile </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>os</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::VisMF::How&#160;</td>
          <td class="paramname"><em>how</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write all user-requested fields to disk. </p>
<div class="fragment"><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;{</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;std::cout &lt;&lt; <span class="stringliteral">&quot;writePlotFile_00&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  <span class="keywordtype">int</span> i, n;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  <span class="comment">// The list of indices of State to write to plotfile.</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  <span class="comment">// first component of pair is state_type,</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  <span class="comment">// second component of pair is component # within the state_type</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  amrex::Vector&lt;std::pair&lt;int, int&gt;&gt; plot_var_map;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> typ = 0; typ &lt; <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.desc_lst.size(); typ++)</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> comp = 0; comp &lt; <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.desc_lst[typ].nComp(); comp++)</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.parent-&gt;isStatePlotVar(<a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.desc_lst[typ].name(comp)) &amp;&amp;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.desc_lst[typ].getType() == amrex::IndexType::TheCellType())</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        plot_var_map.push_back(std::pair&lt;int, int&gt;(typ, comp));</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160; </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  <span class="keywordtype">int</span> num_derive = 0;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  std::list&lt;std::string&gt; derive_names;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  <span class="keyword">const</span> std::list&lt;amrex::DeriveRec&gt;&amp; dlist = <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.derive_lst.dlist();</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160; </div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  <span class="keywordflow">for</span> (std::list&lt;amrex::DeriveRec&gt;::const_iterator it = dlist.begin(),</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                                                   end = dlist.end();</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;       it != end; ++it)</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  {</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.parent-&gt;isDerivePlotVar(it-&gt;name())) {</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;      {</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        derive_names.push_back(it-&gt;name());</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        num_derive += it-&gt;numDerive();</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      }</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    }</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  }</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160; </div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  <span class="keywordtype">int</span> n_data_items = plot_var_map.size() + num_derive;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160; </div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  amrex::Real cur_time = <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.state[State_Type].curTime();</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160; </div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.level == 0 &amp;&amp; amrex::ParallelDescriptor::IOProcessor()) {</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="comment">// The first thing we write out is the plotfile type.</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    os &lt;&lt; <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.thePlotFileType() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160; </div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="keywordflow">if</span> (n_data_items == 0)</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      amrex::Error(<span class="stringliteral">&quot;Must specify at least one valid data item to plot&quot;</span>);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160; </div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    os &lt;&lt; n_data_items &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160; </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="comment">// Names of variables -- first state, then derived</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; plot_var_map.size(); i++) {</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;      <span class="keywordtype">int</span> typ = plot_var_map[i].first;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;      <span class="keywordtype">int</span> comp = plot_var_map[i].second;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;      os &lt;&lt; <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.desc_lst[typ].name(comp) &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    }</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160; </div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="keywordflow">for</span> (std::list&lt;std::string&gt;::const_iterator it = derive_names.begin(),</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                                                end = derive_names.end();</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;         it != end; ++it) {</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      <span class="keyword">const</span> amrex::DeriveRec* rec = <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.derive_lst.get(*it);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; rec-&gt;numDerive(); i++)</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        os &lt;&lt; rec-&gt;variableName(i) &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    }</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160; </div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    os &lt;&lt; AMREX_SPACEDIM &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    os &lt;&lt; <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.parent-&gt;cumTime() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="keywordtype">int</span> f_lev = <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.parent-&gt;finestLevel();</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    os &lt;&lt; f_lev &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; AMREX_SPACEDIM; i++)</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;      os &lt;&lt; amrex::DefaultGeometry().ProbLo(i) &lt;&lt; <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; AMREX_SPACEDIM; i++)</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;      os &lt;&lt; amrex::DefaultGeometry().ProbHi(i) &lt;&lt; <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; f_lev; i++)</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;      os &lt;&lt; <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.parent-&gt;refRatio(i)[0] &lt;&lt; <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt;= f_lev; i++)</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;      os &lt;&lt; <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.parent-&gt;Geom(i).Domain() &lt;&lt; <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt;= f_lev; i++)</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;      os &lt;&lt; <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.parent-&gt;levelSteps(i) &lt;&lt; <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt;= f_lev; i++) {</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; AMREX_SPACEDIM; k++)</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        os &lt;&lt; <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.parent-&gt;Geom(i).CellSize()[k] &lt;&lt; <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;      os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    }</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    os &lt;&lt; (int)amrex::DefaultGeometry().Coord() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;0\n&quot;</span>; <span class="comment">// Write bndry data.</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160; </div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <a class="code" href="classIOManager.html#a458cd55e2e1e3cf2626b606f0ccfc223">writeJobInfo</a>(dir);</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  }</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  <span class="comment">// Build the directory to hold the MultiFab at this level.</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  <span class="comment">// The name is relative to the directory containing the Header file.</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> std::string BaseName = <span class="stringliteral">&quot;/Cell&quot;</span>;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  <span class="keywordtype">char</span> buf[64];</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  sprintf(buf, <span class="stringliteral">&quot;Level_%d&quot;</span>, <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.level);</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  std::string LevelStr = buf;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  <span class="comment">// Now for the full pathname of that directory.</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  std::string FullPath = dir;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  <span class="keywordflow">if</span> (!FullPath.empty() &amp;&amp; FullPath[FullPath.size() - 1] != <span class="charliteral">&#39;/&#39;</span>)</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    FullPath += <span class="charliteral">&#39;/&#39;</span>;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  FullPath += LevelStr;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  <span class="comment">// Only the I/O processor makes the directory if it doesn&#39;t already exist.</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  <span class="keywordflow">if</span> (amrex::ParallelDescriptor::IOProcessor())</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="keywordflow">if</span> (!amrex::UtilCreateDirectory(FullPath, 0755))</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;      amrex::CreateDirectoryFailed(FullPath);</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  <span class="comment">// Force other processors to wait till directory is built.</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  amrex::ParallelDescriptor::Barrier();</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160; </div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  <span class="keywordflow">if</span> (amrex::ParallelDescriptor::IOProcessor()) {</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    os &lt;&lt; <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.level &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.grids.size() &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; cur_time &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    os &lt;&lt; <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.parent-&gt;levelSteps(<a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.level) &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160; </div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.grids.size(); ++i) {</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;      amrex::RealBox gridloc =</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        amrex::RealBox(<a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.grids[i], <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.geom.CellSize(), <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.geom.ProbLo());</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;      <span class="keywordflow">for</span> (n = 0; n &lt; AMREX_SPACEDIM; n++)</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        os &lt;&lt; gridloc.lo(n) &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; gridloc.hi(n) &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    }</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="comment">// The full relative pathname of the MultiFabs at this level.</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="comment">// The name is relative to the Header file containing this name.</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="comment">// It&#39;s the name that gets written into the Header.</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="keywordflow">if</span> (n_data_items &gt; 0) {</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;      std::string PathNameInHeader = LevelStr;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      PathNameInHeader += BaseName;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;      os &lt;&lt; PathNameInHeader &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    }</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  }</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  <span class="comment">// We combine all of the multifabs -- state, derived, etc -- into one</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  <span class="comment">// multifab -- plotMF.</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <span class="comment">// NOTE: we are assuming that each state variable has one component,</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  <span class="comment">// but a derived variable is allowed to have multiple components.</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160; </div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  <span class="keywordtype">int</span> cnt = 0;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  <span class="keywordtype">int</span> ncomp = 1;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> nGrow = 0;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  amrex::MultiFab plotMF(</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.grids, <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.dmap, n_data_items, nGrow, amrex::MFInfo(), <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.Factory());</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  amrex::MultiFab* this_dat = 0;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  <span class="comment">// Cull data from state variables -- use no ghost cells.</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; plot_var_map.size(); i++) {</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="keywordtype">int</span> typ = plot_var_map[i].first;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <span class="keywordtype">int</span> comp = plot_var_map[i].second;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    this_dat = &amp;(<a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.state[typ].newData());</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    amrex::MultiFab::Copy(plotMF, *this_dat, comp, cnt, 1, nGrow);</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    cnt++;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  }</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  <span class="comment">// Cull data from derived variables.</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  <span class="keywordflow">if</span> (derive_names.size() &gt; 0) {</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160; </div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    <span class="keywordflow">for</span> (std::list&lt;std::string&gt;::const_iterator it = derive_names.begin(),</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                                                end = derive_names.end();</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;         it != end; ++it) {</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;      <span class="keyword">const</span> amrex::DeriveRec* rec = <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.derive_lst.get(*it);</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;      ncomp = rec-&gt;numDerive();</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160; </div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;      <span class="keyword">auto</span> derive_dat = <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.derive(*it, cur_time, nGrow);</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;      amrex::MultiFab::Copy(plotMF, *derive_dat, 0, cnt, ncomp, nGrow);</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;      cnt += ncomp;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    }</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  }</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160; </div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  <span class="comment">// Use the Full pathname when naming the MultiFab.</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;  std::string TheFullPath = FullPath;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  TheFullPath += BaseName;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  amrex::VisMF::Write(plotMF, TheFullPath, how, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classIOManager_af7254c361d36c4e08117a3d486d84341_cgraph.png" border="0" usemap="#classIOManager_af7254c361d36c4e08117a3d486d84341_cgraph" alt=""/></div>
<map name="classIOManager_af7254c361d36c4e08117a3d486d84341_cgraph" id="classIOManager_af7254c361d36c4e08117a3d486d84341_cgraph">
<area shape="rect" title="Write all user&#45;requested fields to disk." alt="" coords="5,5,188,32"/>
<area shape="rect" href="classIOManager.html#a458cd55e2e1e3cf2626b606f0ccfc223" title="write job information" alt="" coords="236,5,415,32"/>
</map>
</div>

</div>
</div>
<a id="a17056a1e637c37a4a424562529050d5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17056a1e637c37a4a424562529050d5d">&#9670;&nbsp;</a></span>writeSmallPlotFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IOManager::writeSmallPlotFile </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>os</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::VisMF::How&#160;</td>
          <td class="paramname"><em>how</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>write small plotfile </p>
<div class="fragment"><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;{</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  <span class="keywordtype">int</span> i, n;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  <span class="comment">// The list of indices of State to write to plotfile.</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  <span class="comment">// first component of pair is state_type,</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  <span class="comment">// second component of pair is component # within the state_type</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  amrex::Vector&lt;std::pair&lt;int, int&gt;&gt; plot_var_map;</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> typ = 0; typ &lt; <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.desc_lst.size(); typ++)</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> comp = 0; comp &lt; <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.desc_lst[typ].nComp(); comp++)</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.parent-&gt;isStateSmallPlotVar(<a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.desc_lst[typ].name(comp)) &amp;&amp;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.desc_lst[typ].getType() == amrex::IndexType::TheCellType())</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        plot_var_map.push_back(std::pair&lt;int, int&gt;(typ, comp));</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160; </div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  <span class="keywordtype">int</span> n_data_items = plot_var_map.size();</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160; </div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  amrex::Real cur_time = <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.state[State_Type].curTime();</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160; </div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.level == 0 &amp;&amp; amrex::ParallelDescriptor::IOProcessor()) {</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <span class="comment">// The first thing we write out is the plotfile type.</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    os &lt;&lt; <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.thePlotFileType() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160; </div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <span class="keywordflow">if</span> (n_data_items == 0)</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;      amrex::Error(<span class="stringliteral">&quot;Must specify at least one valid data item to plot&quot;</span>);</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160; </div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    os &lt;&lt; n_data_items &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160; </div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <span class="comment">// Names of variables -- first state, then derived</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; plot_var_map.size(); i++) {</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;      <span class="keywordtype">int</span> typ = plot_var_map[i].first;</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;      <span class="keywordtype">int</span> comp = plot_var_map[i].second;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      os &lt;&lt; <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.desc_lst[typ].name(comp) &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    }</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160; </div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    os &lt;&lt; AMREX_SPACEDIM &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    os &lt;&lt; <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.parent-&gt;cumTime() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <span class="keywordtype">int</span> f_lev = <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.parent-&gt;finestLevel();</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    os &lt;&lt; f_lev &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; AMREX_SPACEDIM; i++)</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;      os &lt;&lt; amrex::DefaultGeometry().ProbLo(i) &lt;&lt; <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; AMREX_SPACEDIM; i++)</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;      os &lt;&lt; amrex::DefaultGeometry().ProbHi(i) &lt;&lt; <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; f_lev; i++)</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;      os &lt;&lt; <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.parent-&gt;refRatio(i)[0] &lt;&lt; <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt;= f_lev; i++)</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;      os &lt;&lt; <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.parent-&gt;Geom(i).Domain() &lt;&lt; <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt;= f_lev; i++)</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;      os &lt;&lt; <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.parent-&gt;levelSteps(i) &lt;&lt; <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt;= f_lev; i++) {</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; AMREX_SPACEDIM; k++)</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        os &lt;&lt; <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.parent-&gt;Geom(i).CellSize()[k] &lt;&lt; <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;      os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    }</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    os &lt;&lt; (int)amrex::DefaultGeometry().Coord() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;0\n&quot;</span>; <span class="comment">// Write bndry data.</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160; </div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <span class="comment">// job_info file with details about the run</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <a class="code" href="classIOManager.html#a458cd55e2e1e3cf2626b606f0ccfc223">writeJobInfo</a>(dir);</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  }</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;  <span class="comment">// Build the directory to hold the MultiFab at this level.</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;  <span class="comment">// The name is relative to the directory containing the Header file.</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> std::string BaseName = <span class="stringliteral">&quot;/Cell&quot;</span>;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  <span class="keywordtype">char</span> buf[64];</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  sprintf(buf, <span class="stringliteral">&quot;Level_%d&quot;</span>, <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.level);</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;  std::string LevelStr = buf;</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  <span class="comment">// Now for the full pathname of that directory.</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  std::string FullPath = dir;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;  <span class="keywordflow">if</span> (!FullPath.empty() &amp;&amp; FullPath[FullPath.size() - 1] != <span class="charliteral">&#39;/&#39;</span>)</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    FullPath += <span class="charliteral">&#39;/&#39;</span>;</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  FullPath += LevelStr;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;  <span class="comment">// Only the I/O processor makes the directory if it doesn&#39;t already exist.</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  <span class="keywordflow">if</span> (amrex::ParallelDescriptor::IOProcessor())</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    <span class="keywordflow">if</span> (!amrex::UtilCreateDirectory(FullPath, 0755))</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;      amrex::CreateDirectoryFailed(FullPath);</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  <span class="comment">// Force other processors to wait till directory is built.</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  amrex::ParallelDescriptor::Barrier();</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160; </div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  <span class="keywordflow">if</span> (amrex::ParallelDescriptor::IOProcessor()) {</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    os &lt;&lt; <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.level &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.grids.size() &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; cur_time &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    os &lt;&lt; <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.parent-&gt;levelSteps(<a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.level) &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160; </div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.grids.size(); ++i) {</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;      amrex::RealBox gridloc =</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;        amrex::RealBox(<a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.grids[i], <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.geom.CellSize(), <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.geom.ProbLo());</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;      <span class="keywordflow">for</span> (n = 0; n &lt; AMREX_SPACEDIM; n++)</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;        os &lt;&lt; gridloc.lo(n) &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; gridloc.hi(n) &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    }</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    <span class="comment">// The full relative pathname of the MultiFabs at this level.</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <span class="comment">// The name is relative to the Header file containing this name.</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <span class="comment">// It&#39;s the name that gets written into the Header.</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    <span class="keywordflow">if</span> (n_data_items &gt; 0) {</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;      std::string PathNameInHeader = LevelStr;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;      PathNameInHeader += BaseName;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;      os &lt;&lt; PathNameInHeader &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    }</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    os &lt;&lt; vfraceps &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  }</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;  <span class="comment">// We combine all of the multifabs -- state, derived, etc -- into one</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  <span class="comment">// multifab -- plotMF.</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  <span class="comment">// NOTE: we are assuming that each state variable has one component,</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  <span class="comment">// but a derived variable is allowed to have multiple components.</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;  <span class="keywordtype">int</span> cnt = 0;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> nGrow = 0;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;  amrex::MultiFab plotMF(</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.grids, <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.dmap, n_data_items, nGrow, amrex::MFInfo(), <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.Factory());</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;  amrex::MultiFab* this_dat = 0;</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;  <span class="comment">// Cull data from state variables -- use no ghost cells.</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; plot_var_map.size(); i++) {</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    <span class="keywordtype">int</span> typ = plot_var_map[i].first;</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <span class="keywordtype">int</span> comp = plot_var_map[i].second;</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    this_dat = &amp;(<a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.state[typ].newData());</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    amrex::MultiFab::Copy(plotMF, *this_dat, comp, cnt, 1, nGrow);</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    cnt++;</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  }</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160; </div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;  <span class="comment">// Use the Full pathname when naming the MultiFab.</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;  std::string TheFullPath = FullPath;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;  TheFullPath += BaseName;</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;  amrex::VisMF::Write(plotMF, TheFullPath, how, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classIOManager_a17056a1e637c37a4a424562529050d5d_cgraph.png" border="0" usemap="#classIOManager_a17056a1e637c37a4a424562529050d5d_cgraph" alt=""/></div>
<map name="classIOManager_a17056a1e637c37a4a424562529050d5d_cgraph" id="classIOManager_a17056a1e637c37a4a424562529050d5d_cgraph">
<area shape="rect" title="write small plotfile" alt="" coords="5,5,224,32"/>
<area shape="rect" href="classIOManager.html#a458cd55e2e1e3cf2626b606f0ccfc223" title="write job information" alt="" coords="272,5,451,32"/>
</map>
</div>

</div>
</div>
<a id="aae07f10c3fde49c1e5f59b0dea6659e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae07f10c3fde49c1e5f59b0dea6659e2">&#9670;&nbsp;</a></span>writeToNCColumnFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IOManager::writeToNCColumnFile </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>colfile_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real&#160;</td>
          <td class="paramname"><em>xloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real&#160;</td>
          <td class="paramname"><em>yloc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write a timestep to 1D vertical column output for coupling. </p>
<div class="fragment"><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;{</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="comment">// TODO: Relax assumption of only a single level</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.parent-&gt;finestLevel() &gt; 0) {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    amrex::Error(<span class="stringliteral">&quot;Cannot writeToNCColumnFile: present implementation assumes only a single level is present&quot;</span>);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  }</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="comment">// All processors: look for the requested column and get data if it&#39;s there</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  amrex::Box probBox = <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.geom.Domain();</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">size_t</span> nheights = probBox.length(2) + 2;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  amrex::Gpu::DeviceVector&lt;amrex::Real&gt; d_column_data(nheights*3, 0.0);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  amrex::Vector&lt;amrex::Real&gt; h_column_data(nheights*3, 0.0);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  amrex::Real* ucol = &amp;d_column_data[0];</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  amrex::Real* vcol = &amp;d_column_data[nheights];</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  amrex::Real* thetacol = &amp;d_column_data[nheights*2];</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <span class="comment">// Requested point must be inside problem domain</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="keywordflow">if</span> (xloc &lt; <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.geom.ProbLo(0) || xloc &gt; <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.geom.ProbHi(0) ||</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      yloc &lt; <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.geom.ProbLo(1) || yloc &gt; <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.geom.ProbHi(1)) {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    amrex::Error(<span class="stringliteral">&quot;Invalid xy location to save column data - outside of domain&quot;</span>);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  }</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="comment">// get indices and interpolation coefficients</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="keyword">const</span> amrex::Real x_cell_loc = probBox.smallEnd(0) + (xloc - <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.geom.ProbLo(0))* <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.geom.InvCellSize(0);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="keyword">const</span> amrex::Real y_cell_loc = probBox.smallEnd(1) + (yloc - <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.geom.ProbLo(1))* <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.geom.InvCellSize(1);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> iloc = floor(x_cell_loc - 0.5);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> jloc = floor(y_cell_loc - 0.5);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="keyword">const</span> amrex::Real alpha_x = x_cell_loc - 0.5 - iloc;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="keyword">const</span> amrex::Real alpha_y = y_cell_loc - 0.5 - jloc;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  amrex::Array2D&lt;amrex::Real, 0, 1, 0, 1&gt; alpha_theta;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  alpha_theta(0,0) = (1.0 - alpha_x) * (1.0-alpha_y);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  alpha_theta(1,0) = (alpha_x) * (1.0-alpha_y);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  alpha_theta(0,1) = (1.0 - alpha_x) * (alpha_y);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  alpha_theta(1,1) = (alpha_x) * (alpha_y);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="comment">// may need different indices for u,v due to not being collocated</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> iloc_shift = floor(x_cell_loc) - iloc;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> jloc_shift = floor(y_cell_loc) - jloc;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="keyword">const</span> amrex::Real alpha_x_u = x_cell_loc - iloc - iloc_shift;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="keyword">const</span> amrex::Real alpha_y_v = y_cell_loc - jloc - jloc_shift;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  amrex::Array2D&lt;amrex::Real, 0, 1, 0, 1&gt; alpha_u;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  alpha_u(0,0) = (1.0 - alpha_x_u) * (1.0-alpha_y);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  alpha_u(1,0) = (alpha_x_u) * (1.0-alpha_y);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  alpha_u(0,1) = (1.0 - alpha_x_u) * (alpha_y);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  alpha_u(1,1) = (alpha_x_u) * (alpha_y);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  amrex::Array2D&lt;amrex::Real, 0, 1, 0, 1&gt; alpha_v;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  alpha_v(0,0) = (1.0 - alpha_x) * (1.0-alpha_y_v);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  alpha_v(1,0) = (alpha_x) * (1.0-alpha_y_v);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  alpha_v(0,1) = (1.0 - alpha_x) * (alpha_y_v);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  alpha_v(1,1) = (alpha_x) * (alpha_y_v);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> kstart = probBox.smallEnd(2)-1;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> kend = probBox.bigEnd(2)+1;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keyword">const</span> amrex::Box target_box(IntVect{iloc, jloc, kstart},</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                              IntVect{iloc+1, jloc+1, kend});</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="comment">//  Need to get these valid in one grow cell for interpolation</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  amrex::MultiFab&amp; S_new = <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.get_new_data(State_Type);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  amrex::MultiFab&amp; U_new = <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.get_new_data(X_Vel_Type);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  amrex::MultiFab&amp; V_new = <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.get_new_data(Y_Vel_Type);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  S_new.FillBoundary(<a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.geom.periodicity());</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  U_new.FillBoundary(<a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.geom.periodicity());</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  V_new.FillBoundary(<a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.geom.periodicity());</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  amrex::Vector&lt;MultiFab*&gt; all_vars{&amp;S_new, &amp;U_new, &amp;V_new};</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  ERF::applyBCs(<a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.geom,all_vars);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="comment">// No tiling - we&#39;re just interested in one location</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keywordflow">for</span> ( MFIter mfi(S_new); mfi.isValid(); ++mfi){</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keyword">const</span> amrex::Array4&lt;Real const&gt; &amp; state = S_new.array(mfi);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keyword">const</span> amrex::Array4&lt;Real const&gt; &amp; velx = U_new.array(mfi);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keyword">const</span> amrex::Array4&lt;Real const&gt; &amp; vely = V_new.array(mfi);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="comment">// we want to include data at physical boundary ghost cells</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="comment">// for interpolation (i,j) or saving (k)</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    amrex::Box vbox = mfi.validbox();</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idir = 0; idir &lt;=2; idir++) {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      <span class="keywordflow">if</span> (vbox.smallEnd(idir) == probBox.smallEnd(idir)) {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        vbox.growLo(idir,1);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      <span class="keywordflow">if</span> (vbox.bigEnd(idir) == probBox.bigEnd(idir)) {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        vbox.growHi(idir,1);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    }</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="comment">// Loop over indices where our box contains data needed for interpolation</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keyword">const</span> amrex::Box overlap_box = vbox &amp; target_box;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keywordflow">if</span> (overlap_box.ok()) {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      amrex::ParallelFor(overlap_box,</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> idx_vec = k - kstart;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> ialpha = i - iloc;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> jalpha = j - jloc;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        ucol[idx_vec] += velx(i+iloc_shift,j,k) * alpha_u(ialpha, jalpha);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        vcol[idx_vec] += vely(i,j+jloc_shift,k) * alpha_v(ialpha, jalpha);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        thetacol[idx_vec] += state(i,j,k,<a class="code" href="IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>) / state(i,j,k,<a class="code" href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>)</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;          * alpha_theta(ialpha, jalpha);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      });</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    }</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  }</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="comment">// Communicate values to CPU then to the IO processor</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  amrex::Gpu::copy(amrex::Gpu::deviceToHost, d_column_data.begin(),</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    d_column_data.end(), h_column_data.begin());</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  amrex::ParallelDescriptor::ReduceRealSum(h_column_data.data(),</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    h_column_data.size(), amrex::ParallelDescriptor::IOProcessorNumber());</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="comment">// IO processor only: write the relevant data to file</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="keywordflow">if</span> (amrex::ParallelDescriptor::IOProcessor()) {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="keyword">auto</span> ncf = <a class="code" href="classncutils_1_1NCFile.html#a2881b70e450e11f01b474c538b8d6885">ncutils::NCFile::open</a>(colfile_name, NC_WRITE | NC_NETCDF4);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordtype">size_t</span> putloc = ncf.dim(<span class="stringliteral">&quot;ntime&quot;</span>).len();</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="comment">// Time</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    amrex::Real cumtime = <a class="code" href="classIOManager.html#aed10780741a2c90b7916a6353e560075">erf</a>.parent-&gt;cumTime();</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    amrex::Vector&lt;size_t&gt; start_t {putloc};</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    amrex::Vector&lt;size_t&gt; count_t {1};</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    ncf.var(<span class="stringliteral">&quot;times&quot;</span>).put(&amp;cumtime, start_t, count_t);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="comment">// T flux</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="comment">// TODO: Make this the actual flux rather than just a placeholder</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    amrex::Real Tflux = 0.0;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    ncf.var(<span class="stringliteral">&quot;wrf_tflux&quot;</span>).put(&amp;Tflux, start_t, count_t);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="comment">// U, V, Theta</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    std::vector&lt;size_t&gt; start = {putloc, 0};</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    std::vector&lt;size_t&gt; count = {1, nheights};</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    ncf.var(<span class="stringliteral">&quot;wrf_momentum_u&quot;</span>).put(&amp;h_column_data[0], start, count);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    ncf.var(<span class="stringliteral">&quot;wrf_momentum_v&quot;</span>).put(&amp;h_column_data[nheights], start, count);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    ncf.var(<span class="stringliteral">&quot;wrf_temperature&quot;</span>).put(&amp;h_column_data[2*nheights], start, count);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    ncf.close();</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  }</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classIOManager_aae07f10c3fde49c1e5f59b0dea6659e2_cgraph.png" border="0" usemap="#classIOManager_aae07f10c3fde49c1e5f59b0dea6659e2_cgraph" alt=""/></div>
<map name="classIOManager_aae07f10c3fde49c1e5f59b0dea6659e2_cgraph" id="classIOManager_aae07f10c3fde49c1e5f59b0dea6659e2_cgraph">
<area shape="rect" title="Write a timestep to 1D vertical column output for coupling." alt="" coords="5,31,245,57"/>
<area shape="rect" href="classncutils_1_1NCFile.html#a2881b70e450e11f01b474c538b8d6885" title=" " alt="" coords="293,31,448,57"/>
<area shape="rect" href="classncutils_1_1NCGroup.html#a3d53c2f625cc6fc286e76c9137b5b1b0" title="Name of this group." alt="" coords="496,5,672,32"/>
<area shape="rect" href="classncutils_1_1NCFile.html#aec0e1a7f0f93f2f806c0a0abaae66423" title=" " alt="" coords="501,56,667,83"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="aed10780741a2c90b7916a6353e560075"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed10780741a2c90b7916a6353e560075">&#9670;&nbsp;</a></span>erf</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ERF&amp; IOManager::erf</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classIOManager.html#a7d90373f66fdbcacbf31bbe42fc2b4a8">checkPoint()</a>, <a class="el" href="classIOManager.html#a98b07fb4d16bd248d0b69ada41d85aac">createNCColumnFile()</a>, <a class="el" href="classIOManager.html#ae3027a0eeaebfb1ddc523d438b966652">restart()</a>, <a class="el" href="classIOManager.html#a6b7eea06a1e32b99bceee9942c8eb464">set_state_in_checkpoint()</a>, <a class="el" href="classIOManager.html#a458cd55e2e1e3cf2626b606f0ccfc223">writeJobInfo()</a>, <a class="el" href="classIOManager.html#af7254c361d36c4e08117a3d486d84341">writePlotFile()</a>, <a class="el" href="classIOManager.html#a17056a1e637c37a4a424562529050d5d">writeSmallPlotFile()</a>, and <a class="el" href="classIOManager.html#aae07f10c3fde49c1e5f59b0dea6659e2">writeToNCColumnFile()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/runner/work/ERF/ERF/Source/IO/<a class="el" href="IOManager_8H_source.html">IOManager.H</a></li>
<li>/home/runner/work/ERF/ERF/Source/IO/<a class="el" href="IOManager_8cpp.html">IOManager.cpp</a></li>
<li>/home/runner/work/ERF/ERF/Source/IO/<a class="el" href="NCColumnFile_8cpp.html">NCColumnFile.cpp</a></li>
<li>/home/runner/work/ERF/ERF/Source/IO/<a class="el" href="PlotFile_8cpp.html">PlotFile.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="aIndexDefines_8H_html_a27dcc910aeb002a0fd44727954dc0e49"><div class="ttname"><a href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a></div><div class="ttdeci">#define Rho_comp</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:9</div></div>
<div class="ttc" id="aclassIOManager_html_aed10780741a2c90b7916a6353e560075"><div class="ttname"><a href="classIOManager.html#aed10780741a2c90b7916a6353e560075">IOManager::erf</a></div><div class="ttdeci">ERF &amp; erf</div><div class="ttdef"><b>Definition:</b> IOManager.H:91</div></div>
<div class="ttc" id="aNCPlotFile_8H_html_aabaa127a3a319c1b86090d6c88568965"><div class="ttname"><a href="NCPlotFile_8H.html#aabaa127a3a319c1b86090d6c88568965">inputs_name</a></div><div class="ttdeci">std::string inputs_name</div><div class="ttdef"><b>Definition:</b> main.cpp:14</div></div>
<div class="ttc" id="aclassIOManager_html_a458cd55e2e1e3cf2626b606f0ccfc223"><div class="ttname"><a href="classIOManager.html#a458cd55e2e1e3cf2626b606f0ccfc223">IOManager::writeJobInfo</a></div><div class="ttdeci">void writeJobInfo(const std::string &amp;dir)</div><div class="ttdoc">write job information</div><div class="ttdef"><b>Definition:</b> PlotFile.cpp:196</div></div>
<div class="ttc" id="aIndexDefines_8H_html_ad5195ac8f863f5a9a7eaa0db094f7639"><div class="ttname"><a href="IndexDefines_8H.html#ad5195ac8f863f5a9a7eaa0db094f7639">NVAR</a></div><div class="ttdeci">#define NVAR</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:12</div></div>
<div class="ttc" id="aIndexDefines_8H_html_a28f96fd04e1ff08fa7a8f53ccde0f877"><div class="ttname"><a href="IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a></div><div class="ttdeci">#define RhoTheta_comp</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:10</div></div>
<div class="ttc" id="aIndexDefines_8H_html_ac7c21c1d1c96b568a7eefbe3c997238e"><div class="ttname"><a href="IndexDefines_8H.html#ac7c21c1d1c96b568a7eefbe3c997238e">NUM_ADV</a></div><div class="ttdeci">#define NUM_ADV</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:18</div></div>
<div class="ttc" id="aIndexDefines_8H_html_aaf6046446c90ca7f5b9a7de90b661607"><div class="ttname"><a href="IndexDefines_8H.html#aaf6046446c90ca7f5b9a7de90b661607">NUM_GROW</a></div><div class="ttdeci">#define NUM_GROW</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:21</div></div>
<div class="ttc" id="aclassIOManager_html_a6b7eea06a1e32b99bceee9942c8eb464"><div class="ttname"><a href="classIOManager.html#a6b7eea06a1e32b99bceee9942c8eb464">IOManager::set_state_in_checkpoint</a></div><div class="ttdeci">void set_state_in_checkpoint(amrex::Vector&lt; int &gt; &amp;state_in_checkpoint)</div><div class="ttdoc">set state in checkpoint</div><div class="ttdef"><b>Definition:</b> PlotFile.cpp:130</div></div>
<div class="ttc" id="aclassncutils_1_1NCFile_html_a47bdccee2cc22a735ca715d9c88e4f6b"><div class="ttname"><a href="classncutils_1_1NCFile.html#a47bdccee2cc22a735ca715d9c88e4f6b">ncutils::NCFile::create</a></div><div class="ttdeci">static NCFile create(const std::string &amp;name, const int cmode=NC_CLOBBER|NC_NETCDF4)</div><div class="ttdef"><b>Definition:</b> NCInterface.cpp:547</div></div>
<div class="ttc" id="aclassncutils_1_1NCFile_html_a2881b70e450e11f01b474c538b8d6885"><div class="ttname"><a href="classncutils_1_1NCFile.html#a2881b70e450e11f01b474c538b8d6885">ncutils::NCFile::open</a></div><div class="ttdeci">static NCFile open(const std::string &amp;name, const int cmode=NC_NOWRITE)</div><div class="ttdef"><b>Definition:</b> NCInterface.cpp:554</div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classIOManager.html">IOManager</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
