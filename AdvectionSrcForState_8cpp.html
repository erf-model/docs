<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ERF: Source/Advection/AdvectionSrcForState.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ERF
   </div>
   <div id="projectbrief">Energy Research and Forecasting: An Atmospheric Modeling Code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('AdvectionSrcForState_8cpp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">AdvectionSrcForState.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;<a class="el" href="IndexDefines_8H_source.html">IndexDefines.H</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="TerrainMetrics_8H_source.html">TerrainMetrics.H</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="Advection_8H_source.html">Advection.H</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="AdvectionSrcForState__N_8H_source.html">AdvectionSrcForState_N.H</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="AdvectionSrcForState__T_8H_source.html">AdvectionSrcForState_T.H</a>&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for AdvectionSrcForState.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="AdvectionSrcForState_8cpp__incl.png" border="0" usemap="#aSource_2Advection_2AdvectionSrcForState_8cpp" alt=""/></div>
<map name="aSource_2Advection_2AdvectionSrcForState_8cpp" id="aSource_2Advection_2AdvectionSrcForState_8cpp">
<area shape="rect" title=" " alt="" coords="329,5,533,47"/>
<area shape="rect" href="IndexDefines_8H.html" title=" " alt="" coords="318,393,439,420"/>
<area shape="rect" href="TerrainMetrics_8H.html" title=" " alt="" coords="875,319,1003,345"/>
<area shape="rect" href="Advection_8H.html" title=" " alt="" coords="1231,95,1332,121"/>
<area shape="rect" href="AdvectionSrcForState__N_8H.html" title=" " alt="" coords="120,95,312,121"/>
<area shape="rect" href="AdvectionSrcForState__T_8H.html" title=" " alt="" coords="336,95,525,121"/>
<area shape="rect" title=" " alt="" coords="723,468,845,495"/>
<area shape="rect" title=" " alt="" coords="315,468,443,495"/>
<area shape="rect" title=" " alt="" coords="1461,393,1544,420"/>
<area shape="rect" title=" " alt="" coords="795,393,949,420"/>
<area shape="rect" title=" " alt="" coords="1571,393,1717,420"/>
<area shape="rect" title=" " alt="" coords="1362,169,1494,196"/>
<area shape="rect" title=" " alt="" coords="1519,169,1729,196"/>
<area shape="rect" href="DataStruct_8H.html" title=" " alt="" coords="686,319,791,345"/>
<area shape="rect" href="ABLMost_8H.html" title=" " alt="" coords="1193,169,1287,196"/>
<area shape="rect" title=" " alt="" coords="608,393,667,420"/>
<area shape="rect" title=" " alt="" coords="691,393,771,420"/>
<area shape="rect" title=" " alt="" coords="1271,393,1430,420"/>
<area shape="rect" title=" " alt="" coords="464,393,584,420"/>
<area shape="rect" title=" " alt="" coords="1131,393,1247,420"/>
<area shape="rect" href="ERF__Constants_8H.html" title=" " alt="" coords="973,393,1107,420"/>
<area shape="rect" title=" " alt="" coords="1403,319,1559,345"/>
<area shape="rect" title=" " alt="" coords="1077,319,1227,345"/>
<area shape="rect" href="MOSTAverage_8H.html" title=" " alt="" coords="1198,244,1325,271"/>
<area shape="rect" href="Interpolation_8H.html" title=" " alt="" coords="318,169,437,196"/>
<area shape="rect" href="Interpolation__UPW_8H.html" title=" " alt="" coords="246,244,402,271"/>
<area shape="rect" href="Interpolation__WENO_8H.html" title=" " alt="" coords="426,244,593,271"/>
<area shape="rect" href="Interpolation__WENO__Z_8H.html" title=" " alt="" coords="617,244,799,271"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7f3aaf7c7991cf4d3cdb007d496d7e38"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="AdvectionSrcForState_8cpp.html#a7f3aaf7c7991cf4d3cdb007d496d7e38">AdvectionSrcForRhoAndTheta</a> (const Box &amp;bx, const Box &amp;valid_bx, const Array4&lt; Real &gt; &amp;advectionSrc, const Array4&lt; const Real &gt; &amp;rho_u, const Array4&lt; const Real &gt; &amp;rho_v, const Array4&lt; const Real &gt; &amp;Omega, Real fac, const Array4&lt; Real &gt; &amp;avg_xmom, const Array4&lt; Real &gt; &amp;avg_ymom, const Array4&lt; Real &gt; &amp;avg_zmom, const Array4&lt; const Real &gt; &amp;cell_prim, const Array4&lt; const Real &gt; &amp;z_nd, const Array4&lt; const Real &gt; &amp;detJ, const GpuArray&lt; Real, AMREX_SPACEDIM &gt; &amp;cellSizeInv, const Array4&lt; const Real &gt; &amp;mf_m, const Array4&lt; const Real &gt; &amp;mf_u, const Array4&lt; const Real &gt; &amp;mf_v, const int horiz_adv_type, const int vert_adv_type, const int use_terrain)</td></tr>
<tr class="separator:a7f3aaf7c7991cf4d3cdb007d496d7e38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0081f24e8e78feeee0754fbbadb90427"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="AdvectionSrcForState_8cpp.html#a0081f24e8e78feeee0754fbbadb90427">AdvectionSrcForScalars</a> (const Box &amp;bx, const int icomp, const int ncomp, const Array4&lt; const Real &gt; &amp;avg_xmom, const Array4&lt; const Real &gt; &amp;avg_ymom, const Array4&lt; const Real &gt; &amp;avg_zmom, const Array4&lt; const Real &gt; &amp;cell_prim, const Array4&lt; Real &gt; &amp;advectionSrc, const Array4&lt; const Real &gt; &amp;detJ, const GpuArray&lt; Real, AMREX_SPACEDIM &gt; &amp;cellSizeInv, const Array4&lt; const Real &gt; &amp;mf_m, const int horiz_adv_type, const int vert_adv_type, const int use_terrain)</td></tr>
<tr class="separator:a0081f24e8e78feeee0754fbbadb90427"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a7f3aaf7c7991cf4d3cdb007d496d7e38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f3aaf7c7991cf4d3cdb007d496d7e38">&#9670;&nbsp;</a></span>AdvectionSrcForRhoAndTheta()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AdvectionSrcForRhoAndTheta </td>
          <td>(</td>
          <td class="paramtype">const Box &amp;&#160;</td>
          <td class="paramname"><em>bx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Box &amp;&#160;</td>
          <td class="paramname"><em>valid_bx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array4&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>advectionSrc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array4&lt; const Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>rho_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array4&lt; const Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>rho_v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array4&lt; const Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>Omega</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>fac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array4&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>avg_xmom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array4&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>avg_ymom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array4&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>avg_zmom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array4&lt; const Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>cell_prim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array4&lt; const Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>z_nd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array4&lt; const Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>detJ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const GpuArray&lt; Real, AMREX_SPACEDIM &gt; &amp;&#160;</td>
          <td class="paramname"><em>cellSizeInv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array4&lt; const Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array4&lt; const Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array4&lt; const Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>horiz_adv_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>vert_adv_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>use_terrain</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function for computing the advective tendency for the update equations for rho and (rho theta) This routine has explicit expressions for all cases (terrain or not) when the horizontal and vertial spatial orders are &lt;= 2, and calls more specialized functions when either (or both) spatial order(s) is greater than 2.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">bx</td><td>box over which the scalars are updated </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">valid_bx</td><td>box that contains only the cells not in the specified or relaxation zones </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">advectionSrc</td><td>tendency for the scalar update equation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rho_u</td><td>x-component of momentum </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rho_v</td><td>y-component of momentum </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Omega</td><td>component of momentum normal to the z-coordinate surface </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fac</td><td>weighting factor for use in defining time-averaged momentum </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">avg_xmom</td><td>x-component of time-averaged momentum defined in this routine </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">avg_ymom</td><td>y-component of time-averaged momentum defined in this routine </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">avg_zmom</td><td>z-component of time-averaged momentum defined in this routine </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cell_prim</td><td>primtive form of scalar variales, here only potential temperature theta </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">z_nd</td><td>height coordinate at nodes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">detJ</td><td>Jacobian of the metric transformation (= 1 if use_terrain is false) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cellSizeInv</td><td>inverse of the mesh spacing </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mf_m</td><td>map factor at cell centers </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mf_u</td><td>map factor at x-faces </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mf_v</td><td>map factor at y-faces </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">horiz_adv_type</td><td>advection scheme to be used in horiz. directions for dry scalars </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">vert_adv_type</td><td>advection scheme to be used in horiz. directions for dry scalars </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">use_terrain</td><td>if true, use the terrain-aware derivatives (with metric terms) </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;{</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    BL_PROFILE_VAR(<span class="stringliteral">&quot;AdvectionSrcForRhoAndTheta&quot;</span>, <a class="code" href="AdvectionSrcForState_8cpp.html#a7f3aaf7c7991cf4d3cdb007d496d7e38">AdvectionSrcForRhoAndTheta</a>);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keyword">auto</span> dxInv = cellSizeInv[0], dyInv = cellSizeInv[1], dzInv = cellSizeInv[2];</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="comment">// We note that valid_bx is the actual grid, while bx may be a tile within that grid</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; vbx_hi = ubound(valid_bx);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordflow">if</span> (!use_terrain) {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <span class="comment">// Inline with 2nd order for efficiency</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <span class="keywordflow">if</span> (horiz_adv_type == <a class="code" href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a50868a47b0f928ff938726290c7f86f0">AdvType::Centered_2nd</a> &amp;&amp; vert_adv_type == <a class="code" href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a50868a47b0f928ff938726290c7f86f0">AdvType::Centered_2nd</a>)</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;            ParallelFor(bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;            {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                Real xflux_lo = rho_u(i  ,j,k) / mf_u(i  ,j  ,0);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                Real xflux_hi = rho_u(i+1,j,k) / mf_u(i+1,j  ,0);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                Real yflux_lo = rho_v(i,j  ,k) / mf_v(i  ,j  ,0);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                Real yflux_hi = rho_v(i,j+1,k) / mf_v(i  ,j+1,0);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                Real zflux_lo = Omega(i,j,k  );</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                Real zflux_hi = Omega(i,j,k+1);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                avg_xmom(i  ,j,k) += fac*xflux_lo;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                <span class="keywordflow">if</span> (i == vbx_hi.x)</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                    avg_xmom(i+1,j,k) += fac*xflux_hi;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                avg_ymom(i,j  ,k) += fac*yflux_lo;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                <span class="keywordflow">if</span> (j == vbx_hi.y)</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                    avg_ymom(i,j+1,k) += fac*yflux_hi;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                avg_zmom(i,j,k  ) += fac*zflux_lo;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                <span class="keywordflow">if</span> (k == vbx_hi.z)</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                    avg_zmom(i,j,k+1) += fac*zflux_hi;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                Real mfsq = mf_m(i,j,0) * mf_m(i,j,0);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                advectionSrc(i,j,k,0) = -(</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                                          ( xflux_hi - xflux_lo ) * dxInv * mfsq +</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                                          ( yflux_hi - yflux_lo ) * dyInv * mfsq +</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                                          ( zflux_hi - zflux_lo ) * dzInv );</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">int</span> prim_index = 0;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                advectionSrc(i,j,k,1) = - 0.5 * (</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;              ( xflux_hi * (cell_prim(i+1,j,k,prim_index) + cell_prim(i,j,k,prim_index)) -</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                xflux_lo * (cell_prim(i-1,j,k,prim_index) + cell_prim(i,j,k,prim_index)) ) * dxInv * mfsq +</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;              ( yflux_hi * (cell_prim(i,j+1,k,prim_index) + cell_prim(i,j,k,prim_index)) -</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                yflux_lo * (cell_prim(i,j-1,k,prim_index) + cell_prim(i,j,k,prim_index)) ) * dyInv * mfsq +</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;              ( zflux_hi * (cell_prim(i,j,k+1,prim_index) + cell_prim(i,j,k,prim_index)) -</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                zflux_lo * (cell_prim(i,j,k-1,prim_index) + cell_prim(i,j,k,prim_index)) ) * dzInv);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            });</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <span class="comment">// Template higher order methods</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;            <span class="keywordflow">if</span> (horiz_adv_type == <a class="code" href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a50868a47b0f928ff938726290c7f86f0">AdvType::Centered_2nd</a>) {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                AdvectionSrcForRhoThetaVert_N&lt;CENTERED2&gt;(bx, vbx_hi, fac, advectionSrc,</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                                                         cell_prim, rho_u, rho_v, Omega,</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                                                         avg_xmom, avg_ymom, avg_zmom,</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                                                         cellSizeInv, mf_m, mf_u, mf_v,</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                                                         vert_adv_type);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (horiz_adv_type == <a class="code" href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70ac7fe7ee5bfd5ea8c3d1da3612ec07d26">AdvType::Upwind_3rd</a>) {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                AdvectionSrcForRhoThetaVert_N&lt;UPWIND3&gt;(bx, vbx_hi, fac, advectionSrc,</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                                                       cell_prim, rho_u, rho_v, Omega,</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                                                       avg_xmom, avg_ymom, avg_zmom,</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                                                       cellSizeInv, mf_m, mf_u, mf_v,</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                                                       vert_adv_type);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (horiz_adv_type == <a class="code" href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70ad9c9e225889709967bad5bd8c5694afb">AdvType::Centered_4th</a>) {</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                AdvectionSrcForRhoThetaVert_N&lt;CENTERED4&gt;(bx, vbx_hi, fac, advectionSrc,</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                                                         cell_prim, rho_u, rho_v, Omega,</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                                                         avg_xmom, avg_ymom, avg_zmom,</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                                                         cellSizeInv, mf_m, mf_u, mf_v,</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                                                         vert_adv_type);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (horiz_adv_type == <a class="code" href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a7f1fd32cf2e27353b77771d3d5ccec70">AdvType::Upwind_5th</a>) {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                AdvectionSrcForRhoThetaVert_N&lt;UPWIND5&gt;(bx, vbx_hi, fac, advectionSrc,</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                                                       cell_prim, rho_u, rho_v, Omega,</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                                                       avg_xmom, avg_ymom, avg_zmom,</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                                                       cellSizeInv, mf_m, mf_u, mf_v,</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                                                       vert_adv_type);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (horiz_adv_type == <a class="code" href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a4ae585c894c9ca0c5a2f6059ccc25642">AdvType::Centered_6th</a>) {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                AdvectionSrcForRhoThetaVert_N&lt;CENTERED6&gt;(bx, vbx_hi, fac, advectionSrc,</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                                                         cell_prim, rho_u, rho_v, Omega,</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                                                         avg_xmom, avg_ymom, avg_zmom,</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                                                         cellSizeInv, mf_m, mf_u, mf_v,</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                                                         vert_adv_type);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                AMREX_ASSERT_WITH_MESSAGE(<span class="keyword">false</span>, <span class="stringliteral">&quot;Unknown advection scheme!&quot;</span>);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            }</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        }</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <span class="comment">// Inline with 2nd order for efficiency</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <span class="keywordflow">if</span> (horiz_adv_type == <a class="code" href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a50868a47b0f928ff938726290c7f86f0">AdvType::Centered_2nd</a> &amp;&amp; vert_adv_type == <a class="code" href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a50868a47b0f928ff938726290c7f86f0">AdvType::Centered_2nd</a>)</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            amrex::ParallelFor(bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                Real invdetJ = 1./ detJ(i,j,k);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                Real xflux_lo = rho_u(i  ,j,k) / mf_u(i  ,j  ,0);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                Real xflux_hi = rho_u(i+1,j,k) / mf_u(i+1,j  ,0);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                Real yflux_lo = rho_v(i,j  ,k) / mf_v(i  ,j  ,0);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                Real yflux_hi = rho_v(i,j+1,k) / mf_v(i  ,j+1,0);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                Real zflux_lo = Omega(i,j,k  );</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                Real zflux_hi = Omega(i,j,k+1);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                Real met_h_zeta_xlo = <a class="code" href="TerrainMetrics_8H.html#a8d96671d41364f1e24391375a2bc0f1e">Compute_h_zeta_AtIface</a>(i  ,j  ,k,cellSizeInv,z_nd);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                xflux_lo *= met_h_zeta_xlo;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                Real met_h_zeta_xhi = <a class="code" href="TerrainMetrics_8H.html#a8d96671d41364f1e24391375a2bc0f1e">Compute_h_zeta_AtIface</a>(i+1,j  ,k,cellSizeInv,z_nd);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                xflux_hi *= met_h_zeta_xhi;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                Real met_h_zeta_ylo = <a class="code" href="TerrainMetrics_8H.html#ada12bcb6beb3fa0d00dbdacb37f3c60f">Compute_h_zeta_AtJface</a>(i  ,j  ,k,cellSizeInv,z_nd);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                yflux_lo *= met_h_zeta_ylo;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                Real met_h_zeta_yhi = <a class="code" href="TerrainMetrics_8H.html#ada12bcb6beb3fa0d00dbdacb37f3c60f">Compute_h_zeta_AtJface</a>(i  ,j+1,k,cellSizeInv,z_nd);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                yflux_hi *= met_h_zeta_yhi;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                avg_xmom(i  ,j,k) += fac*xflux_lo;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                <span class="keywordflow">if</span> (i == vbx_hi.x)</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                    avg_xmom(i+1,j,k) += fac*xflux_hi;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                avg_ymom(i,j  ,k) += fac*yflux_lo;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                <span class="keywordflow">if</span> (j == vbx_hi.y)</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                    avg_ymom(i,j+1,k) += fac*yflux_hi;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                avg_zmom(i,j,k  ) += fac*zflux_lo;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                <span class="keywordflow">if</span> (k == vbx_hi.z)</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                    avg_zmom(i,j,k+1) += fac*zflux_hi;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                Real mfsq = mf_m(i,j,0) * mf_m(i,j,0);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                advectionSrc(i,j,k,0) = - invdetJ * (</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                                                     ( xflux_hi - xflux_lo ) * dxInv * mfsq +</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                                                     ( yflux_hi - yflux_lo ) * dyInv * mfsq +</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                                                     ( zflux_hi - zflux_lo ) * dzInv );</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">int</span> prim_index = 0;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                advectionSrc(i,j,k,1) = - invdetJ * 0.5 * (</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                ( xflux_hi * (cell_prim(i,j,k,prim_index) + cell_prim(i+1,j,k,prim_index)) -</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                  xflux_lo * (cell_prim(i,j,k,prim_index) + cell_prim(i-1,j,k,prim_index)) ) * dxInv * mfsq +</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                ( yflux_hi * (cell_prim(i,j,k,prim_index) + cell_prim(i,j+1,k,prim_index)) -</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                  yflux_lo * (cell_prim(i,j,k,prim_index) + cell_prim(i,j-1,k,prim_index)) ) * dyInv * mfsq +</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                ( zflux_hi * (cell_prim(i,j,k,prim_index) + cell_prim(i,j,k+1,prim_index)) -</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                  zflux_lo * (cell_prim(i,j,k,prim_index) + cell_prim(i,j,k-1,prim_index)) ) * dzInv);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            });</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <span class="comment">// Template higher order methods (horizontal first)</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            <span class="keywordflow">if</span> (horiz_adv_type == <a class="code" href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a50868a47b0f928ff938726290c7f86f0">AdvType::Centered_2nd</a>) {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                AdvectionSrcForRhoThetaVert_T&lt;CENTERED2&gt;(bx, vbx_hi, fac, advectionSrc,</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                                                         cell_prim, rho_u, rho_v, Omega,</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                                                         avg_xmom, avg_ymom, avg_zmom,</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                                                         z_nd, detJ, cellSizeInv, mf_m,</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                                                         mf_u, mf_v, vert_adv_type);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (horiz_adv_type == <a class="code" href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70ac7fe7ee5bfd5ea8c3d1da3612ec07d26">AdvType::Upwind_3rd</a>) {</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                AdvectionSrcForRhoThetaVert_T&lt;UPWIND3&gt;(bx, vbx_hi, fac, advectionSrc,</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                                                       cell_prim, rho_u, rho_v, Omega,</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                                                       avg_xmom, avg_ymom, avg_zmom,</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                                                       z_nd, detJ, cellSizeInv, mf_m,</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                                                       mf_u, mf_v, vert_adv_type);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (horiz_adv_type == <a class="code" href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70ad9c9e225889709967bad5bd8c5694afb">AdvType::Centered_4th</a>) {</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                AdvectionSrcForRhoThetaVert_T&lt;CENTERED4&gt;(bx, vbx_hi, fac, advectionSrc,</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                                                         cell_prim, rho_u, rho_v, Omega,</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                                                         avg_xmom, avg_ymom, avg_zmom,</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                                                         z_nd, detJ, cellSizeInv, mf_m,</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                                                         mf_u, mf_v, vert_adv_type);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (horiz_adv_type == <a class="code" href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a7f1fd32cf2e27353b77771d3d5ccec70">AdvType::Upwind_5th</a>) {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                AdvectionSrcForRhoThetaVert_T&lt;UPWIND5&gt;(bx, vbx_hi, fac, advectionSrc,</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                                                       cell_prim, rho_u, rho_v, Omega,</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                                                       avg_xmom, avg_ymom, avg_zmom,</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                                                       z_nd, detJ, cellSizeInv, mf_m,</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                                                       mf_u, mf_v, vert_adv_type);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (horiz_adv_type == <a class="code" href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a4ae585c894c9ca0c5a2f6059ccc25642">AdvType::Centered_6th</a>) {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                AdvectionSrcForRhoThetaVert_T&lt;CENTERED6&gt;(bx, vbx_hi, fac, advectionSrc,</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                                                         cell_prim, rho_u, rho_v, Omega,</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                                                         avg_xmom, avg_ymom, avg_zmom,</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                                                         z_nd, detJ, cellSizeInv, mf_m,</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                                                         mf_u, mf_v, vert_adv_type);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                AMREX_ASSERT_WITH_MESSAGE(<span class="keyword">false</span>, <span class="stringliteral">&quot;Unknown advection scheme!&quot;</span>);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            }</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        }</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    }</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;}</div>
<div class="ttc" id="aAdvectionSrcForState_8cpp_html_a7f3aaf7c7991cf4d3cdb007d496d7e38"><div class="ttname"><a href="AdvectionSrcForState_8cpp.html#a7f3aaf7c7991cf4d3cdb007d496d7e38">AdvectionSrcForRhoAndTheta</a></div><div class="ttdeci">void AdvectionSrcForRhoAndTheta(const Box &amp;bx, const Box &amp;valid_bx, const Array4&lt; Real &gt; &amp;advectionSrc, const Array4&lt; const Real &gt; &amp;rho_u, const Array4&lt; const Real &gt; &amp;rho_v, const Array4&lt; const Real &gt; &amp;Omega, Real fac, const Array4&lt; Real &gt; &amp;avg_xmom, const Array4&lt; Real &gt; &amp;avg_ymom, const Array4&lt; Real &gt; &amp;avg_zmom, const Array4&lt; const Real &gt; &amp;cell_prim, const Array4&lt; const Real &gt; &amp;z_nd, const Array4&lt; const Real &gt; &amp;detJ, const GpuArray&lt; Real, AMREX_SPACEDIM &gt; &amp;cellSizeInv, const Array4&lt; const Real &gt; &amp;mf_m, const Array4&lt; const Real &gt; &amp;mf_u, const Array4&lt; const Real &gt; &amp;mf_v, const int horiz_adv_type, const int vert_adv_type, const int use_terrain)</div><div class="ttdef"><b>Definition:</b> AdvectionSrcForState.cpp:38</div></div>
<div class="ttc" id="aIndexDefines_8H_html_ada2d84e0dbbfb8d748defbf018748a70a4ae585c894c9ca0c5a2f6059ccc25642"><div class="ttname"><a href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a4ae585c894c9ca0c5a2f6059ccc25642">Centered_6th</a></div><div class="ttdeci">@ Centered_6th</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:195</div></div>
<div class="ttc" id="aIndexDefines_8H_html_ada2d84e0dbbfb8d748defbf018748a70a50868a47b0f928ff938726290c7f86f0"><div class="ttname"><a href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a50868a47b0f928ff938726290c7f86f0">Centered_2nd</a></div><div class="ttdeci">@ Centered_2nd</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:191</div></div>
<div class="ttc" id="aIndexDefines_8H_html_ada2d84e0dbbfb8d748defbf018748a70a7f1fd32cf2e27353b77771d3d5ccec70"><div class="ttname"><a href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a7f1fd32cf2e27353b77771d3d5ccec70">Upwind_5th</a></div><div class="ttdeci">@ Upwind_5th</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:194</div></div>
<div class="ttc" id="aIndexDefines_8H_html_ada2d84e0dbbfb8d748defbf018748a70ac7fe7ee5bfd5ea8c3d1da3612ec07d26"><div class="ttname"><a href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70ac7fe7ee5bfd5ea8c3d1da3612ec07d26">Upwind_3rd</a></div><div class="ttdeci">@ Upwind_3rd</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:192</div></div>
<div class="ttc" id="aIndexDefines_8H_html_ada2d84e0dbbfb8d748defbf018748a70ad9c9e225889709967bad5bd8c5694afb"><div class="ttname"><a href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70ad9c9e225889709967bad5bd8c5694afb">Centered_4th</a></div><div class="ttdeci">@ Centered_4th</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:193</div></div>
<div class="ttc" id="aTerrainMetrics_8H_html_a8d96671d41364f1e24391375a2bc0f1e"><div class="ttname"><a href="TerrainMetrics_8H.html#a8d96671d41364f1e24391375a2bc0f1e">Compute_h_zeta_AtIface</a></div><div class="ttdeci">AMREX_GPU_DEVICE AMREX_FORCE_INLINE amrex::Real Compute_h_zeta_AtIface(const int &amp;i, const int &amp;j, const int &amp;k, const amrex::GpuArray&lt; amrex::Real, AMREX_SPACEDIM &gt; &amp;cellSizeInv, const amrex::Array4&lt; const amrex::Real &gt; &amp;z_nd)</div><div class="ttdef"><b>Definition:</b> TerrainMetrics.H:71</div></div>
<div class="ttc" id="aTerrainMetrics_8H_html_ada12bcb6beb3fa0d00dbdacb37f3c60f"><div class="ttname"><a href="TerrainMetrics_8H.html#ada12bcb6beb3fa0d00dbdacb37f3c60f">Compute_h_zeta_AtJface</a></div><div class="ttdeci">AMREX_GPU_DEVICE AMREX_FORCE_INLINE amrex::Real Compute_h_zeta_AtJface(const int &amp;i, const int &amp;j, const int &amp;k, const amrex::GpuArray&lt; amrex::Real, AMREX_SPACEDIM &gt; &amp;cellSizeInv, const amrex::Array4&lt; const amrex::Real &gt; &amp;z_nd)</div><div class="ttdef"><b>Definition:</b> TerrainMetrics.H:114</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="AdvectionSrcForState_8cpp_a7f3aaf7c7991cf4d3cdb007d496d7e38_cgraph.png" border="0" usemap="#aAdvectionSrcForState_8cpp_a7f3aaf7c7991cf4d3cdb007d496d7e38_cgraph" alt=""/></div>
<map name="aAdvectionSrcForState_8cpp_a7f3aaf7c7991cf4d3cdb007d496d7e38_cgraph" id="aAdvectionSrcForState_8cpp_a7f3aaf7c7991cf4d3cdb007d496d7e38_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,220,57"/>
<area shape="rect" href="TerrainMetrics_8H.html#a8d96671d41364f1e24391375a2bc0f1e" title=" " alt="" coords="268,5,452,32"/>
<area shape="rect" href="TerrainMetrics_8H.html#ada12bcb6beb3fa0d00dbdacb37f3c60f" title=" " alt="" coords="268,56,452,83"/>
</map>
</div>

</div>
</div>
<a id="a0081f24e8e78feeee0754fbbadb90427"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0081f24e8e78feeee0754fbbadb90427">&#9670;&nbsp;</a></span>AdvectionSrcForScalars()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AdvectionSrcForScalars </td>
          <td>(</td>
          <td class="paramtype">const Box &amp;&#160;</td>
          <td class="paramname"><em>bx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>icomp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ncomp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array4&lt; const Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>avg_xmom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array4&lt; const Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>avg_ymom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array4&lt; const Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>avg_zmom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array4&lt; const Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>cell_prim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array4&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>advectionSrc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array4&lt; const Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>detJ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const GpuArray&lt; Real, AMREX_SPACEDIM &gt; &amp;&#160;</td>
          <td class="paramname"><em>cellSizeInv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array4&lt; const Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>horiz_adv_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>vert_adv_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>use_terrain</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function for computing the advective tendency for the update equations for all scalars other than rho and (rho theta) This routine has explicit expressions for all cases (terrain or not) when the horizontal and vertial spatial orders are &lt;= 2, and calls more specialized functions when either (or both) spatial order(s) is greater than 2.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">bx</td><td>box over which the scalars are updated if no external boundary conditions </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">icomp</td><td>component of first scalar to be updated </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ncomp</td><td>number of components to be updated </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">avg_xmom</td><td>x-component of time-averaged momentum defined in this routine </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">avg_ymom</td><td>y-component of time-averaged momentum defined in this routine </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">avg_zmom</td><td>z-component of time-averaged momentum defined in this routine </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cell_prim</td><td>primtive form of scalar variales, here only potential temperature theta </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">advectionSrc</td><td>tendency for the scalar update equation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">detJ</td><td>Jacobian of the metric transformation (= 1 if use_terrain is false) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cellSizeInv</td><td>inverse of the mesh spacing </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mf_m</td><td>map factor at cell centers </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">horiz_adv_type</td><td>advection scheme to be used in horiz. directions for dry scalars </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">vert_adv_type</td><td>advection scheme to be used in horiz. directions for dry scalars </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">use_terrain</td><td>if true, use the terrain-aware derivatives (with metric terms) </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;{</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    BL_PROFILE_VAR(<span class="stringliteral">&quot;AdvectionSrcForScalars&quot;</span>, <a class="code" href="AdvectionSrcForState_8cpp.html#a0081f24e8e78feeee0754fbbadb90427">AdvectionSrcForScalars</a>);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keyword">auto</span> dxInv = cellSizeInv[0], dyInv = cellSizeInv[1], dzInv = cellSizeInv[2];</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="comment">// Inline with 2nd order for efficiency</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keywordflow">if</span> (horiz_adv_type == <a class="code" href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a50868a47b0f928ff938726290c7f86f0">AdvType::Centered_2nd</a> &amp;&amp; vert_adv_type == <a class="code" href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a50868a47b0f928ff938726290c7f86f0">AdvType::Centered_2nd</a>)</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    {</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        amrex::ParallelFor(bx, ncomp, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k, <span class="keywordtype">int</span> n) noexcept</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        {</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            Real invdetJ = (use_terrain) ?  1. / detJ(i,j,k) : 1.;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            <span class="comment">// NOTE: we don&#39;t need to weight avg_xmom, avg_ymom, avg_zmom with terrain metrics</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            <span class="comment">//       because that was done when they were constructed in AdvectionSrcForRhoAndTheta</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> cons_index = icomp + n;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> prim_index = cons_index - 1;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            Real mfsq = mf_m(i,j,0) * mf_m(i,j,0);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            advectionSrc(i,j,k,cons_index) = - 0.5 * invdetJ * (</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;              ( avg_xmom(i+1,j,k) * (cell_prim(i,j,k,prim_index) + cell_prim(i+1,j,k,prim_index)) -</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                avg_xmom(i  ,j,k) * (cell_prim(i,j,k,prim_index) + cell_prim(i-1,j,k,prim_index)) ) * dxInv * mfsq +</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;              ( avg_ymom(i,j+1,k) * (cell_prim(i,j,k,prim_index) + cell_prim(i,j+1,k,prim_index)) -</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                avg_ymom(i,j  ,k) * (cell_prim(i,j,k,prim_index) + cell_prim(i,j-1,k,prim_index)) ) * dyInv * mfsq +</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;              ( avg_zmom(i,j,k+1) * (cell_prim(i,j,k,prim_index) + cell_prim(i,j,k+1,prim_index)) -</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                avg_zmom(i,j,k  ) * (cell_prim(i,j,k,prim_index) + cell_prim(i,j,k-1,prim_index)) ) * dzInv);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        });</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="comment">// Template higher order methods (horizontal first)</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <span class="keywordflow">if</span> (horiz_adv_type == <a class="code" href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a50868a47b0f928ff938726290c7f86f0">AdvType::Centered_2nd</a>) {</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            AdvectionSrcForScalarsVert_N&lt;CENTERED2&gt;(bx, ncomp, icomp,</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                                                    use_terrain, advectionSrc, cell_prim,</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                                                    avg_xmom, avg_ymom, avg_zmom, detJ,</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                                                    cellSizeInv, mf_m, vert_adv_type);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (horiz_adv_type == <a class="code" href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70ac7fe7ee5bfd5ea8c3d1da3612ec07d26">AdvType::Upwind_3rd</a>) {</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            AdvectionSrcForScalarsVert_N&lt;UPWIND3&gt;(bx, ncomp, icomp,</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                                                  use_terrain, advectionSrc, cell_prim,</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                                                  avg_xmom, avg_ymom, avg_zmom, detJ,</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                                                  cellSizeInv, mf_m, vert_adv_type);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (horiz_adv_type == <a class="code" href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70ad9c9e225889709967bad5bd8c5694afb">AdvType::Centered_4th</a>) {</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            AdvectionSrcForScalarsVert_N&lt;CENTERED4&gt;(bx, ncomp, icomp,</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                                                    use_terrain, advectionSrc, cell_prim,</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                                                    avg_xmom, avg_ymom, avg_zmom, detJ,</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                                                    cellSizeInv, mf_m, vert_adv_type);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (horiz_adv_type == <a class="code" href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a7f1fd32cf2e27353b77771d3d5ccec70">AdvType::Upwind_5th</a>) {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            AdvectionSrcForScalarsVert_N&lt;UPWIND5&gt;(bx, ncomp, icomp,</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                                                  use_terrain, advectionSrc, cell_prim,</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                                                  avg_xmom, avg_ymom, avg_zmom, detJ,</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                                                  cellSizeInv, mf_m, vert_adv_type);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (horiz_adv_type == <a class="code" href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a4ae585c894c9ca0c5a2f6059ccc25642">AdvType::Centered_6th</a>) {</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            AdvectionSrcForScalarsVert_N&lt;CENTERED6&gt;(bx, ncomp, icomp,</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                                                    use_terrain, advectionSrc, cell_prim,</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                                                    avg_xmom, avg_ymom, avg_zmom, detJ,</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                                                    cellSizeInv, mf_m, vert_adv_type);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (horiz_adv_type == <a class="code" href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a7b2a966dc1393623ced30f715e3a1c5b">AdvType::Weno_3</a>) {</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;            AdvectionSrcForScalarsWrapper_N&lt;WENO3,WENO3&gt;(bx, ncomp, icomp,</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                                                         use_terrain, advectionSrc, cell_prim,</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                                                         avg_xmom, avg_ymom, avg_zmom, detJ,</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                                                         cellSizeInv, mf_m);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (horiz_adv_type == <a class="code" href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a1a671baee1a0a409360fa857e42b84af">AdvType::Weno_5</a>) {</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            AdvectionSrcForScalarsWrapper_N&lt;WENO5,WENO5&gt;(bx, ncomp, icomp,</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                                                         use_terrain, advectionSrc, cell_prim,</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                                                         avg_xmom, avg_ymom, avg_zmom, detJ,</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                                                         cellSizeInv, mf_m);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (horiz_adv_type == <a class="code" href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a3f52c29fc095fec904b780e9cdb21dff">AdvType::Weno_3Z</a>) {</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            AdvectionSrcForScalarsWrapper_N&lt;WENO_Z3,WENO_Z3&gt;(bx, ncomp, icomp,</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                                                             use_terrain, advectionSrc, cell_prim,</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                                                             avg_xmom, avg_ymom, avg_zmom, detJ,</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                                                             cellSizeInv, mf_m);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (horiz_adv_type == <a class="code" href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a35281555e9873efb8a7ec30d009665d1">AdvType::Weno_3MZQ</a>) {</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            AdvectionSrcForScalarsWrapper_N&lt;WENO_MZQ3,WENO_MZQ3&gt;(bx, ncomp, icomp,</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                                                                 use_terrain, advectionSrc, cell_prim,</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                                                                 avg_xmom, avg_ymom, avg_zmom, detJ,</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                                                                 cellSizeInv, mf_m);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (horiz_adv_type == <a class="code" href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a97d28956ba07aedc3c043286e6493342">AdvType::Weno_5Z</a>) {</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            AdvectionSrcForScalarsWrapper_N&lt;WENO_Z5,WENO_Z5&gt;(bx, ncomp, icomp,</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                                                             use_terrain, advectionSrc, cell_prim,</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                                                             avg_xmom, avg_ymom, avg_zmom, detJ,</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                                                             cellSizeInv, mf_m);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            AMREX_ASSERT_WITH_MESSAGE(<span class="keyword">false</span>, <span class="stringliteral">&quot;Unknown advection scheme!&quot;</span>);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        }</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    }</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;}</div>
<div class="ttc" id="aAdvectionSrcForState_8cpp_html_a0081f24e8e78feeee0754fbbadb90427"><div class="ttname"><a href="AdvectionSrcForState_8cpp.html#a0081f24e8e78feeee0754fbbadb90427">AdvectionSrcForScalars</a></div><div class="ttdeci">void AdvectionSrcForScalars(const Box &amp;bx, const int icomp, const int ncomp, const Array4&lt; const Real &gt; &amp;avg_xmom, const Array4&lt; const Real &gt; &amp;avg_ymom, const Array4&lt; const Real &gt; &amp;avg_zmom, const Array4&lt; const Real &gt; &amp;cell_prim, const Array4&lt; Real &gt; &amp;advectionSrc, const Array4&lt; const Real &gt; &amp;detJ, const GpuArray&lt; Real, AMREX_SPACEDIM &gt; &amp;cellSizeInv, const Array4&lt; const Real &gt; &amp;mf_m, const int horiz_adv_type, const int vert_adv_type, const int use_terrain)</div><div class="ttdef"><b>Definition:</b> AdvectionSrcForState.cpp:251</div></div>
<div class="ttc" id="aIndexDefines_8H_html_ada2d84e0dbbfb8d748defbf018748a70a1a671baee1a0a409360fa857e42b84af"><div class="ttname"><a href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a1a671baee1a0a409360fa857e42b84af">Weno_5</a></div><div class="ttdeci">@ Weno_5</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:198</div></div>
<div class="ttc" id="aIndexDefines_8H_html_ada2d84e0dbbfb8d748defbf018748a70a35281555e9873efb8a7ec30d009665d1"><div class="ttname"><a href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a35281555e9873efb8a7ec30d009665d1">Weno_3MZQ</a></div><div class="ttdeci">@ Weno_3MZQ</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:200</div></div>
<div class="ttc" id="aIndexDefines_8H_html_ada2d84e0dbbfb8d748defbf018748a70a3f52c29fc095fec904b780e9cdb21dff"><div class="ttname"><a href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a3f52c29fc095fec904b780e9cdb21dff">Weno_3Z</a></div><div class="ttdeci">@ Weno_3Z</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:197</div></div>
<div class="ttc" id="aIndexDefines_8H_html_ada2d84e0dbbfb8d748defbf018748a70a7b2a966dc1393623ced30f715e3a1c5b"><div class="ttname"><a href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a7b2a966dc1393623ced30f715e3a1c5b">Weno_3</a></div><div class="ttdeci">@ Weno_3</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:196</div></div>
<div class="ttc" id="aIndexDefines_8H_html_ada2d84e0dbbfb8d748defbf018748a70a97d28956ba07aedc3c043286e6493342"><div class="ttname"><a href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a97d28956ba07aedc3c043286e6493342">Weno_5Z</a></div><div class="ttdeci">@ Weno_5Z</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:199</div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_74389ed8173ad57b461b9d623a1f3867.html">Source</a></li><li class="navelem"><a class="el" href="dir_87c27e56fd01e6f1a6e2085b6fe8a1a5.html">Advection</a></li><li class="navelem"><a class="el" href="AdvectionSrcForState_8cpp.html">AdvectionSrcForState.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
