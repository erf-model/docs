<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ERF: AerRadProps Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ERF
   </div>
   <div id="projectbrief">Energy Research and Forecasting: An Atmospheric Modeling Code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('classAerRadProps.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classAerRadProps-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">AerRadProps Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="Aero__rad__props_8H_source.html">Aero_rad_props.H</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for AerRadProps:</div>
<div class="dyncontent">
<div class="center"><img src="classAerRadProps__coll__graph.png" border="0" usemap="#aAerRadProps_coll__map" alt="Collaboration graph"/></div>
<map name="aAerRadProps_coll__map" id="aAerRadProps_coll__map">
<area shape="rect" title=" " alt="" coords="2573,1479,2679,1505"/>
<area shape="rect" href="classMam4__aer.html" title=" " alt="" coords="2366,1793,2457,1820"/>
<area shape="rect" href="classMamConstituents.html" title=" " alt="" coords="2088,1419,2225,1445"/>
<area shape="rect" href="structMamConstituents_1_1modes__t.html" title=" " alt="" coords="1746,965,1947,992"/>
<area shape="rect" title=" " alt="" coords="303,536,341,563"/>
<area shape="rect" href="structMamConstituents_1_1mode__component__t.html" title=" " alt="" coords="982,886,1165,927"/>
<area shape="rect" title=" " alt="" coords="597,943,736,969"/>
<area shape="rect" href="structMamConstituents_1_1modelist__t.html" title=" " alt="" coords="966,1219,1181,1245"/>
<area shape="rect" href="structMamConstituents_1_1aerlist__t.html" title=" " alt="" coords="1361,628,1559,655"/>
<area shape="rect" href="structMamConstituents_1_1aerosol__t.html" title=" " alt="" coords="564,609,769,636"/>
<area shape="rect" href="structMamConstituents_1_1gaslist__t.html" title=" " alt="" coords="1360,1083,1560,1109"/>
<area shape="rect" href="structMamConstituents_1_1gas__t.html" title=" " alt="" coords="577,1044,757,1071"/>
<area shape="rect" href="structPhysProp_1_1physprop__t.html" title=" " alt="" coords="585,1817,748,1844"/>
<area shape="rect" title=" " alt="" coords="573,1293,760,1320"/>
<area shape="rect" href="classPhysProp.html" title=" " alt="" coords="1419,1481,1501,1508"/>
<area shape="rect" title=" " alt="" coords="279,1496,365,1523"/>
<area shape="rect" title=" " alt="" coords="5,1489,144,1530"/>
<area shape="rect" title=" " alt="" coords="257,1017,387,1044"/>
<area shape="rect" title=" " alt="" coords="1349,886,1571,927"/>
<area shape="rect" title=" " alt="" coords="1349,1407,1571,1449"/>
<area shape="rect" title=" " alt="" coords="1736,513,1957,554"/>
<area shape="rect" title=" " alt="" coords="963,649,1184,690"/>
<area shape="rect" title=" " alt="" coords="1736,1075,1957,1117"/>
<area shape="rect" title=" " alt="" coords="963,1075,1184,1117"/>
<area shape="rect" title=" " alt="" coords="990,1614,1157,1655"/>
<area shape="rect" title=" " alt="" coords="55,1017,94,1044"/>
<area shape="rect" title=" " alt="" coords="1821,1761,1872,1788"/>
<area shape="rect" title=" " alt="" coords="291,1817,353,1844"/>
<area shape="rect" title=" " alt="" coords="291,2524,353,2551"/>
<area shape="rect" title=" " alt="" coords="299,2156,345,2183"/>
<area shape="rect" title=" " alt="" coords="291,2367,353,2393"/>
<area shape="rect" title=" " alt="" coords="2125,2479,2188,2505"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ae0eb6fbcd6b30a8e4538b8db3944d1e0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAerRadProps.html#ae0eb6fbcd6b30a8e4538b8db3944d1e0">AerRadProps</a> ()=default</td></tr>
<tr class="separator:ae0eb6fbcd6b30a8e4538b8db3944d1e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb46a505acde8e7bd4a4b4d15e8e1792"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAerRadProps.html#aeb46a505acde8e7bd4a4b4d15e8e1792">~AerRadProps</a> ()=default</td></tr>
<tr class="separator:aeb46a505acde8e7bd4a4b4d15e8e1792"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d708a6b6284e41f8dce29444416c810"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAerRadProps.html#a4d708a6b6284e41f8dce29444416c810">initialize</a> (int ngas_, int nmodes_, int num_aeros_, int nswbands_, int nlwbands_, int ncol_, int nlev_, int nrh_, int top_lev_, const std::vector&lt; std::string &gt; &amp;aero_names_, const real2d &amp;zi_, const real2d &amp;pmid_, const real2d &amp;temp_, const real2d &amp;qi_, const real2d &amp;geom_radius)</td></tr>
<tr class="separator:a4d708a6b6284e41f8dce29444416c810"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a433097bd85637100b16f3e120e9d6fa1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAerRadProps.html#a433097bd85637100b16f3e120e9d6fa1">aer_rad_props_sw</a> (const int &amp;<a class="el" href="Modal__aero__wateruptake_8H.html#ac871f47ba48bc0761657c3be0f86bad2">list_idx</a>, const real &amp;dt, const int &amp;nnite, const int1d &amp;idxnite, const bool is_cmip6_volc, const real3d &amp;tau, const real3d &amp;tau_w, const real3d &amp;tau_w_g, const real3d &amp;tau_w_f, const real2d &amp;clear_rh)</td></tr>
<tr class="separator:a433097bd85637100b16f3e120e9d6fa1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6aabfa89e9a9d91bae79c7a0d91f17b3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAerRadProps.html#a6aabfa89e9a9d91bae79c7a0d91f17b3">aer_rad_props_lw</a> (const bool &amp;is_cmip6_volc, const int &amp;<a class="el" href="Modal__aero__wateruptake_8H.html#ac871f47ba48bc0761657c3be0f86bad2">list_idx</a>, const real &amp;dt, const real2d &amp;<a class="el" href="classAerRadProps.html#ac82b4bf91bb3a23e33074e00381388e3">zi</a>, const real3d &amp;odap_aer, const real2d &amp;clear_rh)</td></tr>
<tr class="separator:a6aabfa89e9a9d91bae79c7a0d91f17b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a1e71160911bbc52d09bdbd73acb219"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAerRadProps.html#a6a1e71160911bbc52d09bdbd73acb219">get_hygro_rad_props</a> (const int &amp;<a class="el" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, const int2d &amp;krh, const real2d &amp;wrh, const real2d &amp;mass, const real2d &amp;ext, const real2d &amp;ssa, const real2d &amp;assm, const real3d &amp;tau, const real3d &amp;tau_w, const real3d &amp;tau_w_g, const real3d &amp;tau_w_f)</td></tr>
<tr class="separator:a6a1e71160911bbc52d09bdbd73acb219"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6e6827c17d2247b72337a35875ea0e0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAerRadProps.html#af6e6827c17d2247b72337a35875ea0e0">get_nonhygro_rad_props</a> (const int &amp;<a class="el" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, const real2d &amp;mass, const real1d &amp;ext, const real1d &amp;ssa, const real1d &amp;assm, const real3d &amp;tau, const real3d &amp;tau_w, const real3d &amp;tau_w_g, const real3d &amp;tau_w_f)</td></tr>
<tr class="separator:af6e6827c17d2247b72337a35875ea0e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55507a56c5808f7480e42f4369cbf5a7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAerRadProps.html#a55507a56c5808f7480e42f4369cbf5a7">get_volcanic_radius_rad_props</a> (const int &amp;<a class="el" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, const real2d &amp;mass, const real2d &amp;r_ext, const real2d &amp;r_scat, const real2d &amp;r_ascat, const real1d &amp;r_mu, const real3d &amp;tau, const real3d &amp;tau_w, const real3d &amp;tau_w_g, const real3d &amp;tau_w_f)</td></tr>
<tr class="separator:a55507a56c5808f7480e42f4369cbf5a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4241f4adcf62ef3c537a91bdfce66db"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAerRadProps.html#aa4241f4adcf62ef3c537a91bdfce66db">volcanic_cmip_sw</a> (const int1d &amp;trop_level, const real2d &amp;<a class="el" href="classAerRadProps.html#ac82b4bf91bb3a23e33074e00381388e3">zi</a>, const real3d &amp;ext_cmip6_sw_inv_m, const real3d &amp;<a class="el" href="classAerRadProps.html#a0690511bbea6225a4afa365c4c153f0c">ssa_cmip6_sw</a>, const real3d &amp;<a class="el" href="classAerRadProps.html#afd083b451cf913a409380fb0b95de4c0">af_cmip6_sw</a>, const real3d &amp;tau, const real3d &amp;tau_w, const real3d &amp;tau_w_g, const real3d &amp;tau_w_f)</td></tr>
<tr class="separator:aa4241f4adcf62ef3c537a91bdfce66db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74842fff81711719376fc035b86dc1a7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAerRadProps.html#a74842fff81711719376fc035b86dc1a7">get_volcanic_rad_props</a> (const int &amp;<a class="el" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, const real2d &amp;mass, const real1d &amp;ext, const real1d &amp;scat, const real1d &amp;ascat, const real3d &amp;tau, const real3d &amp;tau_w, const real3d &amp;tau_w_g, const real3d &amp;tau_w_f)</td></tr>
<tr class="separator:a74842fff81711719376fc035b86dc1a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97f18fad2a20322240862cee5c3fb5b7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAerRadProps.html#a97f18fad2a20322240862cee5c3fb5b7">aer_vis_diag_out</a> (const int &amp;<a class="el" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, const int &amp;nnite, const int1d &amp;idxnite, const int &amp;iaer, const real2d &amp;tau, const int &amp;diag_idx)</td></tr>
<tr class="separator:a97f18fad2a20322240862cee5c3fb5b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a3bd718612795e1c875ad70da941cc89a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAerRadProps.html#a3bd718612795e1c875ad70da941cc89a">nmodes</a></td></tr>
<tr class="separator:a3bd718612795e1c875ad70da941cc89a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae41f31dfce03d5b3952114e12436bec9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAerRadProps.html#ae41f31dfce03d5b3952114e12436bec9">ngas</a></td></tr>
<tr class="separator:ae41f31dfce03d5b3952114e12436bec9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af174fea4281252e1cf87c621ab532aeb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAerRadProps.html#af174fea4281252e1cf87c621ab532aeb">num_aeroes</a></td></tr>
<tr class="separator:af174fea4281252e1cf87c621ab532aeb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6dcb735fda4651c893ce9d3c2860a0af"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAerRadProps.html#a6dcb735fda4651c893ce9d3c2860a0af">aero_names</a></td></tr>
<tr class="separator:a6dcb735fda4651c893ce9d3c2860a0af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aded12109795a3f22556faecdd3fb3d03"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAerRadProps.html#aded12109795a3f22556faecdd3fb3d03">nswbands</a></td></tr>
<tr class="separator:aded12109795a3f22556faecdd3fb3d03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2dc3b884340390993212e03e99112af"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAerRadProps.html#af2dc3b884340390993212e03e99112af">nlwbands</a></td></tr>
<tr class="separator:af2dc3b884340390993212e03e99112af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a551936497e3a360746d6bfd53513d508"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a></td></tr>
<tr class="separator:a551936497e3a360746d6bfd53513d508"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3854326c4b23eedef970611ab3a639dd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a></td></tr>
<tr class="separator:a3854326c4b23eedef970611ab3a639dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa21297bb80600126531f2d324f6d9c2f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAerRadProps.html#aa21297bb80600126531f2d324f6d9c2f">nrh</a></td></tr>
<tr class="separator:aa21297bb80600126531f2d324f6d9c2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83216edbd2d57b575f1869df38a1b668"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAerRadProps.html#a83216edbd2d57b575f1869df38a1b668">top_lev</a></td></tr>
<tr class="separator:a83216edbd2d57b575f1869df38a1b668"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66f750181cccc82c03268b0a4a245ecc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMamConstituents.html">MamConstituents</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAerRadProps.html#a66f750181cccc82c03268b0a4a245ecc">mam_consti</a></td></tr>
<tr class="separator:a66f750181cccc82c03268b0a4a245ecc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb607ae14bfc3e46dd66c9e04627a57d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMam4__aer.html">Mam4_aer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAerRadProps.html#afb607ae14bfc3e46dd66c9e04627a57d">mam_aer</a></td></tr>
<tr class="separator:afb607ae14bfc3e46dd66c9e04627a57d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1bf28a8f87d617095d3cf88cf7ef738e"><td class="memItemLeft" align="right" valign="top">real2d&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAerRadProps.html#a1bf28a8f87d617095d3cf88cf7ef738e">pdeldry</a></td></tr>
<tr class="separator:a1bf28a8f87d617095d3cf88cf7ef738e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab56e110ccf8deaa71d452a64e69b8647"><td class="memItemLeft" align="right" valign="top">real2d&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAerRadProps.html#ab56e110ccf8deaa71d452a64e69b8647">pmid</a></td></tr>
<tr class="separator:ab56e110ccf8deaa71d452a64e69b8647"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a03391413de1fcd9ea2550fea907b33"><td class="memItemLeft" align="right" valign="top">real2d&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAerRadProps.html#a0a03391413de1fcd9ea2550fea907b33">temp</a></td></tr>
<tr class="separator:a0a03391413de1fcd9ea2550fea907b33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a837035712a214f1b8daf7a4d30727e6d"><td class="memItemLeft" align="right" valign="top">real2d&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAerRadProps.html#a837035712a214f1b8daf7a4d30727e6d">qt</a></td></tr>
<tr class="separator:a837035712a214f1b8daf7a4d30727e6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a315308c2521564d2531785962659d292"><td class="memItemLeft" align="right" valign="top">real2d&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAerRadProps.html#a315308c2521564d2531785962659d292">geometric_radius</a></td></tr>
<tr class="separator:a315308c2521564d2531785962659d292"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac82b4bf91bb3a23e33074e00381388e3"><td class="memItemLeft" align="right" valign="top">real2d&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAerRadProps.html#ac82b4bf91bb3a23e33074e00381388e3">zi</a></td></tr>
<tr class="separator:ac82b4bf91bb3a23e33074e00381388e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf87aa0fdbfa3b73924a1f7c56088e55"><td class="memItemLeft" align="right" valign="top">real3d&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAerRadProps.html#acf87aa0fdbfa3b73924a1f7c56088e55">ext_cmip6_sw</a></td></tr>
<tr class="separator:acf87aa0fdbfa3b73924a1f7c56088e55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0690511bbea6225a4afa365c4c153f0c"><td class="memItemLeft" align="right" valign="top">real3d&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAerRadProps.html#a0690511bbea6225a4afa365c4c153f0c">ssa_cmip6_sw</a></td></tr>
<tr class="separator:a0690511bbea6225a4afa365c4c153f0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd083b451cf913a409380fb0b95de4c0"><td class="memItemLeft" align="right" valign="top">real3d&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAerRadProps.html#afd083b451cf913a409380fb0b95de4c0">af_cmip6_sw</a></td></tr>
<tr class="separator:afd083b451cf913a409380fb0b95de4c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ae0eb6fbcd6b30a8e4538b8db3944d1e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0eb6fbcd6b30a8e4538b8db3944d1e0">&#9670;&nbsp;</a></span>AerRadProps()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">AerRadProps::AerRadProps </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">default</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aeb46a505acde8e7bd4a4b4d15e8e1792"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb46a505acde8e7bd4a4b4d15e8e1792">&#9670;&nbsp;</a></span>~AerRadProps()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">AerRadProps::~AerRadProps </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">default</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a6aabfa89e9a9d91bae79c7a0d91f17b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6aabfa89e9a9d91bae79c7a0d91f17b3">&#9670;&nbsp;</a></span>aer_rad_props_lw()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AerRadProps::aer_rad_props_lw </td>
          <td>(</td>
          <td class="paramtype">const bool &amp;&#160;</td>
          <td class="paramname"><em>is_cmip6_volc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int &amp;&#160;</td>
          <td class="paramname"><em>list_idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real &amp;&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>zi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>odap_aer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>clear_rh</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                                                            {</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keywordtype">int</span> numaerosols; <span class="comment">// number of bulk aerosols in climate/diagnostic list</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classAerRadProps.html#a3bd718612795e1c875ad70da941cc89a">nmodes</a>;      <span class="comment">// number of aerosol modes in climate/diagnostic list</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    std::string opticstype;  <span class="comment">// hygro or nonhygro</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="comment">// optical props for each aerosol</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    real1d lw_abs(<span class="stringliteral">&quot;lw_abs&quot;</span>, <a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    real2d lw_hygro_abs(<span class="stringliteral">&quot;lw_hygro&quot;</span>, <a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    real2d <a class="code" href="classAerRadProps.html#a315308c2521564d2531785962659d292">geometric_radius</a>(<span class="stringliteral">&quot;geometric_radius&quot;</span>, <a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="comment">// volcanic lookup table</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    real2d r_lw_abs(<span class="stringliteral">&quot;r_lw_abs&quot;</span>, <a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>);  <span class="comment">// radius dependent mass-specific absorption coefficient</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    real1d r_mu(<span class="stringliteral">&quot;r_mu&quot;</span>, <a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>);        <span class="comment">// log(geometric_mean_radius) domain samples of r_lw_abs(:,:)</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    real2d mu(<span class="stringliteral">&quot;mu&quot;</span>, <a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>);          <span class="comment">// log(geometric_radius)</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    real r_mu_min, r_mu_max, wmu, mutrunc;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="keywordtype">int</span> nmu, kmu;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="comment">// for table lookup into rh grid</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    real2d <a class="code" href="Modal__aero__wateruptake_8H.html#a8a0c0dddc4a8389a14e6906b55d7cacf">es</a>(<span class="stringliteral">&quot;es&quot;</span>, <a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>);     <span class="comment">// saturation vapor pressure</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    real2d <a class="code" href="Modal__aero__wateruptake_8H.html#a732deb0c6f95544c2c323749f227bbd6">qs</a>(<span class="stringliteral">&quot;qs&quot;</span>, <a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>);     <span class="comment">// saturation specific humidity</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    real2d <a class="code" href="Modal__aero__wateruptake_8H.html#a352bc71b7a47b331f4f6b71b09e0401d">rh</a>(<span class="stringliteral">&quot;rh&quot;</span>, <a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    real2d rhtrunc(<span class="stringliteral">&quot;rhtrunc&quot;</span>, <a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    real2d wrh(<span class="stringliteral">&quot;wrh&quot;</span>, <a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    int2d krh(<span class="stringliteral">&quot;krh&quot;</span>, <a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="comment">// aerosol (vertical) mass path and extinction aerosol masses</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    real2d aermmr(<span class="stringliteral">&quot;aermmr&quot;</span>, <a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>);    <span class="comment">// mass mixing ratio of aerosols</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    real2d mmr_to_mass(<span class="stringliteral">&quot;mmr_to_mass&quot;</span>, <a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>); <span class="comment">// conversion factor for mmr to mass</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    real2d aermass(<span class="stringliteral">&quot;aermass&quot;</span>, <a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>);     <span class="comment">// mass of aerosols</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="comment">//For cmip6 volcanic file</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    int1d trop_level(<span class="stringliteral">&quot;trop_level&quot;</span>, <a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    real lyr_thk;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    real3d ext_cmip6_lw(<span class="stringliteral">&quot;ext_cmip6_lw&quot;</span>, <a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>, <a class="code" href="classAerRadProps.html#af2dc3b884340390993212e03e99112af">nlwbands</a>);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    real3d ext_cmip6_lw_inv_m(<span class="stringliteral">&quot;ext_cmip6_lw_inv_m&quot;</span>,<a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>, <a class="code" href="classAerRadProps.html#af2dc3b884340390993212e03e99112af">nlwbands</a>); <span class="comment">//long wave extinction in the units of 1/m</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160; </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keyword">const</span> real km_inv_to_m_inv = 0.001;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160; </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="comment">// get number of bulk aerosols and number of modes in current list</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <a class="code" href="classAerRadProps.html#a66f750181cccc82c03268b0a4a245ecc">mam_consti</a>.<a class="code" href="classMamConstituents.html#a5de90eaa3b6d493a7b12ce7df766fa6f">get_nmodes</a>(<a class="code" href="Modal__aero__wateruptake_8H.html#ac871f47ba48bc0761657c3be0f86bad2">list_idx</a>, <a class="code" href="classAerRadProps.html#a3bd718612795e1c875ad70da941cc89a">nmodes</a>);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <a class="code" href="classAerRadProps.html#a66f750181cccc82c03268b0a4a245ecc">mam_consti</a>.<a class="code" href="classMamConstituents.html#abd92c92743d51efe2f17e68cbfaccee1">get_naero</a>(<a class="code" href="Modal__aero__wateruptake_8H.html#ac871f47ba48bc0761657c3be0f86bad2">list_idx</a>, numaerosols);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160; </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="comment">// Contributions from modal aerosols.</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classAerRadProps.html#a3bd718612795e1c875ad70da941cc89a">nmodes</a> &gt; 0) {</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <a class="code" href="classAerRadProps.html#afb607ae14bfc3e46dd66c9e04627a57d">mam_aer</a>.<a class="code" href="classMam4__aer.html#a9721da0af2c6b65da92a81c76f3bf43d">modal_aero_lw</a>(<a class="code" href="Modal__aero__wateruptake_8H.html#ac871f47ba48bc0761657c3be0f86bad2">list_idx</a>, dt, odap_aer,clear_rh);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        yakl::memset(odap_aer, 0.);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    }</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160; </div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="comment">// Contributions from bulk aerosols.</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="keywordflow">if</span> (numaerosols &gt; 0) {</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160; </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        <span class="comment">// compute mixing ratio to mass conversion</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        parallel_for(SimpleBounds&lt;2&gt;(<a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>), YAKL_LAMBDA (<span class="keywordtype">int</span> icol, <span class="keywordtype">int</span> ilev) {</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                mmr_to_mass(icol,ilev) = <a class="code" href="ERF__Constants_8H.html#a562f6dc5abcd5944a1d3cd8f22146d31">rgas</a> * <a class="code" href="classAerRadProps.html#a1bf28a8f87d617095d3cf88cf7ef738e">pdeldry</a>(icol,ilev);</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            });</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <span class="comment">// calculate relative humidity for table lookup into rh grid</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        parallel_for(SimpleBounds&lt;2&gt;(<a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>), YAKL_LAMBDA (<span class="keywordtype">int</span> icol, <span class="keywordtype">int</span> ilev)</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        {</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;            <a class="code" href="classWaterVaporSat.html#a4dac5d0ff52b333add64a13539fca1c8">WaterVaporSat::qsat</a>(<a class="code" href="classAerRadProps.html#a0a03391413de1fcd9ea2550fea907b33">temp</a>(icol,ilev), <a class="code" href="classAerRadProps.html#ab56e110ccf8deaa71d452a64e69b8647">pmid</a>(icol,ilev), <a class="code" href="Modal__aero__wateruptake_8H.html#a8a0c0dddc4a8389a14e6906b55d7cacf">es</a>(icol,ilev), <a class="code" href="Modal__aero__wateruptake_8H.html#a732deb0c6f95544c2c323749f227bbd6">qs</a>(icol,ilev));</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            <a class="code" href="Modal__aero__wateruptake_8H.html#a352bc71b7a47b331f4f6b71b09e0401d">rh</a>(icol,ilev) = <a class="code" href="classAerRadProps.html#a837035712a214f1b8daf7a4d30727e6d">qt</a>(icol,ilev) / <a class="code" href="Modal__aero__wateruptake_8H.html#a732deb0c6f95544c2c323749f227bbd6">qs</a>(icol,ilev);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160; </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            rhtrunc(icol, ilev) = std::min(<a class="code" href="Modal__aero__wateruptake_8H.html#a352bc71b7a47b331f4f6b71b09e0401d">rh</a>(icol, ilev),1.);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            krh(icol, ilev) = std::min(std::floor(rhtrunc(icol, ilev) * <a class="code" href="classAerRadProps.html#aa21297bb80600126531f2d324f6d9c2f">nrh</a> ) + 1, <a class="code" href="classAerRadProps.html#aa21297bb80600126531f2d324f6d9c2f">nrh</a> - 1.);  <span class="comment">// index into rh mesh</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            wrh(icol, ilev) = rhtrunc(icol, ilev) * <a class="code" href="classAerRadProps.html#aa21297bb80600126531f2d324f6d9c2f">nrh</a> - krh(icol, ilev);       <span class="comment">// (-) weighting on left side values</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        });</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    }</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160; </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    yakl::memset(ext_cmip6_lw, 0.);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keywordflow">if</span>(is_cmip6_volc) {</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        <span class="comment">// Logic:</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        <span class="comment">// Update odap_aer with the read in volcanic aerosol extinction (1/km).</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        <span class="comment">// It needs to be converted to 1/m and multiplied by layer thickness first.</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <span class="comment">// Obtain read in values for ext from the volcanic input file</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        <span class="comment">//      call pbuf_get_field(pbuf, idx_ext_lw, ext_cmip6_lw)</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        <span class="comment">//      call outfld(&#39;extinct_lw_inp&#39;,ext_cmip6_lw(:,:,idx_lw_diag), pcols, lchnk)</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        <span class="comment">//      ext_cmip6_lw_inv_m = ext_cmip6_lw * km_inv_to_m_inv  !convert from 1/km to 1/m</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        <span class="comment">// Above the tropopause, the read in values from the file include both the stratospheric</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        <span class="comment">// and volcanic aerosols. Therefore, we need to zero out odap_aer above the tropopause</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        <span class="comment">// and populate it exclusively from the read in values.</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160; </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        <span class="comment">// Find tropopause</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        <span class="comment">// trop_level has value for tropopause for each column</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <span class="comment">//      tropopause_find(state, trop_level)</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        real1d strop(<span class="stringliteral">&quot;strop&quot;</span>,1);</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        parallel_for(SimpleBounds&lt;1&gt;(<a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>), YAKL_LAMBDA (<span class="keywordtype">int</span> i)</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        {</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            <span class="comment">// Search from the bottom up, looking for the first minimum.</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            <span class="keywordtype">int</span> tlev  = -1;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">auto</span> k = <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>-1; k &gt; 0; --k) {</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                real stobie = 0.03 * <a class="code" href="classAerRadProps.html#a0a03391413de1fcd9ea2550fea907b33">temp</a>(i,k) - std::log10(<a class="code" href="classAerRadProps.html#ab56e110ccf8deaa71d452a64e69b8647">pmid</a>(i, k));</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classAerRadProps.html#ab56e110ccf8deaa71d452a64e69b8647">pmid</a>(i, k) &lt;= 4000.) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classAerRadProps.html#ab56e110ccf8deaa71d452a64e69b8647">pmid</a>(i, k) &gt;= 55000.) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                <span class="keywordflow">if</span> ((tlev == -1) || (stobie &lt; strop(0))) {</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                    tlev  = k;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                    strop(0) = stobie;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                }</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            }</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            <span class="keywordflow">if</span> (tlev != -1) trop_level(i) = tlev;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        });</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160; </div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        <span class="comment">// Quit if tropopause is not found</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        <span class="keywordflow">if</span> (yakl::intrinsics::any(trop_level) == -1)</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;            amrex::Print() &lt;&lt; <span class="stringliteral">&quot;aer_rad_props_lw: tropopause not found\n&quot;</span>;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160; </div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        <span class="comment">// If tropopause is found, update taus with 50% contributuions from the volcanic input</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        <span class="comment">// file and 50% from the existing model computed values</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        <span class="comment">// First handle the case of tropopause layer itself:</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        parallel_for(SimpleBounds&lt;2&gt;(<a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#af2dc3b884340390993212e03e99112af">nlwbands</a>), YAKL_LAMBDA (<span class="keywordtype">int</span> icol, <span class="keywordtype">int</span> ilw)</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        {</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;            <span class="keywordtype">int</span> ilev_tropp = trop_level(icol); <span class="comment">//tropopause level</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;            <span class="keyword">auto</span> lyr_thk    = <a class="code" href="classAerRadProps.html#ac82b4bf91bb3a23e33074e00381388e3">zi</a>(icol,ilev_tropp) - <a class="code" href="classAerRadProps.html#ac82b4bf91bb3a23e33074e00381388e3">zi</a>(icol,ilev_tropp+1); <span class="comment">//in meters</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;            <span class="keyword">auto</span> ext_cmip6_inv_m = km_inv_to_m_inv * ext_cmip6_lw_inv_m(icol,ilev_tropp,ilw);</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            odap_aer(icol,ilev_tropp,ilw) = 0.5 * (odap_aer(icol,ilev_tropp,ilw) + lyr_thk * ext_cmip6_inv_m);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        });</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160; </div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        <span class="comment">// As it will be more efficient for FORTRAN to loop over levels and then columns, the following loops</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        <span class="comment">// are nested keeping that in mind</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        parallel_for(SimpleBounds&lt;3&gt;(<a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>, <a class="code" href="classAerRadProps.html#af2dc3b884340390993212e03e99112af">nlwbands</a>), YAKL_LAMBDA (<span class="keywordtype">int</span> icol, <span class="keywordtype">int</span> ilev, <span class="keywordtype">int</span> ilw)</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        {</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            <span class="keywordtype">int</span> ilev_tropp = trop_level(icol); <span class="comment">//tropopause level</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;            <span class="keywordflow">if</span> (ilev &lt; ilev_tropp) {</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                <span class="keyword">auto</span> lyr_thk = <a class="code" href="classAerRadProps.html#ac82b4bf91bb3a23e33074e00381388e3">zi</a>(icol,ilev) - <a class="code" href="classAerRadProps.html#ac82b4bf91bb3a23e33074e00381388e3">zi</a>(icol,ilev+1);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                <span class="comment">// odap_aer(icol,ilev,ilw) = lyr_thk * ext_cmip6_lw_inv_m(icol,ilev,ilw);</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;            }</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        });</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    }</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160; </div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160; </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="comment">// Loop over bulk aerosols in list.</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> iaerosol = 0; iaerosol &lt; numaerosols; ++iaerosol) {</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160; </div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        <span class="comment">// get aerosol mass mixing ratio</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        <span class="comment">//      mam_consti.rad_cnst_get_aer_mmr(list_idx, iaerosol, aermmr);</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        parallel_for(SimpleBounds&lt;2&gt;(<a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>), YAKL_LAMBDA (<span class="keywordtype">int</span> icol, <span class="keywordtype">int</span> ilev)</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        {</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;            <span class="keywordflow">if</span> (ilev &lt; <a class="code" href="classAerRadProps.html#a83216edbd2d57b575f1869df38a1b668">top_lev</a>) {</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                aermass(icol,ilev) = 0.;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                aermass(icol,ilev) = aermmr(icol,ilev) * mmr_to_mass(icol,ilev);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;            }</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        });</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160; </div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        <span class="comment">// get optics type</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <a class="code" href="classAerRadProps.html#a66f750181cccc82c03268b0a4a245ecc">mam_consti</a>.<a class="code" href="classMamConstituents.html#a278b01dd1df95acd2ad6a5c800caf719">get_aer_opticstype</a>(<a class="code" href="Modal__aero__wateruptake_8H.html#ac871f47ba48bc0761657c3be0f86bad2">list_idx</a>, iaerosol, opticstype);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160; </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        <span class="keywordflow">if</span> (opticstype == <span class="stringliteral">&quot;hygroscopic&quot;</span>) {</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;            <span class="comment">// get optical properties for hygroscopic aerosols</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            <a class="code" href="classAerRadProps.html#a66f750181cccc82c03268b0a4a245ecc">mam_consti</a>.<a class="code" href="classMamConstituents.html#a66c3525ddc3b20a3a9dba2d7dc5020f8">get_aer_lw_hygro_abs</a>(<a class="code" href="Modal__aero__wateruptake_8H.html#ac871f47ba48bc0761657c3be0f86bad2">list_idx</a>, iaerosol, lw_hygro_abs);</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;            parallel_for(SimpleBounds&lt;3&gt;(<a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>, <a class="code" href="classAerRadProps.html#af2dc3b884340390993212e03e99112af">nlwbands</a>), YAKL_LAMBDA (<span class="keywordtype">int</span> icol, <span class="keywordtype">int</span> ilev, <span class="keywordtype">int</span> bnd_idx)</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;            {</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                odap_aer(icol, ilev, bnd_idx) = odap_aer(icol, ilev, bnd_idx) + aermass(icol, ilev) *</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                    ((1 + wrh(icol,ilev)) * lw_hygro_abs(krh(icol, ilev)+1,bnd_idx)</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                     - wrh(icol, ilev)  * lw_hygro_abs(krh(icol, ilev),  bnd_idx));</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;            });</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (opticstype == <span class="stringliteral">&quot;insoluble&quot;</span> || opticstype == <span class="stringliteral">&quot;nonhygro&quot;</span> || opticstype == <span class="stringliteral">&quot;hygro&quot;</span> || opticstype == <span class="stringliteral">&quot;volcanic&quot;</span>) {</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;            <span class="comment">// get optical properties for hygroscopic aerosols</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;            <a class="code" href="classAerRadProps.html#a66f750181cccc82c03268b0a4a245ecc">mam_consti</a>.<a class="code" href="classMamConstituents.html#aaaf1541dee704eca0b0186f75457e49b">get_aer_lw_abs</a>(<a class="code" href="Modal__aero__wateruptake_8H.html#ac871f47ba48bc0761657c3be0f86bad2">list_idx</a>, iaerosol, lw_abs);</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;            parallel_for(SimpleBounds&lt;3&gt;(<a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>, <a class="code" href="classAerRadProps.html#af2dc3b884340390993212e03e99112af">nlwbands</a>), YAKL_LAMBDA (<span class="keywordtype">int</span> icol, <span class="keywordtype">int</span> ilev, <span class="keywordtype">int</span> bnd_idx)</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;            {</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                odap_aer(icol,ilev,bnd_idx) = odap_aer(icol,ilev,bnd_idx) + lw_abs(bnd_idx)*aermass(icol,ilev);</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;            });</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (opticstype == <span class="stringliteral">&quot;volcanic_radius&quot;</span>) {</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;            <span class="comment">// get optical properties for hygroscopic aerosols</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;            <a class="code" href="classAerRadProps.html#a66f750181cccc82c03268b0a4a245ecc">mam_consti</a>.<a class="code" href="classMamConstituents.html#ac0d794c0c89d7f87e444fc10e4ca76b6">get_aer_r_lw_abs</a>(<a class="code" href="Modal__aero__wateruptake_8H.html#ac871f47ba48bc0761657c3be0f86bad2">list_idx</a>, iaerosol, r_lw_abs);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            <a class="code" href="classAerRadProps.html#a66f750181cccc82c03268b0a4a245ecc">mam_consti</a>.<a class="code" href="classMamConstituents.html#aa268eea91939bf42c29685aa43138d15">get_aer_mu</a>(<a class="code" href="Modal__aero__wateruptake_8H.html#ac871f47ba48bc0761657c3be0f86bad2">list_idx</a>, iaerosol, r_mu);</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            <span class="comment">// get microphysical properties for volcanic aerosols</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            <span class="comment">//         idx = pbuf_get_index(&#39;VOLC_RAD_GEOM&#39;)</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;            <span class="comment">//         call pbuf_get_field(pbuf, idx, geometric_radius )</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160; </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            <span class="comment">// interpolate in radius</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;            <span class="comment">// caution: clip the table with no warning when outside bounds</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;            parallel_for(SimpleBounds&lt;2&gt;(<a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>), YAKL_LAMBDA (<span class="keywordtype">int</span> icol, <span class="keywordtype">int</span> ilev)</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;            {</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                <span class="keyword">auto</span> nmu = r_mu.extent(0);</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                <span class="keyword">auto</span> r_mu_max = r_mu(nmu);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                <span class="keyword">auto</span> r_mu_min = r_mu(1);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160; </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="classAerRadProps.html#a315308c2521564d2531785962659d292">geometric_radius</a>(icol,ilev) &gt; 0.) {</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                    mu(icol,ilev) = std::log(<a class="code" href="classAerRadProps.html#a315308c2521564d2531785962659d292">geometric_radius</a>(icol,ilev));</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                    mu(icol,ilev) = 0.;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                }</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                <span class="keyword">auto</span> mutrunc = std::max(std::min(mu(icol,ilev),r_mu_max),r_mu_min);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                <span class="keyword">auto</span> kmu = std::max(std::min(1 + (mutrunc-r_mu_min)/(r_mu_max-r_mu_min)*(nmu-1),nmu-1.),1.);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                <span class="keyword">auto</span> wmu = std::max(std::min( (mutrunc -r_mu(kmu)) / (r_mu(kmu+1) - r_mu(kmu)) ,1.),0.);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">auto</span> bnd_idx = 0; bnd_idx &lt; <a class="code" href="classAerRadProps.html#af2dc3b884340390993212e03e99112af">nlwbands</a>; ++bnd_idx) {</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                    odap_aer(icol,ilev,bnd_idx) = odap_aer(icol,ilev,bnd_idx) +</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                        aermass(icol,ilev) * ((1. - wmu) * r_lw_abs(bnd_idx, kmu) +</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                                              (wmu) * r_lw_abs(bnd_idx, kmu+1));</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                }</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;            });</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        }</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    }</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;}</div>
<div class="ttc" id="aERF__Constants_8H_html_a562f6dc5abcd5944a1d3cd8f22146d31"><div class="ttname"><a href="ERF__Constants_8H.html#a562f6dc5abcd5944a1d3cd8f22146d31">rgas</a></div><div class="ttdeci">constexpr amrex::Real rgas</div><div class="ttdef"><b>Definition:</b> ERF_Constants.H:68</div></div>
<div class="ttc" id="aModal__aero__wateruptake_8H_html_a352bc71b7a47b331f4f6b71b09e0401d"><div class="ttname"><a href="Modal__aero__wateruptake_8H.html#a352bc71b7a47b331f4f6b71b09e0401d">rh</a></div><div class="ttdeci">real2d rh(&quot;rh&quot;, pcols, pver)</div></div>
<div class="ttc" id="aModal__aero__wateruptake_8H_html_a732deb0c6f95544c2c323749f227bbd6"><div class="ttname"><a href="Modal__aero__wateruptake_8H.html#a732deb0c6f95544c2c323749f227bbd6">qs</a></div><div class="ttdeci">real1d qs(&quot;qs&quot;, pcols)</div></div>
<div class="ttc" id="aModal__aero__wateruptake_8H_html_a8a0c0dddc4a8389a14e6906b55d7cacf"><div class="ttname"><a href="Modal__aero__wateruptake_8H.html#a8a0c0dddc4a8389a14e6906b55d7cacf">es</a></div><div class="ttdeci">real1d es(&quot;es&quot;, pcols)</div></div>
<div class="ttc" id="aModal__aero__wateruptake_8H_html_ac871f47ba48bc0761657c3be0f86bad2"><div class="ttname"><a href="Modal__aero__wateruptake_8H.html#ac871f47ba48bc0761657c3be0f86bad2">list_idx</a></div><div class="ttdeci">list_idx</div><div class="ttdef"><b>Definition:</b> Modal_aero_wateruptake.H:359</div></div>
<div class="ttc" id="aclassAerRadProps_html_a0a03391413de1fcd9ea2550fea907b33"><div class="ttname"><a href="classAerRadProps.html#a0a03391413de1fcd9ea2550fea907b33">AerRadProps::temp</a></div><div class="ttdeci">real2d temp</div><div class="ttdef"><b>Definition:</b> Aero_rad_props.H:126</div></div>
<div class="ttc" id="aclassAerRadProps_html_a1bf28a8f87d617095d3cf88cf7ef738e"><div class="ttname"><a href="classAerRadProps.html#a1bf28a8f87d617095d3cf88cf7ef738e">AerRadProps::pdeldry</a></div><div class="ttdeci">real2d pdeldry</div><div class="ttdef"><b>Definition:</b> Aero_rad_props.H:124</div></div>
<div class="ttc" id="aclassAerRadProps_html_a315308c2521564d2531785962659d292"><div class="ttname"><a href="classAerRadProps.html#a315308c2521564d2531785962659d292">AerRadProps::geometric_radius</a></div><div class="ttdeci">real2d geometric_radius</div><div class="ttdef"><b>Definition:</b> Aero_rad_props.H:128</div></div>
<div class="ttc" id="aclassAerRadProps_html_a3854326c4b23eedef970611ab3a639dd"><div class="ttname"><a href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">AerRadProps::nlev</a></div><div class="ttdeci">int nlev</div><div class="ttdef"><b>Definition:</b> Aero_rad_props.H:115</div></div>
<div class="ttc" id="aclassAerRadProps_html_a3bd718612795e1c875ad70da941cc89a"><div class="ttname"><a href="classAerRadProps.html#a3bd718612795e1c875ad70da941cc89a">AerRadProps::nmodes</a></div><div class="ttdeci">int nmodes</div><div class="ttdef"><b>Definition:</b> Aero_rad_props.H:111</div></div>
<div class="ttc" id="aclassAerRadProps_html_a551936497e3a360746d6bfd53513d508"><div class="ttname"><a href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">AerRadProps::ncol</a></div><div class="ttdeci">int ncol</div><div class="ttdef"><b>Definition:</b> Aero_rad_props.H:115</div></div>
<div class="ttc" id="aclassAerRadProps_html_a66f750181cccc82c03268b0a4a245ecc"><div class="ttname"><a href="classAerRadProps.html#a66f750181cccc82c03268b0a4a245ecc">AerRadProps::mam_consti</a></div><div class="ttdeci">MamConstituents mam_consti</div><div class="ttdef"><b>Definition:</b> Aero_rad_props.H:118</div></div>
<div class="ttc" id="aclassAerRadProps_html_a83216edbd2d57b575f1869df38a1b668"><div class="ttname"><a href="classAerRadProps.html#a83216edbd2d57b575f1869df38a1b668">AerRadProps::top_lev</a></div><div class="ttdeci">int top_lev</div><div class="ttdef"><b>Definition:</b> Aero_rad_props.H:115</div></div>
<div class="ttc" id="aclassAerRadProps_html_a837035712a214f1b8daf7a4d30727e6d"><div class="ttname"><a href="classAerRadProps.html#a837035712a214f1b8daf7a4d30727e6d">AerRadProps::qt</a></div><div class="ttdeci">real2d qt</div><div class="ttdef"><b>Definition:</b> Aero_rad_props.H:126</div></div>
<div class="ttc" id="aclassAerRadProps_html_aa21297bb80600126531f2d324f6d9c2f"><div class="ttname"><a href="classAerRadProps.html#aa21297bb80600126531f2d324f6d9c2f">AerRadProps::nrh</a></div><div class="ttdeci">int nrh</div><div class="ttdef"><b>Definition:</b> Aero_rad_props.H:115</div></div>
<div class="ttc" id="aclassAerRadProps_html_ab56e110ccf8deaa71d452a64e69b8647"><div class="ttname"><a href="classAerRadProps.html#ab56e110ccf8deaa71d452a64e69b8647">AerRadProps::pmid</a></div><div class="ttdeci">real2d pmid</div><div class="ttdef"><b>Definition:</b> Aero_rad_props.H:126</div></div>
<div class="ttc" id="aclassAerRadProps_html_ac82b4bf91bb3a23e33074e00381388e3"><div class="ttname"><a href="classAerRadProps.html#ac82b4bf91bb3a23e33074e00381388e3">AerRadProps::zi</a></div><div class="ttdeci">real2d zi</div><div class="ttdef"><b>Definition:</b> Aero_rad_props.H:130</div></div>
<div class="ttc" id="aclassAerRadProps_html_af2dc3b884340390993212e03e99112af"><div class="ttname"><a href="classAerRadProps.html#af2dc3b884340390993212e03e99112af">AerRadProps::nlwbands</a></div><div class="ttdeci">int nlwbands</div><div class="ttdef"><b>Definition:</b> Aero_rad_props.H:114</div></div>
<div class="ttc" id="aclassAerRadProps_html_afb607ae14bfc3e46dd66c9e04627a57d"><div class="ttname"><a href="classAerRadProps.html#afb607ae14bfc3e46dd66c9e04627a57d">AerRadProps::mam_aer</a></div><div class="ttdeci">Mam4_aer mam_aer</div><div class="ttdef"><b>Definition:</b> Aero_rad_props.H:121</div></div>
<div class="ttc" id="aclassMam4__aer_html_a9721da0af2c6b65da92a81c76f3bf43d"><div class="ttname"><a href="classMam4__aer.html#a9721da0af2c6b65da92a81c76f3bf43d">Mam4_aer::modal_aero_lw</a></div><div class="ttdeci">void modal_aero_lw(int list_idx, real dt, const real3d &amp;tauxar, const real2d &amp;clear_rh)</div><div class="ttdef"><b>Definition:</b> Mam4_aero.H:570</div></div>
<div class="ttc" id="aclassMamConstituents_html_a278b01dd1df95acd2ad6a5c800caf719"><div class="ttname"><a href="classMamConstituents.html#a278b01dd1df95acd2ad6a5c800caf719">MamConstituents::get_aer_opticstype</a></div><div class="ttdeci">void get_aer_opticstype(int list_idx, int aer_idx, std::string opticstype)</div><div class="ttdef"><b>Definition:</b> Mam4_constituents.H:912</div></div>
<div class="ttc" id="aclassMamConstituents_html_a5de90eaa3b6d493a7b12ce7df766fa6f"><div class="ttname"><a href="classMamConstituents.html#a5de90eaa3b6d493a7b12ce7df766fa6f">MamConstituents::get_nmodes</a></div><div class="ttdeci">void get_nmodes(int list_idx, int nmodes)</div><div class="ttdef"><b>Definition:</b> Mam4_constituents.H:324</div></div>
<div class="ttc" id="aclassMamConstituents_html_a66c3525ddc3b20a3a9dba2d7dc5020f8"><div class="ttname"><a href="classMamConstituents.html#a66c3525ddc3b20a3a9dba2d7dc5020f8">MamConstituents::get_aer_lw_hygro_abs</a></div><div class="ttdeci">void get_aer_lw_hygro_abs(int list_idx, int aer_idx, real2d &amp;lw_hygro_abs)</div><div class="ttdef"><b>Definition:</b> Mam4_constituents.H:944</div></div>
<div class="ttc" id="aclassMamConstituents_html_aa268eea91939bf42c29685aa43138d15"><div class="ttname"><a href="classMamConstituents.html#aa268eea91939bf42c29685aa43138d15">MamConstituents::get_aer_mu</a></div><div class="ttdeci">void get_aer_mu(int list_idx, int aer_idx, real1d &amp;mu)</div><div class="ttdef"><b>Definition:</b> Mam4_constituents.H:1050</div></div>
<div class="ttc" id="aclassMamConstituents_html_aaaf1541dee704eca0b0186f75457e49b"><div class="ttname"><a href="classMamConstituents.html#aaaf1541dee704eca0b0186f75457e49b">MamConstituents::get_aer_lw_abs</a></div><div class="ttdeci">void get_aer_lw_abs(int list_idx, int aer_idx, real1d &amp;lw_abs)</div><div class="ttdef"><b>Definition:</b> Mam4_constituents.H:992</div></div>
<div class="ttc" id="aclassMamConstituents_html_abd92c92743d51efe2f17e68cbfaccee1"><div class="ttname"><a href="classMamConstituents.html#abd92c92743d51efe2f17e68cbfaccee1">MamConstituents::get_naero</a></div><div class="ttdeci">void get_naero(int list_idx, int naero)</div><div class="ttdef"><b>Definition:</b> Mam4_constituents.H:334</div></div>
<div class="ttc" id="aclassMamConstituents_html_ac0d794c0c89d7f87e444fc10e4ca76b6"><div class="ttname"><a href="classMamConstituents.html#ac0d794c0c89d7f87e444fc10e4ca76b6">MamConstituents::get_aer_r_lw_abs</a></div><div class="ttdeci">void get_aer_r_lw_abs(int list_idx, int aer_idx, real2d &amp;r_lw_abs)</div><div class="ttdef"><b>Definition:</b> Mam4_constituents.H:1042</div></div>
<div class="ttc" id="aclassWaterVaporSat_html_a4dac5d0ff52b333add64a13539fca1c8"><div class="ttname"><a href="classWaterVaporSat.html#a4dac5d0ff52b333add64a13539fca1c8">WaterVaporSat::qsat</a></div><div class="ttdeci">AMREX_GPU_HOST_DEVICE static AMREX_FORCE_INLINE void qsat(const amrex::Real &amp;t, const amrex::Real &amp;p, amrex::Real &amp;es, amrex::Real &amp;qs, amrex::Real gam=0., amrex::Real dqsdt=0., amrex::Real enthalpy=0.)</div><div class="ttdef"><b>Definition:</b> Water_vapor_saturation.H:149</div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classOptics.html#aecf608be7db530dc74beb0a03b2279f2">Optics::set_aerosol_optics_lw()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classAerRadProps_a6aabfa89e9a9d91bae79c7a0d91f17b3_cgraph.png" border="0" usemap="#aclassAerRadProps_a6aabfa89e9a9d91bae79c7a0d91f17b3_cgraph" alt=""/></div>
<map name="aclassAerRadProps_a6aabfa89e9a9d91bae79c7a0d91f17b3_cgraph" id="aclassAerRadProps_a6aabfa89e9a9d91bae79c7a0d91f17b3_cgraph">
<area shape="rect" title=" " alt="" coords="5,1524,168,1566"/>
<area shape="rect" href="Modal__aero__wateruptake_8H.html#a8a0c0dddc4a8389a14e6906b55d7cacf" title=" " alt="" coords="1241,693,1280,720"/>
<area shape="rect" href="classMamConstituents.html#aaaf1541dee704eca0b0186f75457e49b" title=" " alt="" coords="232,1426,399,1467"/>
<area shape="rect" href="classMamConstituents.html#a66c3525ddc3b20a3a9dba2d7dc5020f8" title=" " alt="" coords="232,1491,399,1532"/>
<area shape="rect" href="classMamConstituents.html#aa268eea91939bf42c29685aa43138d15" title=" " alt="" coords="232,1556,399,1598"/>
<area shape="rect" href="classMamConstituents.html#a278b01dd1df95acd2ad6a5c800caf719" title=" " alt="" coords="232,1622,399,1663"/>
<area shape="rect" href="classMamConstituents.html#ac0d794c0c89d7f87e444fc10e4ca76b6" title=" " alt="" coords="232,1687,399,1728"/>
<area shape="rect" href="classMamConstituents.html#abd92c92743d51efe2f17e68cbfaccee1" title=" " alt="" coords="232,1752,399,1794"/>
<area shape="rect" href="classMamConstituents.html#a5de90eaa3b6d493a7b12ce7df766fa6f" title=" " alt="" coords="232,1818,399,1859"/>
<area shape="rect" href="classMam4__aer.html#a9721da0af2c6b65da92a81c76f3bf43d" title=" " alt="" coords="216,1302,415,1329"/>
<area shape="rect" href="Modal__aero__wateruptake_8H.html#a732deb0c6f95544c2c323749f227bbd6" title=" " alt="" coords="795,1033,834,1060"/>
<area shape="rect" href="classWaterVaporSat.html#a4dac5d0ff52b333add64a13539fca1c8" title=" " alt="" coords="238,865,393,892"/>
<area shape="rect" href="Modal__aero__wateruptake_8H.html#a352bc71b7a47b331f4f6b71b09e0401d" title=" " alt="" coords="296,1884,335,1910"/>
<area shape="rect" href="classPhysProp.html#a6d68ef1925d5f6b671c9f19012e03ee0" title=" " alt="" coords="485,1485,647,1512"/>
<area shape="rect" href="classPhysProp.html#a6e676bbfdadc5ca4317c868826168bf7" title=" " alt="" coords="463,1536,669,1562"/>
<area shape="rect" href="classPhysProp.html#ac78ce456f60120096570085d96025467" title=" " alt="" coords="497,1586,635,1613"/>
<area shape="rect" href="classPhysProp.html#a2e6aa40659bebbb92eff36707e84dbeb" title=" " alt="" coords="473,1637,659,1664"/>
<area shape="rect" href="classPhysProp.html#a4229d0c1f2685db59d5a233c51b86913" title=" " alt="" coords="479,1694,653,1721"/>
<area shape="rect" href="classMam4__aer.html#a1488790796a5a153be55af7d9a64d36a" title=" " alt="" coords="964,1109,1109,1136"/>
<area shape="rect" href="Modal__aero__wateruptake_8H.html#ae5d285c0e71657c006da1c31ac41c548" title=" " alt="" coords="535,1302,597,1329"/>
<area shape="rect" href="classMamConstituents.html#af03978750c5679f6f44de935e49b7ef7" title=" " alt="" coords="483,1419,649,1460"/>
<area shape="rect" href="classMamConstituents.html#a2d427b9d796e14b4e713b58829034f56" title=" " alt="" coords="483,1186,649,1227"/>
<area shape="rect" href="classMamConstituents.html#a12e3884e2ae28840165e4aa8408add45" title=" " alt="" coords="483,1354,649,1395"/>
<area shape="rect" href="Modal__aero__wateruptake_8H.html#a3cd6f9e15171bc4f84f7293abef597cb" title=" " alt="" coords="533,1252,599,1278"/>
<area shape="rect" href="Modal__aero__wateruptake_8H.html#a9aa3077c8aba28c76a55a49b5ce9d5ec" title=" " alt="" coords="1408,510,1447,537"/>
<area shape="rect" href="classPhysProp.html#ab2337242b083bd5f434cb32720aff5a8" title=" " alt="" coords="717,1450,912,1477"/>
<area shape="rect" href="classPhysProp.html#a0d29d8a473f08acf3a9083b54942b27b" title=" " alt="" coords="735,1502,895,1543"/>
<area shape="rect" href="classPhysProp.html#aa435d3d01ec01519c8c6e4959fa58fcf" title=" " alt="" coords="731,1567,899,1608"/>
<area shape="rect" href="classPhysProp.html#ace87b45eead8d9fd6a17eec2c3456a98" title=" " alt="" coords="727,1248,902,1274"/>
<area shape="rect" href="Modal__aero__wateruptake_8H.html#a11260de6947324f76f836f37f6ec7eb6" title=" " alt="" coords="997,1222,1076,1249"/>
<area shape="rect" href="classPhysProp.html#a81485201c08d1e2b8013f0bb88f44af7" title=" " alt="" coords="721,1349,908,1376"/>
<area shape="rect" href="Modal__aero__wateruptake_8H.html#a4500ffa7f6c54c672531b679f4903f25" title=" " alt="" coords="991,1324,1082,1350"/>
<area shape="rect" href="classPhysProp.html#a5872e2bb36e4c750385b349738f11e1c" title=" " alt="" coords="731,1400,898,1426"/>
<area shape="rect" href="classWaterVaporSat.html#a071cc1a28405ce131d1c1bcb216d471a" title=" " alt="" coords="961,916,1113,958"/>
<area shape="rect" href="classWaterVaporSat.html#a9d72a29e54869f42ec419639d6c3d70f" title=" " alt="" coords="487,967,645,1008"/>
<area shape="rect" href="classWaterVaporSat.html#a65b6cc3dc802016e84bc19030f6ad65a" title=" " alt="" coords="491,415,641,456"/>
<area shape="rect" href="classWaterVaporSat.html#afae0dfb4f85c8ac528ff330ccfa182b2" title=" " alt="" coords="465,764,667,790"/>
<area shape="rect" href="classSatMethods.html#a25e9dd28dcfcfd4e060472815e8389fa" title=" " alt="" coords="960,674,1113,715"/>
<area shape="rect" href="classWaterVaporSat.html#ad2bce1bf12d7f01fd354c36e17bfe635" title=" " alt="" coords="1180,866,1341,907"/>
<area shape="rect" href="classSatMethods.html#ac2fa5e55257c6021e9e7fd897f4950b7" title=" " alt="" coords="738,415,891,456"/>
<area shape="rect" href="classSatMethods.html#add2fde8076c60c19ed9f4f78c9891e0e" title=" " alt="" coords="960,262,1113,303"/>
<area shape="rect" href="classSatMethods.html#a1c4bb9729c75dd1160d45ae638635766" title=" " alt="" coords="960,444,1113,486"/>
<area shape="rect" href="classSatMethods.html#a128ccad46f784c2d1aaeda372833dab6" title=" " alt="" coords="1186,327,1335,368"/>
<area shape="rect" href="classSatMethods.html#a9e929b8ac05dbeaa78dc158159f84758" title=" " alt="" coords="1172,196,1349,238"/>
<area shape="rect" href="classSatMethods.html#a87786f42b9d0601dc1d22f635906a76f" title=" " alt="" coords="1167,262,1355,303"/>
<area shape="rect" href="classSatMethods.html#a185a448ec1db160bc61f23cbda63f4bd" title=" " alt="" coords="1161,79,1360,120"/>
<area shape="rect" href="classSatMethods.html#a264a283910d028a29c374900fc03017f" title=" " alt="" coords="1172,562,1349,603"/>
<area shape="rect" href="classSatMethods.html#aac1daa9a38464e217df80a4f9613bcb3" title=" " alt="" coords="1167,627,1355,668"/>
<area shape="rect" href="classSatMethods.html#a8458bd6a233082c463c070ddc692080f" title=" " alt="" coords="1161,444,1360,486"/>
<area shape="rect" href="Modal__aero__wateruptake_8H.html#ae7815a546266ee09cee1f18ee2a27d97" title=" " alt="" coords="795,713,834,740"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classAerRadProps_a6aabfa89e9a9d91bae79c7a0d91f17b3_icgraph.png" border="0" usemap="#aclassAerRadProps_a6aabfa89e9a9d91bae79c7a0d91f17b3_icgraph" alt=""/></div>
<map name="aclassAerRadProps_a6aabfa89e9a9d91bae79c7a0d91f17b3_icgraph" id="aclassAerRadProps_a6aabfa89e9a9d91bae79c7a0d91f17b3_icgraph">
<area shape="rect" title=" " alt="" coords="200,5,363,47"/>
<area shape="rect" href="classOptics.html#aecf608be7db530dc74beb0a03b2279f2" title=" " alt="" coords="5,5,152,47"/>
</map>
</div>

</div>
</div>
<a id="a433097bd85637100b16f3e120e9d6fa1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a433097bd85637100b16f3e120e9d6fa1">&#9670;&nbsp;</a></span>aer_rad_props_sw()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AerRadProps::aer_rad_props_sw </td>
          <td>(</td>
          <td class="paramtype">const int &amp;&#160;</td>
          <td class="paramname"><em>list_idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real &amp;&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int &amp;&#160;</td>
          <td class="paramname"><em>nnite</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int1d &amp;&#160;</td>
          <td class="paramname"><em>idxnite</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>is_cmip6_volc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>tau_w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>tau_w_g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>tau_w_f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>clear_rh</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;                                                                                                          {</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="comment">// radiative properties for each aerosol</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    real3d ta(<span class="stringliteral">&quot;ta&quot;</span>, <a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>, <a class="code" href="classAerRadProps.html#aded12109795a3f22556faecdd3fb3d03">nswbands</a>);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    real3d tw(<span class="stringliteral">&quot;tw&quot;</span>, <a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>, <a class="code" href="classAerRadProps.html#aded12109795a3f22556faecdd3fb3d03">nswbands</a>);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    real3d twf(<span class="stringliteral">&quot;twf&quot;</span>, <a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>, <a class="code" href="classAerRadProps.html#aded12109795a3f22556faecdd3fb3d03">nswbands</a>);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    real3d twg(<span class="stringliteral">&quot;twg&quot;</span>, <a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>, <a class="code" href="classAerRadProps.html#aded12109795a3f22556faecdd3fb3d03">nswbands</a>);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="comment">// aerosol masses</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    real2d aermmr(<span class="stringliteral">&quot;aermmr&quot;</span>, <a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>);    <span class="comment">// mass mixing ratio of aerosols</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    real2d mmr_to_mass(<span class="stringliteral">&quot;mmr_to_mass&quot;</span>, <a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>); <span class="comment">// conversion factor for mmr to mass</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    real2d aermass(<span class="stringliteral">&quot;aermass&quot;</span>, <a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>);     <span class="comment">// mass of aerosols</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="comment">// for table lookup into rh grid</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    real2d <a class="code" href="Modal__aero__wateruptake_8H.html#a8a0c0dddc4a8389a14e6906b55d7cacf">es</a>(<span class="stringliteral">&quot;es&quot;</span>, <a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>);     <span class="comment">// saturation vapor pressure</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    real2d <a class="code" href="Modal__aero__wateruptake_8H.html#a732deb0c6f95544c2c323749f227bbd6">qs</a>(<span class="stringliteral">&quot;qs&quot;</span>, <a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>);     <span class="comment">// saturation specific humidity</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    real2d <a class="code" href="Modal__aero__wateruptake_8H.html#a352bc71b7a47b331f4f6b71b09e0401d">rh</a>(<span class="stringliteral">&quot;rh&quot;</span>, <a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    real2d rhtrunc(<span class="stringliteral">&quot;rhtrunc&quot;</span>, <a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    real2d wrh(<span class="stringliteral">&quot;wrh&quot;</span>, <a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    int2d krh(<span class="stringliteral">&quot;krh&quot;</span>, <a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keywordtype">int</span> numaerosols;     <span class="comment">// number of bulk aerosols in climate/diagnostic list</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classAerRadProps.html#a3bd718612795e1c875ad70da941cc89a">nmodes</a>;          <span class="comment">// number of aerosol modes in climate/diagnostic list</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordtype">int</span> iaerosol;        <span class="comment">// index into bulk aerosol list</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    std::string opticstype;       <span class="comment">// hygro or nonhygro</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="comment">// for cmip6 style volcanic file</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    int1d trop_level(<span class="stringliteral">&quot;trop_level&quot;</span>, <a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    real3d ext_cmip6_sw_inv_m(<span class="stringliteral">&quot;ext_cmip6_sw_inv_m&quot;</span>, <a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>, <a class="code" href="classAerRadProps.html#aded12109795a3f22556faecdd3fb3d03">nswbands</a>); <span class="comment">// short wave extinction in the units of 1/m</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="comment">// compute mixing ratio to mass conversion</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    parallel_for(SimpleBounds&lt;2&gt;(<a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>) , YAKL_LAMBDA (<span class="keywordtype">int</span> icol, <span class="keywordtype">int</span> ilev)</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        mmr_to_mass(icol,ilev) = <a class="code" href="ERF__Constants_8H.html#a562f6dc5abcd5944a1d3cd8f22146d31">rgas</a> * <a class="code" href="classAerRadProps.html#a1bf28a8f87d617095d3cf88cf7ef738e">pdeldry</a>(icol,ilev);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    });</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="comment">// initialize to conditions that would cause failure</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    yakl::memset(tau, -100.);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    yakl::memset(tau_w, -100.);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    yakl::memset(tau_w_g, -100.);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    yakl::memset(tau_w_f, -100.);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">// top layer (ilev = 0) has no aerosol (ie tau = 0)</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="comment">// also initialize rest of layers to accumulate od&#39;s</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    parallel_for(SimpleBounds&lt;2&gt;(<a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#aded12109795a3f22556faecdd3fb3d03">nswbands</a>) , YAKL_LAMBDA (<span class="keywordtype">int</span> icol, <span class="keywordtype">int</span> isw)</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        tau    (icol,1,isw) = 0.;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        tau_w  (icol,1,isw) = 0.;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        tau_w_g(icol,1,isw) = 0.;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        tau_w_f(icol,1,isw) = 0.;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    });</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="comment">// calculate relative humidity for table lookup into rh grid</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    parallel_for(SimpleBounds&lt;2&gt;(<a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>), YAKL_LAMBDA (<span class="keywordtype">int</span> icol, <span class="keywordtype">int</span> ilev)</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <a class="code" href="classWaterVaporSat.html#a4dac5d0ff52b333add64a13539fca1c8">WaterVaporSat::qsat</a>(<a class="code" href="classAerRadProps.html#a0a03391413de1fcd9ea2550fea907b33">temp</a>(icol,ilev), <a class="code" href="classAerRadProps.html#ab56e110ccf8deaa71d452a64e69b8647">pmid</a>(icol,ilev), <a class="code" href="Modal__aero__wateruptake_8H.html#a8a0c0dddc4a8389a14e6906b55d7cacf">es</a>(icol,ilev), <a class="code" href="Modal__aero__wateruptake_8H.html#a732deb0c6f95544c2c323749f227bbd6">qs</a>(icol,ilev));</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <a class="code" href="Modal__aero__wateruptake_8H.html#a352bc71b7a47b331f4f6b71b09e0401d">rh</a>(icol, ilev) = <a class="code" href="classAerRadProps.html#a837035712a214f1b8daf7a4d30727e6d">qt</a>(icol,ilev) / <a class="code" href="Modal__aero__wateruptake_8H.html#a732deb0c6f95544c2c323749f227bbd6">qs</a>(icol,ilev);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        rhtrunc(icol,ilev) = std::min(<a class="code" href="Modal__aero__wateruptake_8H.html#a352bc71b7a47b331f4f6b71b09e0401d">rh</a>(icol,ilev),1.);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        krh(icol, ilev) = std::min(std::floor(rhtrunc(icol, ilev)*<a class="code" href="classAerRadProps.html#aa21297bb80600126531f2d324f6d9c2f">nrh</a> )+1, <a class="code" href="classAerRadProps.html#aa21297bb80600126531f2d324f6d9c2f">nrh</a> - 1.); <span class="comment">// index into rh mesh</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        wrh(icol, ilev) = rhtrunc(icol,ilev)*<a class="code" href="classAerRadProps.html#aa21297bb80600126531f2d324f6d9c2f">nrh</a> - krh(icol, ilev);       <span class="comment">// (-) weighting on left side values</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    });</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="comment">// Special treatment for CMIP6 volcanic aerosols, where extinction, ssa</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="comment">// and af are directly read from the prescribed volcanic aerosol file</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="comment">// Point ext_cmip6_sw to null so that the code breaks if they are used for is_cmip6_volc=.false. case</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="comment">// This is done to avoid having optional arguments in modal_aero_sw call</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    yakl::memset(trop_level, 10000000);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="comment">// I was thinking whether we have to include volcanic effects on radiation?</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordflow">if</span> (is_cmip6_volc) {</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <span class="comment">// get extinction so as to supply to modal_aero_sw routine for computing EXTINCT variable</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <span class="comment">// converting it from 1/km to 1/m</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <span class="comment">//      call pbuf_get_field(pbuf, idx_ext_sw, ext_cmip6_sw)</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="comment">//      call outfld(&#39;extinct_sw_inp&#39;,ext_cmip6_sw(:,:,idx_sw_diag), pcols, lchnk)</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        parallel_for(SimpleBounds&lt;3&gt;(<a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>, <a class="code" href="classAerRadProps.html#aded12109795a3f22556faecdd3fb3d03">nswbands</a>), YAKL_LAMBDA (<span class="keywordtype">int</span> icol, <span class="keywordtype">int</span> ilev, <span class="keywordtype">int</span> isw)</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            ext_cmip6_sw_inv_m(icol, ilev, isw) = 1.0e-3*<a class="code" href="classAerRadProps.html#acf87aa0fdbfa3b73924a1f7c56088e55">ext_cmip6_sw</a>(icol, ilev, isw); <span class="comment">//convert from 1/km to 1/m</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        });</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <span class="comment">//Find tropopause as extinction should be applied only above tropopause</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <span class="comment">//trop_level has value for tropopause for each column</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="comment">//tropopause_find(state, trop_level)</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <span class="comment">// Iterate over all of the columns to find the troppause</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        real1d strop(<span class="stringliteral">&quot;strop&quot;</span>,1);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        parallel_for(SimpleBounds&lt;1&gt;(<a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>), YAKL_LAMBDA (<span class="keywordtype">int</span> i)</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            <span class="comment">// Search from the bottom up, looking for the first minimum.</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            <span class="keywordtype">int</span> tlev  = -1;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">auto</span> k = <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>-1; k &gt; 0; --k) {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                real stobie = 0.03 * <a class="code" href="classAerRadProps.html#a0a03391413de1fcd9ea2550fea907b33">temp</a>(i,k) - std::log10(<a class="code" href="classAerRadProps.html#ab56e110ccf8deaa71d452a64e69b8647">pmid</a>(i, k));</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classAerRadProps.html#ab56e110ccf8deaa71d452a64e69b8647">pmid</a>(i, k) &lt;= 4000.) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classAerRadProps.html#ab56e110ccf8deaa71d452a64e69b8647">pmid</a>(i, k) &gt;= 55000.) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                <span class="keywordflow">if</span> ((tlev == -1) || (stobie &lt; strop(1))) {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                    tlev  = k;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                    strop(1) = stobie;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                }</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            <span class="keywordflow">if</span> (tlev != -1) trop_level(i) = tlev;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        });</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="comment">//Quit if tropopause is not found</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="keywordflow">if</span> (yakl::intrinsics::any(trop_level) == -1) {</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            amrex::Print() &lt;&lt; <span class="stringliteral">&quot;aer_rad_props.F90: subr aer_rad_props_sw: tropopause not found\n&quot;</span>;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        }</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    }</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="comment">// get number of bulk aerosols and number of modes in current list</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <a class="code" href="classAerRadProps.html#a66f750181cccc82c03268b0a4a245ecc">mam_consti</a>.<a class="code" href="classMamConstituents.html#a5de90eaa3b6d493a7b12ce7df766fa6f">get_nmodes</a>(<a class="code" href="Modal__aero__wateruptake_8H.html#ac871f47ba48bc0761657c3be0f86bad2">list_idx</a>, <a class="code" href="classAerRadProps.html#a3bd718612795e1c875ad70da941cc89a">nmodes</a>);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <a class="code" href="classAerRadProps.html#a66f750181cccc82c03268b0a4a245ecc">mam_consti</a>.<a class="code" href="classMamConstituents.html#a80c22c3ae9035880d179adca47c29b60">get_ngas</a>(<a class="code" href="Modal__aero__wateruptake_8H.html#ac871f47ba48bc0761657c3be0f86bad2">list_idx</a>, <a class="code" href="classAerRadProps.html#ae41f31dfce03d5b3952114e12436bec9">ngas</a>);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <a class="code" href="classAerRadProps.html#a66f750181cccc82c03268b0a4a245ecc">mam_consti</a>.<a class="code" href="classMamConstituents.html#abd92c92743d51efe2f17e68cbfaccee1">get_naero</a>(<a class="code" href="Modal__aero__wateruptake_8H.html#ac871f47ba48bc0761657c3be0f86bad2">list_idx</a>, numaerosols);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="comment">// Contributions from modal aerosols.</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classAerRadProps.html#a3bd718612795e1c875ad70da941cc89a">nmodes</a> &gt; 0) {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        real2d ext_cmip6_sw_2d(<span class="stringliteral">&quot;ext_cmip6_sw&quot;</span>,<a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>,<a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        parallel_for(SimpleBounds&lt;3&gt;(<a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>, <a class="code" href="classAerRadProps.html#aded12109795a3f22556faecdd3fb3d03">nswbands</a>), YAKL_LAMBDA (<span class="keywordtype">int</span> icol, <span class="keywordtype">int</span> ilev, <span class="keywordtype">int</span> isw)</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        {</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            ext_cmip6_sw_2d(icol,ilev) = ext_cmip6_sw_inv_m(icol,ilev,<a class="code" href="classRadConstants.html#aa8d069e0dd3bcec898e914167c02f4ee">RadConstants::idx_sw_diag</a>);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        });</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <a class="code" href="classAerRadProps.html#afb607ae14bfc3e46dd66c9e04627a57d">mam_aer</a>.<a class="code" href="classMam4__aer.html#ad7ec661c28332eed1cbb43fa82c8fb92">modal_aero_sw</a>(<a class="code" href="Modal__aero__wateruptake_8H.html#ac871f47ba48bc0761657c3be0f86bad2">list_idx</a>, dt, nnite, idxnite, is_cmip6_volc, ext_cmip6_sw_2d,</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                              trop_level, tau, tau_w, tau_w_g, tau_w_f, clear_rh);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        yakl::memset(tau, 0.);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        yakl::memset(tau_w, 0.);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        yakl::memset(tau_w_g, 0.);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        yakl::memset(tau_w_f, 0.);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    }</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160; </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">if</span> (is_cmip6_volc) {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <span class="comment">//update tau, tau_w, tau_w_g, and tau_w_f with the read in values of extinction, ssa and asymmetry factors</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <a class="code" href="classAerRadProps.html#aa4241f4adcf62ef3c537a91bdfce66db">volcanic_cmip_sw</a> (trop_level, <a class="code" href="classAerRadProps.html#ac82b4bf91bb3a23e33074e00381388e3">zi</a>, ext_cmip6_sw_inv_m, <a class="code" href="classAerRadProps.html#a0690511bbea6225a4afa365c4c153f0c">ssa_cmip6_sw</a>, <a class="code" href="classAerRadProps.html#afd083b451cf913a409380fb0b95de4c0">af_cmip6_sw</a>,</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                          tau, tau_w, tau_w_g, tau_w_f);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    }</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="comment">// Contributions from bulk aerosols.</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> iaerosol = 0; iaerosol &lt; numaerosols; ++iaerosol) {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="comment">// get bulk aerosol mass mixing ratio</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <span class="comment">//      mam_consti.rad_cnst_get_aer_mmr(list_idx, iaerosol, aermmr);</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        parallel_for(SimpleBounds&lt;2&gt;(<a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>), YAKL_LAMBDA (<span class="keywordtype">int</span> icol, <span class="keywordtype">int</span> ilev)</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        {</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            <span class="keywordflow">if</span> (ilev &lt; <a class="code" href="classAerRadProps.html#a83216edbd2d57b575f1869df38a1b668">top_lev</a>) {</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                aermass(icol,ilev) = 0.;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                aermass(icol,ilev) = aermmr(icol,ilev) * mmr_to_mass(icol,ilev);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            }</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        });</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="comment">// get optics type</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <a class="code" href="classAerRadProps.html#a66f750181cccc82c03268b0a4a245ecc">mam_consti</a>.<a class="code" href="classMamConstituents.html#a278b01dd1df95acd2ad6a5c800caf719">get_aer_opticstype</a>(<a class="code" href="Modal__aero__wateruptake_8H.html#ac871f47ba48bc0761657c3be0f86bad2">list_idx</a>, iaerosol, opticstype);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <span class="keywordflow">if</span> (opticstype == <span class="stringliteral">&quot;hygro&quot;</span>) {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            <span class="comment">// get optical properties for hygroscopic aerosols</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            <span class="comment">// optical props for each aerosol hygroscopic</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            real2d h_ext(<span class="stringliteral">&quot;h_ext&quot;</span>, <a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            real2d h_ssa(<span class="stringliteral">&quot;h_ssa&quot;</span>, <a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;            real2d h_asm(<span class="stringliteral">&quot;h_asm&quot;</span>, <a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            <a class="code" href="classAerRadProps.html#a66f750181cccc82c03268b0a4a245ecc">mam_consti</a>.<a class="code" href="classMamConstituents.html#aa8e7a68a039ef90b126879c91ac33086">get_aer_sw_hygro_ext</a>(<a class="code" href="Modal__aero__wateruptake_8H.html#ac871f47ba48bc0761657c3be0f86bad2">list_idx</a>, iaerosol, h_ext);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            <a class="code" href="classAerRadProps.html#a66f750181cccc82c03268b0a4a245ecc">mam_consti</a>.<a class="code" href="classMamConstituents.html#a97b9fbaf5e3efd669c510507e3a4095c">get_aer_sw_hygro_ssa</a>(<a class="code" href="Modal__aero__wateruptake_8H.html#ac871f47ba48bc0761657c3be0f86bad2">list_idx</a>, iaerosol, h_ssa);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            <a class="code" href="classAerRadProps.html#a66f750181cccc82c03268b0a4a245ecc">mam_consti</a>.<a class="code" href="classMamConstituents.html#a1e2eb8427b5f69fe79ffdbff599489da">get_aer_sw_hygro_asm</a>(<a class="code" href="Modal__aero__wateruptake_8H.html#ac871f47ba48bc0761657c3be0f86bad2">list_idx</a>, iaerosol, h_asm);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            <a class="code" href="classAerRadProps.html#a6a1e71160911bbc52d09bdbd73acb219">get_hygro_rad_props</a>(<a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, krh, wrh, aermass, h_ext, h_ssa, h_asm, ta, tw, twg, twf);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            parallel_for(SimpleBounds&lt;3&gt;(<a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>, <a class="code" href="classAerRadProps.html#aded12109795a3f22556faecdd3fb3d03">nswbands</a>), YAKL_LAMBDA (<span class="keywordtype">int</span> icol, <span class="keywordtype">int</span> ilev, <span class="keywordtype">int</span> isw)</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                tau    (icol,ilev,isw) = tau    (icol,ilev,isw) + ta (icol,ilev,isw);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                tau_w  (icol,ilev,isw) = tau_w  (icol,ilev,isw) + tw (icol,ilev,isw);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                tau_w_g(icol,ilev,isw) = tau_w_g(icol,ilev,isw) + twg(icol,ilev,isw);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                tau_w_f(icol,ilev,isw) = tau_w_f(icol,ilev,isw) + twf(icol,ilev,isw);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            });</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (opticstype == <span class="stringliteral">&quot;nonhygro&quot;</span>) {</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            <span class="comment">// get optical properties for non-hygroscopic aerosols</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            <span class="comment">// non-hygroscopic</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            real1d n_ext(<span class="stringliteral">&quot;n_ext&quot;</span>, <a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            real1d n_ssa(<span class="stringliteral">&quot;n_ssa&quot;</span>, <a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            real1d n_asm(<span class="stringliteral">&quot;n_asm&quot;</span>, <a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            <a class="code" href="classAerRadProps.html#a66f750181cccc82c03268b0a4a245ecc">mam_consti</a>.<a class="code" href="classMamConstituents.html#aa0f1152f17813847ba8f464828079065">get_aer_sw_nonhygro_ext</a>(<a class="code" href="Modal__aero__wateruptake_8H.html#ac871f47ba48bc0761657c3be0f86bad2">list_idx</a>, iaerosol, n_ext);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            <a class="code" href="classAerRadProps.html#a66f750181cccc82c03268b0a4a245ecc">mam_consti</a>.<a class="code" href="classMamConstituents.html#a8d1e4789f9cd4438776ba0838c59f663">get_aer_sw_nonhygro_ssa</a>(<a class="code" href="Modal__aero__wateruptake_8H.html#ac871f47ba48bc0761657c3be0f86bad2">list_idx</a>, iaerosol, n_ssa);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            <a class="code" href="classAerRadProps.html#a66f750181cccc82c03268b0a4a245ecc">mam_consti</a>.<a class="code" href="classMamConstituents.html#a55dbbc44079a3d80b501dabb766c70f6">get_aer_sw_nonhygro_asm</a>(<a class="code" href="Modal__aero__wateruptake_8H.html#ac871f47ba48bc0761657c3be0f86bad2">list_idx</a>, iaerosol, n_asm);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            <a class="code" href="classAerRadProps.html#af6e6827c17d2247b72337a35875ea0e0">get_nonhygro_rad_props</a>(<a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, aermass, n_ext, n_ssa, n_asm, ta, tw, twg, twf);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            parallel_for(SimpleBounds&lt;3&gt;(<a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>, <a class="code" href="classAerRadProps.html#aded12109795a3f22556faecdd3fb3d03">nswbands</a>), YAKL_LAMBDA (<span class="keywordtype">int</span> icol, <span class="keywordtype">int</span> ilev, <span class="keywordtype">int</span> isw)</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            {</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                tau    (icol,ilev,isw) = tau    (icol,ilev,isw) + ta (icol,ilev,isw);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                tau_w  (icol,ilev,isw) = tau_w  (icol,ilev,isw) + tw (icol,ilev,isw);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                tau_w_g(icol,ilev,isw) = tau_w_g(icol,ilev,isw) + twg(icol,ilev,isw);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                tau_w_f(icol,ilev,isw) = tau_w_f(icol,ilev,isw) + twf(icol,ilev,isw);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            });</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (opticstype == <span class="stringliteral">&quot;volcanic&quot;</span>) {</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            <span class="comment">// get optical properties for volcanic aerosols</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            real1d n_ext(<span class="stringliteral">&quot;n_ext&quot;</span>, <a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            real1d n_scat(<span class="stringliteral">&quot;n_scat&quot;</span>, <a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            real1d n_ascat(<span class="stringliteral">&quot;n_ascat&quot;</span>, <a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            <a class="code" href="classAerRadProps.html#a66f750181cccc82c03268b0a4a245ecc">mam_consti</a>.<a class="code" href="classMamConstituents.html#aa0f1152f17813847ba8f464828079065">get_aer_sw_nonhygro_ext</a>(<a class="code" href="Modal__aero__wateruptake_8H.html#ac871f47ba48bc0761657c3be0f86bad2">list_idx</a>, iaerosol, n_ext);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            <a class="code" href="classAerRadProps.html#a66f750181cccc82c03268b0a4a245ecc">mam_consti</a>.<a class="code" href="classMamConstituents.html#af3443a17ef46a08705917692bd92bfae">get_aer_sw_nonhygro_scat</a>(<a class="code" href="Modal__aero__wateruptake_8H.html#ac871f47ba48bc0761657c3be0f86bad2">list_idx</a>, iaerosol, n_scat);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            <a class="code" href="classAerRadProps.html#a66f750181cccc82c03268b0a4a245ecc">mam_consti</a>.<a class="code" href="classMamConstituents.html#ad7a049202ae9582047df1a88d0f973ae">get_aer_sw_nonhygro_ascat</a>(<a class="code" href="Modal__aero__wateruptake_8H.html#ac871f47ba48bc0761657c3be0f86bad2">list_idx</a>, iaerosol, n_ascat);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            <a class="code" href="classAerRadProps.html#a74842fff81711719376fc035b86dc1a7">get_volcanic_rad_props</a>(<a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, aermass, n_ext, n_scat, n_ascat, ta, tw, twg, twf);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            parallel_for(SimpleBounds&lt;3&gt;(<a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>, <a class="code" href="classAerRadProps.html#aded12109795a3f22556faecdd3fb3d03">nswbands</a>), YAKL_LAMBDA (<span class="keywordtype">int</span> icol, <span class="keywordtype">int</span> ilev, <span class="keywordtype">int</span> isw)</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            {</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                tau    (icol,ilev,isw) = tau    (icol,ilev,isw) + ta (icol,ilev,isw);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                tau_w  (icol,ilev,isw) = tau_w  (icol,ilev,isw) + tw (icol,ilev,isw);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                tau_w_g(icol,ilev,isw) = tau_w_g(icol,ilev,isw) + twg(icol,ilev,isw);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                tau_w_f(icol,ilev,isw) = tau_w_f(icol,ilev,isw) + twf(icol,ilev,isw);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            });</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (opticstype == <span class="stringliteral">&quot;volcanic_radius&quot;</span>) {</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            <span class="comment">// get optical properties for volcanic aerosols</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            real2d r_ext(<span class="stringliteral">&quot;r_ext&quot;</span>,<a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>,<a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            real2d r_scat(<span class="stringliteral">&quot;r_scat&quot;</span>,<a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>,<a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            real2d r_ascat(<span class="stringliteral">&quot;r_ascat&quot;</span>,<a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>,<a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            real1d r_mu(<span class="stringliteral">&quot;r_mu&quot;</span>, <a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            <a class="code" href="classAerRadProps.html#a66f750181cccc82c03268b0a4a245ecc">mam_consti</a>.<a class="code" href="classMamConstituents.html#aa1f6958b2ddfaf33e1561b53e3e026c3">get_aer_r_sw_ext</a>(<a class="code" href="Modal__aero__wateruptake_8H.html#ac871f47ba48bc0761657c3be0f86bad2">list_idx</a>, iaerosol, r_ext);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            <a class="code" href="classAerRadProps.html#a66f750181cccc82c03268b0a4a245ecc">mam_consti</a>.<a class="code" href="classMamConstituents.html#ad7e9e541dea92292a381c1d645faef1b">get_aer_r_sw_scat</a>(<a class="code" href="Modal__aero__wateruptake_8H.html#ac871f47ba48bc0761657c3be0f86bad2">list_idx</a>, iaerosol, r_scat);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            <a class="code" href="classAerRadProps.html#a66f750181cccc82c03268b0a4a245ecc">mam_consti</a>.<a class="code" href="classMamConstituents.html#a6c4d7f8d8edc0d35828faf619d474c2b">get_aer_r_sw_ascat</a>(<a class="code" href="Modal__aero__wateruptake_8H.html#ac871f47ba48bc0761657c3be0f86bad2">list_idx</a>, iaerosol, r_ascat);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            <a class="code" href="classAerRadProps.html#a66f750181cccc82c03268b0a4a245ecc">mam_consti</a>.<a class="code" href="classMamConstituents.html#aa268eea91939bf42c29685aa43138d15">get_aer_mu</a>(<a class="code" href="Modal__aero__wateruptake_8H.html#ac871f47ba48bc0761657c3be0f86bad2">list_idx</a>, iaerosol, r_mu);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;            <a class="code" href="classAerRadProps.html#a55507a56c5808f7480e42f4369cbf5a7">get_volcanic_radius_rad_props</a>(<a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, aermass, r_ext, r_scat, r_ascat, r_mu, ta, tw, twg, twf);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            <span class="comment">//get_volcanic_radius_rad_props(const real2d&amp; mass,</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            <span class="comment">//                                        const real2d&amp; r_ext,</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            <span class="comment">//                                       const real2d&amp; r_scat,</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            <span class="comment">//                                      const real2d&amp; r_ascat,</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            <span class="comment">//                                      const real1d&amp; r_mu,</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            <span class="comment">//                                      real3d&amp; tau,</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            <span class="comment">//                                      real3d&amp; tau_w,</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            <span class="comment">//                                      real3d&amp; tau_w_g,</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            <span class="comment">//                                      real3d&amp; tau_w_f)</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            parallel_for(SimpleBounds&lt;3&gt;(<a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>, <a class="code" href="classAerRadProps.html#aded12109795a3f22556faecdd3fb3d03">nswbands</a>), YAKL_LAMBDA (<span class="keywordtype">int</span> icol, <span class="keywordtype">int</span> ilev, <span class="keywordtype">int</span> isw)</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            {</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                tau    (icol,ilev,isw) = tau    (icol,ilev,isw) + ta (icol,ilev,isw);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                tau_w  (icol,ilev,isw) = tau_w  (icol,ilev,isw) + tw (icol,ilev,isw);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                tau_w_g(icol,ilev,isw) = tau_w_g(icol,ilev,isw) + twg(icol,ilev,isw);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                tau_w_f(icol,ilev,isw) = tau_w_f(icol,ilev,isw) + twf(icol,ilev,isw);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            });</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            amrex::Print() &lt;&lt; <span class="stringliteral">&quot;aer_rad_props_sw: unsupported opticstype\n&quot;</span>;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <span class="comment">// diagnostic output of individual aerosol optical properties</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <span class="comment">// currently implemented for climate list only</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        <span class="comment">//      call aer_vis_diag_out(lchnk, ncol, nnite, idxnite, iaerosol, ta(:,:,idx_sw_diag), list_idx)</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    }</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="comment">// diagnostic output of total aerosol optical properties</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="comment">// currently implemented for climate list only</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="comment">//   call aer_vis_diag_out(lchnk, ncol, nnite, idxnite, 0, tau(:,:,idx_sw_diag), list_idx)</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;}</div>
<div class="ttc" id="aclassAerRadProps_html_a0690511bbea6225a4afa365c4c153f0c"><div class="ttname"><a href="classAerRadProps.html#a0690511bbea6225a4afa365c4c153f0c">AerRadProps::ssa_cmip6_sw</a></div><div class="ttdeci">real3d ssa_cmip6_sw</div><div class="ttdef"><b>Definition:</b> Aero_rad_props.H:132</div></div>
<div class="ttc" id="aclassAerRadProps_html_a55507a56c5808f7480e42f4369cbf5a7"><div class="ttname"><a href="classAerRadProps.html#a55507a56c5808f7480e42f4369cbf5a7">AerRadProps::get_volcanic_radius_rad_props</a></div><div class="ttdeci">void get_volcanic_radius_rad_props(const int &amp;ncol, const real2d &amp;mass, const real2d &amp;r_ext, const real2d &amp;r_scat, const real2d &amp;r_ascat, const real1d &amp;r_mu, const real3d &amp;tau, const real3d &amp;tau_w, const real3d &amp;tau_w_g, const real3d &amp;tau_w_f)</div><div class="ttdef"><b>Definition:</b> Aero_rad_props.cpp:550</div></div>
<div class="ttc" id="aclassAerRadProps_html_a6a1e71160911bbc52d09bdbd73acb219"><div class="ttname"><a href="classAerRadProps.html#a6a1e71160911bbc52d09bdbd73acb219">AerRadProps::get_hygro_rad_props</a></div><div class="ttdeci">void get_hygro_rad_props(const int &amp;ncol, const int2d &amp;krh, const real2d &amp;wrh, const real2d &amp;mass, const real2d &amp;ext, const real2d &amp;ssa, const real2d &amp;assm, const real3d &amp;tau, const real3d &amp;tau_w, const real3d &amp;tau_w_g, const real3d &amp;tau_w_f)</div><div class="ttdef"><b>Definition:</b> Aero_rad_props.cpp:503</div></div>
<div class="ttc" id="aclassAerRadProps_html_a74842fff81711719376fc035b86dc1a7"><div class="ttname"><a href="classAerRadProps.html#a74842fff81711719376fc035b86dc1a7">AerRadProps::get_volcanic_rad_props</a></div><div class="ttdeci">void get_volcanic_rad_props(const int &amp;ncol, const real2d &amp;mass, const real1d &amp;ext, const real1d &amp;scat, const real1d &amp;ascat, const real3d &amp;tau, const real3d &amp;tau_w, const real3d &amp;tau_w_g, const real3d &amp;tau_w_f)</div><div class="ttdef"><b>Definition:</b> Aero_rad_props.cpp:672</div></div>
<div class="ttc" id="aclassAerRadProps_html_aa4241f4adcf62ef3c537a91bdfce66db"><div class="ttname"><a href="classAerRadProps.html#aa4241f4adcf62ef3c537a91bdfce66db">AerRadProps::volcanic_cmip_sw</a></div><div class="ttdeci">void volcanic_cmip_sw(const int1d &amp;trop_level, const real2d &amp;zi, const real3d &amp;ext_cmip6_sw_inv_m, const real3d &amp;ssa_cmip6_sw, const real3d &amp;af_cmip6_sw, const real3d &amp;tau, const real3d &amp;tau_w, const real3d &amp;tau_w_g, const real3d &amp;tau_w_f)</div><div class="ttdef"><b>Definition:</b> Aero_rad_props.cpp:613</div></div>
<div class="ttc" id="aclassAerRadProps_html_acf87aa0fdbfa3b73924a1f7c56088e55"><div class="ttname"><a href="classAerRadProps.html#acf87aa0fdbfa3b73924a1f7c56088e55">AerRadProps::ext_cmip6_sw</a></div><div class="ttdeci">real3d ext_cmip6_sw</div><div class="ttdef"><b>Definition:</b> Aero_rad_props.H:132</div></div>
<div class="ttc" id="aclassAerRadProps_html_aded12109795a3f22556faecdd3fb3d03"><div class="ttname"><a href="classAerRadProps.html#aded12109795a3f22556faecdd3fb3d03">AerRadProps::nswbands</a></div><div class="ttdeci">int nswbands</div><div class="ttdef"><b>Definition:</b> Aero_rad_props.H:114</div></div>
<div class="ttc" id="aclassAerRadProps_html_ae41f31dfce03d5b3952114e12436bec9"><div class="ttname"><a href="classAerRadProps.html#ae41f31dfce03d5b3952114e12436bec9">AerRadProps::ngas</a></div><div class="ttdeci">int ngas</div><div class="ttdef"><b>Definition:</b> Aero_rad_props.H:111</div></div>
<div class="ttc" id="aclassAerRadProps_html_af6e6827c17d2247b72337a35875ea0e0"><div class="ttname"><a href="classAerRadProps.html#af6e6827c17d2247b72337a35875ea0e0">AerRadProps::get_nonhygro_rad_props</a></div><div class="ttdeci">void get_nonhygro_rad_props(const int &amp;ncol, const real2d &amp;mass, const real1d &amp;ext, const real1d &amp;ssa, const real1d &amp;assm, const real3d &amp;tau, const real3d &amp;tau_w, const real3d &amp;tau_w_g, const real3d &amp;tau_w_f)</div><div class="ttdef"><b>Definition:</b> Aero_rad_props.cpp:528</div></div>
<div class="ttc" id="aclassAerRadProps_html_afd083b451cf913a409380fb0b95de4c0"><div class="ttname"><a href="classAerRadProps.html#afd083b451cf913a409380fb0b95de4c0">AerRadProps::af_cmip6_sw</a></div><div class="ttdeci">real3d af_cmip6_sw</div><div class="ttdef"><b>Definition:</b> Aero_rad_props.H:132</div></div>
<div class="ttc" id="aclassMam4__aer_html_ad7ec661c28332eed1cbb43fa82c8fb92"><div class="ttname"><a href="classMam4__aer.html#ad7ec661c28332eed1cbb43fa82c8fb92">Mam4_aer::modal_aero_sw</a></div><div class="ttdeci">void modal_aero_sw(int list_idx, real dt, int nnite, const int1d &amp;idxnite, const bool &amp;is_cmip6_volc, const real2d &amp;ext_cmip6_sw, const int1d &amp;trop_level, const real3d &amp;tauxar, const real3d &amp;wa, const real3d &amp;ga, const real3d &amp;fa, const real2d &amp;clear_rh)</div><div class="ttdef"><b>Definition:</b> Mam4_aero.H:321</div></div>
<div class="ttc" id="aclassMamConstituents_html_a1e2eb8427b5f69fe79ffdbff599489da"><div class="ttname"><a href="classMamConstituents.html#a1e2eb8427b5f69fe79ffdbff599489da">MamConstituents::get_aer_sw_hygro_asm</a></div><div class="ttdeci">void get_aer_sw_hygro_asm(int list_idx, int aer_idx, real2d &amp;sw_hygro_asm)</div><div class="ttdef"><b>Definition:</b> Mam4_constituents.H:936</div></div>
<div class="ttc" id="aclassMamConstituents_html_a55dbbc44079a3d80b501dabb766c70f6"><div class="ttname"><a href="classMamConstituents.html#a55dbbc44079a3d80b501dabb766c70f6">MamConstituents::get_aer_sw_nonhygro_asm</a></div><div class="ttdeci">void get_aer_sw_nonhygro_asm(int list_idx, int aer_idx, real1d &amp;sw_nonhygro_asm)</div><div class="ttdef"><b>Definition:</b> Mam4_constituents.H:968</div></div>
<div class="ttc" id="aclassMamConstituents_html_a6c4d7f8d8edc0d35828faf619d474c2b"><div class="ttname"><a href="classMamConstituents.html#a6c4d7f8d8edc0d35828faf619d474c2b">MamConstituents::get_aer_r_sw_ascat</a></div><div class="ttdeci">void get_aer_r_sw_ascat(int list_idx, int aer_idx, real2d &amp;r_sw_ascat)</div><div class="ttdef"><b>Definition:</b> Mam4_constituents.H:1034</div></div>
<div class="ttc" id="aclassMamConstituents_html_a80c22c3ae9035880d179adca47c29b60"><div class="ttname"><a href="classMamConstituents.html#a80c22c3ae9035880d179adca47c29b60">MamConstituents::get_ngas</a></div><div class="ttdeci">void get_ngas(int list_idx, int ngas)</div><div class="ttdef"><b>Definition:</b> Mam4_constituents.H:329</div></div>
<div class="ttc" id="aclassMamConstituents_html_a8d1e4789f9cd4438776ba0838c59f663"><div class="ttname"><a href="classMamConstituents.html#a8d1e4789f9cd4438776ba0838c59f663">MamConstituents::get_aer_sw_nonhygro_ssa</a></div><div class="ttdeci">void get_aer_sw_nonhygro_ssa(int list_idx, int aer_idx, real1d &amp;sw_nonhygro_ssa)</div><div class="ttdef"><b>Definition:</b> Mam4_constituents.H:960</div></div>
<div class="ttc" id="aclassMamConstituents_html_a97b9fbaf5e3efd669c510507e3a4095c"><div class="ttname"><a href="classMamConstituents.html#a97b9fbaf5e3efd669c510507e3a4095c">MamConstituents::get_aer_sw_hygro_ssa</a></div><div class="ttdeci">void get_aer_sw_hygro_ssa(int list_idx, int aer_idx, real2d &amp;sw_hygro_ssa)</div><div class="ttdef"><b>Definition:</b> Mam4_constituents.H:928</div></div>
<div class="ttc" id="aclassMamConstituents_html_aa0f1152f17813847ba8f464828079065"><div class="ttname"><a href="classMamConstituents.html#aa0f1152f17813847ba8f464828079065">MamConstituents::get_aer_sw_nonhygro_ext</a></div><div class="ttdeci">void get_aer_sw_nonhygro_ext(int list_idx, int aer_idx, real1d &amp;sw_nonhygro_ext)</div><div class="ttdef"><b>Definition:</b> Mam4_constituents.H:952</div></div>
<div class="ttc" id="aclassMamConstituents_html_aa1f6958b2ddfaf33e1561b53e3e026c3"><div class="ttname"><a href="classMamConstituents.html#aa1f6958b2ddfaf33e1561b53e3e026c3">MamConstituents::get_aer_r_sw_ext</a></div><div class="ttdeci">void get_aer_r_sw_ext(int list_idx, int aer_idx, real2d &amp;r_sw_ext)</div><div class="ttdef"><b>Definition:</b> Mam4_constituents.H:1018</div></div>
<div class="ttc" id="aclassMamConstituents_html_aa8e7a68a039ef90b126879c91ac33086"><div class="ttname"><a href="classMamConstituents.html#aa8e7a68a039ef90b126879c91ac33086">MamConstituents::get_aer_sw_hygro_ext</a></div><div class="ttdeci">void get_aer_sw_hygro_ext(int list_idx, int aer_idx, real2d &amp;sw_hygro_ext)</div><div class="ttdef"><b>Definition:</b> Mam4_constituents.H:920</div></div>
<div class="ttc" id="aclassMamConstituents_html_ad7a049202ae9582047df1a88d0f973ae"><div class="ttname"><a href="classMamConstituents.html#ad7a049202ae9582047df1a88d0f973ae">MamConstituents::get_aer_sw_nonhygro_ascat</a></div><div class="ttdeci">void get_aer_sw_nonhygro_ascat(int list_idx, int aer_idx, real1d &amp;sw_nonhygro_ascat)</div><div class="ttdef"><b>Definition:</b> Mam4_constituents.H:984</div></div>
<div class="ttc" id="aclassMamConstituents_html_ad7e9e541dea92292a381c1d645faef1b"><div class="ttname"><a href="classMamConstituents.html#ad7e9e541dea92292a381c1d645faef1b">MamConstituents::get_aer_r_sw_scat</a></div><div class="ttdeci">void get_aer_r_sw_scat(int list_idx, int aer_idx, real2d &amp;r_sw_scat)</div><div class="ttdef"><b>Definition:</b> Mam4_constituents.H:1026</div></div>
<div class="ttc" id="aclassMamConstituents_html_af3443a17ef46a08705917692bd92bfae"><div class="ttname"><a href="classMamConstituents.html#af3443a17ef46a08705917692bd92bfae">MamConstituents::get_aer_sw_nonhygro_scat</a></div><div class="ttdeci">void get_aer_sw_nonhygro_scat(int list_idx, int aer_idx, real1d &amp;sw_nonhygro_scat)</div><div class="ttdef"><b>Definition:</b> Mam4_constituents.H:976</div></div>
<div class="ttc" id="aclassRadConstants_html_aa8d069e0dd3bcec898e914167c02f4ee"><div class="ttname"><a href="classRadConstants.html#aa8d069e0dd3bcec898e914167c02f4ee">RadConstants::idx_sw_diag</a></div><div class="ttdeci">static constexpr int idx_sw_diag</div><div class="ttdef"><b>Definition:</b> Rad_constants.H:60</div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classOptics.html#a54463b4d74c22934fcbf36a7c95f0b3f">Optics::set_aerosol_optics_sw()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classAerRadProps_a433097bd85637100b16f3e120e9d6fa1_cgraph.png" border="0" usemap="#aclassAerRadProps_a433097bd85637100b16f3e120e9d6fa1_cgraph" alt=""/></div>
<map name="aclassAerRadProps_a433097bd85637100b16f3e120e9d6fa1_cgraph" id="aclassAerRadProps_a433097bd85637100b16f3e120e9d6fa1_cgraph">
<area shape="rect" title=" " alt="" coords="5,801,168,842"/>
<area shape="rect" href="Modal__aero__wateruptake_8H.html#a8a0c0dddc4a8389a14e6906b55d7cacf" title=" " alt="" coords="568,19,607,46"/>
<area shape="rect" href="classMamConstituents.html#aa268eea91939bf42c29685aa43138d15" title=" " alt="" coords="235,180,401,221"/>
<area shape="rect" href="classMamConstituents.html#a278b01dd1df95acd2ad6a5c800caf719" title=" " alt="" coords="235,245,401,286"/>
<area shape="rect" href="classMamConstituents.html#a6c4d7f8d8edc0d35828faf619d474c2b" title=" " alt="" coords="235,310,401,352"/>
<area shape="rect" href="classMamConstituents.html#aa1f6958b2ddfaf33e1561b53e3e026c3" title=" " alt="" coords="235,376,401,417"/>
<area shape="rect" href="classMamConstituents.html#ad7e9e541dea92292a381c1d645faef1b" title=" " alt="" coords="235,441,401,482"/>
<area shape="rect" href="classMamConstituents.html#a1e2eb8427b5f69fe79ffdbff599489da" title=" " alt="" coords="235,506,401,548"/>
<area shape="rect" href="classMamConstituents.html#aa8e7a68a039ef90b126879c91ac33086" title=" " alt="" coords="235,572,401,613"/>
<area shape="rect" href="classMamConstituents.html#a97b9fbaf5e3efd669c510507e3a4095c" title=" " alt="" coords="235,637,401,678"/>
<area shape="rect" href="classMamConstituents.html#ad7a049202ae9582047df1a88d0f973ae" title=" " alt="" coords="225,702,411,744"/>
<area shape="rect" href="classMamConstituents.html#a55dbbc44079a3d80b501dabb766c70f6" title=" " alt="" coords="229,768,407,809"/>
<area shape="rect" href="classMamConstituents.html#aa0f1152f17813847ba8f464828079065" title=" " alt="" coords="233,833,403,874"/>
<area shape="rect" href="classMamConstituents.html#af3443a17ef46a08705917692bd92bfae" title=" " alt="" coords="229,898,407,940"/>
<area shape="rect" href="classMamConstituents.html#a8d1e4789f9cd4438776ba0838c59f663" title=" " alt="" coords="232,964,404,1005"/>
<area shape="rect" href="classAerRadProps.html#a6a1e71160911bbc52d09bdbd73acb219" title=" " alt="" coords="229,1029,407,1070"/>
<area shape="rect" href="classMamConstituents.html#abd92c92743d51efe2f17e68cbfaccee1" title=" " alt="" coords="235,1094,401,1136"/>
<area shape="rect" href="classMamConstituents.html#a80c22c3ae9035880d179adca47c29b60" title=" " alt="" coords="216,1160,420,1187"/>
<area shape="rect" href="classMamConstituents.html#a5de90eaa3b6d493a7b12ce7df766fa6f" title=" " alt="" coords="755,1470,921,1512"/>
<area shape="rect" href="classAerRadProps.html#af6e6827c17d2247b72337a35875ea0e0" title=" " alt="" coords="217,1313,419,1354"/>
<area shape="rect" href="classAerRadProps.html#a74842fff81711719376fc035b86dc1a7" title=" " alt="" coords="221,1378,415,1420"/>
<area shape="rect" href="classAerRadProps.html#a55507a56c5808f7480e42f4369cbf5a7" title=" " alt="" coords="221,1444,415,1485"/>
<area shape="rect" href="classMam4__aer.html#ad7ec661c28332eed1cbb43fa82c8fb92" title=" " alt="" coords="217,1211,419,1238"/>
<area shape="rect" href="Modal__aero__wateruptake_8H.html#a732deb0c6f95544c2c323749f227bbd6" title=" " alt="" coords="568,136,607,163"/>
<area shape="rect" href="classWaterVaporSat.html#a4dac5d0ff52b333add64a13539fca1c8" title=" " alt="" coords="241,78,395,104"/>
<area shape="rect" href="Modal__aero__wateruptake_8H.html#a352bc71b7a47b331f4f6b71b09e0401d" title=" " alt="" coords="299,1510,337,1536"/>
<area shape="rect" href="classAerRadProps.html#aa4241f4adcf62ef3c537a91bdfce66db" title=" " alt="" coords="235,1561,401,1602"/>
<area shape="rect" href="classPhysProp.html#ac78ce456f60120096570085d96025467" title=" " alt="" coords="518,187,657,214"/>
<area shape="rect" href="classPhysProp.html#a2e6aa40659bebbb92eff36707e84dbeb" title=" " alt="" coords="494,252,681,279"/>
<area shape="rect" href="classPhysProp.html#a8e24d22599eb28c794d6c013a77da88b" title=" " alt="" coords="513,310,661,352"/>
<area shape="rect" href="classPhysProp.html#a8ae236822c66b24d61542a7562dc2b36" title=" " alt="" coords="499,383,675,410"/>
<area shape="rect" href="classPhysProp.html#a4dc566af71334229d77cec2ff7c1b8a2" title=" " alt="" coords="496,448,679,475"/>
<area shape="rect" href="classPhysProp.html#a2c4ba9dc1730e16e61dd5de913f09229" title=" " alt="" coords="480,514,695,540"/>
<area shape="rect" href="classPhysProp.html#ababe9e1b22883f8f778de5642c51fb7e" title=" " alt="" coords="483,579,691,606"/>
<area shape="rect" href="classPhysProp.html#a5b9855835eec9368dd391c7e2bea62c8" title=" " alt="" coords="483,644,692,671"/>
<area shape="rect" href="classPhysProp.html#a8f01d8ce66699a90d6a9f11470d04e8f" title=" " alt="" coords="485,702,689,744"/>
<area shape="rect" href="classPhysProp.html#a619a541abfbda160eab3cfe9ea26c612" title=" " alt="" coords="468,771,707,798"/>
<area shape="rect" href="classPhysProp.html#a98cea076df018a4aaf83ea7c559674ec" title=" " alt="" coords="471,822,703,848"/>
<area shape="rect" href="classPhysProp.html#a10b14c12c1fafdc8e35b622fc816247e" title=" " alt="" coords="468,872,707,899"/>
<area shape="rect" href="classPhysProp.html#a014f63e66f91a28c359abf6ed245450b" title=" " alt="" coords="471,923,704,950"/>
<area shape="rect" href="classMam4__aer.html#a1488790796a5a153be55af7d9a64d36a" title=" " alt="" coords="515,1142,660,1168"/>
<area shape="rect" href="Modal__aero__wateruptake_8H.html#ae5d285c0e71657c006da1c31ac41c548" title=" " alt="" coords="556,1243,619,1270"/>
<area shape="rect" href="classMamConstituents.html#a4fd648d3960d01a223e78b1436280c13" title=" " alt="" coords="755,1332,921,1373"/>
<area shape="rect" href="classMamConstituents.html#aca6158f69242c0ed4e434c16c4254cd0" title=" " alt="" coords="504,1412,671,1453"/>
<area shape="rect" href="classMamConstituents.html#a2d427b9d796e14b4e713b58829034f56" title=" " alt="" coords="755,1106,921,1148"/>
<area shape="rect" href="classMamConstituents.html#a12e3884e2ae28840165e4aa8408add45" title=" " alt="" coords="755,1216,921,1257"/>
<area shape="rect" href="classMam4__aer.html#adedd31f2c7c2a293e6f3dfc4818b175d" title=" " alt="" coords="499,1294,675,1336"/>
<area shape="rect" href="classMam4__aer.html#af2034bd10c39ba3bf5139d8d8c5b07ad" title=" " alt="" coords="501,974,674,1016"/>
<area shape="rect" href="Modal__aero__wateruptake_8H.html#a3cd6f9e15171bc4f84f7293abef597cb" title=" " alt="" coords="554,1040,621,1067"/>
<area shape="rect" href="classWaterVaporSat.html#a071cc1a28405ce131d1c1bcb216d471a" title=" " alt="" coords="511,70,663,112"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classAerRadProps_a433097bd85637100b16f3e120e9d6fa1_icgraph.png" border="0" usemap="#aclassAerRadProps_a433097bd85637100b16f3e120e9d6fa1_icgraph" alt=""/></div>
<map name="aclassAerRadProps_a433097bd85637100b16f3e120e9d6fa1_icgraph" id="aclassAerRadProps_a433097bd85637100b16f3e120e9d6fa1_icgraph">
<area shape="rect" title=" " alt="" coords="200,5,363,47"/>
<area shape="rect" href="classOptics.html#a54463b4d74c22934fcbf36a7c95f0b3f" title=" " alt="" coords="5,5,152,47"/>
</map>
</div>

</div>
</div>
<a id="a97f18fad2a20322240862cee5c3fb5b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97f18fad2a20322240862cee5c3fb5b7">&#9670;&nbsp;</a></span>aer_vis_diag_out()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AerRadProps::aer_vis_diag_out </td>
          <td>(</td>
          <td class="paramtype">const int &amp;&#160;</td>
          <td class="paramname"><em>ncol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int &amp;&#160;</td>
          <td class="paramname"><em>nnite</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int1d &amp;&#160;</td>
          <td class="paramname"><em>idxnite</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int &amp;&#160;</td>
          <td class="paramname"><em>iaer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int &amp;&#160;</td>
          <td class="paramname"><em>diag_idx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6a1e71160911bbc52d09bdbd73acb219"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a1e71160911bbc52d09bdbd73acb219">&#9670;&nbsp;</a></span>get_hygro_rad_props()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AerRadProps::get_hygro_rad_props </td>
          <td>(</td>
          <td class="paramtype">const int &amp;&#160;</td>
          <td class="paramname"><em>ncol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int2d &amp;&#160;</td>
          <td class="paramname"><em>krh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>wrh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>mass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>ext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>ssa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>assm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>tau_w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>tau_w_g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>tau_w_f</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                                                               {</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160; </div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;   parallel_for(SimpleBounds&lt;3&gt;(<a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>,<a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>,<a class="code" href="classAerRadProps.html#aded12109795a3f22556faecdd3fb3d03">nswbands</a>) , YAKL_LAMBDA (<span class="keywordtype">int</span> icol, <span class="keywordtype">int</span> ilev, <span class="keywordtype">int</span> iswband)</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;   {</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;       <span class="keyword">auto</span> ext1 = (1 + wrh(icol,ilev)) * extb(krh(icol,ilev)+1,iswband) - wrh(icol,ilev) * extb(krh(icol,ilev),iswband);</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;       <span class="keyword">auto</span> ssa1 = (1 + wrh(icol,ilev)) * ssab(krh(icol,ilev)+1,iswband) - wrh(icol,ilev) * ssab(krh(icol,ilev),iswband);</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;       <span class="keyword">auto</span> asm1 = (1 + wrh(icol,ilev)) * asmb(krh(icol,ilev)+1,iswband) - wrh(icol,ilev) * asmb(krh(icol,ilev),iswband);</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160; </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;       tau    (icol, ilev, iswband) = mass(icol, ilev) * ext1;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;       tau_w  (icol, ilev, iswband) = mass(icol, ilev) * ext1 * ssa1;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;       tau_w_g(icol, ilev, iswband) = mass(icol, ilev) * ext1 * ssa1 * asm1;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;       tau_w_f(icol, ilev, iswband) = mass(icol, ilev) * ext1 * ssa1 * asm1 * asm1;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;   });</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classAerRadProps.html#a433097bd85637100b16f3e120e9d6fa1">aer_rad_props_sw()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classAerRadProps_a6a1e71160911bbc52d09bdbd73acb219_icgraph.png" border="0" usemap="#aclassAerRadProps_a6a1e71160911bbc52d09bdbd73acb219_icgraph" alt=""/></div>
<map name="aclassAerRadProps_a6a1e71160911bbc52d09bdbd73acb219_icgraph" id="aclassAerRadProps_a6a1e71160911bbc52d09bdbd73acb219_icgraph">
<area shape="rect" title=" " alt="" coords="411,5,589,47"/>
<area shape="rect" href="classAerRadProps.html#a433097bd85637100b16f3e120e9d6fa1" title=" " alt="" coords="200,5,363,47"/>
<area shape="rect" href="classOptics.html#a54463b4d74c22934fcbf36a7c95f0b3f" title=" " alt="" coords="5,5,152,47"/>
</map>
</div>

</div>
</div>
<a id="af6e6827c17d2247b72337a35875ea0e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6e6827c17d2247b72337a35875ea0e0">&#9670;&nbsp;</a></span>get_nonhygro_rad_props()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AerRadProps::get_nonhygro_rad_props </td>
          <td>(</td>
          <td class="paramtype">const int &amp;&#160;</td>
          <td class="paramname"><em>ncol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>mass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real1d &amp;&#160;</td>
          <td class="paramname"><em>ext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real1d &amp;&#160;</td>
          <td class="paramname"><em>ssa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real1d &amp;&#160;</td>
          <td class="paramname"><em>assm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>tau_w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>tau_w_g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>tau_w_f</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                                                                 {</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160; </div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;   parallel_for(SimpleBounds&lt;3&gt;(<a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>,<a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>,<a class="code" href="classAerRadProps.html#aded12109795a3f22556faecdd3fb3d03">nswbands</a>) , YAKL_LAMBDA (<span class="keywordtype">int</span> icol, <span class="keywordtype">int</span> ilev, <span class="keywordtype">int</span> iswband)</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;   {</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;       <span class="keyword">auto</span> ext1 = extb(iswband);</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;       <span class="keyword">auto</span> ssa1 = ssab(iswband);</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;       <span class="keyword">auto</span> asm1 = asmb(iswband);</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;       tau    (icol,ilev,iswband) = mass(icol,ilev) * ext1;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;       tau_w  (icol,ilev,iswband) = mass(icol,ilev) * ext1 * ssa1;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;       tau_w_g(icol,ilev,iswband) = mass(icol,ilev) * ext1 * ssa1 * asm1;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;       tau_w_f(icol,ilev,iswband) = mass(icol,ilev) * ext1 * ssa1 * asm1 * asm1;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;   });</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classAerRadProps.html#a433097bd85637100b16f3e120e9d6fa1">aer_rad_props_sw()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classAerRadProps_af6e6827c17d2247b72337a35875ea0e0_icgraph.png" border="0" usemap="#aclassAerRadProps_af6e6827c17d2247b72337a35875ea0e0_icgraph" alt=""/></div>
<map name="aclassAerRadProps_af6e6827c17d2247b72337a35875ea0e0_icgraph" id="aclassAerRadProps_af6e6827c17d2247b72337a35875ea0e0_icgraph">
<area shape="rect" title=" " alt="" coords="411,5,613,47"/>
<area shape="rect" href="classAerRadProps.html#a433097bd85637100b16f3e120e9d6fa1" title=" " alt="" coords="200,5,363,47"/>
<area shape="rect" href="classOptics.html#a54463b4d74c22934fcbf36a7c95f0b3f" title=" " alt="" coords="5,5,152,47"/>
</map>
</div>

</div>
</div>
<a id="a74842fff81711719376fc035b86dc1a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74842fff81711719376fc035b86dc1a7">&#9670;&nbsp;</a></span>get_volcanic_rad_props()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AerRadProps::get_volcanic_rad_props </td>
          <td>(</td>
          <td class="paramtype">const int &amp;&#160;</td>
          <td class="paramname"><em>ncol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>mass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real1d &amp;&#160;</td>
          <td class="paramname"><em>ext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real1d &amp;&#160;</td>
          <td class="paramname"><em>scat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real1d &amp;&#160;</td>
          <td class="paramname"><em>ascat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>tau_w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>tau_w_g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>tau_w_f</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                                                                 {</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="classAerRadProps.html#aded12109795a3f22556faecdd3fb3d03">nswbands</a>;</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;   parallel_for(SimpleBounds&lt;3&gt;(<a class="code" href="classAerRadProps.html#aded12109795a3f22556faecdd3fb3d03">nswbands</a>, <a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>,<a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>), YAKL_LAMBDA (<span class="keywordtype">int</span> iswband, <span class="keywordtype">int</span> icol, <span class="keywordtype">int</span> ilev)</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;   {</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;       real g = 0;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;       <span class="keywordflow">if</span> (scat(iswband) &gt; 0.)</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;           g = ascat(iswband)/scat(iswband);</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160; </div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;       tau    (icol, ilev, iswband) = mass(icol, ilev) * ext(iswband);</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;       tau_w  (icol, ilev, iswband) = mass(icol, ilev) * scat(iswband);</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;       tau_w_g(icol, ilev, iswband) = mass(icol, ilev) * ascat(iswband);</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;       tau_w_f(icol, ilev, iswband) = mass(icol, ilev) * g * ascat(iswband);</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;   });</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classAerRadProps.html#a433097bd85637100b16f3e120e9d6fa1">aer_rad_props_sw()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classAerRadProps_a74842fff81711719376fc035b86dc1a7_icgraph.png" border="0" usemap="#aclassAerRadProps_a74842fff81711719376fc035b86dc1a7_icgraph" alt=""/></div>
<map name="aclassAerRadProps_a74842fff81711719376fc035b86dc1a7_icgraph" id="aclassAerRadProps_a74842fff81711719376fc035b86dc1a7_icgraph">
<area shape="rect" title=" " alt="" coords="411,5,605,47"/>
<area shape="rect" href="classAerRadProps.html#a433097bd85637100b16f3e120e9d6fa1" title=" " alt="" coords="200,5,363,47"/>
<area shape="rect" href="classOptics.html#a54463b4d74c22934fcbf36a7c95f0b3f" title=" " alt="" coords="5,5,152,47"/>
</map>
</div>

</div>
</div>
<a id="a55507a56c5808f7480e42f4369cbf5a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55507a56c5808f7480e42f4369cbf5a7">&#9670;&nbsp;</a></span>get_volcanic_radius_rad_props()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AerRadProps::get_volcanic_radius_rad_props </td>
          <td>(</td>
          <td class="paramtype">const int &amp;&#160;</td>
          <td class="paramname"><em>ncol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>mass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>r_ext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>r_scat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>r_ascat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real1d &amp;&#160;</td>
          <td class="paramname"><em>r_mu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>tau_w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>tau_w_g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>tau_w_f</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                                                                         {</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;   yakl::memset(tau, 0.);</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;   yakl::memset(tau_w, 0.);</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;   yakl::memset(tau_w_g, 0.);</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;   yakl::memset(tau_w_f, 0.);</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160; </div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;   <span class="comment">// get microphysical properties for volcanic aerosols</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;   <span class="comment">//idx = pbuf_get_index(&#39;VOLC_RAD_GEOM&#39;)</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;   <span class="comment">//call pbuf_get_field(pbuf, idx, geometric_radius )</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160; </div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;   <span class="comment">// interpolate in radius</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;   <span class="comment">// caution: clip the table with no warning when outside bounds</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;   <span class="keyword">auto</span> nmu = r_mu.extent(0);</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;   <span class="keyword">auto</span> r_mu_max = r_mu(nmu-1);</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;   <span class="keyword">auto</span> r_mu_min = r_mu(0);</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160; </div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;   <span class="comment">// interpolated values from table</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;   real1d ext(<span class="stringliteral">&quot;ext&quot;</span>, <a class="code" href="classAerRadProps.html#aded12109795a3f22556faecdd3fb3d03">nswbands</a>);</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;   real1d scat(<span class="stringliteral">&quot;scat&quot;</span>, <a class="code" href="classAerRadProps.html#aded12109795a3f22556faecdd3fb3d03">nswbands</a>);</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;   real1d ascat(<span class="stringliteral">&quot;ascat&quot;</span>, <a class="code" href="classAerRadProps.html#aded12109795a3f22556faecdd3fb3d03">nswbands</a>);</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;   real2d mu(<span class="stringliteral">&quot;mu&quot;</span>, <a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>);</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160; </div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;   parallel_for(SimpleBounds&lt;3&gt;(<a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>,<a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>,<a class="code" href="classAerRadProps.html#aded12109795a3f22556faecdd3fb3d03">nswbands</a>), YAKL_LAMBDA (<span class="keywordtype">int</span> icol, <span class="keywordtype">int</span> ilev, <span class="keywordtype">int</span> iswband)</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;   {</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;       <span class="keywordflow">if</span>(<a class="code" href="classAerRadProps.html#a315308c2521564d2531785962659d292">geometric_radius</a>(icol,ilev) &gt; 0.)</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;           mu(icol,ilev) = std::log(<a class="code" href="classAerRadProps.html#a315308c2521564d2531785962659d292">geometric_radius</a>(icol,ilev));</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;       <span class="keywordflow">else</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;           mu(icol,ilev) = 0.;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160; </div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;       <span class="keyword">auto</span> mutrunc = std::max(std::min(mu(icol,ilev),r_mu_max),r_mu_min);</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;       <span class="keyword">auto</span> kmu = std::max(std::min(1 + (mutrunc-r_mu_min)/(r_mu_max-r_mu_min)*(nmu-1),nmu-1.),1.);</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;       <span class="keyword">auto</span> wmu = std::max(std::min((mutrunc -r_mu(kmu)) / (r_mu(kmu+1) - r_mu(kmu)),1.),0.);</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160; </div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;       ext(iswband) = ((1. - wmu) * r_ext(iswband, kmu  ) +</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                       (wmu) * r_ext(iswband, kmu+1));</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;       scat(iswband) = ((1. - wmu) * r_scat(iswband, kmu  ) +</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                        (wmu) * r_scat(iswband, kmu+1));</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;       ascat(iswband) = ((1. - wmu) * r_ascat(iswband, kmu  ) +</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                         (wmu) * r_ascat(iswband, kmu+1));</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;       real g = 0;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;       <span class="keywordflow">if</span> (scat(iswband) &gt; 0.)</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;           g = ascat(iswband)/scat(iswband);</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160; </div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;       tau    (icol,ilev,iswband) = mass(icol,ilev) * ext(iswband);</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;       tau_w  (icol,ilev,iswband) = mass(icol,ilev) * scat(iswband);</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;       tau_w_g(icol,ilev,iswband) = mass(icol,ilev) * ascat(iswband);</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;       tau_w_f(icol,ilev,iswband) = mass(icol,ilev) * g * ascat(iswband);</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;   });</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classAerRadProps.html#a433097bd85637100b16f3e120e9d6fa1">aer_rad_props_sw()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classAerRadProps_a55507a56c5808f7480e42f4369cbf5a7_icgraph.png" border="0" usemap="#aclassAerRadProps_a55507a56c5808f7480e42f4369cbf5a7_icgraph" alt=""/></div>
<map name="aclassAerRadProps_a55507a56c5808f7480e42f4369cbf5a7_icgraph" id="aclassAerRadProps_a55507a56c5808f7480e42f4369cbf5a7_icgraph">
<area shape="rect" title=" " alt="" coords="411,5,605,47"/>
<area shape="rect" href="classAerRadProps.html#a433097bd85637100b16f3e120e9d6fa1" title=" " alt="" coords="200,5,363,47"/>
<area shape="rect" href="classOptics.html#a54463b4d74c22934fcbf36a7c95f0b3f" title=" " alt="" coords="5,5,152,47"/>
</map>
</div>

</div>
</div>
<a id="a4d708a6b6284e41f8dce29444416c810"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d708a6b6284e41f8dce29444416c810">&#9670;&nbsp;</a></span>initialize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AerRadProps::initialize </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ngas_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nmodes_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num_aeros_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nswbands_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlwbands_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ncol_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlev_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrh_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>top_lev_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>aero_names_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>zi_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>pmid_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>temp_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>qi_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>geom_radius</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;                                                                            {</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <a class="code" href="classAerRadProps.html#a3bd718612795e1c875ad70da941cc89a">nmodes</a> = nmodes_;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <a class="code" href="classAerRadProps.html#ae41f31dfce03d5b3952114e12436bec9">ngas</a> = ngas_;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <a class="code" href="classAerRadProps.html#af174fea4281252e1cf87c621ab532aeb">num_aeroes</a> = num_aeroes_;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <a class="code" href="classAerRadProps.html#a6dcb735fda4651c893ce9d3c2860a0af">aero_names</a> = aero_names_;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <a class="code" href="classAerRadProps.html#aded12109795a3f22556faecdd3fb3d03">nswbands</a> = nswbands_;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <a class="code" href="classAerRadProps.html#af2dc3b884340390993212e03e99112af">nlwbands</a> = nlwbands_;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>     = ncol_;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>     = nlev_;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <a class="code" href="classAerRadProps.html#aa21297bb80600126531f2d324f6d9c2f">nrh</a>      = nrh_;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <a class="code" href="classAerRadProps.html#a83216edbd2d57b575f1869df38a1b668">top_lev</a>  = top_lev_;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <a class="code" href="classAerRadProps.html#ab56e110ccf8deaa71d452a64e69b8647">pmid</a> = pmid_;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <a class="code" href="classAerRadProps.html#a1bf28a8f87d617095d3cf88cf7ef738e">pdeldry</a> = pmid_;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <a class="code" href="classAerRadProps.html#a0a03391413de1fcd9ea2550fea907b33">temp</a> = temp_;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <a class="code" href="classAerRadProps.html#a837035712a214f1b8daf7a4d30727e6d">qt</a>   = qt_;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="comment">// geometric radius</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <a class="code" href="classAerRadProps.html#a315308c2521564d2531785962659d292">geometric_radius</a> = geom_radius;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="comment">// vertical grid</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <a class="code" href="classAerRadProps.html#ac82b4bf91bb3a23e33074e00381388e3">zi</a> = zi_;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="comment">// initialize mam4 aero model</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <a class="code" href="classAerRadProps.html#afb607ae14bfc3e46dd66c9e04627a57d">mam_aer</a>.<a class="code" href="classMam4__aer.html#ad26a9b5e3fc355d5102328b86621b8df">initialize</a>(<a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>, <a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>, <a class="code" href="classAerRadProps.html#a83216edbd2d57b575f1869df38a1b668">top_lev</a>, <a class="code" href="classAerRadProps.html#aded12109795a3f22556faecdd3fb3d03">nswbands</a>, <a class="code" href="classAerRadProps.html#af2dc3b884340390993212e03e99112af">nlwbands</a>);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;}</div>
<div class="ttc" id="aclassAerRadProps_html_a6dcb735fda4651c893ce9d3c2860a0af"><div class="ttname"><a href="classAerRadProps.html#a6dcb735fda4651c893ce9d3c2860a0af">AerRadProps::aero_names</a></div><div class="ttdeci">std::vector&lt; std::string &gt; aero_names</div><div class="ttdef"><b>Definition:</b> Aero_rad_props.H:112</div></div>
<div class="ttc" id="aclassAerRadProps_html_af174fea4281252e1cf87c621ab532aeb"><div class="ttname"><a href="classAerRadProps.html#af174fea4281252e1cf87c621ab532aeb">AerRadProps::num_aeroes</a></div><div class="ttdeci">int num_aeroes</div><div class="ttdef"><b>Definition:</b> Aero_rad_props.H:111</div></div>
<div class="ttc" id="aclassMam4__aer_html_ad26a9b5e3fc355d5102328b86621b8df"><div class="ttname"><a href="classMam4__aer.html#ad26a9b5e3fc355d5102328b86621b8df">Mam4_aer::initialize</a></div><div class="ttdeci">void initialize(int ncol_, int nlev_, int top_lev_, int nswbands_, int nlwbands_)</div><div class="ttdef"><b>Definition:</b> Mam4_aero.H:61</div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classOptics.html#a2472dd458109b58bc71cc44f57ff02f9">Optics::initialize()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classAerRadProps_a4d708a6b6284e41f8dce29444416c810_cgraph.png" border="0" usemap="#aclassAerRadProps_a4d708a6b6284e41f8dce29444416c810_cgraph" alt=""/></div>
<map name="aclassAerRadProps_a4d708a6b6284e41f8dce29444416c810_cgraph" id="aclassAerRadProps_a4d708a6b6284e41f8dce29444416c810_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,175,32"/>
<area shape="rect" href="classMam4__aer.html#ad26a9b5e3fc355d5102328b86621b8df" title=" " alt="" coords="223,5,377,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classAerRadProps_a4d708a6b6284e41f8dce29444416c810_icgraph.png" border="0" usemap="#aclassAerRadProps_a4d708a6b6284e41f8dce29444416c810_icgraph" alt=""/></div>
<map name="aclassAerRadProps_a4d708a6b6284e41f8dce29444416c810_icgraph" id="aclassAerRadProps_a4d708a6b6284e41f8dce29444416c810_icgraph">
<area shape="rect" title=" " alt="" coords="180,5,349,32"/>
<area shape="rect" href="classOptics.html#a2472dd458109b58bc71cc44f57ff02f9" title=" " alt="" coords="5,5,132,32"/>
</map>
</div>

</div>
</div>
<a id="aa4241f4adcf62ef3c537a91bdfce66db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4241f4adcf62ef3c537a91bdfce66db">&#9670;&nbsp;</a></span>volcanic_cmip_sw()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AerRadProps::volcanic_cmip_sw </td>
          <td>(</td>
          <td class="paramtype">const int1d &amp;&#160;</td>
          <td class="paramname"><em>trop_level</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real2d &amp;&#160;</td>
          <td class="paramname"><em>zi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>ext_cmip6_sw_inv_m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>ssa_cmip6_sw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>af_cmip6_sw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>tau_w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>tau_w_g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const real3d &amp;&#160;</td>
          <td class="paramname"><em>tau_w_f</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                                                            {</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  <span class="comment">// Above the tropopause, the read in values from the file include both the stratospheric</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;  <span class="comment">// and volcanic aerosols. Therefore, we need to zero out taus above the tropopause</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  <span class="comment">// and populate them exclusively from the read in values.</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160; </div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  <span class="comment">// If tropopause is found, update taus with 50% contributuions from the volcanic input</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  <span class="comment">// file and 50% from the existing model computed values</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  real1d ext_unitless(<span class="stringliteral">&quot;ext_unitless&quot;</span>, <a class="code" href="classAerRadProps.html#aded12109795a3f22556faecdd3fb3d03">nswbands</a>),</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;         asym_unitless(<span class="stringliteral">&quot;asym_unitless&quot;</span>,<a class="code" href="classAerRadProps.html#aded12109795a3f22556faecdd3fb3d03">nswbands</a>),</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;         ext_ssa(<span class="stringliteral">&quot;ext_ssa&quot;</span>,<a class="code" href="classAerRadProps.html#aded12109795a3f22556faecdd3fb3d03">nswbands</a>),</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;         ext_ssa_asym(<span class="stringliteral">&quot;ext_ssa_asym&quot;</span>,<a class="code" href="classAerRadProps.html#aded12109795a3f22556faecdd3fb3d03">nswbands</a>);</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160; </div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  <span class="comment">// First handle the case of tropopause layer itself:</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  parallel_for(SimpleBounds&lt;2&gt;(<a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>,<a class="code" href="classAerRadProps.html#aded12109795a3f22556faecdd3fb3d03">nswbands</a>), YAKL_LAMBDA (<span class="keywordtype">int</span> icol, <span class="keywordtype">int</span> isw)</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  {</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;      <span class="keyword">auto</span> ilev_tropp = trop_level(icol); <span class="comment">//tropopause level</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;      <span class="keyword">auto</span> lyr_thk = <a class="code" href="classAerRadProps.html#ac82b4bf91bb3a23e33074e00381388e3">zi</a>(icol,ilev_tropp) - <a class="code" href="classAerRadProps.html#ac82b4bf91bb3a23e33074e00381388e3">zi</a>(icol,ilev_tropp+1);</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160; </div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;      ext_unitless(isw)  = lyr_thk * ext_cmip6_sw_inv_m(icol,ilev_tropp,isw);</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      asym_unitless(isw) = <a class="code" href="classAerRadProps.html#afd083b451cf913a409380fb0b95de4c0">af_cmip6_sw</a> (icol,ilev_tropp,isw);</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;      ext_ssa(isw)       = ext_unitless(isw) * <a class="code" href="classAerRadProps.html#a0690511bbea6225a4afa365c4c153f0c">ssa_cmip6_sw</a>(icol,ilev_tropp,isw);</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;      ext_ssa_asym(isw)  = ext_ssa(isw) * asym_unitless(isw);</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160; </div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;      tau    (icol,ilev_tropp,isw) = 0.5 * ( tau    (icol,ilev_tropp,isw) + ext_unitless(isw) );</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;      tau_w  (icol,ilev_tropp,isw) = 0.5 * ( tau_w  (icol,ilev_tropp,isw) + ext_ssa(isw));</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;      tau_w_g(icol,ilev_tropp,isw) = 0.5 * ( tau_w_g(icol,ilev_tropp,isw) + ext_ssa_asym(isw));</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      tau_w_f(icol,ilev_tropp,isw) = 0.5 * ( tau_w_f(icol,ilev_tropp,isw) + ext_ssa_asym(isw) * asym_unitless(isw));</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  });</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160; </div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  <span class="comment">// As it will be more efficient for FORTRAN to loop over levels and then columns, the following loops</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <span class="comment">// are nested keeping that in mind</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  parallel_for(SimpleBounds&lt;3&gt;(<a class="code" href="classAerRadProps.html#a551936497e3a360746d6bfd53513d508">ncol</a>,<a class="code" href="classAerRadProps.html#a3854326c4b23eedef970611ab3a639dd">nlev</a>, <a class="code" href="classAerRadProps.html#aded12109795a3f22556faecdd3fb3d03">nswbands</a>), YAKL_LAMBDA (<span class="keywordtype">int</span> icol, <span class="keywordtype">int</span> ilev, <span class="keywordtype">int</span> isw)</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  {</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;      <span class="keyword">auto</span> ilev_tropp = trop_level(icol); <span class="comment">//tropopause level</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160; </div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;      <span class="keywordflow">if</span> (ilev &lt; ilev_tropp) { <span class="comment">//BALLI: see if this is right!</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;          <span class="keyword">auto</span> lyr_thk = <a class="code" href="classAerRadProps.html#ac82b4bf91bb3a23e33074e00381388e3">zi</a>(icol,ilev) - <a class="code" href="classAerRadProps.html#ac82b4bf91bb3a23e33074e00381388e3">zi</a>(icol,ilev+1);</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160; </div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;          ext_unitless(isw)  = lyr_thk * ext_cmip6_sw_inv_m(icol,ilev,isw);</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;          asym_unitless(isw) = <a class="code" href="classAerRadProps.html#afd083b451cf913a409380fb0b95de4c0">af_cmip6_sw</a>(icol,ilev,isw);</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;          ext_ssa(isw)       = ext_unitless(isw) * <a class="code" href="classAerRadProps.html#a0690511bbea6225a4afa365c4c153f0c">ssa_cmip6_sw</a>(icol,ilev,isw);</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;          ext_ssa_asym(isw)  = ext_ssa(isw) * asym_unitless(isw);</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160; </div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;          tau    (icol,ilev,isw) = ext_unitless(isw);</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;          tau_w  (icol,ilev,isw) = ext_ssa(isw);</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;          tau_w_g(icol,ilev,isw) = ext_ssa_asym(isw);</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;          tau_w_f(icol,ilev,isw) = ext_ssa_asym(isw) * asym_unitless(isw);</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;      }</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  });</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classAerRadProps.html#a433097bd85637100b16f3e120e9d6fa1">aer_rad_props_sw()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classAerRadProps_aa4241f4adcf62ef3c537a91bdfce66db_icgraph.png" border="0" usemap="#aclassAerRadProps_aa4241f4adcf62ef3c537a91bdfce66db_icgraph" alt=""/></div>
<map name="aclassAerRadProps_aa4241f4adcf62ef3c537a91bdfce66db_icgraph" id="aclassAerRadProps_aa4241f4adcf62ef3c537a91bdfce66db_icgraph">
<area shape="rect" title=" " alt="" coords="411,5,577,47"/>
<area shape="rect" href="classAerRadProps.html#a433097bd85637100b16f3e120e9d6fa1" title=" " alt="" coords="200,5,363,47"/>
<area shape="rect" href="classOptics.html#a54463b4d74c22934fcbf36a7c95f0b3f" title=" " alt="" coords="5,5,152,47"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a6dcb735fda4651c893ce9d3c2860a0af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6dcb735fda4651c893ce9d3c2860a0af">&#9670;&nbsp;</a></span>aero_names</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::string&gt; AerRadProps::aero_names</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classAerRadProps.html#a4d708a6b6284e41f8dce29444416c810">initialize()</a>.</p>

</div>
</div>
<a id="afd083b451cf913a409380fb0b95de4c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd083b451cf913a409380fb0b95de4c0">&#9670;&nbsp;</a></span>af_cmip6_sw</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real3d AerRadProps::af_cmip6_sw</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classAerRadProps.html#a433097bd85637100b16f3e120e9d6fa1">aer_rad_props_sw()</a>, and <a class="el" href="classAerRadProps.html#aa4241f4adcf62ef3c537a91bdfce66db">volcanic_cmip_sw()</a>.</p>

</div>
</div>
<a id="acf87aa0fdbfa3b73924a1f7c56088e55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf87aa0fdbfa3b73924a1f7c56088e55">&#9670;&nbsp;</a></span>ext_cmip6_sw</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real3d AerRadProps::ext_cmip6_sw</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classAerRadProps.html#a433097bd85637100b16f3e120e9d6fa1">aer_rad_props_sw()</a>.</p>

</div>
</div>
<a id="a315308c2521564d2531785962659d292"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a315308c2521564d2531785962659d292">&#9670;&nbsp;</a></span>geometric_radius</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real2d AerRadProps::geometric_radius</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classAerRadProps.html#a6aabfa89e9a9d91bae79c7a0d91f17b3">aer_rad_props_lw()</a>, <a class="el" href="classAerRadProps.html#a55507a56c5808f7480e42f4369cbf5a7">get_volcanic_radius_rad_props()</a>, and <a class="el" href="classAerRadProps.html#a4d708a6b6284e41f8dce29444416c810">initialize()</a>.</p>

</div>
</div>
<a id="afb607ae14bfc3e46dd66c9e04627a57d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb607ae14bfc3e46dd66c9e04627a57d">&#9670;&nbsp;</a></span>mam_aer</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMam4__aer.html">Mam4_aer</a> AerRadProps::mam_aer</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classAerRadProps.html#a6aabfa89e9a9d91bae79c7a0d91f17b3">aer_rad_props_lw()</a>, <a class="el" href="classAerRadProps.html#a433097bd85637100b16f3e120e9d6fa1">aer_rad_props_sw()</a>, and <a class="el" href="classAerRadProps.html#a4d708a6b6284e41f8dce29444416c810">initialize()</a>.</p>

</div>
</div>
<a id="a66f750181cccc82c03268b0a4a245ecc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66f750181cccc82c03268b0a4a245ecc">&#9670;&nbsp;</a></span>mam_consti</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMamConstituents.html">MamConstituents</a> AerRadProps::mam_consti</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classAerRadProps.html#a6aabfa89e9a9d91bae79c7a0d91f17b3">aer_rad_props_lw()</a>, and <a class="el" href="classAerRadProps.html#a433097bd85637100b16f3e120e9d6fa1">aer_rad_props_sw()</a>.</p>

</div>
</div>
<a id="a551936497e3a360746d6bfd53513d508"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a551936497e3a360746d6bfd53513d508">&#9670;&nbsp;</a></span>ncol</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int AerRadProps::ncol</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classAerRadProps.html#a6aabfa89e9a9d91bae79c7a0d91f17b3">aer_rad_props_lw()</a>, <a class="el" href="classAerRadProps.html#a433097bd85637100b16f3e120e9d6fa1">aer_rad_props_sw()</a>, <a class="el" href="classAerRadProps.html#a6a1e71160911bbc52d09bdbd73acb219">get_hygro_rad_props()</a>, <a class="el" href="classAerRadProps.html#af6e6827c17d2247b72337a35875ea0e0">get_nonhygro_rad_props()</a>, <a class="el" href="classAerRadProps.html#a74842fff81711719376fc035b86dc1a7">get_volcanic_rad_props()</a>, <a class="el" href="classAerRadProps.html#a55507a56c5808f7480e42f4369cbf5a7">get_volcanic_radius_rad_props()</a>, <a class="el" href="classAerRadProps.html#a4d708a6b6284e41f8dce29444416c810">initialize()</a>, and <a class="el" href="classAerRadProps.html#aa4241f4adcf62ef3c537a91bdfce66db">volcanic_cmip_sw()</a>.</p>

</div>
</div>
<a id="ae41f31dfce03d5b3952114e12436bec9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae41f31dfce03d5b3952114e12436bec9">&#9670;&nbsp;</a></span>ngas</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int AerRadProps::ngas</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classAerRadProps.html#a433097bd85637100b16f3e120e9d6fa1">aer_rad_props_sw()</a>, and <a class="el" href="classAerRadProps.html#a4d708a6b6284e41f8dce29444416c810">initialize()</a>.</p>

</div>
</div>
<a id="a3854326c4b23eedef970611ab3a639dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3854326c4b23eedef970611ab3a639dd">&#9670;&nbsp;</a></span>nlev</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int AerRadProps::nlev</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classAerRadProps.html#a6aabfa89e9a9d91bae79c7a0d91f17b3">aer_rad_props_lw()</a>, <a class="el" href="classAerRadProps.html#a433097bd85637100b16f3e120e9d6fa1">aer_rad_props_sw()</a>, <a class="el" href="classAerRadProps.html#a6a1e71160911bbc52d09bdbd73acb219">get_hygro_rad_props()</a>, <a class="el" href="classAerRadProps.html#af6e6827c17d2247b72337a35875ea0e0">get_nonhygro_rad_props()</a>, <a class="el" href="classAerRadProps.html#a74842fff81711719376fc035b86dc1a7">get_volcanic_rad_props()</a>, <a class="el" href="classAerRadProps.html#a55507a56c5808f7480e42f4369cbf5a7">get_volcanic_radius_rad_props()</a>, <a class="el" href="classAerRadProps.html#a4d708a6b6284e41f8dce29444416c810">initialize()</a>, and <a class="el" href="classAerRadProps.html#aa4241f4adcf62ef3c537a91bdfce66db">volcanic_cmip_sw()</a>.</p>

</div>
</div>
<a id="af2dc3b884340390993212e03e99112af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2dc3b884340390993212e03e99112af">&#9670;&nbsp;</a></span>nlwbands</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int AerRadProps::nlwbands</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classAerRadProps.html#a6aabfa89e9a9d91bae79c7a0d91f17b3">aer_rad_props_lw()</a>, and <a class="el" href="classAerRadProps.html#a4d708a6b6284e41f8dce29444416c810">initialize()</a>.</p>

</div>
</div>
<a id="a3bd718612795e1c875ad70da941cc89a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3bd718612795e1c875ad70da941cc89a">&#9670;&nbsp;</a></span>nmodes</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int AerRadProps::nmodes</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classAerRadProps.html#a6aabfa89e9a9d91bae79c7a0d91f17b3">aer_rad_props_lw()</a>, <a class="el" href="classAerRadProps.html#a433097bd85637100b16f3e120e9d6fa1">aer_rad_props_sw()</a>, and <a class="el" href="classAerRadProps.html#a4d708a6b6284e41f8dce29444416c810">initialize()</a>.</p>

</div>
</div>
<a id="aa21297bb80600126531f2d324f6d9c2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa21297bb80600126531f2d324f6d9c2f">&#9670;&nbsp;</a></span>nrh</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int AerRadProps::nrh</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classAerRadProps.html#a6aabfa89e9a9d91bae79c7a0d91f17b3">aer_rad_props_lw()</a>, <a class="el" href="classAerRadProps.html#a433097bd85637100b16f3e120e9d6fa1">aer_rad_props_sw()</a>, and <a class="el" href="classAerRadProps.html#a4d708a6b6284e41f8dce29444416c810">initialize()</a>.</p>

</div>
</div>
<a id="aded12109795a3f22556faecdd3fb3d03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aded12109795a3f22556faecdd3fb3d03">&#9670;&nbsp;</a></span>nswbands</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int AerRadProps::nswbands</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classAerRadProps.html#a433097bd85637100b16f3e120e9d6fa1">aer_rad_props_sw()</a>, <a class="el" href="classAerRadProps.html#a6a1e71160911bbc52d09bdbd73acb219">get_hygro_rad_props()</a>, <a class="el" href="classAerRadProps.html#af6e6827c17d2247b72337a35875ea0e0">get_nonhygro_rad_props()</a>, <a class="el" href="classAerRadProps.html#a74842fff81711719376fc035b86dc1a7">get_volcanic_rad_props()</a>, <a class="el" href="classAerRadProps.html#a55507a56c5808f7480e42f4369cbf5a7">get_volcanic_radius_rad_props()</a>, <a class="el" href="classAerRadProps.html#a4d708a6b6284e41f8dce29444416c810">initialize()</a>, and <a class="el" href="classAerRadProps.html#aa4241f4adcf62ef3c537a91bdfce66db">volcanic_cmip_sw()</a>.</p>

</div>
</div>
<a id="af174fea4281252e1cf87c621ab532aeb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af174fea4281252e1cf87c621ab532aeb">&#9670;&nbsp;</a></span>num_aeroes</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int AerRadProps::num_aeroes</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classAerRadProps.html#a4d708a6b6284e41f8dce29444416c810">initialize()</a>.</p>

</div>
</div>
<a id="a1bf28a8f87d617095d3cf88cf7ef738e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1bf28a8f87d617095d3cf88cf7ef738e">&#9670;&nbsp;</a></span>pdeldry</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real2d AerRadProps::pdeldry</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classAerRadProps.html#a6aabfa89e9a9d91bae79c7a0d91f17b3">aer_rad_props_lw()</a>, <a class="el" href="classAerRadProps.html#a433097bd85637100b16f3e120e9d6fa1">aer_rad_props_sw()</a>, and <a class="el" href="classAerRadProps.html#a4d708a6b6284e41f8dce29444416c810">initialize()</a>.</p>

</div>
</div>
<a id="ab56e110ccf8deaa71d452a64e69b8647"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab56e110ccf8deaa71d452a64e69b8647">&#9670;&nbsp;</a></span>pmid</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real2d AerRadProps::pmid</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classAerRadProps.html#a6aabfa89e9a9d91bae79c7a0d91f17b3">aer_rad_props_lw()</a>, <a class="el" href="classAerRadProps.html#a433097bd85637100b16f3e120e9d6fa1">aer_rad_props_sw()</a>, and <a class="el" href="classAerRadProps.html#a4d708a6b6284e41f8dce29444416c810">initialize()</a>.</p>

</div>
</div>
<a id="a837035712a214f1b8daf7a4d30727e6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a837035712a214f1b8daf7a4d30727e6d">&#9670;&nbsp;</a></span>qt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real2d AerRadProps::qt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classAerRadProps.html#a6aabfa89e9a9d91bae79c7a0d91f17b3">aer_rad_props_lw()</a>, <a class="el" href="classAerRadProps.html#a433097bd85637100b16f3e120e9d6fa1">aer_rad_props_sw()</a>, and <a class="el" href="classAerRadProps.html#a4d708a6b6284e41f8dce29444416c810">initialize()</a>.</p>

</div>
</div>
<a id="a0690511bbea6225a4afa365c4c153f0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0690511bbea6225a4afa365c4c153f0c">&#9670;&nbsp;</a></span>ssa_cmip6_sw</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real3d AerRadProps::ssa_cmip6_sw</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classAerRadProps.html#a433097bd85637100b16f3e120e9d6fa1">aer_rad_props_sw()</a>, and <a class="el" href="classAerRadProps.html#aa4241f4adcf62ef3c537a91bdfce66db">volcanic_cmip_sw()</a>.</p>

</div>
</div>
<a id="a0a03391413de1fcd9ea2550fea907b33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a03391413de1fcd9ea2550fea907b33">&#9670;&nbsp;</a></span>temp</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real2d AerRadProps::temp</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classAerRadProps.html#a6aabfa89e9a9d91bae79c7a0d91f17b3">aer_rad_props_lw()</a>, <a class="el" href="classAerRadProps.html#a433097bd85637100b16f3e120e9d6fa1">aer_rad_props_sw()</a>, and <a class="el" href="classAerRadProps.html#a4d708a6b6284e41f8dce29444416c810">initialize()</a>.</p>

</div>
</div>
<a id="a83216edbd2d57b575f1869df38a1b668"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83216edbd2d57b575f1869df38a1b668">&#9670;&nbsp;</a></span>top_lev</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int AerRadProps::top_lev</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classAerRadProps.html#a6aabfa89e9a9d91bae79c7a0d91f17b3">aer_rad_props_lw()</a>, <a class="el" href="classAerRadProps.html#a433097bd85637100b16f3e120e9d6fa1">aer_rad_props_sw()</a>, and <a class="el" href="classAerRadProps.html#a4d708a6b6284e41f8dce29444416c810">initialize()</a>.</p>

</div>
</div>
<a id="ac82b4bf91bb3a23e33074e00381388e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac82b4bf91bb3a23e33074e00381388e3">&#9670;&nbsp;</a></span>zi</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real2d AerRadProps::zi</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classAerRadProps.html#a6aabfa89e9a9d91bae79c7a0d91f17b3">aer_rad_props_lw()</a>, <a class="el" href="classAerRadProps.html#a433097bd85637100b16f3e120e9d6fa1">aer_rad_props_sw()</a>, <a class="el" href="classAerRadProps.html#a4d708a6b6284e41f8dce29444416c810">initialize()</a>, and <a class="el" href="classAerRadProps.html#aa4241f4adcf62ef3c537a91bdfce66db">volcanic_cmip_sw()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>Source/Radiation/<a class="el" href="Aero__rad__props_8H_source.html">Aero_rad_props.H</a></li>
<li>Source/Radiation/<a class="el" href="Aero__rad__props_8cpp.html">Aero_rad_props.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classAerRadProps.html">AerRadProps</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
