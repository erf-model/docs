<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ERF: ERF Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ERF
   </div>
   <div id="projectbrief">Energy Research and Forecasting: An Atmospheric Modeling Code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('classERF.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-static-methods">Static Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="#pri-static-attribs">Static Private Attributes</a> &#124;
<a href="classERF-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">ERF Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="ERF_8H_source.html">ERF.H</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for ERF:</div>
<div class="dyncontent">
<div class="center"><img src="classERF__inherit__graph.png" border="0" usemap="#aERF_inherit__map" alt="Inheritance graph"/></div>
<map name="aERF_inherit__map" id="aERF_inherit__map">
<area shape="rect" title=" " alt="" coords="47,80,93,107"/>
<area shape="rect" title=" " alt="" coords="5,5,135,32"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for ERF:</div>
<div class="dyncontent">
<div class="center"><img src="classERF__coll__graph.png" border="0" usemap="#aERF_coll__map" alt="Collaboration graph"/></div>
<map name="aERF_coll__map" id="aERF_coll__map">
<area shape="rect" title=" " alt="" coords="852,2326,899,2353"/>
<area shape="rect" title=" " alt="" coords="464,17,593,43"/>
<area shape="rect" title=" " alt="" coords="425,317,632,343"/>
<area shape="rect" title=" " alt="" coords="26,199,183,226"/>
<area shape="rect" title=" " alt="" coords="426,68,631,109"/>
<area shape="rect" title=" " alt="" coords="425,133,632,175"/>
<area shape="rect" title=" " alt="" coords="411,199,646,226"/>
<area shape="rect" title=" " alt="" coords="435,251,623,292"/>
<area shape="rect" title=" " alt="" coords="425,367,632,423"/>
<area shape="rect" title=" " alt="" coords="442,447,615,503"/>
<area shape="rect" title=" " alt="" coords="403,527,655,554"/>
<area shape="rect" title=" " alt="" coords="443,579,614,620"/>
<area shape="rect" title=" " alt="" coords="427,644,630,685"/>
<area shape="rect" title=" " alt="" coords="433,710,624,766"/>
<area shape="rect" title=" " alt="" coords="468,790,589,817"/>
<area shape="rect" title=" " alt="" coords="415,841,642,867"/>
<area shape="rect" title=" " alt="" coords="421,892,637,933"/>
<area shape="rect" title=" " alt="" coords="436,957,621,1028"/>
<area shape="rect" title=" " alt="" coords="444,1052,613,1093"/>
<area shape="rect" title=" " alt="" coords="79,1343,130,1370"/>
<area shape="rect" href="structSolverChoice.html" title=" " alt="" coords="475,1746,582,1773"/>
<area shape="rect" href="structInputSoundingData.html" title=" " alt="" coords="455,2509,602,2535"/>
<area shape="rect" title=" " alt="" coords="443,2740,615,2781"/>
<area shape="rect" title=" " alt="" coords="14,1720,195,1761"/>
<area shape="rect" title=" " alt="" coords="85,1577,124,1603"/>
<area shape="rect" title=" " alt="" coords="79,2058,130,2085"/>
<area shape="rect" title=" " alt="" coords="61,2145,148,2171"/>
<area shape="rect" href="classLandSurface.html" title=" " alt="" coords="477,2127,580,2154"/>
<area shape="rect" title=" " alt="" coords="449,2806,608,2833"/>
<area shape="rect" title=" " alt="" coords="446,2857,611,2899"/>
<area shape="rect" title=" " alt="" coords="19,2659,191,2686"/>
<area shape="rect" title=" " alt="" coords="22,2436,187,2477"/>
<area shape="rect" title=" " alt="" coords="490,2923,567,2950"/>
<area shape="rect" title=" " alt="" coords="436,2974,621,3030"/>
<area shape="rect" title=" " alt="" coords="435,3054,623,3081"/>
<area shape="rect" title=" " alt="" coords="433,3105,624,3161"/>
<area shape="rect" title=" " alt="" coords="5,2294,204,2321"/>
<area shape="rect" title=" " alt="" coords="443,3185,614,3241"/>
<area shape="rect" title=" " alt="" coords="437,3265,620,3307"/>
<area shape="rect" title=" " alt="" coords="443,3331,614,3387"/>
<area shape="rect" title=" " alt="" coords="473,3411,584,3438"/>
<area shape="rect" title=" " alt="" coords="438,3463,619,3504"/>
<area shape="rect" title=" " alt="" coords="444,3528,613,3569"/>
<area shape="rect" title=" " alt="" coords="431,3593,626,3664"/>
<area shape="rect" title=" " alt="" coords="430,3727,627,3768"/>
<area shape="rect" title=" " alt="" coords="419,3792,638,3833"/>
<area shape="rect" title=" " alt="" coords="436,3858,621,3885"/>
<area shape="rect" title=" " alt="" coords="436,3927,621,3954"/>
<area shape="rect" title=" " alt="" coords="421,3979,637,4020"/>
<area shape="rect" title=" " alt="" coords="444,4044,613,4085"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a30129012dd367825e5e4fd1406694f58"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a30129012dd367825e5e4fd1406694f58">ERF</a> ()</td></tr>
<tr class="separator:a30129012dd367825e5e4fd1406694f58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30901583bd41e7bf4dddb3c1ea329dfe"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a30901583bd41e7bf4dddb3c1ea329dfe">~ERF</a> () override</td></tr>
<tr class="separator:a30901583bd41e7bf4dddb3c1ea329dfe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13fc8f3a00573ee7735c3228316164a9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a13fc8f3a00573ee7735c3228316164a9">ERF</a> (<a class="el" href="classERF.html">ERF</a> &amp;&amp;) noexcept=delete</td></tr>
<tr class="separator:a13fc8f3a00573ee7735c3228316164a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbc40e6fe700b80e3666dd3723624f05"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classERF.html">ERF</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#abbc40e6fe700b80e3666dd3723624f05">operator=</a> (<a class="el" href="classERF.html">ERF</a> &amp;&amp;other) noexcept=delete</td></tr>
<tr class="separator:abbc40e6fe700b80e3666dd3723624f05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4f5db4e6643e9ebc8ffeebcbca3978a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#af4f5db4e6643e9ebc8ffeebcbca3978a">ERF</a> (const <a class="el" href="classERF.html">ERF</a> &amp;other)=delete</td></tr>
<tr class="separator:af4f5db4e6643e9ebc8ffeebcbca3978a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72fcc41d6f5225e9ca3b8c9111ff37e7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classERF.html">ERF</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a72fcc41d6f5225e9ca3b8c9111ff37e7">operator=</a> (const <a class="el" href="classERF.html">ERF</a> &amp;other)=delete</td></tr>
<tr class="separator:a72fcc41d6f5225e9ca3b8c9111ff37e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0be12798b46f52fa4b5a995f147c3f96"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a0be12798b46f52fa4b5a995f147c3f96">Evolve</a> ()</td></tr>
<tr class="separator:a0be12798b46f52fa4b5a995f147c3f96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18e6dbbf968b4492e78aa427791620f4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a18e6dbbf968b4492e78aa427791620f4">ErrorEst</a> (int lev, amrex::TagBoxArray &amp;tags, amrex::Real time, int ngrow) override</td></tr>
<tr class="separator:a18e6dbbf968b4492e78aa427791620f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5d585e110291969767013a515719224"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ad5d585e110291969767013a515719224">InitData</a> ()</td></tr>
<tr class="separator:ad5d585e110291969767013a515719224"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80981e20939a6a38ba17478da2253ff1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a80981e20939a6a38ba17478da2253ff1">init_only</a> (int lev, amrex::Real time)</td></tr>
<tr class="separator:a80981e20939a6a38ba17478da2253ff1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a530d2ce59e6fd46e9fb00e4d11eaf737"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a530d2ce59e6fd46e9fb00e4d11eaf737">restart</a> ()</td></tr>
<tr class="separator:a530d2ce59e6fd46e9fb00e4d11eaf737"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2e4de4eaa0f93149c1aefd58dc7068a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#af2e4de4eaa0f93149c1aefd58dc7068a">writeNow</a> (const amrex::Real cur_time, const amrex::Real <a class="el" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>, const int nstep, const int plot_int, const amrex::Real plot_per)</td></tr>
<tr class="separator:af2e4de4eaa0f93149c1aefd58dc7068a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58f6683aff0fbe6949bfe8b49275a8b3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a58f6683aff0fbe6949bfe8b49275a8b3">post_timestep</a> (int nstep, amrex::Real time, amrex::Real dt_lev)</td></tr>
<tr class="separator:a58f6683aff0fbe6949bfe8b49275a8b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a922892a05ee0c5bccd210a3e5a8599e1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a922892a05ee0c5bccd210a3e5a8599e1">sum_integrated_quantities</a> (amrex::Real time)</td></tr>
<tr class="separator:a922892a05ee0c5bccd210a3e5a8599e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55eae94c5363e227b571739738bb26b7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a55eae94c5363e227b571739738bb26b7">write_1D_profiles</a> (amrex::Real time)</td></tr>
<tr class="separator:a55eae94c5363e227b571739738bb26b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39efa3a0f3ae3deb7a43f4ce110ee49a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a39efa3a0f3ae3deb7a43f4ce110ee49a">write_1D_profiles_stag</a> (amrex::Real time)</td></tr>
<tr class="separator:a39efa3a0f3ae3deb7a43f4ce110ee49a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa28182226262c67cfd686d35bfeabcad"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aa28182226262c67cfd686d35bfeabcad">sample_points</a> (int lev, amrex::Real time, amrex::IntVect cell, amrex::MultiFab &amp;mf)</td></tr>
<tr class="separator:aa28182226262c67cfd686d35bfeabcad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb798c72ea4fde6f4da8d01a24c8c165"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#afb798c72ea4fde6f4da8d01a24c8c165">sample_lines</a> (int lev, amrex::Real time, amrex::IntVect cell, amrex::MultiFab &amp;mf)</td></tr>
<tr class="separator:afb798c72ea4fde6f4da8d01a24c8c165"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07f151e7fbc8aa6c4ac8b52bd4c49e2e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a07f151e7fbc8aa6c4ac8b52bd4c49e2e">derive_diag_profiles</a> (amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_u, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_v, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_w, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_rho, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_th, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_ksgs, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_uu, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_uv, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_uw, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_vv, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_vw, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_ww, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_uth, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_vth, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_wth, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_thth, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_ku, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_kv, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_kw, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_p, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_pu, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_pv, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_pw)</td></tr>
<tr class="separator:a07f151e7fbc8aa6c4ac8b52bd4c49e2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e3bb984f352bb1b0887d4cf88bc7139"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a8e3bb984f352bb1b0887d4cf88bc7139">derive_diag_profiles_stag</a> (amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_u, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_v, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_w, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_rho, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_th, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_ksgs, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_uu, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_uv, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_uw, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_vv, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_vw, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_ww, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_uth, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_vth, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_wth, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_thth, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_ku, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_kv, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_kw, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_p, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_pu, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_pv, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_pw)</td></tr>
<tr class="separator:a8e3bb984f352bb1b0887d4cf88bc7139"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f0aaad01835b2f1ce8f42112877ef47"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a0f0aaad01835b2f1ce8f42112877ef47">derive_stress_profiles</a> (amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_tau11, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_tau12, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_tau13, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_tau22, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_tau23, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_tau33, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_hfx3, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_diss)</td></tr>
<tr class="separator:a0f0aaad01835b2f1ce8f42112877ef47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1d539b1b91119c61ec5d3efd2897cc9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aa1d539b1b91119c61ec5d3efd2897cc9">derive_stress_profiles_stag</a> (amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_tau11, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_tau12, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_tau13, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_tau22, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_tau23, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_tau33, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_hfx3, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_diss)</td></tr>
<tr class="separator:aa1d539b1b91119c61ec5d3efd2897cc9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae959fa22a0c888a6da28d385054edf82"><td class="memItemLeft" align="right" valign="top">amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ae959fa22a0c888a6da28d385054edf82">volWgtSumMF</a> (int lev, const amrex::MultiFab &amp;mf, int comp, const amrex::MultiFab &amp;mapfac, bool local, bool finemask)</td></tr>
<tr class="separator:ae959fa22a0c888a6da28d385054edf82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb6175c28b36d23f5dda2994ca4a85e7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#abb6175c28b36d23f5dda2994ca4a85e7">MakeNewLevelFromCoarse</a> (int lev, amrex::Real time, const amrex::BoxArray &amp;ba, const amrex::DistributionMapping &amp;dm) override</td></tr>
<tr class="separator:abb6175c28b36d23f5dda2994ca4a85e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae7a3a76e08e54c618cf79b30ed2d73d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aae7a3a76e08e54c618cf79b30ed2d73d">RemakeLevel</a> (int lev, amrex::Real time, const amrex::BoxArray &amp;ba, const amrex::DistributionMapping &amp;dm) override</td></tr>
<tr class="separator:aae7a3a76e08e54c618cf79b30ed2d73d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac44e400a7ce68e18fa44e9416cb1344e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ac44e400a7ce68e18fa44e9416cb1344e">ClearLevel</a> (int lev) override</td></tr>
<tr class="separator:ac44e400a7ce68e18fa44e9416cb1344e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf10bbf8c9a5dbc257a88c4c1b650fee"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aaf10bbf8c9a5dbc257a88c4c1b650fee">MakeNewLevelFromScratch</a> (int lev, amrex::Real time, const amrex::BoxArray &amp;ba, const amrex::DistributionMapping &amp;dm) override</td></tr>
<tr class="separator:aaf10bbf8c9a5dbc257a88c4c1b650fee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b1d727e63de2e49aa4f8e00b0dda1d5"><td class="memItemLeft" align="right" valign="top">amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a6b1d727e63de2e49aa4f8e00b0dda1d5">estTimeStep</a> (int lev, long &amp;dt_fast_ratio) const</td></tr>
<tr class="separator:a6b1d727e63de2e49aa4f8e00b0dda1d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9068176f45cea5fdbbbf3c8eb08bd808"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a9068176f45cea5fdbbbf3c8eb08bd808">advance_dycore</a> (int level, amrex::Vector&lt; amrex::MultiFab &gt; &amp;state_old, amrex::Vector&lt; amrex::MultiFab &gt; &amp;state_new, amrex::MultiFab &amp;xvel_old, amrex::MultiFab &amp;yvel_old, amrex::MultiFab &amp;zvel_old, amrex::MultiFab &amp;xvel_new, amrex::MultiFab &amp;yvel_new, amrex::MultiFab &amp;zvel_new, amrex::MultiFab &amp;source, amrex::MultiFab &amp;buoyancy, amrex::Geometry fine_geom, amrex::Real <a class="el" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>, amrex::Real time)</td></tr>
<tr class="separator:a9068176f45cea5fdbbbf3c8eb08bd808"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87c9bb3f5c35218b85024312261b098c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a87c9bb3f5c35218b85024312261b098c">advance_microphysics</a> (int lev, amrex::MultiFab &amp;cons_in, const amrex::Real &amp;dt_advance)</td></tr>
<tr class="separator:a87c9bb3f5c35218b85024312261b098c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3f83ba16254a0efd4395900cef97efc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ac3f83ba16254a0efd4395900cef97efc">advance_lsm</a> (int lev, amrex::MultiFab &amp;, const amrex::Real &amp;dt_advance)</td></tr>
<tr class="separator:ac3f83ba16254a0efd4395900cef97efc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af46289079e053a6d74ddef0bf1a5d8a3"><td class="memItemLeft" align="right" valign="top">amrex::MultiFab &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#af46289079e053a6d74ddef0bf1a5d8a3">build_fine_mask</a> (int lev)</td></tr>
<tr class="separator:af46289079e053a6d74ddef0bf1a5d8a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01987b2556834788694f2f3741a2afe4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a01987b2556834788694f2f3741a2afe4">MakeHorizontalAverages</a> ()</td></tr>
<tr class="separator:a01987b2556834788694f2f3741a2afe4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93ed2dd2c2441da6853d6f48b6467324"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a93ed2dd2c2441da6853d6f48b6467324">MakeDiagnosticAverage</a> (amrex::Vector&lt; amrex::Real &gt; &amp;h_havg, amrex::MultiFab &amp;S, int n)</td></tr>
<tr class="separator:a93ed2dd2c2441da6853d6f48b6467324"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1981699bedbbfd6785f26ca340a74d8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#af1981699bedbbfd6785f26ca340a74d8">derive_upwp</a> (amrex::Vector&lt; amrex::Real &gt; &amp;h_havg)</td></tr>
<tr class="separator:af1981699bedbbfd6785f26ca340a74d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b0b4140e117163895e5e2c89a68d12a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a0b0b4140e117163895e5e2c89a68d12a">WritePlotFile</a> (int which, amrex::Vector&lt; std::string &gt; plot_var_names)</td></tr>
<tr class="separator:a0b0b4140e117163895e5e2c89a68d12a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a898410553492b2add00a72374dcec6ba"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a898410553492b2add00a72374dcec6ba">WriteMultiLevelPlotfileWithTerrain</a> (const std::string &amp;plotfilename, int nlevels, const amrex::Vector&lt; const amrex::MultiFab * &gt; &amp;mf, const amrex::Vector&lt; const amrex::MultiFab * &gt; &amp;mf_nd, const amrex::Vector&lt; std::string &gt; &amp;varnames, amrex::Real time, const amrex::Vector&lt; int &gt; &amp;level_steps, const std::string &amp;versionName=&quot;HyperCLaw-V1.1&quot;, const std::string &amp;levelPrefix=&quot;Level_&quot;, const std::string &amp;mfPrefix=&quot;Cell&quot;, const amrex::Vector&lt; std::string &gt; &amp;extra_dirs=amrex::Vector&lt; std::string &gt;()) const</td></tr>
<tr class="separator:a898410553492b2add00a72374dcec6ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16e49fd65c68e2afc2140bd9e97bcbe9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a16e49fd65c68e2afc2140bd9e97bcbe9">WriteGenericPlotfileHeaderWithTerrain</a> (std::ostream &amp;HeaderFile, int nlevels, const amrex::Vector&lt; amrex::BoxArray &gt; &amp;bArray, const amrex::Vector&lt; std::string &gt; &amp;varnames, amrex::Real time, const amrex::Vector&lt; int &gt; &amp;level_steps, const std::string &amp;versionName, const std::string &amp;levelPrefix, const std::string &amp;mfPrefix) const</td></tr>
<tr class="separator:a16e49fd65c68e2afc2140bd9e97bcbe9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f4902e264ff9b48001461c3555c0590"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a1f4902e264ff9b48001461c3555c0590">erf_enforce_hse</a> (int lev, amrex::MultiFab &amp;dens, amrex::MultiFab &amp;pres, amrex::MultiFab &amp;pi, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;z_cc, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;z_nd)</td></tr>
<tr class="separator:a1f4902e264ff9b48001461c3555c0590"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2908bcd920ab5e3fef171a37302853ec"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a2908bcd920ab5e3fef171a37302853ec">init_from_input_sounding</a> (int lev)</td></tr>
<tr class="separator:a2908bcd920ab5e3fef171a37302853ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a857a8f76768ec4451b995cbf4f4ac176"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a857a8f76768ec4451b995cbf4f4ac176">init_from_hse</a> (int lev)</td></tr>
<tr class="separator:a857a8f76768ec4451b995cbf4f4ac176"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2135641de33dea5057799569c74cac42"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a2135641de33dea5057799569c74cac42">fill_from_bndryregs</a> (const amrex::Vector&lt; amrex::MultiFab * &gt; &amp;mfs, amrex::Real time)</td></tr>
<tr class="separator:a2135641de33dea5057799569c74cac42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae17524f168760cf435685a08d97480e7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ae17524f168760cf435685a08d97480e7">AverageDownTo</a> (int crse_lev, int scomp, int ncomp)</td></tr>
<tr class="separator:ae17524f168760cf435685a08d97480e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2d8099655a8779836e63e3e98ea4372"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aa2d8099655a8779836e63e3e98ea4372">writeJobInfo</a> (const std::string &amp;dir) const</td></tr>
<tr class="separator:aa2d8099655a8779836e63e3e98ea4372"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:ad4c61fad53912d1e8d0f774d365bcf0f"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ad4c61fad53912d1e8d0f774d365bcf0f">is_it_time_for_action</a> (int nstep, amrex::Real time, amrex::Real <a class="el" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>, int action_interval, amrex::Real action_per)</td></tr>
<tr class="separator:ad4c61fad53912d1e8d0f774d365bcf0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6afed5b3a72ca80ccf0d791b08516aa"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ae6afed5b3a72ca80ccf0d791b08516aa">writeBuildInfo</a> (std::ostream &amp;os)</td></tr>
<tr class="separator:ae6afed5b3a72ca80ccf0d791b08516aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a8eb6bc00080cdbd8df28f6a321ac72"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a1a8eb6bc00080cdbd8df28f6a321ac72">print_banner</a> (MPI_Comm, std::ostream &amp;)</td></tr>
<tr class="separator:a1a8eb6bc00080cdbd8df28f6a321ac72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeaeb11001478b0635ef0fe3baa396df1"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aeaeb11001478b0635ef0fe3baa396df1">print_usage</a> (MPI_Comm, std::ostream &amp;)</td></tr>
<tr class="separator:aeaeb11001478b0635ef0fe3baa396df1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addc510dbf758a33cc095d64a9b17076c"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#addc510dbf758a33cc095d64a9b17076c">print_error</a> (MPI_Comm, const std::string &amp;msg)</td></tr>
<tr class="separator:addc510dbf758a33cc095d64a9b17076c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa432756254529fb37b921088f0960d2"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#afa432756254529fb37b921088f0960d2">print_summary</a> (std::ostream &amp;)</td></tr>
<tr class="separator:afa432756254529fb37b921088f0960d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15af18ae136cf3a11bb63fe0cf3924c8"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a15af18ae136cf3a11bb63fe0cf3924c8">print_tpls</a> (std::ostream &amp;)</td></tr>
<tr class="separator:a15af18ae136cf3a11bb63fe0cf3924c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a59df30e7a5537c8543bb00772bd98b58"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a59df30e7a5537c8543bb00772bd98b58">pp_prefix</a> {&quot;erf&quot;}</td></tr>
<tr class="separator:a59df30e7a5537c8543bb00772bd98b58"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a2d39cd3bdc3d90609ad3b14e266d190a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a2d39cd3bdc3d90609ad3b14e266d190a">ReadParameters</a> ()</td></tr>
<tr class="separator:a2d39cd3bdc3d90609ad3b14e266d190a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8202de1f8f372e3e6fdc483447c6a55f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a8202de1f8f372e3e6fdc483447c6a55f">AverageDown</a> ()</td></tr>
<tr class="separator:a8202de1f8f372e3e6fdc483447c6a55f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a419510fced05e9afc05c466beeeb66f7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a419510fced05e9afc05c466beeeb66f7">update_diffusive_arrays</a> (int lev, const amrex::BoxArray &amp;ba, const amrex::DistributionMapping &amp;dm)</td></tr>
<tr class="separator:a419510fced05e9afc05c466beeeb66f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a900a0119c110486650f2759287e22cba"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a900a0119c110486650f2759287e22cba">update_terrain_arrays</a> (int lev, amrex::Real time)</td></tr>
<tr class="separator:a900a0119c110486650f2759287e22cba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc284f421c5fd9dd15c0e5cbe4ff5fc8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#adc284f421c5fd9dd15c0e5cbe4ff5fc8">Construct_ERFFillPatchers</a> (int lev)</td></tr>
<tr class="separator:adc284f421c5fd9dd15c0e5cbe4ff5fc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0951404aa6802aad7a3be6b7375dfa2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ac0951404aa6802aad7a3be6b7375dfa2">Define_ERFFillPatchers</a> (int lev)</td></tr>
<tr class="separator:ac0951404aa6802aad7a3be6b7375dfa2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7261c4eb7722af0dfe6cdfb8e2e9e4db"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a7261c4eb7722af0dfe6cdfb8e2e9e4db">init1DArrays</a> ()</td></tr>
<tr class="separator:a7261c4eb7722af0dfe6cdfb8e2e9e4db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a618e8fdff3239cc79d4145d02b1ecaa2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a618e8fdff3239cc79d4145d02b1ecaa2">init_bcs</a> ()</td></tr>
<tr class="separator:a618e8fdff3239cc79d4145d02b1ecaa2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a604939a8058f7efa36a427adb889739c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a604939a8058f7efa36a427adb889739c">init_custom</a> (int lev)</td></tr>
<tr class="separator:a604939a8058f7efa36a427adb889739c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae618963cf90e247b72fbd71d5b13599d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ae618963cf90e247b72fbd71d5b13599d">init_uniform</a> (int lev)</td></tr>
<tr class="separator:ae618963cf90e247b72fbd71d5b13599d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5160b1e054b3e2a09c26274ef3551c64"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a5160b1e054b3e2a09c26274ef3551c64">init_stuff</a> (int lev, const amrex::BoxArray &amp;ba, const amrex::DistributionMapping &amp;dm)</td></tr>
<tr class="separator:a5160b1e054b3e2a09c26274ef3551c64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5600f8ce250d4811012719fdf5e85f00"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a5600f8ce250d4811012719fdf5e85f00">initialize_integrator</a> (int lev, amrex::MultiFab &amp;cons_mf, amrex::MultiFab &amp;vel_mf)</td></tr>
<tr class="separator:a5600f8ce250d4811012719fdf5e85f00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc2898daad269536c1a15443abf3fa75"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#afc2898daad269536c1a15443abf3fa75">initializeMicrophysics</a> (const int &amp;)</td></tr>
<tr class="separator:afc2898daad269536c1a15443abf3fa75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8de69f537859f576fba1d94844cfbd33"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a8de69f537859f576fba1d94844cfbd33">FillPatch</a> (int lev, amrex::Real time, const amrex::Vector&lt; amrex::MultiFab * &gt; &amp;mfs_vel, const amrex::Vector&lt; amrex::MultiFab * &gt; &amp;mfs_mom, bool fillset=true, bool cons_only=false)</td></tr>
<tr class="separator:a8de69f537859f576fba1d94844cfbd33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb39caf6b6949138c0c3c4a067648321"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#afb39caf6b6949138c0c3c4a067648321">FillPatchMoistVars</a> (int lev, amrex::MultiFab &amp;mf)</td></tr>
<tr class="separator:afb39caf6b6949138c0c3c4a067648321"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5434c771d76cf50e4a0dd9e1b0eb27fc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a5434c771d76cf50e4a0dd9e1b0eb27fc">FillIntermediatePatch</a> (int lev, amrex::Real time, const amrex::Vector&lt; amrex::MultiFab * &gt; &amp;mfs_vel, const amrex::Vector&lt; amrex::MultiFab * &gt; &amp;mfs_mom, int ng_cons, int ng_vel, bool cons_only, int icomp_cons, int ncomp_cons, bool allow_most_bcs=true)</td></tr>
<tr class="separator:a5434c771d76cf50e4a0dd9e1b0eb27fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4497025ab94461899960ee067c2c72a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ac4497025ab94461899960ee067c2c72a">FillCoarsePatch</a> (int lev, amrex::Real time)</td></tr>
<tr class="separator:ac4497025ab94461899960ee067c2c72a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff397ccf7eb99c51d7c705a35e85ec5f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aff397ccf7eb99c51d7c705a35e85ec5f">timeStep</a> (int lev, amrex::Real time, int iteration)</td></tr>
<tr class="separator:aff397ccf7eb99c51d7c705a35e85ec5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47413fe5588f7dd71a1d5087a9e804f9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a47413fe5588f7dd71a1d5087a9e804f9">Advance</a> (int lev, amrex::Real time, amrex::Real dt_lev, int iteration, int ncycle)</td></tr>
<tr class="separator:a47413fe5588f7dd71a1d5087a9e804f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92c020bfaa43e40fb5ffc449427a0318"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a92c020bfaa43e40fb5ffc449427a0318">initHSE</a> ()</td></tr>
<tr class="memdesc:a92c020bfaa43e40fb5ffc449427a0318"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize HSE.  <a href="classERF.html#a92c020bfaa43e40fb5ffc449427a0318">More...</a><br /></td></tr>
<tr class="separator:a92c020bfaa43e40fb5ffc449427a0318"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69c8fce3b0f5b28e98240599c2ee16bb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a69c8fce3b0f5b28e98240599c2ee16bb">initHSE</a> (int lev)</td></tr>
<tr class="separator:a69c8fce3b0f5b28e98240599c2ee16bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a039a764a1d942c484e8aea49e87bc046"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a039a764a1d942c484e8aea49e87bc046">initRayleigh</a> ()</td></tr>
<tr class="memdesc:a039a764a1d942c484e8aea49e87bc046"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize Rayleigh damping profiles.  <a href="classERF.html#a039a764a1d942c484e8aea49e87bc046">More...</a><br /></td></tr>
<tr class="separator:a039a764a1d942c484e8aea49e87bc046"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0877d5a0263641c13b92d2d16f47b689"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a0877d5a0263641c13b92d2d16f47b689">setRayleighRefFromSounding</a> (bool restarting)</td></tr>
<tr class="memdesc:a0877d5a0263641c13b92d2d16f47b689"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set Rayleigh mean profiles from input sounding.  <a href="classERF.html#a0877d5a0263641c13b92d2d16f47b689">More...</a><br /></td></tr>
<tr class="separator:a0877d5a0263641c13b92d2d16f47b689"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62a5ed3c3806eaa918257e0ad1382df5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a62a5ed3c3806eaa918257e0ad1382df5">ComputeDt</a> ()</td></tr>
<tr class="separator:a62a5ed3c3806eaa918257e0ad1382df5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54f6c5d799e51521ad10bb57d29d0c44"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a54f6c5d799e51521ad10bb57d29d0c44">PlotFileName</a> (int lev) const</td></tr>
<tr class="separator:a54f6c5d799e51521ad10bb57d29d0c44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1fcb440c67da60c86372aec1fe871cb7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a1fcb440c67da60c86372aec1fe871cb7">setPlotVariables</a> (const std::string &amp;pp_plot_var_names, amrex::Vector&lt; std::string &gt; &amp;plot_var_names)</td></tr>
<tr class="separator:a1fcb440c67da60c86372aec1fe871cb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7758f75dc7c9029eddc4c58ac0567654"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a7758f75dc7c9029eddc4c58ac0567654">appendPlotVariables</a> (const std::string &amp;pp_plot_var_names, amrex::Vector&lt; std::string &gt; &amp;plot_var_names)</td></tr>
<tr class="separator:a7758f75dc7c9029eddc4c58ac0567654"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad101fd46096db2d6b21544bfede6551f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ad101fd46096db2d6b21544bfede6551f">WriteCheckpointFile</a> () const</td></tr>
<tr class="separator:ad101fd46096db2d6b21544bfede6551f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af285247b24b173cd851fe49799d17f42"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#af285247b24b173cd851fe49799d17f42">ReadCheckpointFile</a> ()</td></tr>
<tr class="separator:af285247b24b173cd851fe49799d17f42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e1874d47d95c7c858c2a2336fd0eee6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a2e1874d47d95c7c858c2a2336fd0eee6">InitializeFromFile</a> ()</td></tr>
<tr class="separator:a2e1874d47d95c7c858c2a2336fd0eee6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a914f576acc2d1a54203a220cce10df62"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a914f576acc2d1a54203a220cce10df62">InitializeLevelFromData</a> (int lev, const amrex::MultiFab &amp;initial_data)</td></tr>
<tr class="separator:a914f576acc2d1a54203a220cce10df62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adca0cddd75f33ecb5fb8e0ef9601dae4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#adca0cddd75f33ecb5fb8e0ef9601dae4">post_update</a> (amrex::MultiFab &amp;state_mf, amrex::Real time, const amrex::Geometry &amp;geom)</td></tr>
<tr class="separator:adca0cddd75f33ecb5fb8e0ef9601dae4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76600d7a4a0451c9727d2cc57dae4220"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a76600d7a4a0451c9727d2cc57dae4220">fill_rhs</a> (amrex::MultiFab &amp;rhs_mf, const amrex::MultiFab &amp;state_mf, amrex::Real time, const amrex::Geometry &amp;geom)</td></tr>
<tr class="separator:a76600d7a4a0451c9727d2cc57dae4220"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa90c9756f684404f8b69b8a23568b535"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aa90c9756f684404f8b69b8a23568b535">refinement_criteria_setup</a> ()</td></tr>
<tr class="separator:aa90c9756f684404f8b69b8a23568b535"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d6d990d8111c170692b1e9cc0e918b8"><td class="memItemLeft" align="right" valign="top">AMREX_FORCE_INLINE amrex::YAFluxRegister *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a4d6d990d8111c170692b1e9cc0e918b8">getAdvFluxReg</a> (int lev)</td></tr>
<tr class="separator:a4d6d990d8111c170692b1e9cc0e918b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2c3ee1910008b828b9da79ccdfe3871"><td class="memItemLeft" align="right" valign="top">AMREX_FORCE_INLINE std::ostream &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aa2c3ee1910008b828b9da79ccdfe3871">DataLog</a> (int i)</td></tr>
<tr class="separator:aa2c3ee1910008b828b9da79ccdfe3871"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1238c1616826c66df1dfd9076e6a3da"><td class="memItemLeft" align="right" valign="top">AMREX_FORCE_INLINE int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ac1238c1616826c66df1dfd9076e6a3da">NumDataLogs</a> () noexcept</td></tr>
<tr class="separator:ac1238c1616826c66df1dfd9076e6a3da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5f6c32cc5463e52901f21117d3156c7"><td class="memItemLeft" align="right" valign="top">AMREX_FORCE_INLINE std::ostream &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#af5f6c32cc5463e52901f21117d3156c7">SamplePointLog</a> (int i)</td></tr>
<tr class="separator:af5f6c32cc5463e52901f21117d3156c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41324a4b5610fde725fe721550b23c85"><td class="memItemLeft" align="right" valign="top">AMREX_FORCE_INLINE int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a41324a4b5610fde725fe721550b23c85">NumSamplePointLogs</a> () noexcept</td></tr>
<tr class="separator:a41324a4b5610fde725fe721550b23c85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa559426d0435e669b04148c58b20caef"><td class="memItemLeft" align="right" valign="top">AMREX_FORCE_INLINE std::ostream &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aa559426d0435e669b04148c58b20caef">SampleLineLog</a> (int i)</td></tr>
<tr class="separator:aa559426d0435e669b04148c58b20caef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14f922bdc3a0f23c087afa32c67ac119"><td class="memItemLeft" align="right" valign="top">AMREX_FORCE_INLINE int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a14f922bdc3a0f23c087afa32c67ac119">NumSampleLineLogs</a> () noexcept</td></tr>
<tr class="separator:a14f922bdc3a0f23c087afa32c67ac119"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9095d1b641b4d7f32ca5acb679786891"><td class="memItemLeft" align="right" valign="top">amrex::IntVect &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a9095d1b641b4d7f32ca5acb679786891">SamplePoint</a> (int i)</td></tr>
<tr class="separator:a9095d1b641b4d7f32ca5acb679786891"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5bc7dd2c7e1ebf65b7dc1d9bf0dfb36f"><td class="memItemLeft" align="right" valign="top">AMREX_FORCE_INLINE int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a5bc7dd2c7e1ebf65b7dc1d9bf0dfb36f">NumSamplePoints</a> () noexcept</td></tr>
<tr class="separator:a5bc7dd2c7e1ebf65b7dc1d9bf0dfb36f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54357e2f81f3d7d3a9189a3e21283e6b"><td class="memItemLeft" align="right" valign="top">amrex::IntVect &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a54357e2f81f3d7d3a9189a3e21283e6b">SampleLine</a> (int i)</td></tr>
<tr class="separator:a54357e2f81f3d7d3a9189a3e21283e6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70d78ca624acf09d8faab9a2d51264d9"><td class="memItemLeft" align="right" valign="top">AMREX_FORCE_INLINE int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a70d78ca624acf09d8faab9a2d51264d9">NumSampleLines</a> () noexcept</td></tr>
<tr class="separator:a70d78ca624acf09d8faab9a2d51264d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2486b49bb0d7917f812318822e42a03c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a2486b49bb0d7917f812318822e42a03c">setRecordDataInfo</a> (int i, const std::string &amp;filename)</td></tr>
<tr class="separator:a2486b49bb0d7917f812318822e42a03c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8d930dce1b926ecc3bdc6787dd47818"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#af8d930dce1b926ecc3bdc6787dd47818">setRecordSamplePointInfo</a> (int i, int lev, amrex::IntVect &amp;cell, const std::string &amp;filename)</td></tr>
<tr class="separator:af8d930dce1b926ecc3bdc6787dd47818"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1a8856961aaee53016122facba03dbe"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ae1a8856961aaee53016122facba03dbe">setRecordSampleLineInfo</a> (int i, int lev, amrex::IntVect &amp;cell, const std::string &amp;filename)</td></tr>
<tr class="separator:ae1a8856961aaee53016122facba03dbe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16e1f6b8bbb05ae738daf2abe626c159"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a16e1f6b8bbb05ae738daf2abe626c159">DataLogName</a> (int i) const noexcept</td></tr>
<tr class="memdesc:a16e1f6b8bbb05ae738daf2abe626c159"><td class="mdescLeft">&#160;</td><td class="mdescRight">The filename of the ith datalog file.  <a href="classERF.html#a16e1f6b8bbb05ae738daf2abe626c159">More...</a><br /></td></tr>
<tr class="separator:a16e1f6b8bbb05ae738daf2abe626c159"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa87242f053bfae4efb2a7698ef417ab9"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aa87242f053bfae4efb2a7698ef417ab9">SamplePointLogName</a> (int i) const noexcept</td></tr>
<tr class="memdesc:aa87242f053bfae4efb2a7698ef417ab9"><td class="mdescLeft">&#160;</td><td class="mdescRight">The filename of the ith sampleptlog file.  <a href="classERF.html#aa87242f053bfae4efb2a7698ef417ab9">More...</a><br /></td></tr>
<tr class="separator:aa87242f053bfae4efb2a7698ef417ab9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59eae161173111d66e88dc3acc65b552"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a59eae161173111d66e88dc3acc65b552">SampleLineLogName</a> (int i) const noexcept</td></tr>
<tr class="memdesc:a59eae161173111d66e88dc3acc65b552"><td class="mdescLeft">&#160;</td><td class="mdescRight">The filename of the ith samplelinelog file.  <a href="classERF.html#a59eae161173111d66e88dc3acc65b552">More...</a><br /></td></tr>
<tr class="separator:a59eae161173111d66e88dc3acc65b552"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-methods"></a>
Static Private Member Functions</h2></td></tr>
<tr class="memitem:a2dcd22cb915d923c687f60267f44542b"><td class="memItemLeft" align="right" valign="top">static amrex::Vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a2dcd22cb915d923c687f60267f44542b">PlotFileVarNames</a> (amrex::Vector&lt; std::string &gt; plot_var_names)</td></tr>
<tr class="separator:a2dcd22cb915d923c687f60267f44542b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaee255b031e63bd9b5807f6612739dbd"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aaee255b031e63bd9b5807f6612739dbd">GotoNextLine</a> (std::istream &amp;is)</td></tr>
<tr class="separator:aaee255b031e63bd9b5807f6612739dbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae68b1f54d196d0a4b19716d65a59d4c5"><td class="memItemLeft" align="right" valign="top">static AMREX_FORCE_INLINE int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ae68b1f54d196d0a4b19716d65a59d4c5">ComputeGhostCells</a> (const <a class="el" href="structAdvChoice.html">AdvChoice</a> &amp;advChoice, bool use_num_diff)</td></tr>
<tr class="separator:ae68b1f54d196d0a4b19716d65a59d4c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0597da6edf955cd138e52fd00380ff2"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ae0597da6edf955cd138e52fd00380ff2">getCPUTime</a> ()</td></tr>
<tr class="separator:ae0597da6edf955cd138e52fd00380ff2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a83572d8dfad51158945b4a5ab06b2f72"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structInputSoundingData.html">InputSoundingData</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a83572d8dfad51158945b4a5ab06b2f72">input_sounding_data</a></td></tr>
<tr class="separator:a83572d8dfad51158945b4a5ab06b2f72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46a3587ddcfacba35dcf52189cc1be86"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a46a3587ddcfacba35dcf52189cc1be86">min_k_at_level</a></td></tr>
<tr class="separator:a46a3587ddcfacba35dcf52189cc1be86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9108040a44e5e64853ac7d6529538315"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a9108040a44e5e64853ac7d6529538315">max_k_at_level</a></td></tr>
<tr class="separator:a9108040a44e5e64853ac7d6529538315"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60e8cb933f237903e3fbcd6376c26db0"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classProblemBase.html">ProblemBase</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a60e8cb933f237903e3fbcd6376c26db0">prob</a> = nullptr</td></tr>
<tr class="separator:a60e8cb933f237903e3fbcd6376c26db0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcd9f23975ffa605247b41d391c2a2f0"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#adcd9f23975ffa605247b41d391c2a2f0">num_boxes_at_level</a></td></tr>
<tr class="separator:adcd9f23975ffa605247b41d391c2a2f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a610a988f46e0496e6dbd0471ae817f75"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a610a988f46e0496e6dbd0471ae817f75">num_files_at_level</a></td></tr>
<tr class="separator:a610a988f46e0496e6dbd0471ae817f75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a050dbd236c9bf246554a53008e09f683"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Vector&lt; amrex::Box &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a050dbd236c9bf246554a53008e09f683">boxes_at_level</a></td></tr>
<tr class="separator:a050dbd236c9bf246554a53008e09f683"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefa640a036c25b7b770e88a5f838eb2a"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a></td></tr>
<tr class="separator:aefa640a036c25b7b770e88a5f838eb2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3db2dd1b65310c66c4038650c22aaee"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aa3db2dd1b65310c66c4038650c22aaee">nsubsteps</a></td></tr>
<tr class="separator:aa3db2dd1b65310c66c4038650c22aaee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65741b6379d273c19a25cf48bb947614"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a></td></tr>
<tr class="separator:a65741b6379d273c19a25cf48bb947614"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7085d7d5fc94a0f84efc06957267d58e"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a7085d7d5fc94a0f84efc06957267d58e">t_old</a></td></tr>
<tr class="separator:a7085d7d5fc94a0f84efc06957267d58e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad34bae243fdb6c3029f5abe4fb4bca2d"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a></td></tr>
<tr class="separator:ad34bae243fdb6c3029f5abe4fb4bca2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3cf7cb2e51eb7b69cb4079ffc6722459"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; long &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a3cf7cb2e51eb7b69cb4079ffc6722459">dt_mri_ratio</a></td></tr>
<tr class="separator:a3cf7cb2e51eb7b69cb4079ffc6722459"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1204ca4dc5d79f5da191ffbe09dfab9b"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Vector&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a></td></tr>
<tr class="separator:a1204ca4dc5d79f5da191ffbe09dfab9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af31e928baa970a1507dfb0233b352542"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Vector&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a></td></tr>
<tr class="separator:af31e928baa970a1507dfb0233b352542"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09d0fb2bd609c898a665d9530a744585"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; <a class="el" href="classMRISplitIntegrator.html">MRISplitIntegrator</a>&lt; amrex::Vector&lt; amrex::MultiFab &gt; &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a09d0fb2bd609c898a665d9530a744585">mri_integrator_mem</a></td></tr>
<tr class="separator:a09d0fb2bd609c898a665d9530a744585"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e9b04043853d25f2d76edbc0bed2e72"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; <a class="el" href="classERFPhysBCFunct__cons.html">ERFPhysBCFunct_cons</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a2e9b04043853d25f2d76edbc0bed2e72">physbcs_cons</a></td></tr>
<tr class="separator:a2e9b04043853d25f2d76edbc0bed2e72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64e55e5ae9df06433146db657eb9e72e"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; <a class="el" href="classERFPhysBCFunct__u.html">ERFPhysBCFunct_u</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a64e55e5ae9df06433146db657eb9e72e">physbcs_u</a></td></tr>
<tr class="separator:a64e55e5ae9df06433146db657eb9e72e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79231b5cfd4576a742e46ae0082b5121"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; <a class="el" href="classERFPhysBCFunct__v.html">ERFPhysBCFunct_v</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a79231b5cfd4576a742e46ae0082b5121">physbcs_v</a></td></tr>
<tr class="separator:a79231b5cfd4576a742e46ae0082b5121"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45c8ecd777f47732993777a0afb8e140"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; <a class="el" href="classERFPhysBCFunct__w.html">ERFPhysBCFunct_w</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a45c8ecd777f47732993777a0afb8e140">physbcs_w</a></td></tr>
<tr class="separator:a45c8ecd777f47732993777a0afb8e140"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d717bb9fe936fd1a124d0d3e720f9d1"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; <a class="el" href="classERFPhysBCFunct__w__no__terrain.html">ERFPhysBCFunct_w_no_terrain</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a4d717bb9fe936fd1a124d0d3e720f9d1">physbcs_w_no_terrain</a></td></tr>
<tr class="separator:a4d717bb9fe936fd1a124d0d3e720f9d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71629ae2fda396472198691b75d83b2e"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a71629ae2fda396472198691b75d83b2e">Theta_prim</a></td></tr>
<tr class="separator:a71629ae2fda396472198691b75d83b2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a521d1faf157e3bccc86c0f26ee923576"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a521d1faf157e3bccc86c0f26ee923576">Qv_prim</a></td></tr>
<tr class="separator:a521d1faf157e3bccc86c0f26ee923576"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6eecc44323f77917c95869928284f61d"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::MultiFab &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a6eecc44323f77917c95869928284f61d">rU_old</a></td></tr>
<tr class="separator:a6eecc44323f77917c95869928284f61d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01f3db32272f53dc68025f0a98195e57"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::MultiFab &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a01f3db32272f53dc68025f0a98195e57">rU_new</a></td></tr>
<tr class="separator:a01f3db32272f53dc68025f0a98195e57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb64e3b4def989ce68d873aefeed5e0e"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::MultiFab &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aeb64e3b4def989ce68d873aefeed5e0e">rV_old</a></td></tr>
<tr class="separator:aeb64e3b4def989ce68d873aefeed5e0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54e37988486ef96e55e84bd8e91bb688"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::MultiFab &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a54e37988486ef96e55e84bd8e91bb688">rV_new</a></td></tr>
<tr class="separator:a54e37988486ef96e55e84bd8e91bb688"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1fa56ec90f44e3cdf487af46804163f"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::MultiFab &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ac1fa56ec90f44e3cdf487af46804163f">rW_old</a></td></tr>
<tr class="separator:ac1fa56ec90f44e3cdf487af46804163f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa46c0b0d20525aed10f447923e54dde7"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::MultiFab &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aa46c0b0d20525aed10f447923e54dde7">rW_new</a></td></tr>
<tr class="separator:aa46c0b0d20525aed10f447923e54dde7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b7277d54649219f31fe286eee9d415a"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classMicrophysics.html">Microphysics</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a></td></tr>
<tr class="separator:a4b7277d54649219f31fe286eee9d415a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae00126a9c2738bf6a6cbbe77321c9cfc"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Vector&lt; amrex::MultiFab * &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ae00126a9c2738bf6a6cbbe77321c9cfc">qmoist</a></td></tr>
<tr class="separator:ae00126a9c2738bf6a6cbbe77321c9cfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e6f53a430ed3842f51fd569b908fa28"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::MultiFab &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a8e6f53a430ed3842f51fd569b908fa28">Nturb</a></td></tr>
<tr class="separator:a8e6f53a430ed3842f51fd569b908fa28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47c13e4cf7d4bd9b7b2be81886619fd9"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::MultiFab &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a47c13e4cf7d4bd9b7b2be81886619fd9">vars_fitch</a></td></tr>
<tr class="separator:a47c13e4cf7d4bd9b7b2be81886619fd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0e9a78f120ba632d78cbf23c97b851c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classLandSurface.html">LandSurface</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ae0e9a78f120ba632d78cbf23c97b851c">lsm</a></td></tr>
<tr class="separator:ae0e9a78f120ba632d78cbf23c97b851c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad03da3399e893728741fac33100ce476"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Vector&lt; amrex::MultiFab * &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ad03da3399e893728741fac33100ce476">lsm_data</a></td></tr>
<tr class="separator:ad03da3399e893728741fac33100ce476"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5f6a6ceae0087393f386649d8bbbc31"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Vector&lt; amrex::MultiFab * &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aa5f6a6ceae0087393f386649d8bbbc31">lsm_flux</a></td></tr>
<tr class="separator:aa5f6a6ceae0087393f386649d8bbbc31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9084179f7384e10a519989ffd51fd34"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ad9084179f7384e10a519989ffd51fd34">cf_width</a> {0}</td></tr>
<tr class="separator:ad9084179f7384e10a519989ffd51fd34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e3e2855b6e811596226c167573ad62d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a1e3e2855b6e811596226c167573ad62d">cf_set_width</a> {0}</td></tr>
<tr class="separator:a1e3e2855b6e811596226c167573ad62d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34160ca20fb400ee285664117cb80512"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; <a class="el" href="classERFFillPatcher.html">ERFFillPatcher</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a34160ca20fb400ee285664117cb80512">FPr_c</a></td></tr>
<tr class="separator:a34160ca20fb400ee285664117cb80512"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ef3455d5b4fc9a178e023b233d389a4"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; <a class="el" href="classERFFillPatcher.html">ERFFillPatcher</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a0ef3455d5b4fc9a178e023b233d389a4">FPr_u</a></td></tr>
<tr class="separator:a0ef3455d5b4fc9a178e023b233d389a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1dc7086aec533a042e6033706845b0c3"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; <a class="el" href="classERFFillPatcher.html">ERFFillPatcher</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a1dc7086aec533a042e6033706845b0c3">FPr_v</a></td></tr>
<tr class="separator:a1dc7086aec533a042e6033706845b0c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9a11403c2238d0d1e7b65b2d100dbaf"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; <a class="el" href="classERFFillPatcher.html">ERFFillPatcher</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ac9a11403c2238d0d1e7b65b2d100dbaf">FPr_w</a></td></tr>
<tr class="separator:ac9a11403c2238d0d1e7b65b2d100dbaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb9348353b2415d023d8f52c293cad7e"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aeb9348353b2415d023d8f52c293cad7e">Tau11_lev</a></td></tr>
<tr class="separator:aeb9348353b2415d023d8f52c293cad7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb4294f848d86e4aefb74848bb71047e"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#afb4294f848d86e4aefb74848bb71047e">Tau22_lev</a></td></tr>
<tr class="separator:afb4294f848d86e4aefb74848bb71047e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60a185c47f07bf4fb537a15d5a226d8a"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a60a185c47f07bf4fb537a15d5a226d8a">Tau33_lev</a></td></tr>
<tr class="separator:a60a185c47f07bf4fb537a15d5a226d8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8c2eca71737b102cc5cf75f97c6bd63"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ad8c2eca71737b102cc5cf75f97c6bd63">Tau12_lev</a></td></tr>
<tr class="separator:ad8c2eca71737b102cc5cf75f97c6bd63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a547864dc0347f4620feb99ed564acb4d"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a547864dc0347f4620feb99ed564acb4d">Tau21_lev</a></td></tr>
<tr class="separator:a547864dc0347f4620feb99ed564acb4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5392e6104804d799b3fd943dfe390766"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a5392e6104804d799b3fd943dfe390766">Tau13_lev</a></td></tr>
<tr class="separator:a5392e6104804d799b3fd943dfe390766"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a203e7334296218672e36bab93174e146"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a203e7334296218672e36bab93174e146">Tau31_lev</a></td></tr>
<tr class="separator:a203e7334296218672e36bab93174e146"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03a4ad7368c1c98b492cd9d9fec9cbc5"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a03a4ad7368c1c98b492cd9d9fec9cbc5">Tau23_lev</a></td></tr>
<tr class="separator:a03a4ad7368c1c98b492cd9d9fec9cbc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa650bf1f6885b179fd8d4c24b48668cb"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aa650bf1f6885b179fd8d4c24b48668cb">Tau32_lev</a></td></tr>
<tr class="separator:aa650bf1f6885b179fd8d4c24b48668cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a327d704704abd516be19339cb2d226f9"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a327d704704abd516be19339cb2d226f9">eddyDiffs_lev</a></td></tr>
<tr class="separator:a327d704704abd516be19339cb2d226f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9faaa96a7c270d2b2b062d9f30f19711"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a9faaa96a7c270d2b2b062d9f30f19711">SmnSmn_lev</a></td></tr>
<tr class="separator:a9faaa96a7c270d2b2b062d9f30f19711"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a5395054a212d8f3fc577562c14b66e"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a5a5395054a212d8f3fc577562c14b66e">sst_lev</a></td></tr>
<tr class="separator:a5a5395054a212d8f3fc577562c14b66e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f3e29874221e43e13e2a431e77e0e4e"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Vector&lt; std::unique_ptr&lt; amrex::iMultiFab &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a3f3e29874221e43e13e2a431e77e0e4e">lmask_lev</a></td></tr>
<tr class="separator:a3f3e29874221e43e13e2a431e77e0e4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25174b4ae6cfcac8f7d183ce5c9fe67b"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a25174b4ae6cfcac8f7d183ce5c9fe67b">SFS_hfx1_lev</a></td></tr>
<tr class="separator:a25174b4ae6cfcac8f7d183ce5c9fe67b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb607b2e675b45fdcabc09b640ce5ae2"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#acb607b2e675b45fdcabc09b640ce5ae2">SFS_hfx2_lev</a></td></tr>
<tr class="separator:acb607b2e675b45fdcabc09b640ce5ae2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a2e3faf5dd90ad2f9ded28b486f3b46"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a1a2e3faf5dd90ad2f9ded28b486f3b46">SFS_hfx3_lev</a></td></tr>
<tr class="separator:a1a2e3faf5dd90ad2f9ded28b486f3b46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e1ad417e3bd062468d74830b65911fb"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a6e1ad417e3bd062468d74830b65911fb">SFS_diss_lev</a></td></tr>
<tr class="separator:a6e1ad417e3bd062468d74830b65911fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a4d6e7887fa8f30c33a0b8899035ddb"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a7a4d6e7887fa8f30c33a0b8899035ddb">zlevels_stag</a></td></tr>
<tr class="separator:a7a4d6e7887fa8f30c33a0b8899035ddb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93e63e5af35efa564fd4195e8703f84c"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a></td></tr>
<tr class="separator:a93e63e5af35efa564fd4195e8703f84c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31be0f1ae705c52c8ccc520369013284"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a></td></tr>
<tr class="separator:a31be0f1ae705c52c8ccc520369013284"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30f8b851ed29d38695d44cff257f14e6"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">detJ_cc</a></td></tr>
<tr class="separator:a30f8b851ed29d38695d44cff257f14e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30dcf40e8f104fb6b6132805d2eff47c"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a30dcf40e8f104fb6b6132805d2eff47c">z_phys_nd_src</a></td></tr>
<tr class="separator:a30dcf40e8f104fb6b6132805d2eff47c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a411e0ea9d9bdbfab957c8081229091"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a9a411e0ea9d9bdbfab957c8081229091">detJ_cc_src</a></td></tr>
<tr class="separator:a9a411e0ea9d9bdbfab957c8081229091"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ef635c22e72c715f5703a6b95a7abe5"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a4ef635c22e72c715f5703a6b95a7abe5">z_phys_nd_new</a></td></tr>
<tr class="separator:a4ef635c22e72c715f5703a6b95a7abe5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae39bf64c5306b1dd939d82d9df728daa"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ae39bf64c5306b1dd939d82d9df728daa">detJ_cc_new</a></td></tr>
<tr class="separator:ae39bf64c5306b1dd939d82d9df728daa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72a59614c6d5ab840b924c84d5682270"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a72a59614c6d5ab840b924c84d5682270">z_t_rk</a></td></tr>
<tr class="separator:a72a59614c6d5ab840b924c84d5682270"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23aacdb72e9d2dfed8e2ebd2c2526497"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a23aacdb72e9d2dfed8e2ebd2c2526497">mapfac_m</a></td></tr>
<tr class="separator:a23aacdb72e9d2dfed8e2ebd2c2526497"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e8afee1508b720dab56f5d044deb301"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a1e8afee1508b720dab56f5d044deb301">mapfac_u</a></td></tr>
<tr class="separator:a1e8afee1508b720dab56f5d044deb301"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae49b5055f9a7117fa15918a5daa775b7"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ae49b5055f9a7117fa15918a5daa775b7">mapfac_v</a></td></tr>
<tr class="separator:ae49b5055f9a7117fa15918a5daa775b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c1fae5e620fcd64cc9ede73715e3b7c"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::MultiFab &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a></td></tr>
<tr class="separator:a4c1fae5e620fcd64cc9ede73715e3b7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37b2a4257df8ff53d4450de47f16ace1"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::MultiFab &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a37b2a4257df8ff53d4450de47f16ace1">base_state_new</a></td></tr>
<tr class="separator:a37b2a4257df8ff53d4450de47f16ace1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86a0bc8e41668411ee0ab5801d4688a7"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::YAFluxRegister * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a86a0bc8e41668411ee0ab5801d4688a7">advflux_reg</a></td></tr>
<tr class="separator:a86a0bc8e41668411ee0ab5801d4688a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a574521986a6e403159f83c8b8123ba90"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::BCRec &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a></td></tr>
<tr class="separator:a574521986a6e403159f83c8b8123ba90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a99e22b1111c803e31b4afd5fcdea60"><td class="memItemLeft" align="right" valign="top">amrex::Gpu::DeviceVector&lt; amrex::BCRec &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a8a99e22b1111c803e31b4afd5fcdea60">domain_bcs_type_d</a></td></tr>
<tr class="separator:a8a99e22b1111c803e31b4afd5fcdea60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5968f1bed602fa87cdd5cb7905b7e5e"><td class="memItemLeft" align="right" valign="top">amrex::Array&lt; std::string, 2 *AMREX_SPACEDIM &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a></td></tr>
<tr class="separator:ae5968f1bed602fa87cdd5cb7905b7e5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a199add69cee34c6611a5dc9ee965971c"><td class="memItemLeft" align="right" valign="top">amrex::Array&lt; amrex::Array&lt; amrex::Real, AMREX_SPACEDIM *2 &gt;, AMREX_SPACEDIM+<a class="el" href="IndexDefines_8H.html#a46e292b965f80d15acfbdc11ffe1e0f0">NVAR_max</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a></td></tr>
<tr class="separator:a199add69cee34c6611a5dc9ee965971c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69ea003766c97b1a667b002b3661f0f2"><td class="memItemLeft" align="right" valign="top">amrex::Array&lt; amrex::Array&lt; amrex::Real, AMREX_SPACEDIM *2 &gt;, AMREX_SPACEDIM+<a class="el" href="IndexDefines_8H.html#a46e292b965f80d15acfbdc11ffe1e0f0">NVAR_max</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a69ea003766c97b1a667b002b3661f0f2">m_bc_neumann_vals</a></td></tr>
<tr class="separator:a69ea003766c97b1a667b002b3661f0f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6df94c25ac21bf6a2e856a9901e3a15"><td class="memItemLeft" align="right" valign="top">amrex::GpuArray&lt; <a class="el" href="IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9">ERF_BC</a>, AMREX_SPACEDIM *2 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a></td></tr>
<tr class="separator:ae6df94c25ac21bf6a2e856a9901e3a15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d54d3f2317d06a8dfcde4f65cfc3e92"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a7d54d3f2317d06a8dfcde4f65cfc3e92">last_plot_file_step_1</a></td></tr>
<tr class="separator:a7d54d3f2317d06a8dfcde4f65cfc3e92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09017292c9943ac2ed20ce7ed5c3c767"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a09017292c9943ac2ed20ce7ed5c3c767">last_plot_file_step_2</a></td></tr>
<tr class="separator:a09017292c9943ac2ed20ce7ed5c3c767"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02722d16f3c26efe590702200f1296d7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a02722d16f3c26efe590702200f1296d7">last_check_file_step</a></td></tr>
<tr class="separator:a02722d16f3c26efe590702200f1296d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc00038dfe4c332e5d15f621184c69e8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#adc00038dfe4c332e5d15f621184c69e8">plot_file_on_restart</a> = 1</td></tr>
<tr class="separator:adc00038dfe4c332e5d15f621184c69e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0634154e8e58379c495c3e7fe7c5e4d6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a0634154e8e58379c495c3e7fe7c5e4d6">max_step</a> = std::numeric_limits&lt;int&gt;::max()</td></tr>
<tr class="separator:a0634154e8e58379c495c3e7fe7c5e4d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0c07f31b23d977646b8161e5473fab5"><td class="memItemLeft" align="right" valign="top">amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aa0c07f31b23d977646b8161e5473fab5">start_time</a> = 0.0</td></tr>
<tr class="separator:aa0c07f31b23d977646b8161e5473fab5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a405556a52bef334ab68294c1a540e107"><td class="memItemLeft" align="right" valign="top">amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a405556a52bef334ab68294c1a540e107">stop_time</a> = std::numeric_limits&lt;amrex::Real&gt;::max()</td></tr>
<tr class="separator:a405556a52bef334ab68294c1a540e107"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e758060d3dede9694fbfcabddc17169"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a> = &quot;&quot;</td></tr>
<tr class="separator:a8e758060d3dede9694fbfcabddc17169"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3937527f96c81674fa38dc34ed24f3f5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a3937527f96c81674fa38dc34ed24f3f5">regrid_int</a> = -1</td></tr>
<tr class="separator:a3937527f96c81674fa38dc34ed24f3f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa54aaa938a18d34caa4d86e977647899"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aa54aaa938a18d34caa4d86e977647899">plot_file_1</a> {&quot;plt_1_&quot;}</td></tr>
<tr class="separator:aa54aaa938a18d34caa4d86e977647899"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18fa84b06132715757d97ec38678aa2c"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a18fa84b06132715757d97ec38678aa2c">plot_file_2</a> {&quot;plt_2_&quot;}</td></tr>
<tr class="separator:a18fa84b06132715757d97ec38678aa2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57cfb4bfead8525174646964992c7e69"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a57cfb4bfead8525174646964992c7e69">m_plot_int_1</a> = -1</td></tr>
<tr class="separator:a57cfb4bfead8525174646964992c7e69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3311c9ceacd17f34bdb5e03cefa33b3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ad3311c9ceacd17f34bdb5e03cefa33b3">m_plot_int_2</a> = -1</td></tr>
<tr class="separator:ad3311c9ceacd17f34bdb5e03cefa33b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3167adc9518cce649a90ab82e9f9c85d"><td class="memItemLeft" align="right" valign="top">amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a3167adc9518cce649a90ab82e9f9c85d">m_plot_per_1</a> = -1.0</td></tr>
<tr class="separator:a3167adc9518cce649a90ab82e9f9c85d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff879a9c686293a10a3a03027b765c51"><td class="memItemLeft" align="right" valign="top">amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aff879a9c686293a10a3a03027b765c51">m_plot_per_2</a> = -1.0</td></tr>
<tr class="separator:aff879a9c686293a10a3a03027b765c51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc653b103aa26c56acafed85cdd95f52"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#afc653b103aa26c56acafed85cdd95f52">plot_lsm</a> = false</td></tr>
<tr class="separator:afc653b103aa26c56acafed85cdd95f52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a633cd0b44d2e38f02c23e953aecd69eb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a633cd0b44d2e38f02c23e953aecd69eb">profile_int</a> = -1</td></tr>
<tr class="separator:a633cd0b44d2e38f02c23e953aecd69eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2aa0f6b2edd9efd9b090e39db1effcdf"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a2aa0f6b2edd9efd9b090e39db1effcdf">cc_profiles</a> = true</td></tr>
<tr class="separator:a2aa0f6b2edd9efd9b090e39db1effcdf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae701564fbe3da5bbd88587e5a08eca4e"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ae701564fbe3da5bbd88587e5a08eca4e">check_file</a> {&quot;chk&quot;}</td></tr>
<tr class="separator:ae701564fbe3da5bbd88587e5a08eca4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32e0d0f5ae0db18ee81f9d4325a14f64"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a32e0d0f5ae0db18ee81f9d4325a14f64">check_type</a> {&quot;native&quot;}</td></tr>
<tr class="separator:a32e0d0f5ae0db18ee81f9d4325a14f64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30a0b9e3a037c71580d1feb3b30a8258"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a30a0b9e3a037c71580d1feb3b30a8258">restart_type</a> {&quot;native&quot;}</td></tr>
<tr class="separator:a30a0b9e3a037c71580d1feb3b30a8258"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69a3f925e95ec4244b0257f9de16d65a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a69a3f925e95ec4244b0257f9de16d65a">m_check_int</a> = -1</td></tr>
<tr class="separator:a69a3f925e95ec4244b0257f9de16d65a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fbf17cfc8d9e5b994783e05ec3594b2"><td class="memItemLeft" align="right" valign="top">amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a5fbf17cfc8d9e5b994783e05ec3594b2">m_check_per</a> = -1.0</td></tr>
<tr class="separator:a5fbf17cfc8d9e5b994783e05ec3594b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6865cf87abbb5aab0db00ff3b1ce94ac"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a6865cf87abbb5aab0db00ff3b1ce94ac">plot_var_names_1</a></td></tr>
<tr class="separator:a6865cf87abbb5aab0db00ff3b1ce94ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79705c02d6f25fbdcec14ca2432e5da1"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a79705c02d6f25fbdcec14ca2432e5da1">plot_var_names_2</a></td></tr>
<tr class="separator:a79705c02d6f25fbdcec14ca2432e5da1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd8cd5a477754776135befa668fdd0c9"><td class="memItemLeft" align="right" valign="top">const amrex::Vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#afd8cd5a477754776135befa668fdd0c9">cons_names</a></td></tr>
<tr class="separator:afd8cd5a477754776135befa668fdd0c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fc0f6e6ca35036d2e3a36dd42e66435"><td class="memItemLeft" align="right" valign="top">const amrex::Vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a></td></tr>
<tr class="separator:a9fc0f6e6ca35036d2e3a36dd42e66435"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb15119348ad5399947bc8883084b230"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#abb15119348ad5399947bc8883084b230">real_width</a> {0}</td></tr>
<tr class="separator:abb15119348ad5399947bc8883084b230"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acab120bb9324e7298534d765c447d703"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#acab120bb9324e7298534d765c447d703">real_set_width</a> {0}</td></tr>
<tr class="separator:acab120bb9324e7298534d765c447d703"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87aad7caaf3b575734994b47628a2faf"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Vector&lt; amrex::Real &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a87aad7caaf3b575734994b47628a2faf">h_rhotheta_src</a></td></tr>
<tr class="separator:a87aad7caaf3b575734994b47628a2faf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c1fdcfbc9cbd6cb13e41d1170b161f8"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Gpu::DeviceVector&lt; amrex::Real &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a0c1fdcfbc9cbd6cb13e41d1170b161f8">d_rhotheta_src</a></td></tr>
<tr class="separator:a0c1fdcfbc9cbd6cb13e41d1170b161f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c5eca26a28dda3a981b3581abadfca0"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Vector&lt; amrex::Real &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a3c5eca26a28dda3a981b3581abadfca0">h_rhoqt_src</a></td></tr>
<tr class="separator:a3c5eca26a28dda3a981b3581abadfca0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a838687881ef3626f932d0e95ceff0e53"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Gpu::DeviceVector&lt; amrex::Real &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a838687881ef3626f932d0e95ceff0e53">d_rhoqt_src</a></td></tr>
<tr class="separator:a838687881ef3626f932d0e95ceff0e53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a5d0d0b4e8c196f56dfab98f245aff5"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Vector&lt; amrex::Real &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a1a5d0d0b4e8c196f56dfab98f245aff5">h_w_subsid</a></td></tr>
<tr class="separator:a1a5d0d0b4e8c196f56dfab98f245aff5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac94ddee2f501dbcea2a516284b7119b5"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Gpu::DeviceVector&lt; amrex::Real &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ac94ddee2f501dbcea2a516284b7119b5">d_w_subsid</a></td></tr>
<tr class="separator:ac94ddee2f501dbcea2a516284b7119b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9939824ea7b7d06ab252fed28d5a911"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Vector&lt; amrex::Vector&lt; amrex::Real &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ad9939824ea7b7d06ab252fed28d5a911">h_rayleigh_ptrs</a></td></tr>
<tr class="separator:ad9939824ea7b7d06ab252fed28d5a911"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad598bde8e728479faaa7c2820096b47a"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Vector&lt; amrex::Gpu::DeviceVector&lt; amrex::Real &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ad598bde8e728479faaa7c2820096b47a">d_rayleigh_ptrs</a></td></tr>
<tr class="separator:ad598bde8e728479faaa7c2820096b47a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4dd7c603e65d230105a4f1e0afb4cf8a"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a4dd7c603e65d230105a4f1e0afb4cf8a">h_havg_density</a></td></tr>
<tr class="separator:a4dd7c603e65d230105a4f1e0afb4cf8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9683c7b07c287e57856ee5a9c99917a1"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a9683c7b07c287e57856ee5a9c99917a1">h_havg_temperature</a></td></tr>
<tr class="separator:a9683c7b07c287e57856ee5a9c99917a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a413293737b0021c97b50c62756561446"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a413293737b0021c97b50c62756561446">h_havg_pressure</a></td></tr>
<tr class="separator:a413293737b0021c97b50c62756561446"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8de26569516b41e5dc3cbb3419e891c"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ae8de26569516b41e5dc3cbb3419e891c">h_havg_qv</a></td></tr>
<tr class="separator:ae8de26569516b41e5dc3cbb3419e891c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45233bcc95ac50c112b7146595164a8d"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a45233bcc95ac50c112b7146595164a8d">h_havg_qc</a></td></tr>
<tr class="separator:a45233bcc95ac50c112b7146595164a8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84cf7616e7b3928f08f4bd56112db01e"><td class="memItemLeft" align="right" valign="top">amrex::Gpu::DeviceVector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a84cf7616e7b3928f08f4bd56112db01e">d_havg_density</a></td></tr>
<tr class="separator:a84cf7616e7b3928f08f4bd56112db01e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20350959b7b3e252ee3a802e7998ca8d"><td class="memItemLeft" align="right" valign="top">amrex::Gpu::DeviceVector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a20350959b7b3e252ee3a802e7998ca8d">d_havg_temperature</a></td></tr>
<tr class="separator:a20350959b7b3e252ee3a802e7998ca8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a4f076c56f31fbb5e68c09706605a05"><td class="memItemLeft" align="right" valign="top">amrex::Gpu::DeviceVector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a9a4f076c56f31fbb5e68c09706605a05">d_havg_pressure</a></td></tr>
<tr class="separator:a9a4f076c56f31fbb5e68c09706605a05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b0085123e02051ac4c2a72e9972e6ee"><td class="memItemLeft" align="right" valign="top">amrex::Gpu::DeviceVector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a2b0085123e02051ac4c2a72e9972e6ee">d_havg_qv</a></td></tr>
<tr class="separator:a2b0085123e02051ac4c2a72e9972e6ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8199cc1ec38b9dfd47262ccc7df6a941"><td class="memItemLeft" align="right" valign="top">amrex::Gpu::DeviceVector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a8199cc1ec38b9dfd47262ccc7df6a941">d_havg_qc</a></td></tr>
<tr class="separator:a8199cc1ec38b9dfd47262ccc7df6a941"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa53035f34ba133b86172e180abda4209"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classWriteBndryPlanes.html">WriteBndryPlanes</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aa53035f34ba133b86172e180abda4209">m_w2d</a> = nullptr</td></tr>
<tr class="separator:aa53035f34ba133b86172e180abda4209"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addf62bfc534515447b94e928ac0b7135"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classReadBndryPlanes.html">ReadBndryPlanes</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a> = nullptr</td></tr>
<tr class="separator:addf62bfc534515447b94e928ac0b7135"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a051364b2373d8d86151c0b4a958035bd"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classABLMost.html">ABLMost</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a051364b2373d8d86151c0b4a958035bd">m_most</a> = nullptr</td></tr>
<tr class="separator:a051364b2373d8d86151c0b4a958035bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83c244120a15f0d9b9bca54e93976428"><td class="memItemLeft" align="right" valign="top">amrex::MultiFab&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a83c244120a15f0d9b9bca54e93976428">fine_mask</a></td></tr>
<tr class="separator:a83c244120a15f0d9b9bca54e93976428"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0656573ffb79f0fda8d02d5ea0482ed2"><td class="memItemLeft" align="right" valign="top">amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a0656573ffb79f0fda8d02d5ea0482ed2">dz_min</a></td></tr>
<tr class="separator:a0656573ffb79f0fda8d02d5ea0482ed2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cade630b005dbcc0f644987ef3db287"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; std::fstream &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a1cade630b005dbcc0f644987ef3db287">datalog</a></td></tr>
<tr class="separator:a1cade630b005dbcc0f644987ef3db287"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9248a4eb025c2647e003f838cba52a21"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a9248a4eb025c2647e003f838cba52a21">datalogname</a></td></tr>
<tr class="separator:a9248a4eb025c2647e003f838cba52a21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9737ddb0de6b9e8a5b17c109d5ad3e08"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; std::fstream &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a9737ddb0de6b9e8a5b17c109d5ad3e08">sampleptlog</a></td></tr>
<tr class="separator:a9737ddb0de6b9e8a5b17c109d5ad3e08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8fbfa8bb47c0a3b53e244081aa1e8ad3"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a8fbfa8bb47c0a3b53e244081aa1e8ad3">sampleptlogname</a></td></tr>
<tr class="separator:a8fbfa8bb47c0a3b53e244081aa1e8ad3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8a57b7fbf5a67c99d04b7d4f43ad100"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::IntVect &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ae8a57b7fbf5a67c99d04b7d4f43ad100">samplepoint</a></td></tr>
<tr class="separator:ae8a57b7fbf5a67c99d04b7d4f43ad100"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4990f1796b65ec8ee602f177a66afc3e"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; std::fstream &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a4990f1796b65ec8ee602f177a66afc3e">samplelinelog</a></td></tr>
<tr class="separator:a4990f1796b65ec8ee602f177a66afc3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0553967f1131860bb8ecb47c0f192eaa"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a0553967f1131860bb8ecb47c0f192eaa">samplelinelogname</a></td></tr>
<tr class="separator:a0553967f1131860bb8ecb47c0f192eaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fa1582bb13357895d2aba91b695624a"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::IntVect &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a0fa1582bb13357895d2aba91b695624a">sampleline</a></td></tr>
<tr class="separator:a0fa1582bb13357895d2aba91b695624a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-attribs"></a>
Static Private Attributes</h2></td></tr>
<tr class="memitem:a89f605d1a1eae06a7c79f9b6b65c637f"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a89f605d1a1eae06a7c79f9b6b65c637f">cfl</a> = 0.8</td></tr>
<tr class="separator:a89f605d1a1eae06a7c79f9b6b65c637f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad353aa9e275612ff2110c5a1405c1176"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ad353aa9e275612ff2110c5a1405c1176">init_shrink</a> = 1.0</td></tr>
<tr class="separator:ad353aa9e275612ff2110c5a1405c1176"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae16d413b172bb3b3400af6d5cb236fd4"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ae16d413b172bb3b3400af6d5cb236fd4">change_max</a> = 1.1</td></tr>
<tr class="separator:ae16d413b172bb3b3400af6d5cb236fd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd88606a88916719171a267e9edf54c7"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#acd88606a88916719171a267e9edf54c7">fixed_dt</a> = -1.0</td></tr>
<tr class="separator:acd88606a88916719171a267e9edf54c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20f8ed606dd006f84efa4ebed7b96130"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a20f8ed606dd006f84efa4ebed7b96130">fixed_fast_dt</a> = -1.0</td></tr>
<tr class="separator:a20f8ed606dd006f84efa4ebed7b96130"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2e1a979c0ad68e87eaee349beb7e9fd"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ad2e1a979c0ad68e87eaee349beb7e9fd">fixed_mri_dt_ratio</a> = 0</td></tr>
<tr class="separator:ad2e1a979c0ad68e87eaee349beb7e9fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32dd48049e8acbe95decdd4b01b782c4"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="structSolverChoice.html">SolverChoice</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a></td></tr>
<tr class="separator:a32dd48049e8acbe95decdd4b01b782c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43d0b17f6e155691a1e9474526df3af5"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a43d0b17f6e155691a1e9474526df3af5">verbose</a> = 0</td></tr>
<tr class="separator:a43d0b17f6e155691a1e9474526df3af5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5232e98479611a24fe97994640c61faa"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a5232e98479611a24fe97994640c61faa">sum_interval</a> = -1</td></tr>
<tr class="separator:a5232e98479611a24fe97994640c61faa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cf2ba396f4404724824516da4c4a084"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a1cf2ba396f4404724824516da4c4a084">sum_per</a> = -1.0</td></tr>
<tr class="separator:a1cf2ba396f4404724824516da4c4a084"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7b9991150042eb38e2abc89399c0c7c"><td class="memItemLeft" align="right" valign="top">static std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ae7b9991150042eb38e2abc89399c0c7c">plotfile_type</a> = &quot;amrex&quot;</td></tr>
<tr class="separator:ae7b9991150042eb38e2abc89399c0c7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5ac3d88a33a1a284bcc120ce0599cf7"><td class="memItemLeft" align="right" valign="top">static std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#af5ac3d88a33a1a284bcc120ce0599cf7">init_type</a></td></tr>
<tr class="separator:af5ac3d88a33a1a284bcc120ce0599cf7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86208285bf705f360a3c318a75097f61"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a86208285bf705f360a3c318a75097f61">use_real_bcs</a></td></tr>
<tr class="separator:a86208285bf705f360a3c318a75097f61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ef14f6028b577eba70aef46b508be19"><td class="memItemLeft" align="right" valign="top">static amrex::Vector&lt; amrex::Vector&lt; std::string &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a7ef14f6028b577eba70aef46b508be19">nc_init_file</a> = {{&quot;&quot;}}</td></tr>
<tr class="separator:a7ef14f6028b577eba70aef46b508be19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e9040f32464f1a6dee6e0384393451d"><td class="memItemLeft" align="right" valign="top">static std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a7e9040f32464f1a6dee6e0384393451d">nc_bdy_file</a></td></tr>
<tr class="separator:a7e9040f32464f1a6dee6e0384393451d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a536424e14c4139e4683b15c59e742362"><td class="memItemLeft" align="right" valign="top">static std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a536424e14c4139e4683b15c59e742362">input_sounding_file</a> = &quot;input_sounding&quot;</td></tr>
<tr class="separator:a536424e14c4139e4683b15c59e742362"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2eb81c590271b429f132103c9af25830"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a2eb81c590271b429f132103c9af25830">init_sounding_ideal</a> = false</td></tr>
<tr class="separator:a2eb81c590271b429f132103c9af25830"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad17ff2753e754ff3eb1330612b820b5f"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ad17ff2753e754ff3eb1330612b820b5f">output_1d_column</a> = 0</td></tr>
<tr class="separator:ad17ff2753e754ff3eb1330612b820b5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa0bef6d3146788302b81c0d4f4802d1"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#afa0bef6d3146788302b81c0d4f4802d1">column_interval</a> = -1</td></tr>
<tr class="separator:afa0bef6d3146788302b81c0d4f4802d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b0175190c6fcf829c7f2841f729b12a"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a7b0175190c6fcf829c7f2841f729b12a">column_per</a> = -1.0</td></tr>
<tr class="separator:a7b0175190c6fcf829c7f2841f729b12a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a930b7d48218b3fc41d8719b50b3f6086"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a930b7d48218b3fc41d8719b50b3f6086">column_loc_x</a> = 0.0</td></tr>
<tr class="separator:a930b7d48218b3fc41d8719b50b3f6086"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b911f3a5a324813b1ff4462df6044a6"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a2b911f3a5a324813b1ff4462df6044a6">column_loc_y</a> = 0.0</td></tr>
<tr class="separator:a2b911f3a5a324813b1ff4462df6044a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48bba6b1c1b39940b09aefbe56311e2f"><td class="memItemLeft" align="right" valign="top">static std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a48bba6b1c1b39940b09aefbe56311e2f">column_file_name</a> = &quot;column_data.nc&quot;</td></tr>
<tr class="separator:a48bba6b1c1b39940b09aefbe56311e2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c448670f7a5cadd6fe56f7e615c9eb6"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a7c448670f7a5cadd6fe56f7e615c9eb6">output_bndry_planes</a> = 0</td></tr>
<tr class="separator:a7c448670f7a5cadd6fe56f7e615c9eb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab4575d8fb57595a2f1aaf088c60447a"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aab4575d8fb57595a2f1aaf088c60447a">bndry_output_planes_interval</a> = -1</td></tr>
<tr class="separator:aab4575d8fb57595a2f1aaf088c60447a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f99e949c83d86507e003ae556cf7c22"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a5f99e949c83d86507e003ae556cf7c22">bndry_output_planes_per</a> = -1.0</td></tr>
<tr class="separator:a5f99e949c83d86507e003ae556cf7c22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87e58f16f44a6cb35d6983ed3fe7d3c1"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a87e58f16f44a6cb35d6983ed3fe7d3c1">bndry_output_planes_start_time</a> = 0.0</td></tr>
<tr class="separator:a87e58f16f44a6cb35d6983ed3fe7d3c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80ad08512968ec45635df68abe66b1fc"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a80ad08512968ec45635df68abe66b1fc">input_bndry_planes</a> = 0</td></tr>
<tr class="separator:a80ad08512968ec45635df68abe66b1fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addf0fb2aae0efaa649c69685a4dcca83"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#addf0fb2aae0efaa649c69685a4dcca83">ng_dens_hse</a></td></tr>
<tr class="separator:addf0fb2aae0efaa649c69685a4dcca83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87dc6c0720462bfd088c909289cdca0b"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a87dc6c0720462bfd088c909289cdca0b">ng_pres_hse</a></td></tr>
<tr class="separator:a87dc6c0720462bfd088c909289cdca0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac81b3dfd7c6f21ba8479834e2ff1e652"><td class="memItemLeft" align="right" valign="top">static amrex::Vector&lt; amrex::AMRErrorTag &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ac81b3dfd7c6f21ba8479834e2ff1e652">ref_tags</a></td></tr>
<tr class="separator:ac81b3dfd7c6f21ba8479834e2ff1e652"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d00e1cb76bfbcbada173e092b6accf3"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a6d00e1cb76bfbcbada173e092b6accf3">startCPUTime</a> = 0.0</td></tr>
<tr class="separator:a6d00e1cb76bfbcbada173e092b6accf3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f412097e565c23acb4c17c67db10e22"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a1f412097e565c23acb4c17c67db10e22">previousCPUTimeUsed</a> = 0.0</td></tr>
<tr class="separator:a1f412097e565c23acb4c17c67db10e22"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Main class in <a class="el" href="classERF.html">ERF</a> code, instantiated from <a class="el" href="main_8cpp.html">main.cpp</a> </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a30129012dd367825e5e4fd1406694f58"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30129012dd367825e5e4fd1406694f58">&#9670;&nbsp;</a></span>ERF() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ERF::ERF </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;{</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordflow">if</span> (ParallelDescriptor::IOProcessor()) {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span>* erf_hash = <a class="code" href="namespaceamrex.html#afa2dbdd17ead719f97272c9a0a2b0f8a">buildInfoGetGitHash</a>(1);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span>* amrex_hash = <a class="code" href="namespaceamrex.html#afa2dbdd17ead719f97272c9a0a2b0f8a">buildInfoGetGitHash</a>(2);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span>* buildgithash = buildInfoGetBuildGitHash();</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span>* buildgitname = buildInfoGetBuildGitName();</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="keywordflow">if</span> (strlen(erf_hash) &gt; 0) {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;          Print() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                         &lt;&lt; <span class="stringliteral">&quot;ERF git hash: &quot;</span> &lt;&lt; erf_hash &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        }</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="keywordflow">if</span> (strlen(amrex_hash) &gt; 0) {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;          Print() &lt;&lt; <span class="stringliteral">&quot;AMReX git hash: &quot;</span> &lt;&lt; amrex_hash &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        }</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="keywordflow">if</span> (strlen(buildgithash) &gt; 0) {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;          Print() &lt;&lt; buildgitname &lt;&lt; <span class="stringliteral">&quot; git hash: &quot;</span> &lt;&lt; buildgithash &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        }</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        Print() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    }</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordtype">int</span> nlevs_max = max_level + 1;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="preprocessor">#ifdef ERF_USE_WINDFARM</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac0a723e8797cdc0fe06b3fc781fca645">windfarm_type</a> == <a class="code" href="DataStruct_8H.html#a5930188cdc2dd4def9ce58fdf5f46847a2b00d051a8acd949c63ac94efa793efe">WindFarmType::Fitch</a>){</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <a class="code" href="classERF.html#a8e6f53a430ed3842f51fd569b908fa28">Nturb</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <a class="code" href="classERF.html#a47c13e4cf7d4bd9b7b2be81886619fd9">vars_fitch</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="preprocessor">#if defined(ERF_USE_RRTMGP)</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    qheating_rates.resize(nlevs_max);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="comment">// NOTE: size lsm before readparams (chooses the model at all levels)</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <a class="code" href="classERF.html#ae0e9a78f120ba632d78cbf23c97b851c">lsm</a>.<a class="code" href="classLandSurface.html#a58bc8a6e1b1369cd863f8b4f424a6270">ReSize</a>(nlevs_max);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <a class="code" href="classERF.html#ad03da3399e893728741fac33100ce476">lsm_data</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <a class="code" href="classERF.html#aa5f6a6ceae0087393f386649d8bbbc31">lsm_flux</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <a class="code" href="classERF.html#a2d39cd3bdc3d90609ad3b14e266d190a">ReadParameters</a>();</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <a class="code" href="classERF.html#afc2898daad269536c1a15443abf3fa75">initializeMicrophysics</a>(nlevs_max);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keyword">const</span> std::string&amp; pv1 = <span class="stringliteral">&quot;plot_vars_1&quot;</span>; <a class="code" href="classERF.html#a1fcb440c67da60c86372aec1fe871cb7">setPlotVariables</a>(pv1,<a class="code" href="classERF.html#a6865cf87abbb5aab0db00ff3b1ce94ac">plot_var_names_1</a>);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keyword">const</span> std::string&amp; pv2 = <span class="stringliteral">&quot;plot_vars_2&quot;</span>; <a class="code" href="classERF.html#a1fcb440c67da60c86372aec1fe871cb7">setPlotVariables</a>(pv2,<a class="code" href="classERF.html#a79705c02d6f25fbdcec14ca2432e5da1">plot_var_names_2</a>);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="comment">// Initialize staggered vertical levels for grid stretching or terrain.</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a063a88594452100497651e8aaf1f68d7">use_terrain</a>) {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <a class="code" href="TerrainMetrics_8cpp.html#a67815693673f128e68656a61d4bf2b4f">init_zlevels</a>(<a class="code" href="classERF.html#a7a4d6e7887fa8f30c33a0b8899035ddb">zlevels_stag</a>,</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                     geom[0],</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                     <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a63b6fffe930de9eb25f92c2bafb00c00">grid_stretching_ratio</a>,</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                     <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa4659e9babdc5d7327266f967d9a80ff">zsurf</a>,</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                     <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a0a4f1c55ea1e3a7d50f926ee0d20a21c">dz0</a>);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <span class="keywordtype">int</span> nz = geom[0].Domain().length(2) + 1; <span class="comment">// staggered</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <span class="keywordflow">if</span> (std::fabs(<a class="code" href="classERF.html#a7a4d6e7887fa8f30c33a0b8899035ddb">zlevels_stag</a>[nz-1]-geom[0].ProbHi(2)) &gt; 1.0e-4) {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            Print() &lt;&lt; <span class="stringliteral">&quot;WARNING: prob_hi[2]=&quot;</span> &lt;&lt; geom[0].ProbHi(2)</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; does not match highest requested z level &quot;</span> &lt;&lt; <a class="code" href="classERF.html#a7a4d6e7887fa8f30c33a0b8899035ddb">zlevels_stag</a>[nz-1]</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                &lt;&lt; std::endl;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        }</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="keywordflow">if</span> (std::fabs(<a class="code" href="classERF.html#a7a4d6e7887fa8f30c33a0b8899035ddb">zlevels_stag</a>[0]-geom[0].ProbLo(2)) &gt; 1.0e-4) {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            Print() &lt;&lt; <span class="stringliteral">&quot;WARNING: prob_lo[2]=&quot;</span> &lt;&lt; geom[0].ProbLo(2)</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; does not match lowest requested level &quot;</span> &lt;&lt; <a class="code" href="classERF.html#a7a4d6e7887fa8f30c33a0b8899035ddb">zlevels_stag</a>[0]</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                &lt;&lt; std::endl;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        }</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="comment">// Redefine the problem domain here?</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    }</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <a class="code" href="classERF.html#a60e8cb933f237903e3fbcd6376c26db0">prob</a> = <a class="code" href="prob__common_8H.html#a177c505462e3d544fae638344f900397">amrex_probinit</a>(geom[0].ProbLo(),geom[0].ProbHi());</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="comment">// Geometry on all levels has been defined already.</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="comment">// No valid BoxArray and DistributionMapping have been defined.</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="comment">// But the arrays for them have been resized.</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>.resize(nlevs_max, 0);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <a class="code" href="classERF.html#aa3db2dd1b65310c66c4038650c22aaee">nsubsteps</a>.resize(nlevs_max, 1);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 1; lev &lt;= max_level; ++lev) {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <a class="code" href="classERF.html#aa3db2dd1b65310c66c4038650c22aaee">nsubsteps</a>[lev] = MaxRefRatio(lev-1);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    }</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>.resize(nlevs_max, 0.0);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <a class="code" href="classERF.html#a7085d7d5fc94a0f84efc06957267d58e">t_old</a>.resize(nlevs_max, -1.e100);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>.resize(nlevs_max, 1.e100);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <a class="code" href="classERF.html#a3cf7cb2e51eb7b69cb4079ffc6722459">dt_mri_ratio</a>.resize(nlevs_max, 1);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <a class="code" href="classERF.html#a01f3db32272f53dc68025f0a98195e57">rU_new</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <a class="code" href="classERF.html#a54e37988486ef96e55e84bd8e91bb688">rV_new</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <a class="code" href="classERF.html#aa46c0b0d20525aed10f447923e54dde7">rW_new</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <a class="code" href="classERF.html#a6eecc44323f77917c95869928284f61d">rU_old</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <a class="code" href="classERF.html#aeb64e3b4def989ce68d873aefeed5e0e">rV_old</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <a class="code" href="classERF.html#ac1fa56ec90f44e3cdf487af46804163f">rW_old</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt; nlevs_max; ++lev) {</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev].resize(<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a5deccaa24d5e74279425d7749f7d1494">Vars::NumTypes</a>);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        <a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev].resize(<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a5deccaa24d5e74279425d7749f7d1494">Vars::NumTypes</a>);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    }</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="comment">// Time integrator</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <a class="code" href="classERF.html#a09d0fb2bd609c898a665d9530a744585">mri_integrator_mem</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="comment">// Physical boundary conditions</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <a class="code" href="classERF.html#a2e9b04043853d25f2d76edbc0bed2e72">physbcs_cons</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <a class="code" href="classERF.html#a64e55e5ae9df06433146db657eb9e72e">physbcs_u</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <a class="code" href="classERF.html#a79231b5cfd4576a742e46ae0082b5121">physbcs_v</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <a class="code" href="classERF.html#a45c8ecd777f47732993777a0afb8e140">physbcs_w</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <a class="code" href="classERF.html#a4d717bb9fe936fd1a124d0d3e720f9d1">physbcs_w_no_terrain</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <a class="code" href="classERF.html#a86a0bc8e41668411ee0ab5801d4688a7">advflux_reg</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="comment">// Stresses</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <a class="code" href="classERF.html#aeb9348353b2415d023d8f52c293cad7e">Tau11_lev</a>.resize(nlevs_max); <a class="code" href="classERF.html#afb4294f848d86e4aefb74848bb71047e">Tau22_lev</a>.resize(nlevs_max); <a class="code" href="classERF.html#a60a185c47f07bf4fb537a15d5a226d8a">Tau33_lev</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <a class="code" href="classERF.html#ad8c2eca71737b102cc5cf75f97c6bd63">Tau12_lev</a>.resize(nlevs_max); <a class="code" href="classERF.html#a547864dc0347f4620feb99ed564acb4d">Tau21_lev</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <a class="code" href="classERF.html#a5392e6104804d799b3fd943dfe390766">Tau13_lev</a>.resize(nlevs_max); <a class="code" href="classERF.html#a203e7334296218672e36bab93174e146">Tau31_lev</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <a class="code" href="classERF.html#a03a4ad7368c1c98b492cd9d9fec9cbc5">Tau23_lev</a>.resize(nlevs_max); <a class="code" href="classERF.html#aa650bf1f6885b179fd8d4c24b48668cb">Tau32_lev</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <a class="code" href="classERF.html#a25174b4ae6cfcac8f7d183ce5c9fe67b">SFS_hfx1_lev</a>.resize(nlevs_max); <a class="code" href="classERF.html#acb607b2e675b45fdcabc09b640ce5ae2">SFS_hfx2_lev</a>.resize(nlevs_max); <a class="code" href="classERF.html#a1a2e3faf5dd90ad2f9ded28b486f3b46">SFS_hfx3_lev</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <a class="code" href="classERF.html#a6e1ad417e3bd062468d74830b65911fb">SFS_diss_lev</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <a class="code" href="classERF.html#a327d704704abd516be19339cb2d226f9">eddyDiffs_lev</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <a class="code" href="classERF.html#a9faaa96a7c270d2b2b062d9f30f19711">SmnSmn_lev</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160; </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="comment">// Sea surface temps</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <a class="code" href="classERF.html#a5a5395054a212d8f3fc577562c14b66e">sst_lev</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <a class="code" href="classERF.html#a3f3e29874221e43e13e2a431e77e0e4e">lmask_lev</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="comment">// Metric terms</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <a class="code" href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">detJ_cc</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <a class="code" href="classERF.html#a4ef635c22e72c715f5703a6b95a7abe5">z_phys_nd_new</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <a class="code" href="classERF.html#ae39bf64c5306b1dd939d82d9df728daa">detJ_cc_new</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <a class="code" href="classERF.html#a30dcf40e8f104fb6b6132805d2eff47c">z_phys_nd_src</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <a class="code" href="classERF.html#a9a411e0ea9d9bdbfab957c8081229091">detJ_cc_src</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <a class="code" href="classERF.html#a72a59614c6d5ab840b924c84d5682270">z_t_rk</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="comment">// Mapfactors</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <a class="code" href="classERF.html#a23aacdb72e9d2dfed8e2ebd2c2526497">mapfac_m</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <a class="code" href="classERF.html#a1e8afee1508b720dab56f5d044deb301">mapfac_u</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <a class="code" href="classERF.html#ae49b5055f9a7117fa15918a5daa775b7">mapfac_v</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="comment">// Base state</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <a class="code" href="classERF.html#a37b2a4257df8ff53d4450de47f16ace1">base_state_new</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="comment">// Theta prim for MOST</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <a class="code" href="classERF.html#a71629ae2fda396472198691b75d83b2e">Theta_prim</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="comment">// Qv prim for MOST</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <a class="code" href="classERF.html#a521d1faf157e3bccc86c0f26ee923576">Qv_prim</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="comment">// Initialize tagging criteria for mesh refinement</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <a class="code" href="classERF.html#aa90c9756f684404f8b69b8a23568b535">refinement_criteria_setup</a>();</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="comment">// We have already read in the ref_Ratio (via amr.ref_ratio =) but we need to enforce</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="comment">//     that there is no refinement in the vertical so we test on that here.</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt; max_level; ++lev)</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    {</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;       Print() &lt;&lt; <span class="stringliteral">&quot;Refinement ratio at level &quot;</span> &lt;&lt; lev+1 &lt;&lt; <span class="stringliteral">&quot; set to be &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;          ref_ratio[lev][0]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; ref_ratio[lev][1]  &lt;&lt;  <span class="stringliteral">&quot; &quot;</span> &lt;&lt; ref_ratio[lev][2] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;       <span class="keywordflow">if</span> (ref_ratio[lev][2] != 1)</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;       {</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;           Error(<span class="stringliteral">&quot;We don&#39;t allow refinement in the vertical -- make sure to set ref_ratio = 1 in z&quot;</span>);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;       }</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    }</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;}</div>
<div class="ttc" id="aDataStruct_8H_html_a5930188cdc2dd4def9ce58fdf5f46847a2b00d051a8acd949c63ac94efa793efe"><div class="ttname"><a href="DataStruct_8H.html#a5930188cdc2dd4def9ce58fdf5f46847a2b00d051a8acd949c63ac94efa793efe">WindFarmType::Fitch</a></div><div class="ttdeci">@ Fitch</div></div>
<div class="ttc" id="aTerrainMetrics_8cpp_html_a67815693673f128e68656a61d4bf2b4f"><div class="ttname"><a href="TerrainMetrics_8cpp.html#a67815693673f128e68656a61d4bf2b4f">init_zlevels</a></div><div class="ttdeci">void init_zlevels(Vector&lt; Real &gt; &amp;zlevels_stag, const Geometry &amp;geom, const Real grid_stretching_ratio, const Real zsurf, const Real dz0)</div><div class="ttdef"><b>Definition:</b> TerrainMetrics.cpp:9</div></div>
<div class="ttc" id="aclassERF_html_a01f3db32272f53dc68025f0a98195e57"><div class="ttname"><a href="classERF.html#a01f3db32272f53dc68025f0a98195e57">ERF::rU_new</a></div><div class="ttdeci">amrex::Vector&lt; amrex::MultiFab &gt; rU_new</div><div class="ttdef"><b>Definition:</b> ERF.H:567</div></div>
<div class="ttc" id="aclassERF_html_a03a4ad7368c1c98b492cd9d9fec9cbc5"><div class="ttname"><a href="classERF.html#a03a4ad7368c1c98b492cd9d9fec9cbc5">ERF::Tau23_lev</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; Tau23_lev</div><div class="ttdef"><b>Definition:</b> ERF.H:601</div></div>
<div class="ttc" id="aclassERF_html_a09d0fb2bd609c898a665d9530a744585"><div class="ttname"><a href="classERF.html#a09d0fb2bd609c898a665d9530a744585">ERF::mri_integrator_mem</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; MRISplitIntegrator&lt; amrex::Vector&lt; amrex::MultiFab &gt; &gt; &gt; &gt; mri_integrator_mem</div><div class="ttdef"><b>Definition:</b> ERF.H:552</div></div>
<div class="ttc" id="aclassERF_html_a1204ca4dc5d79f5da191ffbe09dfab9b"><div class="ttname"><a href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">ERF::vars_new</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; amrex::MultiFab &gt; &gt; vars_new</div><div class="ttdef"><b>Definition:</b> ERF.H:549</div></div>
<div class="ttc" id="aclassERF_html_a1a2e3faf5dd90ad2f9ded28b486f3b46"><div class="ttname"><a href="classERF.html#a1a2e3faf5dd90ad2f9ded28b486f3b46">ERF::SFS_hfx3_lev</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; SFS_hfx3_lev</div><div class="ttdef"><b>Definition:</b> ERF.H:610</div></div>
<div class="ttc" id="aclassERF_html_a1e8afee1508b720dab56f5d044deb301"><div class="ttname"><a href="classERF.html#a1e8afee1508b720dab56f5d044deb301">ERF::mapfac_u</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; mapfac_u</div><div class="ttdef"><b>Definition:</b> ERF.H:628</div></div>
<div class="ttc" id="aclassERF_html_a1fcb440c67da60c86372aec1fe871cb7"><div class="ttname"><a href="classERF.html#a1fcb440c67da60c86372aec1fe871cb7">ERF::setPlotVariables</a></div><div class="ttdeci">void setPlotVariables(const std::string &amp;pp_plot_var_names, amrex::Vector&lt; std::string &gt; &amp;plot_var_names)</div><div class="ttdef"><b>Definition:</b> Plotfile.cpp:16</div></div>
<div class="ttc" id="aclassERF_html_a203e7334296218672e36bab93174e146"><div class="ttname"><a href="classERF.html#a203e7334296218672e36bab93174e146">ERF::Tau31_lev</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; Tau31_lev</div><div class="ttdef"><b>Definition:</b> ERF.H:600</div></div>
<div class="ttc" id="aclassERF_html_a23aacdb72e9d2dfed8e2ebd2c2526497"><div class="ttname"><a href="classERF.html#a23aacdb72e9d2dfed8e2ebd2c2526497">ERF::mapfac_m</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; mapfac_m</div><div class="ttdef"><b>Definition:</b> ERF.H:627</div></div>
<div class="ttc" id="aclassERF_html_a25174b4ae6cfcac8f7d183ce5c9fe67b"><div class="ttname"><a href="classERF.html#a25174b4ae6cfcac8f7d183ce5c9fe67b">ERF::SFS_hfx1_lev</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; SFS_hfx1_lev</div><div class="ttdef"><b>Definition:</b> ERF.H:610</div></div>
<div class="ttc" id="aclassERF_html_a2d39cd3bdc3d90609ad3b14e266d190a"><div class="ttname"><a href="classERF.html#a2d39cd3bdc3d90609ad3b14e266d190a">ERF::ReadParameters</a></div><div class="ttdeci">void ReadParameters()</div><div class="ttdef"><b>Definition:</b> ERF.cpp:1098</div></div>
<div class="ttc" id="aclassERF_html_a2e9b04043853d25f2d76edbc0bed2e72"><div class="ttname"><a href="classERF.html#a2e9b04043853d25f2d76edbc0bed2e72">ERF::physbcs_cons</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; ERFPhysBCFunct_cons &gt; &gt; physbcs_cons</div><div class="ttdef"><b>Definition:</b> ERF.H:555</div></div>
<div class="ttc" id="aclassERF_html_a30dcf40e8f104fb6b6132805d2eff47c"><div class="ttname"><a href="classERF.html#a30dcf40e8f104fb6b6132805d2eff47c">ERF::z_phys_nd_src</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; z_phys_nd_src</div><div class="ttdef"><b>Definition:</b> ERF.H:619</div></div>
<div class="ttc" id="aclassERF_html_a30f8b851ed29d38695d44cff257f14e6"><div class="ttname"><a href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">ERF::detJ_cc</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; detJ_cc</div><div class="ttdef"><b>Definition:</b> ERF.H:617</div></div>
<div class="ttc" id="aclassERF_html_a31be0f1ae705c52c8ccc520369013284"><div class="ttname"><a href="classERF.html#a31be0f1ae705c52c8ccc520369013284">ERF::z_phys_cc</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; z_phys_cc</div><div class="ttdef"><b>Definition:</b> ERF.H:616</div></div>
<div class="ttc" id="aclassERF_html_a327d704704abd516be19339cb2d226f9"><div class="ttname"><a href="classERF.html#a327d704704abd516be19339cb2d226f9">ERF::eddyDiffs_lev</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; eddyDiffs_lev</div><div class="ttdef"><b>Definition:</b> ERF.H:602</div></div>
<div class="ttc" id="aclassERF_html_a32dd48049e8acbe95decdd4b01b782c4"><div class="ttname"><a href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">ERF::solverChoice</a></div><div class="ttdeci">static SolverChoice solverChoice</div><div class="ttdef"><b>Definition:</b> ERF.H:732</div></div>
<div class="ttc" id="aclassERF_html_a37b2a4257df8ff53d4450de47f16ace1"><div class="ttname"><a href="classERF.html#a37b2a4257df8ff53d4450de47f16ace1">ERF::base_state_new</a></div><div class="ttdeci">amrex::Vector&lt; amrex::MultiFab &gt; base_state_new</div><div class="ttdef"><b>Definition:</b> ERF.H:632</div></div>
<div class="ttc" id="aclassERF_html_a3cf7cb2e51eb7b69cb4079ffc6722459"><div class="ttname"><a href="classERF.html#a3cf7cb2e51eb7b69cb4079ffc6722459">ERF::dt_mri_ratio</a></div><div class="ttdeci">amrex::Vector&lt; long &gt; dt_mri_ratio</div><div class="ttdef"><b>Definition:</b> ERF.H:544</div></div>
<div class="ttc" id="aclassERF_html_a3f3e29874221e43e13e2a431e77e0e4e"><div class="ttname"><a href="classERF.html#a3f3e29874221e43e13e2a431e77e0e4e">ERF::lmask_lev</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; std::unique_ptr&lt; amrex::iMultiFab &gt; &gt; &gt; lmask_lev</div><div class="ttdef"><b>Definition:</b> ERF.H:607</div></div>
<div class="ttc" id="aclassERF_html_a45c8ecd777f47732993777a0afb8e140"><div class="ttname"><a href="classERF.html#a45c8ecd777f47732993777a0afb8e140">ERF::physbcs_w</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; ERFPhysBCFunct_w &gt; &gt; physbcs_w</div><div class="ttdef"><b>Definition:</b> ERF.H:558</div></div>
<div class="ttc" id="aclassERF_html_a47c13e4cf7d4bd9b7b2be81886619fd9"><div class="ttname"><a href="classERF.html#a47c13e4cf7d4bd9b7b2be81886619fd9">ERF::vars_fitch</a></div><div class="ttdeci">amrex::Vector&lt; amrex::MultiFab &gt; vars_fitch</div><div class="ttdef"><b>Definition:</b> ERF.H:578</div></div>
<div class="ttc" id="aclassERF_html_a4c1fae5e620fcd64cc9ede73715e3b7c"><div class="ttname"><a href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">ERF::base_state</a></div><div class="ttdeci">amrex::Vector&lt; amrex::MultiFab &gt; base_state</div><div class="ttdef"><b>Definition:</b> ERF.H:631</div></div>
<div class="ttc" id="aclassERF_html_a4d717bb9fe936fd1a124d0d3e720f9d1"><div class="ttname"><a href="classERF.html#a4d717bb9fe936fd1a124d0d3e720f9d1">ERF::physbcs_w_no_terrain</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; ERFPhysBCFunct_w_no_terrain &gt; &gt; physbcs_w_no_terrain</div><div class="ttdef"><b>Definition:</b> ERF.H:559</div></div>
<div class="ttc" id="aclassERF_html_a4ef635c22e72c715f5703a6b95a7abe5"><div class="ttname"><a href="classERF.html#a4ef635c22e72c715f5703a6b95a7abe5">ERF::z_phys_nd_new</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; z_phys_nd_new</div><div class="ttdef"><b>Definition:</b> ERF.H:622</div></div>
<div class="ttc" id="aclassERF_html_a521d1faf157e3bccc86c0f26ee923576"><div class="ttname"><a href="classERF.html#a521d1faf157e3bccc86c0f26ee923576">ERF::Qv_prim</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; Qv_prim</div><div class="ttdef"><b>Definition:</b> ERF.H:563</div></div>
<div class="ttc" id="aclassERF_html_a5392e6104804d799b3fd943dfe390766"><div class="ttname"><a href="classERF.html#a5392e6104804d799b3fd943dfe390766">ERF::Tau13_lev</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; Tau13_lev</div><div class="ttdef"><b>Definition:</b> ERF.H:600</div></div>
<div class="ttc" id="aclassERF_html_a547864dc0347f4620feb99ed564acb4d"><div class="ttname"><a href="classERF.html#a547864dc0347f4620feb99ed564acb4d">ERF::Tau21_lev</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; Tau21_lev</div><div class="ttdef"><b>Definition:</b> ERF.H:599</div></div>
<div class="ttc" id="aclassERF_html_a54e37988486ef96e55e84bd8e91bb688"><div class="ttname"><a href="classERF.html#a54e37988486ef96e55e84bd8e91bb688">ERF::rV_new</a></div><div class="ttdeci">amrex::Vector&lt; amrex::MultiFab &gt; rV_new</div><div class="ttdef"><b>Definition:</b> ERF.H:569</div></div>
<div class="ttc" id="aclassERF_html_a5a5395054a212d8f3fc577562c14b66e"><div class="ttname"><a href="classERF.html#a5a5395054a212d8f3fc577562c14b66e">ERF::sst_lev</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; &gt; sst_lev</div><div class="ttdef"><b>Definition:</b> ERF.H:606</div></div>
<div class="ttc" id="aclassERF_html_a60a185c47f07bf4fb537a15d5a226d8a"><div class="ttname"><a href="classERF.html#a60a185c47f07bf4fb537a15d5a226d8a">ERF::Tau33_lev</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; Tau33_lev</div><div class="ttdef"><b>Definition:</b> ERF.H:598</div></div>
<div class="ttc" id="aclassERF_html_a60e8cb933f237903e3fbcd6376c26db0"><div class="ttname"><a href="classERF.html#a60e8cb933f237903e3fbcd6376c26db0">ERF::prob</a></div><div class="ttdeci">std::unique_ptr&lt; ProblemBase &gt; prob</div><div class="ttdef"><b>Definition:</b> ERF.H:531</div></div>
<div class="ttc" id="aclassERF_html_a64e55e5ae9df06433146db657eb9e72e"><div class="ttname"><a href="classERF.html#a64e55e5ae9df06433146db657eb9e72e">ERF::physbcs_u</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; ERFPhysBCFunct_u &gt; &gt; physbcs_u</div><div class="ttdef"><b>Definition:</b> ERF.H:556</div></div>
<div class="ttc" id="aclassERF_html_a65741b6379d273c19a25cf48bb947614"><div class="ttname"><a href="classERF.html#a65741b6379d273c19a25cf48bb947614">ERF::t_new</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Real &gt; t_new</div><div class="ttdef"><b>Definition:</b> ERF.H:541</div></div>
<div class="ttc" id="aclassERF_html_a6865cf87abbb5aab0db00ff3b1ce94ac"><div class="ttname"><a href="classERF.html#a6865cf87abbb5aab0db00ff3b1ce94ac">ERF::plot_var_names_1</a></div><div class="ttdeci">amrex::Vector&lt; std::string &gt; plot_var_names_1</div><div class="ttdef"><b>Definition:</b> ERF.H:707</div></div>
<div class="ttc" id="aclassERF_html_a6e1ad417e3bd062468d74830b65911fb"><div class="ttname"><a href="classERF.html#a6e1ad417e3bd062468d74830b65911fb">ERF::SFS_diss_lev</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; SFS_diss_lev</div><div class="ttdef"><b>Definition:</b> ERF.H:611</div></div>
<div class="ttc" id="aclassERF_html_a6eecc44323f77917c95869928284f61d"><div class="ttname"><a href="classERF.html#a6eecc44323f77917c95869928284f61d">ERF::rU_old</a></div><div class="ttdeci">amrex::Vector&lt; amrex::MultiFab &gt; rU_old</div><div class="ttdef"><b>Definition:</b> ERF.H:566</div></div>
<div class="ttc" id="aclassERF_html_a7085d7d5fc94a0f84efc06957267d58e"><div class="ttname"><a href="classERF.html#a7085d7d5fc94a0f84efc06957267d58e">ERF::t_old</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Real &gt; t_old</div><div class="ttdef"><b>Definition:</b> ERF.H:542</div></div>
<div class="ttc" id="aclassERF_html_a71629ae2fda396472198691b75d83b2e"><div class="ttname"><a href="classERF.html#a71629ae2fda396472198691b75d83b2e">ERF::Theta_prim</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; Theta_prim</div><div class="ttdef"><b>Definition:</b> ERF.H:562</div></div>
<div class="ttc" id="aclassERF_html_a72a59614c6d5ab840b924c84d5682270"><div class="ttname"><a href="classERF.html#a72a59614c6d5ab840b924c84d5682270">ERF::z_t_rk</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; z_t_rk</div><div class="ttdef"><b>Definition:</b> ERF.H:625</div></div>
<div class="ttc" id="aclassERF_html_a79231b5cfd4576a742e46ae0082b5121"><div class="ttname"><a href="classERF.html#a79231b5cfd4576a742e46ae0082b5121">ERF::physbcs_v</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; ERFPhysBCFunct_v &gt; &gt; physbcs_v</div><div class="ttdef"><b>Definition:</b> ERF.H:557</div></div>
<div class="ttc" id="aclassERF_html_a79705c02d6f25fbdcec14ca2432e5da1"><div class="ttname"><a href="classERF.html#a79705c02d6f25fbdcec14ca2432e5da1">ERF::plot_var_names_2</a></div><div class="ttdeci">amrex::Vector&lt; std::string &gt; plot_var_names_2</div><div class="ttdef"><b>Definition:</b> ERF.H:708</div></div>
<div class="ttc" id="aclassERF_html_a7a4d6e7887fa8f30c33a0b8899035ddb"><div class="ttname"><a href="classERF.html#a7a4d6e7887fa8f30c33a0b8899035ddb">ERF::zlevels_stag</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Real &gt; zlevels_stag</div><div class="ttdef"><b>Definition:</b> ERF.H:614</div></div>
<div class="ttc" id="aclassERF_html_a86a0bc8e41668411ee0ab5801d4688a7"><div class="ttname"><a href="classERF.html#a86a0bc8e41668411ee0ab5801d4688a7">ERF::advflux_reg</a></div><div class="ttdeci">amrex::Vector&lt; amrex::YAFluxRegister * &gt; advflux_reg</div><div class="ttdef"><b>Definition:</b> ERF.H:635</div></div>
<div class="ttc" id="aclassERF_html_a8e6f53a430ed3842f51fd569b908fa28"><div class="ttname"><a href="classERF.html#a8e6f53a430ed3842f51fd569b908fa28">ERF::Nturb</a></div><div class="ttdeci">amrex::Vector&lt; amrex::MultiFab &gt; Nturb</div><div class="ttdef"><b>Definition:</b> ERF.H:577</div></div>
<div class="ttc" id="aclassERF_html_a93e63e5af35efa564fd4195e8703f84c"><div class="ttname"><a href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">ERF::z_phys_nd</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; z_phys_nd</div><div class="ttdef"><b>Definition:</b> ERF.H:615</div></div>
<div class="ttc" id="aclassERF_html_a9a411e0ea9d9bdbfab957c8081229091"><div class="ttname"><a href="classERF.html#a9a411e0ea9d9bdbfab957c8081229091">ERF::detJ_cc_src</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; detJ_cc_src</div><div class="ttdef"><b>Definition:</b> ERF.H:620</div></div>
<div class="ttc" id="aclassERF_html_a9faaa96a7c270d2b2b062d9f30f19711"><div class="ttname"><a href="classERF.html#a9faaa96a7c270d2b2b062d9f30f19711">ERF::SmnSmn_lev</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; SmnSmn_lev</div><div class="ttdef"><b>Definition:</b> ERF.H:603</div></div>
<div class="ttc" id="aclassERF_html_aa3db2dd1b65310c66c4038650c22aaee"><div class="ttname"><a href="classERF.html#aa3db2dd1b65310c66c4038650c22aaee">ERF::nsubsteps</a></div><div class="ttdeci">amrex::Vector&lt; int &gt; nsubsteps</div><div class="ttdef"><b>Definition:</b> ERF.H:538</div></div>
<div class="ttc" id="aclassERF_html_aa46c0b0d20525aed10f447923e54dde7"><div class="ttname"><a href="classERF.html#aa46c0b0d20525aed10f447923e54dde7">ERF::rW_new</a></div><div class="ttdeci">amrex::Vector&lt; amrex::MultiFab &gt; rW_new</div><div class="ttdef"><b>Definition:</b> ERF.H:571</div></div>
<div class="ttc" id="aclassERF_html_aa5f6a6ceae0087393f386649d8bbbc31"><div class="ttname"><a href="classERF.html#aa5f6a6ceae0087393f386649d8bbbc31">ERF::lsm_flux</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; amrex::MultiFab * &gt; &gt; lsm_flux</div><div class="ttdef"><b>Definition:</b> ERF.H:582</div></div>
<div class="ttc" id="aclassERF_html_aa650bf1f6885b179fd8d4c24b48668cb"><div class="ttname"><a href="classERF.html#aa650bf1f6885b179fd8d4c24b48668cb">ERF::Tau32_lev</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; Tau32_lev</div><div class="ttdef"><b>Definition:</b> ERF.H:601</div></div>
<div class="ttc" id="aclassERF_html_aa90c9756f684404f8b69b8a23568b535"><div class="ttname"><a href="classERF.html#aa90c9756f684404f8b69b8a23568b535">ERF::refinement_criteria_setup</a></div><div class="ttdeci">void refinement_criteria_setup()</div><div class="ttdef"><b>Definition:</b> ERF_Tagging.cpp:58</div></div>
<div class="ttc" id="aclassERF_html_ac1fa56ec90f44e3cdf487af46804163f"><div class="ttname"><a href="classERF.html#ac1fa56ec90f44e3cdf487af46804163f">ERF::rW_old</a></div><div class="ttdeci">amrex::Vector&lt; amrex::MultiFab &gt; rW_old</div><div class="ttdef"><b>Definition:</b> ERF.H:570</div></div>
<div class="ttc" id="aclassERF_html_acb607b2e675b45fdcabc09b640ce5ae2"><div class="ttname"><a href="classERF.html#acb607b2e675b45fdcabc09b640ce5ae2">ERF::SFS_hfx2_lev</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; SFS_hfx2_lev</div><div class="ttdef"><b>Definition:</b> ERF.H:610</div></div>
<div class="ttc" id="aclassERF_html_ad03da3399e893728741fac33100ce476"><div class="ttname"><a href="classERF.html#ad03da3399e893728741fac33100ce476">ERF::lsm_data</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; amrex::MultiFab * &gt; &gt; lsm_data</div><div class="ttdef"><b>Definition:</b> ERF.H:581</div></div>
<div class="ttc" id="aclassERF_html_ad34bae243fdb6c3029f5abe4fb4bca2d"><div class="ttname"><a href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">ERF::dt</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Real &gt; dt</div><div class="ttdef"><b>Definition:</b> ERF.H:543</div></div>
<div class="ttc" id="aclassERF_html_ad8c2eca71737b102cc5cf75f97c6bd63"><div class="ttname"><a href="classERF.html#ad8c2eca71737b102cc5cf75f97c6bd63">ERF::Tau12_lev</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; Tau12_lev</div><div class="ttdef"><b>Definition:</b> ERF.H:599</div></div>
<div class="ttc" id="aclassERF_html_ae0e9a78f120ba632d78cbf23c97b851c"><div class="ttname"><a href="classERF.html#ae0e9a78f120ba632d78cbf23c97b851c">ERF::lsm</a></div><div class="ttdeci">LandSurface lsm</div><div class="ttdef"><b>Definition:</b> ERF.H:580</div></div>
<div class="ttc" id="aclassERF_html_ae39bf64c5306b1dd939d82d9df728daa"><div class="ttname"><a href="classERF.html#ae39bf64c5306b1dd939d82d9df728daa">ERF::detJ_cc_new</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; detJ_cc_new</div><div class="ttdef"><b>Definition:</b> ERF.H:623</div></div>
<div class="ttc" id="aclassERF_html_ae49b5055f9a7117fa15918a5daa775b7"><div class="ttname"><a href="classERF.html#ae49b5055f9a7117fa15918a5daa775b7">ERF::mapfac_v</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; mapfac_v</div><div class="ttdef"><b>Definition:</b> ERF.H:629</div></div>
<div class="ttc" id="aclassERF_html_aeb64e3b4def989ce68d873aefeed5e0e"><div class="ttname"><a href="classERF.html#aeb64e3b4def989ce68d873aefeed5e0e">ERF::rV_old</a></div><div class="ttdeci">amrex::Vector&lt; amrex::MultiFab &gt; rV_old</div><div class="ttdef"><b>Definition:</b> ERF.H:568</div></div>
<div class="ttc" id="aclassERF_html_aeb9348353b2415d023d8f52c293cad7e"><div class="ttname"><a href="classERF.html#aeb9348353b2415d023d8f52c293cad7e">ERF::Tau11_lev</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; Tau11_lev</div><div class="ttdef"><b>Definition:</b> ERF.H:598</div></div>
<div class="ttc" id="aclassERF_html_aefa640a036c25b7b770e88a5f838eb2a"><div class="ttname"><a href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">ERF::istep</a></div><div class="ttdeci">amrex::Vector&lt; int &gt; istep</div><div class="ttdef"><b>Definition:</b> ERF.H:537</div></div>
<div class="ttc" id="aclassERF_html_af31e928baa970a1507dfb0233b352542"><div class="ttname"><a href="classERF.html#af31e928baa970a1507dfb0233b352542">ERF::vars_old</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; amrex::MultiFab &gt; &gt; vars_old</div><div class="ttdef"><b>Definition:</b> ERF.H:550</div></div>
<div class="ttc" id="aclassERF_html_afb4294f848d86e4aefb74848bb71047e"><div class="ttname"><a href="classERF.html#afb4294f848d86e4aefb74848bb71047e">ERF::Tau22_lev</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; Tau22_lev</div><div class="ttdef"><b>Definition:</b> ERF.H:598</div></div>
<div class="ttc" id="aclassERF_html_afc2898daad269536c1a15443abf3fa75"><div class="ttname"><a href="classERF.html#afc2898daad269536c1a15443abf3fa75">ERF::initializeMicrophysics</a></div><div class="ttdeci">void initializeMicrophysics(const int &amp;)</div><div class="ttdef"><b>Definition:</b> ERF.cpp:970</div></div>
<div class="ttc" id="aclassLandSurface_html_a58bc8a6e1b1369cd863f8b4f424a6270"><div class="ttname"><a href="classLandSurface.html#a58bc8a6e1b1369cd863f8b4f424a6270">LandSurface::ReSize</a></div><div class="ttdeci">void ReSize(const int &amp;nlev)</div><div class="ttdef"><b>Definition:</b> LandSurface.H:19</div></div>
<div class="ttc" id="anamespaceVars_html_a161eed9b529c2108b15a09099729c3b9a5deccaa24d5e74279425d7749f7d1494"><div class="ttname"><a href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a5deccaa24d5e74279425d7749f7d1494">Vars::NumTypes</a></div><div class="ttdeci">@ NumTypes</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:103</div></div>
<div class="ttc" id="anamespaceamrex_html_afa2dbdd17ead719f97272c9a0a2b0f8a"><div class="ttname"><a href="namespaceamrex.html#afa2dbdd17ead719f97272c9a0a2b0f8a">amrex::buildInfoGetGitHash</a></div><div class="ttdeci">const char * buildInfoGetGitHash(int i)</div></div>
<div class="ttc" id="aprob__common_8H_html_a177c505462e3d544fae638344f900397"><div class="ttname"><a href="prob__common_8H.html#a177c505462e3d544fae638344f900397">amrex_probinit</a></div><div class="ttdeci">std::unique_ptr&lt; ProblemBase &gt; amrex_probinit(const amrex_real *problo, const amrex_real *probhi)</div></div>
<div class="ttc" id="astructSolverChoice_html_a063a88594452100497651e8aaf1f68d7"><div class="ttname"><a href="structSolverChoice.html#a063a88594452100497651e8aaf1f68d7">SolverChoice::use_terrain</a></div><div class="ttdeci">bool use_terrain</div><div class="ttdef"><b>Definition:</b> DataStruct.H:364</div></div>
<div class="ttc" id="astructSolverChoice_html_a0a4f1c55ea1e3a7d50f926ee0d20a21c"><div class="ttname"><a href="structSolverChoice.html#a0a4f1c55ea1e3a7d50f926ee0d20a21c">SolverChoice::dz0</a></div><div class="ttdeci">amrex::Real dz0</div><div class="ttdef"><b>Definition:</b> DataStruct.H:388</div></div>
<div class="ttc" id="astructSolverChoice_html_a63b6fffe930de9eb25f92c2bafb00c00"><div class="ttname"><a href="structSolverChoice.html#a63b6fffe930de9eb25f92c2bafb00c00">SolverChoice::grid_stretching_ratio</a></div><div class="ttdeci">amrex::Real grid_stretching_ratio</div><div class="ttdef"><b>Definition:</b> DataStruct.H:386</div></div>
<div class="ttc" id="astructSolverChoice_html_aa4659e9babdc5d7327266f967d9a80ff"><div class="ttname"><a href="structSolverChoice.html#aa4659e9babdc5d7327266f967d9a80ff">SolverChoice::zsurf</a></div><div class="ttdeci">amrex::Real zsurf</div><div class="ttdef"><b>Definition:</b> DataStruct.H:387</div></div>
<div class="ttc" id="astructSolverChoice_html_ac0a723e8797cdc0fe06b3fc781fca645"><div class="ttname"><a href="structSolverChoice.html#ac0a723e8797cdc0fe06b3fc781fca645">SolverChoice::windfarm_type</a></div><div class="ttdeci">WindFarmType windfarm_type</div><div class="ttdef"><b>Definition:</b> DataStruct.H:412</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a30129012dd367825e5e4fd1406694f58_cgraph.png" border="0" usemap="#aclassERF_a30129012dd367825e5e4fd1406694f58_cgraph" alt=""/></div>
<map name="aclassERF_a30129012dd367825e5e4fd1406694f58_cgraph" id="aclassERF_a30129012dd367825e5e4fd1406694f58_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,84,83"/>
<area shape="rect" href="prob__common_8H.html#a177c505462e3d544fae638344f900397" title=" " alt="" coords="173,5,295,32"/>
<area shape="rect" href="namespaceamrex.html#afa2dbdd17ead719f97272c9a0a2b0f8a" title=" " alt="" coords="132,56,336,83"/>
<area shape="rect" href="TerrainMetrics_8cpp.html#a67815693673f128e68656a61d4bf2b4f" title=" " alt="" coords="186,107,282,133"/>
<area shape="rect" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469" title=" " alt="" coords="384,107,423,133"/>
</map>
</div>

</div>
</div>
<a id="a30901583bd41e7bf4dddb3c1ea329dfe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30901583bd41e7bf4dddb3c1ea329dfe">&#9670;&nbsp;</a></span>~ERF()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ERF::~ERF </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">default</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a13fc8f3a00573ee7735c3228316164a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13fc8f3a00573ee7735c3228316164a9">&#9670;&nbsp;</a></span>ERF() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ERF::ERF </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classERF.html">ERF</a> &amp;&amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="af4f5db4e6643e9ebc8ffeebcbca3978a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4f5db4e6643e9ebc8ffeebcbca3978a">&#9670;&nbsp;</a></span>ERF() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ERF::ERF </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classERF.html">ERF</a> &amp;&#160;</td>
          <td class="paramname"><em>other</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a47413fe5588f7dd71a1d5087a9e804f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47413fe5588f7dd71a1d5087a9e804f9">&#9670;&nbsp;</a></span>Advance()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::Advance </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>dt_lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iteration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ncycle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Function that advances the solution at one level for a single time step &ndash; this does some preliminaries then calls erf_advance</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">lev</td><td>level of refinement (coarsest level is 0) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">time</td><td>start time for time advance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dt_lev</td><td>time step for this time advance </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;{</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    BL_PROFILE(<span class="stringliteral">&quot;ERF::Advance()&quot;</span>);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160; </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="comment">// We must swap the pointers so the previous step&#39;s &quot;new&quot; is now this step&#39;s &quot;old&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    std::swap(<a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev]);</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    MultiFab&amp; S_old = <a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>];</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    MultiFab&amp; S_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>];</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    MultiFab&amp; U_old = <a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>];</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    MultiFab&amp; V_old = <a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>];</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    MultiFab&amp; W_old = <a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>];</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    MultiFab&amp; U_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>];</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    MultiFab&amp; V_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>];</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    MultiFab&amp; W_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>];</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="comment">// configure ABLMost params if used MostWall boundary condition</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[Orientation(Direction::z,Orientation::low)] == <a class="code" href="IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a882dd232c0425bb9366544f84f0a7b6c">ERF_BC::MOST</a>) {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a051364b2373d8d86151c0b4a958035bd">m_most</a>) {</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;            IntVect ng = <a class="code" href="classERF.html#a71629ae2fda396472198691b75d83b2e">Theta_prim</a>[lev]-&gt;nGrowVect();</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;            MultiFab::Copy(  *<a class="code" href="classERF.html#a71629ae2fda396472198691b75d83b2e">Theta_prim</a>[lev], S_old, <a class="code" href="IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>, 0, 1, ng);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;            MultiFab::Divide(*<a class="code" href="classERF.html#a71629ae2fda396472198691b75d83b2e">Theta_prim</a>[lev], S_old, <a class="code" href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>     , 0, 1, ng);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> != <a class="code" href="DataStruct_8H.html#ab34704153a585940411c26587cb82ad0a6adf97f83acf6453d4a6a4b1070f3754">MoistureType::None</a>) {</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;                ng = <a class="code" href="classERF.html#a521d1faf157e3bccc86c0f26ee923576">Qv_prim</a>[lev]-&gt;nGrowVect();</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                MultiFab::Copy(  *<a class="code" href="classERF.html#a521d1faf157e3bccc86c0f26ee923576">Qv_prim</a>[lev], S_old, <a class="code" href="IndexDefines_8H.html#aa965e9988f14d5d2a5aef4a942168a15">RhoQ1_comp</a>, 0, 1, ng);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;                MultiFab::Divide(*<a class="code" href="classERF.html#a521d1faf157e3bccc86c0f26ee923576">Qv_prim</a>[lev], S_old, <a class="code" href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>  , 0, 1, ng);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;            }</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;            <span class="comment">// NOTE: std::swap above causes the field ptrs to be out of date.</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;            <span class="comment">//       Reassign the field ptrs for MAC avg computation.</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;            <a class="code" href="classERF.html#a051364b2373d8d86151c0b4a958035bd">m_most</a>-&gt;update_mac_ptrs(lev, <a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>, <a class="code" href="classERF.html#a71629ae2fda396472198691b75d83b2e">Theta_prim</a>, <a class="code" href="classERF.html#a521d1faf157e3bccc86c0f26ee923576">Qv_prim</a>);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;            <a class="code" href="classERF.html#a051364b2373d8d86151c0b4a958035bd">m_most</a>-&gt;update_fluxes(lev, time);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        }</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    }</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="comment">// We need to set these because otherwise in the first call to erf_advance we may</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="comment">//    read uninitialized data on ghost values in setting the bc&#39;s on the velocities</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    U_new.setVal(1.e34,U_new.nGrowVect());</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    V_new.setVal(1.e34,V_new.nGrowVect());</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    W_new.setVal(1.e34,W_new.nGrowVect());</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <a class="code" href="classERF.html#a8de69f537859f576fba1d94844cfbd33">FillPatch</a>(lev, time, {&amp;S_old, &amp;U_old, &amp;V_old, &amp;W_old},</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                         {&amp;S_old, &amp;<a class="code" href="classERF.html#a6eecc44323f77917c95869928284f61d">rU_old</a>[lev], &amp;<a class="code" href="classERF.html#aeb64e3b4def989ce68d873aefeed5e0e">rV_old</a>[lev], &amp;<a class="code" href="classERF.html#ac1fa56ec90f44e3cdf487af46804163f">rW_old</a>[lev]});</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> != <a class="code" href="DataStruct_8H.html#ab34704153a585940411c26587cb82ad0a6adf97f83acf6453d4a6a4b1070f3754">MoistureType::None</a>) {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <span class="comment">// TODO: This is only qv</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ae00126a9c2738bf6a6cbbe77321c9cfc">qmoist</a>[lev].size() &gt; 0) <a class="code" href="classERF.html#afb39caf6b6949138c0c3c4a067648321">FillPatchMoistVars</a>(lev, *(<a class="code" href="classERF.html#ae00126a9c2738bf6a6cbbe77321c9cfc">qmoist</a>[lev][0]));</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    }</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="preprocessor">#if defined(ERF_USE_WINDFARM)</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="comment">// Update with the Fitch source terms</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac0a723e8797cdc0fe06b3fc781fca645">windfarm_type</a> == <a class="code" href="DataStruct_8H.html#a5930188cdc2dd4def9ce58fdf5f46847a2b00d051a8acd949c63ac94efa793efe">WindFarmType::Fitch</a>) {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <a class="code" href="AdvanceFitch_8cpp.html#ad97355595cc7b033548c7b30513e2760">fitch_advance</a>(lev, Geom(lev), dt_lev, S_old,</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                      U_old, V_old, W_old, <a class="code" href="classERF.html#a47c13e4cf7d4bd9b7b2be81886619fd9">vars_fitch</a>[lev]);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keyword">const</span> BoxArray&amp;            ba = S_old.boxArray();</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keyword">const</span> DistributionMapping&amp; dm = S_old.DistributionMap();</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a7c3c83d6fcec1f134956c3160adf6e39">nvars</a> = S_old.nComp();</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="comment">// Place-holder for source array -- for now just set to 0</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    MultiFab source(ba,dm,<a class="code" href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a7c3c83d6fcec1f134956c3160adf6e39">nvars</a>,1);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    source.setVal(0.0);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="comment">// We don&#39;t need to call FillPatch on cons_mf because we have fillpatch&#39;ed S_old above</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    MultiFab cons_mf(ba,dm,<a class="code" href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a7c3c83d6fcec1f134956c3160adf6e39">nvars</a>,S_old.nGrowVect());</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    MultiFab::Copy(cons_mf,S_old,0,0,S_old.nComp(),S_old.nGrowVect());</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="comment">// Define Multifab for buoyancy term -- only added to vertical velocity</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    MultiFab buoyancy(W_old.boxArray(),W_old.DistributionMap(),1,1);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    amrex::Vector&lt;MultiFab&gt; state_old;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    amrex::Vector&lt;MultiFab&gt; state_new;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="comment">// **************************************************************************************</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="comment">// Here we define state_old and state_new which are to be advanced</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="comment">// **************************************************************************************</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="comment">// Initial solution</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="comment">// Note that &quot;old&quot; and &quot;new&quot; here are relative to each RK stage.</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    state_old.push_back(MultiFab(cons_mf    , amrex::make_alias, 0, <a class="code" href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a7c3c83d6fcec1f134956c3160adf6e39">nvars</a>)); <span class="comment">// cons</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    state_old.push_back(MultiFab(<a class="code" href="classERF.html#a6eecc44323f77917c95869928284f61d">rU_old</a>[lev], amrex::make_alias, 0,     1)); <span class="comment">// xmom</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    state_old.push_back(MultiFab(<a class="code" href="classERF.html#aeb64e3b4def989ce68d873aefeed5e0e">rV_old</a>[lev], amrex::make_alias, 0,     1)); <span class="comment">// ymom</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    state_old.push_back(MultiFab(<a class="code" href="classERF.html#ac1fa56ec90f44e3cdf487af46804163f">rW_old</a>[lev], amrex::make_alias, 0,     1)); <span class="comment">// zmom</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="comment">// Final solution</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="comment">// state_new at the end of the last RK stage holds the t^{n+1} data</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    state_new.push_back(MultiFab(S_new      , amrex::make_alias, 0, <a class="code" href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a7c3c83d6fcec1f134956c3160adf6e39">nvars</a>)); <span class="comment">// cons</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    state_new.push_back(MultiFab(<a class="code" href="classERF.html#a01f3db32272f53dc68025f0a98195e57">rU_new</a>[lev], amrex::make_alias, 0,     1)); <span class="comment">// xmom</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    state_new.push_back(MultiFab(<a class="code" href="classERF.html#a54e37988486ef96e55e84bd8e91bb688">rV_new</a>[lev], amrex::make_alias, 0,     1)); <span class="comment">// ymom</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    state_new.push_back(MultiFab(<a class="code" href="classERF.html#aa46c0b0d20525aed10f447923e54dde7">rW_new</a>[lev], amrex::make_alias, 0,     1)); <span class="comment">// zmom</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="comment">// **************************************************************************************</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="comment">// Update the dycore</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="comment">// **************************************************************************************</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <a class="code" href="classERF.html#a9068176f45cea5fdbbbf3c8eb08bd808">advance_dycore</a>(lev, state_old, state_new,</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                   U_old, V_old, W_old,</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                   U_new, V_new, W_new,</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                   source, buoyancy,</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                   Geom(lev), dt_lev, time);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="comment">// **************************************************************************************</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="comment">// Update the microphysics (moisture)</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="comment">// **************************************************************************************</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <a class="code" href="classERF.html#a87c9bb3f5c35218b85024312261b098c">advance_microphysics</a>(lev, S_new, dt_lev);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="comment">// **************************************************************************************</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="comment">// Update the land surface model</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="comment">// **************************************************************************************</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <a class="code" href="classERF.html#ac3f83ba16254a0efd4395900cef97efc">advance_lsm</a>(lev, S_new, dt_lev);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160; </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="preprocessor">#if defined(ERF_USE_RRTMGP)</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="comment">// **************************************************************************************</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="comment">// Update the radiation</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="comment">// **************************************************************************************</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    advance_radiation(lev, S_new, dt_lev);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="preprocessor">#ifdef ERF_USE_PARTICLES</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="comment">// **************************************************************************************</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="comment">// Update the particle positions</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="comment">// **************************************************************************************</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;   evolveTracers( lev, dt_lev, <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>, <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a> );</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="comment">// **************************************************************************************</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="comment">// Register old and new coarse data if we are at a level less than the finest level</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="comment">// **************************************************************************************</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordflow">if</span> (lev &lt; finest_level)</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    {</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ad9084179f7384e10a519989ffd51fd34">cf_width</a> &gt; 0) {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            <span class="comment">// We must fill the ghost cells of these so that the parallel copy works correctly</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            state_old[<a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daa2e7100afbf5e7a39371f1cb29f6f570a">IntVars::cons</a>].FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            state_new[<a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daa2e7100afbf5e7a39371f1cb29f6f570a">IntVars::cons</a>].FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            <a class="code" href="classERF.html#a34160ca20fb400ee285664117cb80512">FPr_c</a>[lev].RegisterCoarseData({&amp;state_old[<a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daa2e7100afbf5e7a39371f1cb29f6f570a">IntVars::cons</a>], &amp;state_new[<a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daa2e7100afbf5e7a39371f1cb29f6f570a">IntVars::cons</a>]},</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                                          {time, time + dt_lev});</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ad9084179f7384e10a519989ffd51fd34">cf_width</a> &gt;= 0) {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            <span class="comment">// We must fill the ghost cells of these so that the parallel copy works correctly</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            state_old[<a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daaf661293a5a71ca532c214929b98c0bad">IntVars::xmom</a>].FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            state_new[<a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daaf661293a5a71ca532c214929b98c0bad">IntVars::xmom</a>].FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            <a class="code" href="classERF.html#a0ef3455d5b4fc9a178e023b233d389a4">FPr_u</a>[lev].RegisterCoarseData({&amp;state_old[<a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daaf661293a5a71ca532c214929b98c0bad">IntVars::xmom</a>], &amp;state_new[<a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daaf661293a5a71ca532c214929b98c0bad">IntVars::xmom</a>]},</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                                          {time, time + dt_lev});</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            state_old[<a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daa2e60798bc45154a8f905b1aa228a24e5">IntVars::ymom</a>].FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            state_new[<a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daa2e60798bc45154a8f905b1aa228a24e5">IntVars::ymom</a>].FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            <a class="code" href="classERF.html#a1dc7086aec533a042e6033706845b0c3">FPr_v</a>[lev].RegisterCoarseData({&amp;state_old[<a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daa2e60798bc45154a8f905b1aa228a24e5">IntVars::ymom</a>], &amp;state_new[<a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daa2e60798bc45154a8f905b1aa228a24e5">IntVars::ymom</a>]},</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                                          {time, time + dt_lev});</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            state_old[<a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daaaab25f707cae69bfadac2abcd17a2188">IntVars::zmom</a>].FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            state_new[<a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daaaab25f707cae69bfadac2abcd17a2188">IntVars::zmom</a>].FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            <a class="code" href="classERF.html#ac9a11403c2238d0d1e7b65b2d100dbaf">FPr_w</a>[lev].RegisterCoarseData({&amp;state_old[<a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daaaab25f707cae69bfadac2abcd17a2188">IntVars::zmom</a>], &amp;state_new[<a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daaaab25f707cae69bfadac2abcd17a2188">IntVars::zmom</a>]},</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                                          {time, time + dt_lev});</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        }</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    }</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;}</div>
<div class="ttc" id="aAdvanceFitch_8cpp_html_ad97355595cc7b033548c7b30513e2760"><div class="ttname"><a href="AdvanceFitch_8cpp.html#ad97355595cc7b033548c7b30513e2760">fitch_advance</a></div><div class="ttdeci">void fitch_advance(int lev, const Geometry &amp;geom, const Real &amp;dt_advance, MultiFab &amp;cons_in, MultiFab &amp;U_old, MultiFab &amp;V_old, MultiFab &amp;W_old, MultiFab &amp;mf_vars_fitch)</div><div class="ttdef"><b>Definition:</b> AdvanceFitch.cpp:40</div></div>
<div class="ttc" id="aDataStruct_8H_html_a3856c8a2f055327ada182186bfd70239a7c3c83d6fcec1f134956c3160adf6e39"><div class="ttname"><a href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a7c3c83d6fcec1f134956c3160adf6e39">nvars</a></div><div class="ttdeci">@ nvars</div><div class="ttdef"><b>Definition:</b> DataStruct.H:52</div></div>
<div class="ttc" id="aDataStruct_8H_html_ab34704153a585940411c26587cb82ad0a6adf97f83acf6453d4a6a4b1070f3754"><div class="ttname"><a href="DataStruct_8H.html#ab34704153a585940411c26587cb82ad0a6adf97f83acf6453d4a6a4b1070f3754">MoistureType::None</a></div><div class="ttdeci">@ None</div></div>
<div class="ttc" id="aIndexDefines_8H_html_a27dcc910aeb002a0fd44727954dc0e49"><div class="ttname"><a href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a></div><div class="ttdeci">#define Rho_comp</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:12</div></div>
<div class="ttc" id="aIndexDefines_8H_html_a28f96fd04e1ff08fa7a8f53ccde0f877"><div class="ttname"><a href="IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a></div><div class="ttdeci">#define RhoTheta_comp</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:13</div></div>
<div class="ttc" id="aIndexDefines_8H_html_aa965e9988f14d5d2a5aef4a942168a15"><div class="ttname"><a href="IndexDefines_8H.html#aa965e9988f14d5d2a5aef4a942168a15">RhoQ1_comp</a></div><div class="ttdeci">#define RhoQ1_comp</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:17</div></div>
<div class="ttc" id="aIndexDefines_8H_html_adf340bf1893bad34b2bf452d987d86c9a882dd232c0425bb9366544f84f0a7b6c"><div class="ttname"><a href="IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a882dd232c0425bb9366544f84f0a7b6c">ERF_BC::MOST</a></div><div class="ttdeci">@ MOST</div></div>
<div class="ttc" id="aclassERF_html_a051364b2373d8d86151c0b4a958035bd"><div class="ttname"><a href="classERF.html#a051364b2373d8d86151c0b4a958035bd">ERF::m_most</a></div><div class="ttdeci">std::unique_ptr&lt; ABLMost &gt; m_most</div><div class="ttdef"><b>Definition:</b> ERF.H:839</div></div>
<div class="ttc" id="aclassERF_html_a0ef3455d5b4fc9a178e023b233d389a4"><div class="ttname"><a href="classERF.html#a0ef3455d5b4fc9a178e023b233d389a4">ERF::FPr_u</a></div><div class="ttdeci">amrex::Vector&lt; ERFFillPatcher &gt; FPr_u</div><div class="ttdef"><b>Definition:</b> ERF.H:593</div></div>
<div class="ttc" id="aclassERF_html_a1dc7086aec533a042e6033706845b0c3"><div class="ttname"><a href="classERF.html#a1dc7086aec533a042e6033706845b0c3">ERF::FPr_v</a></div><div class="ttdeci">amrex::Vector&lt; ERFFillPatcher &gt; FPr_v</div><div class="ttdef"><b>Definition:</b> ERF.H:594</div></div>
<div class="ttc" id="aclassERF_html_a34160ca20fb400ee285664117cb80512"><div class="ttname"><a href="classERF.html#a34160ca20fb400ee285664117cb80512">ERF::FPr_c</a></div><div class="ttdeci">amrex::Vector&lt; ERFFillPatcher &gt; FPr_c</div><div class="ttdef"><b>Definition:</b> ERF.H:592</div></div>
<div class="ttc" id="aclassERF_html_a87c9bb3f5c35218b85024312261b098c"><div class="ttname"><a href="classERF.html#a87c9bb3f5c35218b85024312261b098c">ERF::advance_microphysics</a></div><div class="ttdeci">void advance_microphysics(int lev, amrex::MultiFab &amp;cons_in, const amrex::Real &amp;dt_advance)</div><div class="ttdef"><b>Definition:</b> ERF_advance_microphysics.cpp:5</div></div>
<div class="ttc" id="aclassERF_html_a8de69f537859f576fba1d94844cfbd33"><div class="ttname"><a href="classERF.html#a8de69f537859f576fba1d94844cfbd33">ERF::FillPatch</a></div><div class="ttdeci">void FillPatch(int lev, amrex::Real time, const amrex::Vector&lt; amrex::MultiFab * &gt; &amp;mfs_vel, const amrex::Vector&lt; amrex::MultiFab * &gt; &amp;mfs_mom, bool fillset=true, bool cons_only=false)</div><div class="ttdef"><b>Definition:</b> ERF_FillPatch.cpp:22</div></div>
<div class="ttc" id="aclassERF_html_a9068176f45cea5fdbbbf3c8eb08bd808"><div class="ttname"><a href="classERF.html#a9068176f45cea5fdbbbf3c8eb08bd808">ERF::advance_dycore</a></div><div class="ttdeci">void advance_dycore(int level, amrex::Vector&lt; amrex::MultiFab &gt; &amp;state_old, amrex::Vector&lt; amrex::MultiFab &gt; &amp;state_new, amrex::MultiFab &amp;xvel_old, amrex::MultiFab &amp;yvel_old, amrex::MultiFab &amp;zvel_old, amrex::MultiFab &amp;xvel_new, amrex::MultiFab &amp;yvel_new, amrex::MultiFab &amp;zvel_new, amrex::MultiFab &amp;source, amrex::MultiFab &amp;buoyancy, amrex::Geometry fine_geom, amrex::Real dt, amrex::Real time)</div><div class="ttdef"><b>Definition:</b> ERF_advance_dycore.cpp:36</div></div>
<div class="ttc" id="aclassERF_html_ac3f83ba16254a0efd4395900cef97efc"><div class="ttname"><a href="classERF.html#ac3f83ba16254a0efd4395900cef97efc">ERF::advance_lsm</a></div><div class="ttdeci">void advance_lsm(int lev, amrex::MultiFab &amp;, const amrex::Real &amp;dt_advance)</div><div class="ttdef"><b>Definition:</b> ERF_advance_lsm.cpp:5</div></div>
<div class="ttc" id="aclassERF_html_ac9a11403c2238d0d1e7b65b2d100dbaf"><div class="ttname"><a href="classERF.html#ac9a11403c2238d0d1e7b65b2d100dbaf">ERF::FPr_w</a></div><div class="ttdeci">amrex::Vector&lt; ERFFillPatcher &gt; FPr_w</div><div class="ttdef"><b>Definition:</b> ERF.H:595</div></div>
<div class="ttc" id="aclassERF_html_ad9084179f7384e10a519989ffd51fd34"><div class="ttname"><a href="classERF.html#ad9084179f7384e10a519989ffd51fd34">ERF::cf_width</a></div><div class="ttdeci">int cf_width</div><div class="ttdef"><b>Definition:</b> ERF.H:590</div></div>
<div class="ttc" id="aclassERF_html_ae00126a9c2738bf6a6cbbe77321c9cfc"><div class="ttname"><a href="classERF.html#ae00126a9c2738bf6a6cbbe77321c9cfc">ERF::qmoist</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; amrex::MultiFab * &gt; &gt; qmoist</div><div class="ttdef"><b>Definition:</b> ERF.H:574</div></div>
<div class="ttc" id="aclassERF_html_ae6df94c25ac21bf6a2e856a9901e3a15"><div class="ttname"><a href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">ERF::phys_bc_type</a></div><div class="ttdeci">amrex::GpuArray&lt; ERF_BC, AMREX_SPACEDIM *2 &gt; phys_bc_type</div><div class="ttdef"><b>Definition:</b> ERF.H:653</div></div>
<div class="ttc" id="aclassERF_html_afb39caf6b6949138c0c3c4a067648321"><div class="ttname"><a href="classERF.html#afb39caf6b6949138c0c3c4a067648321">ERF::FillPatchMoistVars</a></div><div class="ttdeci">void FillPatchMoistVars(int lev, amrex::MultiFab &amp;mf)</div><div class="ttdef"><b>Definition:</b> ERF_FillPatch.cpp:175</div></div>
<div class="ttc" id="anamespaceIntVars_html_afdaa1b64a98a711870ca86f30e7963daa2e60798bc45154a8f905b1aa228a24e5"><div class="ttname"><a href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daa2e60798bc45154a8f905b1aa228a24e5">IntVars::ymom</a></div><div class="ttdeci">@ ymom</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:111</div></div>
<div class="ttc" id="anamespaceIntVars_html_afdaa1b64a98a711870ca86f30e7963daa2e7100afbf5e7a39371f1cb29f6f570a"><div class="ttname"><a href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daa2e7100afbf5e7a39371f1cb29f6f570a">IntVars::cons</a></div><div class="ttdeci">@ cons</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:109</div></div>
<div class="ttc" id="anamespaceIntVars_html_afdaa1b64a98a711870ca86f30e7963daaaab25f707cae69bfadac2abcd17a2188"><div class="ttname"><a href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daaaab25f707cae69bfadac2abcd17a2188">IntVars::zmom</a></div><div class="ttdeci">@ zmom</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:112</div></div>
<div class="ttc" id="anamespaceIntVars_html_afdaa1b64a98a711870ca86f30e7963daaf661293a5a71ca532c214929b98c0bad"><div class="ttname"><a href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daaf661293a5a71ca532c214929b98c0bad">IntVars::xmom</a></div><div class="ttdeci">@ xmom</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:110</div></div>
<div class="ttc" id="anamespaceVars_html_a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c"><div class="ttname"><a href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a></div><div class="ttdeci">@ xvel</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:100</div></div>
<div class="ttc" id="anamespaceVars_html_a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b"><div class="ttname"><a href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a></div><div class="ttdeci">@ cons</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:99</div></div>
<div class="ttc" id="anamespaceVars_html_a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b"><div class="ttname"><a href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a></div><div class="ttdeci">@ zvel</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:102</div></div>
<div class="ttc" id="anamespaceVars_html_a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6"><div class="ttname"><a href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a></div><div class="ttdeci">@ yvel</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:101</div></div>
<div class="ttc" id="astructSolverChoice_html_aacbfbe6f4a3040db3efdc6dbf8fa291b"><div class="ttname"><a href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">SolverChoice::moisture_type</a></div><div class="ttdeci">MoistureType moisture_type</div><div class="ttdef"><b>Definition:</b> DataStruct.H:411</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a47413fe5588f7dd71a1d5087a9e804f9_cgraph.png" border="0" usemap="#aclassERF_a47413fe5588f7dd71a1d5087a9e804f9_cgraph" alt=""/></div>
<map name="aclassERF_a47413fe5588f7dd71a1d5087a9e804f9_cgraph" id="aclassERF_a47413fe5588f7dd71a1d5087a9e804f9_cgraph">
<area shape="rect" title=" " alt="" coords="5,42,116,69"/>
<area shape="rect" href="AdvanceFitch_8cpp.html#ad97355595cc7b033548c7b30513e2760" title=" " alt="" coords="164,42,276,69"/>
<area shape="rect" href="AdvanceFitch_8cpp.html#a471f7bd67ab4c260fed4a09c984a54ed" title=" " alt="" coords="324,5,469,47"/>
<area shape="rect" href="AdvanceFitch_8cpp.html#aa3d620903fe9c72b3d91efbd15990624" title=" " alt="" coords="345,71,448,98"/>
<area shape="rect" href="AdvanceFitch_8cpp.html#ad6dacb1871f0220ea196b85482548fdb" title=" " alt="" coords="517,13,628,39"/>
<area shape="rect" href="AdvanceFitch_8cpp.html#ad9c41fe197e66da6d9e2226544131c14" title=" " alt="" coords="676,13,771,39"/>
</map>
</div>

</div>
</div>
<a id="a9068176f45cea5fdbbbf3c8eb08bd808"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9068176f45cea5fdbbbf3c8eb08bd808">&#9670;&nbsp;</a></span>advance_dycore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::advance_dycore </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>level</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Vector&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>state_old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Vector&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>state_new</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>xvel_old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>yvel_old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>zvel_old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>xvel_new</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>yvel_new</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>zvel_new</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>buoyancy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Geometry&#160;</td>
          <td class="paramname"><em>fine_geom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function that advances the solution at one level for a single time step &ndash; this sets up the multirate time integrator and calls the integrator's advance function</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">level</td><td>level of refinement (coarsest level is 0) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">state_old</td><td>old-time conserved variables </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">state_new</td><td>new-time conserved variables </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xvel_old</td><td>old-time x-component of velocity </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yvel_old</td><td>old-time y-component of velocity </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zvel_old</td><td>old-time z-component of velocity </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xvel_new</td><td>new-time x-component of velocity </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yvel_new</td><td>new-time y-component of velocity </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zvel_new</td><td>new-time z-component of velocity </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">source</td><td>source term for conserved variables </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">buoyancy</td><td>buoyancy source term for z-component of momentum </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fine_geom</td><td>container for geometry information at current level </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dt_advance</td><td>time step for this time advance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">old_time</td><td>old time for this time advance </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;{</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    BL_PROFILE_VAR(<span class="stringliteral">&quot;erf_advance_dycore()&quot;</span>,erf_advance_dycore);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a43d0b17f6e155691a1e9474526df3af5">verbose</a>) Print() &lt;&lt; <span class="stringliteral">&quot;Starting advance_dycore at level &quot;</span> &lt;&lt; level &lt;&lt; std::endl;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <a class="code" href="structDiffChoice.html">DiffChoice</a> dc = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a396122e87a3d15c4ec8666d7dd18c095">diffChoice</a>;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <a class="code" href="structTurbChoice.html">TurbChoice</a> tc = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa53b017d79e0067923180a0aa59367b4">turbChoice</a>[level];</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    MultiFab r_hse (<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[level], make_alias, 0, 1); <span class="comment">// r_0 is first  component</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    MultiFab p_hse (<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[level], make_alias, 1, 1); <span class="comment">// p_0 is second component</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    MultiFab pi_hse(<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[level], make_alias, 2, 1); <span class="comment">// pi_0 is second component</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="comment">// These pointers are used in the MRI utility functions</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    MultiFab* r0  = &amp;r_hse;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    MultiFab* p0  = &amp;p_hse;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    MultiFab* pi0 = &amp;pi_hse;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    Real* dptr_rhotheta_src = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a4e81a09c9f454c680568b7776a3ed90e">custom_rhotheta_forcing</a> ? <a class="code" href="classERF.html#a0c1fdcfbc9cbd6cb13e41d1170b161f8">d_rhotheta_src</a>[level].data() : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    Real* dptr_rhoqt_src    = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa2e312b4e6d08797fc3c1b6d67313d48">custom_moisture_forcing</a> ? <a class="code" href="classERF.html#a838687881ef3626f932d0e95ceff0e53">d_rhoqt_src</a>[level].data()    : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    Real* dptr_wbar_sub     = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a596f061b796ada0389c81a6125150b6e">custom_w_subsidence</a>     ? <a class="code" href="classERF.html#ac94ddee2f501dbcea2a516284b7119b5">d_w_subsid</a>[level].data()     : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    Vector&lt;Real*&gt; d_rayleigh_ptrs_at_lev;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    d_rayleigh_ptrs_at_lev.resize(<a class="code" href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a7c3c83d6fcec1f134956c3160adf6e39">Rayleigh::nvars</a>);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    d_rayleigh_ptrs_at_lev[<a class="code" href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a0831ecd8c789131994c1f350dce2b02f">Rayleigh::tau</a>]      = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a27ced9266434a4680ef175e7b2ba8f01">use_rayleigh_damping</a> ? <a class="code" href="classERF.html#ad598bde8e728479faaa7c2820096b47a">d_rayleigh_ptrs</a>[level][<a class="code" href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a0831ecd8c789131994c1f350dce2b02f">Rayleigh::tau</a> ].data() : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    d_rayleigh_ptrs_at_lev[<a class="code" href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a3d2cdf8cea6cb933d4ce759c1ff1b948">Rayleigh::ubar</a>]     = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a27ced9266434a4680ef175e7b2ba8f01">use_rayleigh_damping</a> ? <a class="code" href="classERF.html#ad598bde8e728479faaa7c2820096b47a">d_rayleigh_ptrs</a>[level][<a class="code" href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a3d2cdf8cea6cb933d4ce759c1ff1b948">Rayleigh::ubar</a>].data() : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    d_rayleigh_ptrs_at_lev[<a class="code" href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239acb08c6a1b8bca5e9e4ef6162aef2cfa4">Rayleigh::vbar</a>]     = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a27ced9266434a4680ef175e7b2ba8f01">use_rayleigh_damping</a> ? <a class="code" href="classERF.html#ad598bde8e728479faaa7c2820096b47a">d_rayleigh_ptrs</a>[level][<a class="code" href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239acb08c6a1b8bca5e9e4ef6162aef2cfa4">Rayleigh::vbar</a>].data() : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    d_rayleigh_ptrs_at_lev[<a class="code" href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a3d8bd6001a2421b06c3ec4e9f2dcdffd">Rayleigh::wbar</a>]     = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a27ced9266434a4680ef175e7b2ba8f01">use_rayleigh_damping</a> ? <a class="code" href="classERF.html#ad598bde8e728479faaa7c2820096b47a">d_rayleigh_ptrs</a>[level][<a class="code" href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a3d8bd6001a2421b06c3ec4e9f2dcdffd">Rayleigh::wbar</a>].data() : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    d_rayleigh_ptrs_at_lev[<a class="code" href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239ae41e9f65f26ee3b04db07f2db7f28bdb">Rayleigh::thetabar</a>] = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a27ced9266434a4680ef175e7b2ba8f01">use_rayleigh_damping</a> ? <a class="code" href="classERF.html#ad598bde8e728479faaa7c2820096b47a">d_rayleigh_ptrs</a>[level][<a class="code" href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239ae41e9f65f26ee3b04db07f2db7f28bdb">Rayleigh::thetabar</a>].data() : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keywordtype">bool</span> l_use_terrain = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a063a88594452100497651e8aaf1f68d7">use_terrain</a>;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordtype">bool</span> l_use_diff    = ( (dc.<a class="code" href="structDiffChoice.html#aed5c75ec58e358a735d97869147b2baf">molec_diff_type</a> != <a class="code" href="DiffStruct_8H.html#a84e6bfbbb8e490790c506939b364f735a6adf97f83acf6453d4a6a4b1070f3754">MolecDiffType::None</a>) ||</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                           (tc.<a class="code" href="structTurbChoice.html#abbba68e0d699dd97701d31a0e37d5304">les_type</a>        !=       <a class="code" href="TurbStruct_8H.html#aa346fa9f5c0cb101a7766563fb76c500a6adf97f83acf6453d4a6a4b1070f3754">LESType::None</a>) ||</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                           (tc.<a class="code" href="structTurbChoice.html#a15b9bb58cde72bab3f5714934125f3f9">pbl_type</a>        !=       <a class="code" href="TurbStruct_8H.html#a4a079f2650ca30c787a8375ec5f17ca5a6adf97f83acf6453d4a6a4b1070f3754">PBLType::None</a>) );</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordtype">bool</span> l_use_kturb   = ( (tc.<a class="code" href="structTurbChoice.html#abbba68e0d699dd97701d31a0e37d5304">les_type</a> != <a class="code" href="TurbStruct_8H.html#aa346fa9f5c0cb101a7766563fb76c500a6adf97f83acf6453d4a6a4b1070f3754">LESType::None</a>)   ||</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                           (tc.<a class="code" href="structTurbChoice.html#a15b9bb58cde72bab3f5714934125f3f9">pbl_type</a> != <a class="code" href="TurbStruct_8H.html#a4a079f2650ca30c787a8375ec5f17ca5a6adf97f83acf6453d4a6a4b1070f3754">PBLType::None</a>) );</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> use_most = (<a class="code" href="classERF.html#a051364b2373d8d86151c0b4a958035bd">m_most</a> != <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    amrex::ignore_unused(use_most);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keyword">const</span> BoxArray&amp; ba            = state_old[<a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daa2e7100afbf5e7a39371f1cb29f6f570a">IntVars::cons</a>].boxArray();</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keyword">const</span> BoxArray&amp; ba_z          = zvel_old.boxArray();</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keyword">const</span> DistributionMapping&amp; dm = state_old[<a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daa2e7100afbf5e7a39371f1cb29f6f570a">IntVars::cons</a>].DistributionMap();</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keywordtype">int</span> num_prim = state_old[<a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daa2e7100afbf5e7a39371f1cb29f6f570a">IntVars::cons</a>].nComp() - 1;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    MultiFab    S_prim  (ba  , dm, num_prim,          state_old[<a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daa2e7100afbf5e7a39371f1cb29f6f570a">IntVars::cons</a>].nGrowVect());</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    MultiFab  pi_stage  (ba  , dm,        1,          state_old[<a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daa2e7100afbf5e7a39371f1cb29f6f570a">IntVars::cons</a>].nGrowVect());</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    MultiFab fast_coeffs(ba_z, dm,        5,          0);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    MultiFab* eddyDiffs = <a class="code" href="classERF.html#a327d704704abd516be19339cb2d226f9">eddyDiffs_lev</a>[level].get();</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    MultiFab* SmnSmn    = <a class="code" href="classERF.html#a9faaa96a7c270d2b2b062d9f30f19711">SmnSmn_lev</a>[level].get();</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="comment">// **************************************************************************************</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="comment">// Compute strain for use in slow RHS, Smagorinsky model, and MOST</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="comment">// **************************************************************************************</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    MultiFab* Tau11 = <a class="code" href="classERF.html#aeb9348353b2415d023d8f52c293cad7e">Tau11_lev</a>[level].get();</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    MultiFab* Tau22 = <a class="code" href="classERF.html#afb4294f848d86e4aefb74848bb71047e">Tau22_lev</a>[level].get();</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    MultiFab* Tau33 = <a class="code" href="classERF.html#a60a185c47f07bf4fb537a15d5a226d8a">Tau33_lev</a>[level].get();</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    MultiFab* Tau12 = <a class="code" href="classERF.html#ad8c2eca71737b102cc5cf75f97c6bd63">Tau12_lev</a>[level].get();</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    MultiFab* Tau13 = <a class="code" href="classERF.html#a5392e6104804d799b3fd943dfe390766">Tau13_lev</a>[level].get();</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    MultiFab* Tau23 = <a class="code" href="classERF.html#a03a4ad7368c1c98b492cd9d9fec9cbc5">Tau23_lev</a>[level].get();</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    MultiFab* Tau21 = <a class="code" href="classERF.html#a547864dc0347f4620feb99ed564acb4d">Tau21_lev</a>[level].get();</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    MultiFab* Tau31 = <a class="code" href="classERF.html#a203e7334296218672e36bab93174e146">Tau31_lev</a>[level].get();</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    MultiFab* Tau32 = <a class="code" href="classERF.html#aa650bf1f6885b179fd8d4c24b48668cb">Tau32_lev</a>[level].get();</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    BL_PROFILE(<span class="stringliteral">&quot;erf_advance_strain&quot;</span>);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordflow">if</span> (l_use_diff) {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="keyword">const</span> BCRec* bc_ptr_h = <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>.data();</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="keyword">const</span> GpuArray&lt;Real, AMREX_SPACEDIM&gt; dxInv = fine_geom.InvCellSizeArray();</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="preprocessor">#pragma omp parallel if (Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <span class="keywordflow">for</span> ( MFIter mfi(state_new[<a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daa2e7100afbf5e7a39371f1cb29f6f570a">IntVars::cons</a>],<a class="code" href="TileNoZ_8H.html#a8da113f1d5603f7297fe1d03e5013f00">TileNoZ</a>()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            Box bxcc  = mfi.growntilebox(IntVect(1,1,0));</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            Box tbxxy = mfi.tilebox(IntVect(1,1,0),IntVect(1,1,0));</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            Box tbxxz = mfi.tilebox(IntVect(1,0,1),IntVect(1,1,0));</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            Box tbxyz = mfi.tilebox(IntVect(0,1,1),IntVect(1,1,0));</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            <span class="keyword">const</span> Array4&lt;const Real&gt; &amp; u = xvel_old.array(mfi);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            <span class="keyword">const</span> Array4&lt;const Real&gt; &amp; v = yvel_old.array(mfi);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            <span class="keyword">const</span> Array4&lt;const Real&gt; &amp; w = zvel_old.array(mfi);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            Array4&lt;Real&gt; tau11 = Tau11-&gt;array(mfi);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            Array4&lt;Real&gt; tau22 = Tau22-&gt;array(mfi);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            Array4&lt;Real&gt; tau33 = Tau33-&gt;array(mfi);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            Array4&lt;Real&gt; tau12 = Tau12-&gt;array(mfi);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            Array4&lt;Real&gt; tau13 = Tau13-&gt;array(mfi);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            Array4&lt;Real&gt; tau23 = Tau23-&gt;array(mfi);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160; </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            Array4&lt;Real&gt; tau21  = l_use_terrain ? Tau21-&gt;array(mfi) : Array4&lt;Real&gt;{};</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            Array4&lt;Real&gt; tau31  = l_use_terrain ? Tau31-&gt;array(mfi) : Array4&lt;Real&gt;{};</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            Array4&lt;Real&gt; tau32  = l_use_terrain ? Tau32-&gt;array(mfi) : Array4&lt;Real&gt;{};</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            <span class="keyword">const</span> Array4&lt;const Real&gt;&amp; z_nd = l_use_terrain ? <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[level]-&gt;const_array(mfi) : Array4&lt;const Real&gt;{};</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            <span class="keyword">const</span> Array4&lt;const Real&gt; mf_m = <a class="code" href="classERF.html#a23aacdb72e9d2dfed8e2ebd2c2526497">mapfac_m</a>[level]-&gt;array(mfi);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            <span class="keyword">const</span> Array4&lt;const Real&gt; mf_u = <a class="code" href="classERF.html#a1e8afee1508b720dab56f5d044deb301">mapfac_u</a>[level]-&gt;array(mfi);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            <span class="keyword">const</span> Array4&lt;const Real&gt; mf_v = <a class="code" href="classERF.html#ae49b5055f9a7117fa15918a5daa775b7">mapfac_v</a>[level]-&gt;array(mfi);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            <span class="keywordflow">if</span> (l_use_terrain) {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                <a class="code" href="ComputeStrain__T_8cpp.html#ac6a307fd66f18cab5974d8f9487ec352">ComputeStrain_T</a>(bxcc, tbxxy, tbxxz, tbxyz,</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                                u, v, w,</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                                tau11, tau22, tau33,</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                                tau12, tau13,</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                                tau21, tau23,</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                                tau31, tau32,</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                                z_nd, bc_ptr_h, dxInv,</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                                mf_m, mf_u, mf_v);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                <a class="code" href="ComputeStrain__N_8cpp.html#a2014bd585f4d40660d263804bf9bb2fa">ComputeStrain_N</a>(bxcc, tbxxy, tbxxz, tbxyz,</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                                u, v, w,</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                                tau11, tau22, tau33,</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                                tau12, tau13, tau23,</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                                bc_ptr_h, dxInv,</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                                mf_m, mf_u, mf_v);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        } <span class="comment">// mfi</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    } <span class="comment">// l_use_diff</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    } <span class="comment">// profile</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    MultiFab Omega (state_old[<a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daaaab25f707cae69bfadac2abcd17a2188">IntVars::zmom</a>].boxArray(),dm,1,1);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TI__utils_8H.html">TI_utils.H</a>&quot;</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="comment">// Additional SFS quantities, calculated once per timestep</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    MultiFab* Hfx1 = <a class="code" href="classERF.html#a25174b4ae6cfcac8f7d183ce5c9fe67b">SFS_hfx1_lev</a>[level].get();</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    MultiFab* Hfx2 = <a class="code" href="classERF.html#acb607b2e675b45fdcabc09b640ce5ae2">SFS_hfx2_lev</a>[level].get();</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    MultiFab* Hfx3 = <a class="code" href="classERF.html#a1a2e3faf5dd90ad2f9ded28b486f3b46">SFS_hfx3_lev</a>[level].get();</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    MultiFab* Diss = <a class="code" href="classERF.html#a6e1ad417e3bd062468d74830b65911fb">SFS_diss_lev</a>[level].get();</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="comment">// *************************************************************************</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="comment">// Calculate cell-centered eddy viscosity &amp; diffusivities</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="comment">// Notes -- we fill all the data in ghost cells before calling this so</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="comment">//    that we can fill the eddy viscosity in the ghost regions and</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="comment">//    not have to call a boundary filler on this data itself</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="comment">// LES - updates both horizontal and vertical eddy viscosity components</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="comment">// PBL - only updates vertical eddy viscosity components so horizontal</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="comment">//       components come from the LES model or are left as zero.</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="comment">// *************************************************************************</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordflow">if</span> (l_use_kturb)</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    {</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <span class="comment">// NOTE: state_new transfers to state_old for PBL (due to ptr swap in advance)</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <span class="keyword">const</span> BCRec* bc_ptr_d = <a class="code" href="classERF.html#a8a99e22b1111c803e31b4afd5fcdea60">domain_bcs_type_d</a>.data();</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <a class="code" href="ComputeTurbulentViscosity_8cpp.html#a38abb469c263e5cb1c09ba83272bd94a">ComputeTurbulentViscosity</a>(xvel_old, yvel_old,</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                                  *Tau11, *Tau22, *Tau33,</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                                  *Tau12, *Tau13, *Tau23,</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                                  state_old[<a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daa2e7100afbf5e7a39371f1cb29f6f570a">IntVars::cons</a>],</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                                  *eddyDiffs, *Hfx1, *Hfx2, *Hfx3, *Diss, <span class="comment">// to be updated</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                                  fine_geom, *<a class="code" href="classERF.html#a1e8afee1508b720dab56f5d044deb301">mapfac_u</a>[level], *<a class="code" href="classERF.html#ae49b5055f9a7117fa15918a5daa775b7">mapfac_v</a>[level],</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                                  <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[level], tc, <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a47a54f2e44955202b5b437e4b1b4a61b">gravity</a>,</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                                  <a class="code" href="classERF.html#a051364b2373d8d86151c0b4a958035bd">m_most</a>, bc_ptr_d);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    }</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="comment">// ***********************************************************************************************</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="comment">// Update user-defined source terms</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="comment">// ***********************************************************************************************</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a4e81a09c9f454c680568b7776a3ed90e">custom_rhotheta_forcing</a>) {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <a class="code" href="classERF.html#a60e8cb933f237903e3fbcd6376c26db0">prob</a>-&gt;update_rhotheta_sources(old_time,</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                                      <a class="code" href="classERF.html#a87aad7caaf3b575734994b47628a2faf">h_rhotheta_src</a>[level], <a class="code" href="classERF.html#a0c1fdcfbc9cbd6cb13e41d1170b161f8">d_rhotheta_src</a>[level],</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                                      fine_geom, <a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[level]);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    }</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa2e312b4e6d08797fc3c1b6d67313d48">custom_moisture_forcing</a>) {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <a class="code" href="classERF.html#a60e8cb933f237903e3fbcd6376c26db0">prob</a>-&gt;update_rhoqt_sources(old_time,</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                                   <a class="code" href="classERF.html#a3c5eca26a28dda3a981b3581abadfca0">h_rhoqt_src</a>[level], <a class="code" href="classERF.html#a838687881ef3626f932d0e95ceff0e53">d_rhoqt_src</a>[level],</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                                   fine_geom, <a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[level]);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    }</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160; </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="comment">// ***********************************************************************************************</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="comment">// Convert old velocity available on faces to old momentum on faces to be used in time integration</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="comment">// ***********************************************************************************************</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    MultiFab density(state_old[<a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daa2e7100afbf5e7a39371f1cb29f6f570a">IntVars::cons</a>], make_alias, <a class="code" href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>, 1);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <a class="code" href="Utils_8H.html#a087ad6f9e01593fb0cd3624ff6caaf14">VelocityToMomentum</a>(xvel_old, xvel_old.nGrowVect(),</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                       yvel_old, yvel_old.nGrowVect(),</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                       zvel_old, zvel_old.nGrowVect(),</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                       density,</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                       state_old[<a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daaf661293a5a71ca532c214929b98c0bad">IntVars::xmom</a>],</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                       state_old[<a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daa2e60798bc45154a8f905b1aa228a24e5">IntVars::ymom</a>],</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                       state_old[<a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daaaab25f707cae69bfadac2abcd17a2188">IntVars::zmom</a>],</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                       <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa2de671156cccf1f3a34b9f250fb0e28">use_NumDiff</a>);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    MultiFab::Copy(xvel_new,xvel_old,0,0,1,xvel_old.nGrowVect());</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    MultiFab::Copy(yvel_new,yvel_old,0,0,1,yvel_old.nGrowVect());</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    MultiFab::Copy(zvel_new,zvel_old,0,0,1,zvel_old.nGrowVect());</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keywordtype">bool</span> fast_only = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordtype">bool</span> vel_and_mom_synced = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <a class="code" href="TI__utils_8H.html#a5e7934b18ef63bc8c4c16db42277c52f">apply_bcs</a>(state_old, old_time,</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;              state_old[<a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daa2e7100afbf5e7a39371f1cb29f6f570a">IntVars::cons</a>].nGrow(), state_old[<a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daaf661293a5a71ca532c214929b98c0bad">IntVars::xmom</a>].nGrow(),</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;              fast_only, vel_and_mom_synced);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <a class="code" href="TI__utils_8H.html#a76b27b6105fe279f9a43296072c843b3">cons_to_prim</a>(state_old[<a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daa2e7100afbf5e7a39371f1cb29f6f570a">IntVars::cons</a>], state_old[<a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daa2e7100afbf5e7a39371f1cb29f6f570a">IntVars::cons</a>].nGrow());</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TI__no__substep__fun_8H.html">TI_no_substep_fun.H</a>&quot;</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TI__slow__rhs__fun_8H.html">TI_slow_rhs_fun.H</a>&quot;</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TI__fast__rhs__fun_8H.html">TI_fast_rhs_fun.H</a>&quot;</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="comment">// ***************************************************************************************</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="comment">// Setup the integrator and integrate for a single timestep</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="comment">// **************************************************************************************</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <a class="code" href="classMRISplitIntegrator.html">MRISplitIntegrator&lt;Vector&lt;MultiFab&gt;</a> &gt;&amp; mri_integrator = *<a class="code" href="classERF.html#a09d0fb2bd609c898a665d9530a744585">mri_integrator_mem</a>[level];</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="comment">// Define rhs and &#39;post update&#39; utility function that is called after calculating</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="comment">// any state data (e.g. at RK stages or at the end of a timestep)</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    mri_integrator.<a class="code" href="classMRISplitIntegrator.html#a137a1ceb1e8051b5a97aaab40492c0e1">set_slow_rhs_pre</a>(<a class="code" href="TI__slow__rhs__fun_8H.html#a963142d364408ee1775dbef20383b244">slow_rhs_fun_pre</a>);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    mri_integrator.<a class="code" href="classMRISplitIntegrator.html#af086d3c68787442d07f0a9d530618cc1">set_slow_rhs_post</a>(<a class="code" href="TI__slow__rhs__fun_8H.html#af460c930508105e92f60fd868d23ebcf">slow_rhs_fun_post</a>);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    mri_integrator.<a class="code" href="classMRISplitIntegrator.html#a7c3d1c29712cdc8888af315d37960561">set_pre_update</a> (<a class="code" href="TI__slow__rhs__fun_8H.html#aadc7f4c039b08417963410e7f76bb2dd">pre_update_fun</a>);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    mri_integrator.<a class="code" href="classMRISplitIntegrator.html#a95b3c0742918b516a3d12a60eb280b48">set_post_update</a>(<a class="code" href="TI__slow__rhs__fun_8H.html#afd90eac481ef47af3b095c56653098e8">post_update_fun</a>);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="preprocessor">#ifdef ERF_USE_POISSON_SOLVE</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#af39df4d1618645dcc1fb8678f738e3f0">incompressible</a>) {</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        mri_integrator.<a class="code" href="classMRISplitIntegrator.html#a26955c190dfb0d6cef7237198dbfd099">set_slow_rhs_inc</a>(slow_rhs_fun_inc);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    }</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    mri_integrator.<a class="code" href="classMRISplitIntegrator.html#aafed3f1d61d477bd1f01bdeb71a9ab11">set_fast_rhs</a>(<a class="code" href="TI__fast__rhs__fun_8H.html#ac6afbd55bf5b7264098d44d9b8928f57">fast_rhs_fun</a>);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    mri_integrator.<a class="code" href="classMRISplitIntegrator.html#ad31fb2cda1fc2dce80820ed7c4a3c052">set_slow_fast_timestep_ratio</a>(<a class="code" href="classERF.html#ad2e1a979c0ad68e87eaee349beb7e9fd">fixed_mri_dt_ratio</a> &gt; 0 ? <a class="code" href="classERF.html#ad2e1a979c0ad68e87eaee349beb7e9fd">fixed_mri_dt_ratio</a> : <a class="code" href="classERF.html#a3cf7cb2e51eb7b69cb4079ffc6722459">dt_mri_ratio</a>[level]);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    mri_integrator.<a class="code" href="classMRISplitIntegrator.html#a825efb33e69853b14d8e7085ea86edf6">set_no_substep</a>(<a class="code" href="TI__no__substep__fun_8H.html#a4cad8180e91d2eabd5638651fc24bcc7">no_substep_fun</a>);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    mri_integrator.<a class="code" href="classMRISplitIntegrator.html#a16941f966b288f15498914965786649d">advance</a>(state_old, state_new, old_time, dt_advance);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a43d0b17f6e155691a1e9474526df3af5">verbose</a>) Print() &lt;&lt; <span class="stringliteral">&quot;Done with advance_dycore at level &quot;</span> &lt;&lt; level &lt;&lt; std::endl;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;}</div>
<div class="ttc" id="aComputeStrain__N_8cpp_html_a2014bd585f4d40660d263804bf9bb2fa"><div class="ttname"><a href="ComputeStrain__N_8cpp.html#a2014bd585f4d40660d263804bf9bb2fa">ComputeStrain_N</a></div><div class="ttdeci">void ComputeStrain_N(Box bxcc, Box tbxxy, Box tbxxz, Box tbxyz, const Array4&lt; const Real &gt; &amp;u, const Array4&lt; const Real &gt; &amp;v, const Array4&lt; const Real &gt; &amp;w, Array4&lt; Real &gt; &amp;tau11, Array4&lt; Real &gt; &amp;tau22, Array4&lt; Real &gt; &amp;tau33, Array4&lt; Real &gt; &amp;tau12, Array4&lt; Real &gt; &amp;tau13, Array4&lt; Real &gt; &amp;tau23, const BCRec *bc_ptr, const GpuArray&lt; Real, AMREX_SPACEDIM &gt; &amp;dxInv, const Array4&lt; const Real &gt; &amp;mf_m, const Array4&lt; const Real &gt; &amp;mf_u, const Array4&lt; const Real &gt; &amp;mf_v)</div><div class="ttdef"><b>Definition:</b> ComputeStrain_N.cpp:28</div></div>
<div class="ttc" id="aComputeStrain__T_8cpp_html_ac6a307fd66f18cab5974d8f9487ec352"><div class="ttname"><a href="ComputeStrain__T_8cpp.html#ac6a307fd66f18cab5974d8f9487ec352">ComputeStrain_T</a></div><div class="ttdeci">void ComputeStrain_T(Box bxcc, Box tbxxy, Box tbxxz, Box tbxyz, const Array4&lt; const Real &gt; &amp;u, const Array4&lt; const Real &gt; &amp;v, const Array4&lt; const Real &gt; &amp;w, Array4&lt; Real &gt; &amp;tau11, Array4&lt; Real &gt; &amp;tau22, Array4&lt; Real &gt; &amp;tau33, Array4&lt; Real &gt; &amp;tau12, Array4&lt; Real &gt; &amp;tau13, Array4&lt; Real &gt; &amp;tau21, Array4&lt; Real &gt; &amp;tau23, Array4&lt; Real &gt; &amp;tau31, Array4&lt; Real &gt; &amp;tau32, const Array4&lt; const Real &gt; &amp;z_nd, const BCRec *bc_ptr, const GpuArray&lt; Real, AMREX_SPACEDIM &gt; &amp;dxInv, const Array4&lt; const Real &gt; &amp;, const Array4&lt; const Real &gt; &amp;mf_u, const Array4&lt; const Real &gt; &amp;mf_v)</div><div class="ttdef"><b>Definition:</b> ComputeStrain_T.cpp:32</div></div>
<div class="ttc" id="aComputeTurbulentViscosity_8cpp_html_a38abb469c263e5cb1c09ba83272bd94a"><div class="ttname"><a href="ComputeTurbulentViscosity_8cpp.html#a38abb469c263e5cb1c09ba83272bd94a">ComputeTurbulentViscosity</a></div><div class="ttdeci">void ComputeTurbulentViscosity(const MultiFab &amp;xvel, const MultiFab &amp;yvel, const MultiFab &amp;Tau11, const MultiFab &amp;Tau22, const MultiFab &amp;Tau33, const MultiFab &amp;Tau12, const MultiFab &amp;Tau13, const MultiFab &amp;Tau23, const MultiFab &amp;cons_in, MultiFab &amp;eddyViscosity, MultiFab &amp;Hfx1, MultiFab &amp;Hfx2, MultiFab &amp;Hfx3, MultiFab &amp;Diss, const Geometry &amp;geom, const MultiFab &amp;mapfac_u, const MultiFab &amp;mapfac_v, const std::unique_ptr&lt; MultiFab &gt; &amp;z_phys_nd, const TurbChoice &amp;turbChoice, const Real const_grav, std::unique_ptr&lt; ABLMost &gt; &amp;most, const BCRec *bc_ptr, bool vert_only)</div><div class="ttdef"><b>Definition:</b> ComputeTurbulentViscosity.cpp:404</div></div>
<div class="ttc" id="aDataStruct_8H_html_a3856c8a2f055327ada182186bfd70239a0831ecd8c789131994c1f350dce2b02f"><div class="ttname"><a href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a0831ecd8c789131994c1f350dce2b02f">tau</a></div><div class="ttdeci">@ tau</div><div class="ttdef"><b>Definition:</b> DataStruct.H:52</div></div>
<div class="ttc" id="aDataStruct_8H_html_a3856c8a2f055327ada182186bfd70239a3d2cdf8cea6cb933d4ce759c1ff1b948"><div class="ttname"><a href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a3d2cdf8cea6cb933d4ce759c1ff1b948">ubar</a></div><div class="ttdeci">@ ubar</div><div class="ttdef"><b>Definition:</b> DataStruct.H:52</div></div>
<div class="ttc" id="aDataStruct_8H_html_a3856c8a2f055327ada182186bfd70239a3d8bd6001a2421b06c3ec4e9f2dcdffd"><div class="ttname"><a href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a3d8bd6001a2421b06c3ec4e9f2dcdffd">wbar</a></div><div class="ttdeci">@ wbar</div><div class="ttdef"><b>Definition:</b> DataStruct.H:52</div></div>
<div class="ttc" id="aDataStruct_8H_html_a3856c8a2f055327ada182186bfd70239acb08c6a1b8bca5e9e4ef6162aef2cfa4"><div class="ttname"><a href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239acb08c6a1b8bca5e9e4ef6162aef2cfa4">vbar</a></div><div class="ttdeci">@ vbar</div><div class="ttdef"><b>Definition:</b> DataStruct.H:52</div></div>
<div class="ttc" id="aDataStruct_8H_html_a3856c8a2f055327ada182186bfd70239ae41e9f65f26ee3b04db07f2db7f28bdb"><div class="ttname"><a href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239ae41e9f65f26ee3b04db07f2db7f28bdb">thetabar</a></div><div class="ttdeci">@ thetabar</div><div class="ttdef"><b>Definition:</b> DataStruct.H:52</div></div>
<div class="ttc" id="aDiffStruct_8H_html_a84e6bfbbb8e490790c506939b364f735a6adf97f83acf6453d4a6a4b1070f3754"><div class="ttname"><a href="DiffStruct_8H.html#a84e6bfbbb8e490790c506939b364f735a6adf97f83acf6453d4a6a4b1070f3754">MolecDiffType::None</a></div><div class="ttdeci">@ None</div></div>
<div class="ttc" id="aTI__fast__rhs__fun_8H_html"><div class="ttname"><a href="TI__fast__rhs__fun_8H.html">TI_fast_rhs_fun.H</a></div></div>
<div class="ttc" id="aTI__fast__rhs__fun_8H_html_ac6afbd55bf5b7264098d44d9b8928f57"><div class="ttname"><a href="TI__fast__rhs__fun_8H.html#ac6afbd55bf5b7264098d44d9b8928f57">fast_rhs_fun</a></div><div class="ttdeci">auto fast_rhs_fun</div><div class="ttdef"><b>Definition:</b> TI_fast_rhs_fun.H:4</div></div>
<div class="ttc" id="aTI__no__substep__fun_8H_html"><div class="ttname"><a href="TI__no__substep__fun_8H.html">TI_no_substep_fun.H</a></div></div>
<div class="ttc" id="aTI__no__substep__fun_8H_html_a4cad8180e91d2eabd5638651fc24bcc7"><div class="ttname"><a href="TI__no__substep__fun_8H.html#a4cad8180e91d2eabd5638651fc24bcc7">no_substep_fun</a></div><div class="ttdeci">auto no_substep_fun</div><div class="ttdef"><b>Definition:</b> TI_no_substep_fun.H:4</div></div>
<div class="ttc" id="aTI__slow__rhs__fun_8H_html"><div class="ttname"><a href="TI__slow__rhs__fun_8H.html">TI_slow_rhs_fun.H</a></div></div>
<div class="ttc" id="aTI__slow__rhs__fun_8H_html_a963142d364408ee1775dbef20383b244"><div class="ttname"><a href="TI__slow__rhs__fun_8H.html#a963142d364408ee1775dbef20383b244">slow_rhs_fun_pre</a></div><div class="ttdeci">auto slow_rhs_fun_pre</div><div class="ttdef"><b>Definition:</b> TI_slow_rhs_fun.H:6</div></div>
<div class="ttc" id="aTI__slow__rhs__fun_8H_html_aadc7f4c039b08417963410e7f76bb2dd"><div class="ttname"><a href="TI__slow__rhs__fun_8H.html#aadc7f4c039b08417963410e7f76bb2dd">pre_update_fun</a></div><div class="ttdeci">auto pre_update_fun</div><div class="ttdef"><b>Definition:</b> TI_slow_rhs_fun.H:238</div></div>
<div class="ttc" id="aTI__slow__rhs__fun_8H_html_af460c930508105e92f60fd868d23ebcf"><div class="ttname"><a href="TI__slow__rhs__fun_8H.html#af460c930508105e92f60fd868d23ebcf">slow_rhs_fun_post</a></div><div class="ttdeci">auto slow_rhs_fun_post</div><div class="ttdef"><b>Definition:</b> TI_slow_rhs_fun.H:255</div></div>
<div class="ttc" id="aTI__slow__rhs__fun_8H_html_afd90eac481ef47af3b095c56653098e8"><div class="ttname"><a href="TI__slow__rhs__fun_8H.html#afd90eac481ef47af3b095c56653098e8">post_update_fun</a></div><div class="ttdeci">auto post_update_fun</div><div class="ttdef"><b>Definition:</b> TI_slow_rhs_fun.H:246</div></div>
<div class="ttc" id="aTI__utils_8H_html"><div class="ttname"><a href="TI__utils_8H.html">TI_utils.H</a></div></div>
<div class="ttc" id="aTI__utils_8H_html_a5e7934b18ef63bc8c4c16db42277c52f"><div class="ttname"><a href="TI__utils_8H.html#a5e7934b18ef63bc8c4c16db42277c52f">apply_bcs</a></div><div class="ttdeci">auto apply_bcs</div><div class="ttdef"><b>Definition:</b> TI_utils.H:40</div></div>
<div class="ttc" id="aTI__utils_8H_html_a76b27b6105fe279f9a43296072c843b3"><div class="ttname"><a href="TI__utils_8H.html#a76b27b6105fe279f9a43296072c843b3">cons_to_prim</a></div><div class="ttdeci">auto cons_to_prim</div><div class="ttdef"><b>Definition:</b> TI_utils.H:4</div></div>
<div class="ttc" id="aTileNoZ_8H_html_a8da113f1d5603f7297fe1d03e5013f00"><div class="ttname"><a href="TileNoZ_8H.html#a8da113f1d5603f7297fe1d03e5013f00">TileNoZ</a></div><div class="ttdeci">AMREX_FORCE_INLINE amrex::IntVect TileNoZ()</div><div class="ttdef"><b>Definition:</b> TileNoZ.H:11</div></div>
<div class="ttc" id="aTurbStruct_8H_html_a4a079f2650ca30c787a8375ec5f17ca5a6adf97f83acf6453d4a6a4b1070f3754"><div class="ttname"><a href="TurbStruct_8H.html#a4a079f2650ca30c787a8375ec5f17ca5a6adf97f83acf6453d4a6a4b1070f3754">PBLType::None</a></div><div class="ttdeci">@ None</div></div>
<div class="ttc" id="aTurbStruct_8H_html_aa346fa9f5c0cb101a7766563fb76c500a6adf97f83acf6453d4a6a4b1070f3754"><div class="ttname"><a href="TurbStruct_8H.html#aa346fa9f5c0cb101a7766563fb76c500a6adf97f83acf6453d4a6a4b1070f3754">LESType::None</a></div><div class="ttdeci">@ None</div></div>
<div class="ttc" id="aUtils_8H_html_a087ad6f9e01593fb0cd3624ff6caaf14"><div class="ttname"><a href="Utils_8H.html#a087ad6f9e01593fb0cd3624ff6caaf14">VelocityToMomentum</a></div><div class="ttdeci">void VelocityToMomentum(const amrex::MultiFab &amp;xvel_in, const amrex::IntVect &amp;xvel_ngrow, const amrex::MultiFab &amp;yvel_in, const amrex::IntVect &amp;yvel_ngrow, const amrex::MultiFab &amp;zvel_in, const amrex::IntVect &amp;zvel_ngrow, const amrex::MultiFab &amp;cons_in, amrex::MultiFab &amp;xmom_out, amrex::MultiFab &amp;ymom_out, amrex::MultiFab &amp;zmom_out, bool l_use_ndiff)</div></div>
<div class="ttc" id="aclassERF_html_a0c1fdcfbc9cbd6cb13e41d1170b161f8"><div class="ttname"><a href="classERF.html#a0c1fdcfbc9cbd6cb13e41d1170b161f8">ERF::d_rhotheta_src</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Gpu::DeviceVector&lt; amrex::Real &gt; &gt; d_rhotheta_src</div><div class="ttdef"><b>Definition:</b> ERF.H:809</div></div>
<div class="ttc" id="aclassERF_html_a3c5eca26a28dda3a981b3581abadfca0"><div class="ttname"><a href="classERF.html#a3c5eca26a28dda3a981b3581abadfca0">ERF::h_rhoqt_src</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; amrex::Real &gt; &gt; h_rhoqt_src</div><div class="ttdef"><b>Definition:</b> ERF.H:811</div></div>
<div class="ttc" id="aclassERF_html_a43d0b17f6e155691a1e9474526df3af5"><div class="ttname"><a href="classERF.html#a43d0b17f6e155691a1e9474526df3af5">ERF::verbose</a></div><div class="ttdeci">static int verbose</div><div class="ttdef"><b>Definition:</b> ERF.H:756</div></div>
<div class="ttc" id="aclassERF_html_a574521986a6e403159f83c8b8123ba90"><div class="ttname"><a href="classERF.html#a574521986a6e403159f83c8b8123ba90">ERF::domain_bcs_type</a></div><div class="ttdeci">amrex::Vector&lt; amrex::BCRec &gt; domain_bcs_type</div><div class="ttdef"><b>Definition:</b> ERF.H:640</div></div>
<div class="ttc" id="aclassERF_html_a838687881ef3626f932d0e95ceff0e53"><div class="ttname"><a href="classERF.html#a838687881ef3626f932d0e95ceff0e53">ERF::d_rhoqt_src</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Gpu::DeviceVector&lt; amrex::Real &gt; &gt; d_rhoqt_src</div><div class="ttdef"><b>Definition:</b> ERF.H:812</div></div>
<div class="ttc" id="aclassERF_html_a87aad7caaf3b575734994b47628a2faf"><div class="ttname"><a href="classERF.html#a87aad7caaf3b575734994b47628a2faf">ERF::h_rhotheta_src</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; amrex::Real &gt; &gt; h_rhotheta_src</div><div class="ttdef"><b>Definition:</b> ERF.H:808</div></div>
<div class="ttc" id="aclassERF_html_a8a99e22b1111c803e31b4afd5fcdea60"><div class="ttname"><a href="classERF.html#a8a99e22b1111c803e31b4afd5fcdea60">ERF::domain_bcs_type_d</a></div><div class="ttdeci">amrex::Gpu::DeviceVector&lt; amrex::BCRec &gt; domain_bcs_type_d</div><div class="ttdef"><b>Definition:</b> ERF.H:641</div></div>
<div class="ttc" id="aclassERF_html_ac94ddee2f501dbcea2a516284b7119b5"><div class="ttname"><a href="classERF.html#ac94ddee2f501dbcea2a516284b7119b5">ERF::d_w_subsid</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Gpu::DeviceVector&lt; amrex::Real &gt; &gt; d_w_subsid</div><div class="ttdef"><b>Definition:</b> ERF.H:815</div></div>
<div class="ttc" id="aclassERF_html_ad2e1a979c0ad68e87eaee349beb7e9fd"><div class="ttname"><a href="classERF.html#ad2e1a979c0ad68e87eaee349beb7e9fd">ERF::fixed_mri_dt_ratio</a></div><div class="ttdeci">static int fixed_mri_dt_ratio</div><div class="ttdef"><b>Definition:</b> ERF.H:680</div></div>
<div class="ttc" id="aclassERF_html_ad598bde8e728479faaa7c2820096b47a"><div class="ttname"><a href="classERF.html#ad598bde8e728479faaa7c2820096b47a">ERF::d_rayleigh_ptrs</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; amrex::Gpu::DeviceVector&lt; amrex::Real &gt; &gt; &gt; d_rayleigh_ptrs</div><div class="ttdef"><b>Definition:</b> ERF.H:821</div></div>
<div class="ttc" id="aclassMRISplitIntegrator_html"><div class="ttname"><a href="classMRISplitIntegrator.html">MRISplitIntegrator</a></div><div class="ttdef"><b>Definition:</b> ERF_MRI.H:12</div></div>
<div class="ttc" id="aclassMRISplitIntegrator_html_a137a1ceb1e8051b5a97aaab40492c0e1"><div class="ttname"><a href="classMRISplitIntegrator.html#a137a1ceb1e8051b5a97aaab40492c0e1">MRISplitIntegrator::set_slow_rhs_pre</a></div><div class="ttdeci">void set_slow_rhs_pre(std::function&lt; void(T &amp;, T &amp;, T &amp;, T &amp;, const amrex::Real, const amrex::Real, const amrex::Real, const int)&gt; F)</div><div class="ttdef"><b>Definition:</b> ERF_MRI.H:133</div></div>
<div class="ttc" id="aclassMRISplitIntegrator_html_a16941f966b288f15498914965786649d"><div class="ttname"><a href="classMRISplitIntegrator.html#a16941f966b288f15498914965786649d">MRISplitIntegrator::advance</a></div><div class="ttdeci">amrex::Real advance(T &amp;S_old, T &amp;S_new, amrex::Real time, const amrex::Real time_step) override</div><div class="ttdef"><b>Definition:</b> ERF_MRI.H:183</div></div>
<div class="ttc" id="aclassMRISplitIntegrator_html_a26955c190dfb0d6cef7237198dbfd099"><div class="ttname"><a href="classMRISplitIntegrator.html#a26955c190dfb0d6cef7237198dbfd099">MRISplitIntegrator::set_slow_rhs_inc</a></div><div class="ttdeci">void set_slow_rhs_inc(std::function&lt; void(T &amp;, T &amp;, T &amp;, T &amp;, const amrex::Real, const amrex::Real, const amrex::Real, const int)&gt; F)</div><div class="ttdef"><b>Definition:</b> ERF_MRI.H:137</div></div>
<div class="ttc" id="aclassMRISplitIntegrator_html_a7c3d1c29712cdc8888af315d37960561"><div class="ttname"><a href="classMRISplitIntegrator.html#a7c3d1c29712cdc8888af315d37960561">MRISplitIntegrator::set_pre_update</a></div><div class="ttdeci">void set_pre_update(std::function&lt; void(T &amp;, int)&gt; F)</div><div class="ttdef"><b>Definition:</b> ERF_MRI.H:163</div></div>
<div class="ttc" id="aclassMRISplitIntegrator_html_a825efb33e69853b14d8e7085ea86edf6"><div class="ttname"><a href="classMRISplitIntegrator.html#a825efb33e69853b14d8e7085ea86edf6">MRISplitIntegrator::set_no_substep</a></div><div class="ttdeci">void set_no_substep(std::function&lt; void(T &amp;, T &amp;, T &amp;, amrex::Real, amrex::Real)&gt; F)</div><div class="ttdef"><b>Definition:</b> ERF_MRI.H:173</div></div>
<div class="ttc" id="aclassMRISplitIntegrator_html_a95b3c0742918b516a3d12a60eb280b48"><div class="ttname"><a href="classMRISplitIntegrator.html#a95b3c0742918b516a3d12a60eb280b48">MRISplitIntegrator::set_post_update</a></div><div class="ttdeci">void set_post_update(std::function&lt; void(T &amp;, amrex::Real, int, int)&gt; F)</div><div class="ttdef"><b>Definition:</b> ERF_MRI.H:168</div></div>
<div class="ttc" id="aclassMRISplitIntegrator_html_aafed3f1d61d477bd1f01bdeb71a9ab11"><div class="ttname"><a href="classMRISplitIntegrator.html#aafed3f1d61d477bd1f01bdeb71a9ab11">MRISplitIntegrator::set_fast_rhs</a></div><div class="ttdeci">void set_fast_rhs(std::function&lt; void(int, int, int, T &amp;, const T &amp;, T &amp;, T &amp;, T &amp;, const amrex::Real, const amrex::Real, const amrex::Real, const amrex::Real)&gt; F)</div><div class="ttdef"><b>Definition:</b> ERF_MRI.H:146</div></div>
<div class="ttc" id="aclassMRISplitIntegrator_html_ad31fb2cda1fc2dce80820ed7c4a3c052"><div class="ttname"><a href="classMRISplitIntegrator.html#ad31fb2cda1fc2dce80820ed7c4a3c052">MRISplitIntegrator::set_slow_fast_timestep_ratio</a></div><div class="ttdeci">void set_slow_fast_timestep_ratio(const int timestep_ratio=1)</div><div class="ttdef"><b>Definition:</b> ERF_MRI.H:153</div></div>
<div class="ttc" id="aclassMRISplitIntegrator_html_af086d3c68787442d07f0a9d530618cc1"><div class="ttname"><a href="classMRISplitIntegrator.html#af086d3c68787442d07f0a9d530618cc1">MRISplitIntegrator::set_slow_rhs_post</a></div><div class="ttdeci">void set_slow_rhs_post(std::function&lt; void(T &amp;, T &amp;, T &amp;, T &amp;, T &amp;, const amrex::Real, const amrex::Real, const amrex::Real, const int)&gt; F)</div><div class="ttdef"><b>Definition:</b> ERF_MRI.H:141</div></div>
<div class="ttc" id="astructDiffChoice_html"><div class="ttname"><a href="structDiffChoice.html">DiffChoice</a></div><div class="ttdef"><b>Definition:</b> DiffStruct.H:19</div></div>
<div class="ttc" id="astructDiffChoice_html_aed5c75ec58e358a735d97869147b2baf"><div class="ttname"><a href="structDiffChoice.html#aed5c75ec58e358a735d97869147b2baf">DiffChoice::molec_diff_type</a></div><div class="ttdeci">MolecDiffType molec_diff_type</div><div class="ttdef"><b>Definition:</b> DiffStruct.H:76</div></div>
<div class="ttc" id="astructSolverChoice_html_a27ced9266434a4680ef175e7b2ba8f01"><div class="ttname"><a href="structSolverChoice.html#a27ced9266434a4680ef175e7b2ba8f01">SolverChoice::use_rayleigh_damping</a></div><div class="ttdeci">bool use_rayleigh_damping</div><div class="ttdef"><b>Definition:</b> DataStruct.H:370</div></div>
<div class="ttc" id="astructSolverChoice_html_a396122e87a3d15c4ec8666d7dd18c095"><div class="ttname"><a href="structSolverChoice.html#a396122e87a3d15c4ec8666d7dd18c095">SolverChoice::diffChoice</a></div><div class="ttdeci">DiffChoice diffChoice</div><div class="ttdef"><b>Definition:</b> DataStruct.H:351</div></div>
<div class="ttc" id="astructSolverChoice_html_a47a54f2e44955202b5b437e4b1b4a61b"><div class="ttname"><a href="structSolverChoice.html#a47a54f2e44955202b5b437e4b1b4a61b">SolverChoice::gravity</a></div><div class="ttdeci">amrex::Real gravity</div><div class="ttdef"><b>Definition:</b> DataStruct.H:381</div></div>
<div class="ttc" id="astructSolverChoice_html_a4e81a09c9f454c680568b7776a3ed90e"><div class="ttname"><a href="structSolverChoice.html#a4e81a09c9f454c680568b7776a3ed90e">SolverChoice::custom_rhotheta_forcing</a></div><div class="ttdeci">bool custom_rhotheta_forcing</div><div class="ttdef"><b>Definition:</b> DataStruct.H:400</div></div>
<div class="ttc" id="astructSolverChoice_html_a596f061b796ada0389c81a6125150b6e"><div class="ttname"><a href="structSolverChoice.html#a596f061b796ada0389c81a6125150b6e">SolverChoice::custom_w_subsidence</a></div><div class="ttdeci">bool custom_w_subsidence</div><div class="ttdef"><b>Definition:</b> DataStruct.H:402</div></div>
<div class="ttc" id="astructSolverChoice_html_aa2de671156cccf1f3a34b9f250fb0e28"><div class="ttname"><a href="structSolverChoice.html#aa2de671156cccf1f3a34b9f250fb0e28">SolverChoice::use_NumDiff</a></div><div class="ttdeci">bool use_NumDiff</div><div class="ttdef"><b>Definition:</b> DataStruct.H:406</div></div>
<div class="ttc" id="astructSolverChoice_html_aa2e312b4e6d08797fc3c1b6d67313d48"><div class="ttname"><a href="structSolverChoice.html#aa2e312b4e6d08797fc3c1b6d67313d48">SolverChoice::custom_moisture_forcing</a></div><div class="ttdeci">bool custom_moisture_forcing</div><div class="ttdef"><b>Definition:</b> DataStruct.H:401</div></div>
<div class="ttc" id="astructSolverChoice_html_aa53b017d79e0067923180a0aa59367b4"><div class="ttname"><a href="structSolverChoice.html#aa53b017d79e0067923180a0aa59367b4">SolverChoice::turbChoice</a></div><div class="ttdeci">amrex::Vector&lt; TurbChoice &gt; turbChoice</div><div class="ttdef"><b>Definition:</b> DataStruct.H:353</div></div>
<div class="ttc" id="astructSolverChoice_html_af39df4d1618645dcc1fb8678f738e3f0"><div class="ttname"><a href="structSolverChoice.html#af39df4d1618645dcc1fb8678f738e3f0">SolverChoice::incompressible</a></div><div class="ttdeci">int incompressible</div><div class="ttdef"><b>Definition:</b> DataStruct.H:360</div></div>
<div class="ttc" id="astructTurbChoice_html"><div class="ttname"><a href="structTurbChoice.html">TurbChoice</a></div><div class="ttdef"><b>Definition:</b> TurbStruct.H:16</div></div>
<div class="ttc" id="astructTurbChoice_html_a15b9bb58cde72bab3f5714934125f3f9"><div class="ttname"><a href="structTurbChoice.html#a15b9bb58cde72bab3f5714934125f3f9">TurbChoice::pbl_type</a></div><div class="ttdeci">PBLType pbl_type</div><div class="ttdef"><b>Definition:</b> TurbStruct.H:279</div></div>
<div class="ttc" id="astructTurbChoice_html_abbba68e0d699dd97701d31a0e37d5304"><div class="ttname"><a href="structTurbChoice.html#abbba68e0d699dd97701d31a0e37d5304">TurbChoice::les_type</a></div><div class="ttdeci">LESType les_type</div><div class="ttdef"><b>Definition:</b> TurbStruct.H:256</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a9068176f45cea5fdbbbf3c8eb08bd808_cgraph.png" border="0" usemap="#aclassERF_a9068176f45cea5fdbbbf3c8eb08bd808_cgraph" alt=""/></div>
<map name="aclassERF_a9068176f45cea5fdbbbf3c8eb08bd808_cgraph" id="aclassERF_a9068176f45cea5fdbbbf3c8eb08bd808_cgraph">
<area shape="rect" title=" " alt="" coords="5,837,165,863"/>
<area shape="rect" href="classMRISplitIntegrator.html#a16941f966b288f15498914965786649d" title=" " alt="" coords="254,107,394,148"/>
<area shape="rect" href="ComputeStrain__N_8cpp.html#a2014bd585f4d40660d263804bf9bb2fa" title=" " alt="" coords="256,299,392,326"/>
<area shape="rect" href="ComputeStrain__T_8cpp.html#ac6a307fd66f18cab5974d8f9487ec352" title=" " alt="" coords="257,350,391,377"/>
<area shape="rect" href="ComputeTurbulentViscosity_8cpp.html#a38abb469c263e5cb1c09ba83272bd94a" title=" " alt="" coords="224,629,424,655"/>
<area shape="rect" href="TileNoZ_8H.html#a8da113f1d5603f7297fe1d03e5013f00" title=" " alt="" coords="845,730,918,757"/>
<area shape="rect" href="classMRISplitIntegrator.html#aafed3f1d61d477bd1f01bdeb71a9ab11" title=" " alt="" coords="254,731,394,772"/>
<area shape="rect" href="classMRISplitIntegrator.html#a825efb33e69853b14d8e7085ea86edf6" title=" " alt="" coords="254,796,394,837"/>
<area shape="rect" href="classMRISplitIntegrator.html#a95b3c0742918b516a3d12a60eb280b48" title=" " alt="" coords="254,861,394,903"/>
<area shape="rect" href="classMRISplitIntegrator.html#a7c3d1c29712cdc8888af315d37960561" title=" " alt="" coords="254,927,394,968"/>
<area shape="rect" href="classMRISplitIntegrator.html#ad31fb2cda1fc2dce80820ed7c4a3c052" title=" " alt="" coords="213,992,435,1033"/>
<area shape="rect" href="classMRISplitIntegrator.html#a26955c190dfb0d6cef7237198dbfd099" title=" " alt="" coords="254,1057,394,1099"/>
<area shape="rect" href="classMRISplitIntegrator.html#af086d3c68787442d07f0a9d530618cc1" title=" " alt="" coords="249,1123,399,1164"/>
<area shape="rect" href="classMRISplitIntegrator.html#a137a1ceb1e8051b5a97aaab40492c0e1" title=" " alt="" coords="253,1188,395,1229"/>
<area shape="rect" href="Utils_8H.html#a087ad6f9e01593fb0cd3624ff6caaf14" title=" " alt="" coords="243,1254,405,1281"/>
<area shape="rect" href="classMRISplitIntegrator.html#aba63019a6ac3ea9135772dcd91f49c86" title=" " alt="" coords="489,5,712,47"/>
<area shape="rect" href="TerrainMetrics_8H.html#a43b431cbd97421014ff80245883e06d2" title=" " alt="" coords="494,325,707,351"/>
<area shape="rect" href="TerrainMetrics_8H.html#aed973861215c4eb0697f7a83b37016a9" title=" " alt="" coords="489,375,713,402"/>
<area shape="rect" href="TerrainMetrics_8H.html#ac1434a53d9966d992133433473bc629a" title=" " alt="" coords="486,426,715,453"/>
<area shape="rect" href="TerrainMetrics_8H.html#ada44020dc4ec27c5bebf8fd82d336cee" title=" " alt="" coords="499,477,703,503"/>
<area shape="rect" href="TerrainMetrics_8H.html#a1582797e6ac6cf0c1e0b94a619bc13b8" title=" " alt="" coords="493,71,708,98"/>
<area shape="rect" href="TerrainMetrics_8H.html#a07e83bf0f142a953679c9edfa42b398d" title=" " alt="" coords="491,122,711,149"/>
<area shape="rect" href="TerrainMetrics_8H.html#a32eeeb066c70da970aa6a60918515987" title=" " alt="" coords="771,578,991,605"/>
<area shape="rect" href="TerrainMetrics_8H.html#a3e3ceccddeb3cca9d9e4573af2311a5e" title=" " alt="" coords="485,173,716,199"/>
<area shape="rect" href="TerrainMetrics_8H.html#a21aac76e0b284b33e302526e1f292c76" title=" " alt="" coords="485,223,716,250"/>
<area shape="rect" href="TerrainMetrics_8H.html#a2b9e684355ee8d6dad22950c8c51716b" title=" " alt="" coords="483,274,719,301"/>
<area shape="rect" href="ComputeTurbulentViscosity_8cpp.html#ab6f1ccaf44801ed9da070dcfc808d326" title=" " alt="" coords="489,629,712,655"/>
<area shape="rect" href="ComputeTurbulentViscosity_8cpp.html#af51a779cc7294b769e8c6d37451e9639" title=" " alt="" coords="489,527,713,554"/>
<area shape="rect" href="EddyViscosity_8H.html#ac65b7bc704e954fdb6c75920639b1cec" title=" " alt="" coords="812,629,951,655"/>
<area shape="rect" href="ERF__ReadBndryPlanes_8cpp.html#a63d3125f6fd361f61d697799f46da817" title=" " alt="" coords="852,679,911,706"/>
<area shape="rect" href="TerrainMetrics_8H.html#a41f9b3a5604791daf44935b10a55a565" title=" " alt="" coords="780,477,983,503"/>
<area shape="rect" href="PBLModels_8H.html#a4f010fa74c87ce3a524f53c2f501255b" title=" " alt="" coords="767,527,996,554"/>
</map>
</div>

</div>
</div>
<a id="ac3f83ba16254a0efd4395900cef97efc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3f83ba16254a0efd4395900cef97efc">&#9670;&nbsp;</a></span>advance_lsm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::advance_lsm </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real &amp;&#160;</td>
          <td class="paramname"><em>dt_advance</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;{</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a43c1741535574c7e6f4fe6bf90552f31">lsm_type</a> != <a class="code" href="DataStruct_8H.html#abeec366fd5381f3bb7ba39f6e5c1e7e4a6adf97f83acf6453d4a6a4b1070f3754">LandSurfaceType::None</a>) {</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;        <a class="code" href="classERF.html#ae0e9a78f120ba632d78cbf23c97b851c">lsm</a>.<a class="code" href="classLandSurface.html#a2170397164e0f533884e744a2a73deb7">Advance</a>(lev, dt_advance);</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    }</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;}</div>
<div class="ttc" id="aDataStruct_8H_html_abeec366fd5381f3bb7ba39f6e5c1e7e4a6adf97f83acf6453d4a6a4b1070f3754"><div class="ttname"><a href="DataStruct_8H.html#abeec366fd5381f3bb7ba39f6e5c1e7e4a6adf97f83acf6453d4a6a4b1070f3754">LandSurfaceType::None</a></div><div class="ttdeci">@ None</div></div>
<div class="ttc" id="aclassLandSurface_html_a2170397164e0f533884e744a2a73deb7"><div class="ttname"><a href="classLandSurface.html#a2170397164e0f533884e744a2a73deb7">LandSurface::Advance</a></div><div class="ttdeci">void Advance(const int &amp;lev, const amrex::Real &amp;dt_advance)</div><div class="ttdef"><b>Definition:</b> LandSurface.H:47</div></div>
<div class="ttc" id="astructSolverChoice_html_a43c1741535574c7e6f4fe6bf90552f31"><div class="ttname"><a href="structSolverChoice.html#a43c1741535574c7e6f4fe6bf90552f31">SolverChoice::lsm_type</a></div><div class="ttdeci">LandSurfaceType lsm_type</div><div class="ttdef"><b>Definition:</b> DataStruct.H:413</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a87c9bb3f5c35218b85024312261b098c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87c9bb3f5c35218b85024312261b098c">&#9670;&nbsp;</a></span>advance_microphysics()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::advance_microphysics </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>cons_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real &amp;&#160;</td>
          <td class="paramname"><em>dt_advance</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;{</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> != <a class="code" href="DataStruct_8H.html#ab34704153a585940411c26587cb82ad0a6adf97f83acf6453d4a6a4b1070f3754">MoistureType::None</a>) {</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;        <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;Update_Micro_Vars_Lev(lev, <a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">cons</a>);</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;        <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;Advance(lev, dt_advance, <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>, <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>, <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>);</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;        <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;Update_State_Vars_Lev(lev, <a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">cons</a>);</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    }</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_a4b7277d54649219f31fe286eee9d415a"><div class="ttname"><a href="classERF.html#a4b7277d54649219f31fe286eee9d415a">ERF::micro</a></div><div class="ttdeci">std::unique_ptr&lt; Microphysics &gt; micro</div><div class="ttdef"><b>Definition:</b> ERF.H:573</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7758f75dc7c9029eddc4c58ac0567654"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7758f75dc7c9029eddc4c58ac0567654">&#9670;&nbsp;</a></span>appendPlotVariables()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::appendPlotVariables </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>pp_plot_var_names</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>plot_var_names</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;{</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    ParmParse <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>(<a class="code" href="classERF.html#a59df30e7a5537c8543bb00772bd98b58">pp_prefix</a>);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    Vector&lt;std::string&gt; plot_var_names(0);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.contains(pp_plot_var_names.c_str())) {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        std::string nm;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keywordtype">int</span> nPltVars = <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.countval(pp_plot_var_names.c_str());</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nPltVars; i++) {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.get(pp_plot_var_names.c_str(), nm, i);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            <span class="comment">// Add the named variable to our list of plot variables</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            <span class="comment">// if it is not already in the list</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, nm)) {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                plot_var_names.push_back(nm);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            }</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        }</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    }</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    Vector&lt;std::string&gt; tmp_plot_names(0);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="preprocessor">#ifdef ERF_USE_PARTICLES</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    Vector&lt;std::string&gt; particle_mesh_plot_names;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    particleData.GetMeshPlotVarNames( particle_mesh_plot_names );</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; particle_mesh_plot_names.size(); i++) {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        std::string tmp(particle_mesh_plot_names[i]);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, tmp) ) {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            tmp_plot_names.push_back(tmp);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        }</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    }</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; tmp_plot_names.size(); i++) {</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        a_plot_var_names.push_back( tmp_plot_names[i] );</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    }</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="comment">// Finally, check to see if we found all the requested variables</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; plot_name : plot_var_names) {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(a_plot_var_names, plot_name)) {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;             <span class="keywordflow">if</span> (amrex::ParallelDescriptor::IOProcessor()) {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                 Warning(<span class="stringliteral">&quot;\nWARNING: Requested to plot variable &#39;&quot;</span> + plot_name + <span class="stringliteral">&quot;&#39; but it is not available&quot;</span>);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;             }</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;}</div>
<div class="ttc" id="aMicrophysics__Utils_8H_html_ac54f1d17d8842acb42b2312cd353e469"><div class="ttname"><a href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a></div><div class="ttdeci">AMREX_GPU_HOST_DEVICE AMREX_FORCE_INLINE amrex::Real pp(amrex::Real y)</div><div class="ttdef"><b>Definition:</b> Microphysics_Utils.H:183</div></div>
<div class="ttc" id="aPlotfile_8cpp_html_a1f8554e7b211b0acfc202e8a600e7d67"><div class="ttname"><a href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a></div><div class="ttdeci">bool containerHasElement(const V &amp;iterable, const T &amp;query)</div><div class="ttdef"><b>Definition:</b> Plotfile.cpp:11</div></div>
<div class="ttc" id="aclassERF_html_a59df30e7a5537c8543bb00772bd98b58"><div class="ttname"><a href="classERF.html#a59df30e7a5537c8543bb00772bd98b58">ERF::pp_prefix</a></div><div class="ttdeci">std::string pp_prefix</div><div class="ttdef"><b>Definition:</b> ERF.H:327</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a7758f75dc7c9029eddc4c58ac0567654_cgraph.png" border="0" usemap="#aclassERF_a7758f75dc7c9029eddc4c58ac0567654_cgraph" alt=""/></div>
<map name="aclassERF_a7758f75dc7c9029eddc4c58ac0567654_cgraph" id="aclassERF_a7758f75dc7c9029eddc4c58ac0567654_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,192,57"/>
<area shape="rect" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67" title=" " alt="" coords="240,5,403,32"/>
<area shape="rect" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469" title=" " alt="" coords="302,56,341,83"/>
</map>
</div>

</div>
</div>
<a id="a8202de1f8f372e3e6fdc483447c6a55f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8202de1f8f372e3e6fdc483447c6a55f">&#9670;&nbsp;</a></span>AverageDown()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::AverageDown </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;{</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;    AMREX_ALWAYS_ASSERT(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#af976afa61859c07e6249963edc367c2d">coupling_type</a> == <a class="code" href="DataStruct_8H.html#ad285be248c0803917aaf5cf8ce62139ba6c267346f8ebb889610a5a90838be815">CouplingType::TwoWay</a>);</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    <span class="keywordtype">int</span>  src_comp = 0;</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    <span class="keywordtype">int</span>  num_comp = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[0][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nComp();</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = finest_level-1; lev &gt;= 0; --lev)</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;    {</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;        <a class="code" href="classERF.html#ae17524f168760cf435685a08d97480e7">AverageDownTo</a>(lev,src_comp,num_comp);</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;    }</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;}</div>
<div class="ttc" id="aDataStruct_8H_html_ad285be248c0803917aaf5cf8ce62139ba6c267346f8ebb889610a5a90838be815"><div class="ttname"><a href="DataStruct_8H.html#ad285be248c0803917aaf5cf8ce62139ba6c267346f8ebb889610a5a90838be815">CouplingType::TwoWay</a></div><div class="ttdeci">@ TwoWay</div></div>
<div class="ttc" id="aclassERF_html_ae17524f168760cf435685a08d97480e7"><div class="ttname"><a href="classERF.html#ae17524f168760cf435685a08d97480e7">ERF::AverageDownTo</a></div><div class="ttdeci">void AverageDownTo(int crse_lev, int scomp, int ncomp)</div><div class="ttdef"><b>Definition:</b> ERF.cpp:1506</div></div>
<div class="ttc" id="astructSolverChoice_html_af976afa61859c07e6249963edc367c2d"><div class="ttname"><a href="structSolverChoice.html#af976afa61859c07e6249963edc367c2d">SolverChoice::coupling_type</a></div><div class="ttdeci">CouplingType coupling_type</div><div class="ttdef"><b>Definition:</b> DataStruct.H:409</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae17524f168760cf435685a08d97480e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae17524f168760cf435685a08d97480e7">&#9670;&nbsp;</a></span>AverageDownTo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::AverageDownTo </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>crse_lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>scomp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ncomp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;{</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;    AMREX_ALWAYS_ASSERT(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#af976afa61859c07e6249963edc367c2d">coupling_type</a> == <a class="code" href="DataStruct_8H.html#ad285be248c0803917aaf5cf8ce62139ba6c267346f8ebb889610a5a90838be815">CouplingType::TwoWay</a>);</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160; </div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;    <span class="comment">// ******************************************************************************************</span></div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;    <span class="comment">// First do cell-centered quantities</span></div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;    <span class="comment">// The quantity that is conserved is not (rho S), but rather (rho S / m^2) where</span></div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;    <span class="comment">// m is the map scale factor at cell centers</span></div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;    <span class="comment">// Here we pre-divide (rho S) by m^2 before average down</span></div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;    <span class="comment">// ******************************************************************************************</span></div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = crse_lev; lev &lt;= crse_lev+1; lev++) {</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;      <span class="keywordflow">for</span> (MFIter mfi(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], TilingIfNotGPU()); mfi.isValid(); ++mfi) {</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;        <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;        <span class="keyword">const</span> Array4&lt;      Real&gt;   cons_arr = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].array(mfi);</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;        <span class="keyword">const</span> Array4&lt;const Real&gt; mapfac_arr = <a class="code" href="classERF.html#a23aacdb72e9d2dfed8e2ebd2c2526497">mapfac_m</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a063a88594452100497651e8aaf1f68d7">use_terrain</a>) {</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;            <span class="keyword">const</span> Array4&lt;const Real&gt;   detJ_arr = <a class="code" href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">detJ_cc</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;            ParallelFor(bx, ncomp, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k, <span class="keywordtype">int</span> n) noexcept</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;            {</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;                cons_arr(i,j,k,scomp+n) *= detJ_arr(i,j,k) / (mapfac_arr(i,j,0)*mapfac_arr(i,j,0));</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;            });</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;            ParallelFor(bx, ncomp, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k, <span class="keywordtype">int</span> n) noexcept</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;            {</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;                cons_arr(i,j,k,scomp+n) /= (mapfac_arr(i,j,0)*mapfac_arr(i,j,0));</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;            });</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;        }</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;      } <span class="comment">// mfi</span></div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;    } <span class="comment">// lev</span></div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160; </div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;    average_down(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[crse_lev+1][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;                 <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[crse_lev  ][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;                 scomp, ncomp, refRatio(crse_lev));</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160; </div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;    <span class="comment">// Here we multiply (rho S) by m^2 after average down</span></div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = crse_lev; lev &lt;= crse_lev+1; lev++) {</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;      <span class="keywordflow">for</span> (MFIter mfi(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], TilingIfNotGPU()); mfi.isValid(); ++mfi) {</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;        <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;        <span class="keyword">const</span> Array4&lt;      Real&gt;   cons_arr = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].array(mfi);</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;        <span class="keyword">const</span> Array4&lt;const Real&gt; mapfac_arr = <a class="code" href="classERF.html#a23aacdb72e9d2dfed8e2ebd2c2526497">mapfac_m</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a063a88594452100497651e8aaf1f68d7">use_terrain</a>) {</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;            <span class="keyword">const</span> Array4&lt;const Real&gt;   detJ_arr = <a class="code" href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">detJ_cc</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;            ParallelFor(bx, ncomp, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k, <span class="keywordtype">int</span> n) noexcept</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;            {</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;                cons_arr(i,j,k,scomp+n) *= (mapfac_arr(i,j,0)*mapfac_arr(i,j,0)) / detJ_arr(i,j,k);</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;            });</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;            ParallelFor(bx, ncomp, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k, <span class="keywordtype">int</span> n) noexcept</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;            {</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;                cons_arr(i,j,k,scomp+n) *= (mapfac_arr(i,j,0)*mapfac_arr(i,j,0));</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;            });</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;        }</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;      } <span class="comment">// mfi</span></div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;    } <span class="comment">// lev</span></div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160; </div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;    <span class="comment">// ******************************************************************************************</span></div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;    <span class="comment">// Now average down momenta.</span></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;    <span class="comment">// Note that vars_new holds velocities not momenta, but we want to do conservative</span></div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;    <span class="comment">//    averaging so we first convert to momentum, then average down, then convert</span></div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;    <span class="comment">//    back to velocities -- only on the valid region</span></div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;    <span class="comment">// ******************************************************************************************</span></div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = crse_lev; lev &lt;= crse_lev+1; lev++)</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;    {</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;        <span class="comment">// FillBoundary for density so we can go back and forth between velocity and momentum</span></div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;        <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160; </div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;        <a class="code" href="Utils_8H.html#a087ad6f9e01593fb0cd3624ff6caaf14">VelocityToMomentum</a>(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>], IntVect(0,0,0),</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;                           <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>], IntVect(0,0,0),</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;                           <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>], IntVect(0,0,0),</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;                           <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;                             <a class="code" href="classERF.html#a01f3db32272f53dc68025f0a98195e57">rU_new</a>[lev],</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;                             <a class="code" href="classERF.html#a54e37988486ef96e55e84bd8e91bb688">rV_new</a>[lev],</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;                             <a class="code" href="classERF.html#aa46c0b0d20525aed10f447923e54dde7">rW_new</a>[lev],</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;                           <span class="keyword">true</span>);</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;    }</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160; </div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;    average_down_faces(<a class="code" href="classERF.html#a01f3db32272f53dc68025f0a98195e57">rU_new</a>[crse_lev+1], <a class="code" href="classERF.html#a01f3db32272f53dc68025f0a98195e57">rU_new</a>[crse_lev], refRatio(crse_lev), geom[crse_lev]);</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;    average_down_faces(<a class="code" href="classERF.html#a54e37988486ef96e55e84bd8e91bb688">rV_new</a>[crse_lev+1], <a class="code" href="classERF.html#a54e37988486ef96e55e84bd8e91bb688">rV_new</a>[crse_lev], refRatio(crse_lev), geom[crse_lev]);</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;    average_down_faces(<a class="code" href="classERF.html#aa46c0b0d20525aed10f447923e54dde7">rW_new</a>[crse_lev+1], <a class="code" href="classERF.html#aa46c0b0d20525aed10f447923e54dde7">rW_new</a>[crse_lev], refRatio(crse_lev), geom[crse_lev]);</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160; </div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = crse_lev; lev &lt;= crse_lev+1; lev++) {</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;        <a class="code" href="MomentumToVelocity_8cpp.html#ab444cbf9148a526aaf41e9d510dfedb7">MomentumToVelocity</a>(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;                           <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;                           <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>],</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;                           <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;                             <a class="code" href="classERF.html#a01f3db32272f53dc68025f0a98195e57">rU_new</a>[lev],</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;                             <a class="code" href="classERF.html#a54e37988486ef96e55e84bd8e91bb688">rV_new</a>[lev],</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;                             <a class="code" href="classERF.html#aa46c0b0d20525aed10f447923e54dde7">rW_new</a>[lev]);</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;    }</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;}</div>
<div class="ttc" id="aMomentumToVelocity_8cpp_html_ab444cbf9148a526aaf41e9d510dfedb7"><div class="ttname"><a href="MomentumToVelocity_8cpp.html#ab444cbf9148a526aaf41e9d510dfedb7">MomentumToVelocity</a></div><div class="ttdeci">void MomentumToVelocity(MultiFab &amp;xvel, MultiFab &amp;yvel, MultiFab &amp;zvel, const MultiFab &amp;density, const MultiFab &amp;xmom_in, const MultiFab &amp;ymom_in, const MultiFab &amp;zmom_in)</div><div class="ttdef"><b>Definition:</b> MomentumToVelocity.cpp:23</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_ae17524f168760cf435685a08d97480e7_cgraph.png" border="0" usemap="#aclassERF_ae17524f168760cf435685a08d97480e7_cgraph" alt=""/></div>
<map name="aclassERF_ae17524f168760cf435685a08d97480e7_cgraph" id="aclassERF_ae17524f168760cf435685a08d97480e7_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,164,57"/>
<area shape="rect" href="MomentumToVelocity_8cpp.html#ab444cbf9148a526aaf41e9d510dfedb7" title=" " alt="" coords="212,5,375,32"/>
<area shape="rect" href="Utils_8H.html#a087ad6f9e01593fb0cd3624ff6caaf14" title=" " alt="" coords="212,56,375,83"/>
</map>
</div>

</div>
</div>
<a id="af46289079e053a6d74ddef0bf1a5d8a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af46289079e053a6d74ddef0bf1a5d8a3">&#9670;&nbsp;</a></span>build_fine_mask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MultiFab &amp; ERF::build_fine_mask </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>level</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Helper function for constructing a fine mask, that is, a MultiFab masking coarser data at a lower level by zeroing out covered cells in the fine mask MultiFab we compute.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">level</td><td>Fine level index which masks underlying coarser data </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;{</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="comment">// Mask for zeroing covered cells</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    AMREX_ASSERT(level &gt; 0);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160; </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keyword">const</span> BoxArray&amp; cba = grids[level-1];</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keyword">const</span> DistributionMapping&amp; cdm = dmap[level-1];</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160; </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="comment">// TODO -- we should make a vector of these a member of ERF class</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <a class="code" href="classERF.html#a83c244120a15f0d9b9bca54e93976428">fine_mask</a>.define(cba, cdm, 1, 0, MFInfo());</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <a class="code" href="classERF.html#a83c244120a15f0d9b9bca54e93976428">fine_mask</a>.setVal(1.0);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160; </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    BoxArray fba = grids[level];</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    iMultiFab ifine_mask = makeFineMask(cba, cdm, fba, ref_ratio[level-1], 1, 0);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>  fma =  <a class="code" href="classERF.html#a83c244120a15f0d9b9bca54e93976428">fine_mask</a>.arrays();</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> ifma = ifine_mask.arrays();</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    ParallelFor(<a class="code" href="classERF.html#a83c244120a15f0d9b9bca54e93976428">fine_mask</a>, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> bno, <span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    {</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;       fma[bno](i,j,k) = ifma[bno](i,j,k);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    });</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160; </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classERF.html#a83c244120a15f0d9b9bca54e93976428">fine_mask</a>;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_a83c244120a15f0d9b9bca54e93976428"><div class="ttname"><a href="classERF.html#a83c244120a15f0d9b9bca54e93976428">ERF::fine_mask</a></div><div class="ttdeci">amrex::MultiFab fine_mask</div><div class="ttdef"><b>Definition:</b> ERF.H:850</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac44e400a7ce68e18fa44e9416cb1344e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac44e400a7ce68e18fa44e9416cb1344e">&#9670;&nbsp;</a></span>ClearLevel()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::ClearLevel </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;{</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> var_idx = 0; var_idx &lt; <a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a5deccaa24d5e74279425d7749f7d1494">Vars::NumTypes</a>; ++var_idx) {</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][var_idx].clear();</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        <a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev][var_idx].clear();</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    }</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160; </div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <a class="code" href="classERF.html#a01f3db32272f53dc68025f0a98195e57">rU_new</a>[lev].clear();</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <a class="code" href="classERF.html#a6eecc44323f77917c95869928284f61d">rU_old</a>[lev].clear();</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <a class="code" href="classERF.html#a54e37988486ef96e55e84bd8e91bb688">rV_new</a>[lev].clear();</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <a class="code" href="classERF.html#aeb64e3b4def989ce68d873aefeed5e0e">rV_old</a>[lev].clear();</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <a class="code" href="classERF.html#aa46c0b0d20525aed10f447923e54dde7">rW_new</a>[lev].clear();</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <a class="code" href="classERF.html#ac1fa56ec90f44e3cdf487af46804163f">rW_old</a>[lev].clear();</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160; </div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <span class="comment">// Clears the integrator memory</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <a class="code" href="classERF.html#a09d0fb2bd609c898a665d9530a744585">mri_integrator_mem</a>[lev].reset();</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160; </div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    <span class="comment">// Clears the physical boundary condition routines</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    <a class="code" href="classERF.html#a2e9b04043853d25f2d76edbc0bed2e72">physbcs_cons</a>[lev].reset();</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    <a class="code" href="classERF.html#a64e55e5ae9df06433146db657eb9e72e">physbcs_u</a>[lev].reset();</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <a class="code" href="classERF.html#a79231b5cfd4576a742e46ae0082b5121">physbcs_v</a>[lev].reset();</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    <a class="code" href="classERF.html#a45c8ecd777f47732993777a0afb8e140">physbcs_w</a>[lev].reset();</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    <a class="code" href="classERF.html#a4d717bb9fe936fd1a124d0d3e720f9d1">physbcs_w_no_terrain</a>[lev].reset();</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a62a5ed3c3806eaa918257e0ad1382df5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62a5ed3c3806eaa918257e0ad1382df5">&#9670;&nbsp;</a></span>ComputeDt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::ComputeDt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Function that calls estTimeStep for each level </p>
<div class="fragment"><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;{</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    Vector&lt;Real&gt; dt_tmp(finest_level+1);</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev)</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    {</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;        dt_tmp[lev] = <a class="code" href="classERF.html#a6b1d727e63de2e49aa4f8e00b0dda1d5">estTimeStep</a>(lev, <a class="code" href="classERF.html#a3cf7cb2e51eb7b69cb4079ffc6722459">dt_mri_ratio</a>[lev]);</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    }</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160; </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    ParallelDescriptor::ReduceRealMin(&amp;dt_tmp[0], dt_tmp.size());</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    Real dt_0 = dt_tmp[0];</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="keywordtype">int</span> n_factor = 1;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;        dt_tmp[lev] = amrex::min(dt_tmp[lev], <a class="code" href="classERF.html#ae16d413b172bb3b3400af6d5cb236fd4">change_max</a>*<a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[lev]);</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;        n_factor *= <a class="code" href="classERF.html#aa3db2dd1b65310c66c4038650c22aaee">nsubsteps</a>[lev];</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        dt_0 = amrex::min(dt_0, n_factor*dt_tmp[lev]);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    }</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="comment">// Limit dt&#39;s by the value of stop_time.</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="keyword">const</span> Real eps = 1.e-3*dt_0;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0] + dt_0 &gt; <a class="code" href="classERF.html#a405556a52bef334ab68294c1a540e107">stop_time</a> - eps) {</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        dt_0 = <a class="code" href="classERF.html#a405556a52bef334ab68294c1a540e107">stop_time</a> - <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0];</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    }</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[0] = dt_0;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 1; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[lev] = <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[lev-1] / <a class="code" href="classERF.html#aa3db2dd1b65310c66c4038650c22aaee">nsubsteps</a>[lev];</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    }</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_a405556a52bef334ab68294c1a540e107"><div class="ttname"><a href="classERF.html#a405556a52bef334ab68294c1a540e107">ERF::stop_time</a></div><div class="ttdeci">amrex::Real stop_time</div><div class="ttdef"><b>Definition:</b> ERF.H:667</div></div>
<div class="ttc" id="aclassERF_html_a6b1d727e63de2e49aa4f8e00b0dda1d5"><div class="ttname"><a href="classERF.html#a6b1d727e63de2e49aa4f8e00b0dda1d5">ERF::estTimeStep</a></div><div class="ttdeci">amrex::Real estTimeStep(int lev, long &amp;dt_fast_ratio) const</div><div class="ttdef"><b>Definition:</b> ERF_ComputeTimestep.cpp:49</div></div>
<div class="ttc" id="aclassERF_html_ae16d413b172bb3b3400af6d5cb236fd4"><div class="ttname"><a href="classERF.html#ae16d413b172bb3b3400af6d5cb236fd4">ERF::change_max</a></div><div class="ttdeci">static amrex::Real change_max</div><div class="ttdef"><b>Definition:</b> ERF.H:675</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae68b1f54d196d0a4b19716d65a59d4c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae68b1f54d196d0a4b19716d65a59d4c5">&#9670;&nbsp;</a></span>ComputeGhostCells()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static AMREX_FORCE_INLINE int ERF::ComputeGhostCells </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structAdvChoice.html">AdvChoice</a> &amp;&#160;</td>
          <td class="paramname"><em>advChoice</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>use_num_diff</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    {</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;        <span class="keywordflow">if</span> (use_num_diff)</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;        {</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;            <span class="keywordflow">return</span> 3;</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;            <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                 (advChoice.<a class="code" href="structAdvChoice.html#a81152997920406ea2aa97cbb5af2d9b6">dycore_horiz_adv_type</a>    == <a class="code" href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a8c9475eb6bfde28e5bcb5230ac2e22a9">AdvType::Centered_6th</a>)</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;              || (advChoice.<a class="code" href="structAdvChoice.html#a2dd44749e2d4f224ae1da4f9e53e257a">dycore_vert_adv_type</a>     == <a class="code" href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a8c9475eb6bfde28e5bcb5230ac2e22a9">AdvType::Centered_6th</a>)</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;              || (advChoice.<a class="code" href="structAdvChoice.html#a22f84c60e56d4b3bde6b7f9548c87af3">moistscal_horiz_adv_type</a> == <a class="code" href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a8c9475eb6bfde28e5bcb5230ac2e22a9">AdvType::Centered_6th</a>)</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;              || (advChoice.<a class="code" href="structAdvChoice.html#a22f84c60e56d4b3bde6b7f9548c87af3">moistscal_horiz_adv_type</a> == <a class="code" href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a8c9475eb6bfde28e5bcb5230ac2e22a9">AdvType::Centered_6th</a>)</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;              || (advChoice.<a class="code" href="structAdvChoice.html#a74a383e01c24980b72b920054ee5c1ab">dryscal_horiz_adv_type</a>   == <a class="code" href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a8c9475eb6bfde28e5bcb5230ac2e22a9">AdvType::Centered_6th</a>)</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;              || (advChoice.<a class="code" href="structAdvChoice.html#add9ddd5d61fc695bd2df0e3818767b78">dryscal_vert_adv_type</a>    == <a class="code" href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a8c9475eb6bfde28e5bcb5230ac2e22a9">AdvType::Centered_6th</a>) )</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;            { <span class="keywordflow">return</span> 3; }</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                 (advChoice.<a class="code" href="structAdvChoice.html#a81152997920406ea2aa97cbb5af2d9b6">dycore_horiz_adv_type</a>    == <a class="code" href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a83aec89012c35752597047c6ebdd983a">AdvType::Upwind_5th</a>)</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;              || (advChoice.<a class="code" href="structAdvChoice.html#a2dd44749e2d4f224ae1da4f9e53e257a">dycore_vert_adv_type</a>     == <a class="code" href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a83aec89012c35752597047c6ebdd983a">AdvType::Upwind_5th</a>)</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;              || (advChoice.<a class="code" href="structAdvChoice.html#a22f84c60e56d4b3bde6b7f9548c87af3">moistscal_horiz_adv_type</a> == <a class="code" href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a83aec89012c35752597047c6ebdd983a">AdvType::Upwind_5th</a>)</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;              || (advChoice.<a class="code" href="structAdvChoice.html#a22f84c60e56d4b3bde6b7f9548c87af3">moistscal_horiz_adv_type</a> == <a class="code" href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a83aec89012c35752597047c6ebdd983a">AdvType::Upwind_5th</a>)</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;              || (advChoice.<a class="code" href="structAdvChoice.html#a74a383e01c24980b72b920054ee5c1ab">dryscal_horiz_adv_type</a>   == <a class="code" href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a83aec89012c35752597047c6ebdd983a">AdvType::Upwind_5th</a>)</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;              || (advChoice.<a class="code" href="structAdvChoice.html#add9ddd5d61fc695bd2df0e3818767b78">dryscal_vert_adv_type</a>    == <a class="code" href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a83aec89012c35752597047c6ebdd983a">AdvType::Upwind_5th</a>) )</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;            { <span class="keywordflow">return</span> 3; }</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                  (advChoice.<a class="code" href="structAdvChoice.html#a74a383e01c24980b72b920054ee5c1ab">dryscal_horiz_adv_type</a>   == <a class="code" href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70af2429e8de544f3ebd7c9668e3dbebaa8">AdvType::Weno_5</a>)</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;               || (advChoice.<a class="code" href="structAdvChoice.html#add9ddd5d61fc695bd2df0e3818767b78">dryscal_vert_adv_type</a>    == <a class="code" href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70af2429e8de544f3ebd7c9668e3dbebaa8">AdvType::Weno_5</a>)</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;               || (advChoice.<a class="code" href="structAdvChoice.html#a22f84c60e56d4b3bde6b7f9548c87af3">moistscal_horiz_adv_type</a> == <a class="code" href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70af2429e8de544f3ebd7c9668e3dbebaa8">AdvType::Weno_5</a>)</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;               || (advChoice.<a class="code" href="structAdvChoice.html#a2f888dfcb79cdb766ee04f21aada83ec">moistscal_vert_adv_type</a>  == <a class="code" href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70af2429e8de544f3ebd7c9668e3dbebaa8">AdvType::Weno_5</a>)</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;               || (advChoice.<a class="code" href="structAdvChoice.html#a22f84c60e56d4b3bde6b7f9548c87af3">moistscal_horiz_adv_type</a> == <a class="code" href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70aeb75f5943c7837da80e2048f2b344efc">AdvType::Weno_5Z</a>)</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;               || (advChoice.<a class="code" href="structAdvChoice.html#a2f888dfcb79cdb766ee04f21aada83ec">moistscal_vert_adv_type</a>  == <a class="code" href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70aeb75f5943c7837da80e2048f2b344efc">AdvType::Weno_5Z</a>)</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;               || (advChoice.<a class="code" href="structAdvChoice.html#a74a383e01c24980b72b920054ee5c1ab">dryscal_horiz_adv_type</a>   == <a class="code" href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70aeb75f5943c7837da80e2048f2b344efc">AdvType::Weno_5Z</a>)</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;               || (advChoice.<a class="code" href="structAdvChoice.html#add9ddd5d61fc695bd2df0e3818767b78">dryscal_vert_adv_type</a>    == <a class="code" href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70aeb75f5943c7837da80e2048f2b344efc">AdvType::Weno_5Z</a>) )</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;            { <span class="keywordflow">return</span> 3; }</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;            { <span class="keywordflow">return</span> 2; }</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        }</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    }</div>
<div class="ttc" id="aIndexDefines_8H_html_ada2d84e0dbbfb8d748defbf018748a70a83aec89012c35752597047c6ebdd983a"><div class="ttname"><a href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a83aec89012c35752597047c6ebdd983a">AdvType::Upwind_5th</a></div><div class="ttdeci">@ Upwind_5th</div></div>
<div class="ttc" id="aIndexDefines_8H_html_ada2d84e0dbbfb8d748defbf018748a70a8c9475eb6bfde28e5bcb5230ac2e22a9"><div class="ttname"><a href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a8c9475eb6bfde28e5bcb5230ac2e22a9">AdvType::Centered_6th</a></div><div class="ttdeci">@ Centered_6th</div></div>
<div class="ttc" id="aIndexDefines_8H_html_ada2d84e0dbbfb8d748defbf018748a70aeb75f5943c7837da80e2048f2b344efc"><div class="ttname"><a href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70aeb75f5943c7837da80e2048f2b344efc">AdvType::Weno_5Z</a></div><div class="ttdeci">@ Weno_5Z</div></div>
<div class="ttc" id="aIndexDefines_8H_html_ada2d84e0dbbfb8d748defbf018748a70af2429e8de544f3ebd7c9668e3dbebaa8"><div class="ttname"><a href="IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70af2429e8de544f3ebd7c9668e3dbebaa8">AdvType::Weno_5</a></div><div class="ttdeci">@ Weno_5</div></div>
<div class="ttc" id="astructAdvChoice_html_a22f84c60e56d4b3bde6b7f9548c87af3"><div class="ttname"><a href="structAdvChoice.html#a22f84c60e56d4b3bde6b7f9548c87af3">AdvChoice::moistscal_horiz_adv_type</a></div><div class="ttdeci">AdvType moistscal_horiz_adv_type</div><div class="ttdef"><b>Definition:</b> AdvStruct.H:283</div></div>
<div class="ttc" id="astructAdvChoice_html_a2dd44749e2d4f224ae1da4f9e53e257a"><div class="ttname"><a href="structAdvChoice.html#a2dd44749e2d4f224ae1da4f9e53e257a">AdvChoice::dycore_vert_adv_type</a></div><div class="ttdeci">AdvType dycore_vert_adv_type</div><div class="ttdef"><b>Definition:</b> AdvStruct.H:280</div></div>
<div class="ttc" id="astructAdvChoice_html_a2f888dfcb79cdb766ee04f21aada83ec"><div class="ttname"><a href="structAdvChoice.html#a2f888dfcb79cdb766ee04f21aada83ec">AdvChoice::moistscal_vert_adv_type</a></div><div class="ttdeci">AdvType moistscal_vert_adv_type</div><div class="ttdef"><b>Definition:</b> AdvStruct.H:284</div></div>
<div class="ttc" id="astructAdvChoice_html_a74a383e01c24980b72b920054ee5c1ab"><div class="ttname"><a href="structAdvChoice.html#a74a383e01c24980b72b920054ee5c1ab">AdvChoice::dryscal_horiz_adv_type</a></div><div class="ttdeci">AdvType dryscal_horiz_adv_type</div><div class="ttdef"><b>Definition:</b> AdvStruct.H:281</div></div>
<div class="ttc" id="astructAdvChoice_html_a81152997920406ea2aa97cbb5af2d9b6"><div class="ttname"><a href="structAdvChoice.html#a81152997920406ea2aa97cbb5af2d9b6">AdvChoice::dycore_horiz_adv_type</a></div><div class="ttdeci">AdvType dycore_horiz_adv_type</div><div class="ttdef"><b>Definition:</b> AdvStruct.H:279</div></div>
<div class="ttc" id="astructAdvChoice_html_add9ddd5d61fc695bd2df0e3818767b78"><div class="ttname"><a href="structAdvChoice.html#add9ddd5d61fc695bd2df0e3818767b78">AdvChoice::dryscal_vert_adv_type</a></div><div class="ttdeci">AdvType dryscal_vert_adv_type</div><div class="ttdef"><b>Definition:</b> AdvStruct.H:282</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adc284f421c5fd9dd15c0e5cbe4ff5fc8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc284f421c5fd9dd15c0e5cbe4ff5fc8">&#9670;&nbsp;</a></span>Construct_ERFFillPatchers()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::Construct_ERFFillPatchers </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;{</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;    <span class="keyword">auto</span>&amp; fine_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev];</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    <span class="keyword">auto</span>&amp; crse_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev-1];</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;    <span class="keyword">auto</span>&amp; ba_fine  = fine_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].boxArray();</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;    <span class="keyword">auto</span>&amp; ba_crse  = crse_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].boxArray();</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;    <span class="keyword">auto</span>&amp; dm_fine  = fine_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].DistributionMap();</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;    <span class="keyword">auto</span>&amp; dm_crse  = crse_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].DistributionMap();</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160; </div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;    <span class="keywordtype">int</span> ncomp = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nComp();</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160; </div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;    <a class="code" href="classERF.html#a34160ca20fb400ee285664117cb80512">FPr_c</a>.emplace_back(ba_fine, dm_fine, geom[lev]  ,</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;                       ba_crse, dm_crse, geom[lev-1],</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;                       -<a class="code" href="classERF.html#ad9084179f7384e10a519989ffd51fd34">cf_width</a>, -<a class="code" href="classERF.html#a1e3e2855b6e811596226c167573ad62d">cf_set_width</a>, ncomp, &amp;cell_cons_interp);</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;    <a class="code" href="classERF.html#a0ef3455d5b4fc9a178e023b233d389a4">FPr_u</a>.emplace_back(convert(ba_fine, IntVect(1,0,0)), dm_fine, geom[lev]  ,</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;                       convert(ba_crse, IntVect(1,0,0)), dm_crse, geom[lev-1],</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;                       -<a class="code" href="classERF.html#ad9084179f7384e10a519989ffd51fd34">cf_width</a>, -<a class="code" href="classERF.html#a1e3e2855b6e811596226c167573ad62d">cf_set_width</a>, 1, &amp;face_cons_linear_interp);</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;    <a class="code" href="classERF.html#a1dc7086aec533a042e6033706845b0c3">FPr_v</a>.emplace_back(convert(ba_fine, IntVect(0,1,0)), dm_fine, geom[lev]  ,</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;                       convert(ba_crse, IntVect(0,1,0)), dm_crse, geom[lev-1],</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;                       -<a class="code" href="classERF.html#ad9084179f7384e10a519989ffd51fd34">cf_width</a>, -<a class="code" href="classERF.html#a1e3e2855b6e811596226c167573ad62d">cf_set_width</a>, 1, &amp;face_cons_linear_interp);</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;    <a class="code" href="classERF.html#ac9a11403c2238d0d1e7b65b2d100dbaf">FPr_w</a>.emplace_back(convert(ba_fine, IntVect(0,0,1)), dm_fine, geom[lev]  ,</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;                       convert(ba_crse, IntVect(0,0,1)), dm_crse, geom[lev-1],</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;                       -<a class="code" href="classERF.html#ad9084179f7384e10a519989ffd51fd34">cf_width</a>, -<a class="code" href="classERF.html#a1e3e2855b6e811596226c167573ad62d">cf_set_width</a>, 1, &amp;face_cons_linear_interp);</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_a1e3e2855b6e811596226c167573ad62d"><div class="ttname"><a href="classERF.html#a1e3e2855b6e811596226c167573ad62d">ERF::cf_set_width</a></div><div class="ttdeci">int cf_set_width</div><div class="ttdef"><b>Definition:</b> ERF.H:591</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa2c3ee1910008b828b9da79ccdfe3871"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2c3ee1910008b828b9da79ccdfe3871">&#9670;&nbsp;</a></span>DataLog()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">AMREX_FORCE_INLINE std::ostream&amp; ERF::DataLog </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    {</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;        <span class="keywordflow">return</span> *<a class="code" href="classERF.html#a1cade630b005dbcc0f644987ef3db287">datalog</a>[i];</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    }</div>
<div class="ttc" id="aclassERF_html_a1cade630b005dbcc0f644987ef3db287"><div class="ttname"><a href="classERF.html#a1cade630b005dbcc0f644987ef3db287">ERF::datalog</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; std::fstream &gt; &gt; datalog</div><div class="ttdef"><b>Definition:</b> ERF.H:1032</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a16e1f6b8bbb05ae738daf2abe626c159"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16e1f6b8bbb05ae738daf2abe626c159">&#9670;&nbsp;</a></span>DataLogName()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ERF::DataLogName </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The filename of the ith datalog file. </p>
<div class="fragment"><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classERF.html#a9248a4eb025c2647e003f838cba52a21">datalogname</a>[i]; }</div>
<div class="ttc" id="aclassERF_html_a9248a4eb025c2647e003f838cba52a21"><div class="ttname"><a href="classERF.html#a9248a4eb025c2647e003f838cba52a21">ERF::datalogname</a></div><div class="ttdeci">amrex::Vector&lt; std::string &gt; datalogname</div><div class="ttdef"><b>Definition:</b> ERF.H:1033</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac0951404aa6802aad7a3be6b7375dfa2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0951404aa6802aad7a3be6b7375dfa2">&#9670;&nbsp;</a></span>Define_ERFFillPatchers()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::Define_ERFFillPatchers </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;{</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;    <span class="keyword">auto</span>&amp; fine_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev];</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;    <span class="keyword">auto</span>&amp; crse_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev-1];</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;    <span class="keyword">auto</span>&amp; ba_fine  = fine_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].boxArray();</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;    <span class="keyword">auto</span>&amp; ba_crse  = crse_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].boxArray();</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;    <span class="keyword">auto</span>&amp; dm_fine  = fine_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].DistributionMap();</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;    <span class="keyword">auto</span>&amp; dm_crse  = crse_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].DistributionMap();</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160; </div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    <span class="keywordtype">int</span> ncomp = fine_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nComp();</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160; </div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;    <a class="code" href="classERF.html#a34160ca20fb400ee285664117cb80512">FPr_c</a>[lev-1].Define(ba_fine, dm_fine, geom[lev]  ,</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;                        ba_crse, dm_crse, geom[lev-1],</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;                        -<a class="code" href="classERF.html#ad9084179f7384e10a519989ffd51fd34">cf_width</a>, -<a class="code" href="classERF.html#a1e3e2855b6e811596226c167573ad62d">cf_set_width</a>, ncomp, &amp;cell_cons_interp);</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;    <a class="code" href="classERF.html#a0ef3455d5b4fc9a178e023b233d389a4">FPr_u</a>[lev-1].Define(convert(ba_fine, IntVect(1,0,0)), dm_fine, geom[lev]  ,</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;                        convert(ba_crse, IntVect(1,0,0)), dm_crse, geom[lev-1],</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;                        -<a class="code" href="classERF.html#ad9084179f7384e10a519989ffd51fd34">cf_width</a>, -<a class="code" href="classERF.html#a1e3e2855b6e811596226c167573ad62d">cf_set_width</a>, 1, &amp;face_cons_linear_interp);</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;    <a class="code" href="classERF.html#a1dc7086aec533a042e6033706845b0c3">FPr_v</a>[lev-1].Define(convert(ba_fine, IntVect(0,1,0)), dm_fine, geom[lev]  ,</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;                        convert(ba_crse, IntVect(0,1,0)), dm_crse, geom[lev-1],</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;                        -<a class="code" href="classERF.html#ad9084179f7384e10a519989ffd51fd34">cf_width</a>, -<a class="code" href="classERF.html#a1e3e2855b6e811596226c167573ad62d">cf_set_width</a>, 1, &amp;face_cons_linear_interp);</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;    <a class="code" href="classERF.html#ac9a11403c2238d0d1e7b65b2d100dbaf">FPr_w</a>[lev-1].Define(convert(ba_fine, IntVect(0,0,1)), dm_fine, geom[lev]  ,</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;                        convert(ba_crse, IntVect(0,0,1)), dm_crse, geom[lev-1],</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;                        -<a class="code" href="classERF.html#ad9084179f7384e10a519989ffd51fd34">cf_width</a>, -<a class="code" href="classERF.html#a1e3e2855b6e811596226c167573ad62d">cf_set_width</a>, 1, &amp;face_cons_linear_interp);</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a07f151e7fbc8aa6c4ac8b52bd4c49e2e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07f151e7fbc8aa6c4ac8b52bd4c49e2e">&#9670;&nbsp;</a></span>derive_diag_profiles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::derive_diag_profiles </td>
          <td>(</td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_rho</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_th</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_ksgs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_uu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_uv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_uw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_vv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_vw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_ww</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_uth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_vth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_wth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_thth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_ku</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_kv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_kw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_pu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_pv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_pw</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Computes the profiles for diagnostic quantities.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">h_avg_u</td><td>Profile for x-velocity on Host </td></tr>
    <tr><td class="paramname">h_avg_v</td><td>Profile for y-velocity on Host </td></tr>
    <tr><td class="paramname">h_avg_w</td><td>Profile for z-velocity on Host </td></tr>
    <tr><td class="paramname">h_avg_rho</td><td>Profile for density on Host </td></tr>
    <tr><td class="paramname">h_avg_th</td><td>Profile for potential temperature on Host </td></tr>
    <tr><td class="paramname">h_avg_ksgs</td><td>Profile for Kinetic Energy on Host </td></tr>
    <tr><td class="paramname">h_avg_uu</td><td>Profile for x-velocity squared on Host </td></tr>
    <tr><td class="paramname">h_avg_uv</td><td>Profile for x-velocity * y-velocity on Host </td></tr>
    <tr><td class="paramname">h_avg_uw</td><td>Profile for x-velocity * z-velocity on Host </td></tr>
    <tr><td class="paramname">h_avg_vv</td><td>Profile for y-velocity squared on Host </td></tr>
    <tr><td class="paramname">h_avg_vw</td><td>Profile for y-velocity * z-velocity on Host </td></tr>
    <tr><td class="paramname">h_avg_ww</td><td>Profile for z-velocity squared on Host </td></tr>
    <tr><td class="paramname">h_avg_uth</td><td>Profile for x-velocity * potential temperature on Host </td></tr>
    <tr><td class="paramname">h_avg_uiuiu</td><td>Profile for u_i*u_i*u triple product on Host </td></tr>
    <tr><td class="paramname">h_avg_uiuiv</td><td>Profile for u_i*u_i*v triple product on Host </td></tr>
    <tr><td class="paramname">h_avg_uiuiw</td><td>Profile for u_i*u_i*w triple product on Host </td></tr>
    <tr><td class="paramname">h_avg_p</td><td>Profile for pressure perturbation on Host </td></tr>
    <tr><td class="paramname">h_avg_pu</td><td>Profile for pressure perturbation * x-velocity on Host </td></tr>
    <tr><td class="paramname">h_avg_pv</td><td>Profile for pressure perturbation * y-velocity on Host </td></tr>
    <tr><td class="paramname">h_avg_pw</td><td>Profile for pressure perturbation * z-velocity on Host </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;{</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="comment">// We assume that this is always called at level 0</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordtype">int</span> lev = 0;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordtype">bool</span> l_use_KE  = (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa53b017d79e0067923180a0aa59367b4">turbChoice</a>[lev].les_type == <a class="code" href="TurbStruct_8H.html#aa346fa9f5c0cb101a7766563fb76c500ab7106655ebb5e00e0f040302bf4129bf">LESType::Deardorff</a>);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keywordtype">bool</span> l_use_QKE = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa53b017d79e0067923180a0aa59367b4">turbChoice</a>[lev].use_QKE &amp;&amp; <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa53b017d79e0067923180a0aa59367b4">turbChoice</a>[lev].advect_QKE;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="comment">// This will hold rho, theta, ksgs, uu, uv, uw, vv, vw, ww, uth, vth, wth,</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="comment">//                  0      1     2   3   4   5   6   7   8    9   10   11</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="comment">//                thth, uiuiu, uiuiv, uiuiw, p, pu, pv, pw</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="comment">//                  12     13     14     15 16  17  18  19</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    MultiFab mf_out(grids[lev], dmap[lev], 20, 0);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    MultiFab mf_vels(grids[lev], dmap[lev], AMREX_SPACEDIM, 0);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    MultiFab  u_cc(mf_vels, make_alias, 0, 1); <span class="comment">// u at cell centers</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    MultiFab  v_cc(mf_vels, make_alias, 1, 1); <span class="comment">// v at cell centers</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    MultiFab  w_cc(mf_vels, make_alias, 2, 1); <span class="comment">// w at cell centers</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    average_face_to_cellcenter(mf_vels,0,</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            Array&lt;const MultiFab*,3&gt;{&amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],&amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],&amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>]});</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordtype">int</span> zdir = 2;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keyword">auto</span> domain = geom[0].Domain();</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="comment">// Sum in the horizontal plane</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    h_avg_u  = sumToLine(mf_vels ,0,1,domain,zdir);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    h_avg_v  = sumToLine(mf_vels ,1,1,domain,zdir);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    h_avg_w  = sumToLine(mf_vels ,2,1,domain,zdir);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keywordtype">int</span> hu_size =  h_avg_u.size();</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="comment">// Divide by the total number of cells we are averaging over</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    Real area_z = <span class="keyword">static_cast&lt;</span>Real<span class="keyword">&gt;</span>(domain.length(0)*domain.length(1));</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; hu_size; ++k) {</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        h_avg_u[k] /= area_z; h_avg_v[k] /= area_z; h_avg_w[k] /= area_z;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    }</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a7c3c83d6fcec1f134956c3160adf6e39">nvars</a> = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nComp();</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    MultiFab mf_cons(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], make_alias, 0, <a class="code" href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a7c3c83d6fcec1f134956c3160adf6e39">nvars</a>);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    MultiFab p_hse (<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev], make_alias, 1, 1); <span class="comment">// p_0  is second component</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160; </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keywordtype">bool</span> use_moisture = (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> != <a class="code" href="DataStruct_8H.html#ab34704153a585940411c26587cb82ad0a6adf97f83acf6453d4a6a4b1070f3754">MoistureType::None</a>);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160; </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordflow">for</span> ( MFIter mfi(mf_cons,TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    {</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <span class="keyword">const</span> Array4&lt;Real&gt;&amp; fab_arr = mf_out.array(mfi);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <span class="keyword">const</span> Array4&lt;Real&gt;&amp; u_cc_arr =  u_cc.array(mfi);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <span class="keyword">const</span> Array4&lt;Real&gt;&amp; v_cc_arr =  v_cc.array(mfi);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <span class="keyword">const</span> Array4&lt;Real&gt;&amp; w_cc_arr =  w_cc.array(mfi);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <span class="keyword">const</span> Array4&lt;Real&gt;&amp; cons_arr = mf_cons.array(mfi);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <span class="keyword">const</span> Array4&lt;Real&gt;&amp;   p0_arr = p_hse.array(mfi);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            Real <a class="code" href="namespaceLsmVar__MM5.html#a0c17a1ae9d9db120b8947e6da767cd3baf198df5800148ff3680d005b5fb09c68">theta</a> = cons_arr(i,j,k,<a class="code" href="IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>) / cons_arr(i,j,k,<a class="code" href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            fab_arr(i, j, k, 0) = cons_arr(i,j,k,<a class="code" href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            fab_arr(i, j, k, 1) = <a class="code" href="namespaceLsmVar__MM5.html#a0c17a1ae9d9db120b8947e6da767cd3baf198df5800148ff3680d005b5fb09c68">theta</a>;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            Real ksgs = 0.0;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            <span class="keywordflow">if</span> (l_use_KE)</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                ksgs = cons_arr(i,j,k,<a class="code" href="IndexDefines_8H.html#ae15721db2cb4c2ab4732afe226bbba64">RhoKE_comp</a>) / cons_arr(i,j,k,<a class="code" href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (l_use_QKE)</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                ksgs = cons_arr(i,j,k,<a class="code" href="IndexDefines_8H.html#ac190f1f4846f6e6e31628041150f3d93">RhoQKE_comp</a>) / cons_arr(i,j,k,<a class="code" href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            fab_arr(i, j, k, 2) = ksgs;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            fab_arr(i, j, k, 3) = u_cc_arr(i,j,k) * u_cc_arr(i,j,k);   <span class="comment">// u*u</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            fab_arr(i, j, k, 4) = u_cc_arr(i,j,k) * v_cc_arr(i,j,k);   <span class="comment">// u*v</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            fab_arr(i, j, k, 5) = u_cc_arr(i,j,k) * w_cc_arr(i,j,k);   <span class="comment">// u*w</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            fab_arr(i, j, k, 6) = v_cc_arr(i,j,k) * v_cc_arr(i,j,k);   <span class="comment">// v*v</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            fab_arr(i, j, k, 7) = v_cc_arr(i,j,k) * w_cc_arr(i,j,k);   <span class="comment">// v*w</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            fab_arr(i, j, k, 8) = w_cc_arr(i,j,k) * w_cc_arr(i,j,k);   <span class="comment">// w*w</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            fab_arr(i, j, k, 9) = u_cc_arr(i,j,k) * <a class="code" href="namespaceLsmVar__MM5.html#a0c17a1ae9d9db120b8947e6da767cd3baf198df5800148ff3680d005b5fb09c68">theta</a>; <span class="comment">// u*th</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            fab_arr(i, j, k,10) = v_cc_arr(i,j,k) * <a class="code" href="namespaceLsmVar__MM5.html#a0c17a1ae9d9db120b8947e6da767cd3baf198df5800148ff3680d005b5fb09c68">theta</a>; <span class="comment">// v*th</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            fab_arr(i, j, k,11) = w_cc_arr(i,j,k) * <a class="code" href="namespaceLsmVar__MM5.html#a0c17a1ae9d9db120b8947e6da767cd3baf198df5800148ff3680d005b5fb09c68">theta</a>; <span class="comment">// w*th</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            fab_arr(i, j, k,12) = <a class="code" href="namespaceLsmVar__MM5.html#a0c17a1ae9d9db120b8947e6da767cd3baf198df5800148ff3680d005b5fb09c68">theta</a> * <a class="code" href="namespaceLsmVar__MM5.html#a0c17a1ae9d9db120b8947e6da767cd3baf198df5800148ff3680d005b5fb09c68">theta</a>;           <span class="comment">// th*th</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            Real uiui = fab_arr(i,j,k,3) + fab_arr(i,j,k,6) + fab_arr(i,j,k,8);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            fab_arr(i, j, k,13) = uiui * u_cc_arr(i,j,k);   <span class="comment">// (ui*ui)*u</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            fab_arr(i, j, k,14) = uiui * v_cc_arr(i,j,k);   <span class="comment">// (ui*ui)*v</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            fab_arr(i, j, k,15) = uiui * w_cc_arr(i,j,k);   <span class="comment">// (ui*ui)*w</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            <span class="keywordflow">if</span> (!use_moisture) {</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                Real p = <a class="code" href="EOS_8H.html#a08354ab110fb9e873bce9250b4f4b46e">getPgivenRTh</a>(cons_arr(i, j, k, <a class="code" href="IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>));</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                p -= p0_arr(i,j,k);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                fab_arr(i, j, k,16) = p;                       <span class="comment">// p&#39;</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                fab_arr(i, j, k,17) = p * u_cc_arr(i,j,k);     <span class="comment">// p&#39;*u</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                fab_arr(i, j, k,18) = p * v_cc_arr(i,j,k);     <span class="comment">// p&#39;*v</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                fab_arr(i, j, k,19) = p * w_cc_arr(i,j,k);     <span class="comment">// p&#39;*w</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            }</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        });</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    } <span class="comment">// mfi</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160; </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordflow">if</span> (use_moisture)</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <span class="keywordflow">for</span> ( MFIter mfi(mf_cons,TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        {</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            <span class="keyword">const</span> Array4&lt;Real&gt;&amp; fab_arr  = mf_out.array(mfi);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            <span class="keyword">const</span> Array4&lt;Real&gt;&amp; cons_arr = mf_cons.array(mfi);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            <span class="keyword">const</span> Array4&lt;Real&gt;&amp; u_cc_arr =  u_cc.array(mfi);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            <span class="keyword">const</span> Array4&lt;Real&gt;&amp; v_cc_arr =  v_cc.array(mfi);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            <span class="keyword">const</span> Array4&lt;Real&gt;&amp; w_cc_arr =  w_cc.array(mfi);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            <span class="keyword">const</span> Array4&lt;Real&gt;&amp;   p0_arr = p_hse.array(mfi);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            <span class="keyword">const</span> Array4&lt;Real&gt;&amp;   qv_arr = <a class="code" href="classERF.html#ae00126a9c2738bf6a6cbbe77321c9cfc">qmoist</a>[0][0]-&gt;array(mfi); <span class="comment">// TODO: Is this written only on lev 0?</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                Real p = <a class="code" href="EOS_8H.html#a08354ab110fb9e873bce9250b4f4b46e">getPgivenRTh</a>(cons_arr(i, j, k, <a class="code" href="IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>), qv_arr(i,j,k));</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                p -= p0_arr(i,j,k);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                fab_arr(i, j, k,16) = p;                       <span class="comment">// p&#39;</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                fab_arr(i, j, k,17) = p * u_cc_arr(i,j,k);     <span class="comment">// p&#39;*u</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                fab_arr(i, j, k,18) = p * v_cc_arr(i,j,k);     <span class="comment">// p&#39;*v</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                fab_arr(i, j, k,19) = p * w_cc_arr(i,j,k);     <span class="comment">// p&#39;*w</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            });</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        } <span class="comment">// mfi</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    } <span class="comment">// use_moisture</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    h_avg_rho  = sumToLine(mf_out, 0,1,domain,zdir);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    h_avg_th   = sumToLine(mf_out, 1,1,domain,zdir);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    h_avg_ksgs = sumToLine(mf_out, 2,1,domain,zdir);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    h_avg_uu   = sumToLine(mf_out, 3,1,domain,zdir);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    h_avg_uv   = sumToLine(mf_out, 4,1,domain,zdir);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    h_avg_uw   = sumToLine(mf_out, 5,1,domain,zdir);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    h_avg_vv   = sumToLine(mf_out, 6,1,domain,zdir);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    h_avg_vw   = sumToLine(mf_out, 7,1,domain,zdir);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    h_avg_ww   = sumToLine(mf_out, 8,1,domain,zdir);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    h_avg_uth  = sumToLine(mf_out, 9,1,domain,zdir);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    h_avg_vth  = sumToLine(mf_out,10,1,domain,zdir);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    h_avg_wth  = sumToLine(mf_out,11,1,domain,zdir);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    h_avg_thth = sumToLine(mf_out,12,1,domain,zdir);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    h_avg_uiuiu= sumToLine(mf_out,13,1,domain,zdir);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    h_avg_uiuiv= sumToLine(mf_out,14,1,domain,zdir);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    h_avg_uiuiw= sumToLine(mf_out,15,1,domain,zdir);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    h_avg_p    = sumToLine(mf_out,16,1,domain,zdir);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    h_avg_pu   = sumToLine(mf_out,17,1,domain,zdir);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    h_avg_pv   = sumToLine(mf_out,18,1,domain,zdir);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    h_avg_pw   = sumToLine(mf_out,19,1,domain,zdir);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160; </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="comment">// Divide by the total number of cells we are averaging over</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="keywordtype">int</span> h_avg_u_size = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(h_avg_u.size());</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; h_avg_u_size; ++k) {</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        h_avg_rho[k] /= area_z;  h_avg_ksgs[k] /= area_z;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        h_avg_th[k]  /= area_z;  h_avg_thth[k] /= area_z;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        h_avg_uu[k]  /= area_z;  h_avg_uv[k]   /= area_z;  h_avg_uw[k]  /= area_z;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        h_avg_vv[k]  /= area_z;  h_avg_vw[k]   /= area_z;  h_avg_ww[k]  /= area_z;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        h_avg_uth[k] /= area_z;  h_avg_vth[k]  /= area_z;  h_avg_wth[k] /= area_z;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        h_avg_uiuiu[k] /= area_z;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        h_avg_uiuiv[k] /= area_z;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        h_avg_uiuiw[k] /= area_z;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        h_avg_p[k]   /= area_z;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        h_avg_pu[k]  /= area_z;  h_avg_pv[k]   /= area_z;  h_avg_pw[k]  /= area_z;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    }</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;}</div>
<div class="ttc" id="aEOS_8H_html_a08354ab110fb9e873bce9250b4f4b46e"><div class="ttname"><a href="EOS_8H.html#a08354ab110fb9e873bce9250b4f4b46e">getPgivenRTh</a></div><div class="ttdeci">AMREX_GPU_HOST_DEVICE AMREX_FORCE_INLINE amrex::Real getPgivenRTh(const amrex::Real rhotheta, const amrex::Real qv=0.)</div><div class="ttdef"><b>Definition:</b> EOS.H:62</div></div>
<div class="ttc" id="aIndexDefines_8H_html_ac190f1f4846f6e6e31628041150f3d93"><div class="ttname"><a href="IndexDefines_8H.html#ac190f1f4846f6e6e31628041150f3d93">RhoQKE_comp</a></div><div class="ttdeci">#define RhoQKE_comp</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:15</div></div>
<div class="ttc" id="aIndexDefines_8H_html_ae15721db2cb4c2ab4732afe226bbba64"><div class="ttname"><a href="IndexDefines_8H.html#ae15721db2cb4c2ab4732afe226bbba64">RhoKE_comp</a></div><div class="ttdeci">#define RhoKE_comp</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:14</div></div>
<div class="ttc" id="aTurbStruct_8H_html_aa346fa9f5c0cb101a7766563fb76c500ab7106655ebb5e00e0f040302bf4129bf"><div class="ttname"><a href="TurbStruct_8H.html#aa346fa9f5c0cb101a7766563fb76c500ab7106655ebb5e00e0f040302bf4129bf">LESType::Deardorff</a></div><div class="ttdeci">@ Deardorff</div></div>
<div class="ttc" id="anamespaceLsmVar__MM5_html_a0c17a1ae9d9db120b8947e6da767cd3baf198df5800148ff3680d005b5fb09c68"><div class="ttname"><a href="namespaceLsmVar__MM5.html#a0c17a1ae9d9db120b8947e6da767cd3baf198df5800148ff3680d005b5fb09c68">LsmVar_MM5::theta</a></div><div class="ttdeci">@ theta</div><div class="ttdef"><b>Definition:</b> MM5.H:20</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a07f151e7fbc8aa6c4ac8b52bd4c49e2e_cgraph.png" border="0" usemap="#aclassERF_a07f151e7fbc8aa6c4ac8b52bd4c49e2e_cgraph" alt=""/></div>
<map name="aclassERF_a07f151e7fbc8aa6c4ac8b52bd4c49e2e_cgraph" id="aclassERF_a07f151e7fbc8aa6c4ac8b52bd4c49e2e_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,191,32"/>
<area shape="rect" href="EOS_8H.html#a08354ab110fb9e873bce9250b4f4b46e" title=" " alt="" coords="239,5,349,32"/>
</map>
</div>

</div>
</div>
<a id="a8e3bb984f352bb1b0887d4cf88bc7139"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e3bb984f352bb1b0887d4cf88bc7139">&#9670;&nbsp;</a></span>derive_diag_profiles_stag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::derive_diag_profiles_stag </td>
          <td>(</td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_rho</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_th</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_ksgs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_uu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_uv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_uw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_vv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_vw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_ww</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_uth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_vth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_wth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_thth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_ku</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_kv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_kw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_pu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_pv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_pw</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Computes the profiles for diagnostic quantities at <em>staggered</em> heights.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">h_avg_u</td><td>Profile for x-velocity on Host </td></tr>
    <tr><td class="paramname">h_avg_v</td><td>Profile for y-velocity on Host </td></tr>
    <tr><td class="paramname">h_avg_w</td><td>Profile for z-velocity on Host </td></tr>
    <tr><td class="paramname">h_avg_rho</td><td>Profile for density on Host </td></tr>
    <tr><td class="paramname">h_avg_th</td><td>Profile for potential temperature on Host </td></tr>
    <tr><td class="paramname">h_avg_ksgs</td><td>Profile for Kinetic Energy on Host </td></tr>
    <tr><td class="paramname">h_avg_uu</td><td>Profile for x-velocity squared on Host </td></tr>
    <tr><td class="paramname">h_avg_uv</td><td>Profile for x-velocity * y-velocity on Host </td></tr>
    <tr><td class="paramname">h_avg_uw</td><td>Profile for x-velocity * z-velocity on Host </td></tr>
    <tr><td class="paramname">h_avg_vv</td><td>Profile for y-velocity squared on Host </td></tr>
    <tr><td class="paramname">h_avg_vw</td><td>Profile for y-velocity * z-velocity on Host </td></tr>
    <tr><td class="paramname">h_avg_ww</td><td>Profile for z-velocity squared on Host </td></tr>
    <tr><td class="paramname">h_avg_uth</td><td>Profile for x-velocity * potential temperature on Host </td></tr>
    <tr><td class="paramname">h_avg_uiuiu</td><td>Profile for u_i*u_i*u triple product on Host </td></tr>
    <tr><td class="paramname">h_avg_uiuiv</td><td>Profile for u_i*u_i*v triple product on Host </td></tr>
    <tr><td class="paramname">h_avg_uiuiw</td><td>Profile for u_i*u_i*w triple product on Host </td></tr>
    <tr><td class="paramname">h_avg_p</td><td>Profile for pressure perturbation on Host </td></tr>
    <tr><td class="paramname">h_avg_pu</td><td>Profile for pressure perturbation * x-velocity on Host </td></tr>
    <tr><td class="paramname">h_avg_pv</td><td>Profile for pressure perturbation * y-velocity on Host </td></tr>
    <tr><td class="paramname">h_avg_pw</td><td>Profile for pressure perturbation * z-velocity on Host </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;{</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="comment">// We assume that this is always called at level 0</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keywordtype">int</span> lev = 0;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keywordtype">bool</span> l_use_KE  = (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa53b017d79e0067923180a0aa59367b4">turbChoice</a>[lev].les_type == <a class="code" href="TurbStruct_8H.html#aa346fa9f5c0cb101a7766563fb76c500ab7106655ebb5e00e0f040302bf4129bf">LESType::Deardorff</a>);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keywordtype">bool</span> l_use_QKE = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa53b017d79e0067923180a0aa59367b4">turbChoice</a>[lev].use_QKE &amp;&amp; <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa53b017d79e0067923180a0aa59367b4">turbChoice</a>[lev].advect_QKE;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="comment">// This will hold rho, theta, ksgs, uu, uv, vv, uth, vth, thth, uiuiu, uiuiv, p, pu, pv</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="comment">//         index:   0      1     2   3   4   5    6    7     8      9     10  11 12  13</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    MultiFab mf_out(grids[lev], dmap[lev], 14, 0);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="comment">// This will hold uw, vw, ww, wth, uiuiw, pw (note: uiui == u_i*u_i = u*u + v*v + w*w)</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="comment">//         index:  0   1   2    3      4   5</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    MultiFab mf_out_stag(convert(grids[lev], IntVect(0,0,1)), dmap[lev], 6, 0);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160; </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="comment">// This is only used to average u and v</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    MultiFab mf_vels(grids[lev], dmap[lev], 2, 0);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    MultiFab  u_cc(mf_vels, make_alias, 0, 1); <span class="comment">// u at cell centers</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    MultiFab  v_cc(mf_vels, make_alias, 1, 1); <span class="comment">// v at cell centers</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    MultiFab  w_fc(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>], make_alias, 0, 1); <span class="comment">// w at face centers</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160; </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordtype">int</span> zdir = 2;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keyword">auto</span> domain = geom[0].Domain();</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    Box stag_domain = domain;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    stag_domain.convert(IntVect(0,0,1));</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a7c3c83d6fcec1f134956c3160adf6e39">nvars</a> = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nComp();</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    MultiFab mf_cons(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], make_alias, 0, <a class="code" href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a7c3c83d6fcec1f134956c3160adf6e39">nvars</a>);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    MultiFab p_hse (<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev], make_alias, 1, 1); <span class="comment">// p_0  is second component</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160; </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordtype">bool</span> use_moisture = (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> != <a class="code" href="DataStruct_8H.html#ab34704153a585940411c26587cb82ad0a6adf97f83acf6453d4a6a4b1070f3754">MoistureType::None</a>);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keywordflow">for</span> ( MFIter mfi(mf_cons,TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    {</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <span class="keyword">const</span> Array4&lt;Real&gt;&amp; fab_arr = mf_out.array(mfi);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <span class="keyword">const</span> Array4&lt;Real&gt;&amp; fab_arr_stag = mf_out_stag.array(mfi);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        <span class="keyword">const</span> Array4&lt;Real&gt;&amp; u_arr = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].array(mfi);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        <span class="keyword">const</span> Array4&lt;Real&gt;&amp; v_arr = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].array(mfi);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <span class="keyword">const</span> Array4&lt;Real&gt;&amp; u_cc_arr =  u_cc.array(mfi);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        <span class="keyword">const</span> Array4&lt;Real&gt;&amp; v_cc_arr =  v_cc.array(mfi);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <span class="keyword">const</span> Array4&lt;Real&gt;&amp; w_fc_arr =  w_fc.array(mfi);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <span class="keyword">const</span> Array4&lt;Real&gt;&amp; cons_arr = mf_cons.array(mfi);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <span class="keyword">const</span> Array4&lt;Real&gt;&amp;   p0_arr = p_hse.array(mfi);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160; </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        {</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            u_cc_arr(i,j,k) = 0.5 * (u_arr(i,j,k) + u_arr(i+1,j  ,k));</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            v_cc_arr(i,j,k) = 0.5 * (v_arr(i,j,k) + v_arr(i  ,j+1,k));</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160; </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            Real <a class="code" href="namespaceLsmVar__MM5.html#a0c17a1ae9d9db120b8947e6da767cd3baf198df5800148ff3680d005b5fb09c68">theta</a> = cons_arr(i,j,k,<a class="code" href="IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>) / cons_arr(i,j,k,<a class="code" href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            fab_arr(i, j, k, 0) = cons_arr(i,j,k,<a class="code" href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;            fab_arr(i, j, k, 1) = <a class="code" href="namespaceLsmVar__MM5.html#a0c17a1ae9d9db120b8947e6da767cd3baf198df5800148ff3680d005b5fb09c68">theta</a>;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;            Real ksgs = 0.0;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;            <span class="keywordflow">if</span> (l_use_KE)</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                ksgs = cons_arr(i,j,k,<a class="code" href="IndexDefines_8H.html#ae15721db2cb4c2ab4732afe226bbba64">RhoKE_comp</a>) / cons_arr(i,j,k,<a class="code" href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (l_use_QKE)</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                ksgs = cons_arr(i,j,k,<a class="code" href="IndexDefines_8H.html#ac190f1f4846f6e6e31628041150f3d93">RhoQKE_comp</a>) / cons_arr(i,j,k,<a class="code" href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            fab_arr(i, j, k, 2) = ksgs;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            fab_arr(i, j, k, 3) = u_cc_arr(i,j,k) * u_cc_arr(i,j,k);   <span class="comment">// u*u</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            fab_arr(i, j, k, 4) = u_cc_arr(i,j,k) * v_cc_arr(i,j,k);   <span class="comment">// u*v</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            fab_arr(i, j, k, 5) = v_cc_arr(i,j,k) * v_cc_arr(i,j,k);   <span class="comment">// v*v</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            fab_arr(i, j, k, 6) = u_cc_arr(i,j,k) * <a class="code" href="namespaceLsmVar__MM5.html#a0c17a1ae9d9db120b8947e6da767cd3baf198df5800148ff3680d005b5fb09c68">theta</a>;             <span class="comment">// u*th</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            fab_arr(i, j, k, 7) = v_cc_arr(i,j,k) * <a class="code" href="namespaceLsmVar__MM5.html#a0c17a1ae9d9db120b8947e6da767cd3baf198df5800148ff3680d005b5fb09c68">theta</a>;             <span class="comment">// v*th</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            fab_arr(i, j, k, 8) = <a class="code" href="namespaceLsmVar__MM5.html#a0c17a1ae9d9db120b8947e6da767cd3baf198df5800148ff3680d005b5fb09c68">theta</a> * <a class="code" href="namespaceLsmVar__MM5.html#a0c17a1ae9d9db120b8947e6da767cd3baf198df5800148ff3680d005b5fb09c68">theta</a>;                       <span class="comment">// th*th</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            Real wcc = 0.5 * (w_fc_arr(i,j,k) + w_fc_arr(i,j,k+1));</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            Real uiui = fab_arr(i,j,k,3) + fab_arr(i,j,k,5) + wcc*wcc;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            fab_arr(i, j, k,9 ) = uiui * u_cc_arr(i,j,k);           <span class="comment">// (ui*ui)*u</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            fab_arr(i, j, k,10) = uiui * v_cc_arr(i,j,k);           <span class="comment">// (ui*ui)*v</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160; </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            <span class="keywordflow">if</span> (!use_moisture) {</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                Real p = <a class="code" href="EOS_8H.html#a08354ab110fb9e873bce9250b4f4b46e">getPgivenRTh</a>(cons_arr(i, j, k, <a class="code" href="IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>));</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                p -= p0_arr(i,j,k);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                fab_arr(i, j, k,11) = p;                       <span class="comment">// p&#39;</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                fab_arr(i, j, k,12) = p * u_cc_arr(i,j,k);     <span class="comment">// p&#39;*u</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                fab_arr(i, j, k,13) = p * v_cc_arr(i,j,k);     <span class="comment">// p&#39;*v</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            }</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        });</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160; </div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        <span class="keyword">const</span> Box&amp; zbx = mfi.tilebox(IntVect(0,0,1));</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        ParallelFor(zbx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        {</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            <span class="comment">// average to z faces (first to cell centers, then in z)</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            Real uface = 0.25 * ( u_arr(i  ,j,k) + u_arr(i  ,j,k-1)</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                                + u_arr(i+1,j,k) + u_arr(i+1,j,k-1));</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            Real vface = 0.25 * ( v_arr(i,j  ,k) + v_arr(i,j  ,k-1)</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                                + v_arr(i,j+1,k) + v_arr(i,j+1,k-1));</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;            Real theta0 = cons_arr(i,j,k  ,<a class="code" href="IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>) / cons_arr(i,j,k  ,<a class="code" href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            Real theta1 = cons_arr(i,j,k-1,<a class="code" href="IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>) / cons_arr(i,j,k-1,<a class="code" href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            Real thface = 0.5*(theta0 + theta1);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            fab_arr_stag(i,j,k,0) =           uface * w_fc_arr(i,j,k); <span class="comment">// u*w</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;            fab_arr_stag(i,j,k,1) =           vface * w_fc_arr(i,j,k); <span class="comment">// v*w</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            fab_arr_stag(i,j,k,2) = w_fc_arr(i,j,k) * w_fc_arr(i,j,k); <span class="comment">// w*w</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            fab_arr_stag(i,j,k,3) =          thface * w_fc_arr(i,j,k); <span class="comment">// th*w</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            Real uiui = uface*uface + vface*vface + fab_arr_stag(i,j,k,2);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            fab_arr_stag(i,j,k,4) = uiui * w_fc_arr(i,j,k); <span class="comment">// (ui*ui)*w</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            <span class="keywordflow">if</span> (!use_moisture) {</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                Real p0 = <a class="code" href="EOS_8H.html#a08354ab110fb9e873bce9250b4f4b46e">getPgivenRTh</a>(cons_arr(i, j, k  , <a class="code" href="IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>)) - p0_arr(i,j,k  );</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                Real p1 = <a class="code" href="EOS_8H.html#a08354ab110fb9e873bce9250b4f4b46e">getPgivenRTh</a>(cons_arr(i, j, k-1, <a class="code" href="IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>)) - p0_arr(i,j,k-1);</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                Real pface = 0.5 * (p0 + p1);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                fab_arr_stag(i,j,k,5) = pface * w_fc_arr(i,j,k);       <span class="comment">// p&#39;*w</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;            }</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        });</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    } <span class="comment">// mfi</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="keywordflow">if</span> (use_moisture)</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    {</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        <span class="keywordflow">for</span> ( MFIter mfi(mf_cons,TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        {</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            <span class="keyword">const</span> Array4&lt;Real&gt;&amp; fab_arr  = mf_out.array(mfi);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;            <span class="keyword">const</span> Array4&lt;Real&gt;&amp; fab_arr_stag  = mf_out_stag.array(mfi);</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            <span class="keyword">const</span> Array4&lt;Real&gt;&amp; cons_arr = mf_cons.array(mfi);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;            <span class="keyword">const</span> Array4&lt;Real&gt;&amp; u_cc_arr =  u_cc.array(mfi);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;            <span class="keyword">const</span> Array4&lt;Real&gt;&amp; v_cc_arr =  v_cc.array(mfi);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;            <span class="keyword">const</span> Array4&lt;Real&gt;&amp; w_fc_arr =  w_fc.array(mfi);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;            <span class="keyword">const</span> Array4&lt;Real&gt;&amp;   p0_arr = p_hse.array(mfi);</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            <span class="keyword">const</span> Array4&lt;Real&gt;&amp;   qv_arr = <a class="code" href="classERF.html#ae00126a9c2738bf6a6cbbe77321c9cfc">qmoist</a>[0][0]-&gt;array(mfi); <span class="comment">// TODO: Is this written only on lev 0?</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160; </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;            ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            {</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                Real p = <a class="code" href="EOS_8H.html#a08354ab110fb9e873bce9250b4f4b46e">getPgivenRTh</a>(cons_arr(i, j, k, <a class="code" href="IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>), qv_arr(i,j,k));</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                p -= p0_arr(i,j,k);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                fab_arr(i, j, k,11) = p;                       <span class="comment">// p&#39;</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                fab_arr(i, j, k,12) = p * u_cc_arr(i,j,k);     <span class="comment">// p&#39;*u</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                fab_arr(i, j, k,13) = p * v_cc_arr(i,j,k);     <span class="comment">// p&#39;*v</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;            });</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160; </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;            <span class="keyword">const</span> Box&amp; zbx = mfi.tilebox(IntVect(0,0,1));</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;            ParallelFor(zbx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            {</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                Real p0 = <a class="code" href="EOS_8H.html#a08354ab110fb9e873bce9250b4f4b46e">getPgivenRTh</a>(cons_arr(i, j, k  , <a class="code" href="IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>), qv_arr(i,j,k  )) - p0_arr(i,j,k  );</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                Real p1 = <a class="code" href="EOS_8H.html#a08354ab110fb9e873bce9250b4f4b46e">getPgivenRTh</a>(cons_arr(i, j, k-1, <a class="code" href="IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>), qv_arr(i,j,k-1)) - p0_arr(i,j,k-1);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                Real pface = 0.5 * (p0 + p1);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                fab_arr_stag(i,j,k,5) = pface * w_fc_arr(i,j,k); <span class="comment">// p&#39;*w</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            });</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        } <span class="comment">// mfi</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    } <span class="comment">// use_moisture</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160; </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="comment">// Sum in the horizontal plane</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    h_avg_u  = sumToLine(u_cc,0,1,     domain,zdir);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    h_avg_v  = sumToLine(v_cc,0,1,     domain,zdir);</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    h_avg_w  = sumToLine(w_fc,0,1,stag_domain,zdir);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    h_avg_rho  = sumToLine(mf_out, 0,1,domain,zdir);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    h_avg_th   = sumToLine(mf_out, 1,1,domain,zdir);</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    h_avg_ksgs = sumToLine(mf_out, 2,1,domain,zdir);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    h_avg_uu   = sumToLine(mf_out, 3,1,domain,zdir);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    h_avg_uv   = sumToLine(mf_out, 4,1,domain,zdir);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    h_avg_vv   = sumToLine(mf_out, 5,1,domain,zdir);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    h_avg_uth  = sumToLine(mf_out, 6,1,domain,zdir);</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    h_avg_vth  = sumToLine(mf_out, 7,1,domain,zdir);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    h_avg_thth = sumToLine(mf_out, 8,1,domain,zdir);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    h_avg_uiuiu= sumToLine(mf_out, 9,1,stag_domain,zdir);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    h_avg_uiuiv= sumToLine(mf_out,10,1,stag_domain,zdir);</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    h_avg_p    = sumToLine(mf_out,11,1,domain,zdir);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    h_avg_pu   = sumToLine(mf_out,12,1,domain,zdir);</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    h_avg_pv   = sumToLine(mf_out,13,1,domain,zdir);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160; </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    h_avg_uw   = sumToLine(mf_out_stag,0,1,stag_domain,zdir);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    h_avg_vw   = sumToLine(mf_out_stag,1,1,stag_domain,zdir);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    h_avg_ww   = sumToLine(mf_out_stag,2,1,stag_domain,zdir);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    h_avg_wth  = sumToLine(mf_out_stag,3,1,stag_domain,zdir);</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    h_avg_uiuiw= sumToLine(mf_out_stag,4,1,stag_domain,zdir);</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    h_avg_pw   = sumToLine(mf_out_stag,5,1,stag_domain,zdir);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160; </div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="comment">// Divide by the total number of cells we are averaging over</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    Real area_z = <span class="keyword">static_cast&lt;</span>Real<span class="keyword">&gt;</span>(domain.length(0)*domain.length(1));</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="keywordtype">int</span> unstag_size = h_avg_w.size() - 1; <span class="comment">// _un_staggered heights</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; unstag_size; ++k) {</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        h_avg_u[k]     /= area_z;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        h_avg_v[k]     /= area_z;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        h_avg_rho[k]   /= area_z;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        h_avg_ksgs[k]  /= area_z;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        h_avg_th[k]    /= area_z;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        h_avg_thth[k]  /= area_z;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        h_avg_uu[k]    /= area_z;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        h_avg_uv[k]    /= area_z;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        h_avg_vv[k]    /= area_z;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        h_avg_uth[k]   /= area_z;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        h_avg_vth[k]   /= area_z;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        h_avg_uiuiu[k] /= area_z;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        h_avg_uiuiv[k] /= area_z;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        h_avg_p[k]     /= area_z;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        h_avg_pu[k]    /= area_z;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        h_avg_pv[k]    /= area_z;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    }</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160; </div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; unstag_size+1; ++k) { <span class="comment">// staggered heights</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        h_avg_w[k]     /= area_z;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        h_avg_uw[k]    /= area_z;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        h_avg_vw[k]    /= area_z;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        h_avg_ww[k]    /= area_z;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        h_avg_wth[k]   /= area_z;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        h_avg_uiuiw[k] /= area_z;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        h_avg_pw[k]    /= area_z;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    }</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a8e3bb984f352bb1b0887d4cf88bc7139_cgraph.png" border="0" usemap="#aclassERF_a8e3bb984f352bb1b0887d4cf88bc7139_cgraph" alt=""/></div>
<map name="aclassERF_a8e3bb984f352bb1b0887d4cf88bc7139_cgraph" id="aclassERF_a8e3bb984f352bb1b0887d4cf88bc7139_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,225,32"/>
<area shape="rect" href="EOS_8H.html#a08354ab110fb9e873bce9250b4f4b46e" title=" " alt="" coords="273,5,384,32"/>
</map>
</div>

</div>
</div>
<a id="a0f0aaad01835b2f1ce8f42112877ef47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f0aaad01835b2f1ce8f42112877ef47">&#9670;&nbsp;</a></span>derive_stress_profiles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::derive_stress_profiles </td>
          <td>(</td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_tau11</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_tau12</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_tau13</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_tau22</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_tau23</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_tau33</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_hfx3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_diss</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;{</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordtype">int</span> lev = 0;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="comment">// This will hold the stress tensor components</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    MultiFab mf_out(grids[lev], dmap[lev], 8, 0);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keywordflow">for</span> ( MFIter mfi(mf_out,TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    {</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        <span class="keyword">const</span> Array4&lt;Real&gt;&amp; fab_arr = mf_out.array(mfi);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160; </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <span class="comment">// NOTE: These are from the last RK stage...</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <span class="keyword">const</span> Array4&lt;const Real&gt;&amp; tau11_arr = <a class="code" href="classERF.html#aeb9348353b2415d023d8f52c293cad7e">Tau11_lev</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <span class="keyword">const</span> Array4&lt;const Real&gt;&amp; tau12_arr = <a class="code" href="classERF.html#ad8c2eca71737b102cc5cf75f97c6bd63">Tau12_lev</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <span class="keyword">const</span> Array4&lt;const Real&gt;&amp; tau13_arr = <a class="code" href="classERF.html#a5392e6104804d799b3fd943dfe390766">Tau13_lev</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        <span class="keyword">const</span> Array4&lt;const Real&gt;&amp; tau22_arr = <a class="code" href="classERF.html#afb4294f848d86e4aefb74848bb71047e">Tau22_lev</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <span class="keyword">const</span> Array4&lt;const Real&gt;&amp; tau23_arr = <a class="code" href="classERF.html#a03a4ad7368c1c98b492cd9d9fec9cbc5">Tau23_lev</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <span class="keyword">const</span> Array4&lt;const Real&gt;&amp; tau33_arr = <a class="code" href="classERF.html#a60a185c47f07bf4fb537a15d5a226d8a">Tau33_lev</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160; </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <span class="comment">// These should be re-calculated during ERF_slow_rhs_post</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <span class="comment">// -- just vertical SFS kinematic heat flux for now</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        <span class="comment">//const Array4&lt;const Real&gt;&amp; hfx1_arr = SFS_hfx1_lev[lev]-&gt;const_array(mfi);</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        <span class="comment">//const Array4&lt;const Real&gt;&amp; hfx2_arr = SFS_hfx2_lev[lev]-&gt;const_array(mfi);</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <span class="keyword">const</span> Array4&lt;const Real&gt;&amp; hfx3_arr = <a class="code" href="classERF.html#a1a2e3faf5dd90ad2f9ded28b486f3b46">SFS_hfx3_lev</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <span class="keyword">const</span> Array4&lt;const Real&gt;&amp; diss_arr = <a class="code" href="classERF.html#a6e1ad417e3bd062468d74830b65911fb">SFS_diss_lev</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160; </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        {</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            fab_arr(i, j, k, 0) = tau11_arr(i,j,k);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;            fab_arr(i, j, k, 1) = 0.25 * ( tau12_arr(i,j  ,k) + tau12_arr(i+1,j  ,k)</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                                         + tau12_arr(i,j+1,k) + tau12_arr(i+1,j+1,k) );</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            fab_arr(i, j, k, 2) = 0.25 * ( tau13_arr(i,j,k  ) + tau13_arr(i+1,j,k)</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                                         + tau13_arr(i,j,k+1) + tau13_arr(i+1,j,k+1) );</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;            fab_arr(i, j, k, 3) = tau22_arr(i,j,k);</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            fab_arr(i, j, k, 4) = 0.25 * ( tau23_arr(i,j,k  ) + tau23_arr(i,j+1,k)</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                                         + tau23_arr(i,j,k+1) + tau23_arr(i,j+1,k+1) );</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            fab_arr(i, j, k, 5) = tau33_arr(i,j,k);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            fab_arr(i, j, k, 6) =  hfx3_arr(i,j,k);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            fab_arr(i, j, k, 7) =  diss_arr(i,j,k);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        });</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    }</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160; </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="keywordtype">int</span> zdir = 2;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keyword">auto</span> domain = geom[0].Domain();</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160; </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    h_avg_tau11 = sumToLine(mf_out,0,1,domain,zdir);</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    h_avg_tau12 = sumToLine(mf_out,1,1,domain,zdir);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    h_avg_tau13 = sumToLine(mf_out,2,1,domain,zdir);</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    h_avg_tau22 = sumToLine(mf_out,3,1,domain,zdir);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    h_avg_tau23 = sumToLine(mf_out,4,1,domain,zdir);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    h_avg_tau33 = sumToLine(mf_out,5,1,domain,zdir);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    h_avg_hfx3  = sumToLine(mf_out,6,1,domain,zdir);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    h_avg_diss  = sumToLine(mf_out,7,1,domain,zdir);</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160; </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keywordtype">int</span> ht_size =  h_avg_tau11.size();</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="comment">// Divide by the total number of cells we are averaging over</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    Real area_z = <span class="keyword">static_cast&lt;</span>Real<span class="keyword">&gt;</span>(domain.length(0)*domain.length(1));</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; ht_size; ++k) {</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        h_avg_tau11[k] /= area_z; h_avg_tau12[k] /= area_z; h_avg_tau13[k] /= area_z;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        h_avg_tau22[k] /= area_z; h_avg_tau23[k] /= area_z; h_avg_tau33[k] /= area_z;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        h_avg_hfx3[k] /= area_z;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        h_avg_diss[k] /= area_z;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    }</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa1d539b1b91119c61ec5d3efd2897cc9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1d539b1b91119c61ec5d3efd2897cc9">&#9670;&nbsp;</a></span>derive_stress_profiles_stag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::derive_stress_profiles_stag </td>
          <td>(</td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_tau11</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_tau12</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_tau13</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_tau22</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_tau23</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_tau33</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_hfx3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_diss</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;{</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="keywordtype">int</span> lev = 0;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160; </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="comment">// This will hold the stress tensor components</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    MultiFab mf_out(grids[lev], dmap[lev], 8, 0);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160; </div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="comment">// This will hold Tau13 and Tau23</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    MultiFab mf_out_stag(convert(grids[lev], IntVect(0,0,1)), dmap[lev], 2, 0);</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160; </div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keywordflow">for</span> ( MFIter mfi(mf_out,TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    {</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        <span class="keyword">const</span> Array4&lt;Real&gt;&amp; fab_arr = mf_out.array(mfi);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        <span class="keyword">const</span> Array4&lt;Real&gt;&amp; fab_arr_stag = mf_out_stag.array(mfi);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160; </div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        <span class="comment">// NOTE: These are from the last RK stage...</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        <span class="keyword">const</span> Array4&lt;const Real&gt;&amp; tau11_arr = <a class="code" href="classERF.html#aeb9348353b2415d023d8f52c293cad7e">Tau11_lev</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        <span class="keyword">const</span> Array4&lt;const Real&gt;&amp; tau12_arr = <a class="code" href="classERF.html#ad8c2eca71737b102cc5cf75f97c6bd63">Tau12_lev</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        <span class="keyword">const</span> Array4&lt;const Real&gt;&amp; tau13_arr = <a class="code" href="classERF.html#a5392e6104804d799b3fd943dfe390766">Tau13_lev</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        <span class="keyword">const</span> Array4&lt;const Real&gt;&amp; tau22_arr = <a class="code" href="classERF.html#afb4294f848d86e4aefb74848bb71047e">Tau22_lev</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        <span class="keyword">const</span> Array4&lt;const Real&gt;&amp; tau23_arr = <a class="code" href="classERF.html#a03a4ad7368c1c98b492cd9d9fec9cbc5">Tau23_lev</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        <span class="keyword">const</span> Array4&lt;const Real&gt;&amp; tau33_arr = <a class="code" href="classERF.html#a60a185c47f07bf4fb537a15d5a226d8a">Tau33_lev</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160; </div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        <span class="comment">// These should be re-calculated during ERF_slow_rhs_post</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        <span class="comment">// -- just vertical SFS kinematic heat flux for now</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        <span class="comment">//const Array4&lt;const Real&gt;&amp; hfx1_arr = SFS_hfx1_lev[lev]-&gt;const_array(mfi);</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        <span class="comment">//const Array4&lt;const Real&gt;&amp; hfx2_arr = SFS_hfx2_lev[lev]-&gt;const_array(mfi);</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        <span class="keyword">const</span> Array4&lt;const Real&gt;&amp; hfx3_arr = <a class="code" href="classERF.html#a1a2e3faf5dd90ad2f9ded28b486f3b46">SFS_hfx3_lev</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        <span class="keyword">const</span> Array4&lt;const Real&gt;&amp; diss_arr = <a class="code" href="classERF.html#a6e1ad417e3bd062468d74830b65911fb">SFS_diss_lev</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160; </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        {</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;            fab_arr(i, j, k, 0) = tau11_arr(i,j,k);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;            fab_arr(i, j, k, 1) = 0.25 * ( tau12_arr(i,j  ,k) + tau12_arr(i+1,j  ,k)</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                                         + tau12_arr(i,j+1,k) + tau12_arr(i+1,j+1,k) );</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">//          fab_arr(i, j, k, 2) = 0.25 * ( tau13_arr(i,j,k  ) + tau13_arr(i+1,j,k)</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">//                                       + tau13_arr(i,j,k+1) + tau13_arr(i+1,j,k+1) );</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;            fab_arr(i, j, k, 3) = tau22_arr(i,j,k);</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">//          fab_arr(i, j, k, 4) = 0.25 * ( tau23_arr(i,j,k  ) + tau23_arr(i,j+1,k)</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">//                                       + tau23_arr(i,j,k+1) + tau23_arr(i,j+1,k+1) );</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;            fab_arr(i, j, k, 5) = tau33_arr(i,j,k);</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;            fab_arr(i, j, k, 6) =  hfx3_arr(i,j,k);</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;            fab_arr(i, j, k, 7) =  diss_arr(i,j,k);</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        });</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160; </div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        <span class="keyword">const</span> Box&amp; zbx = mfi.tilebox(IntVect(0,0,1));</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        ParallelFor(zbx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        {</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;            fab_arr_stag(i,j,k,0) = 0.5*(tau13_arr(i,j,k) + tau13_arr(i+1,j  ,k));</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;            fab_arr_stag(i,j,k,1) = 0.5*(tau23_arr(i,j,k) + tau23_arr(i  ,j+1,k));</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        });</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    }</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160; </div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="keywordtype">int</span> zdir = 2;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="keyword">auto</span> domain = geom[0].Domain();</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    Box stag_domain = domain;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    stag_domain.convert(IntVect(0,0,1));</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160; </div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    h_avg_tau11 = sumToLine(mf_out,0,1,domain,zdir);</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    h_avg_tau12 = sumToLine(mf_out,1,1,domain,zdir);</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment">//  h_avg_tau13 = sumToLine(mf_out,2,1,domain,zdir);</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    h_avg_tau22 = sumToLine(mf_out,3,1,domain,zdir);</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">//  h_avg_tau23 = sumToLine(mf_out,4,1,domain,zdir);</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    h_avg_tau33 = sumToLine(mf_out,5,1,domain,zdir);</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    h_avg_hfx3  = sumToLine(mf_out,6,1,domain,zdir);</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    h_avg_diss  = sumToLine(mf_out,7,1,domain,zdir);</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160; </div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    h_avg_tau13 = sumToLine(mf_out_stag,0,1,stag_domain,zdir);</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    h_avg_tau23 = sumToLine(mf_out_stag,1,1,stag_domain,zdir);</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160; </div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="keywordtype">int</span> ht_size =  h_avg_tau11.size(); <span class="comment">// _un_staggered</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160; </div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <span class="comment">// Divide by the total number of cells we are averaging over</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    Real area_z = <span class="keyword">static_cast&lt;</span>Real<span class="keyword">&gt;</span>(domain.length(0)*domain.length(1));</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; ht_size; ++k) {</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        h_avg_tau11[k] /= area_z; h_avg_tau12[k] /= area_z;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        h_avg_tau22[k] /= area_z; h_avg_tau33[k] /= area_z;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        h_avg_hfx3[k] /= area_z;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        h_avg_diss[k] /= area_z;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    }</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; ht_size+1; ++k) { <span class="comment">// staggered heights</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        h_avg_tau13[k] /= area_z;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        h_avg_tau23[k] /= area_z;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    }</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af1981699bedbbfd6785f26ca340a74d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1981699bedbbfd6785f26ca340a74d8">&#9670;&nbsp;</a></span>derive_upwp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::derive_upwp </td>
          <td>(</td>
          <td class="paramtype">amrex::Vector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_havg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a1f4902e264ff9b48001461c3555c0590"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f4902e264ff9b48001461c3555c0590">&#9670;&nbsp;</a></span>erf_enforce_hse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::erf_enforce_hse </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>dens</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>pres</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>pi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>z_cc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>z_nd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Enforces hydrostatic equilibrium when using terrain.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">lev</td><td>Integer specifying the current level </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dens</td><td>MultiFab storing base state density </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pres</td><td>MultiFab storing base state pressure </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pi</td><td>MultiFab storing base state Exner function </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">z_cc</td><td>Pointer to MultiFab storing cell centered z-coordinates </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">z_nd</td><td>Pointer to MultiFab storing node centered z-coordinates </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;{</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    Real l_gravity = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a47a54f2e44955202b5b437e4b1b4a61b">gravity</a>;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordtype">bool</span> l_use_terrain = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a063a88594452100497651e8aaf1f68d7">use_terrain</a>;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> geomdata = geom[lev].data();</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keyword">const</span> Real dz = geomdata.CellSize(2);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keyword">const</span> Box&amp; domain = geom[lev].Domain();</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordflow">if</span> (lev &gt; 0) {</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="keywordtype">int</span>  icomp = 0;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <span class="keywordtype">int</span> bccomp = 0;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="keywordtype">int</span>  ncomp = 1;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        PhysBCFunctNoOp <a class="code" href="ERF__FillPatch_8cpp.html#a85a7293fad1a59ed566bcea306373abc">null_bc</a>;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        Real time = 0.;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        Interpolater* mapper = &amp;cell_cons_interp;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        MultiFab p_hse_crse (<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev-1], make_alias, 1, 1); <span class="comment">// p_0  is second component</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        InterpFromCoarseLevel(<a class="code" href="namespaceMicVar__Kess.html#ad6f84c7e649afdd998b2f37ba87476bea82dd7c202e6cce14520ac01cfaa4f4ad">pres</a>, time, p_hse_crse,</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                              icomp, icomp, ncomp,</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                              geom[lev-1], geom[lev],</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                              <a class="code" href="ERF__FillPatch_8cpp.html#a85a7293fad1a59ed566bcea306373abc">null_bc</a>, 0, <a class="code" href="ERF__FillPatch_8cpp.html#a85a7293fad1a59ed566bcea306373abc">null_bc</a>, 0, refRatio(lev-1),</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                              mapper, <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>, bccomp);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    }</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keywordflow">for</span> ( MFIter mfi(dens, <a class="code" href="TileNoZ_8H.html#a8da113f1d5603f7297fe1d03e5013f00">TileNoZ</a>()); mfi.isValid(); ++mfi )</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    {</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <span class="comment">// Create a flat box with same horizontal extent but only one cell in vertical</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <span class="keyword">const</span> Box&amp; tbz = mfi.nodaltilebox(2);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <span class="keywordtype">int</span> klo = tbz.smallEnd(2);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <span class="keywordtype">int</span> khi = tbz.bigEnd(2);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        Box b2d = tbz; <span class="comment">// Copy constructor</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        b2d.grow(0,1); b2d.grow(1,1); <span class="comment">// Grow by one in the lateral directions</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        b2d.setRange(2,0);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <span class="comment">// We integrate to the first cell (and below) by using rho in this cell</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <span class="comment">// If gravity == 0 this is constant pressure</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <span class="comment">// If gravity != 0, hence this is a wall, this gives gp0 = dens[0] * gravity</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <span class="comment">// (dens_hse*gravity would also be dens[0]*gravity because we use foextrap for rho at k = -1)</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <span class="comment">// Note ng_pres_hse = 1</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;       <span class="comment">// We start by assuming pressure on the ground is p_0 (in ERF_Constants.H)</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;       <span class="comment">// Note that gravity is positive</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160; </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        Array4&lt;Real&gt;  rho_arr = dens.array(mfi);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        Array4&lt;Real&gt; pres_arr = <a class="code" href="namespaceMicVar__Kess.html#ad6f84c7e649afdd998b2f37ba87476bea82dd7c202e6cce14520ac01cfaa4f4ad">pres</a>.array(mfi);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        Array4&lt;Real&gt;   pi_arr =   pi.array(mfi);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        Array4&lt;Real&gt; zcc_arr;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        Array4&lt;Real&gt; znd_arr;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <span class="keywordflow">if</span> (l_use_terrain) {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;           zcc_arr = z_cc-&gt;array(mfi);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;           znd_arr = z_nd-&gt;array(mfi);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        }</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <span class="keyword">const</span> Real rdOcp = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a2e1ef762ee1dc1bd3d4cbd08125c758a">rdOcp</a>;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        ParallelFor(b2d, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>)</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            <span class="comment">// Physical height of the terrain at cell center</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            Real hz;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            <span class="keywordflow">if</span> (l_use_terrain) {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                hz = .125 * ( znd_arr(i,j,0) + znd_arr(i+1,j,0) + znd_arr(i,j+1,0) + znd_arr(i+1,j+1,0)</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                             +znd_arr(i,j,1) + znd_arr(i+1,j,1) + znd_arr(i,j+1,1) + znd_arr(i+1,j+1,1) );</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                hz = 0.5*dz;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            }</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            <span class="comment">// Set value at surface from Newton iteration for rho</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            <span class="keywordflow">if</span> (klo == 0) {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                pres_arr(i,j,klo  ) = <a class="code" href="ERF__Constants_8H.html#a994fea25f28c33c2e8f1e9c63d5b8b56">p_0</a> - hz * rho_arr(i,j,klo) * l_gravity;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                pi_arr(i,j,klo  ) = <a class="code" href="EOS_8H.html#ab415ab4061cbbea05723267a0bf82c6b">getExnergivenP</a>(pres_arr(i,j,klo  ), rdOcp);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160; </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                <span class="comment">// Set ghost cell with dz and rho at boundary</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                pres_arr(i,j,klo-1) = <a class="code" href="ERF__Constants_8H.html#a994fea25f28c33c2e8f1e9c63d5b8b56">p_0</a> + hz * rho_arr(i,j,klo) * l_gravity;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                pi_arr(i,j,klo-1) = <a class="code" href="EOS_8H.html#ab415ab4061cbbea05723267a0bf82c6b">getExnergivenP</a>(pres_arr(i,j,klo-1), rdOcp);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                <span class="comment">// If klo &gt; 0, we need to use the value of pres_arr(i,j,klo-1) which was</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                <span class="comment">//    filled from FillPatch-ing it.</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                Real dens_interp = 0.5*(rho_arr(i,j,klo) + rho_arr(i,j,klo-1));</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                pres_arr(i,j,klo) = pres_arr(i,j,klo-1) - dz * dens_interp * l_gravity;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                pi_arr(i,j,klo  ) = <a class="code" href="EOS_8H.html#ab415ab4061cbbea05723267a0bf82c6b">getExnergivenP</a>(pres_arr(i,j,klo  ), rdOcp);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                pi_arr(i,j,klo-1) = <a class="code" href="EOS_8H.html#ab415ab4061cbbea05723267a0bf82c6b">getExnergivenP</a>(pres_arr(i,j,klo-1), rdOcp);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            }</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            Real dens_interp;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            <span class="keywordflow">if</span> (l_use_terrain) {</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = klo+1; k &lt;= khi; k++) {</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                    Real dz_loc = (zcc_arr(i,j,k) - zcc_arr(i,j,k-1));</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                    dens_interp = 0.5*(rho_arr(i,j,k) + rho_arr(i,j,k-1));</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                    pres_arr(i,j,k) = pres_arr(i,j,k-1) - dz_loc * dens_interp * l_gravity;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                    pi_arr(i,j,k) = <a class="code" href="EOS_8H.html#ab415ab4061cbbea05723267a0bf82c6b">getExnergivenP</a>(pres_arr(i,j,k), rdOcp);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                }</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = klo+1; k &lt;= khi; k++) {</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                    dens_interp = 0.5*(rho_arr(i,j,k) + rho_arr(i,j,k-1));</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                    pres_arr(i,j,k) = pres_arr(i,j,k-1) - dz * dens_interp * l_gravity;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                    pi_arr(i,j,k) = <a class="code" href="EOS_8H.html#ab415ab4061cbbea05723267a0bf82c6b">getExnergivenP</a>(pres_arr(i,j,k), rdOcp);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                }</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            }</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        });</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        <span class="keywordtype">int</span> domlo_x = domain.smallEnd(0); <span class="keywordtype">int</span> domhi_x = domain.bigEnd(0);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <span class="keywordtype">int</span> domlo_y = domain.smallEnd(1); <span class="keywordtype">int</span> domhi_y = domain.bigEnd(1);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespaceMicVar__Kess.html#ad6f84c7e649afdd998b2f37ba87476bea82dd7c202e6cce14520ac01cfaa4f4ad">pres</a>[mfi].box().smallEnd(0) &lt; domlo_x)</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        {</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            Box bx = mfi.nodaltilebox(2);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            bx.setSmall(0,domlo_x-1);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            bx.setBig(0,domlo_x-1);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            ParallelFor(bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) {</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                pres_arr(i,j,k) = pres_arr(domlo_x,j,k);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                pi_arr(i,j,k) = <a class="code" href="EOS_8H.html#ab415ab4061cbbea05723267a0bf82c6b">getExnergivenP</a>(pres_arr(i,j,k), rdOcp);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            });</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        }</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespaceMicVar__Kess.html#ad6f84c7e649afdd998b2f37ba87476bea82dd7c202e6cce14520ac01cfaa4f4ad">pres</a>[mfi].box().bigEnd(0) &gt; domhi_x)</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        {</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            Box bx = mfi.nodaltilebox(2);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            bx.setSmall(0,domhi_x+1);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            bx.setBig(0,domhi_x+1);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            ParallelFor(bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) {</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                pres_arr(i,j,k) = pres_arr(domhi_x,j,k);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                pi_arr(i,j,k) = <a class="code" href="EOS_8H.html#ab415ab4061cbbea05723267a0bf82c6b">getExnergivenP</a>(pres_arr(i,j,k), rdOcp);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            });</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        }</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespaceMicVar__Kess.html#ad6f84c7e649afdd998b2f37ba87476bea82dd7c202e6cce14520ac01cfaa4f4ad">pres</a>[mfi].box().smallEnd(1) &lt; domlo_y)</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        {</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            Box bx = mfi.nodaltilebox(2);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            bx.setSmall(1,domlo_y-1);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            bx.setBig(1,domlo_y-1);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;            ParallelFor(bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) {</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                pres_arr(i,j,k) = pres_arr(i,domlo_y,k);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                pi_arr(i,j,k) = <a class="code" href="EOS_8H.html#ab415ab4061cbbea05723267a0bf82c6b">getExnergivenP</a>(pres_arr(i,j,k), rdOcp);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            });</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        }</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160; </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespaceMicVar__Kess.html#ad6f84c7e649afdd998b2f37ba87476bea82dd7c202e6cce14520ac01cfaa4f4ad">pres</a>[mfi].box().bigEnd(1) &gt; domhi_y)</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        {</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            Box bx = mfi.nodaltilebox(2);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            bx.setSmall(1,domhi_y+1);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            bx.setBig(1,domhi_y+1);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            ParallelFor(bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) {</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                pres_arr(i,j,k) = pres_arr(i,domhi_y,k);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                pi_arr(i,j,k) = <a class="code" href="EOS_8H.html#ab415ab4061cbbea05723267a0bf82c6b">getExnergivenP</a>(pres_arr(i,j,k), rdOcp);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            });</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        }</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    }</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    dens.FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <a class="code" href="namespaceMicVar__Kess.html#ad6f84c7e649afdd998b2f37ba87476bea82dd7c202e6cce14520ac01cfaa4f4ad">pres</a>.FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;}</div>
<div class="ttc" id="aEOS_8H_html_ab415ab4061cbbea05723267a0bf82c6b"><div class="ttname"><a href="EOS_8H.html#ab415ab4061cbbea05723267a0bf82c6b">getExnergivenP</a></div><div class="ttdeci">AMREX_GPU_HOST_DEVICE AMREX_FORCE_INLINE amrex::Real getExnergivenP(const amrex::Real P, const amrex::Real rdOcp)</div><div class="ttdef"><b>Definition:</b> EOS.H:103</div></div>
<div class="ttc" id="aERF__Constants_8H_html_a994fea25f28c33c2e8f1e9c63d5b8b56"><div class="ttname"><a href="ERF__Constants_8H.html#a994fea25f28c33c2e8f1e9c63d5b8b56">p_0</a></div><div class="ttdeci">constexpr amrex::Real p_0</div><div class="ttdef"><b>Definition:</b> ERF_Constants.H:18</div></div>
<div class="ttc" id="aERF__FillPatch_8cpp_html_a85a7293fad1a59ed566bcea306373abc"><div class="ttname"><a href="ERF__FillPatch_8cpp.html#a85a7293fad1a59ed566bcea306373abc">null_bc</a></div><div class="ttdeci">PhysBCFunctNoOp null_bc</div><div class="ttdef"><b>Definition:</b> ERF_FillPatch.cpp:10</div></div>
<div class="ttc" id="anamespaceMicVar__Kess_html_ad6f84c7e649afdd998b2f37ba87476bea82dd7c202e6cce14520ac01cfaa4f4ad"><div class="ttname"><a href="namespaceMicVar__Kess.html#ad6f84c7e649afdd998b2f37ba87476bea82dd7c202e6cce14520ac01cfaa4f4ad">MicVar_Kess::pres</a></div><div class="ttdeci">@ pres</div><div class="ttdef"><b>Definition:</b> Kessler.H:33</div></div>
<div class="ttc" id="astructSolverChoice_html_a2e1ef762ee1dc1bd3d4cbd08125c758a"><div class="ttname"><a href="structSolverChoice.html#a2e1ef762ee1dc1bd3d4cbd08125c758a">SolverChoice::rdOcp</a></div><div class="ttdeci">amrex::Real rdOcp</div><div class="ttdef"><b>Definition:</b> DataStruct.H:383</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a1f4902e264ff9b48001461c3555c0590_cgraph.png" border="0" usemap="#aclassERF_a1f4902e264ff9b48001461c3555c0590_cgraph" alt=""/></div>
<map name="aclassERF_a1f4902e264ff9b48001461c3555c0590_cgraph" id="aclassERF_a1f4902e264ff9b48001461c3555c0590_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,164,57"/>
<area shape="rect" href="EOS_8H.html#ab415ab4061cbbea05723267a0bf82c6b" title=" " alt="" coords="212,5,336,32"/>
<area shape="rect" href="TileNoZ_8H.html#a8da113f1d5603f7297fe1d03e5013f00" title=" " alt="" coords="237,56,311,83"/>
</map>
</div>

</div>
</div>
<a id="a18e6dbbf968b4492e78aa427791620f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18e6dbbf968b4492e78aa427791620f4">&#9670;&nbsp;</a></span>ErrorEst()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::ErrorEst </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::TagBoxArray &amp;&#160;</td>
          <td class="paramname"><em>tags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ngrow</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Function to tag cells for refinement &ndash; this overrides the pure virtual function in AmrCore</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">level</td><td>level of refinement (0 is coarsest leve) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tags</td><td>array of tagged cells </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">time</td><td>current time </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;{</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> clearval = TagBox::CLEAR;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span>   tagval = TagBox::SET;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt; <a class="code" href="classERF.html#ac81b3dfd7c6f21ba8479834e2ff1e652">ref_tags</a>.size(); ++j)</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    {</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;        std::unique_ptr&lt;MultiFab&gt; mf;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;        <span class="comment">// This allows dynamic refinement based on the value of the density</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ac81b3dfd7c6f21ba8479834e2ff1e652">ref_tags</a>[j].Field() == <span class="stringliteral">&quot;density&quot;</span>)</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;        {</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;            mf = std::make_unique&lt;MultiFab&gt;(grids[level], dmap[level], 1, 0);</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;            MultiFab::Copy(*mf,<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[level][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],<a class="code" href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>,0,1,0);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        <span class="comment">// This allows dynamic refinement based on the value of the scalar/pressure/theta</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( (<a class="code" href="classERF.html#ac81b3dfd7c6f21ba8479834e2ff1e652">ref_tags</a>[j].Field() == <span class="stringliteral">&quot;scalar&quot;</span>  ) ||</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;                    (<a class="code" href="classERF.html#ac81b3dfd7c6f21ba8479834e2ff1e652">ref_tags</a>[j].Field() == <span class="stringliteral">&quot;pressure&quot;</span>) ||</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;                    (<a class="code" href="classERF.html#ac81b3dfd7c6f21ba8479834e2ff1e652">ref_tags</a>[j].Field() == <span class="stringliteral">&quot;theta&quot;</span>   ) )</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        {</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;            mf = std::make_unique&lt;MultiFab&gt;(grids[level], dmap[level], 1, 0);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;            <span class="keywordflow">for</span> (MFIter mfi(*mf, TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;            {</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;                <span class="keyword">auto</span>&amp; dfab = (*mf)[mfi];</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;                <span class="keyword">auto</span>&amp; sfab = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[level][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>][mfi];</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ac81b3dfd7c6f21ba8479834e2ff1e652">ref_tags</a>[j].Field() == <span class="stringliteral">&quot;scalar&quot;</span>) {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;                    <a class="code" href="namespacederived.html#a37560f4d3e2c7c10f64d41db2ce76a06">derived::erf_derscalar</a>(bx, dfab, 0, 1, sfab, Geom(level), time, <span class="keyword">nullptr</span>, level);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ac81b3dfd7c6f21ba8479834e2ff1e652">ref_tags</a>[j].Field() == <span class="stringliteral">&quot;theta&quot;</span>) {</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;                    <a class="code" href="namespacederived.html#adc3c787125484205e4fc7cd85c25ab6c">derived::erf_dertheta</a>(bx, dfab, 0, 1, sfab, Geom(level), time, <span class="keyword">nullptr</span>, level);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;                }</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;            } <span class="comment">// mfi</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        }</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        <span class="comment">// This is sufficient for static refinement (where we don&#39;t need mf filled first)</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <a class="code" href="classERF.html#ac81b3dfd7c6f21ba8479834e2ff1e652">ref_tags</a>[j](tags,mf.get(),clearval,tagval,time,level,geom[level]);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  }</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_ac81b3dfd7c6f21ba8479834e2ff1e652"><div class="ttname"><a href="classERF.html#ac81b3dfd7c6f21ba8479834e2ff1e652">ERF::ref_tags</a></div><div class="ttdeci">static amrex::Vector&lt; amrex::AMRErrorTag &gt; ref_tags</div><div class="ttdef"><b>Definition:</b> ERF.H:844</div></div>
<div class="ttc" id="anamespacederived_html_a37560f4d3e2c7c10f64d41db2ce76a06"><div class="ttname"><a href="namespacederived.html#a37560f4d3e2c7c10f64d41db2ce76a06">derived::erf_derscalar</a></div><div class="ttdeci">void erf_derscalar(const Box &amp;bx, FArrayBox &amp;derfab, int, int, const FArrayBox &amp;datfab, const Geometry &amp;, Real, const int *, const int)</div><div class="ttdef"><b>Definition:</b> Derive.cpp:142</div></div>
<div class="ttc" id="anamespacederived_html_adc3c787125484205e4fc7cd85c25ab6c"><div class="ttname"><a href="namespacederived.html#adc3c787125484205e4fc7cd85c25ab6c">derived::erf_dertheta</a></div><div class="ttdeci">void erf_dertheta(const Box &amp;bx, FArrayBox &amp;derfab, int, int, const FArrayBox &amp;datfab, const Geometry &amp;, Real, const int *, const int)</div><div class="ttdef"><b>Definition:</b> Derive.cpp:121</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a18e6dbbf968b4492e78aa427791620f4_cgraph.png" border="0" usemap="#aclassERF_a18e6dbbf968b4492e78aa427791620f4_cgraph" alt=""/></div>
<map name="aclassERF_a18e6dbbf968b4492e78aa427791620f4_cgraph" id="aclassERF_a18e6dbbf968b4492e78aa427791620f4_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,111,57"/>
<area shape="rect" href="namespacederived.html#a37560f4d3e2c7c10f64d41db2ce76a06" title=" " alt="" coords="159,5,323,32"/>
<area shape="rect" href="namespacederived.html#adc3c787125484205e4fc7cd85c25ab6c" title=" " alt="" coords="161,56,320,83"/>
<area shape="rect" href="namespacederived.html#a3786c6a8399bc2508bc129337c446af1" title=" " alt="" coords="371,31,557,57"/>
</map>
</div>

</div>
</div>
<a id="a6b1d727e63de2e49aa4f8e00b0dda1d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b1d727e63de2e49aa4f8e00b0dda1d5">&#9670;&nbsp;</a></span>estTimeStep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Real ERF::estTimeStep </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>level</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long &amp;&#160;</td>
          <td class="paramname"><em>dt_fast_ratio</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function that calls estTimeStep for each level</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">level</td><td>level of refinement (coarsest level i 0) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dt_fast_ratio</td><td>ratio of slow to fast time step </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;{</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    BL_PROFILE(<span class="stringliteral">&quot;ERF::estTimeStep()&quot;</span>);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    Real estdt_comp = 1.e20;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    Real estdt_lowM = 1.e20;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span> dxinv = geom[level].InvCellSizeArray();</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span> dzinv = 1.0 / <a class="code" href="classERF.html#a0656573ffb79f0fda8d02d5ea0482ed2">dz_min</a>;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    MultiFab <span class="keyword">const</span>&amp; S_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[level][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>];</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    MultiFab ccvel(grids[level],dmap[level],3,0);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    average_face_to_cellcenter(ccvel,0,</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                               Array&lt;const MultiFab*,3&gt;{&amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[level][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                                                            &amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[level][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                                                            &amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[level][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>]});</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordtype">int</span> l_no_substepping = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a35e0c82996e345337368bc720bbd6070">no_substepping</a>;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    Real estdt_comp_inv = ReduceMax(S_new, ccvel, 0,</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;       [=] AMREX_GPU_HOST_DEVICE (Box <span class="keyword">const</span>&amp; b,</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                                  Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; s,</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                                  Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; u) -&gt; Real</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;       {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;           Real new_comp_dt = -1.e100;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;           amrex::Loop(b, [=,&amp;new_comp_dt] (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;           {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;               <span class="keyword">const</span> Real <a class="code" href="namespaceMicVar__Kess.html#ad6f84c7e649afdd998b2f37ba87476bea89de8c3bfc941080efb960e5119fbd61">rho</a>      = s(i, j, k, <a class="code" href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;               <span class="keyword">const</span> Real rhotheta = s(i, j, k, <a class="code" href="IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;               <span class="comment">// NOTE: even when moisture is present,</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;               <span class="comment">//       we only use the partial pressure of the dry air</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;               <span class="comment">//       to compute the soundspeed</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;               Real pressure = <a class="code" href="EOS_8H.html#a08354ab110fb9e873bce9250b4f4b46e">getPgivenRTh</a>(rhotheta);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;               Real c = std::sqrt(<a class="code" href="ERF__Constants_8H.html#afbb622bf3b404a3e7c77f3103b4d1231">Gamma</a> * pressure / <a class="code" href="namespaceMicVar__Kess.html#ad6f84c7e649afdd998b2f37ba87476bea89de8c3bfc941080efb960e5119fbd61">rho</a>);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;               <span class="comment">// If we are not doing the acoustic substepping, then the z-direction contributes</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;               <span class="comment">//    to the computation of the time step</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;               <span class="keywordflow">if</span> (l_no_substepping) {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                   new_comp_dt = amrex::max(((amrex::Math::abs(u(i,j,k,0))+c)*dxinv[0]),</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                                            ((amrex::Math::abs(u(i,j,k,1))+c)*dxinv[1]),</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                                            ((amrex::Math::abs(u(i,j,k,2))+c)*dzinv   ), new_comp_dt);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;               <span class="comment">// If we are     doing the acoustic substepping, then the z-direction does not contribute</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;               <span class="comment">//    to the computation of the time step</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;               } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                   new_comp_dt = amrex::max(((amrex::Math::abs(u(i,j,k,0))+c)*dxinv[0]),</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                                            ((amrex::Math::abs(u(i,j,k,1))+c)*dxinv[1]), new_comp_dt);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;               }</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;           });</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;           <span class="keywordflow">return</span> new_comp_dt;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;       });</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    ParallelDescriptor::ReduceRealMax(estdt_comp_inv);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    estdt_comp = <a class="code" href="classERF.html#a89f605d1a1eae06a7c79f9b6b65c637f">cfl</a> / estdt_comp_inv;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;     Real estdt_lowM_inv = ReduceMax(ccvel, 0,</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;       [=] AMREX_GPU_HOST_DEVICE (Box <span class="keyword">const</span>&amp; b,</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                                  Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; u) -&gt; Real</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;       {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;           Real new_lm_dt = -1.e100;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;           Loop(b, [=,&amp;new_lm_dt] (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;           {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;               new_lm_dt = amrex::max(((amrex::Math::abs(u(i,j,k,0)))*dxinv[0]),</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                                      ((amrex::Math::abs(u(i,j,k,1)))*dxinv[1]),</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                                      ((amrex::Math::abs(u(i,j,k,2)))*dxinv[2]), new_lm_dt);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;           });</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;           <span class="keywordflow">return</span> new_lm_dt;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;       });</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;     ParallelDescriptor::ReduceRealMax(estdt_lowM_inv);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;     <span class="keywordflow">if</span> (estdt_lowM_inv &gt; 0.0_rt)</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;         estdt_lowM = <a class="code" href="classERF.html#a89f605d1a1eae06a7c79f9b6b65c637f">cfl</a> / estdt_lowM_inv;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;     <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a43d0b17f6e155691a1e9474526df3af5">verbose</a>) {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="classERF.html#acd88606a88916719171a267e9edf54c7">fixed_dt</a> &lt;= 0.0) {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;             Print() &lt;&lt; <span class="stringliteral">&quot;Using cfl = &quot;</span> &lt;&lt; <a class="code" href="classERF.html#a89f605d1a1eae06a7c79f9b6b65c637f">cfl</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;             Print() &lt;&lt; <span class="stringliteral">&quot;Fast  dt at level &quot;</span> &lt;&lt; level &lt;&lt; <span class="stringliteral">&quot;:  &quot;</span> &lt;&lt; estdt_comp &lt;&lt; std::endl;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;             <span class="keywordflow">if</span> (estdt_lowM_inv &gt; 0.0_rt) {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                 Print() &lt;&lt; <span class="stringliteral">&quot;Slow  dt at level &quot;</span> &lt;&lt; level &lt;&lt; <span class="stringliteral">&quot;:  &quot;</span> &lt;&lt; estdt_lowM &lt;&lt; std::endl;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;             } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                 Print() &lt;&lt; <span class="stringliteral">&quot;Slow  dt at level &quot;</span> &lt;&lt; level &lt;&lt; <span class="stringliteral">&quot;: undefined &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;             }</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;         }</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="classERF.html#acd88606a88916719171a267e9edf54c7">fixed_dt</a> &gt; 0.0) {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;             Print() &lt;&lt; <span class="stringliteral">&quot;Based on cfl of 1.0 &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;             Print() &lt;&lt; <span class="stringliteral">&quot;Fast  dt at level &quot;</span> &lt;&lt; level &lt;&lt; <span class="stringliteral">&quot; would be:  &quot;</span> &lt;&lt; estdt_comp/<a class="code" href="classERF.html#a89f605d1a1eae06a7c79f9b6b65c637f">cfl</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;             <span class="keywordflow">if</span> (estdt_lowM_inv &gt; 0.0_rt) {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                 Print() &lt;&lt; <span class="stringliteral">&quot;Slow  dt at level &quot;</span> &lt;&lt; level &lt;&lt; <span class="stringliteral">&quot; would be:  &quot;</span> &lt;&lt; estdt_lowM/<a class="code" href="classERF.html#a89f605d1a1eae06a7c79f9b6b65c637f">cfl</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;             } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                 Print() &lt;&lt; <span class="stringliteral">&quot;Slow  dt at level &quot;</span> &lt;&lt; level &lt;&lt; <span class="stringliteral">&quot; would be undefined &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;             }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;             Print() &lt;&lt; <span class="stringliteral">&quot;Fixed dt at level &quot;</span> &lt;&lt; level &lt;&lt; <span class="stringliteral">&quot;       is:  &quot;</span> &lt;&lt; <a class="code" href="classERF.html#acd88606a88916719171a267e9edf54c7">fixed_dt</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;             <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a20f8ed606dd006f84efa4ebed7b96130">fixed_fast_dt</a> &gt; 0.0) {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                 Print() &lt;&lt; <span class="stringliteral">&quot;Fixed fast dt at level &quot;</span> &lt;&lt; level &lt;&lt; <span class="stringliteral">&quot;       is:  &quot;</span> &lt;&lt; <a class="code" href="classERF.html#a20f8ed606dd006f84efa4ebed7b96130">fixed_fast_dt</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;             }</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;         }</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;     }</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;     <span class="keywordflow">if</span> (<a class="code" href="classERF.html#acd88606a88916719171a267e9edf54c7">fixed_dt</a> &gt; 0. &amp;&amp; <a class="code" href="classERF.html#a20f8ed606dd006f84efa4ebed7b96130">fixed_fast_dt</a> &gt; 0.) {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;         dt_fast_ratio = <span class="keyword">static_cast&lt;</span><span class="keywordtype">long</span><span class="keyword">&gt;</span>( <a class="code" href="classERF.html#acd88606a88916719171a267e9edf54c7">fixed_dt</a> / <a class="code" href="classERF.html#a20f8ed606dd006f84efa4ebed7b96130">fixed_fast_dt</a> );</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classERF.html#acd88606a88916719171a267e9edf54c7">fixed_dt</a> &gt; 0.) {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;         dt_fast_ratio = <span class="keyword">static_cast&lt;</span><span class="keywordtype">long</span><span class="keyword">&gt;</span>( std::ceil((<a class="code" href="classERF.html#acd88606a88916719171a267e9edf54c7">fixed_dt</a>/estdt_comp)) );</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;     } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;         dt_fast_ratio = (estdt_lowM_inv &gt; 0.0) ? <span class="keyword">static_cast&lt;</span><span class="keywordtype">long</span><span class="keyword">&gt;</span>( std::ceil((estdt_lowM/estdt_comp)) ) : 1;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;     }</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;     <span class="comment">// Force time step ratio to be an even value</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;     <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a3f8ae511632557066f6662eec79591e1">force_stage1_single_substep</a>) {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;         <span class="keywordflow">if</span> ( dt_fast_ratio%2 != 0) dt_fast_ratio += 1;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;     } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;         <span class="keywordflow">if</span> ( dt_fast_ratio%6 != 0) {</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;             Print() &lt;&lt; <span class="stringliteral">&quot;mri_dt_ratio = &quot;</span> &lt;&lt; dt_fast_ratio</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot; not divisible by 6 for N/3 substeps in stage 1&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;             dt_fast_ratio = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(std::ceil(dt_fast_ratio/6.0) * 6);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;         }</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;     }</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;     <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a43d0b17f6e155691a1e9474526df3af5">verbose</a>)</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;         Print() &lt;&lt; <span class="stringliteral">&quot;smallest even ratio is: &quot;</span> &lt;&lt; dt_fast_ratio &lt;&lt; std::endl;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;     <span class="keywordflow">if</span> (<a class="code" href="classERF.html#acd88606a88916719171a267e9edf54c7">fixed_dt</a> &gt; 0.0) {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="classERF.html#acd88606a88916719171a267e9edf54c7">fixed_dt</a>;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;     } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;         <span class="keywordflow">if</span> (l_no_substepping) {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;             <span class="keywordflow">return</span> estdt_comp;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;         } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;             <span class="keywordflow">return</span> estdt_lowM;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;         }</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;     }</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;}</div>
<div class="ttc" id="aERF__Constants_8H_html_afbb622bf3b404a3e7c77f3103b4d1231"><div class="ttname"><a href="ERF__Constants_8H.html#afbb622bf3b404a3e7c77f3103b4d1231">Gamma</a></div><div class="ttdeci">constexpr amrex::Real Gamma</div><div class="ttdef"><b>Definition:</b> ERF_Constants.H:19</div></div>
<div class="ttc" id="aclassERF_html_a0656573ffb79f0fda8d02d5ea0482ed2"><div class="ttname"><a href="classERF.html#a0656573ffb79f0fda8d02d5ea0482ed2">ERF::dz_min</a></div><div class="ttdeci">amrex::Real dz_min</div><div class="ttdef"><b>Definition:</b> ERF.H:852</div></div>
<div class="ttc" id="aclassERF_html_a20f8ed606dd006f84efa4ebed7b96130"><div class="ttname"><a href="classERF.html#a20f8ed606dd006f84efa4ebed7b96130">ERF::fixed_fast_dt</a></div><div class="ttdeci">static amrex::Real fixed_fast_dt</div><div class="ttdef"><b>Definition:</b> ERF.H:679</div></div>
<div class="ttc" id="aclassERF_html_a89f605d1a1eae06a7c79f9b6b65c637f"><div class="ttname"><a href="classERF.html#a89f605d1a1eae06a7c79f9b6b65c637f">ERF::cfl</a></div><div class="ttdeci">static amrex::Real cfl</div><div class="ttdef"><b>Definition:</b> ERF.H:673</div></div>
<div class="ttc" id="aclassERF_html_acd88606a88916719171a267e9edf54c7"><div class="ttname"><a href="classERF.html#acd88606a88916719171a267e9edf54c7">ERF::fixed_dt</a></div><div class="ttdeci">static amrex::Real fixed_dt</div><div class="ttdef"><b>Definition:</b> ERF.H:678</div></div>
<div class="ttc" id="anamespaceMicVar__Kess_html_ad6f84c7e649afdd998b2f37ba87476bea89de8c3bfc941080efb960e5119fbd61"><div class="ttname"><a href="namespaceMicVar__Kess.html#ad6f84c7e649afdd998b2f37ba87476bea89de8c3bfc941080efb960e5119fbd61">MicVar_Kess::rho</a></div><div class="ttdeci">@ rho</div><div class="ttdef"><b>Definition:</b> Kessler.H:30</div></div>
<div class="ttc" id="astructSolverChoice_html_a35e0c82996e345337368bc720bbd6070"><div class="ttname"><a href="structSolverChoice.html#a35e0c82996e345337368bc720bbd6070">SolverChoice::no_substepping</a></div><div class="ttdeci">int no_substepping</div><div class="ttdef"><b>Definition:</b> DataStruct.H:358</div></div>
<div class="ttc" id="astructSolverChoice_html_a3f8ae511632557066f6662eec79591e1"><div class="ttname"><a href="structSolverChoice.html#a3f8ae511632557066f6662eec79591e1">SolverChoice::force_stage1_single_substep</a></div><div class="ttdeci">int force_stage1_single_substep</div><div class="ttdef"><b>Definition:</b> DataStruct.H:359</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a6b1d727e63de2e49aa4f8e00b0dda1d5_cgraph.png" border="0" usemap="#aclassERF_a6b1d727e63de2e49aa4f8e00b0dda1d5_cgraph" alt=""/></div>
<map name="aclassERF_a6b1d727e63de2e49aa4f8e00b0dda1d5_cgraph" id="aclassERF_a6b1d727e63de2e49aa4f8e00b0dda1d5_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,141,32"/>
<area shape="rect" href="EOS_8H.html#a08354ab110fb9e873bce9250b4f4b46e" title=" " alt="" coords="189,5,300,32"/>
</map>
</div>

</div>
</div>
<a id="a0be12798b46f52fa4b5a995f147c3f96"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0be12798b46f52fa4b5a995f147c3f96">&#9670;&nbsp;</a></span>Evolve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::Evolve </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;{</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    BL_PROFILE_VAR(<span class="stringliteral">&quot;ERF::Evolve()&quot;</span>, evolve);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    Real cur_time = <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0];</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="comment">// Take one coarse timestep by calling timeStep -- which recursively calls timeStep</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="comment">//      for finer levels (with or without subcycling)</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> step = <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[0]; step &lt; <a class="code" href="classERF.html#a0634154e8e58379c495c3e7fe7c5e4d6">max_step</a> &amp;&amp; cur_time &lt; <a class="code" href="classERF.html#a405556a52bef334ab68294c1a540e107">stop_time</a>; ++step)</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    {</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        Print() &lt;&lt; <span class="stringliteral">&quot;\nCoarse STEP &quot;</span> &lt;&lt; step+1 &lt;&lt; <span class="stringliteral">&quot; starts ...&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <a class="code" href="classERF.html#a62a5ed3c3806eaa918257e0ad1382df5">ComputeDt</a>();</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <span class="comment">// Make sure we have read enough of the boundary plane data to make it through this timestep</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a80ad08512968ec45635df68abe66b1fc">input_bndry_planes</a>)</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        {</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;read_input_files(cur_time,<a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[0],<a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <span class="keywordtype">int</span> lev = 0;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <span class="keywordtype">int</span> iteration = 1;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <a class="code" href="classERF.html#aff397ccf7eb99c51d7c705a35e85ec5f">timeStep</a>(lev, cur_time, iteration);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        cur_time  += <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[0];</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160; </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        Print() &lt;&lt; <span class="stringliteral">&quot;Coarse STEP &quot;</span> &lt;&lt; step+1 &lt;&lt; <span class="stringliteral">&quot; ends.&quot;</span> &lt;&lt; <span class="stringliteral">&quot; TIME = &quot;</span> &lt;&lt; cur_time</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot; DT = &quot;</span> &lt;&lt; <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[0]  &lt;&lt; std::endl;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <a class="code" href="classERF.html#a58f6683aff0fbe6949bfe8b49275a8b3">post_timestep</a>(step, cur_time, <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[0]);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#af2e4de4eaa0f93149c1aefd58dc7068a">writeNow</a>(cur_time, <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[0], step+1, <a class="code" href="classERF.html#a57cfb4bfead8525174646964992c7e69">m_plot_int_1</a>, <a class="code" href="classERF.html#a3167adc9518cce649a90ab82e9f9c85d">m_plot_per_1</a>)) {</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            <a class="code" href="classERF.html#a7d54d3f2317d06a8dfcde4f65cfc3e92">last_plot_file_step_1</a> = step+1;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            <a class="code" href="classERF.html#a0b0b4140e117163895e5e2c89a68d12a">WritePlotFile</a>(1,<a class="code" href="classERF.html#a6865cf87abbb5aab0db00ff3b1ce94ac">plot_var_names_1</a>);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        }</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#af2e4de4eaa0f93149c1aefd58dc7068a">writeNow</a>(cur_time, <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[0], step+1, <a class="code" href="classERF.html#ad3311c9ceacd17f34bdb5e03cefa33b3">m_plot_int_2</a>, <a class="code" href="classERF.html#aff879a9c686293a10a3a03027b765c51">m_plot_per_2</a>)) {</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            <a class="code" href="classERF.html#a09017292c9943ac2ed20ce7ed5c3c767">last_plot_file_step_2</a> = step+1;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            <a class="code" href="classERF.html#a0b0b4140e117163895e5e2c89a68d12a">WritePlotFile</a>(2,<a class="code" href="classERF.html#a79705c02d6f25fbdcec14ca2432e5da1">plot_var_names_2</a>);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        }</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160; </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#af2e4de4eaa0f93149c1aefd58dc7068a">writeNow</a>(cur_time, <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[0], step+1, <a class="code" href="classERF.html#a69a3f925e95ec4244b0257f9de16d65a">m_check_int</a>, <a class="code" href="classERF.html#a5fbf17cfc8d9e5b994783e05ec3594b2">m_check_per</a>)) {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            <a class="code" href="classERF.html#a02722d16f3c26efe590702200f1296d7">last_check_file_step</a> = step+1;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="preprocessor">#ifdef ERF_USE_NETCDF</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32e0d0f5ae0db18ee81f9d4325a14f64">check_type</a> == <span class="stringliteral">&quot;netcdf&quot;</span>) {</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;               WriteNCCheckpointFile();</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;            }</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32e0d0f5ae0db18ee81f9d4325a14f64">check_type</a> == <span class="stringliteral">&quot;native&quot;</span>) {</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;               <a class="code" href="classERF.html#ad101fd46096db2d6b21544bfede6551f">WriteCheckpointFile</a>();</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            }</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        }</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="preprocessor">#ifdef AMREX_MEM_PROFILING</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        {</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            std::ostringstream ss;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            ss &lt;&lt; <span class="stringliteral">&quot;[STEP &quot;</span> &lt;&lt; step+1 &lt;&lt; <span class="stringliteral">&quot;]&quot;</span>;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            MemProfiler::report(ss.str());</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        }</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <span class="keywordflow">if</span> (cur_time &gt;= <a class="code" href="classERF.html#a405556a52bef334ab68294c1a540e107">stop_time</a> - 1.e-6*<a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[0]) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    }</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="comment">// Write plotfiles at final time</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="keywordflow">if</span> ( (<a class="code" href="classERF.html#a57cfb4bfead8525174646964992c7e69">m_plot_int_1</a> &gt; 0 || <a class="code" href="classERF.html#a3167adc9518cce649a90ab82e9f9c85d">m_plot_per_1</a> &gt; 0.) &amp;&amp; <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[0] &gt; <a class="code" href="classERF.html#a7d54d3f2317d06a8dfcde4f65cfc3e92">last_plot_file_step_1</a> ) {</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        <a class="code" href="classERF.html#a0b0b4140e117163895e5e2c89a68d12a">WritePlotFile</a>(1,<a class="code" href="classERF.html#a6865cf87abbb5aab0db00ff3b1ce94ac">plot_var_names_1</a>);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    }</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="keywordflow">if</span> ( (<a class="code" href="classERF.html#ad3311c9ceacd17f34bdb5e03cefa33b3">m_plot_int_2</a> &gt; 0 || <a class="code" href="classERF.html#aff879a9c686293a10a3a03027b765c51">m_plot_per_2</a> &gt; 0.) &amp;&amp; <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[0] &gt; <a class="code" href="classERF.html#a09017292c9943ac2ed20ce7ed5c3c767">last_plot_file_step_2</a>) {</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        <a class="code" href="classERF.html#a0b0b4140e117163895e5e2c89a68d12a">WritePlotFile</a>(2,<a class="code" href="classERF.html#a79705c02d6f25fbdcec14ca2432e5da1">plot_var_names_2</a>);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    }</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keywordflow">if</span> ( (<a class="code" href="classERF.html#a69a3f925e95ec4244b0257f9de16d65a">m_check_int</a> &gt; 0 || <a class="code" href="classERF.html#a5fbf17cfc8d9e5b994783e05ec3594b2">m_check_per</a> &gt; 0.) &amp;&amp; <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[0] &gt; <a class="code" href="classERF.html#a02722d16f3c26efe590702200f1296d7">last_check_file_step</a>) {</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="preprocessor">#ifdef ERF_USE_NETCDF</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32e0d0f5ae0db18ee81f9d4325a14f64">check_type</a> == <span class="stringliteral">&quot;netcdf&quot;</span>) {</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;           WriteNCCheckpointFile();</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        }</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32e0d0f5ae0db18ee81f9d4325a14f64">check_type</a> == <span class="stringliteral">&quot;native&quot;</span>) {</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;           <a class="code" href="classERF.html#ad101fd46096db2d6b21544bfede6551f">WriteCheckpointFile</a>();</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        }</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    }</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160; </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    BL_PROFILE_VAR_STOP(evolve);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_a02722d16f3c26efe590702200f1296d7"><div class="ttname"><a href="classERF.html#a02722d16f3c26efe590702200f1296d7">ERF::last_check_file_step</a></div><div class="ttdeci">int last_check_file_step</div><div class="ttdef"><b>Definition:</b> ERF.H:658</div></div>
<div class="ttc" id="aclassERF_html_a0634154e8e58379c495c3e7fe7c5e4d6"><div class="ttname"><a href="classERF.html#a0634154e8e58379c495c3e7fe7c5e4d6">ERF::max_step</a></div><div class="ttdeci">int max_step</div><div class="ttdef"><b>Definition:</b> ERF.H:665</div></div>
<div class="ttc" id="aclassERF_html_a09017292c9943ac2ed20ce7ed5c3c767"><div class="ttname"><a href="classERF.html#a09017292c9943ac2ed20ce7ed5c3c767">ERF::last_plot_file_step_2</a></div><div class="ttdeci">int last_plot_file_step_2</div><div class="ttdef"><b>Definition:</b> ERF.H:656</div></div>
<div class="ttc" id="aclassERF_html_a0b0b4140e117163895e5e2c89a68d12a"><div class="ttname"><a href="classERF.html#a0b0b4140e117163895e5e2c89a68d12a">ERF::WritePlotFile</a></div><div class="ttdeci">void WritePlotFile(int which, amrex::Vector&lt; std::string &gt; plot_var_names)</div><div class="ttdef"><b>Definition:</b> Plotfile.cpp:143</div></div>
<div class="ttc" id="aclassERF_html_a199add69cee34c6611a5dc9ee965971c"><div class="ttname"><a href="classERF.html#a199add69cee34c6611a5dc9ee965971c">ERF::m_bc_extdir_vals</a></div><div class="ttdeci">amrex::Array&lt; amrex::Array&lt; amrex::Real, AMREX_SPACEDIM *2 &gt;, AMREX_SPACEDIM+NVAR_max &gt; m_bc_extdir_vals</div><div class="ttdef"><b>Definition:</b> ERF.H:647</div></div>
<div class="ttc" id="aclassERF_html_a3167adc9518cce649a90ab82e9f9c85d"><div class="ttname"><a href="classERF.html#a3167adc9518cce649a90ab82e9f9c85d">ERF::m_plot_per_1</a></div><div class="ttdeci">amrex::Real m_plot_per_1</div><div class="ttdef"><b>Definition:</b> ERF.H:691</div></div>
<div class="ttc" id="aclassERF_html_a32e0d0f5ae0db18ee81f9d4325a14f64"><div class="ttname"><a href="classERF.html#a32e0d0f5ae0db18ee81f9d4325a14f64">ERF::check_type</a></div><div class="ttdeci">std::string check_type</div><div class="ttdef"><b>Definition:</b> ERF.H:702</div></div>
<div class="ttc" id="aclassERF_html_a57cfb4bfead8525174646964992c7e69"><div class="ttname"><a href="classERF.html#a57cfb4bfead8525174646964992c7e69">ERF::m_plot_int_1</a></div><div class="ttdeci">int m_plot_int_1</div><div class="ttdef"><b>Definition:</b> ERF.H:689</div></div>
<div class="ttc" id="aclassERF_html_a58f6683aff0fbe6949bfe8b49275a8b3"><div class="ttname"><a href="classERF.html#a58f6683aff0fbe6949bfe8b49275a8b3">ERF::post_timestep</a></div><div class="ttdeci">void post_timestep(int nstep, amrex::Real time, amrex::Real dt_lev)</div><div class="ttdef"><b>Definition:</b> ERF.cpp:353</div></div>
<div class="ttc" id="aclassERF_html_a5fbf17cfc8d9e5b994783e05ec3594b2"><div class="ttname"><a href="classERF.html#a5fbf17cfc8d9e5b994783e05ec3594b2">ERF::m_check_per</a></div><div class="ttdeci">amrex::Real m_check_per</div><div class="ttdef"><b>Definition:</b> ERF.H:705</div></div>
<div class="ttc" id="aclassERF_html_a62a5ed3c3806eaa918257e0ad1382df5"><div class="ttname"><a href="classERF.html#a62a5ed3c3806eaa918257e0ad1382df5">ERF::ComputeDt</a></div><div class="ttdeci">void ComputeDt()</div><div class="ttdef"><b>Definition:</b> ERF_ComputeTimestep.cpp:11</div></div>
<div class="ttc" id="aclassERF_html_a69a3f925e95ec4244b0257f9de16d65a"><div class="ttname"><a href="classERF.html#a69a3f925e95ec4244b0257f9de16d65a">ERF::m_check_int</a></div><div class="ttdeci">int m_check_int</div><div class="ttdef"><b>Definition:</b> ERF.H:704</div></div>
<div class="ttc" id="aclassERF_html_a7d54d3f2317d06a8dfcde4f65cfc3e92"><div class="ttname"><a href="classERF.html#a7d54d3f2317d06a8dfcde4f65cfc3e92">ERF::last_plot_file_step_1</a></div><div class="ttdeci">int last_plot_file_step_1</div><div class="ttdef"><b>Definition:</b> ERF.H:655</div></div>
<div class="ttc" id="aclassERF_html_a80ad08512968ec45635df68abe66b1fc"><div class="ttname"><a href="classERF.html#a80ad08512968ec45635df68abe66b1fc">ERF::input_bndry_planes</a></div><div class="ttdeci">static int input_bndry_planes</div><div class="ttdef"><b>Definition:</b> ERF.H:802</div></div>
<div class="ttc" id="aclassERF_html_ad101fd46096db2d6b21544bfede6551f"><div class="ttname"><a href="classERF.html#ad101fd46096db2d6b21544bfede6551f">ERF::WriteCheckpointFile</a></div><div class="ttdeci">void WriteCheckpointFile() const</div><div class="ttdef"><b>Definition:</b> Checkpoint.cpp:23</div></div>
<div class="ttc" id="aclassERF_html_ad3311c9ceacd17f34bdb5e03cefa33b3"><div class="ttname"><a href="classERF.html#ad3311c9ceacd17f34bdb5e03cefa33b3">ERF::m_plot_int_2</a></div><div class="ttdeci">int m_plot_int_2</div><div class="ttdef"><b>Definition:</b> ERF.H:690</div></div>
<div class="ttc" id="aclassERF_html_addf62bfc534515447b94e928ac0b7135"><div class="ttname"><a href="classERF.html#addf62bfc534515447b94e928ac0b7135">ERF::m_r2d</a></div><div class="ttdeci">std::unique_ptr&lt; ReadBndryPlanes &gt; m_r2d</div><div class="ttdef"><b>Definition:</b> ERF.H:838</div></div>
<div class="ttc" id="aclassERF_html_af2e4de4eaa0f93149c1aefd58dc7068a"><div class="ttname"><a href="classERF.html#af2e4de4eaa0f93149c1aefd58dc7068a">ERF::writeNow</a></div><div class="ttdeci">bool writeNow(const amrex::Real cur_time, const amrex::Real dt, const int nstep, const int plot_int, const amrex::Real plot_per)</div><div class="ttdef"><b>Definition:</b> ERF.cpp:1886</div></div>
<div class="ttc" id="aclassERF_html_aff397ccf7eb99c51d7c705a35e85ec5f"><div class="ttname"><a href="classERF.html#aff397ccf7eb99c51d7c705a35e85ec5f">ERF::timeStep</a></div><div class="ttdeci">void timeStep(int lev, amrex::Real time, int iteration)</div><div class="ttdef"><b>Definition:</b> ERF_TimeStep.cpp:16</div></div>
<div class="ttc" id="aclassERF_html_aff879a9c686293a10a3a03027b765c51"><div class="ttname"><a href="classERF.html#aff879a9c686293a10a3a03027b765c51">ERF::m_plot_per_2</a></div><div class="ttdeci">amrex::Real m_plot_per_2</div><div class="ttdef"><b>Definition:</b> ERF.H:692</div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a0be12798b46f52fa4b5a995f147c3f96_icgraph.png" border="0" usemap="#aclassERF_a0be12798b46f52fa4b5a995f147c3f96_icgraph" alt=""/></div>
<map name="aclassERF_a0be12798b46f52fa4b5a995f147c3f96_icgraph" id="aclassERF_a0be12798b46f52fa4b5a995f147c3f96_icgraph">
<area shape="rect" title=" " alt="" coords="108,5,207,32"/>
<area shape="rect" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,60,32"/>
</map>
</div>

</div>
</div>
<a id="a2135641de33dea5057799569c74cac42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2135641de33dea5057799569c74cac42">&#9670;&nbsp;</a></span>fill_from_bndryregs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::fill_from_bndryregs </td>
          <td>(</td>
          <td class="paramtype">const amrex::Vector&lt; amrex::MultiFab * &gt; &amp;&#160;</td>
          <td class="paramname"><em>mfs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;{</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <span class="comment">// We now assume that if we read in on one face, we read in on all faces</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    AMREX_ALWAYS_ASSERT(<a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>);</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160; </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <span class="keywordtype">int</span> lev = 0;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="keyword">const</span> Box&amp; domain = geom[lev].Domain();</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; dom_lo = lbound(domain);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; dom_hi = ubound(domain);</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    Vector&lt;std::unique_ptr&lt;PlaneVector&gt;&gt;&amp; bndry_data = <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;interp_in_time(time);</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="comment">// xlo: ori = 0</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="comment">// ylo: ori = 1</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="comment">// zlo: ori = 2</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="comment">// xhi: ori = 3</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="comment">// yhi: ori = 4</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="comment">// zhi: ori = 5</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; bdatxlo = (*bndry_data[0])[lev].const_array();</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; bdatylo = (*bndry_data[1])[lev].const_array();</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; bdatxhi = (*bndry_data[3])[lev].const_array();</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; bdatyhi = (*bndry_data[4])[lev].const_array();</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keywordtype">int</span> bccomp;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> var_idx = 0; var_idx &lt; <a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a5deccaa24d5e74279425d7749f7d1494">Vars::NumTypes</a>; ++var_idx)</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    {</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        MultiFab&amp; mf = *mfs[var_idx];</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> icomp = 0;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> ncomp = mf.nComp();</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        <span class="keywordflow">if</span> (var_idx == <a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>) {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;           bccomp = <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (var_idx == <a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>) {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;           bccomp = <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a>;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (var_idx == <a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>) {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;           bccomp = <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa03b35ec9e83f34bb1349a86965d34e34">BCVars::zvel_bc</a>;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        } <span class="keywordflow">else</span>  <span class="keywordflow">if</span> (var_idx == <a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>) {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;           bccomp = <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        }</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#ifdef AMREX_USE_OMP</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#pragma omp parallel if (Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <span class="keywordflow">for</span> (MFIter mfi(mf); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        {</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;            <span class="keyword">const</span> Array4&lt;Real&gt;&amp; dest_arr = mf.array(mfi);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;            Box bx = mfi.growntilebox();</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;            <span class="comment">// x-faces</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;            {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;            Box bx_xlo(bx); bx_xlo.setBig(0,dom_lo.x-1);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;            <span class="keywordflow">if</span> (var_idx == <a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>) bx_xlo.setBig(0,dom_lo.x);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;            Box bx_xhi(bx); bx_xhi.setSmall(0,dom_hi.x+1);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            <span class="keywordflow">if</span> (var_idx == <a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>) bx_xhi.setSmall(0,dom_hi.x);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            ParallelFor(</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                bx_xlo, ncomp, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k, <span class="keywordtype">int</span> n) {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                    <span class="keywordtype">int</span> jb = std::min(std::max(j,dom_lo.y),dom_hi.y);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                    <span class="keywordtype">int</span> kb = std::min(std::max(k,dom_lo.z),dom_hi.z);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                    dest_arr(i,j,k,icomp+n) = bdatxlo(dom_lo.x-1,jb,kb,bccomp+n);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                },</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                bx_xhi, ncomp, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k, <span class="keywordtype">int</span> n) {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                    <span class="keywordtype">int</span> jb = std::min(std::max(j,dom_lo.y),dom_hi.y);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                    <span class="keywordtype">int</span> kb = std::min(std::max(k,dom_lo.z),dom_hi.z);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                    dest_arr(i,j,k,icomp+n) = bdatxhi(dom_hi.x+1,jb,kb,bccomp+n);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                }</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;            );</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            } <span class="comment">// x-faces</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            <span class="comment">// y-faces</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            Box bx_ylo(bx); bx_ylo.setBig  (1,dom_lo.y-1);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            <span class="keywordflow">if</span> (var_idx == <a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>) bx_ylo.setBig(1,dom_lo.y);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;            Box bx_yhi(bx); bx_yhi.setSmall(1,dom_hi.y+1);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            <span class="keywordflow">if</span> (var_idx == <a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>) bx_yhi.setSmall(1,dom_hi.y);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            ParallelFor(</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;               bx_ylo, ncomp, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k, <span class="keywordtype">int</span> n) {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                    <span class="keywordtype">int</span> ib = std::min(std::max(i,dom_lo.x),dom_hi.x);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                    <span class="keywordtype">int</span> kb = std::min(std::max(k,dom_lo.z),dom_hi.z);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                    dest_arr(i,j,k,icomp+n) = bdatylo(ib,dom_lo.y-1,kb,bccomp+n);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                },</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                bx_yhi, ncomp, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k, <span class="keywordtype">int</span> n) {</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                    <span class="keywordtype">int</span> ib = std::min(std::max(i,dom_lo.x),dom_hi.x);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                    <span class="keywordtype">int</span> kb = std::min(std::max(k,dom_lo.z),dom_hi.z);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                    dest_arr(i,j,k,icomp+n) = bdatyhi(ib,dom_hi.y+1,kb,bccomp+n);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                }</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;            );</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            } <span class="comment">// y-faces</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        } <span class="comment">// mf</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    } <span class="comment">// var_idx</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;}</div>
<div class="ttc" id="anamespaceBCVars_html_a00367571247ba920989360b94c156f4aa03b35ec9e83f34bb1349a86965d34e34"><div class="ttname"><a href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa03b35ec9e83f34bb1349a86965d34e34">BCVars::zvel_bc</a></div><div class="ttdeci">@ zvel_bc</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:57</div></div>
<div class="ttc" id="anamespaceBCVars_html_a00367571247ba920989360b94c156f4aa98ad22810fdfe9e585bc6481fc12454e"><div class="ttname"><a href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a></div><div class="ttdeci">@ yvel_bc</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:56</div></div>
<div class="ttc" id="anamespaceBCVars_html_a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec"><div class="ttname"><a href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a></div><div class="ttdeci">@ cons_bc</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:47</div></div>
<div class="ttc" id="anamespaceBCVars_html_a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4"><div class="ttname"><a href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a></div><div class="ttdeci">@ xvel_bc</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:55</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a76600d7a4a0451c9727d2cc57dae4220"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76600d7a4a0451c9727d2cc57dae4220">&#9670;&nbsp;</a></span>fill_rhs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::fill_rhs </td>
          <td>(</td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>rhs_mf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>state_mf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Geometry &amp;&#160;</td>
          <td class="paramname"><em>geom</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ac4497025ab94461899960ee067c2c72a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4497025ab94461899960ee067c2c72a">&#9670;&nbsp;</a></span>FillCoarsePatch()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::FillCoarsePatch </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;{</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    BL_PROFILE_VAR(<span class="stringliteral">&quot;FillCoarsePatch()&quot;</span>,<a class="code" href="classERF.html#ac4497025ab94461899960ee067c2c72a">FillCoarsePatch</a>);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    AMREX_ASSERT(lev &gt; 0);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160; </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="keywordtype">int</span> icomp = 0;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160; </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="keywordtype">int</span> bccomp = 0;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    Interpolater* mapper = &amp;cell_cons_interp;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    InterpFromCoarseLevel(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], time, <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev-1][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                          icomp, icomp, <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nComp(),</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                          geom[lev-1], geom[lev],</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                          <a class="code" href="ERF__FillPatch_8cpp.html#a85a7293fad1a59ed566bcea306373abc">null_bc</a>, 0, <a class="code" href="ERF__FillPatch_8cpp.html#a85a7293fad1a59ed566bcea306373abc">null_bc</a>, 0, refRatio(lev-1),</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                          mapper, <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>, bccomp);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160; </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160; </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    mapper = &amp;face_cons_linear_interp;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160; </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> which_lev = lev-1; which_lev &lt;= lev; which_lev++)</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    {</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        <span class="comment">// First fill density so we can convert velocity to momenta</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        <span class="comment">// Note we can only do this because we first interpolated density above</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        <span class="keywordtype">bool</span> cons_only = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        <a class="code" href="classERF.html#a8de69f537859f576fba1d94844cfbd33">FillPatch</a>(which_lev, time, {&amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[which_lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], &amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[which_lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                                    &amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[which_lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>], &amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[which_lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>]},</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                                   {&amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[which_lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                                    &amp;<a class="code" href="classERF.html#a01f3db32272f53dc68025f0a98195e57">rU_new</a>[which_lev], &amp;<a class="code" href="classERF.html#a54e37988486ef96e55e84bd8e91bb688">rV_new</a>[which_lev], &amp;<a class="code" href="classERF.html#aa46c0b0d20525aed10f447923e54dde7">rW_new</a>[which_lev]},</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                                    <span class="keyword">false</span>, cons_only);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160; </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        <a class="code" href="Utils_8H.html#a087ad6f9e01593fb0cd3624ff6caaf14">VelocityToMomentum</a>(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[which_lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>], IntVect(0,0,0),</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                           <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[which_lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>], IntVect(0,0,0),</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                           <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[which_lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>], IntVect(0,0,0),</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                           <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[which_lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                             <a class="code" href="classERF.html#a01f3db32272f53dc68025f0a98195e57">rU_new</a>[which_lev],</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                             <a class="code" href="classERF.html#a54e37988486ef96e55e84bd8e91bb688">rV_new</a>[which_lev],</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                             <a class="code" href="classERF.html#aa46c0b0d20525aed10f447923e54dde7">rW_new</a>[which_lev],</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                           <span class="keyword">true</span>);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    }</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160; </div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    bccomp = <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    InterpFromCoarseLevel(<a class="code" href="classERF.html#a01f3db32272f53dc68025f0a98195e57">rU_new</a>[lev], time, <a class="code" href="classERF.html#a01f3db32272f53dc68025f0a98195e57">rU_new</a>[lev-1],</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                          0, 0, 1, geom[lev-1], geom[lev],</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                          <a class="code" href="ERF__FillPatch_8cpp.html#a85a7293fad1a59ed566bcea306373abc">null_bc</a>, 0, <a class="code" href="ERF__FillPatch_8cpp.html#a85a7293fad1a59ed566bcea306373abc">null_bc</a>, 0, refRatio(lev-1),</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                          mapper, <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>, bccomp);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160; </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    bccomp = <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a>;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    InterpFromCoarseLevel(<a class="code" href="classERF.html#a54e37988486ef96e55e84bd8e91bb688">rV_new</a>[lev], time, <a class="code" href="classERF.html#a54e37988486ef96e55e84bd8e91bb688">rV_new</a>[lev-1],</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                          0, 0, 1, geom[lev-1], geom[lev],</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                          <a class="code" href="ERF__FillPatch_8cpp.html#a85a7293fad1a59ed566bcea306373abc">null_bc</a>, 0, <a class="code" href="ERF__FillPatch_8cpp.html#a85a7293fad1a59ed566bcea306373abc">null_bc</a>, 0, refRatio(lev-1),</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                          mapper, <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>, bccomp);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160; </div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    bccomp = <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa03b35ec9e83f34bb1349a86965d34e34">BCVars::zvel_bc</a>;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    InterpFromCoarseLevel(<a class="code" href="classERF.html#aa46c0b0d20525aed10f447923e54dde7">rW_new</a>[lev], time, <a class="code" href="classERF.html#aa46c0b0d20525aed10f447923e54dde7">rW_new</a>[lev-1],</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                          0, 0, 1, geom[lev-1], geom[lev],</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                          <a class="code" href="ERF__FillPatch_8cpp.html#a85a7293fad1a59ed566bcea306373abc">null_bc</a>, 0, <a class="code" href="ERF__FillPatch_8cpp.html#a85a7293fad1a59ed566bcea306373abc">null_bc</a>, 0, refRatio(lev-1),</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                          mapper, <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>, bccomp);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160; </div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> which_lev = lev-1; which_lev &lt;= lev; which_lev++)</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;   {</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        <a class="code" href="MomentumToVelocity_8cpp.html#ab444cbf9148a526aaf41e9d510dfedb7">MomentumToVelocity</a>(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[which_lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                           <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[which_lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                           <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[which_lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>],</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                           <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[which_lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                             <a class="code" href="classERF.html#a01f3db32272f53dc68025f0a98195e57">rU_new</a>[which_lev],</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                             <a class="code" href="classERF.html#a54e37988486ef96e55e84bd8e91bb688">rV_new</a>[which_lev],</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                             <a class="code" href="classERF.html#aa46c0b0d20525aed10f447923e54dde7">rW_new</a>[which_lev]);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    }</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160; </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160; </div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="comment">// Physical bc&#39;s at domain boundary</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    IntVect ngvect_cons = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nGrowVect();</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    IntVect ngvect_vels = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].nGrowVect();</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160; </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="keywordtype">int</span> ncomp_cons = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nComp();</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160; </div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    (*<a class="code" href="classERF.html#a2e9b04043853d25f2d76edbc0bed2e72">physbcs_cons</a>[lev])(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],0,ncomp_cons,ngvect_cons,time,<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    (   *<a class="code" href="classERF.html#a64e55e5ae9df06433146db657eb9e72e">physbcs_u</a>[lev])(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],0,1         ,ngvect_vels,time,<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>);</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    (   *<a class="code" href="classERF.html#a79231b5cfd4576a742e46ae0082b5121">physbcs_v</a>[lev])(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],0,1         ,ngvect_vels,time,<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a>);</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    (   *<a class="code" href="classERF.html#a45c8ecd777f47732993777a0afb8e140">physbcs_w</a>[lev])(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>],<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                         ngvect_vels,time,<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>,<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a>,<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa03b35ec9e83f34bb1349a86965d34e34">BCVars::zvel_bc</a>);</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160; </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="comment">// Since lev &gt; 0 here we don&#39;t worry about m_r2d or wrfbdy data</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_ac4497025ab94461899960ee067c2c72a"><div class="ttname"><a href="classERF.html#ac4497025ab94461899960ee067c2c72a">ERF::FillCoarsePatch</a></div><div class="ttdeci">void FillCoarsePatch(int lev, amrex::Real time)</div><div class="ttdef"><b>Definition:</b> ERF_FillPatch.cpp:384</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_ac4497025ab94461899960ee067c2c72a_cgraph.png" border="0" usemap="#aclassERF_ac4497025ab94461899960ee067c2c72a_cgraph" alt=""/></div>
<map name="aclassERF_ac4497025ab94461899960ee067c2c72a_cgraph" id="aclassERF_ac4497025ab94461899960ee067c2c72a_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,159,57"/>
<area shape="rect" href="MomentumToVelocity_8cpp.html#ab444cbf9148a526aaf41e9d510dfedb7" title=" " alt="" coords="207,5,369,32"/>
<area shape="rect" href="Utils_8H.html#a087ad6f9e01593fb0cd3624ff6caaf14" title=" " alt="" coords="207,56,369,83"/>
</map>
</div>

</div>
</div>
<a id="a5434c771d76cf50e4a0dd9e1b0eb27fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5434c771d76cf50e4a0dd9e1b0eb27fc">&#9670;&nbsp;</a></span>FillIntermediatePatch()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::FillIntermediatePatch </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Vector&lt; amrex::MultiFab * &gt; &amp;&#160;</td>
          <td class="paramname"><em>mfs_vel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Vector&lt; amrex::MultiFab * &gt; &amp;&#160;</td>
          <td class="paramname"><em>mfs_mom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ng_cons</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ng_vel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>cons_only</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>icomp_cons</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ncomp_cons</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>allow_most_bcs</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;{</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    BL_PROFILE_VAR(<span class="stringliteral">&quot;FillIntermediatePatch()&quot;</span>,<a class="code" href="classERF.html#a5434c771d76cf50e4a0dd9e1b0eb27fc">FillIntermediatePatch</a>);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordtype">int</span> bccomp;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    Interpolater* mapper;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="comment">// The first thing we do is interpolate the momenta on the &quot;valid&quot; faces of</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="comment">// the fine grids (where the interface is coarse/fine not fine/fine) -- this</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="comment">// will not be over-written by interpolation below because the FillPatch</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="comment">// operators see these as valid faces.  But we must have these interpolated</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="comment">// values in the fine data before we call FillPatchTwoLevels.</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="comment">// Also -- note that we might be filling values by interpolation at physical boundaries</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="comment">//         here but that&#39;s ok because we will overwrite those values when we impose</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="comment">//         the physical bc&#39;s below</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordflow">if</span> (lev&gt;0) {</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a1e3e2855b6e811596226c167573ad62d">cf_set_width</a> &gt; 0) {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            <span class="comment">// We note that mfs_vel[Vars::cons] and mfs_mom[Vars::cons] are in fact the same pointer</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            <a class="code" href="classERF.html#a34160ca20fb400ee285664117cb80512">FPr_c</a>[lev-1].FillSet(*mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], time, <a class="code" href="ERF__FillPatch_8cpp.html#a85a7293fad1a59ed566bcea306373abc">null_bc</a>, <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <span class="keywordflow">if</span> ( !cons_only &amp;&amp; (<a class="code" href="classERF.html#a1e3e2855b6e811596226c167573ad62d">cf_set_width</a> &gt;= 0) ) {</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            <a class="code" href="classERF.html#a0ef3455d5b4fc9a178e023b233d389a4">FPr_u</a>[lev-1].FillSet(*mfs_mom[<a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daaf661293a5a71ca532c214929b98c0bad">IntVars::xmom</a>], time, <a class="code" href="ERF__FillPatch_8cpp.html#a85a7293fad1a59ed566bcea306373abc">null_bc</a>, <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            <a class="code" href="classERF.html#a1dc7086aec533a042e6033706845b0c3">FPr_v</a>[lev-1].FillSet(*mfs_mom[<a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daa2e60798bc45154a8f905b1aa228a24e5">IntVars::ymom</a>], time, <a class="code" href="ERF__FillPatch_8cpp.html#a85a7293fad1a59ed566bcea306373abc">null_bc</a>, <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            <a class="code" href="classERF.html#ac9a11403c2238d0d1e7b65b2d100dbaf">FPr_w</a>[lev-1].FillSet(*mfs_mom[<a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daaaab25f707cae69bfadac2abcd17a2188">IntVars::zmom</a>], time, <a class="code" href="ERF__FillPatch_8cpp.html#a85a7293fad1a59ed566bcea306373abc">null_bc</a>, <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        }</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    }</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    AMREX_ALWAYS_ASSERT(mfs_mom.size() == <a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daa0468f4146b966163a1fe9f4f32a038c8">IntVars::NumTypes</a>);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    AMREX_ALWAYS_ASSERT(mfs_vel.size() == <a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a5deccaa24d5e74279425d7749f7d1494">Vars::NumTypes</a>);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="comment">// We always come in to this call with updated momenta but we need to create updated velocity</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="comment">//    in order to impose the rest of the bc&#39;s</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keywordflow">if</span> (!cons_only) {</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <span class="comment">// This only fills VALID region of velocity</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <a class="code" href="MomentumToVelocity_8cpp.html#ab444cbf9148a526aaf41e9d510dfedb7">MomentumToVelocity</a>(*mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>], *mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>], *mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>],</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                           *mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                           *mfs_mom[<a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daaf661293a5a71ca532c214929b98c0bad">IntVars::xmom</a>], *mfs_mom[<a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daa2e60798bc45154a8f905b1aa228a24e5">IntVars::ymom</a>], *mfs_mom[<a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daaaab25f707cae69bfadac2abcd17a2188">IntVars::zmom</a>]);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    }</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160; </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="comment">// We now start working on VELOCITY</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> var_idx = 0; var_idx &lt; <a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a5deccaa24d5e74279425d7749f7d1494">Vars::NumTypes</a>; ++var_idx)</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <span class="keywordflow">if</span> (cons_only &amp;&amp; var_idx != <a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        MultiFab&amp; mf = *mfs_vel[var_idx];</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        IntVect ngvect;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <span class="keywordtype">int</span> icomp, ncomp;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="keywordflow">if</span> (var_idx == <a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>)</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        {</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            bccomp = icomp_cons;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            mapper = &amp;cell_cons_interp;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            ngvect = IntVect(ng_cons,ng_cons,ng_cons);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            icomp  = icomp_cons;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            ncomp  = ncomp_cons;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        }</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (var_idx == <a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daaf661293a5a71ca532c214929b98c0bad">IntVars::xmom</a>)</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        {</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            bccomp = <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            mapper = &amp;face_cons_linear_interp;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            ngvect = IntVect(ng_vel,ng_vel,ng_vel);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            icomp  = 0;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            ncomp  = 1;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        }</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (var_idx == <a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daa2e60798bc45154a8f905b1aa228a24e5">IntVars::ymom</a>)</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        {</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;            bccomp = <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a>;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            mapper = &amp;face_cons_linear_interp;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            ngvect = IntVect(ng_vel,ng_vel,ng_vel);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            icomp  = 0;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            ncomp  = 1;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        }</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (var_idx == <a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daaaab25f707cae69bfadac2abcd17a2188">IntVars::zmom</a>)</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        {</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            bccomp = <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa03b35ec9e83f34bb1349a86965d34e34">BCVars::zvel_bc</a>;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            mapper = &amp;face_cons_linear_interp;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            ngvect = IntVect(ng_vel,ng_vel,0);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            icomp  = 0;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            ncomp  = 1;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        }</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        <span class="keywordflow">if</span> (lev == 0)</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            <span class="comment">// This fills fine-fine ghost values of VELOCITY</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            mf.FillBoundary(icomp,ncomp,ngvect,geom[lev].periodicity());</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        }</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        {</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            <span class="comment">// NOTE: All interpolation here happens on velocities not momenta;</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            <span class="comment">//       note we only do the interpolation and FillBoundary here,</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            <span class="comment">//       physical bc&#39;s are imposed later</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;            <span class="comment">// NOTE: This will only fill velocity from coarse grid *outside* the fine grids</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            <span class="comment">//       unlike the FillSet calls above which filled momenta on the coarse/fine bdy</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            Vector&lt;MultiFab*&gt; fmf = {&amp;mf};</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            Vector&lt;MultiFab*&gt; cmf = {&amp;<a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev-1][var_idx], &amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev-1][var_idx]};</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            Vector&lt;Real&gt; ctime    = {<a class="code" href="classERF.html#a7085d7d5fc94a0f84efc06957267d58e">t_old</a>[lev-1], <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev-1]};</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160; </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;            FillPatchTwoLevels(mf, time, cmf, ctime, fmf, {time},</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                               icomp, icomp, ncomp, geom[lev-1], geom[lev],</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                               <a class="code" href="ERF__FillPatch_8cpp.html#a85a7293fad1a59ed566bcea306373abc">null_bc</a>, 0, <a class="code" href="ERF__FillPatch_8cpp.html#a85a7293fad1a59ed566bcea306373abc">null_bc</a>, 0, refRatio(lev-1),</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                               mapper, <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>, bccomp);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        } <span class="comment">// lev &gt; 0</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    } <span class="comment">// var_idx</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="comment">// Physical bc&#39;s at domain boundary</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    IntVect ngvect_cons = IntVect(ng_cons,ng_cons,ng_cons);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    IntVect ngvect_vels = IntVect(ng_vel ,ng_vel ,ng_vel);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="preprocessor">#ifdef ERF_USE_NETCDF</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="comment">// We call this here because it is an ERF routine</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a86208285bf705f360a3c318a75097f61">use_real_bcs</a> &amp;&amp; (lev==0)) {</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        fill_from_realbdy(mfs_vel,time,<span class="keyword">false</span>,0,ncomp_cons);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    }</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160; </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>) <a class="code" href="classERF.html#a2135641de33dea5057799569c74cac42">fill_from_bndryregs</a>(mfs_vel,time);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160; </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="comment">// We call this even if init_type == real because this routine will fill the vertical bcs</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    (*<a class="code" href="classERF.html#a2e9b04043853d25f2d76edbc0bed2e72">physbcs_cons</a>[lev])(*mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],icomp_cons,ncomp_cons,ngvect_cons,time,<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keywordflow">if</span> (!cons_only) {</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        (*<a class="code" href="classERF.html#a64e55e5ae9df06433146db657eb9e72e">physbcs_u</a>[lev])(*mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],0,1,ngvect_vels,time,<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        (*<a class="code" href="classERF.html#a79231b5cfd4576a742e46ae0082b5121">physbcs_v</a>[lev])(*mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],0,1,ngvect_vels,time,<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a>);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        (*<a class="code" href="classERF.html#a45c8ecd777f47732993777a0afb8e140">physbcs_w</a>[lev])(*mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>],*mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],*mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                           ngvect_vels,time,<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>,<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a>,<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa03b35ec9e83f34bb1349a86965d34e34">BCVars::zvel_bc</a>);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    }</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160; </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="comment">// MOST boundary conditions</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keywordflow">if</span> (!(cons_only &amp;&amp; ncomp_cons == 1) &amp;&amp; <a class="code" href="classERF.html#a051364b2373d8d86151c0b4a958035bd">m_most</a> &amp;&amp; allow_most_bcs)</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        <a class="code" href="classERF.html#a051364b2373d8d86151c0b4a958035bd">m_most</a>-&gt;impose_most_bcs(lev,mfs_vel,<a class="code" href="classERF.html#a327d704704abd516be19339cb2d226f9">eddyDiffs_lev</a>[lev].get(),<a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev].get());</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160; </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="comment">// We always come in to this call with momenta so we need to leave with momenta!</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="comment">// We need to make sure we convert back on all ghost cells/faces because this is</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="comment">// how velocity from fine-fine copies (as well as physical and interpolated bcs) will be filled</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keywordflow">if</span> (!cons_only) {</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        <a class="code" href="Utils_8H.html#a087ad6f9e01593fb0cd3624ff6caaf14">VelocityToMomentum</a>(*mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>], mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>]-&gt;nGrowVect(),</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                           *mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>], mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>]-&gt;nGrowVect(),</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                           *mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>], mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>]-&gt;nGrowVect(),</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                           *mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                           *mfs_mom[<a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daaf661293a5a71ca532c214929b98c0bad">IntVars::xmom</a>], *mfs_mom[<a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daa2e60798bc45154a8f905b1aa228a24e5">IntVars::ymom</a>], *mfs_mom[<a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daaaab25f707cae69bfadac2abcd17a2188">IntVars::zmom</a>],</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                           <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa2de671156cccf1f3a34b9f250fb0e28">use_NumDiff</a>);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    }</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_a2135641de33dea5057799569c74cac42"><div class="ttname"><a href="classERF.html#a2135641de33dea5057799569c74cac42">ERF::fill_from_bndryregs</a></div><div class="ttdeci">void fill_from_bndryregs(const amrex::Vector&lt; amrex::MultiFab * &gt; &amp;mfs, amrex::Real time)</div><div class="ttdef"><b>Definition:</b> BoundaryConditions_bndryreg.cpp:13</div></div>
<div class="ttc" id="aclassERF_html_a5434c771d76cf50e4a0dd9e1b0eb27fc"><div class="ttname"><a href="classERF.html#a5434c771d76cf50e4a0dd9e1b0eb27fc">ERF::FillIntermediatePatch</a></div><div class="ttdeci">void FillIntermediatePatch(int lev, amrex::Real time, const amrex::Vector&lt; amrex::MultiFab * &gt; &amp;mfs_vel, const amrex::Vector&lt; amrex::MultiFab * &gt; &amp;mfs_mom, int ng_cons, int ng_vel, bool cons_only, int icomp_cons, int ncomp_cons, bool allow_most_bcs=true)</div><div class="ttdef"><b>Definition:</b> ERF_FillPatch.cpp:216</div></div>
<div class="ttc" id="aclassERF_html_a86208285bf705f360a3c318a75097f61"><div class="ttname"><a href="classERF.html#a86208285bf705f360a3c318a75097f61">ERF::use_real_bcs</a></div><div class="ttdeci">static bool use_real_bcs</div><div class="ttdef"><b>Definition:</b> ERF.H:770</div></div>
<div class="ttc" id="anamespaceIntVars_html_afdaa1b64a98a711870ca86f30e7963daa0468f4146b966163a1fe9f4f32a038c8"><div class="ttname"><a href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daa0468f4146b966163a1fe9f4f32a038c8">IntVars::NumTypes</a></div><div class="ttdeci">@ NumTypes</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:113</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a5434c771d76cf50e4a0dd9e1b0eb27fc_cgraph.png" border="0" usemap="#aclassERF_a5434c771d76cf50e4a0dd9e1b0eb27fc_cgraph" alt=""/></div>
<map name="aclassERF_a5434c771d76cf50e4a0dd9e1b0eb27fc_cgraph" id="aclassERF_a5434c771d76cf50e4a0dd9e1b0eb27fc_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,197,57"/>
<area shape="rect" href="MomentumToVelocity_8cpp.html#ab444cbf9148a526aaf41e9d510dfedb7" title=" " alt="" coords="245,5,408,32"/>
<area shape="rect" href="Utils_8H.html#a087ad6f9e01593fb0cd3624ff6caaf14" title=" " alt="" coords="245,56,408,83"/>
</map>
</div>

</div>
</div>
<a id="a8de69f537859f576fba1d94844cfbd33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8de69f537859f576fba1d94844cfbd33">&#9670;&nbsp;</a></span>FillPatch()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::FillPatch </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Vector&lt; amrex::MultiFab * &gt; &amp;&#160;</td>
          <td class="paramname"><em>mfs_vel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Vector&lt; amrex::MultiFab * &gt; &amp;&#160;</td>
          <td class="paramname"><em>mfs_mom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>fillset</em> = <code>true</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>cons_only</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;{</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    BL_PROFILE_VAR(<span class="stringliteral">&quot;ERF::FillPatch()&quot;</span>,ERF_FillPatch);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    Interpolater* mapper = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="comment">// The first thing we do is interpolate the momenta on the &quot;valid&quot; faces of</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="comment">// the fine grids (where the interface is coarse/fine not fine/fine) -- this</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="comment">// will not be over-written below because the FillPatch operators see these as</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="comment">// valid faces.</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="comment">// Note that we interpolate momentum not velocity, but all the other boundary</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="comment">// conditions are imposed on velocity, so we convert to momentum here then</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="comment">// convert back.</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keywordflow">if</span> (lev&gt;0 &amp;&amp; fillset) {</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a1e3e2855b6e811596226c167573ad62d">cf_set_width</a> &gt; 0) {</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;            <a class="code" href="classERF.html#a34160ca20fb400ee285664117cb80512">FPr_c</a>[lev-1].FillSet(*mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], time, <a class="code" href="ERF__FillPatch_8cpp.html#a85a7293fad1a59ed566bcea306373abc">null_bc</a>, <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        }</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a1e3e2855b6e811596226c167573ad62d">cf_set_width</a> &gt;= 0 &amp;&amp; !cons_only) {</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;            <a class="code" href="Utils_8H.html#a087ad6f9e01593fb0cd3624ff6caaf14">VelocityToMomentum</a>(*mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>], mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>]-&gt;nGrowVect(),</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                               *mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>], mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>]-&gt;nGrowVect(),</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;                               *mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>], mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>]-&gt;nGrowVect(),</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;                               *mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;                               *mfs_mom[<a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daaf661293a5a71ca532c214929b98c0bad">IntVars::xmom</a>],</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                               *mfs_mom[<a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daa2e60798bc45154a8f905b1aa228a24e5">IntVars::ymom</a>],</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                               *mfs_mom[<a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daaaab25f707cae69bfadac2abcd17a2188">IntVars::zmom</a>],</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                               <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa2de671156cccf1f3a34b9f250fb0e28">use_NumDiff</a>);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;            <a class="code" href="classERF.html#a0ef3455d5b4fc9a178e023b233d389a4">FPr_u</a>[lev-1].FillSet(*mfs_mom[<a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daaf661293a5a71ca532c214929b98c0bad">IntVars::xmom</a>], time, <a class="code" href="ERF__FillPatch_8cpp.html#a85a7293fad1a59ed566bcea306373abc">null_bc</a>, <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;            <a class="code" href="classERF.html#a1dc7086aec533a042e6033706845b0c3">FPr_v</a>[lev-1].FillSet(*mfs_mom[<a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daa2e60798bc45154a8f905b1aa228a24e5">IntVars::ymom</a>], time, <a class="code" href="ERF__FillPatch_8cpp.html#a85a7293fad1a59ed566bcea306373abc">null_bc</a>, <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            <a class="code" href="classERF.html#ac9a11403c2238d0d1e7b65b2d100dbaf">FPr_w</a>[lev-1].FillSet(*mfs_mom[<a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daaaab25f707cae69bfadac2abcd17a2188">IntVars::zmom</a>], time, <a class="code" href="ERF__FillPatch_8cpp.html#a85a7293fad1a59ed566bcea306373abc">null_bc</a>, <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;            <a class="code" href="MomentumToVelocity_8cpp.html#ab444cbf9148a526aaf41e9d510dfedb7">MomentumToVelocity</a>(*mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>], *mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>], *mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>],</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                               *mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                               *mfs_mom[<a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daaf661293a5a71ca532c214929b98c0bad">IntVars::xmom</a>],</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                               *mfs_mom[<a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daa2e60798bc45154a8f905b1aa228a24e5">IntVars::ymom</a>],</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                               *mfs_mom[<a class="code" href="namespaceIntVars.html#afdaa1b64a98a711870ca86f30e7963daaaab25f707cae69bfadac2abcd17a2188">IntVars::zmom</a>]);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        }</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    }</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    IntVect ngvect_cons = mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>]-&gt;nGrowVect();</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    IntVect ngvect_vels = mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>]-&gt;nGrowVect();</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keywordflow">if</span> (lev == 0)</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> icomp = 0;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        Vector&lt;Real&gt; ftime    = {<a class="code" href="classERF.html#a7085d7d5fc94a0f84efc06957267d58e">t_old</a>[lev], <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev]};</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        Vector&lt;MultiFab*&gt; fmf = {&amp;<a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], &amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>]};</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span>  ncomp = mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>]-&gt;nComp();</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        FillPatchSingleLevel(*mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], time, fmf, ftime, icomp, icomp, ncomp,</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                             geom[lev], *<a class="code" href="classERF.html#a2e9b04043853d25f2d76edbc0bed2e72">physbcs_cons</a>[lev], <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+icomp);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <span class="keywordflow">if</span> (!cons_only) {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            fmf = {&amp;<a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>], &amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>]};</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> ncomp_u = 1;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            FillPatchSingleLevel(*mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>], time, fmf, ftime, icomp, icomp, ncomp_u,</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                                 geom[lev], *<a class="code" href="classERF.html#a64e55e5ae9df06433146db657eb9e72e">physbcs_u</a>[lev], <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;            fmf = {&amp;<a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>], &amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>]};</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> ncomp_v = 1;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            FillPatchSingleLevel(*mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>], time, fmf, ftime, icomp, icomp, ncomp_v,</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                                 geom[lev], *<a class="code" href="classERF.html#a79231b5cfd4576a742e46ae0082b5121">physbcs_v</a>[lev], <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a>);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;            fmf = {&amp;<a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>], &amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>]};</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> ncomp_w = 1;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            FillPatchSingleLevel(*mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>], time, fmf, ftime, icomp, icomp, ncomp_w,</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                                 geom[lev], *<a class="code" href="classERF.html#a4d717bb9fe936fd1a124d0d3e720f9d1">physbcs_w_no_terrain</a>[lev], <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa03b35ec9e83f34bb1349a86965d34e34">BCVars::zvel_bc</a>);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            (*<a class="code" href="classERF.html#a45c8ecd777f47732993777a0afb8e140">physbcs_w</a>[lev])(*mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>],*mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],*mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                               ngvect_vels,time,<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>,<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a>,<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa03b35ec9e83f34bb1349a86965d34e34">BCVars::zvel_bc</a>);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        } <span class="comment">// !cons_only</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        Vector&lt;Real&gt; ftime    = {<a class="code" href="classERF.html#a7085d7d5fc94a0f84efc06957267d58e">t_old</a>[lev], <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev]};</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        Vector&lt;Real&gt; ctime    = {<a class="code" href="classERF.html#a7085d7d5fc94a0f84efc06957267d58e">t_old</a>[lev-1], <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev-1]};</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        Vector&lt;MultiFab*&gt; fmf = {&amp;<a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev  ][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], &amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev  ][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>]};</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        Vector&lt;MultiFab*&gt; cmf = {&amp;<a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev-1][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], &amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev-1][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>]};</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        MultiFab&amp; mf_c = *mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>];</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        mapper = &amp;cell_cons_interp;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        FillPatchTwoLevels(mf_c, time, cmf, ctime, fmf, ftime,</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                           0, 0, mf_c.nComp(), geom[lev-1], geom[lev],</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                           <a class="code" href="ERF__FillPatch_8cpp.html#a85a7293fad1a59ed566bcea306373abc">null_bc</a>, <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>, <a class="code" href="ERF__FillPatch_8cpp.html#a85a7293fad1a59ed566bcea306373abc">null_bc</a>, <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>, refRatio(lev-1),</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                           mapper, <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>, <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="keywordflow">if</span> (!cons_only) {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            mapper = &amp;face_cons_linear_interp;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            MultiFab&amp; mf_u = *mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>];</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            fmf = {&amp;<a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev  ][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>], &amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev  ][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>]};</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            cmf = {&amp;<a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev-1][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>], &amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev-1][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>]};</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            FillPatchTwoLevels(mf_u, time, cmf, ctime, fmf, ftime,</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                               0, 0, 1, geom[lev-1], geom[lev],</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                               <a class="code" href="ERF__FillPatch_8cpp.html#a85a7293fad1a59ed566bcea306373abc">null_bc</a>, <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>, <a class="code" href="ERF__FillPatch_8cpp.html#a85a7293fad1a59ed566bcea306373abc">null_bc</a>, <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>, refRatio(lev-1),</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                               mapper, <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>, <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            MultiFab&amp; mf_v = *mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>];</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            fmf = {&amp;<a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev  ][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>], &amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev  ][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>]};</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            cmf = {&amp;<a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev-1][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>], &amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev-1][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>]};</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            FillPatchTwoLevels(mf_v, time, cmf, ctime, fmf, ftime,</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                               0, 0, 1, geom[lev-1], geom[lev],</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                               <a class="code" href="ERF__FillPatch_8cpp.html#a85a7293fad1a59ed566bcea306373abc">null_bc</a>, <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a>, <a class="code" href="ERF__FillPatch_8cpp.html#a85a7293fad1a59ed566bcea306373abc">null_bc</a>, <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a>, refRatio(lev-1),</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                               mapper, <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>, <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a>);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            MultiFab&amp; mf_w = *mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>];</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            fmf = {&amp;<a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev  ][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>], &amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev  ][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>]};</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            cmf = {&amp;<a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev-1][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>], &amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev-1][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>]};</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            FillPatchTwoLevels(mf_w, time, cmf, ctime, fmf, ftime,</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                               0, 0, 1, geom[lev-1], geom[lev],</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                               <a class="code" href="ERF__FillPatch_8cpp.html#a85a7293fad1a59ed566bcea306373abc">null_bc</a>, <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa03b35ec9e83f34bb1349a86965d34e34">BCVars::zvel_bc</a>, <a class="code" href="ERF__FillPatch_8cpp.html#a85a7293fad1a59ed566bcea306373abc">null_bc</a>, <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa03b35ec9e83f34bb1349a86965d34e34">BCVars::zvel_bc</a>, refRatio(lev-1),</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                               mapper, <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>, <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa03b35ec9e83f34bb1349a86965d34e34">BCVars::zvel_bc</a>);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        } <span class="comment">// !cons_only</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    } <span class="comment">// lev &gt; 0</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="comment">// Physical bc&#39;s at domain boundary</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordtype">int</span> icomp_cons = 0;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordtype">int</span> ncomp_cons = mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>]-&gt;nComp();</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="preprocessor">#ifdef ERF_USE_NETCDF</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="comment">// We call this here because it is an ERF routine</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a86208285bf705f360a3c318a75097f61">use_real_bcs</a> &amp;&amp; (lev==0)) {</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        fill_from_realbdy(mfs_vel,time,<span class="keyword">false</span>,0,ncomp_cons);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    }</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>) <a class="code" href="classERF.html#a2135641de33dea5057799569c74cac42">fill_from_bndryregs</a>(mfs_vel,time);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="comment">// We call these even if init_type == real because these will fill the vertical bcs</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    (*<a class="code" href="classERF.html#a2e9b04043853d25f2d76edbc0bed2e72">physbcs_cons</a>[lev])(*mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],icomp_cons,ncomp_cons,ngvect_cons,time,<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keywordflow">if</span> (!cons_only) {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        (*<a class="code" href="classERF.html#a64e55e5ae9df06433146db657eb9e72e">physbcs_u</a>[lev])(*mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],0,1,ngvect_vels,time,<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        (*<a class="code" href="classERF.html#a79231b5cfd4576a742e46ae0082b5121">physbcs_v</a>[lev])(*mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],0,1,ngvect_vels,time,<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a>);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        (*<a class="code" href="classERF.html#a45c8ecd777f47732993777a0afb8e140">physbcs_w</a>[lev])(*mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>],*mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],*mfs_vel[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                           ngvect_vels,time,<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>,<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a>,<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa03b35ec9e83f34bb1349a86965d34e34">BCVars::zvel_bc</a>);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    }</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a8de69f537859f576fba1d94844cfbd33_cgraph.png" border="0" usemap="#aclassERF_a8de69f537859f576fba1d94844cfbd33_cgraph" alt=""/></div>
<map name="aclassERF_a8de69f537859f576fba1d94844cfbd33_cgraph" id="aclassERF_a8de69f537859f576fba1d94844cfbd33_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,113,57"/>
<area shape="rect" href="MomentumToVelocity_8cpp.html#ab444cbf9148a526aaf41e9d510dfedb7" title=" " alt="" coords="161,5,324,32"/>
<area shape="rect" href="Utils_8H.html#a087ad6f9e01593fb0cd3624ff6caaf14" title=" " alt="" coords="161,56,324,83"/>
</map>
</div>

</div>
</div>
<a id="afb39caf6b6949138c0c3c4a067648321"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb39caf6b6949138c0c3c4a067648321">&#9670;&nbsp;</a></span>FillPatchMoistVars()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::FillPatchMoistVars </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>mf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;{</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    BL_PROFILE_VAR(<span class="stringliteral">&quot;ERF::FillPatchMoistVars()&quot;</span>,ERF_FillPatchMoistVars);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="comment">// Physical bc&#39;s at domain boundary</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordtype">int</span> icomp_cons = 0;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordtype">int</span> ncomp_cons = 1; <span class="comment">// We only fill qv, the first component</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="comment">// Note that we are filling qv, stored in qmoist[lev], with the input data (if there is any), stored</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="comment">// in RhoQ1_comp.</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classERF.html#a86208285bf705f360a3c318a75097f61">use_real_bcs</a>) {</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        Real time = Real(0.0);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        IntVect ngvect_cons = mf.nGrowVect();</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <span class="keywordtype">int</span> bccomp_cons = <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa0473174d8328f2bf7f74b84e9047e684">BCVars::RhoQ1_bc_comp</a>;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        (*<a class="code" href="classERF.html#a2e9b04043853d25f2d76edbc0bed2e72">physbcs_cons</a>[lev])(mf,icomp_cons,ncomp_cons,ngvect_cons,time,bccomp_cons);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    }</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    mf.FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;}</div>
<div class="ttc" id="anamespaceBCVars_html_a00367571247ba920989360b94c156f4aa0473174d8328f2bf7f74b84e9047e684"><div class="ttname"><a href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa0473174d8328f2bf7f74b84e9047e684">BCVars::RhoQ1_bc_comp</a></div><div class="ttdeci">@ RhoQ1_bc_comp</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:53</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4d6d990d8111c170692b1e9cc0e918b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d6d990d8111c170692b1e9cc0e918b8">&#9670;&nbsp;</a></span>getAdvFluxReg()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">AMREX_FORCE_INLINE amrex::YAFluxRegister* ERF::getAdvFluxReg </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    {</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classERF.html#a86a0bc8e41668411ee0ab5801d4688a7">advflux_reg</a>[lev];</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae0597da6edf955cd138e52fd00380ff2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0597da6edf955cd138e52fd00380ff2">&#9670;&nbsp;</a></span>getCPUTime()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static amrex::Real ERF::getCPUTime </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    {</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;      <span class="keywordtype">int</span> numCores = amrex::ParallelDescriptor::NProcs();</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;      numCores = numCores * omp_get_max_threads();</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160; </div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;      amrex::Real <a class="code" href="namespaceRealBdyVars.html#aa4743649b85ade11df23692d7c3947bda8ecd2dbb16824e5c68db7daf2254fc79">T</a> =</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;        numCores * (amrex::ParallelDescriptor::second() - <a class="code" href="classERF.html#a6d00e1cb76bfbcbada173e092b6accf3">startCPUTime</a>) +</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;        <a class="code" href="classERF.html#a1f412097e565c23acb4c17c67db10e22">previousCPUTimeUsed</a>;</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160; </div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespaceRealBdyVars.html#aa4743649b85ade11df23692d7c3947bda8ecd2dbb16824e5c68db7daf2254fc79">T</a>;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    }</div>
<div class="ttc" id="aclassERF_html_a1f412097e565c23acb4c17c67db10e22"><div class="ttname"><a href="classERF.html#a1f412097e565c23acb4c17c67db10e22">ERF::previousCPUTimeUsed</a></div><div class="ttdeci">static amrex::Real previousCPUTimeUsed</div><div class="ttdef"><b>Definition:</b> ERF.H:968</div></div>
<div class="ttc" id="aclassERF_html_a6d00e1cb76bfbcbada173e092b6accf3"><div class="ttname"><a href="classERF.html#a6d00e1cb76bfbcbada173e092b6accf3">ERF::startCPUTime</a></div><div class="ttdeci">static amrex::Real startCPUTime</div><div class="ttdef"><b>Definition:</b> ERF.H:967</div></div>
<div class="ttc" id="anamespaceRealBdyVars_html_aa4743649b85ade11df23692d7c3947bda8ecd2dbb16824e5c68db7daf2254fc79"><div class="ttname"><a href="namespaceRealBdyVars.html#aa4743649b85ade11df23692d7c3947bda8ecd2dbb16824e5c68db7daf2254fc79">RealBdyVars::T</a></div><div class="ttdeci">@ T</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:67</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aaee255b031e63bd9b5807f6612739dbd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaee255b031e63bd9b5807f6612739dbd">&#9670;&nbsp;</a></span>GotoNextLine()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::GotoNextLine </td>
          <td>(</td>
          <td class="paramtype">std::istream &amp;&#160;</td>
          <td class="paramname"><em>is</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Utility to skip to next line in Header file input stream. </p>
<div class="fragment"><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;{</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    constexpr std::streamsize bl_ignore_max { 100000 };</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    is.ignore(bl_ignore_max, <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7261c4eb7722af0dfe6cdfb8e2e9e4db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7261c4eb7722af0dfe6cdfb8e2e9e4db">&#9670;&nbsp;</a></span>init1DArrays()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::init1DArrays </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a618e8fdff3239cc79d4145d02b1ecaa2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a618e8fdff3239cc79d4145d02b1ecaa2">&#9670;&nbsp;</a></span>init_bcs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::init_bcs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Initializes data structures in the <a class="el" href="classERF.html">ERF</a> class that specify which boundary conditions we are implementing on each face of the domain.</p>
<p>This function also maps the selected boundary condition types (e.g. Outflow, Inflow, Periodic, Dirichlet, ...) to the specific implementation needed for each variable.</p>
<p>Stores this information in both host and device vectors so it is available for GPU kernels. </p>
<div class="fragment"><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;{</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="keyword">auto</span> f = [<span class="keyword">this</span>] (std::string <span class="keyword">const</span>&amp; bcid, Orientation ori)</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    {</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;        <span class="comment">// These are simply defaults for Dirichlet faces -- they should be over-written below</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;        <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa559799ff291d4e692283c4056bac8db1">BCVars::Rho_bc_comp</a>][ori]      =  1.0;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>][ori] = -1.0; <span class="comment">// It is important to set this negative</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;                                                                <span class="comment">// because the sign is tested on below</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa1556c0a3817c6fab60fbb6952cf0124f">BCVars::RhoKE_bc_comp</a>][ori]     = 0.0;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa3fd5e6f8378f1e1e80146b207c062cd8">BCVars::RhoQKE_bc_comp</a>][ori]    = 0.0;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa029ef491930290dea3a984ebdb6d6ae4">BCVars::RhoScalar_bc_comp</a>][ori] = 0.0;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa0473174d8328f2bf7f74b84e9047e684">BCVars::RhoQ1_bc_comp</a>][ori] = 0.0;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa502372fe4399d381375f39c17301030c">BCVars::RhoQ2_bc_comp</a>][ori] = 0.0;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>][ori] = 0.0; <span class="comment">// default</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a>][ori] = 0.0;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa03b35ec9e83f34bb1349a86965d34e34">BCVars::zvel_bc</a>][ori] = 0.0;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        <span class="comment">// These are simply defaults for Neumann gradients -- they should be over-written below</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        <a class="code" href="classERF.html#a69ea003766c97b1a667b002b3661f0f2">m_bc_neumann_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa559799ff291d4e692283c4056bac8db1">BCVars::Rho_bc_comp</a>][ori]      =  0.0;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        <a class="code" href="classERF.html#a69ea003766c97b1a667b002b3661f0f2">m_bc_neumann_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>][ori] =  0.0;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        <a class="code" href="classERF.html#a69ea003766c97b1a667b002b3661f0f2">m_bc_neumann_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa1556c0a3817c6fab60fbb6952cf0124f">BCVars::RhoKE_bc_comp</a>][ori]     = 0.0;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        <a class="code" href="classERF.html#a69ea003766c97b1a667b002b3661f0f2">m_bc_neumann_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa3fd5e6f8378f1e1e80146b207c062cd8">BCVars::RhoQKE_bc_comp</a>][ori]    = 0.0;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        <a class="code" href="classERF.html#a69ea003766c97b1a667b002b3661f0f2">m_bc_neumann_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa029ef491930290dea3a984ebdb6d6ae4">BCVars::RhoScalar_bc_comp</a>][ori] = 0.0;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <a class="code" href="classERF.html#a69ea003766c97b1a667b002b3661f0f2">m_bc_neumann_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa0473174d8328f2bf7f74b84e9047e684">BCVars::RhoQ1_bc_comp</a>][ori]    = 0.0;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        <a class="code" href="classERF.html#a69ea003766c97b1a667b002b3661f0f2">m_bc_neumann_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa502372fe4399d381375f39c17301030c">BCVars::RhoQ2_bc_comp</a>][ori]    = 0.0;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        <a class="code" href="classERF.html#a69ea003766c97b1a667b002b3661f0f2">m_bc_neumann_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>][ori] = 0.0;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        <a class="code" href="classERF.html#a69ea003766c97b1a667b002b3661f0f2">m_bc_neumann_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a>][ori] = 0.0;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <a class="code" href="classERF.html#a69ea003766c97b1a667b002b3661f0f2">m_bc_neumann_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa03b35ec9e83f34bb1349a86965d34e34">BCVars::zvel_bc</a>][ori] = 0.0;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        std::string pp_text;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a59df30e7a5537c8543bb00772bd98b58">pp_prefix</a> == <span class="stringliteral">&quot;erf&quot;</span>) {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;          pp_text = bcid;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;          pp_text = <a class="code" href="classERF.html#a59df30e7a5537c8543bb00772bd98b58">pp_prefix</a> + <span class="stringliteral">&quot;.&quot;</span> + bcid;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        }</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        ParmParse <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>(pp_text);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        std::string bc_type_in = <span class="stringliteral">&quot;null&quot;</span>;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;type&quot;</span>, bc_type_in);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <span class="comment">//if (pp.query(&quot;type&quot;, bc_type_in))</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <span class="comment">//   Print() &lt;&lt; &quot;INPUT BC TYPE &quot; &lt;&lt; bcid &lt;&lt; &quot; &quot; &lt;&lt; bc_type_in &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        std::string bc_type = amrex::toLower(bc_type_in);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <span class="keywordflow">if</span> (bc_type == <span class="stringliteral">&quot;symmetry&quot;</span>)</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;            <span class="comment">// Print() &lt;&lt; bcid &lt;&lt; &quot; set to symmetry.\n&quot;;</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;            <a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[ori] = <a class="code" href="IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a40e712f30d56083318ab20a2402921d2">ERF_BC::symmetry</a>;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;            <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[ori] = <span class="stringliteral">&quot;Symmetry&quot;</span>;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        }</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bc_type == <span class="stringliteral">&quot;outflow&quot;</span>)</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            <span class="comment">// Print() &lt;&lt; bcid &lt;&lt; &quot; set to outflow.\n&quot;;</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;            <a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[ori] = <a class="code" href="IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9acac0c32caf84a889ec9b2b4cb2d56972">ERF_BC::outflow</a>;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[ori] = <span class="stringliteral">&quot;Outflow&quot;</span>;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        }</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bc_type == <span class="stringliteral">&quot;inflow&quot;</span>)</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            <span class="comment">// Print() &lt;&lt; bcid &lt;&lt; &quot; set to inflow.\n&quot;;</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;            <a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[ori] = <a class="code" href="IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9ad37e67db17cfd059f2852e2673b9e8ef">ERF_BC::inflow</a>;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[ori] = <span class="stringliteral">&quot;Inflow&quot;</span>;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            std::vector&lt;Real&gt; v;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a80ad08512968ec45635df68abe66b1fc">input_bndry_planes</a> &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_velocity()) {</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>][ori] = 0.;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a>][ori] = 0.;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa03b35ec9e83f34bb1349a86965d34e34">BCVars::zvel_bc</a>][ori] = 0.;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.getarr(<span class="stringliteral">&quot;velocity&quot;</span>, v, 0, AMREX_SPACEDIM);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>][ori] = v[0];</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a>][ori] = v[1];</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa03b35ec9e83f34bb1349a86965d34e34">BCVars::zvel_bc</a>][ori] = v[2];</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            }</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            Real rho_in;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a80ad08512968ec45635df68abe66b1fc">input_bndry_planes</a> &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_density()) {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa559799ff291d4e692283c4056bac8db1">BCVars::Rho_bc_comp</a>][ori] = 0.;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.get(<span class="stringliteral">&quot;density&quot;</span>, rho_in);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa559799ff291d4e692283c4056bac8db1">BCVars::Rho_bc_comp</a>][ori] = rho_in;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;            }</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            Real theta_in;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a80ad08512968ec45635df68abe66b1fc">input_bndry_planes</a> &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_theta()) {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>][ori] = 0.;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.get(<span class="stringliteral">&quot;theta&quot;</span>, theta_in);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>][ori] = rho_in*theta_in;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            }</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            Real scalar_in = 0.;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a80ad08512968ec45635df68abe66b1fc">input_bndry_planes</a> &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_scalar()) {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa029ef491930290dea3a984ebdb6d6ae4">BCVars::RhoScalar_bc_comp</a>][ori] = 0.;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;scalar&quot;</span>, scalar_in))</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa029ef491930290dea3a984ebdb6d6ae4">BCVars::RhoScalar_bc_comp</a>][ori] = rho_in*scalar_in;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            }</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> != <a class="code" href="DataStruct_8H.html#ab34704153a585940411c26587cb82ad0a6adf97f83acf6453d4a6a4b1070f3754">MoistureType::None</a>) {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                Real qt_in = 0.;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a80ad08512968ec45635df68abe66b1fc">input_bndry_planes</a> &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_q1()) {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                    <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa0473174d8328f2bf7f74b84e9047e684">BCVars::RhoQ1_bc_comp</a>][ori] = 0.;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;qt&quot;</span>, qt_in))</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                    <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa0473174d8328f2bf7f74b84e9047e684">BCVars::RhoQ1_bc_comp</a>][ori] = rho_in*qt_in;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                Real qp_in = 0.;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a80ad08512968ec45635df68abe66b1fc">input_bndry_planes</a> &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_q2()) {</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                    <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa502372fe4399d381375f39c17301030c">BCVars::RhoQ2_bc_comp</a>][ori] = 0.;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;qp&quot;</span>, qp_in))</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                    <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa502372fe4399d381375f39c17301030c">BCVars::RhoQ2_bc_comp</a>][ori] = rho_in*qp_in;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                }</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            }</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            Real KE_in = 0.;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a80ad08512968ec45635df68abe66b1fc">input_bndry_planes</a> &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_KE()) {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa1556c0a3817c6fab60fbb6952cf0124f">BCVars::RhoKE_bc_comp</a>][ori] = 0.;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;KE&quot;</span>, KE_in))</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa1556c0a3817c6fab60fbb6952cf0124f">BCVars::RhoKE_bc_comp</a>][ori] = rho_in*KE_in;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            }</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            Real QKE_in = 0.;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a80ad08512968ec45635df68abe66b1fc">input_bndry_planes</a> &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_QKE()) {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa3fd5e6f8378f1e1e80146b207c062cd8">BCVars::RhoQKE_bc_comp</a>][ori] = 0.;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;QKE&quot;</span>, QKE_in))</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa3fd5e6f8378f1e1e80146b207c062cd8">BCVars::RhoQKE_bc_comp</a>][ori] = rho_in*QKE_in;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            }</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        }</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bc_type == <span class="stringliteral">&quot;noslipwall&quot;</span>)</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            <span class="comment">// Print() &lt;&lt; bcid &lt;&lt;&quot; set to no-slip wall.\n&quot;;</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            <a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[ori] = <a class="code" href="IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9acb8c716b8d9b499d9bc323d8f8a410d3">ERF_BC::no_slip_wall</a>;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[ori] = <span class="stringliteral">&quot;NoSlipWall&quot;</span>;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            std::vector&lt;Real&gt; v;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            <span class="comment">// The values of m_bc_extdir_vals default to 0.</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            <span class="comment">// But if we find &quot;velocity&quot; in the inputs file, use those values instead.</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.queryarr(<span class="stringliteral">&quot;velocity&quot;</span>, v, 0, AMREX_SPACEDIM))</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                v[ori.coordDir()] = 0.0;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>][ori] = v[0];</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a>][ori] = v[1];</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa03b35ec9e83f34bb1349a86965d34e34">BCVars::zvel_bc</a>][ori] = v[2];</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            }</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            Real rho_in;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;density&quot;</span>, rho_in))</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa559799ff291d4e692283c4056bac8db1">BCVars::Rho_bc_comp</a>][ori] = rho_in;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            }</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            Real theta_in;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;theta&quot;</span>, theta_in))</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            {</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;               <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>][ori] = theta_in*<a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa559799ff291d4e692283c4056bac8db1">BCVars::Rho_bc_comp</a>][ori];</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            }</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            Real theta_grad_in;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;theta_grad&quot;</span>, theta_grad_in))</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                <a class="code" href="classERF.html#a69ea003766c97b1a667b002b3661f0f2">m_bc_neumann_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>][ori] = theta_grad_in;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        }</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bc_type == <span class="stringliteral">&quot;slipwall&quot;</span>)</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        {</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            <span class="comment">// Print() &lt;&lt; bcid &lt;&lt;&quot; set to slip wall.\n&quot;;</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            <a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[ori] = <a class="code" href="IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a03ee6de9fd100444c5c0567ea01bd538">ERF_BC::slip_wall</a>;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[ori] = <span class="stringliteral">&quot;SlipWall&quot;</span>;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            Real rho_in;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;density&quot;</span>, rho_in))</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa559799ff291d4e692283c4056bac8db1">BCVars::Rho_bc_comp</a>][ori] = rho_in;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            }</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            Real theta_in;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;theta&quot;</span>, theta_in))</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;               <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>][ori] = theta_in*<a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa559799ff291d4e692283c4056bac8db1">BCVars::Rho_bc_comp</a>][ori];</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            }</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            Real rho_grad_in;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;density_grad&quot;</span>, rho_grad_in))</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            {</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;               <a class="code" href="classERF.html#a69ea003766c97b1a667b002b3661f0f2">m_bc_neumann_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa559799ff291d4e692283c4056bac8db1">BCVars::Rho_bc_comp</a>][ori] = rho_grad_in;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            }</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160; </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            Real theta_grad_in;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;theta_grad&quot;</span>, theta_grad_in))</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;               <a class="code" href="classERF.html#a69ea003766c97b1a667b002b3661f0f2">m_bc_neumann_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>][ori] = theta_grad_in;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            }</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        }</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bc_type == <span class="stringliteral">&quot;most&quot;</span>)</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            <a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[ori] = <a class="code" href="IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a882dd232c0425bb9366544f84f0a7b6c">ERF_BC::MOST</a>;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[ori] = <span class="stringliteral">&quot;MOST&quot;</span>;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        }</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        {</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            <a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[ori] = <a class="code" href="IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a5e543256c480ac577d30f76f9120eb74">ERF_BC::undefined</a>;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        }</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="keywordflow">if</span> (geom[0].isPeriodic(ori.coordDir())) {</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[ori] = <span class="stringliteral">&quot;Periodic&quot;</span>;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[ori] == <a class="code" href="IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a5e543256c480ac577d30f76f9120eb74">ERF_BC::undefined</a>)</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                <a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[ori] = <a class="code" href="IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9ae6ffdec5e14fce371eb7ae99edebbbee">ERF_BC::periodic</a>;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                Abort(<span class="stringliteral">&quot;Wrong BC type for periodic boundary&quot;</span>);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            }</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        }</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[ori] == <a class="code" href="IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a5e543256c480ac577d30f76f9120eb74">ERF_BC::undefined</a>)</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;             Print() &lt;&lt; <span class="stringliteral">&quot;BC Type specified for face &quot;</span> &lt;&lt; bcid &lt;&lt; <span class="stringliteral">&quot; is &quot;</span> &lt;&lt; bc_type_in &lt;&lt; std::endl;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;             Abort(<span class="stringliteral">&quot;This BC type is unknown&quot;</span>);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        }</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    };</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    f(<span class="stringliteral">&quot;xlo&quot;</span>, Orientation(Direction::x,Orientation::low));</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    f(<span class="stringliteral">&quot;xhi&quot;</span>, Orientation(Direction::x,Orientation::high));</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    f(<span class="stringliteral">&quot;ylo&quot;</span>, Orientation(Direction::y,Orientation::low));</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    f(<span class="stringliteral">&quot;yhi&quot;</span>, Orientation(Direction::y,Orientation::high));</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    f(<span class="stringliteral">&quot;zlo&quot;</span>, Orientation(Direction::z,Orientation::low));</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    f(<span class="stringliteral">&quot;zhi&quot;</span>, Orientation(Direction::z,Orientation::high));</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="comment">// *****************************************************************************</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="comment">// Here we translate the physical boundary conditions -- one type per face --</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="comment">//     into logical boundary conditions for each velocity component</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="comment">// *****************************************************************************</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    {</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>.resize(AMREX_SPACEDIM+<a class="code" href="IndexDefines_8H.html#a46e292b965f80d15acfbdc11ffe1e0f0">NVAR_max</a>);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        <a class="code" href="classERF.html#a8a99e22b1111c803e31b4afd5fcdea60">domain_bcs_type_d</a>.resize(AMREX_SPACEDIM+<a class="code" href="IndexDefines_8H.html#a46e292b965f80d15acfbdc11ffe1e0f0">NVAR_max</a>);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <span class="keywordflow">for</span> (OrientationIter oit; oit; ++oit) {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            Orientation ori = oit();</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            <span class="keywordtype">int</span> dir = ori.coordDir();</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            Orientation::Side side = ori.faceDir();</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            <span class="keyword">auto</span> <span class="keyword">const</span> bct = <a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[ori];</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            <span class="keywordflow">if</span> ( bct == <a class="code" href="IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a40e712f30d56083318ab20a2402921d2">ERF_BC::symmetry</a> )</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            {</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++)</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01cabc47f82507730e1734a2f3bc58893cf9">ERFBCType::reflect_even</a>);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                    <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+dir].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca41cecdb4487b15207675ae9ee564e705">ERFBCType::reflect_odd</a>);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++)</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01cabc47f82507730e1734a2f3bc58893cf9">ERFBCType::reflect_even</a>);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                    <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+dir].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca41cecdb4487b15207675ae9ee564e705">ERFBCType::reflect_odd</a>);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                }</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bct == <a class="code" href="IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9acac0c32caf84a889ec9b2b4cb2d56972">ERF_BC::outflow</a>)</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            {</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++)</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4a8d85af949a1ce567934e55c69c2846">ERFBCType::foextrap</a>);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                    <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+dir].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01caa8e7f5249fea539bf14e97cfba9074d9">ERFBCType::neumann_int</a>);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++)</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4a8d85af949a1ce567934e55c69c2846">ERFBCType::foextrap</a>);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                    <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+dir].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01caa8e7f5249fea539bf14e97cfba9074d9">ERFBCType::neumann_int</a>);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                }</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            }</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bct == <a class="code" href="IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9ad37e67db17cfd059f2852e2673b9e8ef">ERF_BC::inflow</a>)</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            {</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++) {</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af">ERFBCType::ext_dir</a>);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a80ad08512968ec45635df68abe66b1fc">input_bndry_planes</a> &amp;&amp; dir &lt; 2 &amp;&amp; m_r2d-&gt;ingested_velocity()) {</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                            <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca138e8c6c2427dcd78959f3e0e84b3462">ERFBCType::ext_dir_ingested</a>);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                        }</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                    }</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++) {</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af">ERFBCType::ext_dir</a>);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a80ad08512968ec45635df68abe66b1fc">input_bndry_planes</a> &amp;&amp; dir &lt; 2 &amp;&amp; m_r2d-&gt;ingested_velocity()) {</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                            <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca138e8c6c2427dcd78959f3e0e84b3462">ERFBCType::ext_dir_ingested</a>);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                        }</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                    }</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                }</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bct == <a class="code" href="IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9acb8c716b8d9b499d9bc323d8f8a410d3">ERF_BC::no_slip_wall</a>)</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            {</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++)</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af">ERFBCType::ext_dir</a>);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++)</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af">ERFBCType::ext_dir</a>);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                }</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            }</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bct == <a class="code" href="IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a03ee6de9fd100444c5c0567ea01bd538">ERF_BC::slip_wall</a>)</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            {</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++)</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4a8d85af949a1ce567934e55c69c2846">ERFBCType::foextrap</a>);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                    <span class="comment">// Only normal direction has ext_dir</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                    <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+dir].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af">ERFBCType::ext_dir</a>);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++)</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4a8d85af949a1ce567934e55c69c2846">ERFBCType::foextrap</a>);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                    <span class="comment">// Only normal direction has ext_dir</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                    <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+dir].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af">ERFBCType::ext_dir</a>);</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                }</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            }</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bct == <a class="code" href="IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9ae6ffdec5e14fce371eb7ae99edebbbee">ERF_BC::periodic</a>)</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            {</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++)</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca9f18284526a1054d4e7a4783852ead30">ERFBCType::int_dir</a>);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++)</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca9f18284526a1054d4e7a4783852ead30">ERFBCType::int_dir</a>);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                }</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;            }</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( bct == <a class="code" href="IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a882dd232c0425bb9366544f84f0a7b6c">ERF_BC::MOST</a> )</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            {</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                AMREX_ALWAYS_ASSERT(dir == 2 &amp;&amp; side == Orientation::low);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+0].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca41cecdb4487b15207675ae9ee564e705">ERFBCType::reflect_odd</a>);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+1].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca41cecdb4487b15207675ae9ee564e705">ERFBCType::reflect_odd</a>);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+2].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af">ERFBCType::ext_dir</a>);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;            }</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        }</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    }</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160; </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="comment">// *****************************************************************************</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="comment">// Here we translate the physical boundary conditions -- one type per face --</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="comment">//     into logical boundary conditions for each cell-centered variable</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="comment">// *****************************************************************************</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    {</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <span class="keywordflow">for</span> (OrientationIter oit; oit; ++oit) {</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;            Orientation ori = oit();</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            <span class="keywordtype">int</span> dir = ori.coordDir();</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            Orientation::Side side = ori.faceDir();</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            <span class="keyword">auto</span> <span class="keyword">const</span> bct = <a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[ori];</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            <span class="keywordflow">if</span> ( bct == <a class="code" href="IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a40e712f30d56083318ab20a2402921d2">ERF_BC::symmetry</a> )</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            {</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#a46e292b965f80d15acfbdc11ffe1e0f0">NVAR_max</a>; i++)</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01cabc47f82507730e1734a2f3bc58893cf9">ERFBCType::reflect_even</a>);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#a46e292b965f80d15acfbdc11ffe1e0f0">NVAR_max</a>; i++)</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01cabc47f82507730e1734a2f3bc58893cf9">ERFBCType::reflect_even</a>);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                }</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;            }</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( bct == <a class="code" href="IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9acac0c32caf84a889ec9b2b4cb2d56972">ERF_BC::outflow</a> )</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;            {</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#a46e292b965f80d15acfbdc11ffe1e0f0">NVAR_max</a>; i++)</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4a8d85af949a1ce567934e55c69c2846">ERFBCType::foextrap</a>);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#a46e292b965f80d15acfbdc11ffe1e0f0">NVAR_max</a>; i++)</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4a8d85af949a1ce567934e55c69c2846">ERFBCType::foextrap</a>);</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                }</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;            }</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( bct == <a class="code" href="IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9acb8c716b8d9b499d9bc323d8f8a410d3">ERF_BC::no_slip_wall</a>)</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;            {</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#a46e292b965f80d15acfbdc11ffe1e0f0">NVAR_max</a>; i++)</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4a8d85af949a1ce567934e55c69c2846">ERFBCType::foextrap</a>);</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>][ori] &gt; 0.)</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af">ERFBCType::ext_dir</a>);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                    <span class="keywordflow">if</span> (std::abs(<a class="code" href="classERF.html#a69ea003766c97b1a667b002b3661f0f2">m_bc_neumann_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>][ori]) &gt; 0.)</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca0b217c3380adcde8f3cd9b58d949db60">ERFBCType::neumann</a>);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#a46e292b965f80d15acfbdc11ffe1e0f0">NVAR_max</a>; i++)</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4a8d85af949a1ce567934e55c69c2846">ERFBCType::foextrap</a>);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>][ori] &gt; 0.)</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af">ERFBCType::ext_dir</a>);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                    <span class="keywordflow">if</span> (std::abs(<a class="code" href="classERF.html#a69ea003766c97b1a667b002b3661f0f2">m_bc_neumann_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>][ori]) &gt; 0.)</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca0b217c3380adcde8f3cd9b58d949db60">ERFBCType::neumann</a>);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                }</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            }</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bct == <a class="code" href="IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a03ee6de9fd100444c5c0567ea01bd538">ERF_BC::slip_wall</a>)</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;            {</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#a46e292b965f80d15acfbdc11ffe1e0f0">NVAR_max</a>; i++)</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4a8d85af949a1ce567934e55c69c2846">ERFBCType::foextrap</a>);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>][ori] &gt; 0.)</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af">ERFBCType::ext_dir</a>);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                    <span class="keywordflow">if</span> (std::abs(<a class="code" href="classERF.html#a69ea003766c97b1a667b002b3661f0f2">m_bc_neumann_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>][ori]) &gt; 0.)</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca0b217c3380adcde8f3cd9b58d949db60">ERFBCType::neumann</a>);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                    <span class="keywordflow">if</span> (std::abs(<a class="code" href="classERF.html#a69ea003766c97b1a667b002b3661f0f2">m_bc_neumann_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa559799ff291d4e692283c4056bac8db1">BCVars::Rho_bc_comp</a>][ori]) &gt; 0.)</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa559799ff291d4e692283c4056bac8db1">BCVars::Rho_bc_comp</a>].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca0b217c3380adcde8f3cd9b58d949db60">ERFBCType::neumann</a>);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#a46e292b965f80d15acfbdc11ffe1e0f0">NVAR_max</a>; i++)</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4a8d85af949a1ce567934e55c69c2846">ERFBCType::foextrap</a>);</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>][ori] &gt; 0.)</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af">ERFBCType::ext_dir</a>);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                    <span class="keywordflow">if</span> (std::abs(<a class="code" href="classERF.html#a69ea003766c97b1a667b002b3661f0f2">m_bc_neumann_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>][ori]) &gt; 0.)</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca0b217c3380adcde8f3cd9b58d949db60">ERFBCType::neumann</a>);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                    <span class="keywordflow">if</span> (std::abs(<a class="code" href="classERF.html#a69ea003766c97b1a667b002b3661f0f2">m_bc_neumann_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa559799ff291d4e692283c4056bac8db1">BCVars::Rho_bc_comp</a>][ori]) &gt; 0.)</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa559799ff291d4e692283c4056bac8db1">BCVars::Rho_bc_comp</a>].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca0b217c3380adcde8f3cd9b58d949db60">ERFBCType::neumann</a>);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                }</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            }</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bct == <a class="code" href="IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9ad37e67db17cfd059f2852e2673b9e8ef">ERF_BC::inflow</a>)</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;            {</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#a46e292b965f80d15acfbdc11ffe1e0f0">NVAR_max</a>; i++) {</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af">ERFBCType::ext_dir</a>);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a80ad08512968ec45635df68abe66b1fc">input_bndry_planes</a> &amp;&amp; dir &lt; 2 &amp;&amp; (</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                           ( (<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i == <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa559799ff291d4e692283c4056bac8db1">BCVars::Rho_bc_comp</a>)       &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_density()) ||</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                           ( (<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i == <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>)  &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_theta()  ) ||</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                           ( (<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i == <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa1556c0a3817c6fab60fbb6952cf0124f">BCVars::RhoKE_bc_comp</a>)     &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_KE()     ) ||</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                           ( (<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i == <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa3fd5e6f8378f1e1e80146b207c062cd8">BCVars::RhoQKE_bc_comp</a>)    &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_QKE()    ) ||</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                           ( (<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i == <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa029ef491930290dea3a984ebdb6d6ae4">BCVars::RhoScalar_bc_comp</a>) &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_scalar() ) ||</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                           ( (<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i == <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa0473174d8328f2bf7f74b84e9047e684">BCVars::RhoQ1_bc_comp</a>)     &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_q1()     ) ||</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                           ( (<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i == <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa502372fe4399d381375f39c17301030c">BCVars::RhoQ2_bc_comp</a>)     &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_q2()     )) ) {</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                            <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca138e8c6c2427dcd78959f3e0e84b3462">ERFBCType::ext_dir_ingested</a>);</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                           }</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                    }</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#a46e292b965f80d15acfbdc11ffe1e0f0">NVAR_max</a>; i++) {</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af">ERFBCType::ext_dir</a>);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a80ad08512968ec45635df68abe66b1fc">input_bndry_planes</a> &amp;&amp; dir &lt; 2 &amp;&amp; (</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                           ( (<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i == <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa559799ff291d4e692283c4056bac8db1">BCVars::Rho_bc_comp</a>)       &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_density()) ||</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                           ( (<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i == <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>)  &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_theta()  ) ||</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                           ( (<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i == <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa1556c0a3817c6fab60fbb6952cf0124f">BCVars::RhoKE_bc_comp</a>)     &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_KE()     ) ||</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                           ( (<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i == <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa3fd5e6f8378f1e1e80146b207c062cd8">BCVars::RhoQKE_bc_comp</a>)    &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_QKE()    ) ||</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                           ( (<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i == <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa029ef491930290dea3a984ebdb6d6ae4">BCVars::RhoScalar_bc_comp</a>) &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_scalar() ) ||</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                           ( (<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i == <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa0473174d8328f2bf7f74b84e9047e684">BCVars::RhoQ1_bc_comp</a>)     &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_q1()     ) ||</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                           ( (<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i == <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa502372fe4399d381375f39c17301030c">BCVars::RhoQ2_bc_comp</a>)     &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_q2()     )</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                           ) ) {</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                            <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca138e8c6c2427dcd78959f3e0e84b3462">ERFBCType::ext_dir_ingested</a>);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                           }</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                    }</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                }</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            }</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bct == <a class="code" href="IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9ae6ffdec5e14fce371eb7ae99edebbbee">ERF_BC::periodic</a>)</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;            {</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#a46e292b965f80d15acfbdc11ffe1e0f0">NVAR_max</a>; i++)</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca9f18284526a1054d4e7a4783852ead30">ERFBCType::int_dir</a>);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#a46e292b965f80d15acfbdc11ffe1e0f0">NVAR_max</a>; i++)</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                       <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca9f18284526a1054d4e7a4783852ead30">ERFBCType::int_dir</a>);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                }</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;            }</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( bct == <a class="code" href="IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a882dd232c0425bb9366544f84f0a7b6c">ERF_BC::MOST</a> )</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            {</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                AMREX_ALWAYS_ASSERT(dir == 2 &amp;&amp; side == Orientation::low);</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#a46e292b965f80d15acfbdc11ffe1e0f0">NVAR_max</a>; i++) {</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                    <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4a8d85af949a1ce567934e55c69c2846">ERFBCType::foextrap</a>);</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                }</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            }</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        }</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    }</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160; </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="preprocessor">#ifdef AMREX_USE_GPU</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    Gpu::htod_memcpy</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        (<a class="code" href="classERF.html#a8a99e22b1111c803e31b4afd5fcdea60">domain_bcs_type_d</a>.data(), <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>.data(),</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;         <span class="keyword">sizeof</span>(amrex::BCRec)*(<a class="code" href="IndexDefines_8H.html#a46e292b965f80d15acfbdc11ffe1e0f0">NVAR_max</a>+AMREX_SPACEDIM));</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    std::memcpy</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        (<a class="code" href="classERF.html#a8a99e22b1111c803e31b4afd5fcdea60">domain_bcs_type_d</a>.data(), <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>.data(),</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;         <span class="keyword">sizeof</span>(amrex::BCRec)*(<a class="code" href="IndexDefines_8H.html#a46e292b965f80d15acfbdc11ffe1e0f0">NVAR_max</a>+AMREX_SPACEDIM));</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;}</div>
<div class="ttc" id="aIndexDefines_8H_html_a46e292b965f80d15acfbdc11ffe1e0f0"><div class="ttname"><a href="IndexDefines_8H.html#a46e292b965f80d15acfbdc11ffe1e0f0">NVAR_max</a></div><div class="ttdeci">#define NVAR_max</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:27</div></div>
<div class="ttc" id="aIndexDefines_8H_html_adf340bf1893bad34b2bf452d987d86c9a03ee6de9fd100444c5c0567ea01bd538"><div class="ttname"><a href="IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a03ee6de9fd100444c5c0567ea01bd538">ERF_BC::slip_wall</a></div><div class="ttdeci">@ slip_wall</div></div>
<div class="ttc" id="aIndexDefines_8H_html_adf340bf1893bad34b2bf452d987d86c9a40e712f30d56083318ab20a2402921d2"><div class="ttname"><a href="IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a40e712f30d56083318ab20a2402921d2">ERF_BC::symmetry</a></div><div class="ttdeci">@ symmetry</div></div>
<div class="ttc" id="aIndexDefines_8H_html_adf340bf1893bad34b2bf452d987d86c9a5e543256c480ac577d30f76f9120eb74"><div class="ttname"><a href="IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a5e543256c480ac577d30f76f9120eb74">ERF_BC::undefined</a></div><div class="ttdeci">@ undefined</div></div>
<div class="ttc" id="aIndexDefines_8H_html_adf340bf1893bad34b2bf452d987d86c9acac0c32caf84a889ec9b2b4cb2d56972"><div class="ttname"><a href="IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9acac0c32caf84a889ec9b2b4cb2d56972">ERF_BC::outflow</a></div><div class="ttdeci">@ outflow</div></div>
<div class="ttc" id="aIndexDefines_8H_html_adf340bf1893bad34b2bf452d987d86c9acb8c716b8d9b499d9bc323d8f8a410d3"><div class="ttname"><a href="IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9acb8c716b8d9b499d9bc323d8f8a410d3">ERF_BC::no_slip_wall</a></div><div class="ttdeci">@ no_slip_wall</div></div>
<div class="ttc" id="aIndexDefines_8H_html_adf340bf1893bad34b2bf452d987d86c9ad37e67db17cfd059f2852e2673b9e8ef"><div class="ttname"><a href="IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9ad37e67db17cfd059f2852e2673b9e8ef">ERF_BC::inflow</a></div><div class="ttdeci">@ inflow</div></div>
<div class="ttc" id="aIndexDefines_8H_html_adf340bf1893bad34b2bf452d987d86c9ae6ffdec5e14fce371eb7ae99edebbbee"><div class="ttname"><a href="IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9ae6ffdec5e14fce371eb7ae99edebbbee">ERF_BC::periodic</a></div><div class="ttdeci">@ periodic</div></div>
<div class="ttc" id="aclassERF_html_a69ea003766c97b1a667b002b3661f0f2"><div class="ttname"><a href="classERF.html#a69ea003766c97b1a667b002b3661f0f2">ERF::m_bc_neumann_vals</a></div><div class="ttdeci">amrex::Array&lt; amrex::Array&lt; amrex::Real, AMREX_SPACEDIM *2 &gt;, AMREX_SPACEDIM+NVAR_max &gt; m_bc_neumann_vals</div><div class="ttdef"><b>Definition:</b> ERF.H:650</div></div>
<div class="ttc" id="aclassERF_html_ae5968f1bed602fa87cdd5cb7905b7e5e"><div class="ttname"><a href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">ERF::domain_bc_type</a></div><div class="ttdeci">amrex::Array&lt; std::string, 2 *AMREX_SPACEDIM &gt; domain_bc_type</div><div class="ttdef"><b>Definition:</b> ERF.H:644</div></div>
<div class="ttc" id="anamespaceBCVars_html_a00367571247ba920989360b94c156f4aa029ef491930290dea3a984ebdb6d6ae4"><div class="ttname"><a href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa029ef491930290dea3a984ebdb6d6ae4">BCVars::RhoScalar_bc_comp</a></div><div class="ttdeci">@ RhoScalar_bc_comp</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:52</div></div>
<div class="ttc" id="anamespaceBCVars_html_a00367571247ba920989360b94c156f4aa1556c0a3817c6fab60fbb6952cf0124f"><div class="ttname"><a href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa1556c0a3817c6fab60fbb6952cf0124f">BCVars::RhoKE_bc_comp</a></div><div class="ttdeci">@ RhoKE_bc_comp</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:50</div></div>
<div class="ttc" id="anamespaceBCVars_html_a00367571247ba920989360b94c156f4aa3fd5e6f8378f1e1e80146b207c062cd8"><div class="ttname"><a href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa3fd5e6f8378f1e1e80146b207c062cd8">BCVars::RhoQKE_bc_comp</a></div><div class="ttdeci">@ RhoQKE_bc_comp</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:51</div></div>
<div class="ttc" id="anamespaceBCVars_html_a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1"><div class="ttname"><a href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a></div><div class="ttdeci">@ RhoTheta_bc_comp</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:49</div></div>
<div class="ttc" id="anamespaceBCVars_html_a00367571247ba920989360b94c156f4aa502372fe4399d381375f39c17301030c"><div class="ttname"><a href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa502372fe4399d381375f39c17301030c">BCVars::RhoQ2_bc_comp</a></div><div class="ttdeci">@ RhoQ2_bc_comp</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:54</div></div>
<div class="ttc" id="anamespaceBCVars_html_a00367571247ba920989360b94c156f4aa559799ff291d4e692283c4056bac8db1"><div class="ttname"><a href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa559799ff291d4e692283c4056bac8db1">BCVars::Rho_bc_comp</a></div><div class="ttdeci">@ Rho_bc_comp</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:48</div></div>
<div class="ttc" id="anamespaceERFBCType_html_a40fbdd5a379a92debb4bcaaccac6e01ca0b217c3380adcde8f3cd9b58d949db60"><div class="ttname"><a href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca0b217c3380adcde8f3cd9b58d949db60">ERFBCType::neumann</a></div><div class="ttdeci">@ neumann</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:155</div></div>
<div class="ttc" id="anamespaceERFBCType_html_a40fbdd5a379a92debb4bcaaccac6e01ca138e8c6c2427dcd78959f3e0e84b3462"><div class="ttname"><a href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca138e8c6c2427dcd78959f3e0e84b3462">ERFBCType::ext_dir_ingested</a></div><div class="ttdeci">@ ext_dir_ingested</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:154</div></div>
<div class="ttc" id="anamespaceERFBCType_html_a40fbdd5a379a92debb4bcaaccac6e01ca41cecdb4487b15207675ae9ee564e705"><div class="ttname"><a href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca41cecdb4487b15207675ae9ee564e705">ERFBCType::reflect_odd</a></div><div class="ttdeci">@ reflect_odd</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:148</div></div>
<div class="ttc" id="anamespaceERFBCType_html_a40fbdd5a379a92debb4bcaaccac6e01ca4a8d85af949a1ce567934e55c69c2846"><div class="ttname"><a href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4a8d85af949a1ce567934e55c69c2846">ERFBCType::foextrap</a></div><div class="ttdeci">@ foextrap</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:151</div></div>
<div class="ttc" id="anamespaceERFBCType_html_a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af"><div class="ttname"><a href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af">ERFBCType::ext_dir</a></div><div class="ttdeci">@ ext_dir</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:152</div></div>
<div class="ttc" id="anamespaceERFBCType_html_a40fbdd5a379a92debb4bcaaccac6e01ca9f18284526a1054d4e7a4783852ead30"><div class="ttname"><a href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca9f18284526a1054d4e7a4783852ead30">ERFBCType::int_dir</a></div><div class="ttdeci">@ int_dir</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:149</div></div>
<div class="ttc" id="anamespaceERFBCType_html_a40fbdd5a379a92debb4bcaaccac6e01caa8e7f5249fea539bf14e97cfba9074d9"><div class="ttname"><a href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01caa8e7f5249fea539bf14e97cfba9074d9">ERFBCType::neumann_int</a></div><div class="ttdeci">@ neumann_int</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:156</div></div>
<div class="ttc" id="anamespaceERFBCType_html_a40fbdd5a379a92debb4bcaaccac6e01cabc47f82507730e1734a2f3bc58893cf9"><div class="ttname"><a href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01cabc47f82507730e1734a2f3bc58893cf9">ERFBCType::reflect_even</a></div><div class="ttdeci">@ reflect_even</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:150</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a618e8fdff3239cc79d4145d02b1ecaa2_cgraph.png" border="0" usemap="#aclassERF_a618e8fdff3239cc79d4145d02b1ecaa2_cgraph" alt=""/></div>
<map name="aclassERF_a618e8fdff3239cc79d4145d02b1ecaa2_cgraph" id="aclassERF_a618e8fdff3239cc79d4145d02b1ecaa2_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,109,32"/>
<area shape="rect" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469" title=" " alt="" coords="157,5,196,32"/>
</map>
</div>

</div>
</div>
<a id="a604939a8058f7efa36a427adb889739c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a604939a8058f7efa36a427adb889739c">&#9670;&nbsp;</a></span>init_custom()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::init_custom </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Wrapper for custom problem-specific initialization routines that can be defined by the user as they set up a new problem in <a class="el" href="classERF.html">ERF</a>. This wrapper handles all the overhead of defining the perturbation as well as initializing the random seed if needed.</p>
<p>This wrapper calls a user function to customize initialization on a per-Fab level inside an MFIter loop, so all the MultiFab operations are hidden from the user.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lev</td><td>Integer specifying the current level </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;{</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keyword">auto</span>&amp; lev_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev];</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    MultiFab r_hse(<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev], make_alias, 0, 1); <span class="comment">// r_0 is first  component</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    MultiFab p_hse(<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev], make_alias, 1, 1); <span class="comment">// p_0 is second component</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    MultiFab cons_pert(lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].boxArray(), lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].DistributionMap(),</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;                       lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nComp()   , lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nGrow());</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    MultiFab xvel_pert(lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].boxArray(), lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].DistributionMap(), 1, lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].nGrowVect());</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    MultiFab yvel_pert(lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].boxArray(), lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].DistributionMap(), 1, lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].nGrowVect());</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    MultiFab zvel_pert(lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].boxArray(), lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].DistributionMap(), 1, lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].nGrowVect());</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="comment">// Default all perturbations to zero</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    cons_pert.setVal(0.);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    xvel_pert.setVal(0.);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    yvel_pert.setVal(0.);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    zvel_pert.setVal(0.);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keywordtype">int</span> fix_random_seed = 0;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    ParmParse <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>(<span class="stringliteral">&quot;erf&quot;</span>); <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;fix_random_seed&quot;</span>, fix_random_seed);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="comment">// Note that the value of 1024UL is not significant -- the point here is just to set the</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="comment">//     same seed for all MPI processes for the purpose of regression testing</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keywordflow">if</span> (fix_random_seed) {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        Print() &lt;&lt; <span class="stringliteral">&quot;Fixing the random seed&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        InitRandom(1024UL);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    }</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#pragma omp parallel if (amrex::Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordflow">for</span> (MFIter mfi(lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], <a class="code" href="TileNoZ_8H.html#a8da113f1d5603f7297fe1d03e5013f00">TileNoZ</a>()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <span class="keyword">const</span> Box &amp;bx  = mfi.tilebox();</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <span class="keyword">const</span> Box &amp;xbx = mfi.tilebox(IntVect(1,0,0));</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <span class="keyword">const</span> Box &amp;ybx = mfi.tilebox(IntVect(0,1,0));</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <span class="keyword">const</span> Box &amp;zbx = mfi.tilebox(IntVect(0,0,1));</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> &amp;cons_pert_arr = cons_pert.array(mfi);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> &amp;xvel_pert_arr = xvel_pert.array(mfi);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> &amp;yvel_pert_arr = yvel_pert.array(mfi);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> &amp;zvel_pert_arr = zvel_pert.array(mfi);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        Array4&lt;Real const&gt; cons_arr = lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].const_array(mfi);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        Array4&lt;Real const&gt; z_nd_arr = (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a063a88594452100497651e8aaf1f68d7">use_terrain</a>) ? <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev]-&gt;const_array(mfi) : Array4&lt;Real const&gt;{};</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        Array4&lt;Real const&gt; z_cc_arr = (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a063a88594452100497651e8aaf1f68d7">use_terrain</a>) ? <a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[lev]-&gt;const_array(mfi) : Array4&lt;Real const&gt;{};</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        Array4&lt;Real const&gt; mf_m     = <a class="code" href="classERF.html#a23aacdb72e9d2dfed8e2ebd2c2526497">mapfac_m</a>[lev]-&gt;array(mfi);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        Array4&lt;Real const&gt; mf_u     = <a class="code" href="classERF.html#a23aacdb72e9d2dfed8e2ebd2c2526497">mapfac_m</a>[lev]-&gt;array(mfi);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        Array4&lt;Real const&gt; mf_v     = <a class="code" href="classERF.html#a23aacdb72e9d2dfed8e2ebd2c2526497">mapfac_m</a>[lev]-&gt;array(mfi);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        Array4&lt;Real&gt; r_hse_arr = r_hse.array(mfi);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        Array4&lt;Real&gt; p_hse_arr = p_hse.array(mfi);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <a class="code" href="classERF.html#a60e8cb933f237903e3fbcd6376c26db0">prob</a>-&gt;init_custom_pert(bx, xbx, ybx, zbx, cons_arr, cons_pert_arr,</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                               xvel_pert_arr, yvel_pert_arr, zvel_pert_arr,</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                               r_hse_arr, p_hse_arr, z_nd_arr, z_cc_arr,</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                               geom[lev].data(), mf_m, mf_u, mf_v,</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                               <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    } <span class="comment">//mfi</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="comment">// Add problem-specific perturbation to background flow</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    MultiFab::Add(lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], cons_pert, <a class="code" href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>,      <a class="code" href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>,      1, cons_pert.nGrow());</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    MultiFab::Add(lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], cons_pert, <a class="code" href="IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>, <a class="code" href="IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>, 1, cons_pert.nGrow());</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    MultiFab::Add(lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], cons_pert, <a class="code" href="IndexDefines_8H.html#a0296f21cd48e5d8236c62ae4ce319b2f">RhoScalar_comp</a>,<a class="code" href="IndexDefines_8H.html#a0296f21cd48e5d8236c62ae4ce319b2f">RhoScalar_comp</a>,1, cons_pert.nGrow());</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="comment">// RhoKE is only relevant if using Deardorff with LES</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa53b017d79e0067923180a0aa59367b4">turbChoice</a>[lev].les_type == <a class="code" href="TurbStruct_8H.html#aa346fa9f5c0cb101a7766563fb76c500ab7106655ebb5e00e0f040302bf4129bf">LESType::Deardorff</a>) {</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        MultiFab::Add(lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], cons_pert, <a class="code" href="IndexDefines_8H.html#ae15721db2cb4c2ab4732afe226bbba64">RhoKE_comp</a>,    <a class="code" href="IndexDefines_8H.html#ae15721db2cb4c2ab4732afe226bbba64">RhoKE_comp</a>,    1, cons_pert.nGrow());</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    }</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="comment">// RhoQKE is only relevant if using MYNN2.5 or YSU</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa53b017d79e0067923180a0aa59367b4">turbChoice</a>[lev].pbl_type == <a class="code" href="TurbStruct_8H.html#a4a079f2650ca30c787a8375ec5f17ca5a6adf97f83acf6453d4a6a4b1070f3754">PBLType::None</a>) {</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].setVal(0.0,<a class="code" href="IndexDefines_8H.html#ac190f1f4846f6e6e31628041150f3d93">RhoQKE_comp</a>,1);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        MultiFab::Add(lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], cons_pert, <a class="code" href="IndexDefines_8H.html#ac190f1f4846f6e6e31628041150f3d93">RhoQKE_comp</a>,   <a class="code" href="IndexDefines_8H.html#ac190f1f4846f6e6e31628041150f3d93">RhoQKE_comp</a>,   1, cons_pert.nGrow());</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    }</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> != <a class="code" href="DataStruct_8H.html#ab34704153a585940411c26587cb82ad0a6adf97f83acf6453d4a6a4b1070f3754">MoistureType::None</a>) {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="keywordtype">int</span> qstate_size = <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;Get_Qstate_Size();</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        MultiFab::Add(lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], cons_pert, <a class="code" href="IndexDefines_8H.html#aa965e9988f14d5d2a5aef4a942168a15">RhoQ1_comp</a>,    <a class="code" href="IndexDefines_8H.html#aa965e9988f14d5d2a5aef4a942168a15">RhoQ1_comp</a>,    1, cons_pert.nGrow());</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        MultiFab::Add(lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], cons_pert, <a class="code" href="IndexDefines_8H.html#a3bf0a4783e82ba30db2b7c0a332c2f16">RhoQ2_comp</a>,    <a class="code" href="IndexDefines_8H.html#a3bf0a4783e82ba30db2b7c0a332c2f16">RhoQ2_comp</a>,    1, cons_pert.nGrow());</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> q_offset(2); q_offset&lt;qstate_size; ++q_offset) {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            <span class="keywordtype">int</span> q_idx = <a class="code" href="IndexDefines_8H.html#aa965e9988f14d5d2a5aef4a942168a15">RhoQ1_comp</a>+q_offset;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            MultiFab::Add(lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], cons_pert, q_idx, q_idx, 1, cons_pert.nGrow());</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        }</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    }</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    MultiFab::Add(lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>], xvel_pert, 0,             0,             1, xvel_pert.nGrowVect());</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    MultiFab::Add(lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>], yvel_pert, 0,             0,             1, yvel_pert.nGrowVect());</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    MultiFab::Add(lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>], zvel_pert, 0,             0,             1, zvel_pert.nGrowVect());</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;}</div>
<div class="ttc" id="aIndexDefines_8H_html_a0296f21cd48e5d8236c62ae4ce319b2f"><div class="ttname"><a href="IndexDefines_8H.html#a0296f21cd48e5d8236c62ae4ce319b2f">RhoScalar_comp</a></div><div class="ttdeci">#define RhoScalar_comp</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:16</div></div>
<div class="ttc" id="aIndexDefines_8H_html_a3bf0a4783e82ba30db2b7c0a332c2f16"><div class="ttname"><a href="IndexDefines_8H.html#a3bf0a4783e82ba30db2b7c0a332c2f16">RhoQ2_comp</a></div><div class="ttdeci">#define RhoQ2_comp</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:18</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a604939a8058f7efa36a427adb889739c_cgraph.png" border="0" usemap="#aclassERF_a604939a8058f7efa36a427adb889739c_cgraph" alt=""/></div>
<map name="aclassERF_a604939a8058f7efa36a427adb889739c_cgraph" id="aclassERF_a604939a8058f7efa36a427adb889739c_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,136,57"/>
<area shape="rect" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469" title=" " alt="" coords="201,5,240,32"/>
<area shape="rect" href="TileNoZ_8H.html#a8da113f1d5603f7297fe1d03e5013f00" title=" " alt="" coords="184,56,257,83"/>
</map>
</div>

</div>
</div>
<a id="a857a8f76768ec4451b995cbf4f4ac176"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a857a8f76768ec4451b995cbf4f4ac176">&#9670;&nbsp;</a></span>init_from_hse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::init_from_hse </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialize the background flow to have the calculated HSE density and rho*theta calculated from the HSE pressure. In general, the hydrostatically balanced density and pressure (r_hse and p_hse from base_state) used here may be calculated through a solver path such as:</p>
<p>ERF::initHSE(lev)</p><ul>
<li>call prob-&gt;erf_init_dens_hse(...)<ul>
<li>call Problem::init_isentropic_hse(...), to simultaneously calculate r_hse and p_hse with Newton iteration &ndash; assuming constant theta</li>
<li>save r_hse</li>
</ul>
</li>
<li>call ERF::enforce_hse(...), calculates p_hse from saved r_hse (redundant, but needed because p_hse is not necessarily calculated by the Problem implementation) and pi_hse &ndash; note: this pressure does not exactly match the p_hse from before because what is calculated by init_isentropic_hse comes from the EOS whereas what is calculated here comes from the hydro- static equation</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lev</td><td>Integer specifying the current level </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;{</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keyword">auto</span>&amp; lev_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev];</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    MultiFab r_hse(<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev], make_alias, 0, 1); <span class="comment">// r_0 is first  component</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    MultiFab p_hse(<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev], make_alias, 1, 1); <span class="comment">// p_0 is second component</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#pragma omp parallel if (amrex::Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keywordflow">for</span> (MFIter mfi(lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], <a class="code" href="TileNoZ_8H.html#a8da113f1d5603f7297fe1d03e5013f00">TileNoZ</a>()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    {</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        <span class="keyword">const</span> Box &amp;gbx = mfi.growntilebox(1);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        <span class="keyword">const</span> Array4&lt;Real      &gt;&amp; cons_arr  = lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].array(mfi);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; r_hse_arr = r_hse.const_array(mfi);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; p_hse_arr = p_hse.const_array(mfi);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        ParallelFor(gbx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;            cons_arr(i,j,k,<a class="code" href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>)      = r_hse_arr(i,j,k);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;            cons_arr(i,j,k,<a class="code" href="IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>) = <a class="code" href="EOS_8H.html#a3cc0ee7727b26e21a97acfc2ad2e6d4d">getRhoThetagivenP</a>(p_hse_arr(i,j,k));</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        });</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    } <span class="comment">//mfi</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;}</div>
<div class="ttc" id="aEOS_8H_html_a3cc0ee7727b26e21a97acfc2ad2e6d4d"><div class="ttname"><a href="EOS_8H.html#a3cc0ee7727b26e21a97acfc2ad2e6d4d">getRhoThetagivenP</a></div><div class="ttdeci">AMREX_GPU_HOST_DEVICE AMREX_FORCE_INLINE amrex::Real getRhoThetagivenP(const amrex::Real p, const amrex::Real qv=0.0)</div><div class="ttdef"><b>Definition:</b> EOS.H:130</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a857a8f76768ec4451b995cbf4f4ac176_cgraph.png" border="0" usemap="#aclassERF_a857a8f76768ec4451b995cbf4f4ac176_cgraph" alt=""/></div>
<map name="aclassERF_a857a8f76768ec4451b995cbf4f4ac176_cgraph" id="aclassERF_a857a8f76768ec4451b995cbf4f4ac176_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,148,57"/>
<area shape="rect" href="EOS_8H.html#a3cc0ee7727b26e21a97acfc2ad2e6d4d" title=" " alt="" coords="196,5,345,32"/>
<area shape="rect" href="TileNoZ_8H.html#a8da113f1d5603f7297fe1d03e5013f00" title=" " alt="" coords="234,56,307,83"/>
</map>
</div>

</div>
</div>
<a id="a2908bcd920ab5e3fef171a37302853ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2908bcd920ab5e3fef171a37302853ec">&#9670;&nbsp;</a></span>init_from_input_sounding()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::init_from_input_sounding </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>High level wrapper for initializing scalar and velocity level data from input sounding data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lev</td><td>Integer specifying the current level </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;{</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="comment">// We only want to read the file once -- here we fill one FArrayBox (per variable) that spans the domain</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordflow">if</span> (lev == 0) {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a536424e14c4139e4683b15c59e742362">input_sounding_file</a>.empty())</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;            Error(<span class="stringliteral">&quot;input_sounding file name must be provided via input&quot;</span>);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <span class="comment">// this will interpolate the input profiles to the nominal height levels</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <span class="comment">// (ranging from 0 to the domain top)</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <a class="code" href="classERF.html#a83572d8dfad51158945b4a5ab06b2f72">input_sounding_data</a>.<a class="code" href="structInputSoundingData.html#a596a65687875bb0172f0621f446452ae">read_from_file</a>(<a class="code" href="classERF.html#a536424e14c4139e4683b15c59e742362">input_sounding_file</a>, geom[lev], <a class="code" href="classERF.html#a7a4d6e7887fa8f30c33a0b8899035ddb">zlevels_stag</a>);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <span class="comment">// this will calculate the hydrostatically balanced density and pressure</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <span class="comment">// profiles following WRF ideal.exe</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a2eb81c590271b429f132103c9af25830">init_sounding_ideal</a>) <a class="code" href="classERF.html#a83572d8dfad51158945b4a5ab06b2f72">input_sounding_data</a>.<a class="code" href="structInputSoundingData.html#af913103d9ecab49f09b2b107832d265f">calc_rho_p</a>();</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    }</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keyword">auto</span>&amp; lev_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev];</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="comment">// update if init_sounding_ideal == true</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    MultiFab r_hse (<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev], make_alias, 0, 1); <span class="comment">// r_0  is first  component</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    MultiFab p_hse (<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev], make_alias, 1, 1); <span class="comment">// p_0  is second component</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    MultiFab pi_hse(<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev], make_alias, 2, 1); <span class="comment">// pi_0 is third  component</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keyword">const</span> Real l_gravity = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a47a54f2e44955202b5b437e4b1b4a61b">gravity</a>;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keyword">const</span> Real l_rdOcp   = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a2e1ef762ee1dc1bd3d4cbd08125c758a">rdOcp</a>;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> l_moist   = (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> != <a class="code" href="DataStruct_8H.html#ab34704153a585940411c26587cb82ad0a6adf97f83acf6453d4a6a4b1070f3754">MoistureType::None</a>);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="preprocessor">#pragma omp parallel if (Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keywordflow">for</span> (MFIter mfi(lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], TilingIfNotGPU()); mfi.isValid(); ++mfi) {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <span class="keyword">const</span> Box &amp;bx = mfi.tilebox();</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> &amp;cons_arr = lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].array(mfi);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> &amp;xvel_arr = lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].array(mfi);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> &amp;yvel_arr = lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].array(mfi);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> &amp;zvel_arr = lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].array(mfi);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        Array4&lt;Real&gt; r_hse_arr = r_hse.array(mfi);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        Array4&lt;Real&gt; p_hse_arr = p_hse.array(mfi);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        Array4&lt;Real&gt; pi_hse_arr = pi_hse.array(mfi);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        Array4&lt;Real const&gt; z_cc_arr = (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a063a88594452100497651e8aaf1f68d7">use_terrain</a>) ? <a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[lev]-&gt;const_array(mfi) : Array4&lt;Real const&gt;{};</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        Array4&lt;Real const&gt; z_nd_arr = (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a063a88594452100497651e8aaf1f68d7">use_terrain</a>) ? <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev]-&gt;const_array(mfi) : Array4&lt;Real const&gt;{};</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a2eb81c590271b429f132103c9af25830">init_sounding_ideal</a>)</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            <span class="comment">// HSE will be initialized here, interpolated from values previously</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            <span class="comment">// calculated by calc_rho_p()</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            <a class="code" href="ERF__init__from__input__sounding_8cpp.html#af361420f8bc21f523a05894f83c85604">init_bx_scalars_from_input_sounding_hse</a>(</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                bx, cons_arr,</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                r_hse_arr, p_hse_arr, pi_hse_arr,</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                geom[lev].data(), z_cc_arr,</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                l_gravity, l_rdOcp, l_moist, <a class="code" href="classERF.html#a83572d8dfad51158945b4a5ab06b2f72">input_sounding_data</a>);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        }</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            <span class="comment">// HSE will be calculated later with call to initHSE</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            <a class="code" href="ERF__init__from__input__sounding_8cpp.html#a3591f1ded54f05cbacb8d1ad6246572e">init_bx_scalars_from_input_sounding</a>(</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                bx, cons_arr,</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                geom[lev].data(), z_cc_arr,</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                l_moist, <a class="code" href="classERF.html#a83572d8dfad51158945b4a5ab06b2f72">input_sounding_data</a>);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <a class="code" href="ERF__init__from__input__sounding_8cpp.html#a3e2549542024fc00744ba8077f71f1fb">init_bx_velocities_from_input_sounding</a>(</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            bx, xvel_arr, yvel_arr, zvel_arr,</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            geom[lev].data(), z_nd_arr,</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            <a class="code" href="classERF.html#a83572d8dfad51158945b4a5ab06b2f72">input_sounding_data</a>);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    } <span class="comment">//mfi</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;}</div>
<div class="ttc" id="aERF__init__from__input__sounding_8cpp_html_a3591f1ded54f05cbacb8d1ad6246572e"><div class="ttname"><a href="ERF__init__from__input__sounding_8cpp.html#a3591f1ded54f05cbacb8d1ad6246572e">init_bx_scalars_from_input_sounding</a></div><div class="ttdeci">void init_bx_scalars_from_input_sounding(const Box &amp;bx, Array4&lt; Real &gt; const &amp;state, GeometryData const &amp;geomdata, Array4&lt; const Real &gt; const &amp;z_cc_arr, const bool &amp;l_moist, InputSoundingData const &amp;inputSoundingData)</div><div class="ttdef"><b>Definition:</b> ERF_init_from_input_sounding.cpp:129</div></div>
<div class="ttc" id="aERF__init__from__input__sounding_8cpp_html_a3e2549542024fc00744ba8077f71f1fb"><div class="ttname"><a href="ERF__init__from__input__sounding_8cpp.html#a3e2549542024fc00744ba8077f71f1fb">init_bx_velocities_from_input_sounding</a></div><div class="ttdeci">void init_bx_velocities_from_input_sounding(const Box &amp;bx, Array4&lt; Real &gt; const &amp;x_vel, Array4&lt; Real &gt; const &amp;y_vel, Array4&lt; Real &gt; const &amp;z_vel, GeometryData const &amp;geomdata, Array4&lt; const Real &gt; const &amp;z_nd_arr, InputSoundingData const &amp;inputSoundingData)</div><div class="ttdef"><b>Definition:</b> ERF_init_from_input_sounding.cpp:276</div></div>
<div class="ttc" id="aERF__init__from__input__sounding_8cpp_html_af361420f8bc21f523a05894f83c85604"><div class="ttname"><a href="ERF__init__from__input__sounding_8cpp.html#af361420f8bc21f523a05894f83c85604">init_bx_scalars_from_input_sounding_hse</a></div><div class="ttdeci">void init_bx_scalars_from_input_sounding_hse(const Box &amp;bx, Array4&lt; Real &gt; const &amp;state, Array4&lt; Real &gt; const &amp;r_hse_arr, Array4&lt; Real &gt; const &amp;p_hse_arr, Array4&lt; Real &gt; const &amp;pi_hse_arr, GeometryData const &amp;geomdata, Array4&lt; const Real &gt; const &amp;z_cc_arr, const Real &amp;l_gravity, const Real &amp;l_rdOcp, const bool &amp;l_moist, InputSoundingData const &amp;inputSoundingData)</div><div class="ttdef"><b>Definition:</b> ERF_init_from_input_sounding.cpp:188</div></div>
<div class="ttc" id="aclassERF_html_a2eb81c590271b429f132103c9af25830"><div class="ttname"><a href="classERF.html#a2eb81c590271b429f132103c9af25830">ERF::init_sounding_ideal</a></div><div class="ttdeci">static bool init_sounding_ideal</div><div class="ttdef"><b>Definition:</b> ERF.H:785</div></div>
<div class="ttc" id="aclassERF_html_a536424e14c4139e4683b15c59e742362"><div class="ttname"><a href="classERF.html#a536424e14c4139e4683b15c59e742362">ERF::input_sounding_file</a></div><div class="ttdeci">static std::string input_sounding_file</div><div class="ttdef"><b>Definition:</b> ERF.H:781</div></div>
<div class="ttc" id="aclassERF_html_a83572d8dfad51158945b4a5ab06b2f72"><div class="ttname"><a href="classERF.html#a83572d8dfad51158945b4a5ab06b2f72">ERF::input_sounding_data</a></div><div class="ttdeci">InputSoundingData input_sounding_data</div><div class="ttdef"><b>Definition:</b> ERF.H:501</div></div>
<div class="ttc" id="astructInputSoundingData_html_a596a65687875bb0172f0621f446452ae"><div class="ttname"><a href="structInputSoundingData.html#a596a65687875bb0172f0621f446452ae">InputSoundingData::read_from_file</a></div><div class="ttdeci">void read_from_file(const std::string input_sounding_file, const amrex::Geometry &amp;geom, const amrex::Vector&lt; amrex::Real &gt; &amp;zlevels_stag)</div><div class="ttdef"><b>Definition:</b> InputSoundingData.H:24</div></div>
<div class="ttc" id="astructInputSoundingData_html_af913103d9ecab49f09b2b107832d265f"><div class="ttname"><a href="structInputSoundingData.html#af913103d9ecab49f09b2b107832d265f">InputSoundingData::calc_rho_p</a></div><div class="ttdeci">void calc_rho_p()</div><div class="ttdef"><b>Definition:</b> InputSoundingData.H:123</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a2908bcd920ab5e3fef171a37302853ec_cgraph.png" border="0" usemap="#aclassERF_a2908bcd920ab5e3fef171a37302853ec_cgraph" alt=""/></div>
<map name="aclassERF_a2908bcd920ab5e3fef171a37302853ec_cgraph" id="aclassERF_a2908bcd920ab5e3fef171a37302853ec_cgraph">
<area shape="rect" title=" " alt="" coords="5,71,159,112"/>
<area shape="rect" href="ERF__init__from__input__sounding_8cpp.html#a3591f1ded54f05cbacb8d1ad6246572e" title=" " alt="" coords="211,71,369,112"/>
<area shape="rect" href="ERF__init__from__input__sounding_8cpp.html#af361420f8bc21f523a05894f83c85604" title=" " alt="" coords="211,136,369,177"/>
<area shape="rect" href="ERF__init__from__input__sounding_8cpp.html#a3e2549542024fc00744ba8077f71f1fb" title=" " alt="" coords="207,5,373,47"/>
<area shape="rect" href="Interpolation__1D_8H.html#a803d0d35d4ca4791556cbe02bbf51cbb" title=" " alt="" coords="453,78,569,105"/>
<area shape="rect" href="structInputSoundingData.html#af2e8c00eb0bd0d64abf35528b33b3240" title=" " alt="" coords="421,27,601,54"/>
<area shape="rect" href="EOS_8H.html#ab415ab4061cbbea05723267a0bf82c6b" title=" " alt="" coords="449,129,573,155"/>
<area shape="rect" href="EOS_8H.html#a24b76fd72f051dc593840f006d79fd1a" title=" " alt="" coords="441,179,581,206"/>
<area shape="rect" href="EOS_8H.html#a08354ab110fb9e873bce9250b4f4b46e" title=" " alt="" coords="456,230,567,257"/>
</map>
</div>

</div>
</div>
<a id="a80981e20939a6a38ba17478da2253ff1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80981e20939a6a38ba17478da2253ff1">&#9670;&nbsp;</a></span>init_only()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::init_only </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;{</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev] = time;</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    <a class="code" href="classERF.html#a7085d7d5fc94a0f84efc06957267d58e">t_old</a>[lev] = time - 1.e200;</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160; </div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    <span class="keyword">auto</span>&amp; lev_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev];</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    <span class="keyword">auto</span>&amp; lev_old = <a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev];</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160; </div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    <span class="comment">// Loop over grids at this level to initialize our grid data</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].setVal(0.0); lev_old[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].setVal(0.0);</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].setVal(0.0); lev_old[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].setVal(0.0);</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].setVal(0.0); lev_old[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].setVal(0.0);</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].setVal(0.0); lev_old[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].setVal(0.0);</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160; </div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    <span class="comment">// Initialize background flow (optional)</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#af5ac3d88a33a1a284bcc120ce0599cf7">init_type</a> == <span class="stringliteral">&quot;input_sounding&quot;</span>) {</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;        <span class="comment">// The base state is initialized by integrating vertically through the</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;        <span class="comment">// input sounding, if the init_sounding_ideal flag is set; otherwise</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        <span class="comment">// it is set by initHSE()</span></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;        <a class="code" href="classERF.html#a2908bcd920ab5e3fef171a37302853ec">init_from_input_sounding</a>(lev);</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a2eb81c590271b429f132103c9af25830">init_sounding_ideal</a>) {</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;            AMREX_ALWAYS_ASSERT_WITH_MESSAGE(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a3ab48411073a3c1f75435292d7b407e5">use_gravity</a>,</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;                <span class="stringliteral">&quot;Gravity should be on to be consistent with sounding initialization.&quot;</span>);</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;            <a class="code" href="classERF.html#a92c020bfaa43e40fb5ffc449427a0318">initHSE</a>();</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;        }</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160; </div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;<span class="preprocessor">#ifdef ERF_USE_NETCDF</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classERF.html#af5ac3d88a33a1a284bcc120ce0599cf7">init_type</a> == <span class="stringliteral">&quot;ideal&quot;</span> || <a class="code" href="classERF.html#af5ac3d88a33a1a284bcc120ce0599cf7">init_type</a> == <span class="stringliteral">&quot;real&quot;</span>) {</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;        <span class="comment">// The base state is initialized from WRF wrfinput data, output by</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;        <span class="comment">// ideal.exe or real.exe</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;        init_from_wrfinput(lev);</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#af5ac3d88a33a1a284bcc120ce0599cf7">init_type</a> == <span class="stringliteral">&quot;ideal&quot;</span>) <a class="code" href="classERF.html#a92c020bfaa43e40fb5ffc449427a0318">initHSE</a>();</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160; </div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classERF.html#af5ac3d88a33a1a284bcc120ce0599cf7">init_type</a> == <span class="stringliteral">&quot;metgrid&quot;</span>) {</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;        <span class="comment">// The base state is initialized from data output by WPS metgrid;</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;        <span class="comment">// we will rebalance after interpolation</span></div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;        init_from_metgrid(lev);</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classERF.html#af5ac3d88a33a1a284bcc120ce0599cf7">init_type</a> == <span class="stringliteral">&quot;uniform&quot;</span>) {</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;        <span class="comment">// Initialize a uniform background field and base state based on the</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;        <span class="comment">// problem-specified reference density and temperature</span></div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;        <a class="code" href="classERF.html#ae618963cf90e247b72fbd71d5b13599d">init_uniform</a>(lev);</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;        <a class="code" href="classERF.html#a92c020bfaa43e40fb5ffc449427a0318">initHSE</a>(lev);</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;        <span class="comment">// No background flow initialization specified, initialize the</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;        <span class="comment">// background field to be equal to the base state, calculated from the</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;        <span class="comment">// problem-specific erf_init_dens_hse</span></div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;        <a class="code" href="classERF.html#a92c020bfaa43e40fb5ffc449427a0318">initHSE</a>(lev); <span class="comment">// need to call this first</span></div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;        <a class="code" href="classERF.html#a857a8f76768ec4451b995cbf4f4ac176">init_from_hse</a>(lev);</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    }</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160; </div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    <span class="comment">// Add problem-specific flow features</span></div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    <span class="comment">// Notes:</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    <span class="comment">// - This calls init_custom_pert that is defined for each problem</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    <span class="comment">// - This may modify the base state</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    <span class="comment">// - The fields set by init_custom_pert are **perturbations** to the</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    <span class="comment">//   background flow set based on init_type</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;    <a class="code" href="classERF.html#a604939a8058f7efa36a427adb889739c">init_custom</a>(lev);</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160; </div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    <span class="comment">// Ensure that the face-based data are the same on both sides of a periodic domain.</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    <span class="comment">// The data associated with the lower grid ID is considered the correct value.</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].OverrideSync(geom[lev].periodicity());</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].OverrideSync(geom[lev].periodicity());</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].OverrideSync(geom[lev].periodicity());</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_a2908bcd920ab5e3fef171a37302853ec"><div class="ttname"><a href="classERF.html#a2908bcd920ab5e3fef171a37302853ec">ERF::init_from_input_sounding</a></div><div class="ttdeci">void init_from_input_sounding(int lev)</div><div class="ttdef"><b>Definition:</b> ERF_init_from_input_sounding.cpp:49</div></div>
<div class="ttc" id="aclassERF_html_a604939a8058f7efa36a427adb889739c"><div class="ttname"><a href="classERF.html#a604939a8058f7efa36a427adb889739c">ERF::init_custom</a></div><div class="ttdeci">void init_custom(int lev)</div><div class="ttdef"><b>Definition:</b> ERF_init_custom.cpp:26</div></div>
<div class="ttc" id="aclassERF_html_a857a8f76768ec4451b995cbf4f4ac176"><div class="ttname"><a href="classERF.html#a857a8f76768ec4451b995cbf4f4ac176">ERF::init_from_hse</a></div><div class="ttdeci">void init_from_hse(int lev)</div><div class="ttdef"><b>Definition:</b> ERF_init_from_hse.cpp:34</div></div>
<div class="ttc" id="aclassERF_html_a92c020bfaa43e40fb5ffc449427a0318"><div class="ttname"><a href="classERF.html#a92c020bfaa43e40fb5ffc449427a0318">ERF::initHSE</a></div><div class="ttdeci">void initHSE()</div><div class="ttdoc">Initialize HSE.</div><div class="ttdef"><b>Definition:</b> ERF_init1d.cpp:146</div></div>
<div class="ttc" id="aclassERF_html_ae618963cf90e247b72fbd71d5b13599d"><div class="ttname"><a href="classERF.html#ae618963cf90e247b72fbd71d5b13599d">ERF::init_uniform</a></div><div class="ttdeci">void init_uniform(int lev)</div><div class="ttdef"><b>Definition:</b> ERF_init_uniform.cpp:17</div></div>
<div class="ttc" id="aclassERF_html_af5ac3d88a33a1a284bcc120ce0599cf7"><div class="ttname"><a href="classERF.html#af5ac3d88a33a1a284bcc120ce0599cf7">ERF::init_type</a></div><div class="ttdeci">static std::string init_type</div><div class="ttdef"><b>Definition:</b> ERF.H:766</div></div>
<div class="ttc" id="astructSolverChoice_html_a3ab48411073a3c1f75435292d7b407e5"><div class="ttname"><a href="structSolverChoice.html#a3ab48411073a3c1f75435292d7b407e5">SolverChoice::use_gravity</a></div><div class="ttdeci">bool use_gravity</div><div class="ttdef"><b>Definition:</b> DataStruct.H:368</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5160b1e054b3e2a09c26274ef3551c64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5160b1e054b3e2a09c26274ef3551c64">&#9670;&nbsp;</a></span>init_stuff()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::init_stuff </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::BoxArray &amp;&#160;</td>
          <td class="paramname"><em>ba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::DistributionMapping &amp;&#160;</td>
          <td class="paramname"><em>dm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;{</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <span class="keywordflow">if</span> (lev == 0) {</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        <a class="code" href="classERF.html#a46a3587ddcfacba35dcf52189cc1be86">min_k_at_level</a>[lev] = 0;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        <a class="code" href="classERF.html#a9108040a44e5e64853ac7d6529538315">max_k_at_level</a>[lev] = geom[lev].Domain().bigEnd(2);</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        <span class="comment">// Start with unreasonable values so we compute the right min/max</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        <a class="code" href="classERF.html#a46a3587ddcfacba35dcf52189cc1be86">min_k_at_level</a>[lev] = geom[lev].Domain().bigEnd(2);</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        <a class="code" href="classERF.html#a9108040a44e5e64853ac7d6529538315">max_k_at_level</a>[lev] = geom[lev].Domain().smallEnd(2);</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; ba.size(); n++)</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        {</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;            <a class="code" href="classERF.html#a46a3587ddcfacba35dcf52189cc1be86">min_k_at_level</a>[lev] = std::min(<a class="code" href="classERF.html#a46a3587ddcfacba35dcf52189cc1be86">min_k_at_level</a>[lev], ba[n].smallEnd(2));</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;            <a class="code" href="classERF.html#a9108040a44e5e64853ac7d6529538315">max_k_at_level</a>[lev] = std::max(<a class="code" href="classERF.html#a9108040a44e5e64853ac7d6529538315">max_k_at_level</a>[lev], ba[n].bigEnd(2));</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        }</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    }</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160; </div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="comment">// The number of ghost cells for density must be 1 greater than that for velocity</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="comment">//     so that we can go back in forth betwen velocity and momentum on all faces</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="keywordtype">int</span> ngrow_state = <a class="code" href="classERF.html#ae68b1f54d196d0a4b19716d65a59d4c5">ComputeGhostCells</a>(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>, <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa2de671156cccf1f3a34b9f250fb0e28">use_NumDiff</a>) + 1;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <span class="keywordtype">int</span> ngrow_vels  = <a class="code" href="classERF.html#ae68b1f54d196d0a4b19716d65a59d4c5">ComputeGhostCells</a>(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>, <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa2de671156cccf1f3a34b9f250fb0e28">use_NumDiff</a>);</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160; </div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <span class="comment">// These are just used for scratch in the time integrator but we might as well define them here</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <a class="code" href="classERF.html#a6eecc44323f77917c95869928284f61d">rU_old</a>[lev].define(convert(ba, IntVect(1,0,0)), dm, 1, ngrow_vels);</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <a class="code" href="classERF.html#a01f3db32272f53dc68025f0a98195e57">rU_new</a>[lev].define(convert(ba, IntVect(1,0,0)), dm, 1, ngrow_vels);</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160; </div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <a class="code" href="classERF.html#aeb64e3b4def989ce68d873aefeed5e0e">rV_old</a>[lev].define(convert(ba, IntVect(0,1,0)), dm, 1, ngrow_vels);</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <a class="code" href="classERF.html#a54e37988486ef96e55e84bd8e91bb688">rV_new</a>[lev].define(convert(ba, IntVect(0,1,0)), dm, 1, ngrow_vels);</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160; </div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <a class="code" href="classERF.html#ac1fa56ec90f44e3cdf487af46804163f">rW_old</a>[lev].define(convert(ba, IntVect(0,0,1)), dm, 1, ngrow_vels);</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <a class="code" href="classERF.html#aa46c0b0d20525aed10f447923e54dde7">rW_new</a>[lev].define(convert(ba, IntVect(0,0,1)), dm, 1, ngrow_vels);</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160; </div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <span class="comment">// We do this here just so they won&#39;t be undefined in the initial FillPatch</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <a class="code" href="classERF.html#a01f3db32272f53dc68025f0a98195e57">rU_new</a>[lev].setVal(1.2e21);</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <a class="code" href="classERF.html#a54e37988486ef96e55e84bd8e91bb688">rV_new</a>[lev].setVal(3.4e22);</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <a class="code" href="classERF.html#aa46c0b0d20525aed10f447923e54dde7">rW_new</a>[lev].setVal(5.6e23);</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160; </div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    <span class="comment">// Define Theta_prim storage if using MOST BC</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[Orientation(Direction::z,Orientation::low)] == <a class="code" href="IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a882dd232c0425bb9366544f84f0a7b6c">ERF_BC::MOST</a>) {</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;      <a class="code" href="classERF.html#a71629ae2fda396472198691b75d83b2e">Theta_prim</a>[lev] = std::make_unique&lt;MultiFab&gt;(ba,dm,1,IntVect(ngrow_state,ngrow_state,0));</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> != <a class="code" href="DataStruct_8H.html#ab34704153a585940411c26587cb82ad0a6adf97f83acf6453d4a6a4b1070f3754">MoistureType::None</a>) {</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;          <a class="code" href="classERF.html#a521d1faf157e3bccc86c0f26ee923576">Qv_prim</a>[lev]    = std::make_unique&lt;MultiFab&gt;(ba,dm,1,IntVect(ngrow_state,ngrow_state,0));</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;          <a class="code" href="classERF.html#a521d1faf157e3bccc86c0f26ee923576">Qv_prim</a>[lev]    = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;      }</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;      <a class="code" href="classERF.html#a71629ae2fda396472198691b75d83b2e">Theta_prim</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;      <a class="code" href="classERF.html#a521d1faf157e3bccc86c0f26ee923576">Qv_prim</a>[lev]    = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    }</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160; </div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <span class="comment">// Map factors</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    BoxList bl2d = ba.boxList();</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; b : bl2d) {</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        b.setRange(2,0);</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    }</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    BoxArray ba2d(std::move(bl2d));</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160; </div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <a class="code" href="classERF.html#a23aacdb72e9d2dfed8e2ebd2c2526497">mapfac_m</a>[lev] = std::make_unique&lt;MultiFab&gt;(ba2d,dm,1,3);</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <a class="code" href="classERF.html#a1e8afee1508b720dab56f5d044deb301">mapfac_u</a>[lev] = std::make_unique&lt;MultiFab&gt;(convert(ba2d,IntVect(1,0,0)),dm,1,3);</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <a class="code" href="classERF.html#ae49b5055f9a7117fa15918a5daa775b7">mapfac_v</a>[lev] = std::make_unique&lt;MultiFab&gt;(convert(ba2d,IntVect(0,1,0)),dm,1,3);</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a9c7942f6ef7cf05115f35702097cf107">test_mapfactor</a>) {</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        <a class="code" href="classERF.html#a23aacdb72e9d2dfed8e2ebd2c2526497">mapfac_m</a>[lev]-&gt;setVal(0.5);</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        <a class="code" href="classERF.html#a1e8afee1508b720dab56f5d044deb301">mapfac_u</a>[lev]-&gt;setVal(0.5);</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        <a class="code" href="classERF.html#ae49b5055f9a7117fa15918a5daa775b7">mapfac_v</a>[lev]-&gt;setVal(0.5);</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    }</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        <a class="code" href="classERF.html#a23aacdb72e9d2dfed8e2ebd2c2526497">mapfac_m</a>[lev]-&gt;setVal(1.);</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        <a class="code" href="classERF.html#a1e8afee1508b720dab56f5d044deb301">mapfac_u</a>[lev]-&gt;setVal(1.);</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        <a class="code" href="classERF.html#ae49b5055f9a7117fa15918a5daa775b7">mapfac_v</a>[lev]-&gt;setVal(1.);</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    }</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160; </div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="preprocessor">#if defined(ERF_USE_WINDFARM)</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="comment">//*********************************************************</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <span class="comment">// Variables for Ftich model for windfarm parametrization</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    <span class="comment">//*********************************************************</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac0a723e8797cdc0fe06b3fc781fca645">windfarm_type</a> == <a class="code" href="DataStruct_8H.html#a5930188cdc2dd4def9ce58fdf5f46847a2b00d051a8acd949c63ac94efa793efe">WindFarmType::Fitch</a>){</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        <span class="keywordtype">int</span> ngrow_state = <a class="code" href="classERF.html#ae68b1f54d196d0a4b19716d65a59d4c5">ComputeGhostCells</a>(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>, <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa2de671156cccf1f3a34b9f250fb0e28">use_NumDiff</a>) + 1;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        <a class="code" href="classERF.html#a47c13e4cf7d4bd9b7b2be81886619fd9">vars_fitch</a>[lev].define(ba, dm, 5, ngrow_state); <span class="comment">// V, dVabsdt, dudt, dvdt, dTKEdt</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    }</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_a46a3587ddcfacba35dcf52189cc1be86"><div class="ttname"><a href="classERF.html#a46a3587ddcfacba35dcf52189cc1be86">ERF::min_k_at_level</a></div><div class="ttdeci">amrex::Vector&lt; int &gt; min_k_at_level</div><div class="ttdef"><b>Definition:</b> ERF.H:528</div></div>
<div class="ttc" id="aclassERF_html_a9108040a44e5e64853ac7d6529538315"><div class="ttname"><a href="classERF.html#a9108040a44e5e64853ac7d6529538315">ERF::max_k_at_level</a></div><div class="ttdeci">amrex::Vector&lt; int &gt; max_k_at_level</div><div class="ttdef"><b>Definition:</b> ERF.H:529</div></div>
<div class="ttc" id="aclassERF_html_ae68b1f54d196d0a4b19716d65a59d4c5"><div class="ttname"><a href="classERF.html#ae68b1f54d196d0a4b19716d65a59d4c5">ERF::ComputeGhostCells</a></div><div class="ttdeci">static AMREX_FORCE_INLINE int ComputeGhostCells(const AdvChoice &amp;advChoice, bool use_num_diff)</div><div class="ttdef"><b>Definition:</b> ERF.H:856</div></div>
<div class="ttc" id="astructSolverChoice_html_a9c7942f6ef7cf05115f35702097cf107"><div class="ttname"><a href="structSolverChoice.html#a9c7942f6ef7cf05115f35702097cf107">SolverChoice::test_mapfactor</a></div><div class="ttdeci">bool test_mapfactor</div><div class="ttdef"><b>Definition:</b> DataStruct.H:362</div></div>
<div class="ttc" id="astructSolverChoice_html_aaadbd092e9e176b7f088c7992c866c6e"><div class="ttname"><a href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">SolverChoice::advChoice</a></div><div class="ttdeci">AdvChoice advChoice</div><div class="ttdef"><b>Definition:</b> DataStruct.H:350</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae618963cf90e247b72fbd71d5b13599d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae618963cf90e247b72fbd71d5b13599d">&#9670;&nbsp;</a></span>init_uniform()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::init_uniform </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Use problem-specific reference density and temperature to set the background state to a uniform value.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lev</td><td>Integer specifying the current level </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;{</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <span class="keyword">auto</span>&amp; lev_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev];</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <span class="keywordflow">for</span> (MFIter mfi(lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], TilingIfNotGPU()); mfi.isValid(); ++mfi) {</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;        <span class="keyword">const</span> Box &amp;gbx = mfi.growntilebox(1);</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> &amp;cons_arr = lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].array(mfi);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;        <a class="code" href="classERF.html#a60e8cb933f237903e3fbcd6376c26db0">prob</a>-&gt;init_uniform(gbx, cons_arr);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    }</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad5d585e110291969767013a515719224"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5d585e110291969767013a515719224">&#9670;&nbsp;</a></span>InitData()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::InitData </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;{</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    BL_PROFILE_VAR(<span class="stringliteral">&quot;ERF::InitData()&quot;</span>, <a class="code" href="classERF.html#ad5d585e110291969767013a515719224">InitData</a>);</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160; </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="comment">// Initialize the start time for our CPU-time tracker</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <a class="code" href="classERF.html#a6d00e1cb76bfbcbada173e092b6accf3">startCPUTime</a> = ParallelDescriptor::second();</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160; </div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="comment">// Create the ReadBndryPlanes object so we can read boundary plane data</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="comment">// m_r2d is used by init_bcs so we must instantiate this class before</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a80ad08512968ec45635df68abe66b1fc">input_bndry_planes</a>) {</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        Print() &lt;&lt; <span class="stringliteral">&quot;Defining r2d for the first time &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a> = std::make_unique&lt;ReadBndryPlanes&gt;(geom[0], <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a2e1ef762ee1dc1bd3d4cbd08125c758a">rdOcp</a>);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    }</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160; </div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="comment">// Map the words in the inputs file to BC types, then translate</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="comment">//     those types into what they mean for each variable</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <a class="code" href="classERF.html#a618e8fdff3239cc79d4145d02b1ecaa2">init_bcs</a>();</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160; </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="comment">// Verify BCs are compatible with solver choice</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev(0); lev &lt;= max_level; ++lev) {</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        <span class="keywordflow">if</span> ( ( (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa53b017d79e0067923180a0aa59367b4">turbChoice</a>[lev].pbl_type == <a class="code" href="TurbStruct_8H.html#a4a079f2650ca30c787a8375ec5f17ca5abdeb9a753db1d1f3fe0e944eab1d0601">PBLType::MYNN25</a>) ||</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;               (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa53b017d79e0067923180a0aa59367b4">turbChoice</a>[lev].pbl_type == <a class="code" href="TurbStruct_8H.html#a4a079f2650ca30c787a8375ec5f17ca5ad032bccff1ff2e272cc68da5a0de09fe">PBLType::YSU</a>)       ) &amp;&amp;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;            <a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[Orientation(Direction::z,Orientation::low)] != <a class="code" href="IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a882dd232c0425bb9366544f84f0a7b6c">ERF_BC::MOST</a> ) {</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;            Abort(<span class="stringliteral">&quot;MYNN2.5/YSU PBL Model requires MOST at lower boundary&quot;</span>);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        }</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    }</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160; </div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a063a88594452100497651e8aaf1f68d7">use_terrain</a> &amp;&amp; <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> != <a class="code" href="DataStruct_8H.html#af82ff6f1edafee12190434b73fe91127a84a8921b25f505d0d2077aeb5db4bc16">TerrainType::Static</a>) {</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        Abort(<span class="stringliteral">&quot;We do not allow non-static terrain_type with use_terrain = false&quot;</span>);</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    }</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160; </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <a class="code" href="classERF.html#a7d54d3f2317d06a8dfcde4f65cfc3e92">last_plot_file_step_1</a> = -1;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <a class="code" href="classERF.html#a09017292c9943ac2ed20ce7ed5c3c767">last_plot_file_step_2</a> = -1;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <a class="code" href="classERF.html#a02722d16f3c26efe590702200f1296d7">last_check_file_step</a>  = -1;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160; </div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>.empty()) {</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        <span class="comment">// start simulation from the beginning</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160; </div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        <span class="keyword">const</span> Real time = <a class="code" href="classERF.html#aa0c07f31b23d977646b8161e5473fab5">start_time</a>;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        InitFromScratch(time);</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160; </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="preprocessor">#ifdef ERF_USE_MULTIBLOCK</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="preprocessor">#ifndef ERF_MB_EXTERN       </span><span class="comment">// enter only if multiblock does not involve an external class</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        <span class="comment">// Multiblock: hook to set BL &amp; comms once ba/dm are known</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        <span class="keywordflow">if</span>(domain_p[0].bigEnd(0) &lt; 500 ) {</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;            m_mbc-&gt;SetBoxLists();</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;            m_mbc-&gt;SetBlockCommMetaData();</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        }</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160; </div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a063a88594452100497651e8aaf1f68d7">use_terrain</a>) {</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#af5ac3d88a33a1a284bcc120ce0599cf7">init_type</a> == <span class="stringliteral">&quot;ideal&quot;</span>) {</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                Abort(<span class="stringliteral">&quot;We do not currently support init_type = ideal with terrain&quot;</span>);</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;            }</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        }</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160; </div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        <span class="comment">// Make sure that detJ and z_phys_cc are the average of the data on a finer level if there is one</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a063a88594452100497651e8aaf1f68d7">use_terrain</a> != 0) {</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> crse_lev = finest_level-1; crse_lev &gt;= 0; crse_lev--) {</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                average_down(  *<a class="code" href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">detJ_cc</a>[crse_lev+1],   *<a class="code" href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">detJ_cc</a>[crse_lev], 0, 1, refRatio(crse_lev));</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                average_down(*<a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[crse_lev+1], *<a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[crse_lev], 0, 1, refRatio(crse_lev));</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;            }</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        }</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160; </div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        <span class="comment">// If using the Deardoff LES model,</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        <span class="comment">// we initialize rho_KE to be nonzero (and positive) so that we end up</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        <span class="comment">// with reasonable values for the eddy diffusivity and the MOST fluxes</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        <span class="comment">// (~ 1/diffusivity) do not blow up</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        Real RhoKE_0;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        ParmParse <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>(<a class="code" href="classERF.html#a59df30e7a5537c8543bb00772bd98b58">pp_prefix</a>);</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;RhoKE_0&quot;</span>, RhoKE_0)) {</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;            <span class="comment">// Uniform initial rho*e field</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; lev++) {</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa53b017d79e0067923180a0aa59367b4">turbChoice</a>[lev].les_type == <a class="code" href="TurbStruct_8H.html#aa346fa9f5c0cb101a7766563fb76c500ab7106655ebb5e00e0f040302bf4129bf">LESType::Deardorff</a>) {</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                    Print() &lt;&lt; <span class="stringliteral">&quot;Initializing uniform rhoKE=&quot;</span> &lt;&lt; RhoKE_0</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot; on level &quot;</span> &lt;&lt; lev</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                        &lt;&lt; std::endl;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                    <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].setVal(RhoKE_0,<a class="code" href="IndexDefines_8H.html#ae15721db2cb4c2ab4732afe226bbba64">RhoKE_comp</a>,1,0);</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                    <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].setVal(0.0,<a class="code" href="IndexDefines_8H.html#ae15721db2cb4c2ab4732afe226bbba64">RhoKE_comp</a>,1,0);</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                }</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;            }</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        }</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160; </div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        Real KE_0;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;KE_0&quot;</span>, KE_0)) {</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;            <span class="comment">// Uniform initial e field</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; lev++) {</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                <span class="keyword">auto</span>&amp; lev_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev];</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa53b017d79e0067923180a0aa59367b4">turbChoice</a>[lev].les_type == <a class="code" href="TurbStruct_8H.html#aa346fa9f5c0cb101a7766563fb76c500ab7106655ebb5e00e0f040302bf4129bf">LESType::Deardorff</a>) {</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                    Print() &lt;&lt; <span class="stringliteral">&quot;Initializing uniform KE=&quot;</span> &lt;&lt; KE_0</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot; on level &quot;</span> &lt;&lt; lev</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                        &lt;&lt; std::endl;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                    <span class="keywordflow">for</span> (MFIter mfi(lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], TilingIfNotGPU()); mfi.isValid(); ++mfi) {</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                        <span class="keyword">const</span> Box &amp;bx = mfi.tilebox();</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                        <span class="keyword">const</span> <span class="keyword">auto</span> &amp;cons_arr = lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].array(mfi);</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                        <span class="comment">// We want to set the lateral BC values, too</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                        Box gbx = bx; <span class="comment">// Copy constructor</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                        gbx.grow(0,1); gbx.grow(1,1); <span class="comment">// Grow by one in the lateral directions</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                        ParallelFor(gbx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept {</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                            cons_arr(i,j,k,<a class="code" href="IndexDefines_8H.html#ae15721db2cb4c2ab4732afe226bbba64">RhoKE_comp</a>) = cons_arr(i,j,k,<a class="code" href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>) * KE_0;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                        });</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                    } <span class="comment">// mfi</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                    lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].setVal(0.0,<a class="code" href="IndexDefines_8H.html#ae15721db2cb4c2ab4732afe226bbba64">RhoKE_comp</a>,1,0);</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                }</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;            } <span class="comment">// lev</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        }</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160; </div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        Real QKE_0;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;QKE_0&quot;</span>, QKE_0)) {</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            Print() &lt;&lt; <span class="stringliteral">&quot;Initializing uniform QKE=&quot;</span> &lt;&lt; QKE_0 &lt;&lt; std::endl;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; lev++) {</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                <span class="keyword">auto</span>&amp; lev_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev];</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                <span class="keywordflow">for</span> (MFIter mfi(lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], TilingIfNotGPU()); mfi.isValid(); ++mfi) {</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                    <span class="keyword">const</span> Box &amp;bx = mfi.tilebox();</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                    <span class="keyword">const</span> <span class="keyword">auto</span> &amp;cons_arr = lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].array(mfi);</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                    <span class="comment">// We want to set the lateral BC values, too</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                    Box gbx = bx; <span class="comment">// Copy constructor</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                    gbx.grow(0,1); gbx.grow(1,1); <span class="comment">// Grow by one in the lateral directions</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                    ParallelFor(gbx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept {</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                        cons_arr(i,j,k,<a class="code" href="IndexDefines_8H.html#ac190f1f4846f6e6e31628041150f3d93">RhoQKE_comp</a>) = cons_arr(i,j,k,<a class="code" href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>) * QKE_0;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                    });</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                } <span class="comment">// mfi</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;            }</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        }</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160; </div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#af976afa61859c07e6249963edc367c2d">coupling_type</a> == <a class="code" href="DataStruct_8H.html#ad285be248c0803917aaf5cf8ce62139ba6c267346f8ebb889610a5a90838be815">CouplingType::TwoWay</a>) {</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;            <a class="code" href="classERF.html#a8202de1f8f372e3e6fdc483447c6a55f">AverageDown</a>();</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        }</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160; </div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="preprocessor">#ifdef ERF_USE_PARTICLES</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        initializeTracers((ParGDBBase*)GetParGDB(),<a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>);</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160; </div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    } <span class="keywordflow">else</span> { <span class="comment">// Restart from a checkpoint</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160; </div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        <a class="code" href="classERF.html#a530d2ce59e6fd46e9fb00e4d11eaf737">restart</a>();</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160; </div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160; </div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        <span class="comment">// TODO: Check if this is needed. I don&#39;t think it is since we now</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        <span class="comment">//       advect all the scalars...</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160; </div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        <span class="comment">// Need to fill ghost cells here since we will use this qmoist in advance</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> != <a class="code" href="DataStruct_8H.html#ab34704153a585940411c26587cb82ad0a6adf97f83acf6453d4a6a4b1070f3754">MoistureType::None</a>)</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        {</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; lev++) {</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ae00126a9c2738bf6a6cbbe77321c9cfc">qmoist</a>[lev].size() &gt; 0) <a class="code" href="classERF.html#afb39caf6b6949138c0c3c4a067648321">FillPatchMoistVars</a>(lev, *(<a class="code" href="classERF.html#ae00126a9c2738bf6a6cbbe77321c9cfc">qmoist</a>[lev][0])); <span class="comment">// qv component</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;            }</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        }</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    }</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160; </div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="preprocessor">#ifdef ERF_USE_PARTICLES</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <span class="comment">/* If using a Lagrangian microphysics model, its particle container has now been</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="comment">       constructed and initialized (calls to micro-&gt;Init). So, add its pointer to</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="comment">       ERF::particleData and remove its name from list of unallocated particle containers. */</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classMicrophysics.html#ac10e6fce2e6cb49373d56ca0e1a5b366">Microphysics::modelType</a>(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a>) == <a class="code" href="DataStruct_8H.html#a62a5a9bde82457a1611cde231a43bfe5a2e32ba26d0dfb8d9502608639fcac451">MoistureModelType::Lagrangian</a>) {</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span>&amp; pc_name( <span class="keyword">dynamic_cast&lt;</span>LagrangianMicrophysics&amp;<span class="keyword">&gt;</span>(*micro).getName() );</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span>&amp; pc_ptr( <span class="keyword">dynamic_cast&lt;</span>LagrangianMicrophysics&amp;<span class="keyword">&gt;</span>(*micro).getParticleContainer() );</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        particleData.pushBack(pc_name, pc_ptr);</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        particleData.getNamesUnalloc().remove(pc_name);</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    }</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160; </div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a80ad08512968ec45635df68abe66b1fc">input_bndry_planes</a>) {</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        <span class="comment">// Read the &quot;time.dat&quot; file to know what data is available</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;read_time_file();</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160; </div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        <span class="comment">// We haven&#39;t populated dt yet, set to 0 to ensure assert doesn&#39;t crash</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        Real dt_dummy = 0.0;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;read_input_files(<a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0],dt_dummy,<a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>);</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    }</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160; </div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <span class="comment">// Initialize flux registers (whether we start from scratch or restart)</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#af976afa61859c07e6249963edc367c2d">coupling_type</a> == <a class="code" href="DataStruct_8H.html#ad285be248c0803917aaf5cf8ce62139ba6c267346f8ebb889610a5a90838be815">CouplingType::TwoWay</a>) {</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        <a class="code" href="classERF.html#a86a0bc8e41668411ee0ab5801d4688a7">advflux_reg</a>[0] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        <span class="keywordtype">int</span> ncomp_reflux = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[0][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nComp();</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 1; lev &lt;= finest_level; lev++)</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        {</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;            <a class="code" href="classERF.html#a86a0bc8e41668411ee0ab5801d4688a7">advflux_reg</a>[lev] = <span class="keyword">new</span> YAFluxRegister(grids[lev], grids[lev-1],</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                                                   dmap[lev],  dmap[lev-1],</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                                                   geom[lev],  geom[lev-1],</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                                              ref_ratio[lev-1], lev, ncomp_reflux);</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        }</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    }</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160; </div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a4e81a09c9f454c680568b7776a3ed90e">custom_rhotheta_forcing</a>)</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    {</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        <a class="code" href="classERF.html#a87aad7caaf3b575734994b47628a2faf">h_rhotheta_src</a>.resize(max_level+1, Vector&lt;Real&gt;(0));</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        <a class="code" href="classERF.html#a0c1fdcfbc9cbd6cb13e41d1170b161f8">d_rhotheta_src</a>.resize(max_level+1, Gpu::DeviceVector&lt;Real&gt;(0));</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; lev++) {</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> domlen = geom[lev].Domain().length(2);</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;            <a class="code" href="classERF.html#a87aad7caaf3b575734994b47628a2faf">h_rhotheta_src</a>[lev].resize(domlen, 0.0_rt);</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;            <a class="code" href="classERF.html#a0c1fdcfbc9cbd6cb13e41d1170b161f8">d_rhotheta_src</a>[lev].resize(domlen, 0.0_rt);</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;            <a class="code" href="classERF.html#a60e8cb933f237903e3fbcd6376c26db0">prob</a>-&gt;update_rhotheta_sources(<a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0],</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                                          <a class="code" href="classERF.html#a87aad7caaf3b575734994b47628a2faf">h_rhotheta_src</a>[lev], <a class="code" href="classERF.html#a0c1fdcfbc9cbd6cb13e41d1170b161f8">d_rhotheta_src</a>[lev],</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                                          geom[lev], <a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[lev]);</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        }</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    }</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160; </div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa2e312b4e6d08797fc3c1b6d67313d48">custom_moisture_forcing</a>)</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    {</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        <a class="code" href="classERF.html#a3c5eca26a28dda3a981b3581abadfca0">h_rhoqt_src</a>.resize(max_level+1, Vector&lt;Real&gt;(0));</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        <a class="code" href="classERF.html#a838687881ef3626f932d0e95ceff0e53">d_rhoqt_src</a>.resize(max_level+1, Gpu::DeviceVector&lt;Real&gt;(0));</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; lev++) {</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> domlen = geom[lev].Domain().length(2);</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;            <a class="code" href="classERF.html#a3c5eca26a28dda3a981b3581abadfca0">h_rhoqt_src</a>[lev].resize(domlen, 0.0_rt);</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;            <a class="code" href="classERF.html#a838687881ef3626f932d0e95ceff0e53">d_rhoqt_src</a>[lev].resize(domlen, 0.0_rt);</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;            <a class="code" href="classERF.html#a60e8cb933f237903e3fbcd6376c26db0">prob</a>-&gt;update_rhoqt_sources(<a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0],</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                                       <a class="code" href="classERF.html#a3c5eca26a28dda3a981b3581abadfca0">h_rhoqt_src</a>[lev], <a class="code" href="classERF.html#a838687881ef3626f932d0e95ceff0e53">d_rhoqt_src</a>[lev],</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                                       geom[lev], <a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[lev]);</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;        }</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    }</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160; </div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a596f061b796ada0389c81a6125150b6e">custom_w_subsidence</a>)</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    {</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        <a class="code" href="classERF.html#a1a5d0d0b4e8c196f56dfab98f245aff5">h_w_subsid</a>.resize(max_level+1, Vector&lt;Real&gt;(0));</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        <a class="code" href="classERF.html#ac94ddee2f501dbcea2a516284b7119b5">d_w_subsid</a>.resize(max_level+1, Gpu::DeviceVector&lt;Real&gt;(0));</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; lev++) {</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> domlen = geom[lev].Domain().length(2);</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;            <a class="code" href="classERF.html#a1a5d0d0b4e8c196f56dfab98f245aff5">h_w_subsid</a>[lev].resize(domlen, 0.0_rt);</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;            <a class="code" href="classERF.html#ac94ddee2f501dbcea2a516284b7119b5">d_w_subsid</a>[lev].resize(domlen, 0.0_rt);</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;            <a class="code" href="classERF.html#a60e8cb933f237903e3fbcd6376c26db0">prob</a>-&gt;update_w_subsidence(<a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0],</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                                      <a class="code" href="classERF.html#a1a5d0d0b4e8c196f56dfab98f245aff5">h_w_subsid</a>[lev], <a class="code" href="classERF.html#ac94ddee2f501dbcea2a516284b7119b5">d_w_subsid</a>[lev],</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                                      geom[lev], <a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[lev]);</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        }</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    }</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160; </div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a27ced9266434a4680ef175e7b2ba8f01">use_rayleigh_damping</a>)</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    {</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        <a class="code" href="classERF.html#a039a764a1d942c484e8aea49e87bc046">initRayleigh</a>();</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#af5ac3d88a33a1a284bcc120ce0599cf7">init_type</a> == <span class="stringliteral">&quot;input_sounding&quot;</span>)</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        {</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;            <span class="comment">// Overwrite ubar, vbar, and thetabar with input profiles;</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;            <span class="comment">// wbar is assumed to be 0. Note: the tau coefficient set by</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;            <span class="comment">// prob-&gt;erf_init_rayleigh() is still used</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;            <span class="keywordtype">bool</span> restarting = (!<a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>.empty());</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;            <a class="code" href="classERF.html#a0877d5a0263641c13b92d2d16f47b689">setRayleighRefFromSounding</a>(restarting);</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;        }</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160; </div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    }</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160; </div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ad4c61fad53912d1e8d0f774d365bcf0f">is_it_time_for_action</a>(<a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[0], <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0], <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[0], <a class="code" href="classERF.html#a5232e98479611a24fe97994640c61faa">sum_interval</a>, <a class="code" href="classERF.html#a1cf2ba396f4404724824516da4c4a084">sum_per</a>)) {</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        <a class="code" href="classERF.html#a922892a05ee0c5bccd210a3e5a8599e1">sum_integrated_quantities</a>(<a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0]);</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a2aa0f6b2edd9efd9b090e39db1effcdf">cc_profiles</a>) {</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;            <span class="comment">// all variables cell-centered</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;            <a class="code" href="classERF.html#a55eae94c5363e227b571739738bb26b7">write_1D_profiles</a>(<a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0]);</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;            <span class="comment">// some variables staggered</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;            <a class="code" href="classERF.html#a39efa3a0f3ae3deb7a43f4ce110ee49a">write_1D_profiles_stag</a>(<a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0]);</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        }</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    }</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160; </div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <span class="comment">// We only write the file at level 0 for now</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a7c448670f7a5cadd6fe56f7e615c9eb6">output_bndry_planes</a>)</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    {</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;        <span class="comment">// Create the WriteBndryPlanes object so we can handle writing of boundary plane data</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;        <a class="code" href="classERF.html#aa53035f34ba133b86172e180abda4209">m_w2d</a> = std::make_unique&lt;WriteBndryPlanes&gt;(grids,geom);</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160; </div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;        Real time = 0.;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;        <span class="keywordflow">if</span> (time &gt;= <a class="code" href="classERF.html#a87e58f16f44a6cb35d6983ed3fe7d3c1">bndry_output_planes_start_time</a>) {</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;            <a class="code" href="classERF.html#aa53035f34ba133b86172e180abda4209">m_w2d</a>-&gt;write_planes(0, time, <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>);</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        }</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    }</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160; </div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="preprocessor">#ifdef ERF_USE_POISSON_SOLVE</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a> == <span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    {</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;        <span class="comment">// Note -- this projection is only defined for no terrain</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.project_initial_velocity) {</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;            AMREX_ALWAYS_ASSERT(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a063a88594452100497651e8aaf1f68d7">use_terrain</a> == 0);</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;            project_velocities(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>);</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;        }</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    }</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    <span class="comment">// Copy from new into old just in case</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev)</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    {</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        <span class="keyword">auto</span>&amp; lev_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev];</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        <span class="keyword">auto</span>&amp; lev_old = <a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev];</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160; </div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        <span class="keywordtype">int</span> ncomp = lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nComp();</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160; </div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        MultiFab::Copy(lev_old[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],0,0,ncomp,lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nGrowVect());</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        MultiFab::Copy(lev_old[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],0,0,    1,lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].nGrowVect());</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        MultiFab::Copy(lev_old[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],0,0,    1,lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].nGrowVect());</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        MultiFab::Copy(lev_old[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>],lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>],0,0,    1,lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].nGrowVect());</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    }</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160; </div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    <span class="comment">// Compute the minimum dz in the domain (to be used for setting the timestep)</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    <a class="code" href="classERF.html#a0656573ffb79f0fda8d02d5ea0482ed2">dz_min</a> = geom[0].CellSize(2);</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a063a88594452100497651e8aaf1f68d7">use_terrain</a> ) {</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        <a class="code" href="classERF.html#a0656573ffb79f0fda8d02d5ea0482ed2">dz_min</a> *= (*<a class="code" href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">detJ_cc</a>[0]).min(0);</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    }</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160; </div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    <a class="code" href="classERF.html#a62a5ed3c3806eaa918257e0ad1382df5">ComputeDt</a>();</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160; </div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <span class="comment">// Fill ghost cells/faces</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev)</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    {</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        <span class="keywordflow">if</span> (lev &gt; 0 &amp;&amp; <a class="code" href="classERF.html#ad9084179f7384e10a519989ffd51fd34">cf_width</a> &gt;= 0) {</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;            <a class="code" href="classERF.html#adc284f421c5fd9dd15c0e5cbe4ff5fc8">Construct_ERFFillPatchers</a>(lev);</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;        }</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160; </div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        <span class="comment">// Fill boundary conditions -- not sure why we need this here</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        <span class="keywordtype">bool</span> fillset = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        <span class="keyword">auto</span>&amp; lev_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev];</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;        <a class="code" href="classERF.html#a8de69f537859f576fba1d94844cfbd33">FillPatch</a>(lev, <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev],</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                  {&amp;lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],&amp;lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],&amp;lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],&amp;lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>]},</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                  {&amp;lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],&amp;<a class="code" href="classERF.html#a01f3db32272f53dc68025f0a98195e57">rU_new</a>[lev],&amp;<a class="code" href="classERF.html#a54e37988486ef96e55e84bd8e91bb688">rV_new</a>[lev],&amp;<a class="code" href="classERF.html#aa46c0b0d20525aed10f447923e54dde7">rW_new</a>[lev]},</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                  fillset);</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160; </div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        <span class="comment">// We do this here to make sure level (lev-1) boundary conditions are filled</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        <span class="comment">// before we interpolate to level (lev) ghost cells</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;        <span class="keywordflow">if</span> (lev &lt; finest_level) {</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;            <span class="keyword">auto</span>&amp; lev_old = <a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev];</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;            MultiFab::Copy(lev_old[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],0,0,lev_old[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nComp(),lev_old[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nGrowVect());</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;            MultiFab::Copy(lev_old[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],0,0,lev_old[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].nComp(),lev_old[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].nGrowVect());</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;            MultiFab::Copy(lev_old[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],0,0,lev_old[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].nComp(),lev_old[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].nGrowVect());</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;            MultiFab::Copy(lev_old[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>],lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>],0,0,lev_old[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].nComp(),lev_old[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].nGrowVect());</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        }</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160; </div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;        <span class="comment">// We fill the ghost cell values of the base state in case it wasn&#39;t done in the initialization</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160; </div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;        <span class="comment">// For moving terrain only</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> != <a class="code" href="DataStruct_8H.html#af82ff6f1edafee12190434b73fe91127a84a8921b25f505d0d2077aeb5db4bc16">TerrainType::Static</a>) {</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;            MultiFab::Copy(<a class="code" href="classERF.html#a37b2a4257df8ff53d4450de47f16ace1">base_state_new</a>[lev],<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev],0,0,3,1);</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;            <a class="code" href="classERF.html#a37b2a4257df8ff53d4450de47f16ace1">base_state_new</a>[lev].FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        }</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    }</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160; </div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    <span class="comment">// Configure ABLMost params if used MostWall boundary condition</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    <span class="comment">// NOTE: we must set up the MOST routine after calling FillPatch</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    <span class="comment">//       in order to have lateral ghost cells filled (MOST + terrain interp).</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    <span class="comment">//       FillPatch does not call MOST, FillIntermediatePatch does.</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[Orientation(Direction::z,Orientation::low)] == <a class="code" href="IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a882dd232c0425bb9366544f84f0a7b6c">ERF_BC::MOST</a>)</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    {</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="preprocessor">#ifdef ERF_EXPLICIT_MOST_STRESS</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        Print() &lt;&lt; <span class="stringliteral">&quot;Using MOST with explicitly included surface stresses&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160; </div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;        <a class="code" href="classERF.html#a051364b2373d8d86151c0b4a958035bd">m_most</a> = std::make_unique&lt;ABLMost&gt;(geom, <a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>, <a class="code" href="classERF.html#a71629ae2fda396472198691b75d83b2e">Theta_prim</a>, <a class="code" href="classERF.html#a521d1faf157e3bccc86c0f26ee923576">Qv_prim</a>, <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>,</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                                           <a class="code" href="classERF.html#a5a5395054a212d8f3fc577562c14b66e">sst_lev</a>, <a class="code" href="classERF.html#a3f3e29874221e43e13e2a431e77e0e4e">lmask_lev</a>, <a class="code" href="classERF.html#ad03da3399e893728741fac33100ce476">lsm_data</a>, <a class="code" href="classERF.html#aa5f6a6ceae0087393f386649d8bbbc31">lsm_flux</a></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;#ifdef ERF_USE_NETCDF</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                                           ,start_bdy_time, bdy_time_interval</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;#endif</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                                           );</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160; </div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        <span class="comment">// We now configure ABLMost params here so that we can print the averages at t=0</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        <span class="comment">// Note we don&#39;t fill ghost cells here because this is just for diagnostics</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev)</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;        {</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;            Real time  = <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev];</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;            IntVect ng = <a class="code" href="classERF.html#a71629ae2fda396472198691b75d83b2e">Theta_prim</a>[lev]-&gt;nGrowVect();</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;            MultiFab S(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],make_alias,0,<a class="code" href="IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>+1);</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;            MultiFab::Copy(  *<a class="code" href="classERF.html#a71629ae2fda396472198691b75d83b2e">Theta_prim</a>[lev], S, <a class="code" href="IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>, 0, 1, ng);</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;            MultiFab::Divide(*<a class="code" href="classERF.html#a71629ae2fda396472198691b75d83b2e">Theta_prim</a>[lev], S, <a class="code" href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>     , 0, 1, ng);</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> != <a class="code" href="DataStruct_8H.html#ab34704153a585940411c26587cb82ad0a6adf97f83acf6453d4a6a4b1070f3754">MoistureType::None</a>) {</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                ng = <a class="code" href="classERF.html#a521d1faf157e3bccc86c0f26ee923576">Qv_prim</a>[lev]-&gt;nGrowVect();</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                MultiFab Sm(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],make_alias,0,<a class="code" href="IndexDefines_8H.html#aa965e9988f14d5d2a5aef4a942168a15">RhoQ1_comp</a>+1);</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                MultiFab::Copy(  *<a class="code" href="classERF.html#a521d1faf157e3bccc86c0f26ee923576">Qv_prim</a>[lev], Sm, <a class="code" href="IndexDefines_8H.html#aa965e9988f14d5d2a5aef4a942168a15">RhoQ1_comp</a>, 0, 1, ng);</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                MultiFab::Divide(*<a class="code" href="classERF.html#a521d1faf157e3bccc86c0f26ee923576">Qv_prim</a>[lev], Sm, <a class="code" href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>  , 0, 1, ng);</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;            }</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;            <a class="code" href="classERF.html#a051364b2373d8d86151c0b4a958035bd">m_most</a>-&gt;update_mac_ptrs(lev, <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>, <a class="code" href="classERF.html#a71629ae2fda396472198691b75d83b2e">Theta_prim</a>, <a class="code" href="classERF.html#a521d1faf157e3bccc86c0f26ee923576">Qv_prim</a>);</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;            <a class="code" href="classERF.html#a051364b2373d8d86151c0b4a958035bd">m_most</a>-&gt;update_fluxes(lev, time);</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        }</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    }</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160; </div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    <span class="comment">// Update micro vars before first plot file</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> != <a class="code" href="DataStruct_8H.html#ab34704153a585940411c26587cb82ad0a6adf97f83acf6453d4a6a4b1070f3754">MoistureType::None</a>) {</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev) <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;Update_Micro_Vars_Lev(lev, <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>]);</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    }</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160; </div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    <span class="comment">// check for additional plotting variables that are available after particle containers</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    <span class="comment">// are setup.</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    <span class="keyword">const</span> std::string&amp; pv1 = <span class="stringliteral">&quot;plot_vars_1&quot;</span>; <a class="code" href="classERF.html#a7758f75dc7c9029eddc4c58ac0567654">appendPlotVariables</a>(pv1,<a class="code" href="classERF.html#a6865cf87abbb5aab0db00ff3b1ce94ac">plot_var_names_1</a>);</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <span class="keyword">const</span> std::string&amp; pv2 = <span class="stringliteral">&quot;plot_vars_2&quot;</span>; <a class="code" href="classERF.html#a7758f75dc7c9029eddc4c58ac0567654">appendPlotVariables</a>(pv2,<a class="code" href="classERF.html#a79705c02d6f25fbdcec14ca2432e5da1">plot_var_names_2</a>);</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160; </div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>.empty() &amp;&amp; (<a class="code" href="classERF.html#a69a3f925e95ec4244b0257f9de16d65a">m_check_int</a> &gt; 0 || <a class="code" href="classERF.html#a5fbf17cfc8d9e5b994783e05ec3594b2">m_check_per</a> &gt; 0.) )</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    {</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;<span class="preprocessor">#ifdef ERF_USE_NETCDF</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32e0d0f5ae0db18ee81f9d4325a14f64">check_type</a> == <span class="stringliteral">&quot;netcdf&quot;</span>) {</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;           WriteNCCheckpointFile();</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;        }</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32e0d0f5ae0db18ee81f9d4325a14f64">check_type</a> == <span class="stringliteral">&quot;native&quot;</span>) {</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;           <a class="code" href="classERF.html#ad101fd46096db2d6b21544bfede6551f">WriteCheckpointFile</a>();</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        }</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;        <a class="code" href="classERF.html#a02722d16f3c26efe590702200f1296d7">last_check_file_step</a> = 0;</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    }</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160; </div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    <span class="keywordflow">if</span> ( (<a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>.empty()) ||</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;         (!<a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>.empty() &amp;&amp; <a class="code" href="classERF.html#adc00038dfe4c332e5d15f621184c69e8">plot_file_on_restart</a>) )</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    {</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a57cfb4bfead8525174646964992c7e69">m_plot_int_1</a> &gt; 0 || <a class="code" href="classERF.html#a3167adc9518cce649a90ab82e9f9c85d">m_plot_per_1</a> &gt; 0.)</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        {</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;            <a class="code" href="classERF.html#a0b0b4140e117163895e5e2c89a68d12a">WritePlotFile</a>(1,<a class="code" href="classERF.html#a6865cf87abbb5aab0db00ff3b1ce94ac">plot_var_names_1</a>);</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;            <a class="code" href="classERF.html#a7d54d3f2317d06a8dfcde4f65cfc3e92">last_plot_file_step_1</a> = <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[0];</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;        }</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ad3311c9ceacd17f34bdb5e03cefa33b3">m_plot_int_2</a> &gt; 0 || <a class="code" href="classERF.html#aff879a9c686293a10a3a03027b765c51">m_plot_per_2</a> &gt; 0.)</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;        {</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;            <a class="code" href="classERF.html#a0b0b4140e117163895e5e2c89a68d12a">WritePlotFile</a>(2,<a class="code" href="classERF.html#a79705c02d6f25fbdcec14ca2432e5da1">plot_var_names_2</a>);</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;            <a class="code" href="classERF.html#a09017292c9943ac2ed20ce7ed5c3c767">last_plot_file_step_2</a> = <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[0];</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        }</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    }</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160; </div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <span class="comment">// Set these up here because we need to know which MPI rank &quot;cell&quot; is on...</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    ParmParse <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>(<span class="stringliteral">&quot;erf&quot;</span>);</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.contains(<span class="stringliteral">&quot;data_log&quot;</span>))</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    {</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        <span class="keywordtype">int</span> num_datalogs = <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.countval(<span class="stringliteral">&quot;data_log&quot;</span>);</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;        <a class="code" href="classERF.html#a1cade630b005dbcc0f644987ef3db287">datalog</a>.resize(num_datalogs);</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;        <a class="code" href="classERF.html#a9248a4eb025c2647e003f838cba52a21">datalogname</a>.resize(num_datalogs);</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.queryarr(<span class="stringliteral">&quot;data_log&quot;</span>,<a class="code" href="classERF.html#a9248a4eb025c2647e003f838cba52a21">datalogname</a>,0,num_datalogs);</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num_datalogs; i++)</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;            <a class="code" href="classERF.html#a2486b49bb0d7917f812318822e42a03c">setRecordDataInfo</a>(i,<a class="code" href="classERF.html#a9248a4eb025c2647e003f838cba52a21">datalogname</a>[i]);</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    }</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160; </div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.contains(<span class="stringliteral">&quot;sample_point_log&quot;</span>) &amp;&amp; <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.contains(<span class="stringliteral">&quot;sample_point&quot;</span>))</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    {</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        <span class="keywordtype">int</span> lev = 0;</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160; </div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;        <span class="keywordtype">int</span> num_samplepts = <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.countval(<span class="stringliteral">&quot;sample_point&quot;</span>) / AMREX_SPACEDIM;</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        <span class="keywordflow">if</span> (num_samplepts &gt; 0) {</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;            Vector&lt;int&gt; index; index.resize(num_samplepts*AMREX_SPACEDIM);</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;            <a class="code" href="classERF.html#ae8a57b7fbf5a67c99d04b7d4f43ad100">samplepoint</a>.resize(num_samplepts);</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160; </div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;            <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.queryarr(<span class="stringliteral">&quot;sample_point&quot;</span>,index,0,num_samplepts*AMREX_SPACEDIM);</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num_samplepts; i++) {</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                IntVect iv(index[AMREX_SPACEDIM*i+0],index[AMREX_SPACEDIM*i+1],index[AMREX_SPACEDIM*i+2]);</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                <a class="code" href="classERF.html#ae8a57b7fbf5a67c99d04b7d4f43ad100">samplepoint</a>[i] = iv;</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;            }</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;        }</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160; </div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        <span class="keywordtype">int</span> num_sampleptlogs = <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.countval(<span class="stringliteral">&quot;sample_point_log&quot;</span>);</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        AMREX_ALWAYS_ASSERT(num_sampleptlogs == num_samplepts);</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;        <span class="keywordflow">if</span> (num_sampleptlogs &gt; 0) {</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;            <a class="code" href="classERF.html#a9737ddb0de6b9e8a5b17c109d5ad3e08">sampleptlog</a>.resize(num_sampleptlogs);</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;            <a class="code" href="classERF.html#a8fbfa8bb47c0a3b53e244081aa1e8ad3">sampleptlogname</a>.resize(num_sampleptlogs);</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;            <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.queryarr(<span class="stringliteral">&quot;sample_point_log&quot;</span>,<a class="code" href="classERF.html#a8fbfa8bb47c0a3b53e244081aa1e8ad3">sampleptlogname</a>,0,num_sampleptlogs);</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160; </div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num_sampleptlogs; i++) {</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                <a class="code" href="classERF.html#af8d930dce1b926ecc3bdc6787dd47818">setRecordSamplePointInfo</a>(i,lev,<a class="code" href="classERF.html#ae8a57b7fbf5a67c99d04b7d4f43ad100">samplepoint</a>[i],<a class="code" href="classERF.html#a8fbfa8bb47c0a3b53e244081aa1e8ad3">sampleptlogname</a>[i]);</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;            }</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;        }</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160; </div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    }</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160; </div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.contains(<span class="stringliteral">&quot;sample_line_log&quot;</span>) &amp;&amp; <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.contains(<span class="stringliteral">&quot;sample_line&quot;</span>))</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    {</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;        <span class="keywordtype">int</span> lev = 0;</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160; </div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;        <span class="keywordtype">int</span> num_samplelines = <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.countval(<span class="stringliteral">&quot;sample_line&quot;</span>) / AMREX_SPACEDIM;</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;        <span class="keywordflow">if</span> (num_samplelines &gt; 0) {</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;            Vector&lt;int&gt; index; index.resize(num_samplelines*AMREX_SPACEDIM);</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;            <a class="code" href="classERF.html#a0fa1582bb13357895d2aba91b695624a">sampleline</a>.resize(num_samplelines);</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160; </div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;            <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.queryarr(<span class="stringliteral">&quot;sample_line&quot;</span>,index,0,num_samplelines*AMREX_SPACEDIM);</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num_samplelines; i++) {</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                IntVect iv(index[AMREX_SPACEDIM*i+0],index[AMREX_SPACEDIM*i+1],index[AMREX_SPACEDIM*i+2]);</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                <a class="code" href="classERF.html#a0fa1582bb13357895d2aba91b695624a">sampleline</a>[i] = iv;</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;            }</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;        }</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160; </div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;        <span class="keywordtype">int</span> num_samplelinelogs = <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.countval(<span class="stringliteral">&quot;sample_line_log&quot;</span>);</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;        AMREX_ALWAYS_ASSERT(num_samplelinelogs == num_samplelines);</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;        <span class="keywordflow">if</span> (num_samplelinelogs &gt; 0) {</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;            <a class="code" href="classERF.html#a4990f1796b65ec8ee602f177a66afc3e">samplelinelog</a>.resize(num_samplelinelogs);</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;            <a class="code" href="classERF.html#a0553967f1131860bb8ecb47c0f192eaa">samplelinelogname</a>.resize(num_samplelinelogs);</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;            <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.queryarr(<span class="stringliteral">&quot;sample_line_log&quot;</span>,<a class="code" href="classERF.html#a0553967f1131860bb8ecb47c0f192eaa">samplelinelogname</a>,0,num_samplelinelogs);</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160; </div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num_samplelinelogs; i++) {</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;                <a class="code" href="classERF.html#ae1a8856961aaee53016122facba03dbe">setRecordSampleLineInfo</a>(i,lev,<a class="code" href="classERF.html#a0fa1582bb13357895d2aba91b695624a">sampleline</a>[i],<a class="code" href="classERF.html#a0553967f1131860bb8ecb47c0f192eaa">samplelinelogname</a>[i]);</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;            }</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;        }</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160; </div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    }</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160; </div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    BL_PROFILE_VAR_STOP(<a class="code" href="classERF.html#ad5d585e110291969767013a515719224">InitData</a>);</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;}</div>
<div class="ttc" id="aDataStruct_8H_html_a62a5a9bde82457a1611cde231a43bfe5a2e32ba26d0dfb8d9502608639fcac451"><div class="ttname"><a href="DataStruct_8H.html#a62a5a9bde82457a1611cde231a43bfe5a2e32ba26d0dfb8d9502608639fcac451">MoistureModelType::Lagrangian</a></div><div class="ttdeci">@ Lagrangian</div></div>
<div class="ttc" id="aDataStruct_8H_html_af82ff6f1edafee12190434b73fe91127a84a8921b25f505d0d2077aeb5db4bc16"><div class="ttname"><a href="DataStruct_8H.html#af82ff6f1edafee12190434b73fe91127a84a8921b25f505d0d2077aeb5db4bc16">TerrainType::Static</a></div><div class="ttdeci">@ Static</div></div>
<div class="ttc" id="aTurbStruct_8H_html_a4a079f2650ca30c787a8375ec5f17ca5abdeb9a753db1d1f3fe0e944eab1d0601"><div class="ttname"><a href="TurbStruct_8H.html#a4a079f2650ca30c787a8375ec5f17ca5abdeb9a753db1d1f3fe0e944eab1d0601">PBLType::MYNN25</a></div><div class="ttdeci">@ MYNN25</div></div>
<div class="ttc" id="aTurbStruct_8H_html_a4a079f2650ca30c787a8375ec5f17ca5ad032bccff1ff2e272cc68da5a0de09fe"><div class="ttname"><a href="TurbStruct_8H.html#a4a079f2650ca30c787a8375ec5f17ca5ad032bccff1ff2e272cc68da5a0de09fe">PBLType::YSU</a></div><div class="ttdeci">@ YSU</div></div>
<div class="ttc" id="aclassERF_html_a039a764a1d942c484e8aea49e87bc046"><div class="ttname"><a href="classERF.html#a039a764a1d942c484e8aea49e87bc046">ERF::initRayleigh</a></div><div class="ttdeci">void initRayleigh()</div><div class="ttdoc">Initialize Rayleigh damping profiles.</div><div class="ttdef"><b>Definition:</b> ERF_init1d.cpp:18</div></div>
<div class="ttc" id="aclassERF_html_a0553967f1131860bb8ecb47c0f192eaa"><div class="ttname"><a href="classERF.html#a0553967f1131860bb8ecb47c0f192eaa">ERF::samplelinelogname</a></div><div class="ttdeci">amrex::Vector&lt; std::string &gt; samplelinelogname</div><div class="ttdef"><b>Definition:</b> ERF.H:1040</div></div>
<div class="ttc" id="aclassERF_html_a0877d5a0263641c13b92d2d16f47b689"><div class="ttname"><a href="classERF.html#a0877d5a0263641c13b92d2d16f47b689">ERF::setRayleighRefFromSounding</a></div><div class="ttdeci">void setRayleighRefFromSounding(bool restarting)</div><div class="ttdoc">Set Rayleigh mean profiles from input sounding.</div><div class="ttdef"><b>Definition:</b> ERF_init1d.cpp:60</div></div>
<div class="ttc" id="aclassERF_html_a0fa1582bb13357895d2aba91b695624a"><div class="ttname"><a href="classERF.html#a0fa1582bb13357895d2aba91b695624a">ERF::sampleline</a></div><div class="ttdeci">amrex::Vector&lt; amrex::IntVect &gt; sampleline</div><div class="ttdef"><b>Definition:</b> ERF.H:1041</div></div>
<div class="ttc" id="aclassERF_html_a1a5d0d0b4e8c196f56dfab98f245aff5"><div class="ttname"><a href="classERF.html#a1a5d0d0b4e8c196f56dfab98f245aff5">ERF::h_w_subsid</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; amrex::Real &gt; &gt; h_w_subsid</div><div class="ttdef"><b>Definition:</b> ERF.H:814</div></div>
<div class="ttc" id="aclassERF_html_a1cf2ba396f4404724824516da4c4a084"><div class="ttname"><a href="classERF.html#a1cf2ba396f4404724824516da4c4a084">ERF::sum_per</a></div><div class="ttdeci">static amrex::Real sum_per</div><div class="ttdef"><b>Definition:</b> ERF.H:760</div></div>
<div class="ttc" id="aclassERF_html_a2486b49bb0d7917f812318822e42a03c"><div class="ttname"><a href="classERF.html#a2486b49bb0d7917f812318822e42a03c">ERF::setRecordDataInfo</a></div><div class="ttdeci">void setRecordDataInfo(int i, const std::string &amp;filename)</div><div class="ttdef"><b>Definition:</b> ERF.H:985</div></div>
<div class="ttc" id="aclassERF_html_a2aa0f6b2edd9efd9b090e39db1effcdf"><div class="ttname"><a href="classERF.html#a2aa0f6b2edd9efd9b090e39db1effcdf">ERF::cc_profiles</a></div><div class="ttdeci">bool cc_profiles</div><div class="ttdef"><b>Definition:</b> ERF.H:698</div></div>
<div class="ttc" id="aclassERF_html_a39efa3a0f3ae3deb7a43f4ce110ee49a"><div class="ttname"><a href="classERF.html#a39efa3a0f3ae3deb7a43f4ce110ee49a">ERF::write_1D_profiles_stag</a></div><div class="ttdeci">void write_1D_profiles_stag(amrex::Real time)</div><div class="ttdef"><b>Definition:</b> ERF_Write1DProfiles_stag.cpp:21</div></div>
<div class="ttc" id="aclassERF_html_a4990f1796b65ec8ee602f177a66afc3e"><div class="ttname"><a href="classERF.html#a4990f1796b65ec8ee602f177a66afc3e">ERF::samplelinelog</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; std::fstream &gt; &gt; samplelinelog</div><div class="ttdef"><b>Definition:</b> ERF.H:1039</div></div>
<div class="ttc" id="aclassERF_html_a5232e98479611a24fe97994640c61faa"><div class="ttname"><a href="classERF.html#a5232e98479611a24fe97994640c61faa">ERF::sum_interval</a></div><div class="ttdeci">static int sum_interval</div><div class="ttdef"><b>Definition:</b> ERF.H:759</div></div>
<div class="ttc" id="aclassERF_html_a530d2ce59e6fd46e9fb00e4d11eaf737"><div class="ttname"><a href="classERF.html#a530d2ce59e6fd46e9fb00e4d11eaf737">ERF::restart</a></div><div class="ttdeci">void restart()</div><div class="ttdef"><b>Definition:</b> ERF.cpp:997</div></div>
<div class="ttc" id="aclassERF_html_a55eae94c5363e227b571739738bb26b7"><div class="ttname"><a href="classERF.html#a55eae94c5363e227b571739738bb26b7">ERF::write_1D_profiles</a></div><div class="ttdeci">void write_1D_profiles(amrex::Real time)</div><div class="ttdef"><b>Definition:</b> ERF_Write1DProfiles.cpp:15</div></div>
<div class="ttc" id="aclassERF_html_a618e8fdff3239cc79d4145d02b1ecaa2"><div class="ttname"><a href="classERF.html#a618e8fdff3239cc79d4145d02b1ecaa2">ERF::init_bcs</a></div><div class="ttdeci">void init_bcs()</div><div class="ttdef"><b>Definition:</b> ERF_init_bcs.cpp:21</div></div>
<div class="ttc" id="aclassERF_html_a7758f75dc7c9029eddc4c58ac0567654"><div class="ttname"><a href="classERF.html#a7758f75dc7c9029eddc4c58ac0567654">ERF::appendPlotVariables</a></div><div class="ttdeci">void appendPlotVariables(const std::string &amp;pp_plot_var_names, amrex::Vector&lt; std::string &gt; &amp;plot_var_names)</div><div class="ttdef"><b>Definition:</b> Plotfile.cpp:85</div></div>
<div class="ttc" id="aclassERF_html_a7c448670f7a5cadd6fe56f7e615c9eb6"><div class="ttname"><a href="classERF.html#a7c448670f7a5cadd6fe56f7e615c9eb6">ERF::output_bndry_planes</a></div><div class="ttdeci">static int output_bndry_planes</div><div class="ttdef"><b>Definition:</b> ERF.H:796</div></div>
<div class="ttc" id="aclassERF_html_a8202de1f8f372e3e6fdc483447c6a55f"><div class="ttname"><a href="classERF.html#a8202de1f8f372e3e6fdc483447c6a55f">ERF::AverageDown</a></div><div class="ttdeci">void AverageDown()</div><div class="ttdef"><b>Definition:</b> ERF.cpp:1493</div></div>
<div class="ttc" id="aclassERF_html_a87e58f16f44a6cb35d6983ed3fe7d3c1"><div class="ttname"><a href="classERF.html#a87e58f16f44a6cb35d6983ed3fe7d3c1">ERF::bndry_output_planes_start_time</a></div><div class="ttdeci">static amrex::Real bndry_output_planes_start_time</div><div class="ttdef"><b>Definition:</b> ERF.H:799</div></div>
<div class="ttc" id="aclassERF_html_a8e758060d3dede9694fbfcabddc17169"><div class="ttname"><a href="classERF.html#a8e758060d3dede9694fbfcabddc17169">ERF::restart_chkfile</a></div><div class="ttdeci">std::string restart_chkfile</div><div class="ttdef"><b>Definition:</b> ERF.H:670</div></div>
<div class="ttc" id="aclassERF_html_a8fbfa8bb47c0a3b53e244081aa1e8ad3"><div class="ttname"><a href="classERF.html#a8fbfa8bb47c0a3b53e244081aa1e8ad3">ERF::sampleptlogname</a></div><div class="ttdeci">amrex::Vector&lt; std::string &gt; sampleptlogname</div><div class="ttdef"><b>Definition:</b> ERF.H:1036</div></div>
<div class="ttc" id="aclassERF_html_a922892a05ee0c5bccd210a3e5a8599e1"><div class="ttname"><a href="classERF.html#a922892a05ee0c5bccd210a3e5a8599e1">ERF::sum_integrated_quantities</a></div><div class="ttdeci">void sum_integrated_quantities(amrex::Real time)</div><div class="ttdef"><b>Definition:</b> ERF_WriteScalarProfiles.cpp:14</div></div>
<div class="ttc" id="aclassERF_html_a9737ddb0de6b9e8a5b17c109d5ad3e08"><div class="ttname"><a href="classERF.html#a9737ddb0de6b9e8a5b17c109d5ad3e08">ERF::sampleptlog</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; std::fstream &gt; &gt; sampleptlog</div><div class="ttdef"><b>Definition:</b> ERF.H:1035</div></div>
<div class="ttc" id="aclassERF_html_aa0c07f31b23d977646b8161e5473fab5"><div class="ttname"><a href="classERF.html#aa0c07f31b23d977646b8161e5473fab5">ERF::start_time</a></div><div class="ttdeci">amrex::Real start_time</div><div class="ttdef"><b>Definition:</b> ERF.H:666</div></div>
<div class="ttc" id="aclassERF_html_aa53035f34ba133b86172e180abda4209"><div class="ttname"><a href="classERF.html#aa53035f34ba133b86172e180abda4209">ERF::m_w2d</a></div><div class="ttdeci">std::unique_ptr&lt; WriteBndryPlanes &gt; m_w2d</div><div class="ttdef"><b>Definition:</b> ERF.H:837</div></div>
<div class="ttc" id="aclassERF_html_ad4c61fad53912d1e8d0f774d365bcf0f"><div class="ttname"><a href="classERF.html#ad4c61fad53912d1e8d0f774d365bcf0f">ERF::is_it_time_for_action</a></div><div class="ttdeci">static bool is_it_time_for_action(int nstep, amrex::Real time, amrex::Real dt, int action_interval, amrex::Real action_per)</div><div class="ttdef"><b>Definition:</b> ERF_WriteScalarProfiles.cpp:399</div></div>
<div class="ttc" id="aclassERF_html_ad5d585e110291969767013a515719224"><div class="ttname"><a href="classERF.html#ad5d585e110291969767013a515719224">ERF::InitData</a></div><div class="ttdeci">void InitData()</div><div class="ttdef"><b>Definition:</b> ERF.cpp:477</div></div>
<div class="ttc" id="aclassERF_html_adc00038dfe4c332e5d15f621184c69e8"><div class="ttname"><a href="classERF.html#adc00038dfe4c332e5d15f621184c69e8">ERF::plot_file_on_restart</a></div><div class="ttdeci">int plot_file_on_restart</div><div class="ttdef"><b>Definition:</b> ERF.H:659</div></div>
<div class="ttc" id="aclassERF_html_adc284f421c5fd9dd15c0e5cbe4ff5fc8"><div class="ttname"><a href="classERF.html#adc284f421c5fd9dd15c0e5cbe4ff5fc8">ERF::Construct_ERFFillPatchers</a></div><div class="ttdeci">void Construct_ERFFillPatchers(int lev)</div><div class="ttdef"><b>Definition:</b> ERF.cpp:1598</div></div>
<div class="ttc" id="aclassERF_html_ae1a8856961aaee53016122facba03dbe"><div class="ttname"><a href="classERF.html#ae1a8856961aaee53016122facba03dbe">ERF::setRecordSampleLineInfo</a></div><div class="ttdeci">void setRecordSampleLineInfo(int i, int lev, amrex::IntVect &amp;cell, const std::string &amp;filename)</div><div class="ttdef"><b>Definition:</b> ERF.H:1015</div></div>
<div class="ttc" id="aclassERF_html_ae8a57b7fbf5a67c99d04b7d4f43ad100"><div class="ttname"><a href="classERF.html#ae8a57b7fbf5a67c99d04b7d4f43ad100">ERF::samplepoint</a></div><div class="ttdeci">amrex::Vector&lt; amrex::IntVect &gt; samplepoint</div><div class="ttdef"><b>Definition:</b> ERF.H:1037</div></div>
<div class="ttc" id="aclassERF_html_af8d930dce1b926ecc3bdc6787dd47818"><div class="ttname"><a href="classERF.html#af8d930dce1b926ecc3bdc6787dd47818">ERF::setRecordSamplePointInfo</a></div><div class="ttdeci">void setRecordSamplePointInfo(int i, int lev, amrex::IntVect &amp;cell, const std::string &amp;filename)</div><div class="ttdef"><b>Definition:</b> ERF.H:998</div></div>
<div class="ttc" id="aclassMicrophysics_html_ac10e6fce2e6cb49373d56ca0e1a5b366"><div class="ttname"><a href="classMicrophysics.html#ac10e6fce2e6cb49373d56ca0e1a5b366">Microphysics::modelType</a></div><div class="ttdeci">static MoistureModelType modelType(const MoistureType a_moisture_type)</div><div class="ttdoc">query if a specified moisture model is Eulerian or Lagrangian</div><div class="ttdef"><b>Definition:</b> Microphysics.H:57</div></div>
<div class="ttc" id="astructSolverChoice_html_ab734eb0a5147b93dc6590038b6decc60"><div class="ttname"><a href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">SolverChoice::terrain_type</a></div><div class="ttdeci">TerrainType terrain_type</div><div class="ttdef"><b>Definition:</b> DataStruct.H:410</div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classMultiBlockContainer.html#a34f2b57ec5aafb88be61d6ffd3dea55c">MultiBlockContainer::InitializeBlocks()</a>, and <a class="el" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_ad5d585e110291969767013a515719224_cgraph.png" border="0" usemap="#aclassERF_ad5d585e110291969767013a515719224_cgraph" alt=""/></div>
<map name="aclassERF_ad5d585e110291969767013a515719224_cgraph" id="aclassERF_ad5d585e110291969767013a515719224_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,112,57"/>
<area shape="rect" href="classMicrophysics.html#ac10e6fce2e6cb49373d56ca0e1a5b366" title="query if a specified moisture model is Eulerian or Lagrangian" alt="" coords="160,5,347,32"/>
<area shape="rect" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469" title=" " alt="" coords="234,56,273,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_ad5d585e110291969767013a515719224_icgraph.png" border="0" usemap="#aclassERF_ad5d585e110291969767013a515719224_icgraph" alt=""/></div>
<map name="aclassERF_ad5d585e110291969767013a515719224_icgraph" id="aclassERF_ad5d585e110291969767013a515719224_icgraph">
<area shape="rect" title=" " alt="" coords="311,42,417,69"/>
<area shape="rect" href="classMultiBlockContainer.html#a34f2b57ec5aafb88be61d6ffd3dea55c" title=" " alt="" coords="108,5,263,47"/>
<area shape="rect" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,42,60,69"/>
</map>
</div>

</div>
</div>
<a id="a92c020bfaa43e40fb5ffc449427a0318"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92c020bfaa43e40fb5ffc449427a0318">&#9670;&nbsp;</a></span>initHSE() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::initHSE </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize HSE. </p>
<div class="fragment"><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;{</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    AMREX_ALWAYS_ASSERT(!<a class="code" href="classERF.html#a2eb81c590271b429f132103c9af25830">init_sounding_ideal</a>);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; lev++)</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    {</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <a class="code" href="classERF.html#a92c020bfaa43e40fb5ffc449427a0318">initHSE</a>(lev);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    }</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a69c8fce3b0f5b28e98240599c2ee16bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69c8fce3b0f5b28e98240599c2ee16bb">&#9670;&nbsp;</a></span>initHSE() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::initHSE </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Initialize density and pressure base state in hydrostatic equilibrium. </p>
<div class="fragment"><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;{</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    MultiFab r_hse (<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev], make_alias, 0, 1); <span class="comment">// r_0  is first  component</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    MultiFab p_hse (<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev], make_alias, 1, 1); <span class="comment">// p_0  is second component</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    MultiFab pi_hse(<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev], make_alias, 2, 1); <span class="comment">// pi_0 is third  component</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="comment">// Initial r_hse may or may not be in HSE -- defined in prob.cpp</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aab88dd74d39b1ad369ae6324e05d7a35">use_moist_background</a>){</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <a class="code" href="classERF.html#a60e8cb933f237903e3fbcd6376c26db0">prob</a>-&gt;erf_init_dens_hse_moist(r_hse, <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev], geom[lev]);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <a class="code" href="classERF.html#a60e8cb933f237903e3fbcd6376c26db0">prob</a>-&gt;erf_init_dens_hse(r_hse, <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev], <a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[lev], geom[lev]);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    }</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="comment">// This integrates up through column to update p_hse, pi_hse;</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="comment">// r_hse is not const b/c FillBoundary is called at the end for r_hse and p_hse</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <a class="code" href="classERF.html#a1f4902e264ff9b48001461c3555c0590">erf_enforce_hse</a>(lev, r_hse, p_hse, pi_hse, <a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[lev], <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev]);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_a1f4902e264ff9b48001461c3555c0590"><div class="ttname"><a href="classERF.html#a1f4902e264ff9b48001461c3555c0590">ERF::erf_enforce_hse</a></div><div class="ttdeci">void erf_enforce_hse(int lev, amrex::MultiFab &amp;dens, amrex::MultiFab &amp;pres, amrex::MultiFab &amp;pi, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;z_cc, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;z_nd)</div><div class="ttdef"><b>Definition:</b> ERF_init1d.cpp:166</div></div>
<div class="ttc" id="astructSolverChoice_html_aab88dd74d39b1ad369ae6324e05d7a35"><div class="ttname"><a href="structSolverChoice.html#aab88dd74d39b1ad369ae6324e05d7a35">SolverChoice::use_moist_background</a></div><div class="ttdeci">bool use_moist_background</div><div class="ttdef"><b>Definition:</b> DataStruct.H:423</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5600f8ce250d4811012719fdf5e85f00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5600f8ce250d4811012719fdf5e85f00">&#9670;&nbsp;</a></span>initialize_integrator()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::initialize_integrator </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>cons_mf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>vel_mf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;{</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <span class="keyword">const</span> BoxArray&amp; ba(cons_mf.boxArray());</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <span class="keyword">const</span> DistributionMapping&amp; dm(cons_mf.DistributionMap());</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160; </div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <span class="keywordtype">int</span> ncomp_cons = cons_mf.nComp();</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160; </div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="comment">// Initialize the integrator memory</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    Vector&lt;MultiFab&gt; int_state; <span class="comment">// integration state data structure example</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    int_state.push_back(MultiFab(cons_mf, make_alias, 0, ncomp_cons));         <span class="comment">// cons</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    int_state.push_back(MultiFab(convert(ba,IntVect(1,0,0)), dm, 1, vel_mf.nGrow())); <span class="comment">// xmom</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    int_state.push_back(MultiFab(convert(ba,IntVect(0,1,0)), dm, 1, vel_mf.nGrow())); <span class="comment">// ymom</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    int_state.push_back(MultiFab(convert(ba,IntVect(0,0,1)), dm, 1, vel_mf.nGrow())); <span class="comment">// zmom</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160; </div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <a class="code" href="classERF.html#a09d0fb2bd609c898a665d9530a744585">mri_integrator_mem</a>[lev] = std::make_unique&lt;MRISplitIntegrator&lt;Vector&lt;MultiFab&gt; &gt; &gt;(int_state);</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <a class="code" href="classERF.html#a09d0fb2bd609c898a665d9530a744585">mri_integrator_mem</a>[lev]-&gt;setNoSubstepping(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a35e0c82996e345337368bc720bbd6070">no_substepping</a>);</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <a class="code" href="classERF.html#a09d0fb2bd609c898a665d9530a744585">mri_integrator_mem</a>[lev]-&gt;setIncompressible(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#af39df4d1618645dcc1fb8678f738e3f0">incompressible</a>);</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <a class="code" href="classERF.html#a09d0fb2bd609c898a665d9530a744585">mri_integrator_mem</a>[lev]-&gt;setNcompCons(ncomp_cons);</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    <a class="code" href="classERF.html#a09d0fb2bd609c898a665d9530a744585">mri_integrator_mem</a>[lev]-&gt;setForceFirstStageSingleSubstep(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a3f8ae511632557066f6662eec79591e1">force_stage1_single_substep</a>);</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2e1874d47d95c7c858c2a2336fd0eee6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e1874d47d95c7c858c2a2336fd0eee6">&#9670;&nbsp;</a></span>InitializeFromFile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::InitializeFromFile </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a914f576acc2d1a54203a220cce10df62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a914f576acc2d1a54203a220cce10df62">&#9670;&nbsp;</a></span>InitializeLevelFromData()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::InitializeLevelFromData </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>initial_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="afc2898daad269536c1a15443abf3fa75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc2898daad269536c1a15443abf3fa75">&#9670;&nbsp;</a></span>initializeMicrophysics()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::initializeMicrophysics </td>
          <td>(</td>
          <td class="paramtype">const int &amp;&#160;</td>
          <td class="paramname"><em>a_nlevsmax</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a_nlevsmax</td><td>number of AMR levels </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;{</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classMicrophysics.html#ac10e6fce2e6cb49373d56ca0e1a5b366">Microphysics::modelType</a>(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a>) == <a class="code" href="DataStruct_8H.html#a62a5a9bde82457a1611cde231a43bfe5aff01d2011cc56dfe241e0002bb9df778">MoistureModelType::Eulerian</a>) {</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160; </div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;        <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a> = std::make_unique&lt;EulerianMicrophysics&gt;(a_nlevsmax, <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a>);</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160; </div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classMicrophysics.html#ac10e6fce2e6cb49373d56ca0e1a5b366">Microphysics::modelType</a>(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a>) == <a class="code" href="DataStruct_8H.html#a62a5a9bde82457a1611cde231a43bfe5a2e32ba26d0dfb8d9502608639fcac451">MoistureModelType::Lagrangian</a>) {</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="preprocessor">#ifdef ERF_USE_PARTICLES</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160; </div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;        <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a> = std::make_unique&lt;LagrangianMicrophysics&gt;(a_nlevsmax, <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a>);</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;        <span class="comment">/* Lagrangian microphysics models will have a particle container; it needs to be added</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;<span class="comment">           to ERF::particleData */</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span>&amp; pc_name( <span class="keyword">dynamic_cast&lt;</span>LagrangianMicrophysics&amp;<span class="keyword">&gt;</span>(*micro).getName() );</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        <span class="comment">/* The particle container has not yet been constructed and initialized, so just add</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="comment">           its name here for now (so that functions to set plotting variables can see it). */</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;        particleData.addName( pc_name );</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160; </div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;        Abort(<span class="stringliteral">&quot;Lagrangian microphysics can be used when compiled with ERF_USE_PARTICLES&quot;</span>);</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    }</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160; </div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    <a class="code" href="classERF.html#ae00126a9c2738bf6a6cbbe77321c9cfc">qmoist</a>.resize(a_nlevsmax);</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;}</div>
<div class="ttc" id="aDataStruct_8H_html_a62a5a9bde82457a1611cde231a43bfe5aff01d2011cc56dfe241e0002bb9df778"><div class="ttname"><a href="DataStruct_8H.html#a62a5a9bde82457a1611cde231a43bfe5aff01d2011cc56dfe241e0002bb9df778">MoistureModelType::Eulerian</a></div><div class="ttdeci">@ Eulerian</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_afc2898daad269536c1a15443abf3fa75_cgraph.png" border="0" usemap="#aclassERF_afc2898daad269536c1a15443abf3fa75_cgraph" alt=""/></div>
<map name="aclassERF_afc2898daad269536c1a15443abf3fa75_cgraph" id="aclassERF_afc2898daad269536c1a15443abf3fa75_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,200,32"/>
<area shape="rect" href="classMicrophysics.html#ac10e6fce2e6cb49373d56ca0e1a5b366" title="query if a specified moisture model is Eulerian or Lagrangian" alt="" coords="248,5,435,32"/>
</map>
</div>

</div>
</div>
<a id="a039a764a1d942c484e8aea49e87bc046"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a039a764a1d942c484e8aea49e87bc046">&#9670;&nbsp;</a></span>initRayleigh()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::initRayleigh </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize Rayleigh damping profiles. </p>
<p>Initialization function for host and device vectors used to store averaged quantities when calculating the effects of Rayleigh Damping. </p>
<div class="fragment"><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;{</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    AMREX_ALWAYS_ASSERT(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a27ced9266434a4680ef175e7b2ba8f01">use_rayleigh_damping</a>);</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <a class="code" href="classERF.html#ad9939824ea7b7d06ab252fed28d5a911">h_rayleigh_ptrs</a>.resize(max_level+1);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <a class="code" href="classERF.html#ad598bde8e728479faaa7c2820096b47a">d_rayleigh_ptrs</a>.resize(max_level+1);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; lev++)</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    {</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        <span class="comment">// These have 5 components: tau, ubar, vbar, wbar, thetabar</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        <a class="code" href="classERF.html#ad9939824ea7b7d06ab252fed28d5a911">h_rayleigh_ptrs</a>[lev].resize(<a class="code" href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a7c3c83d6fcec1f134956c3160adf6e39">Rayleigh::nvars</a>);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        <a class="code" href="classERF.html#ad598bde8e728479faaa7c2820096b47a">d_rayleigh_ptrs</a>[lev].resize(<a class="code" href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a7c3c83d6fcec1f134956c3160adf6e39">Rayleigh::nvars</a>);</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        AMREX_ALWAYS_ASSERT(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a27ced9266434a4680ef175e7b2ba8f01">use_rayleigh_damping</a>);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> zlen_rayleigh = geom[lev].Domain().length(2);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        <span class="comment">// Allocate space for these 1D vectors</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; <a class="code" href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a7c3c83d6fcec1f134956c3160adf6e39">Rayleigh::nvars</a>; n++) {</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;            <a class="code" href="classERF.html#ad9939824ea7b7d06ab252fed28d5a911">h_rayleigh_ptrs</a>[lev][n].resize(zlen_rayleigh, 0.0_rt);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;            <a class="code" href="classERF.html#ad598bde8e728479faaa7c2820096b47a">d_rayleigh_ptrs</a>[lev][n].resize(zlen_rayleigh, 0.0_rt);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        }</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        <span class="comment">// Init the host vectors</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        <a class="code" href="classERF.html#a60e8cb933f237903e3fbcd6376c26db0">prob</a>-&gt;erf_init_rayleigh(<a class="code" href="classERF.html#ad9939824ea7b7d06ab252fed28d5a911">h_rayleigh_ptrs</a>[lev], geom[lev], <a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[lev]);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        <span class="comment">// Copy from host vectors to device vectors</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; <a class="code" href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a7c3c83d6fcec1f134956c3160adf6e39">Rayleigh::nvars</a>; n++) {</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;            Gpu::copy(Gpu::hostToDevice, <a class="code" href="classERF.html#ad9939824ea7b7d06ab252fed28d5a911">h_rayleigh_ptrs</a>[lev][n].begin(), <a class="code" href="classERF.html#ad9939824ea7b7d06ab252fed28d5a911">h_rayleigh_ptrs</a>[lev][n].end(),</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                      <a class="code" href="classERF.html#ad598bde8e728479faaa7c2820096b47a">d_rayleigh_ptrs</a>[lev][n].begin());</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        }</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    }</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_ad9939824ea7b7d06ab252fed28d5a911"><div class="ttname"><a href="classERF.html#ad9939824ea7b7d06ab252fed28d5a911">ERF::h_rayleigh_ptrs</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; amrex::Vector&lt; amrex::Real &gt; &gt; &gt; h_rayleigh_ptrs</div><div class="ttdef"><b>Definition:</b> ERF.H:818</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad4c61fad53912d1e8d0f774d365bcf0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4c61fad53912d1e8d0f774d365bcf0f">&#9670;&nbsp;</a></span>is_it_time_for_action()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool ERF::is_it_time_for_action </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nstep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>action_interval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>action_per</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Helper function which uses the current step number, time, and timestep to determine whether it is time to take an action specified at every interval of timesteps.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nstep</td><td>Timestep number </td></tr>
    <tr><td class="paramname">time</td><td>Current time </td></tr>
    <tr><td class="paramname">dtlev</td><td>Timestep for the current level </td></tr>
    <tr><td class="paramname">action_interval</td><td>Interval in number of timesteps for taking action </td></tr>
    <tr><td class="paramname">action_per</td><td>Interval in simulation time for taking action </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;{</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <span class="keywordtype">bool</span> int_test = (action_interval &gt; 0 &amp;&amp; nstep % action_interval == 0);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160; </div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <span class="keywordtype">bool</span> per_test = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  <span class="keywordflow">if</span> (action_per &gt; 0.0) {</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> num_per_old = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(amrex::Math::floor((time - dtlev) / action_per));</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> num_per_new = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(amrex::Math::floor((time) / action_per));</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160; </div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keywordflow">if</span> (num_per_old != num_per_new) {</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      per_test = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    }</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  }</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160; </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <span class="keywordflow">return</span> int_test || per_test;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a93ed2dd2c2441da6853d6f48b6467324"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93ed2dd2c2441da6853d6f48b6467324">&#9670;&nbsp;</a></span>MakeDiagnosticAverage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::MakeDiagnosticAverage </td>
          <td>(</td>
          <td class="paramtype">amrex::Vector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_havg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>S</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;{</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;    <span class="comment">// Get the number of cells in z at level 0</span></div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    <span class="keywordtype">int</span> dir_z = AMREX_SPACEDIM-1;</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    <span class="keyword">auto</span> domain = geom[0].Domain();</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;    <span class="keywordtype">int</span> size_z = domain.length(dir_z);</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;    <span class="keywordtype">int</span> start_z = domain.smallEnd()[dir_z];</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;    Real area_z = <span class="keyword">static_cast&lt;</span>Real<span class="keyword">&gt;</span>(domain.length(0)*domain.length(1));</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160; </div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;    <span class="comment">// resize the level 0 horizontal average vectors</span></div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;    h_havg.resize(size_z, 0.0_rt);</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160; </div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;    <span class="comment">// Get the cell centered data and construct sums</span></div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;<span class="preprocessor">#pragma omp parallel if (Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;    <span class="keywordflow">for</span> (MFIter mfi(S); mfi.isValid(); ++mfi) {</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;        <span class="keyword">const</span> Box&amp; box = mfi.validbox();</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;        <span class="keyword">const</span> IntVect&amp; se = box.smallEnd();</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;        <span class="keyword">const</span> IntVect&amp; be = box.bigEnd();</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160; </div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;        <span class="keyword">auto</span>      fab_arr = S[mfi].array();</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160; </div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;        FArrayBox fab_reduce(box, 1, The_Async_Arena());</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;        <span class="keyword">auto</span> arr_reduce   = fab_reduce.array();</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160; </div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;        ParallelFor(box, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) {</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;            arr_reduce(i, j, k, 0) = fab_arr(i,j,k,n);</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;        });</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160; </div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=se[dir_z]; k &lt;= be[dir_z]; ++k) {</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;            Box kbox(box); kbox.setSmall(dir_z,k); kbox.setBig(dir_z,k);</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;            h_havg[k-start_z] += fab_reduce.sum&lt;RunOn::Device&gt;(kbox,0);</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;        }</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;    }</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160; </div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    <span class="comment">// combine sums from different MPI ranks</span></div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    ParallelDescriptor::ReduceRealSum(h_havg.dataPtr(), h_havg.size());</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160; </div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;    <span class="comment">// divide by the total number of cells we are averaging over</span></div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; size_z; ++k) {</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;        h_havg[k]     /= area_z;</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    }</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a01987b2556834788694f2f3741a2afe4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01987b2556834788694f2f3741a2afe4">&#9670;&nbsp;</a></span>MakeHorizontalAverages()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::MakeHorizontalAverages </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;{</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;    <span class="keywordtype">int</span> lev = 0;</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160; </div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    <span class="comment">// First, average down all levels (if doing two-way coupling)</span></div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#af976afa61859c07e6249963edc367c2d">coupling_type</a> == <a class="code" href="DataStruct_8H.html#ad285be248c0803917aaf5cf8ce62139ba6c267346f8ebb889610a5a90838be815">CouplingType::TwoWay</a>) {</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;        <a class="code" href="classERF.html#a8202de1f8f372e3e6fdc483447c6a55f">AverageDown</a>();</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;    }</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160; </div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;    MultiFab mf(grids[lev], dmap[lev], 5, 0);</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160; </div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;    <span class="keywordtype">int</span> zdir = 2;</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;    <span class="keyword">auto</span> domain = geom[0].Domain();</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160; </div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;    <span class="keywordtype">bool</span> use_moisture = (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> != <a class="code" href="DataStruct_8H.html#ab34704153a585940411c26587cb82ad0a6adf97f83acf6453d4a6a4b1070f3754">MoistureType::None</a>);</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160; </div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;    <span class="keywordflow">for</span> (MFIter mfi(mf); mfi.isValid(); ++mfi) {</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;        <span class="keyword">const</span> Box&amp; bx = mfi.validbox();</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;        <span class="keyword">auto</span>  fab_arr = mf.array(mfi);</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;        <span class="keyword">auto</span> <span class="keyword">const</span> cons_arr = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].const_array(mfi);</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;        ParallelFor(bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) {</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;            Real dens = cons_arr(i, j, k, <a class="code" href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>);</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;            fab_arr(i, j, k, 0) = dens;</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;            fab_arr(i, j, k, 1) = cons_arr(i, j, k, <a class="code" href="IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>) / dens;</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;            <span class="keywordflow">if</span> (!use_moisture) {</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;                fab_arr(i, j, k, 2) = <a class="code" href="EOS_8H.html#a08354ab110fb9e873bce9250b4f4b46e">getPgivenRTh</a>(cons_arr(i, j, k, <a class="code" href="IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>));</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;            }</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;        });</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;    }</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160; </div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    <span class="keywordflow">if</span> (use_moisture)</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    {</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;        <span class="keywordflow">for</span> (MFIter mfi(mf); mfi.isValid(); ++mfi) {</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;            <span class="keyword">const</span> Box&amp; bx = mfi.validbox();</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;            <span class="keyword">auto</span>  fab_arr = mf.array(mfi);</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;            <span class="keyword">auto</span> <span class="keyword">const</span> cons_arr = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].const_array(mfi);</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;            <span class="keyword">auto</span> <span class="keyword">const</span>   qv_arr = <a class="code" href="classERF.html#ae00126a9c2738bf6a6cbbe77321c9cfc">qmoist</a>[lev][0]-&gt;const_array(mfi);</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;            <span class="keywordtype">int</span> ncomp = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nComp();</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160; </div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;            ParallelFor(bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) {</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;                Real dens = cons_arr(i, j, k, <a class="code" href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>);</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;                fab_arr(i, j, k, 2) = <a class="code" href="EOS_8H.html#a08354ab110fb9e873bce9250b4f4b46e">getPgivenRTh</a>(cons_arr(i, j, k, <a class="code" href="IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>), qv_arr(i,j,k));</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;                fab_arr(i, j, k, 3) = (ncomp &gt; <a class="code" href="IndexDefines_8H.html#aa965e9988f14d5d2a5aef4a942168a15">RhoQ1_comp</a> ? cons_arr(i, j, k, <a class="code" href="IndexDefines_8H.html#aa965e9988f14d5d2a5aef4a942168a15">RhoQ1_comp</a>) / dens : 0.0);</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;                fab_arr(i, j, k, 4) = (ncomp &gt; <a class="code" href="IndexDefines_8H.html#a3bf0a4783e82ba30db2b7c0a332c2f16">RhoQ2_comp</a> ? cons_arr(i, j, k, <a class="code" href="IndexDefines_8H.html#a3bf0a4783e82ba30db2b7c0a332c2f16">RhoQ2_comp</a>) / dens : 0.0);</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;            });</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;        }</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160; </div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;        Gpu::HostVector&lt;Real&gt; h_avg_qv          = sumToLine(mf,3,1,domain,zdir);</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;        Gpu::HostVector&lt;Real&gt; h_avg_qc          = sumToLine(mf,4,1,domain,zdir);</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;    }</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160; </div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;    <span class="comment">// Sum in the horizontal plane</span></div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    Gpu::HostVector&lt;Real&gt; h_avg_density     = sumToLine(mf,0,1,domain,zdir);</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;    Gpu::HostVector&lt;Real&gt; h_avg_temperature = sumToLine(mf,1,1,domain,zdir);</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;    Gpu::HostVector&lt;Real&gt; h_avg_pressure    = sumToLine(mf,2,1,domain,zdir);</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160; </div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    <span class="comment">// Divide by the total number of cells we are averaging over</span></div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    <span class="keywordtype">int</span> size_z = domain.length(zdir);</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    Real area_z = <span class="keyword">static_cast&lt;</span>Real<span class="keyword">&gt;</span>(domain.length(0)*domain.length(1));</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    <span class="keywordtype">int</span> klen = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(h_avg_density.size());</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160; </div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; klen; ++k) {</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;        <a class="code" href="classERF.html#a4dd7c603e65d230105a4f1e0afb4cf8a">h_havg_density</a>[k]     /= area_z;</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;        <a class="code" href="classERF.html#a9683c7b07c287e57856ee5a9c99917a1">h_havg_temperature</a>[k] /= area_z;</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;        <a class="code" href="classERF.html#a413293737b0021c97b50c62756561446">h_havg_pressure</a>[k]    /= area_z;</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> != <a class="code" href="DataStruct_8H.html#ab34704153a585940411c26587cb82ad0a6adf97f83acf6453d4a6a4b1070f3754">MoistureType::None</a>)</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;        {</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;            <a class="code" href="classERF.html#a45233bcc95ac50c112b7146595164a8d">h_havg_qc</a>[k]          /= area_z;</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;            <a class="code" href="classERF.html#ae8de26569516b41e5dc3cbb3419e891c">h_havg_qv</a>[k]          /= area_z;</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;        }</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    } <span class="comment">// k</span></div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160; </div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;    <span class="comment">// resize device vectors</span></div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;    <a class="code" href="classERF.html#a84cf7616e7b3928f08f4bd56112db01e">d_havg_density</a>.resize(size_z, 0.0_rt);</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    <a class="code" href="classERF.html#a20350959b7b3e252ee3a802e7998ca8d">d_havg_temperature</a>.resize(size_z, 0.0_rt);</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;    <a class="code" href="classERF.html#a9a4f076c56f31fbb5e68c09706605a05">d_havg_pressure</a>.resize(size_z, 0.0_rt);</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160; </div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;    <span class="comment">// copy host vectors to device vectors</span></div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;    Gpu::copy(Gpu::hostToDevice, <a class="code" href="classERF.html#a4dd7c603e65d230105a4f1e0afb4cf8a">h_havg_density</a>.begin(), <a class="code" href="classERF.html#a4dd7c603e65d230105a4f1e0afb4cf8a">h_havg_density</a>.end(), <a class="code" href="classERF.html#a84cf7616e7b3928f08f4bd56112db01e">d_havg_density</a>.begin());</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    Gpu::copy(Gpu::hostToDevice, <a class="code" href="classERF.html#a9683c7b07c287e57856ee5a9c99917a1">h_havg_temperature</a>.begin(), <a class="code" href="classERF.html#a9683c7b07c287e57856ee5a9c99917a1">h_havg_temperature</a>.end(), <a class="code" href="classERF.html#a20350959b7b3e252ee3a802e7998ca8d">d_havg_temperature</a>.begin());</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;    Gpu::copy(Gpu::hostToDevice, <a class="code" href="classERF.html#a413293737b0021c97b50c62756561446">h_havg_pressure</a>.begin(), <a class="code" href="classERF.html#a413293737b0021c97b50c62756561446">h_havg_pressure</a>.end(), <a class="code" href="classERF.html#a9a4f076c56f31fbb5e68c09706605a05">d_havg_pressure</a>.begin());</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160; </div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> != <a class="code" href="DataStruct_8H.html#ab34704153a585940411c26587cb82ad0a6adf97f83acf6453d4a6a4b1070f3754">MoistureType::None</a>)</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;    {</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;        <a class="code" href="classERF.html#a2b0085123e02051ac4c2a72e9972e6ee">d_havg_qv</a>.resize(size_z, 0.0_rt);</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;        <a class="code" href="classERF.html#a8199cc1ec38b9dfd47262ccc7df6a941">d_havg_qc</a>.resize(size_z, 0.0_rt);</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;        Gpu::copy(Gpu::hostToDevice, <a class="code" href="classERF.html#ae8de26569516b41e5dc3cbb3419e891c">h_havg_qv</a>.begin(), <a class="code" href="classERF.html#ae8de26569516b41e5dc3cbb3419e891c">h_havg_qv</a>.end(), <a class="code" href="classERF.html#a2b0085123e02051ac4c2a72e9972e6ee">d_havg_qv</a>.begin());</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;        Gpu::copy(Gpu::hostToDevice, <a class="code" href="classERF.html#a45233bcc95ac50c112b7146595164a8d">h_havg_qc</a>.begin(), <a class="code" href="classERF.html#a45233bcc95ac50c112b7146595164a8d">h_havg_qc</a>.end(), <a class="code" href="classERF.html#a8199cc1ec38b9dfd47262ccc7df6a941">d_havg_qc</a>.begin());</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;    }</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_a20350959b7b3e252ee3a802e7998ca8d"><div class="ttname"><a href="classERF.html#a20350959b7b3e252ee3a802e7998ca8d">ERF::d_havg_temperature</a></div><div class="ttdeci">amrex::Gpu::DeviceVector&lt; amrex::Real &gt; d_havg_temperature</div><div class="ttdef"><b>Definition:</b> ERF.H:830</div></div>
<div class="ttc" id="aclassERF_html_a2b0085123e02051ac4c2a72e9972e6ee"><div class="ttname"><a href="classERF.html#a2b0085123e02051ac4c2a72e9972e6ee">ERF::d_havg_qv</a></div><div class="ttdeci">amrex::Gpu::DeviceVector&lt; amrex::Real &gt; d_havg_qv</div><div class="ttdef"><b>Definition:</b> ERF.H:832</div></div>
<div class="ttc" id="aclassERF_html_a413293737b0021c97b50c62756561446"><div class="ttname"><a href="classERF.html#a413293737b0021c97b50c62756561446">ERF::h_havg_pressure</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Real &gt; h_havg_pressure</div><div class="ttdef"><b>Definition:</b> ERF.H:825</div></div>
<div class="ttc" id="aclassERF_html_a45233bcc95ac50c112b7146595164a8d"><div class="ttname"><a href="classERF.html#a45233bcc95ac50c112b7146595164a8d">ERF::h_havg_qc</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Real &gt; h_havg_qc</div><div class="ttdef"><b>Definition:</b> ERF.H:827</div></div>
<div class="ttc" id="aclassERF_html_a4dd7c603e65d230105a4f1e0afb4cf8a"><div class="ttname"><a href="classERF.html#a4dd7c603e65d230105a4f1e0afb4cf8a">ERF::h_havg_density</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Real &gt; h_havg_density</div><div class="ttdef"><b>Definition:</b> ERF.H:823</div></div>
<div class="ttc" id="aclassERF_html_a8199cc1ec38b9dfd47262ccc7df6a941"><div class="ttname"><a href="classERF.html#a8199cc1ec38b9dfd47262ccc7df6a941">ERF::d_havg_qc</a></div><div class="ttdeci">amrex::Gpu::DeviceVector&lt; amrex::Real &gt; d_havg_qc</div><div class="ttdef"><b>Definition:</b> ERF.H:833</div></div>
<div class="ttc" id="aclassERF_html_a84cf7616e7b3928f08f4bd56112db01e"><div class="ttname"><a href="classERF.html#a84cf7616e7b3928f08f4bd56112db01e">ERF::d_havg_density</a></div><div class="ttdeci">amrex::Gpu::DeviceVector&lt; amrex::Real &gt; d_havg_density</div><div class="ttdef"><b>Definition:</b> ERF.H:829</div></div>
<div class="ttc" id="aclassERF_html_a9683c7b07c287e57856ee5a9c99917a1"><div class="ttname"><a href="classERF.html#a9683c7b07c287e57856ee5a9c99917a1">ERF::h_havg_temperature</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Real &gt; h_havg_temperature</div><div class="ttdef"><b>Definition:</b> ERF.H:824</div></div>
<div class="ttc" id="aclassERF_html_a9a4f076c56f31fbb5e68c09706605a05"><div class="ttname"><a href="classERF.html#a9a4f076c56f31fbb5e68c09706605a05">ERF::d_havg_pressure</a></div><div class="ttdeci">amrex::Gpu::DeviceVector&lt; amrex::Real &gt; d_havg_pressure</div><div class="ttdef"><b>Definition:</b> ERF.H:831</div></div>
<div class="ttc" id="aclassERF_html_ae8de26569516b41e5dc3cbb3419e891c"><div class="ttname"><a href="classERF.html#ae8de26569516b41e5dc3cbb3419e891c">ERF::h_havg_qv</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Real &gt; h_havg_qv</div><div class="ttdef"><b>Definition:</b> ERF.H:826</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a01987b2556834788694f2f3741a2afe4_cgraph.png" border="0" usemap="#aclassERF_a01987b2556834788694f2f3741a2afe4_cgraph" alt=""/></div>
<map name="aclassERF_a01987b2556834788694f2f3741a2afe4_cgraph" id="aclassERF_a01987b2556834788694f2f3741a2afe4_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,221,32"/>
<area shape="rect" href="EOS_8H.html#a08354ab110fb9e873bce9250b4f4b46e" title=" " alt="" coords="269,5,380,32"/>
</map>
</div>

</div>
</div>
<a id="abb6175c28b36d23f5dda2994ca4a85e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb6175c28b36d23f5dda2994ca4a85e7">&#9670;&nbsp;</a></span>MakeNewLevelFromCoarse()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::MakeNewLevelFromCoarse </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::BoxArray &amp;&#160;</td>
          <td class="paramname"><em>ba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::DistributionMapping &amp;&#160;</td>
          <td class="paramname"><em>dm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;{</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    AMREX_ALWAYS_ASSERT(lev &gt; 0);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; crse_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev-1];</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;          <span class="keyword">auto</span>&amp;  lev_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev];</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;          <span class="keyword">auto</span>&amp;  lev_old = <a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev];</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordtype">int</span> ncomp = lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nComp();</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="comment">// These are the persistent containers for the old and new data</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].define(ba, dm, crse_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nComp(), crse_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nGrowVect());</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    lev_old[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].define(ba, dm, crse_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nComp(), crse_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nGrowVect());</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].define(convert(ba, IntVect(1,0,0)), dm, 1, crse_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].nGrowVect());</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    lev_old[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].define(convert(ba, IntVect(1,0,0)), dm, 1, crse_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].nGrowVect());</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].define(convert(ba, IntVect(0,1,0)), dm, 1, crse_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].nGrowVect());</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    lev_old[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].define(convert(ba, IntVect(0,1,0)), dm, 1, crse_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].nGrowVect());</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].define(convert(ba, IntVect(0,0,1)), dm, 1, crse_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].nGrowVect());</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    lev_old[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].define(convert(ba, IntVect(0,0,1)), dm, 1, crse_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].nGrowVect());</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="comment">//********************************************************************************************</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="comment">// Microphysics</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="comment">// *******************************************************************************************</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordtype">int</span> q_size  = <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;Get_Qmoist_Size(lev);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <a class="code" href="classERF.html#ae00126a9c2738bf6a6cbbe77321c9cfc">qmoist</a>[lev].resize(q_size);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;Define(lev, <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> != <a class="code" href="DataStruct_8H.html#ab34704153a585940411c26587cb82ad0a6adf97f83acf6453d4a6a4b1070f3754">MoistureType::None</a>)</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;Init(lev, <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], grids[lev], Geom(lev), 0.0); <span class="comment">// dummy dt value</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    }</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> mvar(0); mvar&lt;<a class="code" href="classERF.html#ae00126a9c2738bf6a6cbbe77321c9cfc">qmoist</a>[lev].size(); ++mvar) {</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        <a class="code" href="classERF.html#ae00126a9c2738bf6a6cbbe77321c9cfc">qmoist</a>[lev][mvar] = <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;Get_Qmoist_Ptr(lev,mvar);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    }</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160; </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <a class="code" href="classERF.html#a5160b1e054b3e2a09c26274ef3551c64">init_stuff</a>(lev, ba, dm);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev] = time;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <a class="code" href="classERF.html#a7085d7d5fc94a0f84efc06957267d58e">t_old</a>[lev] = time - 1.e200;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="comment">// Build the data structures for terrain-related quantities</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <a class="code" href="classERF.html#a900a0119c110486650f2759287e22cba">update_terrain_arrays</a>(lev, time);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160; </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="comment">// Update the base state at this level</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].define(ba,dm,3,1);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].setVal(0.);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <a class="code" href="classERF.html#a92c020bfaa43e40fb5ffc449427a0318">initHSE</a>(lev);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="comment">// Build the data structures for calculating diffusive/turbulent terms</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <a class="code" href="classERF.html#a419510fced05e9afc05c466beeeb66f7">update_diffusive_arrays</a>(lev, ba, dm);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="comment">// Initialize flux register at new level</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#af976afa61859c07e6249963edc367c2d">coupling_type</a> == <a class="code" href="DataStruct_8H.html#ad285be248c0803917aaf5cf8ce62139ba6c267346f8ebb889610a5a90838be815">CouplingType::TwoWay</a>) {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <a class="code" href="classERF.html#a86a0bc8e41668411ee0ab5801d4688a7">advflux_reg</a>.resize(lev+1);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <a class="code" href="classERF.html#a86a0bc8e41668411ee0ab5801d4688a7">advflux_reg</a>[lev] = <span class="keyword">new</span> YAFluxRegister(ba, grids[lev-1],</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                                              dm,  dmap[lev-1],</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                                              geom[lev],  geom[lev-1],</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                                              ref_ratio[lev-1], lev, ncomp);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="comment">// *****************************************************************************************************</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="comment">// Initialize the boundary conditions (after initializing the terrain but before calling FillCoarsePatch</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="comment">// *****************************************************************************************************</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <a class="code" href="classERF.html#a2e9b04043853d25f2d76edbc0bed2e72">physbcs_cons</a>[lev] = std::make_unique&lt;ERFPhysBCFunct_cons&gt; (lev, geom[lev], <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>, <a class="code" href="classERF.html#a8a99e22b1111c803e31b4afd5fcdea60">domain_bcs_type_d</a>,</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                                                               <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>, <a class="code" href="classERF.html#a69ea003766c97b1a667b002b3661f0f2">m_bc_neumann_vals</a>,</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                                                               <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev], <a class="code" href="classERF.html#a86208285bf705f360a3c318a75097f61">use_real_bcs</a>);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <a class="code" href="classERF.html#a64e55e5ae9df06433146db657eb9e72e">physbcs_u</a>[lev]    = std::make_unique&lt;ERFPhysBCFunct_u&gt; (lev, geom[lev], <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>, <a class="code" href="classERF.html#a8a99e22b1111c803e31b4afd5fcdea60">domain_bcs_type_d</a>,</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                                                            <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>, <a class="code" href="classERF.html#a69ea003766c97b1a667b002b3661f0f2">m_bc_neumann_vals</a>,</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                                                            <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev], <a class="code" href="classERF.html#a86208285bf705f360a3c318a75097f61">use_real_bcs</a>);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <a class="code" href="classERF.html#a79231b5cfd4576a742e46ae0082b5121">physbcs_v</a>[lev]    = std::make_unique&lt;ERFPhysBCFunct_v&gt; (lev, geom[lev], <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>, <a class="code" href="classERF.html#a8a99e22b1111c803e31b4afd5fcdea60">domain_bcs_type_d</a>,</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                                                            <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>, <a class="code" href="classERF.html#a69ea003766c97b1a667b002b3661f0f2">m_bc_neumann_vals</a>,</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                                                            <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev], <a class="code" href="classERF.html#a86208285bf705f360a3c318a75097f61">use_real_bcs</a>);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <a class="code" href="classERF.html#a45c8ecd777f47732993777a0afb8e140">physbcs_w</a>[lev]    = std::make_unique&lt;ERFPhysBCFunct_w&gt; (lev, geom[lev], <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>, <a class="code" href="classERF.html#a8a99e22b1111c803e31b4afd5fcdea60">domain_bcs_type_d</a>,</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                                                            <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>, <a class="code" href="classERF.html#a69ea003766c97b1a667b002b3661f0f2">m_bc_neumann_vals</a>,</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                                                            <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a>, <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev], <a class="code" href="classERF.html#a86208285bf705f360a3c318a75097f61">use_real_bcs</a>);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <a class="code" href="classERF.html#a4d717bb9fe936fd1a124d0d3e720f9d1">physbcs_w_no_terrain</a>[lev]    = std::make_unique&lt;ERFPhysBCFunct_w_no_terrain&gt;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                                                           (lev, geom[lev], <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>, <a class="code" href="classERF.html#a8a99e22b1111c803e31b4afd5fcdea60">domain_bcs_type_d</a>,</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                                                            <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>, <a class="code" href="classERF.html#a69ea003766c97b1a667b002b3661f0f2">m_bc_neumann_vals</a>, <a class="code" href="classERF.html#a86208285bf705f360a3c318a75097f61">use_real_bcs</a>);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="comment">// Fill data at the new level by interpolation from the coarser level</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="comment">// Note that internal to FillCoarsePatch we will convert velocity to momentum,</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="comment">//      then interpolate momentum, then convert momentum back to velocity</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="comment">// Also note that FillCoarsePatch is hard-wired to act only on lev_new at coarse and fine</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <a class="code" href="classERF.html#ac4497025ab94461899960ee067c2c72a">FillCoarsePatch</a>(lev, time);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="comment">// Initialize the integrator class</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <a class="code" href="classERF.html#a3cf7cb2e51eb7b69cb4079ffc6722459">dt_mri_ratio</a>[lev] = <a class="code" href="classERF.html#a3cf7cb2e51eb7b69cb4079ffc6722459">dt_mri_ratio</a>[lev-1];</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <a class="code" href="classERF.html#a5600f8ce250d4811012719fdf5e85f00">initialize_integrator</a>(lev, lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>]);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160; </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="comment">// If we are making a new level then the FillPatcher for this level hasn&#39;t been allocated yet</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ad9084179f7384e10a519989ffd51fd34">cf_width</a> &gt;= 0) {</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        <a class="code" href="classERF.html#adc284f421c5fd9dd15c0e5cbe4ff5fc8">Construct_ERFFillPatchers</a>(lev);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;           <a class="code" href="classERF.html#ac0951404aa6802aad7a3be6b7375dfa2">Define_ERFFillPatchers</a>(lev);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    }</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160; </div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="comment">// Make sure that detJ and z_phys_cc are the average of the data on a finer level if there is one</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a063a88594452100497651e8aaf1f68d7">use_terrain</a> != 0) {</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> crse_lev = lev-1; crse_lev &gt;= 0; crse_lev--) {</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            average_down(  *<a class="code" href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">detJ_cc</a>[crse_lev+1],   *<a class="code" href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">detJ_cc</a>[crse_lev], 0, 1, refRatio(crse_lev));</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            average_down(*<a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[crse_lev+1], *<a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[crse_lev], 0, 1, refRatio(crse_lev));</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        }</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    }</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_a419510fced05e9afc05c466beeeb66f7"><div class="ttname"><a href="classERF.html#a419510fced05e9afc05c466beeeb66f7">ERF::update_diffusive_arrays</a></div><div class="ttdeci">void update_diffusive_arrays(int lev, const amrex::BoxArray &amp;ba, const amrex::DistributionMapping &amp;dm)</div><div class="ttdef"><b>Definition:</b> ERF_make_new_level.cpp:482</div></div>
<div class="ttc" id="aclassERF_html_a5160b1e054b3e2a09c26274ef3551c64"><div class="ttname"><a href="classERF.html#a5160b1e054b3e2a09c26274ef3551c64">ERF::init_stuff</a></div><div class="ttdeci">void init_stuff(int lev, const amrex::BoxArray &amp;ba, const amrex::DistributionMapping &amp;dm)</div><div class="ttdef"><b>Definition:</b> ERF_make_new_level.cpp:611</div></div>
<div class="ttc" id="aclassERF_html_a5600f8ce250d4811012719fdf5e85f00"><div class="ttname"><a href="classERF.html#a5600f8ce250d4811012719fdf5e85f00">ERF::initialize_integrator</a></div><div class="ttdeci">void initialize_integrator(int lev, amrex::MultiFab &amp;cons_mf, amrex::MultiFab &amp;vel_mf)</div><div class="ttdef"><b>Definition:</b> ERF_make_new_level.cpp:590</div></div>
<div class="ttc" id="aclassERF_html_a900a0119c110486650f2759287e22cba"><div class="ttname"><a href="classERF.html#a900a0119c110486650f2759287e22cba">ERF::update_terrain_arrays</a></div><div class="ttdeci">void update_terrain_arrays(int lev, amrex::Real time)</div><div class="ttdef"><b>Definition:</b> ERF_make_new_level.cpp:547</div></div>
<div class="ttc" id="aclassERF_html_ac0951404aa6802aad7a3be6b7375dfa2"><div class="ttname"><a href="classERF.html#ac0951404aa6802aad7a3be6b7375dfa2">ERF::Define_ERFFillPatchers</a></div><div class="ttdeci">void Define_ERFFillPatchers(int lev)</div><div class="ttdef"><b>Definition:</b> ERF.cpp:1624</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aaf10bbf8c9a5dbc257a88c4c1b650fee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf10bbf8c9a5dbc257a88c4c1b650fee">&#9670;&nbsp;</a></span>MakeNewLevelFromScratch()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::MakeNewLevelFromScratch </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::BoxArray &amp;&#160;</td>
          <td class="paramname"><em>ba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::DistributionMapping &amp;&#160;</td>
          <td class="paramname"><em>dm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;{</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="comment">// Set BoxArray grids and DistributionMapping dmap in AMReX_AmrMesh.H class</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    SetBoxArray(lev, ba);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    SetDistributionMap(lev, dm);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="comment">// amrex::Print() &lt;&lt;&quot; BA AT LEVEL &quot; &lt;&lt; lev &lt;&lt; &quot; &quot; &lt;&lt; ba &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="comment">// The number of ghost cells for density must be 1 greater than that for velocity</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="comment">//     so that we can go back in forth betwen velocity and momentum on all faces</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keywordtype">int</span> ngrow_state = <a class="code" href="classERF.html#ae68b1f54d196d0a4b19716d65a59d4c5">ComputeGhostCells</a>(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>, <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa2de671156cccf1f3a34b9f250fb0e28">use_NumDiff</a>) + 1;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keywordtype">int</span> ngrow_vels  = <a class="code" href="classERF.html#ae68b1f54d196d0a4b19716d65a59d4c5">ComputeGhostCells</a>(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>, <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa2de671156cccf1f3a34b9f250fb0e28">use_NumDiff</a>);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keyword">auto</span>&amp; lev_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev];</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keyword">auto</span>&amp; lev_old = <a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev];</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <a class="code" href="classERF.html#a5160b1e054b3e2a09c26274ef3551c64">init_stuff</a>(lev, ba, dm);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keywordtype">int</span> n_qstate   = <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;Get_Qstate_Size();</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="keywordtype">int</span> ncomp_cons = <a class="code" href="IndexDefines_8H.html#a46e292b965f80d15acfbdc11ffe1e0f0">NVAR_max</a> - (<a class="code" href="IndexDefines_8H.html#abe87e298e9d558e0659a67ad3b9be71f">NMOIST_max</a> - n_qstate);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].define(ba, dm, ncomp_cons, ngrow_state);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    lev_old[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].define(ba, dm, ncomp_cons, ngrow_state);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].define(convert(ba, IntVect(1,0,0)), dm, 1, ngrow_vels);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    lev_old[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].define(convert(ba, IntVect(1,0,0)), dm, 1, ngrow_vels);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].define(convert(ba, IntVect(0,1,0)), dm, 1, ngrow_vels);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    lev_old[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].define(convert(ba, IntVect(0,1,0)), dm, 1, ngrow_vels);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].define(convert(ba, IntVect(0,0,1)), dm, 1, IntVect(ngrow_vels,ngrow_vels,0));</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    lev_old[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].define(convert(ba, IntVect(0,0,1)), dm, 1, IntVect(ngrow_vels,ngrow_vels,0));</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="comment">//********************************************************************************************</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="comment">// Microphysics</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="comment">// *******************************************************************************************</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordtype">int</span> q_size  = <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;Get_Qmoist_Size(lev);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <a class="code" href="classERF.html#ae00126a9c2738bf6a6cbbe77321c9cfc">qmoist</a>[lev].resize(q_size);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;Define(lev, <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> != <a class="code" href="DataStruct_8H.html#ab34704153a585940411c26587cb82ad0a6adf97f83acf6453d4a6a4b1070f3754">MoistureType::None</a>)</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;Init(lev, <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], grids[lev], Geom(lev), 0.0); <span class="comment">// dummy dt value</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    }</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> mvar(0); mvar&lt;<a class="code" href="classERF.html#ae00126a9c2738bf6a6cbbe77321c9cfc">qmoist</a>[lev].size(); ++mvar) {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <a class="code" href="classERF.html#ae00126a9c2738bf6a6cbbe77321c9cfc">qmoist</a>[lev][mvar] = <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;Get_Qmoist_Ptr(lev,mvar);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="comment">//********************************************************************************************</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="comment">// Land Surface Model</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="comment">// *******************************************************************************************</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordtype">int</span> lsm_size  = <a class="code" href="classERF.html#ae0e9a78f120ba632d78cbf23c97b851c">lsm</a>.<a class="code" href="classLandSurface.html#a2652af07555cc98d15d3516371fa42e6">Get_Data_Size</a>();</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <a class="code" href="classERF.html#ad03da3399e893728741fac33100ce476">lsm_data</a>[lev].resize(lsm_size);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <a class="code" href="classERF.html#aa5f6a6ceae0087393f386649d8bbbc31">lsm_flux</a>[lev].resize(lsm_size);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <a class="code" href="classERF.html#ae0e9a78f120ba632d78cbf23c97b851c">lsm</a>.<a class="code" href="classLandSurface.html#ae2087847b83c6a9e4453ccaa110134ce">Define</a>(lev, <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a43c1741535574c7e6f4fe6bf90552f31">lsm_type</a> != <a class="code" href="DataStruct_8H.html#abeec366fd5381f3bb7ba39f6e5c1e7e4a6adf97f83acf6453d4a6a4b1070f3754">LandSurfaceType::None</a>)</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    {</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <a class="code" href="classERF.html#ae0e9a78f120ba632d78cbf23c97b851c">lsm</a>.<a class="code" href="classLandSurface.html#aac1216f5c2758361ddc016442f3c67cd">Init</a>(lev, <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], Geom(lev), 0.0); <span class="comment">// dummy dt value</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    }</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> mvar(0); mvar&lt;<a class="code" href="classERF.html#ad03da3399e893728741fac33100ce476">lsm_data</a>[lev].size(); ++mvar) {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <a class="code" href="classERF.html#ad03da3399e893728741fac33100ce476">lsm_data</a>[lev][mvar] = <a class="code" href="classERF.html#ae0e9a78f120ba632d78cbf23c97b851c">lsm</a>.<a class="code" href="classLandSurface.html#af125bc0c5860b3564afdfce10ec253ea">Get_Data_Ptr</a>(lev,mvar);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <a class="code" href="classERF.html#aa5f6a6ceae0087393f386649d8bbbc31">lsm_flux</a>[lev][mvar] = <a class="code" href="classERF.html#ae0e9a78f120ba632d78cbf23c97b851c">lsm</a>.<a class="code" href="classLandSurface.html#a967a4b0772dc721d0242d38613ac430e">Get_Flux_Ptr</a>(lev,mvar);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    }</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="comment">// Build the data structures for calculating diffusive/turbulent terms</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <a class="code" href="classERF.html#a419510fced05e9afc05c466beeeb66f7">update_diffusive_arrays</a>(lev, ba, dm);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="comment">// Base state holds r_0, pres_0, pi_0 (in that order)</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].define(ba,dm,3,1);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].setVal(0.);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a063a88594452100497651e8aaf1f68d7">use_terrain</a> &amp;&amp; <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> != <a class="code" href="DataStruct_8H.html#af82ff6f1edafee12190434b73fe91127a84a8921b25f505d0d2077aeb5db4bc16">TerrainType::Static</a>) {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <a class="code" href="classERF.html#a37b2a4257df8ff53d4450de47f16ace1">base_state_new</a>[lev].define(ba,dm,3,1);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <a class="code" href="classERF.html#a37b2a4257df8ff53d4450de47f16ace1">base_state_new</a>[lev].setVal(0.);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    }</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a063a88594452100497651e8aaf1f68d7">use_terrain</a>) {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[lev] = std::make_unique&lt;MultiFab&gt;(ba,dm,1,1);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;          <a class="code" href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">detJ_cc</a>[lev] = std::make_unique&lt;MultiFab&gt;(ba,dm,1,1);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> != <a class="code" href="DataStruct_8H.html#af82ff6f1edafee12190434b73fe91127a84a8921b25f505d0d2077aeb5db4bc16">TerrainType::Static</a>) {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            <a class="code" href="classERF.html#ae39bf64c5306b1dd939d82d9df728daa">detJ_cc_new</a>[lev] = std::make_unique&lt;MultiFab&gt;(ba,dm,1,1);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            <a class="code" href="classERF.html#a9a411e0ea9d9bdbfab957c8081229091">detJ_cc_src</a>[lev] = std::make_unique&lt;MultiFab&gt;(ba,dm,1,1);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            <a class="code" href="classERF.html#a72a59614c6d5ab840b924c84d5682270">z_t_rk</a>[lev] = std::make_unique&lt;MultiFab&gt;( convert(ba, IntVect(0,0,1)), dm, 1, 1 );</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        BoxArray ba_nd(ba);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        ba_nd.surroundingNodes();</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <span class="comment">// We need this to be one greater than the ghost cells to handle levels &gt; 0</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <span class="keywordtype">int</span> ngrow = <a class="code" href="classERF.html#ae68b1f54d196d0a4b19716d65a59d4c5">ComputeGhostCells</a>(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>, <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa2de671156cccf1f3a34b9f250fb0e28">use_NumDiff</a>) + 2;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev] = std::make_unique&lt;MultiFab&gt;(ba_nd,dm,1,IntVect(ngrow,ngrow,1));</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> != <a class="code" href="DataStruct_8H.html#af82ff6f1edafee12190434b73fe91127a84a8921b25f505d0d2077aeb5db4bc16">TerrainType::Static</a>) {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            <a class="code" href="classERF.html#a4ef635c22e72c715f5703a6b95a7abe5">z_phys_nd_new</a>[lev] = std::make_unique&lt;MultiFab&gt;(ba_nd,dm,1,IntVect(ngrow,ngrow,1));</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            <a class="code" href="classERF.html#a30dcf40e8f104fb6b6132805d2eff47c">z_phys_nd_src</a>[lev] = std::make_unique&lt;MultiFab&gt;(ba_nd,dm,1,IntVect(ngrow,ngrow,1));</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        }</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            <a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;              <a class="code" href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">detJ_cc</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <a class="code" href="classERF.html#a4ef635c22e72c715f5703a6b95a7abe5">z_phys_nd_new</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;          <a class="code" href="classERF.html#ae39bf64c5306b1dd939d82d9df728daa">detJ_cc_new</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <a class="code" href="classERF.html#a30dcf40e8f104fb6b6132805d2eff47c">z_phys_nd_src</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;          <a class="code" href="classERF.html#a9a411e0ea9d9bdbfab957c8081229091">detJ_cc_src</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;               <a class="code" href="classERF.html#a72a59614c6d5ab840b924c84d5682270">z_t_rk</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <a class="code" href="classERF.html#a5a5395054a212d8f3fc577562c14b66e">sst_lev</a>[lev].resize(1);     <a class="code" href="classERF.html#a5a5395054a212d8f3fc577562c14b66e">sst_lev</a>[lev][0] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <a class="code" href="classERF.html#a3f3e29874221e43e13e2a431e77e0e4e">lmask_lev</a>[lev].resize(1); <a class="code" href="classERF.html#a3f3e29874221e43e13e2a431e77e0e4e">lmask_lev</a>[lev][0] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="comment">// Create the ERFFillPatcher object</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordflow">if</span> (lev &gt; 0 &amp;&amp; <a class="code" href="classERF.html#ad9084179f7384e10a519989ffd51fd34">cf_width</a> &gt;= 0) {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <a class="code" href="classERF.html#adc284f421c5fd9dd15c0e5cbe4ff5fc8">Construct_ERFFillPatchers</a>(lev);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;           <a class="code" href="classERF.html#ac0951404aa6802aad7a3be6b7375dfa2">Define_ERFFillPatchers</a>(lev);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    }</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="comment">// Initialize the boundary conditions</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <a class="code" href="classERF.html#a2e9b04043853d25f2d76edbc0bed2e72">physbcs_cons</a>[lev] = std::make_unique&lt;ERFPhysBCFunct_cons&gt; (lev, geom[lev], <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>, <a class="code" href="classERF.html#a8a99e22b1111c803e31b4afd5fcdea60">domain_bcs_type_d</a>,</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                                                               <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>, <a class="code" href="classERF.html#a69ea003766c97b1a667b002b3661f0f2">m_bc_neumann_vals</a>,</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                                                               <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev], <a class="code" href="classERF.html#a86208285bf705f360a3c318a75097f61">use_real_bcs</a>);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <a class="code" href="classERF.html#a64e55e5ae9df06433146db657eb9e72e">physbcs_u</a>[lev]    = std::make_unique&lt;ERFPhysBCFunct_u&gt; (lev, geom[lev], <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>, <a class="code" href="classERF.html#a8a99e22b1111c803e31b4afd5fcdea60">domain_bcs_type_d</a>,</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                                                            <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>, <a class="code" href="classERF.html#a69ea003766c97b1a667b002b3661f0f2">m_bc_neumann_vals</a>,</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                                                            <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev], <a class="code" href="classERF.html#a86208285bf705f360a3c318a75097f61">use_real_bcs</a>);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <a class="code" href="classERF.html#a79231b5cfd4576a742e46ae0082b5121">physbcs_v</a>[lev]    = std::make_unique&lt;ERFPhysBCFunct_v&gt; (lev, geom[lev], <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>, <a class="code" href="classERF.html#a8a99e22b1111c803e31b4afd5fcdea60">domain_bcs_type_d</a>,</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                                                            <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>, <a class="code" href="classERF.html#a69ea003766c97b1a667b002b3661f0f2">m_bc_neumann_vals</a>,</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                                                            <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev], <a class="code" href="classERF.html#a86208285bf705f360a3c318a75097f61">use_real_bcs</a>);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <a class="code" href="classERF.html#a45c8ecd777f47732993777a0afb8e140">physbcs_w</a>[lev]    = std::make_unique&lt;ERFPhysBCFunct_w&gt; (lev, geom[lev], <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>, <a class="code" href="classERF.html#a8a99e22b1111c803e31b4afd5fcdea60">domain_bcs_type_d</a>,</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                                                            <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>, <a class="code" href="classERF.html#a69ea003766c97b1a667b002b3661f0f2">m_bc_neumann_vals</a>,</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                                                            <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a>, <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev], <a class="code" href="classERF.html#a86208285bf705f360a3c318a75097f61">use_real_bcs</a>);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <a class="code" href="classERF.html#a4d717bb9fe936fd1a124d0d3e720f9d1">physbcs_w_no_terrain</a>[lev]    = std::make_unique&lt;ERFPhysBCFunct_w_no_terrain&gt;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                                                           (lev, geom[lev], <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>, <a class="code" href="classERF.html#a8a99e22b1111c803e31b4afd5fcdea60">domain_bcs_type_d</a>,</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                                                            <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>, <a class="code" href="classERF.html#a69ea003766c97b1a667b002b3661f0f2">m_bc_neumann_vals</a>, <a class="code" href="classERF.html#a86208285bf705f360a3c318a75097f61">use_real_bcs</a>);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="comment">// Initialize the integrator class</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <a class="code" href="classERF.html#a5600f8ce250d4811012719fdf5e85f00">initialize_integrator</a>(lev, lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>]);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="comment">// Initialize the data itself</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="comment">// If (init_type == &quot;real&quot;) then we are initializing terrain and the initial data in</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="comment">//                          the same call so we must call init_only before update_terrain_arrays</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="comment">// If (init_type != &quot;real&quot;) then we want to initialize the terrain before the initial data</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="comment">//                          since we may need to use the grid information before constructing</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="comment">//                          initial idealized data</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="classERF.html#af5ac3d88a33a1a284bcc120ce0599cf7">init_type</a> == <span class="stringliteral">&quot;real&quot;</span>) || (<a class="code" href="classERF.html#af5ac3d88a33a1a284bcc120ce0599cf7">init_type</a> == <span class="stringliteral">&quot;metgrid&quot;</span>)) {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <span class="comment">// If called from restart, the data structures for terrain-related quantities</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        <span class="comment">//    are built in the ReadCheckpoint routine.  Otherwise we build them here.</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>.empty()) {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            <a class="code" href="classERF.html#a80981e20939a6a38ba17478da2253ff1">init_only</a>(lev, <a class="code" href="classERF.html#aa0c07f31b23d977646b8161e5473fab5">start_time</a>);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            <a class="code" href="classERF.html#a900a0119c110486650f2759287e22cba">update_terrain_arrays</a>(lev, time);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        }</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <span class="comment">// Build the data structures for terrain-related quantities</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <a class="code" href="classERF.html#a900a0119c110486650f2759287e22cba">update_terrain_arrays</a>(lev, time);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <span class="comment">// Initialize the solution data itself</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>.empty()) {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            <a class="code" href="classERF.html#a80981e20939a6a38ba17478da2253ff1">init_only</a>(lev, <a class="code" href="classERF.html#aa0c07f31b23d977646b8161e5473fab5">start_time</a>);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        }</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    }</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;}</div>
<div class="ttc" id="aIndexDefines_8H_html_abe87e298e9d558e0659a67ad3b9be71f"><div class="ttname"><a href="IndexDefines_8H.html#abe87e298e9d558e0659a67ad3b9be71f">NMOIST_max</a></div><div class="ttdeci">#define NMOIST_max</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:30</div></div>
<div class="ttc" id="aclassERF_html_a80981e20939a6a38ba17478da2253ff1"><div class="ttname"><a href="classERF.html#a80981e20939a6a38ba17478da2253ff1">ERF::init_only</a></div><div class="ttdeci">void init_only(int lev, amrex::Real time)</div><div class="ttdef"><b>Definition:</b> ERF.cpp:1028</div></div>
<div class="ttc" id="aclassLandSurface_html_a2652af07555cc98d15d3516371fa42e6"><div class="ttname"><a href="classLandSurface.html#a2652af07555cc98d15d3516371fa42e6">LandSurface::Get_Data_Size</a></div><div class="ttdeci">int Get_Data_Size()</div><div class="ttdef"><b>Definition:</b> LandSurface.H:74</div></div>
<div class="ttc" id="aclassLandSurface_html_a967a4b0772dc721d0242d38613ac430e"><div class="ttname"><a href="classLandSurface.html#a967a4b0772dc721d0242d38613ac430e">LandSurface::Get_Flux_Ptr</a></div><div class="ttdeci">amrex::MultiFab * Get_Flux_Ptr(const int &amp;lev, const int &amp;varIdx)</div><div class="ttdef"><b>Definition:</b> LandSurface.H:68</div></div>
<div class="ttc" id="aclassLandSurface_html_aac1216f5c2758361ddc016442f3c67cd"><div class="ttname"><a href="classLandSurface.html#aac1216f5c2758361ddc016442f3c67cd">LandSurface::Init</a></div><div class="ttdeci">void Init(const int &amp;lev, const amrex::MultiFab &amp;cons_in, const amrex::Geometry &amp;geom, const amrex::Real &amp;dt_advance)</div><div class="ttdef"><b>Definition:</b> LandSurface.H:38</div></div>
<div class="ttc" id="aclassLandSurface_html_ae2087847b83c6a9e4453ccaa110134ce"><div class="ttname"><a href="classLandSurface.html#ae2087847b83c6a9e4453ccaa110134ce">LandSurface::Define</a></div><div class="ttdeci">void Define(const int &amp;lev, SolverChoice &amp;sc)</div><div class="ttdef"><b>Definition:</b> LandSurface.H:31</div></div>
<div class="ttc" id="aclassLandSurface_html_af125bc0c5860b3564afdfce10ec253ea"><div class="ttname"><a href="classLandSurface.html#af125bc0c5860b3564afdfce10ec253ea">LandSurface::Get_Data_Ptr</a></div><div class="ttdeci">amrex::MultiFab * Get_Data_Ptr(const int &amp;lev, const int &amp;varIdx)</div><div class="ttdef"><b>Definition:</b> LandSurface.H:65</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac1238c1616826c66df1dfd9076e6a3da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1238c1616826c66df1dfd9076e6a3da">&#9670;&nbsp;</a></span>NumDataLogs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">AMREX_FORCE_INLINE int ERF::NumDataLogs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    {</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classERF.html#a1cade630b005dbcc0f644987ef3db287">datalog</a>.size();</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a14f922bdc3a0f23c087afa32c67ac119"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14f922bdc3a0f23c087afa32c67ac119">&#9670;&nbsp;</a></span>NumSampleLineLogs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">AMREX_FORCE_INLINE int ERF::NumSampleLineLogs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    {</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classERF.html#a4990f1796b65ec8ee602f177a66afc3e">samplelinelog</a>.size();</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a70d78ca624acf09d8faab9a2d51264d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70d78ca624acf09d8faab9a2d51264d9">&#9670;&nbsp;</a></span>NumSampleLines()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">AMREX_FORCE_INLINE int ERF::NumSampleLines </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    {</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classERF.html#a0fa1582bb13357895d2aba91b695624a">sampleline</a>.size();</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a41324a4b5610fde725fe721550b23c85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41324a4b5610fde725fe721550b23c85">&#9670;&nbsp;</a></span>NumSamplePointLogs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">AMREX_FORCE_INLINE int ERF::NumSamplePointLogs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    {</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classERF.html#a9737ddb0de6b9e8a5b17c109d5ad3e08">sampleptlog</a>.size();</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5bc7dd2c7e1ebf65b7dc1d9bf0dfb36f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5bc7dd2c7e1ebf65b7dc1d9bf0dfb36f">&#9670;&nbsp;</a></span>NumSamplePoints()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">AMREX_FORCE_INLINE int ERF::NumSamplePoints </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    {</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classERF.html#ae8a57b7fbf5a67c99d04b7d4f43ad100">samplepoint</a>.size();</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a72fcc41d6f5225e9ca3b8c9111ff37e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72fcc41d6f5225e9ca3b8c9111ff37e7">&#9670;&nbsp;</a></span>operator=() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classERF.html">ERF</a>&amp; ERF::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classERF.html">ERF</a> &amp;&#160;</td>
          <td class="paramname"><em>other</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="abbc40e6fe700b80e3666dd3723624f05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abbc40e6fe700b80e3666dd3723624f05">&#9670;&nbsp;</a></span>operator=() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classERF.html">ERF</a>&amp; ERF::operator= </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classERF.html">ERF</a> &amp;&amp;&#160;</td>
          <td class="paramname"><em>other</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a54f6c5d799e51521ad10bb57d29d0c44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54f6c5d799e51521ad10bb57d29d0c44">&#9670;&nbsp;</a></span>PlotFileName()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ERF::PlotFileName </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a2dcd22cb915d923c687f60267f44542b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2dcd22cb915d923c687f60267f44542b">&#9670;&nbsp;</a></span>PlotFileVarNames()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Vector&lt; std::string &gt; ERF::PlotFileVarNames </td>
          <td>(</td>
          <td class="paramtype">amrex::Vector&lt; std::string &gt;&#160;</td>
          <td class="paramname"><em>plot_var_names</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;{</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    Vector&lt;std::string&gt; names;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    names.insert(names.end(), plot_var_names.begin(), plot_var_names.end());</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordflow">return</span> names;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a58f6683aff0fbe6949bfe8b49275a8b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58f6683aff0fbe6949bfe8b49275a8b3">&#9670;&nbsp;</a></span>post_timestep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::post_timestep </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nstep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>dt_lev</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;{</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    BL_PROFILE(<span class="stringliteral">&quot;ERF::post_timestep()&quot;</span>);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160; </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="preprocessor">#ifdef ERF_USE_PARTICLES</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    particleData.Redistribute();</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#af976afa61859c07e6249963edc367c2d">coupling_type</a> == <a class="code" href="DataStruct_8H.html#ad285be248c0803917aaf5cf8ce62139ba6c267346f8ebb889610a5a90838be815">CouplingType::TwoWay</a>)</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    {</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <span class="keywordtype">bool</span> use_terrain = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a063a88594452100497651e8aaf1f68d7">use_terrain</a>;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        <span class="keywordtype">int</span> ncomp = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[0][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nComp();</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = finest_level-1; lev &gt;= 0; lev--)</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        {</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            <span class="comment">// The quantity that is conserved is not (rho S), but rather (rho S / m^2) where</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            <span class="comment">// m is the map scale factor at cell centers</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            <span class="comment">// Here we pre-divide (rho S) by m^2 before refluxing</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            <span class="keywordflow">for</span> (MFIter mfi(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], TilingIfNotGPU()); mfi.isValid(); ++mfi) {</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                <span class="keyword">const</span> Array4&lt;      Real&gt;   cons_arr = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].array(mfi);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                <span class="keyword">const</span> Array4&lt;const Real&gt; mapfac_arr = <a class="code" href="classERF.html#a23aacdb72e9d2dfed8e2ebd2c2526497">mapfac_m</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                <span class="keywordflow">if</span> (use_terrain) {</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                    <span class="keyword">const</span> Array4&lt;const Real&gt;   detJ_arr = <a class="code" href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">detJ_cc</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                    ParallelFor(bx, ncomp, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k, <span class="keywordtype">int</span> n) noexcept</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                    {</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                        cons_arr(i,j,k,n) *= detJ_arr(i,j,k) / (mapfac_arr(i,j,0)*mapfac_arr(i,j,0));</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                    });</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                    ParallelFor(bx, ncomp, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k, <span class="keywordtype">int</span> n) noexcept</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                    {</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                        cons_arr(i,j,k,n) /= (mapfac_arr(i,j,0)*mapfac_arr(i,j,0));</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                    });</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                }</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            } <span class="comment">// mfi</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160; </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;            <span class="comment">// This call refluxes from the lev/lev+1 interface onto lev</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;            <a class="code" href="classERF.html#a4d6d990d8111c170692b1e9cc0e918b8">getAdvFluxReg</a>(lev+1)-&gt;Reflux(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], 0, 0, ncomp);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160; </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            <span class="comment">// Here we multiply (rho S) by m^2 after refluxing</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            <span class="keywordflow">for</span> (MFIter mfi(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], TilingIfNotGPU()); mfi.isValid(); ++mfi) {</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                <span class="keyword">const</span> Array4&lt;      Real&gt;   cons_arr = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].array(mfi);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                <span class="keyword">const</span> Array4&lt;const Real&gt; mapfac_arr = <a class="code" href="classERF.html#a23aacdb72e9d2dfed8e2ebd2c2526497">mapfac_m</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                <span class="keywordflow">if</span> (use_terrain) {</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                    <span class="keyword">const</span> Array4&lt;const Real&gt;   detJ_arr = <a class="code" href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">detJ_cc</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                    ParallelFor(bx, ncomp, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k, <span class="keywordtype">int</span> n) noexcept</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                    {</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                        cons_arr(i,j,k,n) *= (mapfac_arr(i,j,0)*mapfac_arr(i,j,0)) / detJ_arr(i,j,k);</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                    });</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                    ParallelFor(bx, ncomp, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k, <span class="keywordtype">int</span> n) noexcept</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                    {</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                        cons_arr(i,j,k,n) *= (mapfac_arr(i,j,0)*mapfac_arr(i,j,0));</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                    });</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                }</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;            } <span class="comment">// mfi</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;            <span class="comment">// We need to do this before anything else because refluxing changes the</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;            <span class="comment">// values of coarse cells underneath fine grids with the assumption they&#39;ll</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            <span class="comment">// be over-written by averaging down</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;            <a class="code" href="classERF.html#ae17524f168760cf435685a08d97480e7">AverageDownTo</a>(lev,0,ncomp);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        }</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    }</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160; </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ad4c61fad53912d1e8d0f774d365bcf0f">is_it_time_for_action</a>(nstep, time, dt_lev0, <a class="code" href="classERF.html#a5232e98479611a24fe97994640c61faa">sum_interval</a>, <a class="code" href="classERF.html#a1cf2ba396f4404724824516da4c4a084">sum_per</a>)) {</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        <a class="code" href="classERF.html#a922892a05ee0c5bccd210a3e5a8599e1">sum_integrated_quantities</a>(time);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    }</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160; </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a633cd0b44d2e38f02c23e953aecd69eb">profile_int</a> &gt; 0 &amp;&amp; (nstep+1) % <a class="code" href="classERF.html#a633cd0b44d2e38f02c23e953aecd69eb">profile_int</a> == 0) {</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a2aa0f6b2edd9efd9b090e39db1effcdf">cc_profiles</a>) {</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;            <span class="comment">// all variables cell-centered</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;            <a class="code" href="classERF.html#a55eae94c5363e227b571739738bb26b7">write_1D_profiles</a>(time);</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;            <span class="comment">// some variables staggered</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            <a class="code" href="classERF.html#a39efa3a0f3ae3deb7a43f4ce110ee49a">write_1D_profiles_stag</a>(time);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        }</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    }</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160; </div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ad17ff2753e754ff3eb1330612b820b5f">output_1d_column</a>) {</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="preprocessor">#ifdef ERF_USE_NETCDF</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ad4c61fad53912d1e8d0f774d365bcf0f">is_it_time_for_action</a>(nstep, time, dt_lev0, <a class="code" href="classERF.html#afa0bef6d3146788302b81c0d4f4802d1">column_interval</a>, <a class="code" href="classERF.html#a7b0175190c6fcf829c7f2841f729b12a">column_per</a>))</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;      {</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;         <span class="keywordtype">int</span> lev_column = 0;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = finest_level; lev &gt;= 0; lev--)</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;         {</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;            Real dx_lev = geom[lev].CellSize(0);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            Real dy_lev = geom[lev].CellSize(1);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;            <span class="keywordtype">int</span> i_lev = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(std::floor(<a class="code" href="classERF.html#a930b7d48218b3fc41d8719b50b3f6086">column_loc_x</a> / dx_lev));</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;            <span class="keywordtype">int</span> j_lev = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(std::floor(<a class="code" href="classERF.html#a2b911f3a5a324813b1ff4462df6044a6">column_loc_y</a> / dy_lev));</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;            <span class="keywordflow">if</span> (grids[lev].contains(IntVect(i_lev,j_lev,0))) lev_column = lev;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;         }</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;         writeToNCColumnFile(lev_column, <a class="code" href="classERF.html#a48bba6b1c1b39940b09aefbe56311e2f">column_file_name</a>, <a class="code" href="classERF.html#a930b7d48218b3fc41d8719b50b3f6086">column_loc_x</a>, <a class="code" href="classERF.html#a2b911f3a5a324813b1ff4462df6044a6">column_loc_y</a>, time);</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      }</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;      Abort(<span class="stringliteral">&quot;To output 1D column files ERF must be compiled with NetCDF&quot;</span>);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    }</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160; </div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a7c448670f7a5cadd6fe56f7e615c9eb6">output_bndry_planes</a>)</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    {</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ad4c61fad53912d1e8d0f774d365bcf0f">is_it_time_for_action</a>(<a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[0], time, dt_lev0, <a class="code" href="classERF.html#aab4575d8fb57595a2f1aaf088c60447a">bndry_output_planes_interval</a>, <a class="code" href="classERF.html#a5f99e949c83d86507e003ae556cf7c22">bndry_output_planes_per</a>) &amp;&amp;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;          time &gt;= <a class="code" href="classERF.html#a87e58f16f44a6cb35d6983ed3fe7d3c1">bndry_output_planes_start_time</a>)</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      {</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;         <a class="code" href="classERF.html#aa53035f34ba133b86172e180abda4209">m_w2d</a>-&gt;write_planes(<a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[0], time, <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;      }</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    }</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160; </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="comment">// Moving terrain</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a063a88594452100497651e8aaf1f68d7">use_terrain</a> &amp;&amp;  (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> == <a class="code" href="DataStruct_8H.html#af82ff6f1edafee12190434b73fe91127adefe967ad0373b2274fc298f19125ca7">TerrainType::Moving</a>) )</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    {</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = finest_level; lev &gt;= 0; lev--)</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;      {</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        <span class="comment">// Copy z_phs_nd and detJ_cc at end of timestep</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        MultiFab::Copy(*<a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev], *<a class="code" href="classERF.html#a4ef635c22e72c715f5703a6b95a7abe5">z_phys_nd_new</a>[lev], 0, 0, 1, <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev]-&gt;nGrowVect());</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        MultiFab::Copy(  *<a class="code" href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">detJ_cc</a>[lev],   *<a class="code" href="classERF.html#ae39bf64c5306b1dd939d82d9df728daa">detJ_cc_new</a>[lev], 0, 0, 1,   <a class="code" href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">detJ_cc</a>[lev]-&gt;nGrowVect());</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        MultiFab::Copy(<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev],<a class="code" href="classERF.html#a37b2a4257df8ff53d4450de47f16ace1">base_state_new</a>[lev],0,0,3,1);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160; </div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        <a class="code" href="TerrainMetrics_8cpp.html#acc28d890df44cf0082a848c057042178">make_zcc</a>(geom[lev],*<a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev],*<a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[lev]);</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;      }</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    }</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;} <span class="comment">// post_timestep</span></div>
<div class="ttc" id="aDataStruct_8H_html_af82ff6f1edafee12190434b73fe91127adefe967ad0373b2274fc298f19125ca7"><div class="ttname"><a href="DataStruct_8H.html#af82ff6f1edafee12190434b73fe91127adefe967ad0373b2274fc298f19125ca7">TerrainType::Moving</a></div><div class="ttdeci">@ Moving</div></div>
<div class="ttc" id="aTerrainMetrics_8cpp_html_acc28d890df44cf0082a848c057042178"><div class="ttname"><a href="TerrainMetrics_8cpp.html#acc28d890df44cf0082a848c057042178">make_zcc</a></div><div class="ttdeci">void make_zcc(const Geometry &amp;geom, MultiFab &amp;z_phys_nd, MultiFab &amp;z_phys_cc)</div><div class="ttdef"><b>Definition:</b> TerrainMetrics.cpp:488</div></div>
<div class="ttc" id="aclassERF_html_a2b911f3a5a324813b1ff4462df6044a6"><div class="ttname"><a href="classERF.html#a2b911f3a5a324813b1ff4462df6044a6">ERF::column_loc_y</a></div><div class="ttdeci">static amrex::Real column_loc_y</div><div class="ttdef"><b>Definition:</b> ERF.H:792</div></div>
<div class="ttc" id="aclassERF_html_a48bba6b1c1b39940b09aefbe56311e2f"><div class="ttname"><a href="classERF.html#a48bba6b1c1b39940b09aefbe56311e2f">ERF::column_file_name</a></div><div class="ttdeci">static std::string column_file_name</div><div class="ttdef"><b>Definition:</b> ERF.H:793</div></div>
<div class="ttc" id="aclassERF_html_a4d6d990d8111c170692b1e9cc0e918b8"><div class="ttname"><a href="classERF.html#a4d6d990d8111c170692b1e9cc0e918b8">ERF::getAdvFluxReg</a></div><div class="ttdeci">AMREX_FORCE_INLINE amrex::YAFluxRegister * getAdvFluxReg(int lev)</div><div class="ttdef"><b>Definition:</b> ERF.H:894</div></div>
<div class="ttc" id="aclassERF_html_a5f99e949c83d86507e003ae556cf7c22"><div class="ttname"><a href="classERF.html#a5f99e949c83d86507e003ae556cf7c22">ERF::bndry_output_planes_per</a></div><div class="ttdeci">static amrex::Real bndry_output_planes_per</div><div class="ttdef"><b>Definition:</b> ERF.H:798</div></div>
<div class="ttc" id="aclassERF_html_a633cd0b44d2e38f02c23e953aecd69eb"><div class="ttname"><a href="classERF.html#a633cd0b44d2e38f02c23e953aecd69eb">ERF::profile_int</a></div><div class="ttdeci">int profile_int</div><div class="ttdef"><b>Definition:</b> ERF.H:697</div></div>
<div class="ttc" id="aclassERF_html_a7b0175190c6fcf829c7f2841f729b12a"><div class="ttname"><a href="classERF.html#a7b0175190c6fcf829c7f2841f729b12a">ERF::column_per</a></div><div class="ttdeci">static amrex::Real column_per</div><div class="ttdef"><b>Definition:</b> ERF.H:790</div></div>
<div class="ttc" id="aclassERF_html_a930b7d48218b3fc41d8719b50b3f6086"><div class="ttname"><a href="classERF.html#a930b7d48218b3fc41d8719b50b3f6086">ERF::column_loc_x</a></div><div class="ttdeci">static amrex::Real column_loc_x</div><div class="ttdef"><b>Definition:</b> ERF.H:791</div></div>
<div class="ttc" id="aclassERF_html_aab4575d8fb57595a2f1aaf088c60447a"><div class="ttname"><a href="classERF.html#aab4575d8fb57595a2f1aaf088c60447a">ERF::bndry_output_planes_interval</a></div><div class="ttdeci">static int bndry_output_planes_interval</div><div class="ttdef"><b>Definition:</b> ERF.H:797</div></div>
<div class="ttc" id="aclassERF_html_ad17ff2753e754ff3eb1330612b820b5f"><div class="ttname"><a href="classERF.html#ad17ff2753e754ff3eb1330612b820b5f">ERF::output_1d_column</a></div><div class="ttdeci">static int output_1d_column</div><div class="ttdef"><b>Definition:</b> ERF.H:788</div></div>
<div class="ttc" id="aclassERF_html_afa0bef6d3146788302b81c0d4f4802d1"><div class="ttname"><a href="classERF.html#afa0bef6d3146788302b81c0d4f4802d1">ERF::column_interval</a></div><div class="ttdeci">static int column_interval</div><div class="ttdef"><b>Definition:</b> ERF.H:789</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a58f6683aff0fbe6949bfe8b49275a8b3_cgraph.png" border="0" usemap="#aclassERF_a58f6683aff0fbe6949bfe8b49275a8b3_cgraph" alt=""/></div>
<map name="aclassERF_a58f6683aff0fbe6949bfe8b49275a8b3_cgraph" id="aclassERF_a58f6683aff0fbe6949bfe8b49275a8b3_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,152,32"/>
<area shape="rect" href="TerrainMetrics_8cpp.html#acc28d890df44cf0082a848c057042178" title=" " alt="" coords="200,5,287,32"/>
</map>
</div>

</div>
</div>
<a id="adca0cddd75f33ecb5fb8e0ef9601dae4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adca0cddd75f33ecb5fb8e0ef9601dae4">&#9670;&nbsp;</a></span>post_update()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::post_update </td>
          <td>(</td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>state_mf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Geometry &amp;&#160;</td>
          <td class="paramname"><em>geom</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a1a8eb6bc00080cdbd8df28f6a321ac72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a8eb6bc00080cdbd8df28f6a321ac72">&#9670;&nbsp;</a></span>print_banner()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::print_banner </td>
          <td>(</td>
          <td class="paramtype">MPI_Comm&#160;</td>
          <td class="paramname"><em>comm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                     : <span class="stringliteral">&quot; &lt;&lt; msg &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="stringliteral">}</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="stringliteral">void ERF::print_banner(MPI_Comm comm, std::ostream&amp; out)</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="stringliteral">{</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="stringliteral">#ifdef AMREX_USE_MPI</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="stringliteral">    int irank = 0;</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="stringliteral">    int num_ranks = 1;</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="stringliteral">    MPI_Comm_size(comm, &amp;num_ranks);</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="stringliteral">    MPI_Comm_rank(comm, &amp;irank);</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="stringliteral">    // Only root process does the printing</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="stringliteral">    if (irank != 0) return;</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="stringliteral">#else</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="stringliteral">    amrex::ignore_unused(comm);</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="stringliteral">#endif</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="stringliteral">    auto etime = std::chrono::system_clock::now();</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="stringliteral">    auto etimet = std::chrono::system_clock::to_time_t(etime);</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="stringliteral">#ifndef _WIN32</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="stringliteral">    char time_buf[64];</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="stringliteral">    ctime_r(&amp;etimet, time_buf);</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="stringliteral">    const std::string tstamp(time_buf);</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="stringliteral">#else</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="stringliteral">    char* time_buf = new char[64];</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="stringliteral">    ctime_s(time_buf, 64, &amp;etimet);</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="stringliteral">    const std::string tstamp(time_buf);</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="stringliteral">#endif</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="stringliteral">    const char* githash1 = amrex::buildInfoGetGitHash(1);</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="stringliteral">    const char* githash2 = amrex::buildInfoGetGitHash(2);</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="stringliteral">    // clang-format off</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="stringliteral">    out &lt;&lt; dbl_line</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="stringliteral">        &lt;&lt; &quot;</span>                <a class="code" href="classERF.html#a30129012dd367825e5e4fd1406694f58">ERF</a> (https:<span class="comment">//github.com/erf-model/ERF)&quot;</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        &lt;&lt; std::endl &lt;&lt; std::endl</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;  ERF Git SHA      :: &quot;</span> &lt;&lt; githash1 &lt;&lt; std::endl</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;  AMReX Git SHA    :: &quot;</span> &lt;&lt; githash2 &lt;&lt; std::endl</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;  AMReX version    :: &quot;</span> &lt;&lt; amrex::Version() &lt;&lt; std::endl &lt;&lt; std::endl</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;  Exec. time       :: &quot;</span> &lt;&lt; tstamp</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;  Build time       :: &quot;</span> &lt;&lt; <a class="code" href="namespaceamrex.html#a8f794ff24efbc4b60058492d1a073c78">amrex::buildInfoGetBuildDate</a>() &lt;&lt; std::endl</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;  C++ compiler     :: &quot;</span> &lt;&lt; <a class="code" href="namespaceamrex.html#a9d270ec83f99e836cca454cac4e0af5e">amrex::buildInfoGetComp</a>()</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="namespaceamrex.html#aab3ca155f0d0a6d198817df9c35352f8">amrex::buildInfoGetCompVersion</a>() &lt;&lt; std::endl &lt;&lt; std::endl</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;  MPI              :: &quot;</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;#ifdef AMREX_USE_MPI</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;ON    (Num. ranks = &quot;</span> &lt;&lt; num_ranks &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;#<span class="keywordflow">else</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;OFF &quot;</span> &lt;&lt; std::endl</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;#endif</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;  GPU              :: &quot;</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;#ifdef AMREX_USE_GPU</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;ON    &quot;</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;#<span class="keywordflow">if</span> defined(AMREX_USE_CUDA)</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;(Backend: CUDA)&quot;</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;#elif defined(AMREX_USE_HIP)</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;(Backend: HIP)&quot;</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;#elif defined(AMREX_USE_SYCL)</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;(Backend: SYCL)&quot;</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;#endif</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        &lt;&lt; std::endl</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;#<span class="keywordflow">else</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;OFF&quot;</span> &lt;&lt; std::endl</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;#endif</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;  OpenMP           :: &quot;</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;#ifdef AMREX_USE_OMP</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;ON    (Num. threads = &quot;</span> &lt;&lt; omp_get_max_threads() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;#<span class="keywordflow">else</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;OFF&quot;</span> &lt;&lt; std::endl</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;#endif</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        &lt;&lt; std::endl;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="ttc" id="aclassERF_html_a30129012dd367825e5e4fd1406694f58"><div class="ttname"><a href="classERF.html#a30129012dd367825e5e4fd1406694f58">ERF::ERF</a></div><div class="ttdeci">ERF()</div><div class="ttdef"><b>Definition:</b> ERF.cpp:90</div></div>
<div class="ttc" id="anamespaceamrex_html_a8f794ff24efbc4b60058492d1a073c78"><div class="ttname"><a href="namespaceamrex.html#a8f794ff24efbc4b60058492d1a073c78">amrex::buildInfoGetBuildDate</a></div><div class="ttdeci">const char * buildInfoGetBuildDate()</div></div>
<div class="ttc" id="anamespaceamrex_html_a9d270ec83f99e836cca454cac4e0af5e"><div class="ttname"><a href="namespaceamrex.html#a9d270ec83f99e836cca454cac4e0af5e">amrex::buildInfoGetComp</a></div><div class="ttdeci">const char * buildInfoGetComp()</div></div>
<div class="ttc" id="anamespaceamrex_html_aab3ca155f0d0a6d198817df9c35352f8"><div class="ttname"><a href="namespaceamrex.html#aab3ca155f0d0a6d198817df9c35352f8">amrex::buildInfoGetCompVersion</a></div><div class="ttdeci">const char * buildInfoGetCompVersion()</div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a1a8eb6bc00080cdbd8df28f6a321ac72_icgraph.png" border="0" usemap="#aclassERF_a1a8eb6bc00080cdbd8df28f6a321ac72_icgraph" alt=""/></div>
<map name="aclassERF_a1a8eb6bc00080cdbd8df28f6a321ac72_icgraph" id="aclassERF_a1a8eb6bc00080cdbd8df28f6a321ac72_icgraph">
<area shape="rect" title=" " alt="" coords="108,5,244,32"/>
<area shape="rect" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,60,32"/>
</map>
</div>

</div>
</div>
<a id="addc510dbf758a33cc095d64a9b17076c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addc510dbf758a33cc095d64a9b17076c">&#9670;&nbsp;</a></span>print_error()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::print_error </td>
          <td>(</td>
          <td class="paramtype">MPI_Comm&#160;</td>
          <td class="paramname"><em>comm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        :</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    input_file   : Input file with simulation settings</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;Optional:</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    param=value  : Overrides <span class="keywordflow">for</span> parameters during runtime</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;)doc<span class="stringliteral">&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="stringliteral">}</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="stringliteral">void ERF::print_error(MPI_Comm comm, const std::string&amp; msg)</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="stringliteral">{</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="stringliteral">#ifdef AMREX_USE_MPI</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="stringliteral">    int irank = 0;</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="stringliteral">    int num_ranks = 1;</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="stringliteral">    MPI_Comm_size(comm, &amp;num_ranks);</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="stringliteral">    MPI_Comm_rank(comm, &amp;irank);</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="stringliteral"></span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_addc510dbf758a33cc095d64a9b17076c_icgraph.png" border="0" usemap="#aclassERF_addc510dbf758a33cc095d64a9b17076c_icgraph" alt=""/></div>
<map name="aclassERF_addc510dbf758a33cc095d64a9b17076c_icgraph" id="aclassERF_addc510dbf758a33cc095d64a9b17076c_icgraph">
<area shape="rect" title=" " alt="" coords="108,5,231,32"/>
<area shape="rect" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,60,32"/>
</map>
</div>

</div>
</div>
<a id="afa432756254529fb37b921088f0960d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa432756254529fb37b921088f0960d2">&#9670;&nbsp;</a></span>print_summary()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void ERF::print_summary </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a15af18ae136cf3a11bb63fe0cf3924c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15af18ae136cf3a11bb63fe0cf3924c8">&#9670;&nbsp;</a></span>print_tpls()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::print_tpls </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>out</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                      :<span class="comment">//github.com/erf-model/ERF/blob/development/LICENSE for details. &quot;</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        &lt;&lt; dash_line &lt;&lt; std::endl;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="comment">// clang-format on</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;}</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classERF.html#a15af18ae136cf3a11bb63fe0cf3924c8">ERF::print_tpls</a>(std::ostream&amp; out)</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;{</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    amrex::Vector&lt;std::string&gt; tpls;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="preprocessor">#ifdef ERF_USE_NETCDF</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    tpls.push_back(std::string(<span class="stringliteral">&quot;NetCDF    &quot;</span>) + NC_VERSION);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="preprocessor">#ifdef AMREX_USE_SUNDIALS</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    tpls.push_back(std::string(<span class="stringliteral">&quot;SUNDIALS     &quot;</span>) + SUNDIALS_VERSION);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordflow">if</span> (!tpls.empty()) {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        out &lt;&lt; <span class="stringliteral">&quot;  Enabled third-party libraries: &quot;</span>;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; val : tpls) {</div>
<div class="ttc" id="aclassERF_html_a15af18ae136cf3a11bb63fe0cf3924c8"><div class="ttname"><a href="classERF.html#a15af18ae136cf3a11bb63fe0cf3924c8">ERF::print_tpls</a></div><div class="ttdeci">static void print_tpls(std::ostream &amp;)</div><div class="ttdef"><b>Definition:</b> console_io.cpp:137</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aeaeb11001478b0635ef0fe3baa396df1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeaeb11001478b0635ef0fe3baa396df1">&#9670;&nbsp;</a></span>print_usage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::print_usage </td>
          <td>(</td>
          <td class="paramtype">MPI_Comm&#160;</td>
          <td class="paramname"><em>comm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;{</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#ifdef AMREX_USE_MPI</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keywordtype">int</span> irank = 0;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="keywordtype">int</span> num_ranks = 1;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    MPI_Comm_size(comm, &amp;num_ranks);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    MPI_Comm_rank(comm, &amp;irank);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="comment">// Only root process does the printing</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keywordflow">if</span> (irank != 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    amrex::ignore_unused(comm);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    out &lt;&lt; R<span class="stringliteral">&quot;doc(Usage:</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="stringliteral">    ERF3d.*.ex &lt;input_file&gt; [param=value] [param=value] ...</span></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_aeaeb11001478b0635ef0fe3baa396df1_icgraph.png" border="0" usemap="#aclassERF_aeaeb11001478b0635ef0fe3baa396df1_icgraph" alt=""/></div>
<map name="aclassERF_aeaeb11001478b0635ef0fe3baa396df1_icgraph" id="aclassERF_aeaeb11001478b0635ef0fe3baa396df1_icgraph">
<area shape="rect" title=" " alt="" coords="108,5,239,32"/>
<area shape="rect" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,60,32"/>
</map>
</div>

</div>
</div>
<a id="af285247b24b173cd851fe49799d17f42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af285247b24b173cd851fe49799d17f42">&#9670;&nbsp;</a></span>ReadCheckpointFile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::ReadCheckpointFile </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p><a class="el" href="classERF.html">ERF</a> function for reading data from a checkpoint file during restart. </p>
<div class="fragment"><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;{</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    Print() &lt;&lt; <span class="stringliteral">&quot;Restart from native checkpoint &quot;</span> &lt;&lt; <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="comment">// Header</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    std::string File(<a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a> + <span class="stringliteral">&quot;/Header&quot;</span>);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    VisMF::IO_Buffer io_buffer(VisMF::GetIOBufferSize());</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    Vector&lt;char&gt; fileCharPtr;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    ParallelDescriptor::ReadAndBcastFile(File, fileCharPtr);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    std::string fileCharPtrString(fileCharPtr.dataPtr());</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    std::istringstream is(fileCharPtrString, std::istringstream::in);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    std::string line, word;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordtype">int</span> chk_ncomp_cons, chk_ncomp;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160; </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="comment">// read in title line</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    std::getline(is, line);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="comment">// read in finest_level</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    is &gt;&gt; finest_level;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <a class="code" href="classERF.html#aaee255b031e63bd9b5807f6612739dbd">GotoNextLine</a>(is);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="comment">// read the number of components</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="comment">// for each variable we store</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="comment">// conservative, cell-centered vars</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    is &gt;&gt; chk_ncomp_cons;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <a class="code" href="classERF.html#aaee255b031e63bd9b5807f6612739dbd">GotoNextLine</a>(is);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="comment">// x-velocity on faces</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    is &gt;&gt; chk_ncomp;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <a class="code" href="classERF.html#aaee255b031e63bd9b5807f6612739dbd">GotoNextLine</a>(is);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    AMREX_ASSERT(chk_ncomp == 1);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160; </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="comment">// y-velocity on faces</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    is &gt;&gt; chk_ncomp;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <a class="code" href="classERF.html#aaee255b031e63bd9b5807f6612739dbd">GotoNextLine</a>(is);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    AMREX_ASSERT(chk_ncomp == 1);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="comment">// z-velocity on faces</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    is &gt;&gt; chk_ncomp;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <a class="code" href="classERF.html#aaee255b031e63bd9b5807f6612739dbd">GotoNextLine</a>(is);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    AMREX_ASSERT(chk_ncomp == 1);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="comment">// read in array of istep</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    std::getline(is, line);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    {</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        std::istringstream lis(line);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <span class="keywordflow">while</span> (lis &gt;&gt; word) {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[i++] = std::stoi(word);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    }</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="comment">// read in array of dt</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    std::getline(is, line);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    {</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        std::istringstream lis(line);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <span class="keywordflow">while</span> (lis &gt;&gt; word) {</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[i++] = std::stod(word);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        }</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    }</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="comment">// read in array of t_new</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    std::getline(is, line);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    {</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        std::istringstream lis(line);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        <span class="keywordflow">while</span> (lis &gt;&gt; word) {</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[i++] = std::stod(word);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        }</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    }</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160; </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <span class="comment">// read in level &#39;lev&#39; BoxArray from Header</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        BoxArray ba;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        ba.readFrom(is);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <a class="code" href="classERF.html#aaee255b031e63bd9b5807f6612739dbd">GotoNextLine</a>(is);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        <span class="comment">// create a distribution mapping</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        DistributionMapping dm { ba, ParallelDescriptor::NProcs() };</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160; </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        <a class="code" href="classERF.html#aaf10bbf8c9a5dbc257a88c4c1b650fee">MakeNewLevelFromScratch</a> (lev, <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev], ba, dm);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    }</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="comment">// ncomp is only valid after we MakeNewLevelFromScratch (asks micro how many vars)</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="comment">// NOTE: Data is written over ncomp, so check that we match the header file</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="keywordtype">int</span> ncomp_cons = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[0][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nComp();</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    AMREX_ASSERT(chk_ncomp_cons == ncomp_cons);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160; </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="comment">// read in the MultiFab data</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev)</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    {</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        MultiFab <a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">cons</a>(grids[lev],dmap[lev],ncomp_cons,0);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        VisMF::Read(<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">cons</a>, MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;Cell&quot;</span>));</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        MultiFab::Copy(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">cons</a>,0,0,ncomp_cons,0);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].setBndry(1.0e34);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        MultiFab <a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">xvel</a>(convert(grids[lev],IntVect(1,0,0)),dmap[lev],1,0);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        VisMF::Read(<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">xvel</a>, MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;XFace&quot;</span>));</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        MultiFab::Copy(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">xvel</a>,0,0,1,0);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].setBndry(1.0e34);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        MultiFab <a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">yvel</a>(convert(grids[lev],IntVect(0,1,0)),dmap[lev],1,0);</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        VisMF::Read(<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">yvel</a>, MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;YFace&quot;</span>));</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        MultiFab::Copy(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">yvel</a>,0,0,1,0);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].setBndry(1.0e34);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        MultiFab <a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">zvel</a>(convert(grids[lev],IntVect(0,0,1)),dmap[lev],1,0);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        VisMF::Read(<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">zvel</a>, MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;ZFace&quot;</span>));</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        MultiFab::Copy(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>],<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">zvel</a>,0,0,1,0);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].setBndry(1.0e34);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160; </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <span class="comment">// Note that we read the ghost cells of the base state (unlike above)</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        IntVect ng = <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].nGrowVect();</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        MultiFab base(grids[lev],dmap[lev],<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].nComp(),ng);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        VisMF::Read(base, MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;BaseState&quot;</span>));</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        MultiFab::Copy(<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev],base,0,0,base.nComp(),ng);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160; </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a063a88594452100497651e8aaf1f68d7">use_terrain</a>)  {</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;           <span class="comment">// Note that we also read the ghost cells of z_phys_nd</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;           ng = <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev]-&gt;nGrowVect();</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;           MultiFab z_height(convert(grids[lev],IntVect(1,1,1)),dmap[lev],1,ng);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;           VisMF::Read(z_height, MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;Z_Phys_nd&quot;</span>));</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;           MultiFab::Copy(*<a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev],z_height,0,0,1,ng);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;           <a class="code" href="classERF.html#a900a0119c110486650f2759287e22cba">update_terrain_arrays</a>(lev, <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev]);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        }</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a43c1741535574c7e6f4fe6bf90552f31">lsm_type</a> != <a class="code" href="DataStruct_8H.html#abeec366fd5381f3bb7ba39f6e5c1e7e4a6adf97f83acf6453d4a6a4b1070f3754">LandSurfaceType::None</a>) {</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> mvar(0); mvar&lt;<a class="code" href="classERF.html#ad03da3399e893728741fac33100ce476">lsm_data</a>[lev].size(); ++mvar) {</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                BoxArray ba = <a class="code" href="classERF.html#ad03da3399e893728741fac33100ce476">lsm_data</a>[lev][mvar]-&gt;boxArray();</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                DistributionMapping dm = <a class="code" href="classERF.html#ad03da3399e893728741fac33100ce476">lsm_data</a>[lev][mvar]-&gt;DistributionMap();</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                ng = <a class="code" href="classERF.html#ad03da3399e893728741fac33100ce476">lsm_data</a>[lev][mvar]-&gt;nGrowVect();</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                <span class="keywordtype">int</span> nvar = <a class="code" href="classERF.html#ad03da3399e893728741fac33100ce476">lsm_data</a>[lev][mvar]-&gt;nComp();</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                MultiFab lsm_vars(ba,dm,nvar,ng);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                VisMF::Read(lsm_vars, MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;LsmVars&quot;</span>));</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                MultiFab::Copy(*(<a class="code" href="classERF.html#ad03da3399e893728741fac33100ce476">lsm_data</a>[lev][mvar]),lsm_vars,0,0,nvar,ng);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            }</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        }</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160; </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        <span class="comment">// Note that we read the ghost cells of the mapfactors</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        BoxList bl2d = grids[lev].boxList();</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; b : bl2d) {</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;            b.setRange(2,0);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        }</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        BoxArray ba2d(std::move(bl2d));</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160; </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        ng = <a class="code" href="classERF.html#a23aacdb72e9d2dfed8e2ebd2c2526497">mapfac_m</a>[lev]-&gt;nGrowVect();</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        MultiFab mf_m(ba2d,dmap[lev],1,ng);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        VisMF::Read(mf_m, MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;MapFactor_m&quot;</span>));</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        MultiFab::Copy(*<a class="code" href="classERF.html#a23aacdb72e9d2dfed8e2ebd2c2526497">mapfac_m</a>[lev],mf_m,0,0,1,ng);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160; </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        ng = <a class="code" href="classERF.html#a1e8afee1508b720dab56f5d044deb301">mapfac_u</a>[lev]-&gt;nGrowVect();</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        MultiFab mf_u(convert(ba2d,IntVect(1,0,0)),dmap[lev],1,ng);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        VisMF::Read(mf_u, MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;MapFactor_u&quot;</span>));</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        MultiFab::Copy(*<a class="code" href="classERF.html#a1e8afee1508b720dab56f5d044deb301">mapfac_u</a>[lev],mf_u,0,0,1,ng);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160; </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        ng = <a class="code" href="classERF.html#ae49b5055f9a7117fa15918a5daa775b7">mapfac_v</a>[lev]-&gt;nGrowVect();</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        MultiFab mf_v(convert(ba2d,IntVect(0,1,0)),dmap[lev],1,ng);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        VisMF::Read(mf_v, MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;MapFactor_v&quot;</span>));</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        MultiFab::Copy(*<a class="code" href="classERF.html#ae49b5055f9a7117fa15918a5daa775b7">mapfac_v</a>[lev],mf_v,0,0,1,ng);</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    }</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160; </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="preprocessor">#ifdef ERF_USE_PARTICLES</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;   particleData.Restart((ParGDBBase*)GetParGDB(),<a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="preprocessor">#ifdef ERF_USE_NETCDF</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="comment">// Read bdy_data files</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="classERF.html#af5ac3d88a33a1a284bcc120ce0599cf7">init_type</a>==<span class="stringliteral">&quot;real&quot;</span>) || (<a class="code" href="classERF.html#af5ac3d88a33a1a284bcc120ce0599cf7">init_type</a>==<span class="stringliteral">&quot;metgrid&quot;</span>)) {</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        <span class="keywordtype">int</span> ioproc = ParallelDescriptor::IOProcessorNumber();  <span class="comment">// I/O rank</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        <span class="keywordtype">int</span> num_time;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        <span class="keywordtype">int</span> num_var;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        Vector&lt;Box&gt; bx_v;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        <span class="keywordflow">if</span> (ParallelDescriptor::IOProcessor()) {</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;            <span class="comment">// Open header file and read from it</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;            std::ifstream bdy_h_file(MultiFabFileFullPrefix(0, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;bdy_H&quot;</span>));</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;            bdy_h_file &gt;&gt; num_time;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            bdy_h_file &gt;&gt; num_var;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;            bdy_h_file &gt;&gt; start_bdy_time;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;            bdy_h_file &gt;&gt; bdy_time_interval;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            bdy_h_file &gt;&gt; <a class="code" href="classERF.html#abb15119348ad5399947bc8883084b230">real_width</a>;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;            bx_v.resize(4*num_var);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ivar(0); ivar&lt;num_var; ++ivar) {</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                bdy_h_file &gt;&gt; bx_v[4*ivar  ];</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                bdy_h_file &gt;&gt; bx_v[4*ivar+1];</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                bdy_h_file &gt;&gt; bx_v[4*ivar+2];</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                bdy_h_file &gt;&gt; bx_v[4*ivar+3];</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;            }</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160; </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            <span class="comment">// IO size the FABs</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;            bdy_data_xlo.resize(num_time);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;            bdy_data_xhi.resize(num_time);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;            bdy_data_ylo.resize(num_time);</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;            bdy_data_yhi.resize(num_time);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> itime(0); itime&lt;num_time; ++itime) {</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                bdy_data_xlo[itime].resize(num_var);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                bdy_data_xhi[itime].resize(num_var);</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                bdy_data_ylo[itime].resize(num_var);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                bdy_data_yhi[itime].resize(num_var);</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ivar(0); ivar&lt;num_var; ++ivar) {</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                    bdy_data_xlo[itime][ivar].resize(bx_v[4*ivar  ]);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                    bdy_data_xhi[itime][ivar].resize(bx_v[4*ivar+1]);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                    bdy_data_ylo[itime][ivar].resize(bx_v[4*ivar+2]);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                    bdy_data_yhi[itime][ivar].resize(bx_v[4*ivar+3]);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                }</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;            }</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160; </div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            <span class="comment">// Open data file and read from it</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;            std::ifstream bdy_d_file(MultiFabFileFullPrefix(0, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;bdy_D&quot;</span>));</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> itime(0); itime&lt;num_time; ++itime) {</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ivar(0); ivar&lt;num_var; ++ivar) {</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                    bdy_data_xlo[itime][ivar].readFrom(bdy_d_file);</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                    bdy_data_xhi[itime][ivar].readFrom(bdy_d_file);</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                    bdy_data_ylo[itime][ivar].readFrom(bdy_d_file);</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                    bdy_data_yhi[itime][ivar].readFrom(bdy_d_file);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                }</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;            }</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        } <span class="comment">// IO</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160; </div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <span class="comment">// Broadcast the data</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        ParallelDescriptor::Barrier();</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        ParallelDescriptor::Bcast(&amp;start_bdy_time,1,ioproc);</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        ParallelDescriptor::Bcast(&amp;bdy_time_interval,1,ioproc);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        ParallelDescriptor::Bcast(&amp;<a class="code" href="classERF.html#abb15119348ad5399947bc8883084b230">real_width</a>,1,ioproc);</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        ParallelDescriptor::Bcast(&amp;num_time,1,ioproc);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        ParallelDescriptor::Bcast(&amp;num_var,1,ioproc);</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160; </div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        <span class="comment">// Everyone size their boxes</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        bx_v.resize(4*num_var);</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160; </div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        ParallelDescriptor::Bcast(bx_v.dataPtr(),bx_v.size(),ioproc);</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160; </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        <span class="comment">// Everyone but IO size their FABs</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        <span class="keywordflow">if</span> (!ParallelDescriptor::IOProcessor()) {</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;          bdy_data_xlo.resize(num_time);</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;          bdy_data_xhi.resize(num_time);</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;          bdy_data_ylo.resize(num_time);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;          bdy_data_yhi.resize(num_time);</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> itime(0); itime&lt;num_time; ++itime) {</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;            bdy_data_xlo[itime].resize(num_var);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            bdy_data_xhi[itime].resize(num_var);</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            bdy_data_ylo[itime].resize(num_var);</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            bdy_data_yhi[itime].resize(num_var);</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ivar(0); ivar&lt;num_var; ++ivar) {</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;              bdy_data_xlo[itime][ivar].resize(bx_v[4*ivar  ]);</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;              bdy_data_xhi[itime][ivar].resize(bx_v[4*ivar+1]);</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;              bdy_data_ylo[itime][ivar].resize(bx_v[4*ivar+2]);</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;              bdy_data_yhi[itime][ivar].resize(bx_v[4*ivar+3]);</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;            }</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;          }</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        }</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160; </div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> itime(0); itime&lt;num_time; ++itime) {</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ivar(0); ivar&lt;num_var; ++ivar) {</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                ParallelDescriptor::Bcast(bdy_data_xlo[itime][ivar].dataPtr(),bdy_data_xlo[itime][ivar].box().numPts(),ioproc);</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                ParallelDescriptor::Bcast(bdy_data_xhi[itime][ivar].dataPtr(),bdy_data_xhi[itime][ivar].box().numPts(),ioproc);</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                ParallelDescriptor::Bcast(bdy_data_ylo[itime][ivar].dataPtr(),bdy_data_ylo[itime][ivar].box().numPts(),ioproc);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                ParallelDescriptor::Bcast(bdy_data_yhi[itime][ivar].dataPtr(),bdy_data_yhi[itime][ivar].box().numPts(),ioproc);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;            }</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        }</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    } <span class="comment">// init real</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_aaee255b031e63bd9b5807f6612739dbd"><div class="ttname"><a href="classERF.html#aaee255b031e63bd9b5807f6612739dbd">ERF::GotoNextLine</a></div><div class="ttdeci">static void GotoNextLine(std::istream &amp;is)</div><div class="ttdef"><b>Definition:</b> Checkpoint.cpp:13</div></div>
<div class="ttc" id="aclassERF_html_aaf10bbf8c9a5dbc257a88c4c1b650fee"><div class="ttname"><a href="classERF.html#aaf10bbf8c9a5dbc257a88c4c1b650fee">ERF::MakeNewLevelFromScratch</a></div><div class="ttdeci">void MakeNewLevelFromScratch(int lev, amrex::Real time, const amrex::BoxArray &amp;ba, const amrex::DistributionMapping &amp;dm) override</div><div class="ttdef"><b>Definition:</b> ERF_make_new_level.cpp:30</div></div>
<div class="ttc" id="aclassERF_html_abb15119348ad5399947bc8883084b230"><div class="ttname"><a href="classERF.html#abb15119348ad5399947bc8883084b230">ERF::real_width</a></div><div class="ttdeci">int real_width</div><div class="ttdef"><b>Definition:</b> ERF.H:777</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2d39cd3bdc3d90609ad3b14e266d190a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d39cd3bdc3d90609ad3b14e266d190a">&#9670;&nbsp;</a></span>ReadParameters()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::ReadParameters </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;{</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    {</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;        ParmParse <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>;  <span class="comment">// Traditionally, max_step and stop_time do not have prefix.</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;max_step&quot;</span>, <a class="code" href="classERF.html#a0634154e8e58379c495c3e7fe7c5e4d6">max_step</a>);</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;stop_time&quot;</span>, <a class="code" href="classERF.html#a405556a52bef334ab68294c1a540e107">stop_time</a>);</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160; </div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;start_time&quot;</span>, <a class="code" href="classERF.html#aa0c07f31b23d977646b8161e5473fab5">start_time</a>); <span class="comment">// This is optional, it defaults to 0</span></div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    }</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160; </div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    ParmParse <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>(<a class="code" href="classERF.html#a59df30e7a5537c8543bb00772bd98b58">pp_prefix</a>);</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    ParmParse pp_amr(<span class="stringliteral">&quot;amr&quot;</span>);</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    {</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;        <span class="comment">// The type of the file we restart from</span></div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;restart_type&quot;</span>, <a class="code" href="classERF.html#a30a0b9e3a037c71580d1feb3b30a8258">restart_type</a>);</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160; </div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;regrid_int&quot;</span>, <a class="code" href="classERF.html#a3937527f96c81674fa38dc34ed24f3f5">regrid_int</a>);</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;check_file&quot;</span>, <a class="code" href="classERF.html#ae701564fbe3da5bbd88587e5a08eca4e">check_file</a>);</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;check_type&quot;</span>, <a class="code" href="classERF.html#a32e0d0f5ae0db18ee81f9d4325a14f64">check_type</a>);</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160; </div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;        <span class="comment">// The regression tests use &quot;amr.restart&quot; and &quot;amr.m_check_int&quot; so we allow</span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;        <span class="comment">//    for those or &quot;erf.restart&quot; / &quot;erf.m_check_int&quot; with the former taking</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;        <span class="comment">//    precedence if both are specified</span></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;check_int&quot;</span>, <a class="code" href="classERF.html#a69a3f925e95ec4244b0257f9de16d65a">m_check_int</a>);</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;check_per&quot;</span>, <a class="code" href="classERF.html#a5fbf17cfc8d9e5b994783e05ec3594b2">m_check_per</a>);</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;        pp_amr.query(<span class="stringliteral">&quot;check_int&quot;</span>, <a class="code" href="classERF.html#a69a3f925e95ec4244b0257f9de16d65a">m_check_int</a>);</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;        pp_amr.query(<span class="stringliteral">&quot;check_per&quot;</span>, <a class="code" href="classERF.html#a5fbf17cfc8d9e5b994783e05ec3594b2">m_check_per</a>);</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160; </div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;restart&quot;</span>, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>);</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;        pp_amr.query(<span class="stringliteral">&quot;restart&quot;</span>, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>);</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160; </div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;        <span class="comment">// Verbosity</span></div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;v&quot;</span>, <a class="code" href="classERF.html#a43d0b17f6e155691a1e9474526df3af5">verbose</a>);</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160; </div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;        <span class="comment">// Frequency of diagnostic output</span></div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;sum_interval&quot;</span>, <a class="code" href="classERF.html#a5232e98479611a24fe97994640c61faa">sum_interval</a>);</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;sum_period&quot;</span>  , <a class="code" href="classERF.html#a1cf2ba396f4404724824516da4c4a084">sum_per</a>);</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160; </div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;        <span class="comment">// Time step controls</span></div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;cfl&quot;</span>, <a class="code" href="classERF.html#a89f605d1a1eae06a7c79f9b6b65c637f">cfl</a>);</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;init_shrink&quot;</span>, <a class="code" href="classERF.html#ad353aa9e275612ff2110c5a1405c1176">init_shrink</a>);</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;change_max&quot;</span>, <a class="code" href="classERF.html#ae16d413b172bb3b3400af6d5cb236fd4">change_max</a>);</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160; </div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;fixed_dt&quot;</span>, <a class="code" href="classERF.html#acd88606a88916719171a267e9edf54c7">fixed_dt</a>);</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;fixed_fast_dt&quot;</span>, <a class="code" href="classERF.html#a20f8ed606dd006f84efa4ebed7b96130">fixed_fast_dt</a>);</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;fixed_mri_dt_ratio&quot;</span>, <a class="code" href="classERF.html#ad2e1a979c0ad68e87eaee349beb7e9fd">fixed_mri_dt_ratio</a>);</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160; </div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;        <span class="comment">// If this is set, it must be even</span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ad2e1a979c0ad68e87eaee349beb7e9fd">fixed_mri_dt_ratio</a> &gt; 0 &amp;&amp; (<a class="code" href="classERF.html#ad2e1a979c0ad68e87eaee349beb7e9fd">fixed_mri_dt_ratio</a>%2 != 0) )</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;        {</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;            Abort(<span class="stringliteral">&quot;If you specify fixed_mri_dt_ratio, it must be even&quot;</span>);</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;        }</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160; </div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;        <span class="comment">// If both fixed_dt and fast_dt are specified, their ratio must be an even integer</span></div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#acd88606a88916719171a267e9edf54c7">fixed_dt</a> &gt; 0. &amp;&amp; <a class="code" href="classERF.html#a20f8ed606dd006f84efa4ebed7b96130">fixed_fast_dt</a> &gt; 0. &amp;&amp; <a class="code" href="classERF.html#ad2e1a979c0ad68e87eaee349beb7e9fd">fixed_mri_dt_ratio</a> &lt;= 0)</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;        {</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;            Real eps = 1.e-12;</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;            <span class="keywordtype">int</span> ratio = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( ( (1.0+eps) * <a class="code" href="classERF.html#acd88606a88916719171a267e9edf54c7">fixed_dt</a> ) / <a class="code" href="classERF.html#a20f8ed606dd006f84efa4ebed7b96130">fixed_fast_dt</a> );</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#acd88606a88916719171a267e9edf54c7">fixed_dt</a> / <a class="code" href="classERF.html#a20f8ed606dd006f84efa4ebed7b96130">fixed_fast_dt</a> != ratio)</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;            {</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;                Abort(<span class="stringliteral">&quot;Ratio of fixed_dt to fixed_fast_dt must be an even integer&quot;</span>);</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;            }</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;        }</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160; </div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;        <span class="comment">// If all three are specified, they must be consistent</span></div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#acd88606a88916719171a267e9edf54c7">fixed_dt</a> &gt; 0. &amp;&amp; <a class="code" href="classERF.html#a20f8ed606dd006f84efa4ebed7b96130">fixed_fast_dt</a> &gt; 0. &amp;&amp;  <a class="code" href="classERF.html#ad2e1a979c0ad68e87eaee349beb7e9fd">fixed_mri_dt_ratio</a> &gt; 0)</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;        {</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#acd88606a88916719171a267e9edf54c7">fixed_dt</a> / <a class="code" href="classERF.html#a20f8ed606dd006f84efa4ebed7b96130">fixed_fast_dt</a> != <a class="code" href="classERF.html#ad2e1a979c0ad68e87eaee349beb7e9fd">fixed_mri_dt_ratio</a>)</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;            {</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;                Abort(<span class="stringliteral">&quot;Dt is over-specfied&quot;</span>);</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;            }</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;        }</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160; </div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;        AMREX_ALWAYS_ASSERT(<a class="code" href="classERF.html#a89f605d1a1eae06a7c79f9b6b65c637f">cfl</a> &gt; 0. || <a class="code" href="classERF.html#acd88606a88916719171a267e9edf54c7">fixed_dt</a> &gt; 0.);</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160; </div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;        <span class="comment">// How to initialize</span></div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;init_type&quot;</span>,<a class="code" href="classERF.html#af5ac3d88a33a1a284bcc120ce0599cf7">init_type</a>);</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classERF.html#af5ac3d88a33a1a284bcc120ce0599cf7">init_type</a>.empty() &amp;&amp;</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;            <a class="code" href="classERF.html#af5ac3d88a33a1a284bcc120ce0599cf7">init_type</a> != <span class="stringliteral">&quot;uniform&quot;</span> &amp;&amp;</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;            <a class="code" href="classERF.html#af5ac3d88a33a1a284bcc120ce0599cf7">init_type</a> != <span class="stringliteral">&quot;ideal&quot;</span> &amp;&amp;</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;            <a class="code" href="classERF.html#af5ac3d88a33a1a284bcc120ce0599cf7">init_type</a> != <span class="stringliteral">&quot;real&quot;</span> &amp;&amp;</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;            <a class="code" href="classERF.html#af5ac3d88a33a1a284bcc120ce0599cf7">init_type</a> != <span class="stringliteral">&quot;metgrid&quot;</span> &amp;&amp;</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;            <a class="code" href="classERF.html#af5ac3d88a33a1a284bcc120ce0599cf7">init_type</a> != <span class="stringliteral">&quot;input_sounding&quot;</span>)</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;        {</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;            Error(<span class="stringliteral">&quot;if specified, init_type must be uniform, ideal, real, metgrid or input_sounding&quot;</span>);</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;        }</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160; </div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;        <span class="comment">// Should we use the bcs we&#39;ve read in from wrfbdy or metgrid files?</span></div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;        <span class="comment">// We default to yes if we have them, but the user can override that option</span></div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;        <a class="code" href="classERF.html#a86208285bf705f360a3c318a75097f61">use_real_bcs</a> = ( (<a class="code" href="classERF.html#af5ac3d88a33a1a284bcc120ce0599cf7">init_type</a> == <span class="stringliteral">&quot;real&quot;</span>) || (<a class="code" href="classERF.html#af5ac3d88a33a1a284bcc120ce0599cf7">init_type</a> == <span class="stringliteral">&quot;metgrid&quot;</span>) );</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;use_real_bcs&quot;</span>,<a class="code" href="classERF.html#a86208285bf705f360a3c318a75097f61">use_real_bcs</a>);</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160; </div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;        <span class="comment">// We don&#39;t allow use_real_bcs to be true if init_type is not either real or metgrid</span></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;        AMREX_ALWAYS_ASSERT(!<a class="code" href="classERF.html#a86208285bf705f360a3c318a75097f61">use_real_bcs</a> || ((<a class="code" href="classERF.html#af5ac3d88a33a1a284bcc120ce0599cf7">init_type</a> == <span class="stringliteral">&quot;real&quot;</span>) || (<a class="code" href="classERF.html#af5ac3d88a33a1a284bcc120ce0599cf7">init_type</a> == <span class="stringliteral">&quot;metgrid&quot;</span>)) );</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160; </div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;        <span class="comment">// No moving terrain with init real</span></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#af5ac3d88a33a1a284bcc120ce0599cf7">init_type</a> == <span class="stringliteral">&quot;real&quot;</span> &amp;&amp; <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> != <a class="code" href="DataStruct_8H.html#af82ff6f1edafee12190434b73fe91127a84a8921b25f505d0d2077aeb5db4bc16">TerrainType::Static</a>) {</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;            Abort(<span class="stringliteral">&quot;Moving terrain is not supported with init real&quot;</span>);</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;        }</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160; </div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;        <span class="comment">// We use this to keep track of how many boxes we read in from WRF initialization</span></div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;        <a class="code" href="classERF.html#a610a988f46e0496e6dbd0471ae817f75">num_files_at_level</a>.resize(max_level+1,0);</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160; </div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;        <span class="comment">// We use this to keep track of how many boxes are specified thru the refinement indicators</span></div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;        <a class="code" href="classERF.html#adcd9f23975ffa605247b41d391c2a2f0">num_boxes_at_level</a>.resize(max_level+1,0);</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;            <a class="code" href="classERF.html#a050dbd236c9bf246554a53008e09f683">boxes_at_level</a>.resize(max_level+1);</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160; </div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;        <span class="comment">// These hold the minimum and maximum value of k in the boxes *at each level*</span></div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;        <a class="code" href="classERF.html#a46a3587ddcfacba35dcf52189cc1be86">min_k_at_level</a>.resize(max_level+1,0);</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;        <a class="code" href="classERF.html#a9108040a44e5e64853ac7d6529538315">max_k_at_level</a>.resize(max_level+1,0);</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160; </div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;        <span class="comment">// We always have exactly one file at level 0</span></div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;        <a class="code" href="classERF.html#adcd9f23975ffa605247b41d391c2a2f0">num_boxes_at_level</a>[0] = 1;</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;        <a class="code" href="classERF.html#a050dbd236c9bf246554a53008e09f683">boxes_at_level</a>[0].resize(1);</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;        <a class="code" href="classERF.html#a050dbd236c9bf246554a53008e09f683">boxes_at_level</a>[0][0] = geom[0].Domain();</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160; </div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;<span class="preprocessor">#ifdef ERF_USE_NETCDF</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;        <a class="code" href="classERF.html#a7ef14f6028b577eba70aef46b508be19">nc_init_file</a>.resize(max_level+1);</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160; </div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;        <span class="comment">// NetCDF wrfinput initialization files -- possibly multiple files at each of multiple levels</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;        <span class="comment">//        but we always have exactly one file at level 0</span></div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= max_level; lev++)</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;        {</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;            <span class="keyword">const</span> std::string nc_file_names = Concatenate(<span class="stringliteral">&quot;nc_init_file_&quot;</span>,lev,1);</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.contains(nc_file_names.c_str()))</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;            {</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;                <span class="keywordtype">int</span> num_files = <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.countval(nc_file_names.c_str());</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                <a class="code" href="classERF.html#a610a988f46e0496e6dbd0471ae817f75">num_files_at_level</a>[lev] = num_files;</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;                <a class="code" href="classERF.html#a7ef14f6028b577eba70aef46b508be19">nc_init_file</a>[lev].resize(num_files);</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;                <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.queryarr(nc_file_names.c_str(), <a class="code" href="classERF.html#a7ef14f6028b577eba70aef46b508be19">nc_init_file</a>[lev],0,num_files);</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; num_files; j++)</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;                    Print() &lt;&lt; <span class="stringliteral">&quot;Reading NC init file names at level &quot;</span> &lt;&lt; lev &lt;&lt; <span class="stringliteral">&quot; and index &quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot; : &quot;</span> &lt;&lt; <a class="code" href="classERF.html#a7ef14f6028b577eba70aef46b508be19">nc_init_file</a>[lev][j] &lt;&lt; std::endl;</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;            }</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;        }</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160; </div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;        <span class="comment">// NetCDF wrfbdy lateral boundary file</span></div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;nc_bdy_file&quot;</span>, <a class="code" href="classERF.html#a7e9040f32464f1a6dee6e0384393451d">nc_bdy_file</a>);</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160; </div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;        <span class="comment">// Text input_sounding file</span></div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;input_sounding_file&quot;</span>, <a class="code" href="classERF.html#a536424e14c4139e4683b15c59e742362">input_sounding_file</a>);</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160; </div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;        <span class="comment">// Flag to trigger initialization from input_sounding like WRF&#39;s ideal.exe</span></div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;init_sounding_ideal&quot;</span>, <a class="code" href="classERF.html#a2eb81c590271b429f132103c9af25830">init_sounding_ideal</a>);</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160; </div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;        <span class="comment">// Output format</span></div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;plotfile_type&quot;</span>, <a class="code" href="classERF.html#ae7b9991150042eb38e2abc89399c0c7c">plotfile_type</a>);</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ae7b9991150042eb38e2abc89399c0c7c">plotfile_type</a> != <span class="stringliteral">&quot;amrex&quot;</span> &amp;&amp;</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;            <a class="code" href="classERF.html#ae7b9991150042eb38e2abc89399c0c7c">plotfile_type</a> != <span class="stringliteral">&quot;netcdf&quot;</span> &amp;&amp; <a class="code" href="classERF.html#ae7b9991150042eb38e2abc89399c0c7c">plotfile_type</a> != <span class="stringliteral">&quot;NetCDF&quot;</span> &amp;&amp;</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;            <a class="code" href="classERF.html#ae7b9991150042eb38e2abc89399c0c7c">plotfile_type</a> != <span class="stringliteral">&quot;hdf5&quot;</span>   &amp;&amp; <a class="code" href="classERF.html#ae7b9991150042eb38e2abc89399c0c7c">plotfile_type</a> != <span class="stringliteral">&quot;HDF5&quot;</span> )</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;        {</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;            Print() &lt;&lt; <span class="stringliteral">&quot;User selected plotfile_type = &quot;</span> &lt;&lt; <a class="code" href="classERF.html#ae7b9991150042eb38e2abc89399c0c7c">plotfile_type</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;            Abort(<span class="stringliteral">&quot;Dont know this plotfile_type&quot;</span>);</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;        }</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;plot_file_1&quot;</span>,   <a class="code" href="classERF.html#aa54aaa938a18d34caa4d86e977647899">plot_file_1</a>);</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;plot_file_2&quot;</span>,   <a class="code" href="classERF.html#a18fa84b06132715757d97ec38678aa2c">plot_file_2</a>);</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;plot_int_1&quot;</span> , <a class="code" href="classERF.html#a57cfb4bfead8525174646964992c7e69">m_plot_int_1</a>);</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;plot_int_2&quot;</span> , <a class="code" href="classERF.html#ad3311c9ceacd17f34bdb5e03cefa33b3">m_plot_int_2</a>);</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;plot_per_1&quot;</span>,  <a class="code" href="classERF.html#a3167adc9518cce649a90ab82e9f9c85d">m_plot_per_1</a>);</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;plot_per_2&quot;</span>,  <a class="code" href="classERF.html#aff879a9c686293a10a3a03027b765c51">m_plot_per_2</a>);</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160; </div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;        <span class="keywordflow">if</span> ( (<a class="code" href="classERF.html#a57cfb4bfead8525174646964992c7e69">m_plot_int_1</a> &gt; 0 &amp;&amp; <a class="code" href="classERF.html#a3167adc9518cce649a90ab82e9f9c85d">m_plot_per_1</a> &gt; 0) ||</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;             (<a class="code" href="classERF.html#ad3311c9ceacd17f34bdb5e03cefa33b3">m_plot_int_2</a> &gt; 0 &amp;&amp; <a class="code" href="classERF.html#aff879a9c686293a10a3a03027b765c51">m_plot_per_2</a> &gt; 0.) ) {</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;            Abort(<span class="stringliteral">&quot;Must choose only one of plot_int or plot_per&quot;</span>);</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;        }</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160; </div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;profile_int&quot;</span>, <a class="code" href="classERF.html#a633cd0b44d2e38f02c23e953aecd69eb">profile_int</a>);</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;interp_profiles_to_cc&quot;</span>, <a class="code" href="classERF.html#a2aa0f6b2edd9efd9b090e39db1effcdf">cc_profiles</a>);</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160; </div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;plot_lsm&quot;</span>, <a class="code" href="classERF.html#afc653b103aa26c56acafed85cdd95f52">plot_lsm</a>);</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160; </div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;output_1d_column&quot;</span>, <a class="code" href="classERF.html#ad17ff2753e754ff3eb1330612b820b5f">output_1d_column</a>);</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;column_per&quot;</span>, <a class="code" href="classERF.html#a7b0175190c6fcf829c7f2841f729b12a">column_per</a>);</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;column_interval&quot;</span>, <a class="code" href="classERF.html#afa0bef6d3146788302b81c0d4f4802d1">column_interval</a>);</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;column_loc_x&quot;</span>, <a class="code" href="classERF.html#a930b7d48218b3fc41d8719b50b3f6086">column_loc_x</a>);</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;column_loc_y&quot;</span>, <a class="code" href="classERF.html#a2b911f3a5a324813b1ff4462df6044a6">column_loc_y</a>);</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;column_file_name&quot;</span>, <a class="code" href="classERF.html#a48bba6b1c1b39940b09aefbe56311e2f">column_file_name</a>);</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160; </div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;        <span class="comment">// Specify information about outputting planes of data</span></div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;output_bndry_planes&quot;</span>, <a class="code" href="classERF.html#a7c448670f7a5cadd6fe56f7e615c9eb6">output_bndry_planes</a>);</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;bndry_output_planes_interval&quot;</span>, <a class="code" href="classERF.html#aab4575d8fb57595a2f1aaf088c60447a">bndry_output_planes_interval</a>);</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;bndry_output_planes_per&quot;</span>, <a class="code" href="classERF.html#a5f99e949c83d86507e003ae556cf7c22">bndry_output_planes_per</a>);</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;bndry_output_start_time&quot;</span>, <a class="code" href="classERF.html#a87e58f16f44a6cb35d6983ed3fe7d3c1">bndry_output_planes_start_time</a>);</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160; </div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;        <span class="comment">// Specify whether ingest boundary planes of data</span></div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;input_bndry_planes&quot;</span>, <a class="code" href="classERF.html#a80ad08512968ec45635df68abe66b1fc">input_bndry_planes</a>);</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160; </div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;        <span class="comment">// Query the set and total widths for wrfbdy interior ghost cells</span></div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;real_width&quot;</span>, <a class="code" href="classERF.html#abb15119348ad5399947bc8883084b230">real_width</a>);</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;real_set_width&quot;</span>, <a class="code" href="classERF.html#acab120bb9324e7298534d765c447d703">real_set_width</a>);</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;        AMREX_ALWAYS_ASSERT(<a class="code" href="classERF.html#abb15119348ad5399947bc8883084b230">real_width</a> &gt;= 0);</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;        AMREX_ALWAYS_ASSERT(<a class="code" href="classERF.html#acab120bb9324e7298534d765c447d703">real_set_width</a> &gt;= 0);</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;        AMREX_ALWAYS_ASSERT(<a class="code" href="classERF.html#abb15119348ad5399947bc8883084b230">real_width</a> &gt;= <a class="code" href="classERF.html#acab120bb9324e7298534d765c447d703">real_set_width</a>);</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160; </div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;        <span class="comment">// Query the set and total widths for crse-fine interior ghost cells</span></div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;cf_width&quot;</span>, <a class="code" href="classERF.html#ad9084179f7384e10a519989ffd51fd34">cf_width</a>);</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;cf_set_width&quot;</span>, <a class="code" href="classERF.html#a1e3e2855b6e811596226c167573ad62d">cf_set_width</a>);</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ad9084179f7384e10a519989ffd51fd34">cf_width</a> &lt; 0 || <a class="code" href="classERF.html#a1e3e2855b6e811596226c167573ad62d">cf_set_width</a> &lt; 0 || <a class="code" href="classERF.html#ad9084179f7384e10a519989ffd51fd34">cf_width</a> &lt; <a class="code" href="classERF.html#a1e3e2855b6e811596226c167573ad62d">cf_set_width</a>) {</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;            Abort(<span class="stringliteral">&quot;You must set cf_width &gt;= cf_set_width &gt;= 0&quot;</span>);</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;        }</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;        <span class="keywordflow">if</span> (max_level &gt; 0 &amp;&amp; <a class="code" href="classERF.html#a1e3e2855b6e811596226c167573ad62d">cf_set_width</a> &gt; 0) {</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 1; lev &lt;= max_level; lev++) {</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a1e3e2855b6e811596226c167573ad62d">cf_set_width</a>%ref_ratio[lev-1][0] != 0 ||</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;                    <a class="code" href="classERF.html#a1e3e2855b6e811596226c167573ad62d">cf_set_width</a>%ref_ratio[lev-1][1] != 0 ||</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;                    <a class="code" href="classERF.html#a1e3e2855b6e811596226c167573ad62d">cf_set_width</a>%ref_ratio[lev-1][2] != 0 ) {</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;                    Abort(<span class="stringliteral">&quot;You must set cf_width to be a multiple of ref_ratio&quot;</span>);</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;                }</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;            }</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;        }</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160; </div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;        <span class="comment">// AmrMesh iterate on grids?</span></div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;        <span class="keywordtype">bool</span> iterate(<span class="keyword">true</span>);</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;        pp_amr.query(<span class="stringliteral">&quot;iterate_grids&quot;</span>,iterate);</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;        <span class="keywordflow">if</span> (!iterate) SetIterateToFalse();</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    }</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160; </div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;<span class="preprocessor">#ifdef ERF_USE_PARTICLES</span></div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;    readTracersParams();</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160; </div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;<span class="preprocessor">#ifdef ERF_USE_MULTIBLOCK</span></div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;    <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a4b0edf29a032ff18b10a42825fa9e4b6">pp_prefix</a> = <a class="code" href="classERF.html#a59df30e7a5537c8543bb00772bd98b58">pp_prefix</a>;</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160; </div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a8c15b7cf354e53ddb58bad9577d124d5">init_params</a>(max_level);</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160; </div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    <span class="comment">// What type of land surface model to use</span></div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    <span class="comment">// NOTE: Must be checked after init_params</span></div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a43c1741535574c7e6f4fe6bf90552f31">lsm_type</a> == <a class="code" href="DataStruct_8H.html#abeec366fd5381f3bb7ba39f6e5c1e7e4ad3a11aacb1a63c0b2e5165c43b8ccd68">LandSurfaceType::SLM</a>) {</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;        <a class="code" href="classERF.html#ae0e9a78f120ba632d78cbf23c97b851c">lsm</a>.<a class="code" href="classLandSurface.html#a91df3382b60a6566b78a23c87b46f065">SetModel</a>&lt;<a class="code" href="classSLM.html">SLM</a>&gt;();</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;        Print() &lt;&lt; <span class="stringliteral">&quot;SLM land surface model!\n&quot;</span>;</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a43c1741535574c7e6f4fe6bf90552f31">lsm_type</a> == <a class="code" href="DataStruct_8H.html#abeec366fd5381f3bb7ba39f6e5c1e7e4a4594809823de21e46cbf63b1bcd316b5">LandSurfaceType::MM5</a>) {</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;        <a class="code" href="classERF.html#ae0e9a78f120ba632d78cbf23c97b851c">lsm</a>.<a class="code" href="classLandSurface.html#a91df3382b60a6566b78a23c87b46f065">SetModel</a>&lt;<a class="code" href="classMM5.html">MM5</a>&gt;();</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;        Print() &lt;&lt; <span class="stringliteral">&quot;MM5 land surface model!\n&quot;</span>;</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a43c1741535574c7e6f4fe6bf90552f31">lsm_type</a> == <a class="code" href="DataStruct_8H.html#abeec366fd5381f3bb7ba39f6e5c1e7e4a6adf97f83acf6453d4a6a4b1070f3754">LandSurfaceType::None</a>) {</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;        <a class="code" href="classERF.html#ae0e9a78f120ba632d78cbf23c97b851c">lsm</a>.<a class="code" href="classLandSurface.html#a91df3382b60a6566b78a23c87b46f065">SetModel</a>&lt;<a class="code" href="classNullSurf.html">NullSurf</a>&gt;();</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;        Print() &lt;&lt; <span class="stringliteral">&quot;Null land surface model!\n&quot;</span>;</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;        Abort(<span class="stringliteral">&quot;Dont know this moisture_type!&quot;</span>) ;</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;    }</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160; </div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a43d0b17f6e155691a1e9474526df3af5">verbose</a> &gt; 0) {</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;        <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#abb95d84167308078ce369b4196ef979c">display</a>();</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;    }</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160; </div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#af976afa61859c07e6249963edc367c2d">coupling_type</a> == <a class="code" href="DataStruct_8H.html#ad285be248c0803917aaf5cf8ce62139ba6c267346f8ebb889610a5a90838be815">CouplingType::TwoWay</a> &amp;&amp; <a class="code" href="classERF.html#ad9084179f7384e10a519989ffd51fd34">cf_width</a> &gt; 0) {</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;        Abort(<span class="stringliteral">&quot;For two-way coupling you must set cf_width = 0&quot;</span>);</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    }</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;}</div>
<div class="ttc" id="aDataStruct_8H_html_abeec366fd5381f3bb7ba39f6e5c1e7e4a4594809823de21e46cbf63b1bcd316b5"><div class="ttname"><a href="DataStruct_8H.html#abeec366fd5381f3bb7ba39f6e5c1e7e4a4594809823de21e46cbf63b1bcd316b5">LandSurfaceType::MM5</a></div><div class="ttdeci">@ MM5</div></div>
<div class="ttc" id="aDataStruct_8H_html_abeec366fd5381f3bb7ba39f6e5c1e7e4ad3a11aacb1a63c0b2e5165c43b8ccd68"><div class="ttname"><a href="DataStruct_8H.html#abeec366fd5381f3bb7ba39f6e5c1e7e4ad3a11aacb1a63c0b2e5165c43b8ccd68">LandSurfaceType::SLM</a></div><div class="ttdeci">@ SLM</div></div>
<div class="ttc" id="aclassERF_html_a050dbd236c9bf246554a53008e09f683"><div class="ttname"><a href="classERF.html#a050dbd236c9bf246554a53008e09f683">ERF::boxes_at_level</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; amrex::Box &gt; &gt; boxes_at_level</div><div class="ttdef"><b>Definition:</b> ERF.H:535</div></div>
<div class="ttc" id="aclassERF_html_a18fa84b06132715757d97ec38678aa2c"><div class="ttname"><a href="classERF.html#a18fa84b06132715757d97ec38678aa2c">ERF::plot_file_2</a></div><div class="ttdeci">std::string plot_file_2</div><div class="ttdef"><b>Definition:</b> ERF.H:688</div></div>
<div class="ttc" id="aclassERF_html_a30a0b9e3a037c71580d1feb3b30a8258"><div class="ttname"><a href="classERF.html#a30a0b9e3a037c71580d1feb3b30a8258">ERF::restart_type</a></div><div class="ttdeci">std::string restart_type</div><div class="ttdef"><b>Definition:</b> ERF.H:703</div></div>
<div class="ttc" id="aclassERF_html_a3937527f96c81674fa38dc34ed24f3f5"><div class="ttname"><a href="classERF.html#a3937527f96c81674fa38dc34ed24f3f5">ERF::regrid_int</a></div><div class="ttdeci">int regrid_int</div><div class="ttdef"><b>Definition:</b> ERF.H:684</div></div>
<div class="ttc" id="aclassERF_html_a610a988f46e0496e6dbd0471ae817f75"><div class="ttname"><a href="classERF.html#a610a988f46e0496e6dbd0471ae817f75">ERF::num_files_at_level</a></div><div class="ttdeci">amrex::Vector&lt; int &gt; num_files_at_level</div><div class="ttdef"><b>Definition:</b> ERF.H:534</div></div>
<div class="ttc" id="aclassERF_html_a7e9040f32464f1a6dee6e0384393451d"><div class="ttname"><a href="classERF.html#a7e9040f32464f1a6dee6e0384393451d">ERF::nc_bdy_file</a></div><div class="ttdeci">static std::string nc_bdy_file</div><div class="ttdef"><b>Definition:</b> ERF.H:776</div></div>
<div class="ttc" id="aclassERF_html_a7ef14f6028b577eba70aef46b508be19"><div class="ttname"><a href="classERF.html#a7ef14f6028b577eba70aef46b508be19">ERF::nc_init_file</a></div><div class="ttdeci">static amrex::Vector&lt; amrex::Vector&lt; std::string &gt; &gt; nc_init_file</div><div class="ttdef"><b>Definition:</b> ERF.H:773</div></div>
<div class="ttc" id="aclassERF_html_aa54aaa938a18d34caa4d86e977647899"><div class="ttname"><a href="classERF.html#aa54aaa938a18d34caa4d86e977647899">ERF::plot_file_1</a></div><div class="ttdeci">std::string plot_file_1</div><div class="ttdef"><b>Definition:</b> ERF.H:687</div></div>
<div class="ttc" id="aclassERF_html_acab120bb9324e7298534d765c447d703"><div class="ttname"><a href="classERF.html#acab120bb9324e7298534d765c447d703">ERF::real_set_width</a></div><div class="ttdeci">int real_set_width</div><div class="ttdef"><b>Definition:</b> ERF.H:778</div></div>
<div class="ttc" id="aclassERF_html_ad353aa9e275612ff2110c5a1405c1176"><div class="ttname"><a href="classERF.html#ad353aa9e275612ff2110c5a1405c1176">ERF::init_shrink</a></div><div class="ttdeci">static amrex::Real init_shrink</div><div class="ttdef"><b>Definition:</b> ERF.H:674</div></div>
<div class="ttc" id="aclassERF_html_adcd9f23975ffa605247b41d391c2a2f0"><div class="ttname"><a href="classERF.html#adcd9f23975ffa605247b41d391c2a2f0">ERF::num_boxes_at_level</a></div><div class="ttdeci">amrex::Vector&lt; int &gt; num_boxes_at_level</div><div class="ttdef"><b>Definition:</b> ERF.H:533</div></div>
<div class="ttc" id="aclassERF_html_ae701564fbe3da5bbd88587e5a08eca4e"><div class="ttname"><a href="classERF.html#ae701564fbe3da5bbd88587e5a08eca4e">ERF::check_file</a></div><div class="ttdeci">std::string check_file</div><div class="ttdef"><b>Definition:</b> ERF.H:701</div></div>
<div class="ttc" id="aclassERF_html_ae7b9991150042eb38e2abc89399c0c7c"><div class="ttname"><a href="classERF.html#ae7b9991150042eb38e2abc89399c0c7c">ERF::plotfile_type</a></div><div class="ttdeci">static std::string plotfile_type</div><div class="ttdef"><b>Definition:</b> ERF.H:763</div></div>
<div class="ttc" id="aclassERF_html_afc653b103aa26c56acafed85cdd95f52"><div class="ttname"><a href="classERF.html#afc653b103aa26c56acafed85cdd95f52">ERF::plot_lsm</a></div><div class="ttdeci">bool plot_lsm</div><div class="ttdef"><b>Definition:</b> ERF.H:694</div></div>
<div class="ttc" id="aclassLandSurface_html_a91df3382b60a6566b78a23c87b46f065"><div class="ttname"><a href="classLandSurface.html#a91df3382b60a6566b78a23c87b46f065">LandSurface::SetModel</a></div><div class="ttdeci">void SetModel()</div><div class="ttdef"><b>Definition:</b> LandSurface.H:23</div></div>
<div class="ttc" id="aclassMM5_html"><div class="ttname"><a href="classMM5.html">MM5</a></div><div class="ttdef"><b>Definition:</b> MM5.H:26</div></div>
<div class="ttc" id="aclassNullSurf_html"><div class="ttname"><a href="classNullSurf.html">NullSurf</a></div><div class="ttdef"><b>Definition:</b> NullSurf.H:8</div></div>
<div class="ttc" id="aclassSLM_html"><div class="ttname"><a href="classSLM.html">SLM</a></div><div class="ttdef"><b>Definition:</b> SLM.H:26</div></div>
<div class="ttc" id="astructSolverChoice_html_a4b0edf29a032ff18b10a42825fa9e4b6"><div class="ttname"><a href="structSolverChoice.html#a4b0edf29a032ff18b10a42825fa9e4b6">SolverChoice::pp_prefix</a></div><div class="ttdeci">std::string pp_prefix</div><div class="ttdef"><b>Definition:</b> DataStruct.H:356</div></div>
<div class="ttc" id="astructSolverChoice_html_a8c15b7cf354e53ddb58bad9577d124d5"><div class="ttname"><a href="structSolverChoice.html#a8c15b7cf354e53ddb58bad9577d124d5">SolverChoice::init_params</a></div><div class="ttdeci">void init_params(int max_level)</div><div class="ttdef"><b>Definition:</b> DataStruct.H:61</div></div>
<div class="ttc" id="astructSolverChoice_html_abb95d84167308078ce369b4196ef979c"><div class="ttname"><a href="structSolverChoice.html#abb95d84167308078ce369b4196ef979c">SolverChoice::display</a></div><div class="ttdeci">void display()</div><div class="ttdef"><b>Definition:</b> DataStruct.H:267</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a2d39cd3bdc3d90609ad3b14e266d190a_cgraph.png" border="0" usemap="#aclassERF_a2d39cd3bdc3d90609ad3b14e266d190a_cgraph" alt=""/></div>
<map name="aclassERF_a2d39cd3bdc3d90609ad3b14e266d190a_cgraph" id="aclassERF_a2d39cd3bdc3d90609ad3b14e266d190a_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,167,32"/>
<area shape="rect" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469" title=" " alt="" coords="215,5,253,32"/>
</map>
</div>

</div>
</div>
<a id="aa90c9756f684404f8b69b8a23568b535"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa90c9756f684404f8b69b8a23568b535">&#9670;&nbsp;</a></span>refinement_criteria_setup()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::refinement_criteria_setup </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Function to define the refinement criteria based on user input </p>
<div class="fragment"><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;{</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keywordflow">if</span> (max_level &gt; 0)</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    {</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        ParmParse <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>(<a class="code" href="classERF.html#a59df30e7a5537c8543bb00772bd98b58">pp_prefix</a>);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        Vector&lt;std::string&gt; refinement_indicators;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.queryarr(<span class="stringliteral">&quot;refinement_indicators&quot;</span>,refinement_indicators,0,<a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.countval(<span class="stringliteral">&quot;refinement_indicators&quot;</span>));</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;refinement_indicators.size(); ++i)</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;            std::string ref_prefix = <a class="code" href="classERF.html#a59df30e7a5537c8543bb00772bd98b58">pp_prefix</a> + <span class="stringliteral">&quot;.&quot;</span> + refinement_indicators[i];</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;            ParmParse ppr(ref_prefix);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            RealBox realbox;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            <span class="keywordtype">int</span> lev_for_box;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            <span class="keywordflow">if</span> (ppr.countval(<span class="stringliteral">&quot;in_box_lo&quot;</span>)) {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                std::vector&lt;Real&gt; box_lo(3), box_hi(3);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                ppr.get(<span class="stringliteral">&quot;max_level&quot;</span>,lev_for_box);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                <span class="keywordflow">if</span> (lev_for_box &lt;= max_level)</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                    ppr.getarr(<span class="stringliteral">&quot;in_box_lo&quot;</span>,box_lo,0,AMREX_SPACEDIM);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                    ppr.getarr(<span class="stringliteral">&quot;in_box_hi&quot;</span>,box_hi,0,AMREX_SPACEDIM);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                    realbox = RealBox(&amp;(box_lo[0]),&amp;(box_hi[0]));</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                    Print() &lt;&lt; <span class="stringliteral">&quot;Reading &quot;</span> &lt;&lt; realbox &lt;&lt; <span class="stringliteral">&quot; at level &quot;</span> &lt;&lt; lev_for_box &lt;&lt; std::endl;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                    <a class="code" href="classERF.html#adcd9f23975ffa605247b41d391c2a2f0">num_boxes_at_level</a>[lev_for_box] += 1;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                    <span class="keyword">const</span> <span class="keyword">auto</span>* dx  = geom[lev_for_box].CellSize();</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                    <span class="keyword">const</span> Real* plo = geom[lev_for_box].ProbLo();</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                    <span class="keywordtype">int</span> ilo = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>((box_lo[0] - plo[0])/dx[0]);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                    <span class="keywordtype">int</span> jlo = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>((box_lo[1] - plo[1])/dx[1]);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                    <span class="keywordtype">int</span> klo = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>((box_lo[2] - plo[2])/dx[2]);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                    <span class="keywordtype">int</span> ihi = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>((box_hi[0] - plo[0])/dx[0]-1);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                    <span class="keywordtype">int</span> jhi = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>((box_hi[1] - plo[1])/dx[1]-1);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                    <span class="keywordtype">int</span> khi = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>((box_hi[2] - plo[2])/dx[2]-1);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                    Box bx(IntVect(ilo,jlo,klo),IntVect(ihi,jhi,khi));</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                    <span class="keywordflow">if</span> ( (ilo%ref_ratio[lev_for_box-1][0] != 0) || ((ihi+1)%ref_ratio[lev_for_box-1][0] != 0) ||</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                         (jlo%ref_ratio[lev_for_box-1][1] != 0) || ((jhi+1)%ref_ratio[lev_for_box-1][1] != 0) )</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                         amrex::Error(<span class="stringliteral">&quot;Fine box is not legit with this ref_ratio&quot;</span>);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                    <a class="code" href="classERF.html#a050dbd236c9bf246554a53008e09f683">boxes_at_level</a>[lev_for_box].push_back(bx);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                    Print() &lt;&lt; <span class="stringliteral">&quot;Saving in &#39;boxes at level&#39; as &quot;</span> &lt;&lt; bx &lt;&lt; std::endl;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                } <span class="comment">// lev</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classERF.html#af5ac3d88a33a1a284bcc120ce0599cf7">init_type</a> == <span class="stringliteral">&quot;real&quot;</span> || <a class="code" href="classERF.html#af5ac3d88a33a1a284bcc120ce0599cf7">init_type</a> == <span class="stringliteral">&quot;metgrid&quot;</span>) {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#adcd9f23975ffa605247b41d391c2a2f0">num_boxes_at_level</a>[lev_for_box] != <a class="code" href="classERF.html#a610a988f46e0496e6dbd0471ae817f75">num_files_at_level</a>[lev_for_box]) {</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                        amrex::Error(<span class="stringliteral">&quot;Number of boxes doesnt match number of input files&quot;</span>);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                    }</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                }</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;            }</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;            AMRErrorTagInfo info;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            <span class="keywordflow">if</span> (realbox.ok()) {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                info.SetRealBox(realbox);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            }</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            <span class="keywordflow">if</span> (ppr.countval(<span class="stringliteral">&quot;start_time&quot;</span>) &gt; 0) {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                Real ref_min_time; ppr.get(<span class="stringliteral">&quot;start_time&quot;</span>,ref_min_time);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                info.SetMinTime(ref_min_time);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            }</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            <span class="keywordflow">if</span> (ppr.countval(<span class="stringliteral">&quot;end_time&quot;</span>) &gt; 0) {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                Real ref_max_time; ppr.get(<span class="stringliteral">&quot;end_time&quot;</span>,ref_max_time);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                info.SetMaxTime(ref_max_time);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            }</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            <span class="keywordflow">if</span> (ppr.countval(<span class="stringliteral">&quot;max_level&quot;</span>) &gt; 0) {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                <span class="keywordtype">int</span> ref_max_level; ppr.get(<span class="stringliteral">&quot;max_level&quot;</span>,ref_max_level);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                info.SetMaxLevel(ref_max_level);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            }</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            <span class="keywordflow">if</span> (ppr.countval(<span class="stringliteral">&quot;value_greater&quot;</span>)) {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                <span class="keywordtype">int</span> num_val = ppr.countval(<span class="stringliteral">&quot;value_greater&quot;</span>);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                Vector&lt;Real&gt; value(num_val);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                ppr.getarr(<span class="stringliteral">&quot;value_greater&quot;</span>,value,0,num_val);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                std::string field; ppr.get(<span class="stringliteral">&quot;field_name&quot;</span>,field);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                <a class="code" href="classERF.html#ac81b3dfd7c6f21ba8479834e2ff1e652">ref_tags</a>.push_back(AMRErrorTag(value,AMRErrorTag::GREATER,field,info));</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            }</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ppr.countval(<span class="stringliteral">&quot;value_less&quot;</span>)) {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                <span class="keywordtype">int</span> num_val = ppr.countval(<span class="stringliteral">&quot;value_less&quot;</span>);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                Vector&lt;Real&gt; value(num_val);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                ppr.getarr(<span class="stringliteral">&quot;value_less&quot;</span>,value,0,num_val);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                std::string field; ppr.get(<span class="stringliteral">&quot;field_name&quot;</span>,field);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                <a class="code" href="classERF.html#ac81b3dfd7c6f21ba8479834e2ff1e652">ref_tags</a>.push_back(AMRErrorTag(value,AMRErrorTag::LESS,field,info));</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            }</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ppr.countval(<span class="stringliteral">&quot;adjacent_difference_greater&quot;</span>)) {</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                <span class="keywordtype">int</span> num_val = ppr.countval(<span class="stringliteral">&quot;adjacent_difference_greater&quot;</span>);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                Vector&lt;Real&gt; value(num_val);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                ppr.getarr(<span class="stringliteral">&quot;adjacent_difference_greater&quot;</span>,value,0,num_val);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                std::string field; ppr.get(<span class="stringliteral">&quot;field_name&quot;</span>,field);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                <a class="code" href="classERF.html#ac81b3dfd7c6f21ba8479834e2ff1e652">ref_tags</a>.push_back(AMRErrorTag(value,AMRErrorTag::GRAD,field,info));</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            }</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (realbox.ok())</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                <a class="code" href="classERF.html#ac81b3dfd7c6f21ba8479834e2ff1e652">ref_tags</a>.push_back(AMRErrorTag(info));</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                Abort(std::string(<span class="stringliteral">&quot;Unrecognized refinement indicator for &quot;</span> + refinement_indicators[i]).c_str());</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            }</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        } <span class="comment">// loop over criteria</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    } <span class="comment">// if max_level &gt; 0</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_aa90c9756f684404f8b69b8a23568b535_cgraph.png" border="0" usemap="#aclassERF_aa90c9756f684404f8b69b8a23568b535_cgraph" alt=""/></div>
<map name="aclassERF_aa90c9756f684404f8b69b8a23568b535_cgraph" id="aclassERF_aa90c9756f684404f8b69b8a23568b535_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,184,47"/>
<area shape="rect" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469" title=" " alt="" coords="232,13,271,39"/>
</map>
</div>

</div>
</div>
<a id="aae7a3a76e08e54c618cf79b30ed2d73d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae7a3a76e08e54c618cf79b30ed2d73d">&#9670;&nbsp;</a></span>RemakeLevel()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::RemakeLevel </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::BoxArray &amp;&#160;</td>
          <td class="paramname"><em>ba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::DistributionMapping &amp;&#160;</td>
          <td class="paramname"><em>dm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;{</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    Vector&lt;MultiFab&gt; temp_lev_new(<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a5deccaa24d5e74279425d7749f7d1494">Vars::NumTypes</a>);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    Vector&lt;MultiFab&gt; temp_lev_old(<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a5deccaa24d5e74279425d7749f7d1494">Vars::NumTypes</a>);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160; </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keywordtype">int</span> ncomp_cons = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nComp();</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160; </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keywordtype">int</span> ngrow_state = <a class="code" href="classERF.html#ae68b1f54d196d0a4b19716d65a59d4c5">ComputeGhostCells</a>(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>, <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa2de671156cccf1f3a34b9f250fb0e28">use_NumDiff</a>) + 1;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keywordtype">int</span> ngrow_vels  = <a class="code" href="classERF.html#ae68b1f54d196d0a4b19716d65a59d4c5">ComputeGhostCells</a>(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>, <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa2de671156cccf1f3a34b9f250fb0e28">use_NumDiff</a>);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160; </div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    temp_lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].define(ba, dm, ncomp_cons, ngrow_state);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    temp_lev_old[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].define(ba, dm, ncomp_cons, ngrow_state);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160; </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    temp_lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].define(convert(ba, IntVect(1,0,0)), dm, 1, ngrow_vels);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    temp_lev_old[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].define(convert(ba, IntVect(1,0,0)), dm, 1, ngrow_vels);</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    temp_lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].define(convert(ba, IntVect(0,1,0)), dm, 1, ngrow_vels);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    temp_lev_old[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].define(convert(ba, IntVect(0,1,0)), dm, 1, ngrow_vels);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160; </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    temp_lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].define(convert(ba, IntVect(0,0,1)), dm, 1, IntVect(ngrow_vels,ngrow_vels,0));</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    temp_lev_old[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].define(convert(ba, IntVect(0,0,1)), dm, 1, IntVect(ngrow_vels,ngrow_vels,0));</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="comment">// Remake the flux registers</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#af976afa61859c07e6249963edc367c2d">coupling_type</a> == <a class="code" href="DataStruct_8H.html#ad285be248c0803917aaf5cf8ce62139ba6c267346f8ebb889610a5a90838be815">CouplingType::TwoWay</a>) {</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <span class="keyword">delete</span> <a class="code" href="classERF.html#a86a0bc8e41668411ee0ab5801d4688a7">advflux_reg</a>[lev];</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        <a class="code" href="classERF.html#a86a0bc8e41668411ee0ab5801d4688a7">advflux_reg</a>[lev] = <span class="keyword">new</span> YAFluxRegister(ba, grids[lev-1],</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                                              dm,  dmap[lev-1],</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                                              geom[lev],  geom[lev-1],</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                                              ref_ratio[lev-1], lev, ncomp_cons);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    }</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160; </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="comment">//********************************************************************************************</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="comment">// Microphysics</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="comment">// *******************************************************************************************</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="keywordtype">int</span> q_size = <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;Get_Qmoist_Size(lev);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <a class="code" href="classERF.html#ae00126a9c2738bf6a6cbbe77321c9cfc">qmoist</a>[lev].resize(q_size);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;Define(lev, <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> != <a class="code" href="DataStruct_8H.html#ab34704153a585940411c26587cb82ad0a6adf97f83acf6453d4a6a4b1070f3754">MoistureType::None</a>)</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    {</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;Init(lev, <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], grids[lev], Geom(lev), 0.0); <span class="comment">// dummy dt value</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    }</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> mvar(0); mvar&lt;<a class="code" href="classERF.html#ae00126a9c2738bf6a6cbbe77321c9cfc">qmoist</a>[lev].size(); ++mvar) {</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        <a class="code" href="classERF.html#ae00126a9c2738bf6a6cbbe77321c9cfc">qmoist</a>[lev][mvar] = <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;Get_Qmoist_Ptr(lev,mvar);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    }</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <a class="code" href="classERF.html#a5160b1e054b3e2a09c26274ef3551c64">init_stuff</a>(lev, ba, dm);</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160; </div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    BoxArray            ba_old(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].boxArray());</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    DistributionMapping dm_old(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].DistributionMap());</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160; </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="comment">// This will fill the temporary MultiFabs with data from vars_new</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <a class="code" href="classERF.html#a8de69f537859f576fba1d94844cfbd33">FillPatch</a>(lev, time, {&amp;temp_lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],&amp;temp_lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                          &amp;temp_lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],&amp;temp_lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>]},</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                         {&amp;temp_lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],&amp;<a class="code" href="classERF.html#a01f3db32272f53dc68025f0a98195e57">rU_new</a>[lev],&amp;<a class="code" href="classERF.html#a54e37988486ef96e55e84bd8e91bb688">rV_new</a>[lev],&amp;<a class="code" href="classERF.html#aa46c0b0d20525aed10f447923e54dde7">rW_new</a>[lev]},</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                          <span class="keyword">false</span>);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160; </div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="comment">// Copy from new into old just in case</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    MultiFab::Copy(temp_lev_old[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],temp_lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],0,0,ncomp_cons,ngrow_state);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    MultiFab::Copy(temp_lev_old[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],temp_lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],0,0,    1,ngrow_vels);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    MultiFab::Copy(temp_lev_old[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],temp_lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],0,0,    1,ngrow_vels);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    MultiFab::Copy(temp_lev_old[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>],temp_lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>],0,0,    1,IntVect(ngrow_vels,ngrow_vels,0));</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160; </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="comment">// Now swap the pointers</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> var_idx = 0; var_idx &lt; <a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a5deccaa24d5e74279425d7749f7d1494">Vars::NumTypes</a>; ++var_idx) {</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        std::swap(temp_lev_new[var_idx], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][var_idx]);</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        std::swap(temp_lev_old[var_idx], <a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev][var_idx]);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    }</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160; </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev] = time;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <a class="code" href="classERF.html#a7085d7d5fc94a0f84efc06957267d58e">t_old</a>[lev] = time - 1.e200;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160; </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="comment">// Build the data structures for calculating diffusive/turbulent terms</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <a class="code" href="classERF.html#a419510fced05e9afc05c466beeeb66f7">update_diffusive_arrays</a>(lev, ba, dm);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160; </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="comment">// Build the data structures for terrain-related quantities</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <a class="code" href="classERF.html#a900a0119c110486650f2759287e22cba">update_terrain_arrays</a>(lev, time);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="comment">// Make sure that detJ and z_phys_cc are the average of the data on a finer level if there is one</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a063a88594452100497651e8aaf1f68d7">use_terrain</a> != 0) {</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> crse_lev = lev-1; crse_lev &gt;= 0; crse_lev--) {</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;            average_down(  *<a class="code" href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">detJ_cc</a>[crse_lev+1],   *<a class="code" href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">detJ_cc</a>[crse_lev], 0, 1, refRatio(crse_lev));</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;            average_down(*<a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[crse_lev+1], *<a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[crse_lev], 0, 1, refRatio(crse_lev));</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        }</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    }</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160; </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="comment">// Update the base state at this level</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].define(ba,dm,3,1);</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].setVal(0.);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <a class="code" href="classERF.html#a92c020bfaa43e40fb5ffc449427a0318">initHSE</a>(lev);</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160; </div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="comment">// Initialize the boundary conditions</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <a class="code" href="classERF.html#a2e9b04043853d25f2d76edbc0bed2e72">physbcs_cons</a>[lev] = std::make_unique&lt;ERFPhysBCFunct_cons&gt; (lev, geom[lev], <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>, <a class="code" href="classERF.html#a8a99e22b1111c803e31b4afd5fcdea60">domain_bcs_type_d</a>,</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                                                               <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>, <a class="code" href="classERF.html#a69ea003766c97b1a667b002b3661f0f2">m_bc_neumann_vals</a>,</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                                                               <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev], <a class="code" href="classERF.html#a86208285bf705f360a3c318a75097f61">use_real_bcs</a>);</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <a class="code" href="classERF.html#a64e55e5ae9df06433146db657eb9e72e">physbcs_u</a>[lev]    = std::make_unique&lt;ERFPhysBCFunct_u&gt; (lev, geom[lev], <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>, <a class="code" href="classERF.html#a8a99e22b1111c803e31b4afd5fcdea60">domain_bcs_type_d</a>,</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                                                            <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>, <a class="code" href="classERF.html#a69ea003766c97b1a667b002b3661f0f2">m_bc_neumann_vals</a>,</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                                                            <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev], <a class="code" href="classERF.html#a86208285bf705f360a3c318a75097f61">use_real_bcs</a>);</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <a class="code" href="classERF.html#a79231b5cfd4576a742e46ae0082b5121">physbcs_v</a>[lev]    = std::make_unique&lt;ERFPhysBCFunct_v&gt; (lev, geom[lev], <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>, <a class="code" href="classERF.html#a8a99e22b1111c803e31b4afd5fcdea60">domain_bcs_type_d</a>,</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                                                            <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>, <a class="code" href="classERF.html#a69ea003766c97b1a667b002b3661f0f2">m_bc_neumann_vals</a>,</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                                                            <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev], <a class="code" href="classERF.html#a86208285bf705f360a3c318a75097f61">use_real_bcs</a>);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <a class="code" href="classERF.html#a45c8ecd777f47732993777a0afb8e140">physbcs_w</a>[lev]    = std::make_unique&lt;ERFPhysBCFunct_w&gt; (lev, geom[lev], <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>, <a class="code" href="classERF.html#a8a99e22b1111c803e31b4afd5fcdea60">domain_bcs_type_d</a>,</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                                                            <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>, <a class="code" href="classERF.html#a69ea003766c97b1a667b002b3661f0f2">m_bc_neumann_vals</a>,</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                                                            <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a>, <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev], <a class="code" href="classERF.html#a86208285bf705f360a3c318a75097f61">use_real_bcs</a>);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <a class="code" href="classERF.html#a4d717bb9fe936fd1a124d0d3e720f9d1">physbcs_w_no_terrain</a>[lev]    = std::make_unique&lt;ERFPhysBCFunct_w_no_terrain&gt;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                                                           (lev, geom[lev], <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>, <a class="code" href="classERF.html#a8a99e22b1111c803e31b4afd5fcdea60">domain_bcs_type_d</a>,</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                                                            <a class="code" href="classERF.html#a199add69cee34c6611a5dc9ee965971c">m_bc_extdir_vals</a>, <a class="code" href="classERF.html#a69ea003766c97b1a667b002b3661f0f2">m_bc_neumann_vals</a>, <a class="code" href="classERF.html#a86208285bf705f360a3c318a75097f61">use_real_bcs</a>);</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160; </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="comment">// Initialize the integrator class</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160; </div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <a class="code" href="classERF.html#a5600f8ce250d4811012719fdf5e85f00">initialize_integrator</a>(lev, <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>]);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160; </div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="comment">// We need to re-define the FillPatcher if the grids have changed</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="keywordflow">if</span> (lev &gt; 0 &amp;&amp; <a class="code" href="classERF.html#ad9084179f7384e10a519989ffd51fd34">cf_width</a> &gt;= 0) {</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        <span class="keywordtype">bool</span> ba_changed = (ba != ba_old);</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        <span class="keywordtype">bool</span> dm_changed = (dm != dm_old);</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        <span class="keywordflow">if</span> (ba_changed || dm_changed) {</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;          <a class="code" href="classERF.html#ac0951404aa6802aad7a3be6b7375dfa2">Define_ERFFillPatchers</a>(lev);</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        }</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    }</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a530d2ce59e6fd46e9fb00e4d11eaf737"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a530d2ce59e6fd46e9fb00e4d11eaf737">&#9670;&nbsp;</a></span>restart()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::restart </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;{</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    <span class="comment">// TODO: This could be deleted since ba/dm are not created yet?</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev)</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    {</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        <span class="keyword">auto</span>&amp; lev_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev];</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        <span class="keyword">auto</span>&amp; lev_old = <a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev];</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;        lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].setVal(0.); lev_old[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].setVal(0.);</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].setVal(0.); lev_old[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].setVal(0.);</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;        lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].setVal(0.); lev_old[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].setVal(0.);</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;        lev_new[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].setVal(0.); lev_old[<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].setVal(0.);</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    }</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160; </div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="preprocessor">#ifdef ERF_USE_NETCDF</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a30a0b9e3a037c71580d1feb3b30a8258">restart_type</a> == <span class="stringliteral">&quot;netcdf&quot;</span>) {</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;       ReadNCCheckpointFile();</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    }</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a30a0b9e3a037c71580d1feb3b30a8258">restart_type</a> == <span class="stringliteral">&quot;native&quot;</span>) {</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;       <a class="code" href="classERF.html#af285247b24b173cd851fe49799d17f42">ReadCheckpointFile</a>();</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    }</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160; </div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    <span class="comment">// We set this here so that we don&#39;t over-write the checkpoint file we just started from</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    <a class="code" href="classERF.html#a02722d16f3c26efe590702200f1296d7">last_check_file_step</a> = <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[0];</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_af285247b24b173cd851fe49799d17f42"><div class="ttname"><a href="classERF.html#af285247b24b173cd851fe49799d17f42">ERF::ReadCheckpointFile</a></div><div class="ttdeci">void ReadCheckpointFile()</div><div class="ttdef"><b>Definition:</b> Checkpoint.cpp:226</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afb798c72ea4fde6f4da8d01a24c8c165"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb798c72ea4fde6f4da8d01a24c8c165">&#9670;&nbsp;</a></span>sample_lines()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::sample_lines </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::IntVect&#160;</td>
          <td class="paramname"><em>cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>mf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Utility function for sampling data along a line along the z-dimension at the (x,y) indices specified and writes it to an output file.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lev</td><td>Current level </td></tr>
    <tr><td class="paramname">time</td><td>Current time </td></tr>
    <tr><td class="paramname">cell</td><td>IntVect containing the x,y-dimension indices to sample along z </td></tr>
    <tr><td class="paramname">mf</td><td>MultiFab from which we sample the data </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;{</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordtype">int</span> datwidth = 14;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keywordtype">int</span> datprecision = 6;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordtype">int</span> ifile = 0;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> ncomp = mf.nComp(); <span class="comment">// cell-centered state vars</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    MultiFab mf_vels(grids[lev], dmap[lev], AMREX_SPACEDIM, 0);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    average_face_to_cellcenter(mf_vels, 0,</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                               Array&lt;const MultiFab*,3&gt;{&amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],&amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],&amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>]});</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="comment">// Sample the data at a line (in direction &quot;dir&quot;) in space</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="comment">// In this case we sample in the vertical direction so dir = 2</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="comment">// The &quot;k&quot; value of &quot;cell&quot; is ignored</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordtype">int</span> dir = 2;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    MultiFab my_line       = get_line_data(mf,              dir, cell);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    MultiFab my_line_vels  = get_line_data(mf_vels,         dir, cell);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    MultiFab my_line_tau11 = get_line_data(*<a class="code" href="classERF.html#aeb9348353b2415d023d8f52c293cad7e">Tau11_lev</a>[lev], dir, cell);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    MultiFab my_line_tau12 = get_line_data(*<a class="code" href="classERF.html#ad8c2eca71737b102cc5cf75f97c6bd63">Tau12_lev</a>[lev], dir, cell);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    MultiFab my_line_tau13 = get_line_data(*<a class="code" href="classERF.html#a5392e6104804d799b3fd943dfe390766">Tau13_lev</a>[lev], dir, cell);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    MultiFab my_line_tau22 = get_line_data(*<a class="code" href="classERF.html#afb4294f848d86e4aefb74848bb71047e">Tau22_lev</a>[lev], dir, cell);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    MultiFab my_line_tau23 = get_line_data(*<a class="code" href="classERF.html#a03a4ad7368c1c98b492cd9d9fec9cbc5">Tau23_lev</a>[lev], dir, cell);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    MultiFab my_line_tau33 = get_line_data(*<a class="code" href="classERF.html#a60a185c47f07bf4fb537a15d5a226d8a">Tau33_lev</a>[lev], dir, cell);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordflow">for</span> (MFIter mfi(my_line, <span class="keyword">false</span>); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    {</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <span class="comment">// HERE DO WHATEVER YOU WANT TO THE DATA BEFORE WRITING</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        std::ostream&amp; sample_log = <a class="code" href="classERF.html#aa559426d0435e669b04148c58b20caef">SampleLineLog</a>(ifile);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        <span class="keywordflow">if</span> (sample_log.good()) {</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;          sample_log &lt;&lt; std::setw(datwidth) &lt;&lt; std::setprecision(datprecision) &lt;&lt; time;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;          <span class="keyword">const</span> <span class="keyword">auto</span>&amp; my_line_arr = my_line[0].const_array();</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;          <span class="keyword">const</span> <span class="keyword">auto</span>&amp; my_line_vels_arr = my_line_vels[0].const_array();</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;          <span class="keyword">const</span> <span class="keyword">auto</span>&amp; my_line_tau11_arr = my_line_tau11[0].const_array();</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;          <span class="keyword">const</span> <span class="keyword">auto</span>&amp; my_line_tau12_arr = my_line_tau12[0].const_array();</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;          <span class="keyword">const</span> <span class="keyword">auto</span>&amp; my_line_tau13_arr = my_line_tau13[0].const_array();</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;          <span class="keyword">const</span> <span class="keyword">auto</span>&amp; my_line_tau22_arr = my_line_tau22[0].const_array();</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;          <span class="keyword">const</span> <span class="keyword">auto</span>&amp; my_line_tau23_arr = my_line_tau23[0].const_array();</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;          <span class="keyword">const</span> <span class="keyword">auto</span>&amp; my_line_tau33_arr = my_line_tau33[0].const_array();</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;          <span class="keyword">const</span> Box&amp;  my_box = my_line[0].box();</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">int</span> klo = my_box.smallEnd(2);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">int</span> khi = my_box.bigEnd(2);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;          <span class="keywordtype">int</span> i = cell[0];</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;          <span class="keywordtype">int</span> j = cell[1];</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; ncomp; n++) {</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = klo; k &lt;= khi; k++) {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                  sample_log &lt;&lt; std::setw(datwidth) &lt;&lt; std::setprecision(datprecision) &lt;&lt; my_line_arr(i,j,k,n);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;              }</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;          }</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; AMREX_SPACEDIM; n++) {</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = klo; k &lt;= khi; k++) {</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                  sample_log &lt;&lt; std::setw(datwidth) &lt;&lt; std::setprecision(datprecision) &lt;&lt; my_line_vels_arr(i,j,k,n);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;              }</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;          }</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = klo; k &lt;= khi; k++) {</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;              sample_log &lt;&lt; std::setw(datwidth) &lt;&lt; std::setprecision(datprecision) &lt;&lt; my_line_tau11_arr(i,j,k);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;          }</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = klo; k &lt;= khi; k++) {</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;              sample_log &lt;&lt; std::setw(datwidth) &lt;&lt; std::setprecision(datprecision) &lt;&lt; my_line_tau12_arr(i,j,k);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;          }</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = klo; k &lt;= khi; k++) {</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;              sample_log &lt;&lt; std::setw(datwidth) &lt;&lt; std::setprecision(datprecision) &lt;&lt; my_line_tau13_arr(i,j,k);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;          }</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = klo; k &lt;= khi; k++) {</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;              sample_log &lt;&lt; std::setw(datwidth) &lt;&lt; std::setprecision(datprecision) &lt;&lt; my_line_tau22_arr(i,j,k);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;          }</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = klo; k &lt;= khi; k++) {</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;              sample_log &lt;&lt; std::setw(datwidth) &lt;&lt; std::setprecision(datprecision) &lt;&lt; my_line_tau23_arr(i,j,k);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;          }</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = klo; k &lt;= khi; k++) {</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;              sample_log &lt;&lt; std::setw(datwidth) &lt;&lt; std::setprecision(datprecision) &lt;&lt; my_line_tau33_arr(i,j,k);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;          }</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;          sample_log &lt;&lt; std::endl;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        } <span class="comment">// if good</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    } <span class="comment">// mfi</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_aa559426d0435e669b04148c58b20caef"><div class="ttname"><a href="classERF.html#aa559426d0435e669b04148c58b20caef">ERF::SampleLineLog</a></div><div class="ttdeci">AMREX_FORCE_INLINE std::ostream &amp; SampleLineLog(int i)</div><div class="ttdef"><b>Definition:</b> ERF.H:929</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa28182226262c67cfd686d35bfeabcad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa28182226262c67cfd686d35bfeabcad">&#9670;&nbsp;</a></span>sample_points()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::sample_points </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::IntVect&#160;</td>
          <td class="paramname"><em>cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>mf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Utility function for sampling MultiFab data at a specified cell index.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lev</td><td>Level for the associated MultiFab data </td></tr>
    <tr><td class="paramname">time</td><td>Current time </td></tr>
    <tr><td class="paramname">cell</td><td>IntVect containing the indexes for the cell where we want to sample </td></tr>
    <tr><td class="paramname">mf</td><td>MultiFab from which we wish to sample data </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;{</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keywordtype">int</span> datwidth = 14;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordtype">int</span> ifile = 0;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="comment">// Sample the data at a single point in space</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordtype">int</span> ncomp = mf.nComp();</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    Vector&lt;Real&gt; my_point = get_cell_data(mf, cell);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keywordflow">if</span> (!my_point.empty()) {</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <span class="comment">// HERE DO WHATEVER YOU WANT TO THE DATA BEFORE WRITING</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        std::ostream&amp; sample_log = <a class="code" href="classERF.html#af5f6c32cc5463e52901f21117d3156c7">SamplePointLog</a>(ifile);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <span class="keywordflow">if</span> (sample_log.good()) {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;          sample_log &lt;&lt; std::setw(datwidth) &lt;&lt; time;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ncomp; ++i)</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;          {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;              sample_log &lt;&lt; std::setw(datwidth) &lt;&lt; my_point[i];</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;          }</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;          sample_log &lt;&lt; std::endl;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        } <span class="comment">// if good</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    } <span class="comment">// only write from processor that holds the cell</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_af5f6c32cc5463e52901f21117d3156c7"><div class="ttname"><a href="classERF.html#af5f6c32cc5463e52901f21117d3156c7">ERF::SamplePointLog</a></div><div class="ttdeci">AMREX_FORCE_INLINE std::ostream &amp; SamplePointLog(int i)</div><div class="ttdef"><b>Definition:</b> ERF.H:915</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a54357e2f81f3d7d3a9189a3e21283e6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54357e2f81f3d7d3a9189a3e21283e6b">&#9670;&nbsp;</a></span>SampleLine()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::IntVect&amp; ERF::SampleLine </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    {</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classERF.html#a0fa1582bb13357895d2aba91b695624a">sampleline</a>[i];</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa559426d0435e669b04148c58b20caef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa559426d0435e669b04148c58b20caef">&#9670;&nbsp;</a></span>SampleLineLog()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">AMREX_FORCE_INLINE std::ostream&amp; ERF::SampleLineLog </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    {</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;        <span class="keywordflow">return</span> *<a class="code" href="classERF.html#a4990f1796b65ec8ee602f177a66afc3e">samplelinelog</a>[i];</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a59eae161173111d66e88dc3acc65b552"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59eae161173111d66e88dc3acc65b552">&#9670;&nbsp;</a></span>SampleLineLogName()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ERF::SampleLineLogName </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The filename of the ith samplelinelog file. </p>
<div class="fragment"><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classERF.html#a0553967f1131860bb8ecb47c0f192eaa">samplelinelogname</a>[i]; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9095d1b641b4d7f32ca5acb679786891"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9095d1b641b4d7f32ca5acb679786891">&#9670;&nbsp;</a></span>SamplePoint()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::IntVect&amp; ERF::SamplePoint </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    {</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classERF.html#ae8a57b7fbf5a67c99d04b7d4f43ad100">samplepoint</a>[i];</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="af5f6c32cc5463e52901f21117d3156c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5f6c32cc5463e52901f21117d3156c7">&#9670;&nbsp;</a></span>SamplePointLog()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">AMREX_FORCE_INLINE std::ostream&amp; ERF::SamplePointLog </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    {</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;        <span class="keywordflow">return</span> *<a class="code" href="classERF.html#a9737ddb0de6b9e8a5b17c109d5ad3e08">sampleptlog</a>[i];</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa87242f053bfae4efb2a7698ef417ab9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa87242f053bfae4efb2a7698ef417ab9">&#9670;&nbsp;</a></span>SamplePointLogName()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ERF::SamplePointLogName </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The filename of the ith sampleptlog file. </p>
<div class="fragment"><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classERF.html#a8fbfa8bb47c0a3b53e244081aa1e8ad3">sampleptlogname</a>[i]; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1fcb440c67da60c86372aec1fe871cb7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1fcb440c67da60c86372aec1fe871cb7">&#9670;&nbsp;</a></span>setPlotVariables()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::setPlotVariables </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>pp_plot_var_names</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>plot_var_names</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;{</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    ParmParse <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>(<a class="code" href="classERF.html#a59df30e7a5537c8543bb00772bd98b58">pp_prefix</a>);</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160; </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.contains(pp_plot_var_names.c_str()))</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    {</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;        std::string nm;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160; </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;        <span class="keywordtype">int</span> nPltVars = <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.countval(pp_plot_var_names.c_str());</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nPltVars; i++)</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        {</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;            <a class="code" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.get(pp_plot_var_names.c_str(), nm, i);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;            <span class="comment">// Add the named variable to our list of plot variables</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;            <span class="comment">// if it is not already in the list</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, nm)) {</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;                plot_var_names.push_back(nm);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;            }</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        }</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        <span class="comment">// The default is to add none of the variables to the list</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        plot_var_names.clear();</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    }</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="comment">// Get state variables in the same order as we define them,</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="comment">// since they may be in any order in the input list</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    Vector&lt;std::string&gt; tmp_plot_names;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordtype">int</span> n_qstate   = <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;Get_Qstate_Size();</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordtype">int</span> ncomp_cons = <a class="code" href="IndexDefines_8H.html#a46e292b965f80d15acfbdc11ffe1e0f0">NVAR_max</a> - (<a class="code" href="IndexDefines_8H.html#abe87e298e9d558e0659a67ad3b9be71f">NMOIST_max</a> - n_qstate);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ncomp_cons; ++i) {</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <a class="code" href="classERF.html#afd8cd5a477754776135befa668fdd0c9">cons_names</a>[i]) ) {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;            tmp_plot_names.push_back(<a class="code" href="classERF.html#afd8cd5a477754776135befa668fdd0c9">cons_names</a>[i]);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        }</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    }</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="comment">// check for velocity since it&#39;s not in cons_names</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="comment">// if we are asked for any velocity component, we will need them all</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;x_velocity&quot;</span>) ||</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;y_velocity&quot;</span>) ||</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;z_velocity&quot;</span>)) {</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        tmp_plot_names.push_back(<span class="stringliteral">&quot;x_velocity&quot;</span>);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        tmp_plot_names.push_back(<span class="stringliteral">&quot;y_velocity&quot;</span>);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        tmp_plot_names.push_back(<span class="stringliteral">&quot;z_velocity&quot;</span>);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    }</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a>.size(); ++i) {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <a class="code" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a>[i]) ) {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a063a88594452100497651e8aaf1f68d7">use_terrain</a> || (<a class="code" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a>[i] != <span class="stringliteral">&quot;z_phys&quot;</span> &amp;&amp; <a class="code" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a>[i] != <span class="stringliteral">&quot;detJ&quot;</span>) ) {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;               tmp_plot_names.push_back(<a class="code" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a>[i]);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;            }</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        }</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    }</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="preprocessor">#ifdef ERF_USE_PARTICLES</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; particles_namelist( particleData.getNamesUnalloc() );</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = particles_namelist.cbegin(); it != particles_namelist.cend(); ++it) {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        std::string tmp( (*it)+<span class="stringliteral">&quot;_count&quot;</span> );</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, tmp) ) {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            tmp_plot_names.push_back(tmp);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        }</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    plot_var_names = tmp_plot_names;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_a9fc0f6e6ca35036d2e3a36dd42e66435"><div class="ttname"><a href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">ERF::derived_names</a></div><div class="ttdeci">const amrex::Vector&lt; std::string &gt; derived_names</div><div class="ttdef"><b>Definition:</b> ERF.H:714</div></div>
<div class="ttc" id="aclassERF_html_afd8cd5a477754776135befa668fdd0c9"><div class="ttname"><a href="classERF.html#afd8cd5a477754776135befa668fdd0c9">ERF::cons_names</a></div><div class="ttdeci">const amrex::Vector&lt; std::string &gt; cons_names</div><div class="ttdef"><b>Definition:</b> ERF.H:709</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a1fcb440c67da60c86372aec1fe871cb7_cgraph.png" border="0" usemap="#aclassERF_a1fcb440c67da60c86372aec1fe871cb7_cgraph" alt=""/></div>
<map name="aclassERF_a1fcb440c67da60c86372aec1fe871cb7_cgraph" id="aclassERF_a1fcb440c67da60c86372aec1fe871cb7_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,164,57"/>
<area shape="rect" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67" title=" " alt="" coords="212,5,375,32"/>
<area shape="rect" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469" title=" " alt="" coords="274,56,313,83"/>
</map>
</div>

</div>
</div>
<a id="a0877d5a0263641c13b92d2d16f47b689"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0877d5a0263641c13b92d2d16f47b689">&#9670;&nbsp;</a></span>setRayleighRefFromSounding()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::setRayleighRefFromSounding </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>restarting</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set Rayleigh mean profiles from input sounding. </p>
<p>Sets the Rayleigh Damping averaged quantities from an externally supplied input sounding data file.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">restarting</td><td>Boolean parameter that indicates whether we are currently restarting from a checkpoint file. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;{</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="comment">// If we are restarting then we haven&#39;t read the input_sounding file yet</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="comment">//    so we need to read it here</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="comment">// TODO: should we store this information in the checkpoint file instead?</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordflow">if</span> (restarting) {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <a class="code" href="classERF.html#a83572d8dfad51158945b4a5ab06b2f72">input_sounding_data</a>.<a class="code" href="structInputSoundingData.html#a596a65687875bb0172f0621f446452ae">read_from_file</a>(<a class="code" href="classERF.html#a536424e14c4139e4683b15c59e742362">input_sounding_file</a>, geom[0], <a class="code" href="classERF.html#a7a4d6e7887fa8f30c33a0b8899035ddb">zlevels_stag</a>);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    }</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keyword">const</span> Real* z_inp_sound     = <a class="code" href="classERF.html#a83572d8dfad51158945b4a5ab06b2f72">input_sounding_data</a>.<a class="code" href="structInputSoundingData.html#a0a3d15e3959ce900c213a09230e6646c">z_inp_sound</a>.dataPtr();</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keyword">const</span> Real* U_inp_sound     = <a class="code" href="classERF.html#a83572d8dfad51158945b4a5ab06b2f72">input_sounding_data</a>.<a class="code" href="structInputSoundingData.html#a92f73e73fbc10bb7cbc1ba38155879f6">U_inp_sound</a>.dataPtr();</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keyword">const</span> Real* V_inp_sound     = <a class="code" href="classERF.html#a83572d8dfad51158945b4a5ab06b2f72">input_sounding_data</a>.<a class="code" href="structInputSoundingData.html#a97a1970935e36fc0ba9a69fa0032883d">V_inp_sound</a>.dataPtr();</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keyword">const</span> Real* theta_inp_sound = <a class="code" href="classERF.html#a83572d8dfad51158945b4a5ab06b2f72">input_sounding_data</a>.<a class="code" href="structInputSoundingData.html#acf38db2cecabcd07fe794b41974ba866">theta_inp_sound</a>.dataPtr();</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span>   inp_sound_size  = <a class="code" href="classERF.html#a83572d8dfad51158945b4a5ab06b2f72">input_sounding_data</a>.<a class="code" href="structInputSoundingData.html#af2e8c00eb0bd0d64abf35528b33b3240">size</a>();</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; lev++)</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> khi = geom[lev].Domain().bigEnd()[2];</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        Vector&lt;Real&gt; zcc(khi+1);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[lev]) {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            <span class="comment">// use_terrain=1</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;            <span class="comment">// calculate the damping strength based on the max height at each k</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            <a class="code" href="ParFunctions_8H.html#a7e646d3f1b936883c143204caa88c7c5">reduce_to_max_per_level</a>(zcc, <a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[lev]);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            <span class="keyword">const</span> <span class="keyword">auto</span> *<span class="keyword">const</span> prob_lo = geom[lev].ProbLo();</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;            <span class="keyword">const</span> <span class="keyword">auto</span> *<span class="keyword">const</span> dx = geom[lev].CellSize();</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt;= khi; k++)</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                zcc[k] = prob_lo[2] + (k+0.5) * dx[2];</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            }</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        }</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt;= khi; k++)</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        {</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            <a class="code" href="classERF.html#ad9939824ea7b7d06ab252fed28d5a911">h_rayleigh_ptrs</a>[lev][<a class="code" href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a3d2cdf8cea6cb933d4ce759c1ff1b948">Rayleigh::ubar</a>][k]         = <a class="code" href="Interpolation__1D_8H.html#a803d0d35d4ca4791556cbe02bbf51cbb">interpolate_1d</a>(z_inp_sound, U_inp_sound, zcc[k], inp_sound_size);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            <a class="code" href="classERF.html#ad9939824ea7b7d06ab252fed28d5a911">h_rayleigh_ptrs</a>[lev][<a class="code" href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239acb08c6a1b8bca5e9e4ef6162aef2cfa4">Rayleigh::vbar</a>][k]         = <a class="code" href="Interpolation__1D_8H.html#a803d0d35d4ca4791556cbe02bbf51cbb">interpolate_1d</a>(z_inp_sound, V_inp_sound, zcc[k], inp_sound_size);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            <a class="code" href="classERF.html#ad9939824ea7b7d06ab252fed28d5a911">h_rayleigh_ptrs</a>[lev][<a class="code" href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a3d8bd6001a2421b06c3ec4e9f2dcdffd">Rayleigh::wbar</a>][k]         = Real(0.0);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            <a class="code" href="classERF.html#ad9939824ea7b7d06ab252fed28d5a911">h_rayleigh_ptrs</a>[lev][<a class="code" href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239ae41e9f65f26ee3b04db07f2db7f28bdb">Rayleigh::thetabar</a>][k] = <a class="code" href="Interpolation__1D_8H.html#a803d0d35d4ca4791556cbe02bbf51cbb">interpolate_1d</a>(z_inp_sound, theta_inp_sound, zcc[k], inp_sound_size);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ad9939824ea7b7d06ab252fed28d5a911">h_rayleigh_ptrs</a>[lev][<a class="code" href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a0831ecd8c789131994c1f350dce2b02f">Rayleigh::tau</a>][k] &gt; 0) {</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                                                  Print() &lt;&lt; zcc[k] &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; <span class="stringliteral">&quot; tau=&quot;</span> &lt;&lt; <a class="code" href="classERF.html#ad9939824ea7b7d06ab252fed28d5a911">h_rayleigh_ptrs</a>[lev][<a class="code" href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a0831ecd8c789131994c1f350dce2b02f">Rayleigh::tau</a>][k];</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a5aed4016dd7d17a2d2904c60af59ae9d">rayleigh_damp_U</a>) Print() &lt;&lt; <span class="stringliteral">&quot; ubar    = &quot;</span> &lt;&lt; <a class="code" href="classERF.html#ad9939824ea7b7d06ab252fed28d5a911">h_rayleigh_ptrs</a>[lev][<a class="code" href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a3d2cdf8cea6cb933d4ce759c1ff1b948">Rayleigh::ubar</a>][k];</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a1bae456f7b26e8ed50d78ce1af1b5ef0">rayleigh_damp_V</a>) Print() &lt;&lt; <span class="stringliteral">&quot; vbar    = &quot;</span> &lt;&lt; <a class="code" href="classERF.html#ad9939824ea7b7d06ab252fed28d5a911">h_rayleigh_ptrs</a>[lev][<a class="code" href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239acb08c6a1b8bca5e9e4ef6162aef2cfa4">Rayleigh::vbar</a>][k];</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#abf35af2e52f5c1197264d895396ca59c">rayleigh_damp_W</a>) Print() &lt;&lt; <span class="stringliteral">&quot; wbar    = &quot;</span> &lt;&lt; <a class="code" href="classERF.html#ad9939824ea7b7d06ab252fed28d5a911">h_rayleigh_ptrs</a>[lev][<a class="code" href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a3d8bd6001a2421b06c3ec4e9f2dcdffd">Rayleigh::wbar</a>][k];</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a06a0dd1c8f7c1ed73a4f8d24b6b31cdf">rayleigh_damp_T</a>) Print() &lt;&lt; <span class="stringliteral">&quot; thetabar= &quot;</span> &lt;&lt; <a class="code" href="classERF.html#ad9939824ea7b7d06ab252fed28d5a911">h_rayleigh_ptrs</a>[lev][<a class="code" href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239ae41e9f65f26ee3b04db07f2db7f28bdb">Rayleigh::thetabar</a>][k];</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                Print() &lt;&lt; std::endl;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;            }</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        }</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <span class="comment">// Copy from host version to device version</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        Gpu::copy(Gpu::hostToDevice, <a class="code" href="classERF.html#ad9939824ea7b7d06ab252fed28d5a911">h_rayleigh_ptrs</a>[lev][<a class="code" href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a3d2cdf8cea6cb933d4ce759c1ff1b948">Rayleigh::ubar</a>].begin(), <a class="code" href="classERF.html#ad9939824ea7b7d06ab252fed28d5a911">h_rayleigh_ptrs</a>[lev][<a class="code" href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a3d2cdf8cea6cb933d4ce759c1ff1b948">Rayleigh::ubar</a>].end(),</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                         <a class="code" href="classERF.html#ad598bde8e728479faaa7c2820096b47a">d_rayleigh_ptrs</a>[lev][<a class="code" href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a3d2cdf8cea6cb933d4ce759c1ff1b948">Rayleigh::ubar</a>].begin());</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        Gpu::copy(Gpu::hostToDevice, <a class="code" href="classERF.html#ad9939824ea7b7d06ab252fed28d5a911">h_rayleigh_ptrs</a>[lev][<a class="code" href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239acb08c6a1b8bca5e9e4ef6162aef2cfa4">Rayleigh::vbar</a>].begin(), <a class="code" href="classERF.html#ad9939824ea7b7d06ab252fed28d5a911">h_rayleigh_ptrs</a>[lev][<a class="code" href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239acb08c6a1b8bca5e9e4ef6162aef2cfa4">Rayleigh::vbar</a>].end(),</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                         <a class="code" href="classERF.html#ad598bde8e728479faaa7c2820096b47a">d_rayleigh_ptrs</a>[lev][<a class="code" href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239acb08c6a1b8bca5e9e4ef6162aef2cfa4">Rayleigh::vbar</a>].begin());</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        Gpu::copy(Gpu::hostToDevice, <a class="code" href="classERF.html#ad9939824ea7b7d06ab252fed28d5a911">h_rayleigh_ptrs</a>[lev][<a class="code" href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a3d8bd6001a2421b06c3ec4e9f2dcdffd">Rayleigh::wbar</a>].begin(), <a class="code" href="classERF.html#ad9939824ea7b7d06ab252fed28d5a911">h_rayleigh_ptrs</a>[lev][<a class="code" href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a3d8bd6001a2421b06c3ec4e9f2dcdffd">Rayleigh::wbar</a>].end(),</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                         <a class="code" href="classERF.html#ad598bde8e728479faaa7c2820096b47a">d_rayleigh_ptrs</a>[lev][<a class="code" href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a3d8bd6001a2421b06c3ec4e9f2dcdffd">Rayleigh::wbar</a>].begin());</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        Gpu::copy(Gpu::hostToDevice, <a class="code" href="classERF.html#ad9939824ea7b7d06ab252fed28d5a911">h_rayleigh_ptrs</a>[lev][<a class="code" href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239ae41e9f65f26ee3b04db07f2db7f28bdb">Rayleigh::thetabar</a>].begin(), <a class="code" href="classERF.html#ad9939824ea7b7d06ab252fed28d5a911">h_rayleigh_ptrs</a>[lev][<a class="code" href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239ae41e9f65f26ee3b04db07f2db7f28bdb">Rayleigh::thetabar</a>].end(),</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                         <a class="code" href="classERF.html#ad598bde8e728479faaa7c2820096b47a">d_rayleigh_ptrs</a>[lev][<a class="code" href="DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239ae41e9f65f26ee3b04db07f2db7f28bdb">Rayleigh::thetabar</a>].begin());</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;}</div>
<div class="ttc" id="aInterpolation__1D_8H_html_a803d0d35d4ca4791556cbe02bbf51cbb"><div class="ttname"><a href="Interpolation__1D_8H.html#a803d0d35d4ca4791556cbe02bbf51cbb">interpolate_1d</a></div><div class="ttdeci">AMREX_GPU_HOST_DEVICE AMREX_FORCE_INLINE amrex::Real interpolate_1d(const amrex::Real *alpha, const amrex::Real *beta, const amrex::Real alpha_interp, const int alpha_size)</div><div class="ttdef"><b>Definition:</b> Interpolation_1D.H:12</div></div>
<div class="ttc" id="aParFunctions_8H_html_a7e646d3f1b936883c143204caa88c7c5"><div class="ttname"><a href="ParFunctions_8H.html#a7e646d3f1b936883c143204caa88c7c5">reduce_to_max_per_level</a></div><div class="ttdeci">AMREX_FORCE_INLINE void reduce_to_max_per_level(amrex::Vector&lt; amrex::Real &gt; &amp;v, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf)</div><div class="ttdef"><b>Definition:</b> ParFunctions.H:8</div></div>
<div class="ttc" id="astructInputSoundingData_html_a0a3d15e3959ce900c213a09230e6646c"><div class="ttname"><a href="structInputSoundingData.html#a0a3d15e3959ce900c213a09230e6646c">InputSoundingData::z_inp_sound</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Real &gt; z_inp_sound</div><div class="ttdef"><b>Definition:</b> InputSoundingData.H:248</div></div>
<div class="ttc" id="astructInputSoundingData_html_a92f73e73fbc10bb7cbc1ba38155879f6"><div class="ttname"><a href="structInputSoundingData.html#a92f73e73fbc10bb7cbc1ba38155879f6">InputSoundingData::U_inp_sound</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Real &gt; U_inp_sound</div><div class="ttdef"><b>Definition:</b> InputSoundingData.H:248</div></div>
<div class="ttc" id="astructInputSoundingData_html_a97a1970935e36fc0ba9a69fa0032883d"><div class="ttname"><a href="structInputSoundingData.html#a97a1970935e36fc0ba9a69fa0032883d">InputSoundingData::V_inp_sound</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Real &gt; V_inp_sound</div><div class="ttdef"><b>Definition:</b> InputSoundingData.H:248</div></div>
<div class="ttc" id="astructInputSoundingData_html_acf38db2cecabcd07fe794b41974ba866"><div class="ttname"><a href="structInputSoundingData.html#acf38db2cecabcd07fe794b41974ba866">InputSoundingData::theta_inp_sound</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Real &gt; theta_inp_sound</div><div class="ttdef"><b>Definition:</b> InputSoundingData.H:248</div></div>
<div class="ttc" id="astructInputSoundingData_html_af2e8c00eb0bd0d64abf35528b33b3240"><div class="ttname"><a href="structInputSoundingData.html#af2e8c00eb0bd0d64abf35528b33b3240">InputSoundingData::size</a></div><div class="ttdeci">int size() const</div><div class="ttdef"><b>Definition:</b> InputSoundingData.H:236</div></div>
<div class="ttc" id="astructSolverChoice_html_a06a0dd1c8f7c1ed73a4f8d24b6b31cdf"><div class="ttname"><a href="structSolverChoice.html#a06a0dd1c8f7c1ed73a4f8d24b6b31cdf">SolverChoice::rayleigh_damp_T</a></div><div class="ttdeci">bool rayleigh_damp_T</div><div class="ttdef"><b>Definition:</b> DataStruct.H:375</div></div>
<div class="ttc" id="astructSolverChoice_html_a1bae456f7b26e8ed50d78ce1af1b5ef0"><div class="ttname"><a href="structSolverChoice.html#a1bae456f7b26e8ed50d78ce1af1b5ef0">SolverChoice::rayleigh_damp_V</a></div><div class="ttdeci">bool rayleigh_damp_V</div><div class="ttdef"><b>Definition:</b> DataStruct.H:373</div></div>
<div class="ttc" id="astructSolverChoice_html_a5aed4016dd7d17a2d2904c60af59ae9d"><div class="ttname"><a href="structSolverChoice.html#a5aed4016dd7d17a2d2904c60af59ae9d">SolverChoice::rayleigh_damp_U</a></div><div class="ttdeci">bool rayleigh_damp_U</div><div class="ttdef"><b>Definition:</b> DataStruct.H:372</div></div>
<div class="ttc" id="astructSolverChoice_html_abf35af2e52f5c1197264d895396ca59c"><div class="ttname"><a href="structSolverChoice.html#abf35af2e52f5c1197264d895396ca59c">SolverChoice::rayleigh_damp_W</a></div><div class="ttdeci">bool rayleigh_damp_W</div><div class="ttdef"><b>Definition:</b> DataStruct.H:374</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a0877d5a0263641c13b92d2d16f47b689_cgraph.png" border="0" usemap="#aclassERF_a0877d5a0263641c13b92d2d16f47b689_cgraph" alt=""/></div>
<map name="aclassERF_a0877d5a0263641c13b92d2d16f47b689_cgraph" id="aclassERF_a0877d5a0263641c13b92d2d16f47b689_cgraph">
<area shape="rect" title="Set Rayleigh mean profiles from input sounding." alt="" coords="5,31,252,57"/>
<area shape="rect" href="Interpolation__1D_8H.html#a803d0d35d4ca4791556cbe02bbf51cbb" title=" " alt="" coords="337,5,453,32"/>
<area shape="rect" href="ParFunctions_8H.html#a7e646d3f1b936883c143204caa88c7c5" title=" " alt="" coords="300,56,489,83"/>
</map>
</div>

</div>
</div>
<a id="a2486b49bb0d7917f812318822e42a03c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2486b49bb0d7917f812318822e42a03c">&#9670;&nbsp;</a></span>setRecordDataInfo()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::setRecordDataInfo </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>filename</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    {</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;        <span class="keywordflow">if</span> (amrex::ParallelDescriptor::IOProcessor())</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;        {</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;            <a class="code" href="classERF.html#a1cade630b005dbcc0f644987ef3db287">datalog</a>[i] = std::make_unique&lt;std::fstream&gt;();</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;            <a class="code" href="classERF.html#a1cade630b005dbcc0f644987ef3db287">datalog</a>[i]-&gt;open(filename.c_str(),std::ios::out|std::ios::app);</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classERF.html#a1cade630b005dbcc0f644987ef3db287">datalog</a>[i]-&gt;good()) {</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                amrex::FileOpenFailed(filename);</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;            }</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;        }</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;        amrex::ParallelDescriptor::Barrier(<span class="stringliteral">&quot;ERF::setRecordDataInfo&quot;</span>);</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae1a8856961aaee53016122facba03dbe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1a8856961aaee53016122facba03dbe">&#9670;&nbsp;</a></span>setRecordSampleLineInfo()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::setRecordSampleLineInfo </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::IntVect &amp;&#160;</td>
          <td class="paramname"><em>cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>filename</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    {</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;        amrex::MultiFab dummy(grids[lev],dmap[lev],1,0);</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;        <span class="keywordflow">for</span> (amrex::MFIter mfi(dummy); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;        {</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;            <span class="keyword">const</span> amrex::Box&amp; bx = mfi.validbox();</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;            <span class="keywordflow">if</span> (bx.contains(cell)) {</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;                <a class="code" href="classERF.html#a4990f1796b65ec8ee602f177a66afc3e">samplelinelog</a>[i] = std::make_unique&lt;std::fstream&gt;();</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;                <a class="code" href="classERF.html#a4990f1796b65ec8ee602f177a66afc3e">samplelinelog</a>[i]-&gt;open(filename.c_str(),std::ios::out|std::ios::app);</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="classERF.html#a4990f1796b65ec8ee602f177a66afc3e">samplelinelog</a>[i]-&gt;good()) {</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;                    amrex::FileOpenFailed(filename);</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;                }</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;            }</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;        }</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;        amrex::ParallelDescriptor::Barrier(<span class="stringliteral">&quot;ERF::setRecordSampleLineInfo&quot;</span>);</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="af8d930dce1b926ecc3bdc6787dd47818"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8d930dce1b926ecc3bdc6787dd47818">&#9670;&nbsp;</a></span>setRecordSamplePointInfo()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::setRecordSamplePointInfo </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::IntVect &amp;&#160;</td>
          <td class="paramname"><em>cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>filename</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    {</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;        amrex::MultiFab dummy(grids[lev],dmap[lev],1,0);</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;        <span class="keywordflow">for</span> (amrex::MFIter mfi(dummy); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        {</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;            <span class="keyword">const</span> amrex::Box&amp; bx = mfi.validbox();</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;            <span class="keywordflow">if</span> (bx.contains(cell)) {</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;                <a class="code" href="classERF.html#a9737ddb0de6b9e8a5b17c109d5ad3e08">sampleptlog</a>[i] = std::make_unique&lt;std::fstream&gt;();</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                <a class="code" href="classERF.html#a9737ddb0de6b9e8a5b17c109d5ad3e08">sampleptlog</a>[i]-&gt;open(filename.c_str(),std::ios::out|std::ios::app);</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="classERF.html#a9737ddb0de6b9e8a5b17c109d5ad3e08">sampleptlog</a>[i]-&gt;good()) {</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;                    amrex::FileOpenFailed(filename);</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;                }</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;            }</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;        }</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;        amrex::ParallelDescriptor::Barrier(<span class="stringliteral">&quot;ERF::setRecordSamplePointInfo&quot;</span>);</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a922892a05ee0c5bccd210a3e5a8599e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a922892a05ee0c5bccd210a3e5a8599e1">&#9670;&nbsp;</a></span>sum_integrated_quantities()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::sum_integrated_quantities </td>
          <td>(</td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Computes the integrated quantities on the grid such as the total scalar and total mass quantities. Prints and writes to output file.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">time</td><td>Current time </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;{</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    BL_PROFILE(<span class="stringliteral">&quot;ERF::sum_integrated_quantities()&quot;</span>);</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160; </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a43d0b17f6e155691a1e9474526df3af5">verbose</a> &lt;= 0)</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="keywordtype">int</span> datwidth = 14;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <span class="keywordtype">int</span> datprecision = 6;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160; </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="comment">// Single level sum</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    Real mass_sl;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="comment">// Multilevel sums</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    Real mass_ml = 0.0;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    Real rhth_ml = 0.0;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    Real scal_ml = 0.0;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#if 1</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    mass_sl = <a class="code" href="classERF.html#ae959fa22a0c888a6da28d385054edf82">volWgtSumMF</a>(0,<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[0][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],<a class="code" href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>,*<a class="code" href="classERF.html#a23aacdb72e9d2dfed8e2ebd2c2526497">mapfac_m</a>[0],<span class="keyword">false</span>,<span class="keyword">false</span>);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; lev++) {</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        mass_ml += <a class="code" href="classERF.html#ae959fa22a0c888a6da28d385054edf82">volWgtSumMF</a>(lev,<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],<a class="code" href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>,*<a class="code" href="classERF.html#a23aacdb72e9d2dfed8e2ebd2c2526497">mapfac_m</a>[lev],<span class="keyword">false</span>,<span class="keyword">true</span>);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    }</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; lev++) {</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        MultiFab pert_dens(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].boxArray(),</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                           <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].DistributionMap(),</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;                           1,0);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        MultiFab r_hse (<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev], make_alias, 0, 1); <span class="comment">// r_0 is first  component</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        <span class="keywordflow">for</span> ( MFIter mfi(pert_dens,TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        {</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;            <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;            <span class="keyword">const</span> Array4&lt;Real      &gt;&amp; pert_dens_arr = pert_dens.array(mfi);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;            <span class="keyword">const</span> Array4&lt;Real const&gt;&amp;         S_arr = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].const_array(mfi);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;            <span class="keyword">const</span> Array4&lt;Real const&gt;&amp;        r0_arr = r_hse.const_array(mfi);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;            ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;                pert_dens_arr(i, j, k, 0) = S_arr(i,j,k,<a class="code" href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>) - r0_arr(i,j,k);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;            });</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        }</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <span class="keywordflow">if</span> (lev == 0) {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;            mass_sl = <a class="code" href="classERF.html#ae959fa22a0c888a6da28d385054edf82">volWgtSumMF</a>(0,pert_dens,0,*<a class="code" href="classERF.html#a23aacdb72e9d2dfed8e2ebd2c2526497">mapfac_m</a>[0],<span class="keyword">false</span>,<span class="keyword">false</span>);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        }</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        mass_ml += <a class="code" href="classERF.html#ae959fa22a0c888a6da28d385054edf82">volWgtSumMF</a>(lev,pert_dens,0,*<a class="code" href="classERF.html#a23aacdb72e9d2dfed8e2ebd2c2526497">mapfac_m</a>[lev],<span class="keyword">false</span>,<span class="keyword">true</span>);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    } <span class="comment">// lev</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    Real rhth_sl = <a class="code" href="classERF.html#ae959fa22a0c888a6da28d385054edf82">volWgtSumMF</a>(0,<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[0][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], <a class="code" href="IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>,*<a class="code" href="classERF.html#a23aacdb72e9d2dfed8e2ebd2c2526497">mapfac_m</a>[0],<span class="keyword">false</span>,<span class="keyword">false</span>);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    Real scal_sl = <a class="code" href="classERF.html#ae959fa22a0c888a6da28d385054edf82">volWgtSumMF</a>(0,<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[0][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],<a class="code" href="IndexDefines_8H.html#a0296f21cd48e5d8236c62ae4ce319b2f">RhoScalar_comp</a>,*<a class="code" href="classERF.html#a23aacdb72e9d2dfed8e2ebd2c2526497">mapfac_m</a>[0],<span class="keyword">false</span>,<span class="keyword">false</span>);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; lev++) {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        rhth_ml += <a class="code" href="classERF.html#ae959fa22a0c888a6da28d385054edf82">volWgtSumMF</a>(lev,<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], <a class="code" href="IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>,*<a class="code" href="classERF.html#a23aacdb72e9d2dfed8e2ebd2c2526497">mapfac_m</a>[lev],<span class="keyword">false</span>,<span class="keyword">true</span>);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        scal_ml += <a class="code" href="classERF.html#ae959fa22a0c888a6da28d385054edf82">volWgtSumMF</a>(lev,<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],<a class="code" href="IndexDefines_8H.html#a0296f21cd48e5d8236c62ae4ce319b2f">RhoScalar_comp</a>,*<a class="code" href="classERF.html#a23aacdb72e9d2dfed8e2ebd2c2526497">mapfac_m</a>[lev],<span class="keyword">false</span>,<span class="keyword">true</span>);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    }</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a43d0b17f6e155691a1e9474526df3af5">verbose</a> &gt; 0) {</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        Gpu::HostVector&lt;Real&gt; h_avg_ustar; h_avg_ustar.resize(1);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        Gpu::HostVector&lt;Real&gt; h_avg_tstar; h_avg_tstar.resize(1);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        Gpu::HostVector&lt;Real&gt; h_avg_olen; h_avg_olen.resize(1);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="classERF.html#a051364b2373d8d86151c0b4a958035bd">m_most</a> != <span class="keyword">nullptr</span>) &amp;&amp; (<a class="code" href="classERF.html#ac1238c1616826c66df1dfd9076e6a3da">NumDataLogs</a>() &gt; 0)) {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            Box domain = geom[0].Domain();</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;            <span class="keywordtype">int</span> zdir = 2;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            h_avg_ustar = sumToLine(*<a class="code" href="classERF.html#a051364b2373d8d86151c0b4a958035bd">m_most</a>-&gt;get_u_star(0),0,1,domain,zdir);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            h_avg_tstar = sumToLine(*<a class="code" href="classERF.html#a051364b2373d8d86151c0b4a958035bd">m_most</a>-&gt;get_t_star(0),0,1,domain,zdir);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            h_avg_olen  = sumToLine(*<a class="code" href="classERF.html#a051364b2373d8d86151c0b4a958035bd">m_most</a>-&gt;get_olen(0),0,1,domain,zdir);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            <span class="comment">// Divide by the total number of cells we are averaging over</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            Real area_z = <span class="keyword">static_cast&lt;</span>Real<span class="keyword">&gt;</span>(domain.length(0)*domain.length(1));</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;            h_avg_ustar[0] /= area_z;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            h_avg_tstar[0] /= area_z;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;            h_avg_olen[0]  /= area_z;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            h_avg_ustar[0] = 0.;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            h_avg_tstar[0] = 0.;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            h_avg_olen[0]  = 0.;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        }</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> nfoo = 6;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        Real foo[nfoo] = {mass_sl,rhth_sl,scal_sl,mass_ml,rhth_ml,scal_ml};</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="preprocessor">#ifdef AMREX_LAZY</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        Lazy::QueueReduction([=]() <span class="keyword">mutable</span> {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        ParallelDescriptor::ReduceRealSum(</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            foo, nfoo, ParallelDescriptor::IOProcessorNumber());</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;          <span class="keywordflow">if</span> (ParallelDescriptor::IOProcessor()) {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;            mass_sl = foo[i++];</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;            rhth_sl = foo[i++];</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            scal_sl = foo[i++];</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            mass_ml = foo[i++];</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;            rhth_ml = foo[i++];</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            scal_ml = foo[i++];</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;            Print() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            <span class="keywordflow">if</span> (finest_level ==  0) {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="preprocessor">#if 1</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;               Print() &lt;&lt; <span class="stringliteral">&quot;TIME= &quot;</span> &lt;&lt; time &lt;&lt; <span class="stringliteral">&quot;      MASS         = &quot;</span> &lt;&lt; mass_sl &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;               Print() &lt;&lt; <span class="stringliteral">&quot;TIME= &quot;</span> &lt;&lt; time &lt;&lt; <span class="stringliteral">&quot; PERT MASS         = &quot;</span> &lt;&lt; mass_sl &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;               Print() &lt;&lt; <span class="stringliteral">&quot;TIME= &quot;</span> &lt;&lt; time &lt;&lt; <span class="stringliteral">&quot; RHO THETA         = &quot;</span> &lt;&lt; rhth_sl &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;               Print() &lt;&lt; <span class="stringliteral">&quot;TIME= &quot;</span> &lt;&lt; time &lt;&lt; <span class="stringliteral">&quot; RHO SCALAR        = &quot;</span> &lt;&lt; scal_sl &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="preprocessor">#if 1</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;               Print() &lt;&lt; <span class="stringliteral">&quot;TIME= &quot;</span> &lt;&lt; time &lt;&lt; <span class="stringliteral">&quot;      MASS   SL/ML = &quot;</span> &lt;&lt; mass_sl &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; mass_ml &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;               Print() &lt;&lt; <span class="stringliteral">&quot;TIME= &quot;</span> &lt;&lt; time &lt;&lt; <span class="stringliteral">&quot; PERT MASS   SL/ML = &quot;</span> &lt;&lt; mass_sl &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; mass_ml &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;               Print() &lt;&lt; <span class="stringliteral">&quot;TIME= &quot;</span> &lt;&lt; time &lt;&lt; <span class="stringliteral">&quot; RHO THETA   SL/ML = &quot;</span> &lt;&lt; rhth_sl &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; rhth_ml &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;               Print() &lt;&lt; <span class="stringliteral">&quot;TIME= &quot;</span> &lt;&lt; time &lt;&lt; <span class="stringliteral">&quot; RHO SCALAR  SL/ML = &quot;</span> &lt;&lt; scal_sl &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; scal_ml &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            <span class="comment">// The first data log only holds scalars</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ac1238c1616826c66df1dfd9076e6a3da">NumDataLogs</a>() &gt; 0)</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                <span class="keywordtype">int</span> nd = 0;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                std::ostream&amp; data_log1 = <a class="code" href="classERF.html#aa2c3ee1910008b828b9da79ccdfe3871">DataLog</a>(nd);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                <span class="keywordflow">if</span> (data_log1.good()) {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                    <span class="keywordflow">if</span> (time == 0.0) {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                        data_log1 &lt;&lt; std::setw(datwidth) &lt;&lt; <span class="stringliteral">&quot;          time&quot;</span>;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                        data_log1 &lt;&lt; std::setw(datwidth) &lt;&lt; <span class="stringliteral">&quot;          u_star&quot;</span>;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                        data_log1 &lt;&lt; std::setw(datwidth) &lt;&lt; <span class="stringliteral">&quot;          t_star&quot;</span>;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                        data_log1 &lt;&lt; std::setw(datwidth) &lt;&lt; <span class="stringliteral">&quot;          olen&quot;</span>;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                        data_log1 &lt;&lt; std::endl;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                    } <span class="comment">// time = 0</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                  <span class="comment">// Write the quantities at this time</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                  data_log1 &lt;&lt; std::setw(datwidth) &lt;&lt; time;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                  data_log1 &lt;&lt; std::setw(datwidth) &lt;&lt; std::setprecision(datprecision)</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                            &lt;&lt; h_avg_ustar[0];</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                  data_log1 &lt;&lt; std::setw(datwidth) &lt;&lt; std::setprecision(datprecision)</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                            &lt;&lt; h_avg_tstar[0];</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                  data_log1 &lt;&lt; std::setw(datwidth) &lt;&lt; std::setprecision(datprecision)</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                            &lt;&lt; h_avg_olen[0];</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                  data_log1 &lt;&lt; std::endl;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                } <span class="comment">// if good</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            } <span class="comment">// loop over i</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;          } <span class="comment">// if IOProcessor</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="preprocessor">#ifdef AMREX_LAZY</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        });</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    } <span class="comment">// if verbose</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="comment">// This is just an alias for convenience</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keywordtype">int</span> lev = 0;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a41324a4b5610fde725fe721550b23c85">NumSamplePointLogs</a>() &gt; 0 &amp;&amp; <a class="code" href="classERF.html#a5bc7dd2c7e1ebf65b7dc1d9bf0dfb36f">NumSamplePoints</a>() &gt; 0) {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classERF.html#a5bc7dd2c7e1ebf65b7dc1d9bf0dfb36f">NumSamplePoints</a>(); ++i)</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        {</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            <a class="code" href="classERF.html#aa28182226262c67cfd686d35bfeabcad">sample_points</a>(lev, time, <a class="code" href="classERF.html#a9095d1b641b4d7f32ca5acb679786891">SamplePoint</a>(i), <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>]);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        }</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    }</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a14f922bdc3a0f23c087afa32c67ac119">NumSampleLineLogs</a>() &gt; 0 &amp;&amp; <a class="code" href="classERF.html#a70d78ca624acf09d8faab9a2d51264d9">NumSampleLines</a>() &gt; 0) {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classERF.html#a70d78ca624acf09d8faab9a2d51264d9">NumSampleLines</a>(); ++i)</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            <a class="code" href="classERF.html#afb798c72ea4fde6f4da8d01a24c8c165">sample_lines</a>(lev, time, <a class="code" href="classERF.html#a54357e2f81f3d7d3a9189a3e21283e6b">SampleLine</a>(i), <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>]);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        }</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_a14f922bdc3a0f23c087afa32c67ac119"><div class="ttname"><a href="classERF.html#a14f922bdc3a0f23c087afa32c67ac119">ERF::NumSampleLineLogs</a></div><div class="ttdeci">AMREX_FORCE_INLINE int NumSampleLineLogs() noexcept</div><div class="ttdef"><b>Definition:</b> ERF.H:936</div></div>
<div class="ttc" id="aclassERF_html_a41324a4b5610fde725fe721550b23c85"><div class="ttname"><a href="classERF.html#a41324a4b5610fde725fe721550b23c85">ERF::NumSamplePointLogs</a></div><div class="ttdeci">AMREX_FORCE_INLINE int NumSamplePointLogs() noexcept</div><div class="ttdef"><b>Definition:</b> ERF.H:922</div></div>
<div class="ttc" id="aclassERF_html_a54357e2f81f3d7d3a9189a3e21283e6b"><div class="ttname"><a href="classERF.html#a54357e2f81f3d7d3a9189a3e21283e6b">ERF::SampleLine</a></div><div class="ttdeci">amrex::IntVect &amp; SampleLine(int i)</div><div class="ttdef"><b>Definition:</b> ERF.H:955</div></div>
<div class="ttc" id="aclassERF_html_a5bc7dd2c7e1ebf65b7dc1d9bf0dfb36f"><div class="ttname"><a href="classERF.html#a5bc7dd2c7e1ebf65b7dc1d9bf0dfb36f">ERF::NumSamplePoints</a></div><div class="ttdeci">AMREX_FORCE_INLINE int NumSamplePoints() noexcept</div><div class="ttdef"><b>Definition:</b> ERF.H:949</div></div>
<div class="ttc" id="aclassERF_html_a70d78ca624acf09d8faab9a2d51264d9"><div class="ttname"><a href="classERF.html#a70d78ca624acf09d8faab9a2d51264d9">ERF::NumSampleLines</a></div><div class="ttdeci">AMREX_FORCE_INLINE int NumSampleLines() noexcept</div><div class="ttdef"><b>Definition:</b> ERF.H:962</div></div>
<div class="ttc" id="aclassERF_html_a9095d1b641b4d7f32ca5acb679786891"><div class="ttname"><a href="classERF.html#a9095d1b641b4d7f32ca5acb679786891">ERF::SamplePoint</a></div><div class="ttdeci">amrex::IntVect &amp; SamplePoint(int i)</div><div class="ttdef"><b>Definition:</b> ERF.H:942</div></div>
<div class="ttc" id="aclassERF_html_aa28182226262c67cfd686d35bfeabcad"><div class="ttname"><a href="classERF.html#aa28182226262c67cfd686d35bfeabcad">ERF::sample_points</a></div><div class="ttdeci">void sample_points(int lev, amrex::Real time, amrex::IntVect cell, amrex::MultiFab &amp;mf)</div><div class="ttdef"><b>Definition:</b> ERF_WriteScalarProfiles.cpp:184</div></div>
<div class="ttc" id="aclassERF_html_aa2c3ee1910008b828b9da79ccdfe3871"><div class="ttname"><a href="classERF.html#aa2c3ee1910008b828b9da79ccdfe3871">ERF::DataLog</a></div><div class="ttdeci">AMREX_FORCE_INLINE std::ostream &amp; DataLog(int i)</div><div class="ttdef"><b>Definition:</b> ERF.H:901</div></div>
<div class="ttc" id="aclassERF_html_ac1238c1616826c66df1dfd9076e6a3da"><div class="ttname"><a href="classERF.html#ac1238c1616826c66df1dfd9076e6a3da">ERF::NumDataLogs</a></div><div class="ttdeci">AMREX_FORCE_INLINE int NumDataLogs() noexcept</div><div class="ttdef"><b>Definition:</b> ERF.H:908</div></div>
<div class="ttc" id="aclassERF_html_ae959fa22a0c888a6da28d385054edf82"><div class="ttname"><a href="classERF.html#ae959fa22a0c888a6da28d385054edf82">ERF::volWgtSumMF</a></div><div class="ttdeci">amrex::Real volWgtSumMF(int lev, const amrex::MultiFab &amp;mf, int comp, const amrex::MultiFab &amp;mapfac, bool local, bool finemask)</div><div class="ttdef"><b>Definition:</b> ERF_WriteScalarProfiles.cpp:313</div></div>
<div class="ttc" id="aclassERF_html_afb798c72ea4fde6f4da8d01a24c8c165"><div class="ttname"><a href="classERF.html#afb798c72ea4fde6f4da8d01a24c8c165">ERF::sample_lines</a></div><div class="ttdeci">void sample_lines(int lev, amrex::Real time, amrex::IntVect cell, amrex::MultiFab &amp;mf)</div><div class="ttdef"><b>Definition:</b> ERF_WriteScalarProfiles.cpp:222</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aff397ccf7eb99c51d7c705a35e85ec5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff397ccf7eb99c51d7c705a35e85ec5f">&#9670;&nbsp;</a></span>timeStep()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::timeStep </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iteration</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Function that coordinates the evolution across levels &ndash; this calls Advance to do the actual advance at this level, then recursively calls itself at finer levels</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">lev</td><td>level of refinement (coarsest level is 0) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">time</td><td>start time for time advance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iteration</td><td>time step counter </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;{</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a3937527f96c81674fa38dc34ed24f3f5">regrid_int</a> &gt; 0)  <span class="comment">// We may need to regrid</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    {</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;        <span class="comment">// help keep track of whether a level was already regridded</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;        <span class="comment">// from a coarser level call to regrid</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;        <span class="keyword">static</span> Vector&lt;int&gt; last_regrid_step(max_level+1, 0);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160; </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;        <span class="comment">// regrid changes level &quot;lev+1&quot; so we don&#39;t regrid on max_level</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;        <span class="comment">// also make sure we don&#39;t regrid fine levels again if</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;        <span class="comment">// it was taken care of during a coarser regrid</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        <span class="keywordflow">if</span> (lev &lt; max_level)</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        {</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;            <span class="keywordflow">if</span> ( (<a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[lev] % <a class="code" href="classERF.html#a3937527f96c81674fa38dc34ed24f3f5">regrid_int</a> == 0) &amp;&amp; (<a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[lev] &gt; last_regrid_step[lev]) )</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;            {</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;                <span class="comment">// regrid could add newly refine levels (if finest_level &lt; max_level)</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;                <span class="comment">// so we save the previous finest level index</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;                <span class="keywordtype">int</span> old_finest = finest_level;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;                regrid(lev, time);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;                <span class="comment">// mark that we have regridded this level already</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = lev; k &lt;= finest_level; ++k) {</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;                    last_regrid_step[k] = <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[k];</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                }</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;                <span class="comment">// if there are newly created levels, set the time step</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = old_finest+1; k &lt;= finest_level; ++k) {</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;                    <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[k] = <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[k-1] / MaxRefRatio(k-1);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;                }</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;            } <span class="comment">// if</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        } <span class="comment">// lev</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    }</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="comment">// Update what we call &quot;old&quot; and &quot;new&quot; time</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <a class="code" href="classERF.html#a7085d7d5fc94a0f84efc06957267d58e">t_old</a>[lev] = <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev];</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev] += <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[lev];</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keywordflow">if</span> (Verbose()) {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;[Level &quot;</span> &lt;&lt; lev &lt;&lt; <span class="stringliteral">&quot; step &quot;</span> &lt;&lt; <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[lev]+1 &lt;&lt; <span class="stringliteral">&quot;] &quot;</span>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;ADVANCE from time = &quot;</span> &lt;&lt; <a class="code" href="classERF.html#a7085d7d5fc94a0f84efc06957267d58e">t_old</a>[lev] &lt;&lt; <span class="stringliteral">&quot; to &quot;</span> &lt;&lt; <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev]</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot; with dt = &quot;</span> &lt;&lt; <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[lev] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    }</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="comment">// Advance a single level for a single time step</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <a class="code" href="classERF.html#a47413fe5588f7dd71a1d5087a9e804f9">Advance</a>(lev, time, <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[lev], iteration, <a class="code" href="classERF.html#aa3db2dd1b65310c66c4038650c22aaee">nsubsteps</a>[lev]);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    ++<a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[lev];</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordflow">if</span> (Verbose())</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;[Level &quot;</span> &lt;&lt; lev &lt;&lt; <span class="stringliteral">&quot; step &quot;</span> &lt;&lt; <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[lev] &lt;&lt; <span class="stringliteral">&quot;] &quot;</span>;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Advanced &quot;</span> &lt;&lt; CountCells(lev) &lt;&lt; <span class="stringliteral">&quot; cells&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    }</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keywordflow">if</span> (lev &lt; finest_level)</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <span class="comment">// recursive call for next-finer level</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt;= <a class="code" href="classERF.html#aa3db2dd1b65310c66c4038650c22aaee">nsubsteps</a>[lev+1]; ++i)</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            Real strt_time_for_fine = time + (i-1)*<a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[lev+1];</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            <a class="code" href="classERF.html#aff397ccf7eb99c51d7c705a35e85ec5f">timeStep</a>(lev+1, strt_time_for_fine, i);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    }</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_a47413fe5588f7dd71a1d5087a9e804f9"><div class="ttname"><a href="classERF.html#a47413fe5588f7dd71a1d5087a9e804f9">ERF::Advance</a></div><div class="ttdeci">void Advance(int lev, amrex::Real time, amrex::Real dt_lev, int iteration, int ncycle)</div><div class="ttdef"><b>Definition:</b> ERF_Advance.cpp:20</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a419510fced05e9afc05c466beeeb66f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a419510fced05e9afc05c466beeeb66f7">&#9670;&nbsp;</a></span>update_diffusive_arrays()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::update_diffusive_arrays </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::BoxArray &amp;&#160;</td>
          <td class="paramname"><em>ba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::DistributionMapping &amp;&#160;</td>
          <td class="paramname"><em>dm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;{</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="comment">// Diffusive terms</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keywordtype">bool</span> l_use_terrain = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a063a88594452100497651e8aaf1f68d7">use_terrain</a>;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="keywordtype">bool</span> l_use_diff    = ( (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a396122e87a3d15c4ec8666d7dd18c095">diffChoice</a>.<a class="code" href="structDiffChoice.html#aed5c75ec58e358a735d97869147b2baf">molec_diff_type</a> != <a class="code" href="DiffStruct_8H.html#a84e6bfbbb8e490790c506939b364f735a6adf97f83acf6453d4a6a4b1070f3754">MolecDiffType::None</a>) ||</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                           (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa53b017d79e0067923180a0aa59367b4">turbChoice</a>[lev].les_type        !=       <a class="code" href="TurbStruct_8H.html#aa346fa9f5c0cb101a7766563fb76c500a6adf97f83acf6453d4a6a4b1070f3754">LESType::None</a>) ||</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                           (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa53b017d79e0067923180a0aa59367b4">turbChoice</a>[lev].pbl_type        !=       <a class="code" href="TurbStruct_8H.html#a4a079f2650ca30c787a8375ec5f17ca5a6adf97f83acf6453d4a6a4b1070f3754">PBLType::None</a>) );</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="keywordtype">bool</span> l_use_kturb   = ( (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa53b017d79e0067923180a0aa59367b4">turbChoice</a>[lev].les_type        != <a class="code" href="TurbStruct_8H.html#aa346fa9f5c0cb101a7766563fb76c500a6adf97f83acf6453d4a6a4b1070f3754">LESType::None</a>)   ||</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                           (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa53b017d79e0067923180a0aa59367b4">turbChoice</a>[lev].pbl_type        != <a class="code" href="TurbStruct_8H.html#a4a079f2650ca30c787a8375ec5f17ca5a6adf97f83acf6453d4a6a4b1070f3754">PBLType::None</a>) );</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="keywordtype">bool</span> l_use_ddorf   = (  <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa53b017d79e0067923180a0aa59367b4">turbChoice</a>[lev].les_type        == <a class="code" href="TurbStruct_8H.html#aa346fa9f5c0cb101a7766563fb76c500ab7106655ebb5e00e0f040302bf4129bf">LESType::Deardorff</a>);</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160; </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    BoxArray ba12 = convert(ba, IntVect(1,1,0));</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    BoxArray ba13 = convert(ba, IntVect(1,0,1));</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    BoxArray ba23 = convert(ba, IntVect(0,1,1));</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160; </div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="keywordflow">if</span> (l_use_diff) {</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        <a class="code" href="classERF.html#aeb9348353b2415d023d8f52c293cad7e">Tau11_lev</a>[lev] = std::make_unique&lt;MultiFab&gt;( ba  , dm, 1, IntVect(1,1,0) );</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        <a class="code" href="classERF.html#afb4294f848d86e4aefb74848bb71047e">Tau22_lev</a>[lev] = std::make_unique&lt;MultiFab&gt;( ba  , dm, 1, IntVect(1,1,0) );</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        <a class="code" href="classERF.html#a60a185c47f07bf4fb537a15d5a226d8a">Tau33_lev</a>[lev] = std::make_unique&lt;MultiFab&gt;( ba  , dm, 1, IntVect(1,1,0) );</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        <a class="code" href="classERF.html#ad8c2eca71737b102cc5cf75f97c6bd63">Tau12_lev</a>[lev] = std::make_unique&lt;MultiFab&gt;( ba12, dm, 1, IntVect(1,1,0) );</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        <a class="code" href="classERF.html#a5392e6104804d799b3fd943dfe390766">Tau13_lev</a>[lev] = std::make_unique&lt;MultiFab&gt;( ba13, dm, 1, IntVect(1,1,0) );</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        <a class="code" href="classERF.html#a03a4ad7368c1c98b492cd9d9fec9cbc5">Tau23_lev</a>[lev] = std::make_unique&lt;MultiFab&gt;( ba23, dm, 1, IntVect(1,1,0) );</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        <span class="keywordflow">if</span> (l_use_terrain) {</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;            <a class="code" href="classERF.html#a547864dc0347f4620feb99ed564acb4d">Tau21_lev</a>[lev] = std::make_unique&lt;MultiFab&gt;( ba12, dm, 1, IntVect(1,1,0) );</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;            <a class="code" href="classERF.html#a203e7334296218672e36bab93174e146">Tau31_lev</a>[lev] = std::make_unique&lt;MultiFab&gt;( ba13, dm, 1, IntVect(1,1,0) );</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;            <a class="code" href="classERF.html#aa650bf1f6885b179fd8d4c24b48668cb">Tau32_lev</a>[lev] = std::make_unique&lt;MultiFab&gt;( ba23, dm, 1, IntVect(1,1,0) );</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;            <a class="code" href="classERF.html#a547864dc0347f4620feb99ed564acb4d">Tau21_lev</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;            <a class="code" href="classERF.html#a203e7334296218672e36bab93174e146">Tau31_lev</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;            <a class="code" href="classERF.html#aa650bf1f6885b179fd8d4c24b48668cb">Tau32_lev</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        }</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        <a class="code" href="classERF.html#a25174b4ae6cfcac8f7d183ce5c9fe67b">SFS_hfx1_lev</a>[lev] = std::make_unique&lt;MultiFab&gt;( ba  , dm, 1, IntVect(1,1,0) );</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        <a class="code" href="classERF.html#acb607b2e675b45fdcabc09b640ce5ae2">SFS_hfx2_lev</a>[lev] = std::make_unique&lt;MultiFab&gt;( ba  , dm, 1, IntVect(1,1,0) );</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        <a class="code" href="classERF.html#a1a2e3faf5dd90ad2f9ded28b486f3b46">SFS_hfx3_lev</a>[lev] = std::make_unique&lt;MultiFab&gt;( ba  , dm, 1, IntVect(1,1,1) );</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        <a class="code" href="classERF.html#a6e1ad417e3bd062468d74830b65911fb">SFS_diss_lev</a>[lev] = std::make_unique&lt;MultiFab&gt;( ba  , dm, 1, IntVect(1,1,0) );</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        <a class="code" href="classERF.html#a25174b4ae6cfcac8f7d183ce5c9fe67b">SFS_hfx1_lev</a>[lev]-&gt;setVal(0.);</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        <a class="code" href="classERF.html#acb607b2e675b45fdcabc09b640ce5ae2">SFS_hfx2_lev</a>[lev]-&gt;setVal(0.);</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        <a class="code" href="classERF.html#a1a2e3faf5dd90ad2f9ded28b486f3b46">SFS_hfx3_lev</a>[lev]-&gt;setVal(0.);</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        <a class="code" href="classERF.html#a6e1ad417e3bd062468d74830b65911fb">SFS_diss_lev</a>[lev]-&gt;setVal(0.);</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        <a class="code" href="classERF.html#aeb9348353b2415d023d8f52c293cad7e">Tau11_lev</a>[lev] = <span class="keyword">nullptr</span>; <a class="code" href="classERF.html#afb4294f848d86e4aefb74848bb71047e">Tau22_lev</a>[lev] = <span class="keyword">nullptr</span>; <a class="code" href="classERF.html#a60a185c47f07bf4fb537a15d5a226d8a">Tau33_lev</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        <a class="code" href="classERF.html#ad8c2eca71737b102cc5cf75f97c6bd63">Tau12_lev</a>[lev] = <span class="keyword">nullptr</span>; <a class="code" href="classERF.html#a547864dc0347f4620feb99ed564acb4d">Tau21_lev</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        <a class="code" href="classERF.html#a5392e6104804d799b3fd943dfe390766">Tau13_lev</a>[lev] = <span class="keyword">nullptr</span>; <a class="code" href="classERF.html#a203e7334296218672e36bab93174e146">Tau31_lev</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        <a class="code" href="classERF.html#a03a4ad7368c1c98b492cd9d9fec9cbc5">Tau23_lev</a>[lev] = <span class="keyword">nullptr</span>; <a class="code" href="classERF.html#aa650bf1f6885b179fd8d4c24b48668cb">Tau32_lev</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        <a class="code" href="classERF.html#a25174b4ae6cfcac8f7d183ce5c9fe67b">SFS_hfx1_lev</a>[lev] = <span class="keyword">nullptr</span>; <a class="code" href="classERF.html#acb607b2e675b45fdcabc09b640ce5ae2">SFS_hfx2_lev</a>[lev] = <span class="keyword">nullptr</span>; <a class="code" href="classERF.html#a1a2e3faf5dd90ad2f9ded28b486f3b46">SFS_hfx3_lev</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        <a class="code" href="classERF.html#a6e1ad417e3bd062468d74830b65911fb">SFS_diss_lev</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    }</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160; </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="keywordflow">if</span> (l_use_kturb) {</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      <a class="code" href="classERF.html#a327d704704abd516be19339cb2d226f9">eddyDiffs_lev</a>[lev] = std::make_unique&lt;MultiFab&gt;( ba, dm, <a class="code" href="namespaceEddyDiff.html#a7e7e94a6b49fe20d106a1ea7317d149eaa3900ab375460932d825b615bb532446">EddyDiff::NumDiffs</a>, 1 );</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        <a class="code" href="classERF.html#a327d704704abd516be19339cb2d226f9">eddyDiffs_lev</a>[lev]-&gt;setVal(0.0);</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        <span class="keywordflow">if</span>(l_use_ddorf) {</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;            <a class="code" href="classERF.html#a9faaa96a7c270d2b2b062d9f30f19711">SmnSmn_lev</a>[lev] = std::make_unique&lt;MultiFab&gt;( ba, dm, 1, 0 );</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;            <a class="code" href="classERF.html#a9faaa96a7c270d2b2b062d9f30f19711">SmnSmn_lev</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        }</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        <a class="code" href="classERF.html#a327d704704abd516be19339cb2d226f9">eddyDiffs_lev</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        <a class="code" href="classERF.html#a9faaa96a7c270d2b2b062d9f30f19711">SmnSmn_lev</a>[lev]    = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    }</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;}</div>
<div class="ttc" id="anamespaceEddyDiff_html_a7e7e94a6b49fe20d106a1ea7317d149eaa3900ab375460932d825b615bb532446"><div class="ttname"><a href="namespaceEddyDiff.html#a7e7e94a6b49fe20d106a1ea7317d149eaa3900ab375460932d825b615bb532446">EddyDiff::NumDiffs</a></div><div class="ttdeci">@ NumDiffs</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:134</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a900a0119c110486650f2759287e22cba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a900a0119c110486650f2759287e22cba">&#9670;&nbsp;</a></span>update_terrain_arrays()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::update_terrain_arrays </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;{</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a063a88594452100497651e8aaf1f68d7">use_terrain</a>) {</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160; </div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        <span class="keywordflow">if</span> (lev == 0 &amp;&amp; (<a class="code" href="classERF.html#af5ac3d88a33a1a284bcc120ce0599cf7">init_type</a> != <span class="stringliteral">&quot;real&quot;</span> &amp;&amp; <a class="code" href="classERF.html#af5ac3d88a33a1a284bcc120ce0599cf7">init_type</a> != <span class="stringliteral">&quot;metgrid&quot;</span>) ) {</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;            <a class="code" href="classERF.html#a60e8cb933f237903e3fbcd6376c26db0">prob</a>-&gt;init_custom_terrain(geom[lev],*<a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev],time);</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;            <a class="code" href="TerrainMetrics_8cpp.html#ab4ed6da36c5cfb17fcc586771300cee8">init_terrain_grid</a>(lev,geom[lev],*<a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev],<a class="code" href="classERF.html#a7a4d6e7887fa8f30c33a0b8899035ddb">zlevels_stag</a>);</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        }</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160; </div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        <span class="keywordflow">if</span> (lev &gt; 0) {</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;            PhysBCFunctNoOp empty_bc;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;            Vector&lt;MultiFab*&gt; fmf = {<a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev].get(), <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev].get()};</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;            Vector&lt;Real&gt; ftime    = {<a class="code" href="classERF.html#a7085d7d5fc94a0f84efc06957267d58e">t_old</a>[lev], <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev]};</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;            Vector&lt;MultiFab*&gt; cmf = {<a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev-1].get(), <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev-1].get()};</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;            Vector&lt;Real&gt; ctime    = {<a class="code" href="classERF.html#a7085d7d5fc94a0f84efc06957267d58e">t_old</a>[lev-1], <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev-1]};</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160; </div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;            <span class="comment">// First we fill z_phys_nd at lev&gt;0 through interpolation</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;            FillPatchTwoLevels(*<a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev], time, cmf, ctime, fmf, ftime,</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                               0, 0, 1, geom[lev-1], geom[lev],</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                               empty_bc, 0, empty_bc, 0, refRatio(lev-1),</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                               &amp;node_bilinear_interp, <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>, 0);</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;            <span class="comment">// Then if not using real/metgrid data, we</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;            <span class="comment">// 1) redefine the terrain at k=0 for every fine box which includes k=0</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;            <span class="comment">// 2) recreate z_phys_nd at every fine node using</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;            <span class="comment">// the data at the bottom of each fine grid</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;            <span class="comment">// which has been either been interpolated from the coarse grid (k&gt;0)</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;            <span class="comment">// or set in init_custom_terrain (k=0)</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;            <a class="code" href="classERF.html#a60e8cb933f237903e3fbcd6376c26db0">prob</a>-&gt;init_custom_terrain(geom[lev],*<a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev],time);</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#af5ac3d88a33a1a284bcc120ce0599cf7">init_type</a> != <span class="stringliteral">&quot;real&quot;</span> &amp;&amp; <a class="code" href="classERF.html#af5ac3d88a33a1a284bcc120ce0599cf7">init_type</a> != <span class="stringliteral">&quot;metgrid&quot;</span>) {</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                <a class="code" href="TerrainMetrics_8cpp.html#ab4ed6da36c5cfb17fcc586771300cee8">init_terrain_grid</a>(lev,geom[lev],*<a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev],<a class="code" href="classERF.html#a7a4d6e7887fa8f30c33a0b8899035ddb">zlevels_stag</a>);</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;            }</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        }</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160; </div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        <a class="code" href="TerrainMetrics_8cpp.html#a9c1ecbedddfe464d9db02960e5422564">make_J</a>(geom[lev],*<a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev],*<a class="code" href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">detJ_cc</a>[lev]);</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        <a class="code" href="TerrainMetrics_8cpp.html#acc28d890df44cf0082a848c057042178">make_zcc</a>(geom[lev],*<a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev],*<a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[lev]);</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    }</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;}</div>
<div class="ttc" id="aTerrainMetrics_8cpp_html_a9c1ecbedddfe464d9db02960e5422564"><div class="ttname"><a href="TerrainMetrics_8cpp.html#a9c1ecbedddfe464d9db02960e5422564">make_J</a></div><div class="ttdeci">void make_J(const Geometry &amp;geom, MultiFab &amp;z_phys_nd, MultiFab &amp;detJ_cc)</div><div class="ttdef"><b>Definition:</b> TerrainMetrics.cpp:450</div></div>
<div class="ttc" id="aTerrainMetrics_8cpp_html_ab4ed6da36c5cfb17fcc586771300cee8"><div class="ttname"><a href="TerrainMetrics_8cpp.html#ab4ed6da36c5cfb17fcc586771300cee8">init_terrain_grid</a></div><div class="ttdeci">void init_terrain_grid(int lev, const Geometry &amp;geom, MultiFab &amp;z_phys_nd, Vector&lt; Real &gt; const &amp;z_levels_h)</div><div class="ttdef"><b>Definition:</b> TerrainMetrics.cpp:75</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a900a0119c110486650f2759287e22cba_cgraph.png" border="0" usemap="#aclassERF_a900a0119c110486650f2759287e22cba_cgraph" alt=""/></div>
<map name="aclassERF_a900a0119c110486650f2759287e22cba_cgraph" id="aclassERF_a900a0119c110486650f2759287e22cba_cgraph">
<area shape="rect" title=" " alt="" coords="5,49,155,90"/>
<area shape="rect" href="TerrainMetrics_8cpp.html#ab4ed6da36c5cfb17fcc586771300cee8" title=" " alt="" coords="203,5,328,32"/>
<area shape="rect" href="TerrainMetrics_8cpp.html#a9c1ecbedddfe464d9db02960e5422564" title=" " alt="" coords="231,56,300,83"/>
<area shape="rect" href="TerrainMetrics_8cpp.html#acc28d890df44cf0082a848c057042178" title=" " alt="" coords="222,107,309,133"/>
<area shape="rect" href="Microphysics__Utils_8H.html#ac54f1d17d8842acb42b2312cd353e469" title=" " alt="" coords="376,5,415,32"/>
</map>
</div>

</div>
</div>
<a id="ae959fa22a0c888a6da28d385054edf82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae959fa22a0c888a6da28d385054edf82">&#9670;&nbsp;</a></span>volWgtSumMF()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Real ERF::volWgtSumMF </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>mf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>comp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>mapfac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>local</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>finemask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Utility function for computing a volume weighted sum of MultiFab data for a single component</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lev</td><td>Current level </td></tr>
    <tr><td class="paramname">mf</td><td>MultiFab on which we do the volume weighted sum </td></tr>
    <tr><td class="paramname">comp</td><td>Index of the component we want to sum </td></tr>
    <tr><td class="paramname">local</td><td>Boolean sets whether or not to reduce the sum over the domain (false) or compute sums local to each MPI rank (true) </td></tr>
    <tr><td class="paramname">finemask</td><td>If a finer level is available, determines whether we mask fine data </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;{</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    BL_PROFILE(<span class="stringliteral">&quot;ERF::volWgtSumMF()&quot;</span>);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160; </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    Real sum = 0.0;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    MultiFab tmp(grids[lev], dmap[lev], 1, 0);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    MultiFab::Copy(tmp, mf, comp, 0, 1, 0);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="comment">// The quantity that is conserved is not (rho S), but rather (rho S / m^2) where</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="comment">// m is the map scale factor at cell centers</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keywordflow">for</span> (MFIter mfi(tmp, TilingIfNotGPU()); mfi.isValid(); ++mfi) {</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <span class="keyword">const</span> Array4&lt;      Real&gt;    tmp_arr =    tmp.array(mfi);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <span class="keyword">const</span> Array4&lt;const Real&gt; mapfac_arr = mapfac.const_array(mfi);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        ParallelFor(bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        {</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            tmp_arr(i,j,k) /= (mapfac_arr(i,j,0)*mapfac_arr(i,j,0));</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        });</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    } <span class="comment">// mfi</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160; </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keywordflow">if</span> (lev &lt; finest_level &amp;&amp; finemask) {</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        <span class="keyword">const</span> MultiFab&amp; mask = <a class="code" href="classERF.html#af46289079e053a6d74ddef0bf1a5d8a3">build_fine_mask</a>(lev+1);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        MultiFab::Multiply(tmp, mask, 0, 0, 1, 0);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    }</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160; </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    MultiFab volume(grids[lev], dmap[lev], 1, 0);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span>&amp; dx = geom[lev].CellSizeArray();</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    Real cell_vol = dx[0]*dx[1]*dx[2];</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    volume.setVal(cell_vol);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a063a88594452100497651e8aaf1f68d7">use_terrain</a>)</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        MultiFab::Multiply(volume, *<a class="code" href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">detJ_cc</a>[lev], 0, 0, 1, 0);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    sum = MultiFab::Dot(tmp, 0, volume, 0, 1, 0, local);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160; </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keywordflow">if</span> (!local)</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      ParallelDescriptor::ReduceRealSum(sum);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160; </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keywordflow">return</span> sum;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_af46289079e053a6d74ddef0bf1a5d8a3"><div class="ttname"><a href="classERF.html#af46289079e053a6d74ddef0bf1a5d8a3">ERF::build_fine_mask</a></div><div class="ttdeci">amrex::MultiFab &amp; build_fine_mask(int lev)</div><div class="ttdef"><b>Definition:</b> ERF_WriteScalarProfiles.cpp:362</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a55eae94c5363e227b571739738bb26b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55eae94c5363e227b571739738bb26b7">&#9670;&nbsp;</a></span>write_1D_profiles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::write_1D_profiles </td>
          <td>(</td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Writes 1-dimensional averaged quantities as profiles to output log files at the given time.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">time</td><td>Current time </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;{</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    BL_PROFILE(<span class="stringliteral">&quot;ERF::write_1D_profiles()&quot;</span>);</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a43d0b17f6e155691a1e9474526df3af5">verbose</a> &lt;= 0)</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <span class="keywordtype">int</span> datwidth = 14;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="keywordtype">int</span> datprecision = 6;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="keywordtype">int</span> timeprecision = 13; <span class="comment">// e.g., 1-yr LES: 31,536,000 s with dt ~ 0.01 ==&gt; min prec = 10</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a43d0b17f6e155691a1e9474526df3af5">verbose</a> &gt; 0 &amp;&amp; <a class="code" href="classERF.html#ac1238c1616826c66df1dfd9076e6a3da">NumDataLogs</a>() &gt; 1)</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    {</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        <span class="comment">// Define the 1d arrays we will need</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        Gpu::HostVector&lt;Real&gt; h_avg_u, h_avg_v, h_avg_w;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        Gpu::HostVector&lt;Real&gt; h_avg_rho, h_avg_th, h_avg_ksgs;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        Gpu::HostVector&lt;Real&gt; h_avg_uth, h_avg_vth, h_avg_wth, h_avg_thth;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        Gpu::HostVector&lt;Real&gt; h_avg_uu, h_avg_uv, h_avg_uw, h_avg_vv, h_avg_vw, h_avg_ww;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        Gpu::HostVector&lt;Real&gt; h_avg_uiuiu, h_avg_uiuiv, h_avg_uiuiw;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        Gpu::HostVector&lt;Real&gt; h_avg_p, h_avg_pu, h_avg_pv, h_avg_pw;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        Gpu::HostVector&lt;Real&gt; h_avg_tau11, h_avg_tau12, h_avg_tau13, h_avg_tau22, h_avg_tau23, h_avg_tau33;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        Gpu::HostVector&lt;Real&gt; h_avg_sgshfx, h_avg_sgsdiss; <span class="comment">// only output tau_{theta,w} and epsilon for now</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ac1238c1616826c66df1dfd9076e6a3da">NumDataLogs</a>() &gt; 1) {</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;            <a class="code" href="classERF.html#a07f151e7fbc8aa6c4ac8b52bd4c49e2e">derive_diag_profiles</a>(h_avg_u, h_avg_v, h_avg_w,</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                                 h_avg_rho, h_avg_th, h_avg_ksgs,</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;                                 h_avg_uu, h_avg_uv, h_avg_uw, h_avg_vv, h_avg_vw, h_avg_ww,</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;                                 h_avg_uth, h_avg_vth, h_avg_wth, h_avg_thth,</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;                                 h_avg_uiuiu, h_avg_uiuiv, h_avg_uiuiw,</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;                                 h_avg_p, h_avg_pu, h_avg_pv, h_avg_pw);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        }</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ac1238c1616826c66df1dfd9076e6a3da">NumDataLogs</a>() &gt; 3) {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;            <a class="code" href="classERF.html#a0f0aaad01835b2f1ce8f42112877ef47">derive_stress_profiles</a>(h_avg_tau11, h_avg_tau12, h_avg_tau13,</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;                                   h_avg_tau22, h_avg_tau23, h_avg_tau33,</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;                                   h_avg_sgshfx,</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                                   h_avg_sgsdiss);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        }</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <span class="keywordtype">int</span> hu_size =  h_avg_u.size();</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <span class="keyword">auto</span> <span class="keyword">const</span>&amp; dx = geom[0].CellSizeArray();</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <span class="keywordflow">if</span> (ParallelDescriptor::IOProcessor()) {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ac1238c1616826c66df1dfd9076e6a3da">NumDataLogs</a>() &gt; 1) {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                std::ostream&amp; data_log1 = <a class="code" href="classERF.html#aa2c3ee1910008b828b9da79ccdfe3871">DataLog</a>(1);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                <span class="keywordflow">if</span> (data_log1.good()) {</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                  <span class="comment">// Write the quantities at this time</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; hu_size; k++) {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                      Real <a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> = (k + 0.5)* dx[2];</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                      data_log1 &lt;&lt; std::setw(datwidth) &lt;&lt; std::setprecision(timeprecision) &lt;&lt; time &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                                &lt;&lt; std::setw(datwidth) &lt;&lt; std::setprecision(datprecision) &lt;&lt; <a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                                &lt;&lt; h_avg_u[k]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_v[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_w[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                                &lt;&lt; h_avg_rho[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_th[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_ksgs[k]</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                  } <span class="comment">// loop over z</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                } <span class="comment">// if good</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            } <span class="comment">// NumDataLogs</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ac1238c1616826c66df1dfd9076e6a3da">NumDataLogs</a>() &gt; 2) {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                std::ostream&amp; data_log2 = <a class="code" href="classERF.html#aa2c3ee1910008b828b9da79ccdfe3871">DataLog</a>(2);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                <span class="keywordflow">if</span> (data_log2.good()) {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                  <span class="comment">// Write the perturbational quantities at this time</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; hu_size; k++) {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                      Real <a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> = (k + 0.5)* dx[2];</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                      data_log2 &lt;&lt; std::setw(datwidth) &lt;&lt; std::setprecision(timeprecision) &lt;&lt; time &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                                &lt;&lt; std::setw(datwidth) &lt;&lt; std::setprecision(datprecision) &lt;&lt; <a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                                &lt;&lt; h_avg_uu[k]   - h_avg_u[k]*h_avg_u[k]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                                &lt;&lt; h_avg_uv[k]   - h_avg_u[k]*h_avg_v[k]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                                &lt;&lt; h_avg_uw[k]   - h_avg_u[k]*h_avg_w[k]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                                &lt;&lt; h_avg_vv[k]   - h_avg_v[k]*h_avg_v[k]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                                &lt;&lt; h_avg_vw[k]   - h_avg_v[k]*h_avg_w[k]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                                &lt;&lt; h_avg_ww[k]   - h_avg_w[k]*h_avg_w[k]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                                &lt;&lt; h_avg_uth[k]  - h_avg_u[k]*h_avg_th[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                                &lt;&lt; h_avg_vth[k]  - h_avg_v[k]*h_avg_th[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                                &lt;&lt; h_avg_wth[k]  - h_avg_w[k]*h_avg_th[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                                &lt;&lt; h_avg_thth[k] - h_avg_th[k]*h_avg_th[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                                <span class="comment">// Note: &lt;u&#39;_i u&#39;_i u&#39;_j&gt; =   &lt;u_i u_i u_j&gt;</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                                <span class="comment">//                        -   &lt;u_i u_i&gt; * &lt;u_j&gt;</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                                <span class="comment">//                        - 2*&lt;u_i&gt; * &lt;u_i u_j&gt;</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                                <span class="comment">//                        + 2*&lt;u_i&gt;*&lt;u_i&gt; * &lt;u_j&gt;</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                                &lt;&lt; h_avg_uiuiu[k]</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                                 - (h_avg_uu[k] + h_avg_vv[k] + h_avg_ww[k])*h_avg_u[k]</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                                 - 2*(h_avg_u[k]*h_avg_uu[k] + h_avg_v[k]*h_avg_uv[k] + h_avg_w[k]*h_avg_uw[k])</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                                 + 2*(h_avg_u[k]*h_avg_u[k] + h_avg_v[k]*h_avg_v[k] + h_avg_w[k]*h_avg_w[k])*h_avg_u[k]</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                                   &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// (u&#39;_i u&#39;_i)u&#39;</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                                &lt;&lt; h_avg_uiuiv[k]</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                                 - (h_avg_uu[k] + h_avg_vv[k] + h_avg_ww[k])*h_avg_v[k]</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                                 - 2*(h_avg_u[k]*h_avg_uv[k] + h_avg_v[k]*h_avg_vv[k] + h_avg_w[k]*h_avg_vw[k])</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                                 + 2*(h_avg_u[k]*h_avg_u[k] + h_avg_v[k]*h_avg_v[k] + h_avg_w[k]*h_avg_w[k])*h_avg_v[k]</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                                   &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// (u&#39;_i u&#39;_i)v&#39;</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                                &lt;&lt; h_avg_uiuiw[k]</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                                 - (h_avg_uu[k] + h_avg_vv[k] + h_avg_ww[k])*h_avg_w[k]</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                                 - 2*(h_avg_u[k]*h_avg_uw[k] + h_avg_v[k]*h_avg_vw[k] + h_avg_w[k]*h_avg_ww[k])</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                                 + 2*(h_avg_u[k]*h_avg_u[k] + h_avg_v[k]*h_avg_v[k] + h_avg_w[k]*h_avg_w[k])*h_avg_w[k]</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                                   &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// (u&#39;_i u&#39;_i)w&#39;</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                                &lt;&lt; h_avg_pu[k]   - h_avg_p[k]*h_avg_u[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                                &lt;&lt; h_avg_pv[k]   - h_avg_p[k]*h_avg_v[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                                &lt;&lt; h_avg_pw[k]   - h_avg_p[k]*h_avg_w[k]</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                  } <span class="comment">// loop over z</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                } <span class="comment">// if good</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            } <span class="comment">// NumDataLogs</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ac1238c1616826c66df1dfd9076e6a3da">NumDataLogs</a>() &gt; 3) {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                std::ostream&amp; data_log3 = <a class="code" href="classERF.html#aa2c3ee1910008b828b9da79ccdfe3871">DataLog</a>(3);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                <span class="keywordflow">if</span> (data_log3.good()) {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                  <span class="comment">// Write the average stresses</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; hu_size; k++) {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                      Real <a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> = (k + 0.5)* dx[2];</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                      data_log3 &lt;&lt; std::setw(datwidth) &lt;&lt; std::setprecision(timeprecision) &lt;&lt; time &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                                &lt;&lt; std::setw(datwidth) &lt;&lt; std::setprecision(datprecision) &lt;&lt; <a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                                &lt;&lt; h_avg_tau11[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_tau12[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_tau13[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                                &lt;&lt; h_avg_tau22[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_tau23[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_tau33[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                                &lt;&lt; h_avg_sgshfx[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_sgsdiss[k]</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                  } <span class="comment">// loop over z</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                } <span class="comment">// if good</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            } <span class="comment">// NumDataLogs</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        } <span class="comment">// if IOProcessor</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    } <span class="comment">// if verbose</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;}</div>
<div class="ttc" id="aDataStruct_8H_html_a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7"><div class="ttname"><a href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">Coord::z</a></div><div class="ttdeci">@ z</div></div>
<div class="ttc" id="aclassERF_html_a07f151e7fbc8aa6c4ac8b52bd4c49e2e"><div class="ttname"><a href="classERF.html#a07f151e7fbc8aa6c4ac8b52bd4c49e2e">ERF::derive_diag_profiles</a></div><div class="ttdeci">void derive_diag_profiles(amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_u, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_v, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_w, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_rho, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_th, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_ksgs, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_uu, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_uv, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_uw, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_vv, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_vw, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_ww, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_uth, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_vth, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_wth, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_thth, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_ku, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_kv, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_kw, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_p, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_pu, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_pv, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_pw)</div><div class="ttdef"><b>Definition:</b> ERF_Write1DProfiles.cpp:162</div></div>
<div class="ttc" id="aclassERF_html_a0f0aaad01835b2f1ce8f42112877ef47"><div class="ttname"><a href="classERF.html#a0f0aaad01835b2f1ce8f42112877ef47">ERF::derive_stress_profiles</a></div><div class="ttdeci">void derive_stress_profiles(amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_tau11, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_tau12, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_tau13, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_tau22, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_tau23, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_tau33, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_hfx3, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_diss)</div><div class="ttdef"><b>Definition:</b> ERF_Write1DProfiles.cpp:327</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a39efa3a0f3ae3deb7a43f4ce110ee49a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39efa3a0f3ae3deb7a43f4ce110ee49a">&#9670;&nbsp;</a></span>write_1D_profiles_stag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::write_1D_profiles_stag </td>
          <td>(</td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Writes 1-dimensional averaged quantities as profiles to output log files at the given time. Quantities are output at their native grid locations, therefore W and associated quantities &lt;(*)'w'&gt;, tau13, and tau23 (where * includes u, v, p, theta, and k) will be output at staggered heights (i.e., z faces) rather than cell-center heights to avoid performing additional averaging. The unstaggered quantities are associated with the left cell face, i.e., they share the same k index. These quantities will have a zero value at the max height of Nz+1.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">time</td><td>Current time </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;{</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    BL_PROFILE(<span class="stringliteral">&quot;ERF::write_1D_profiles()&quot;</span>);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a43d0b17f6e155691a1e9474526df3af5">verbose</a> &lt;= 0)</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keywordtype">int</span> datwidth = 14;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keywordtype">int</span> datprecision = 6;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="keywordtype">int</span> timeprecision = 13; <span class="comment">// e.g., 1-yr LES: 31,536,000 s with dt ~ 0.01 ==&gt; min prec = 10</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a43d0b17f6e155691a1e9474526df3af5">verbose</a> &gt; 0 &amp;&amp; <a class="code" href="classERF.html#ac1238c1616826c66df1dfd9076e6a3da">NumDataLogs</a>() &gt; 1)</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    {</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        <span class="comment">// Define the 1d arrays we will need</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        Gpu::HostVector&lt;Real&gt; h_avg_u, h_avg_v, h_avg_w;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        Gpu::HostVector&lt;Real&gt; h_avg_rho, h_avg_th, h_avg_ksgs;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        Gpu::HostVector&lt;Real&gt; h_avg_uth, h_avg_vth, h_avg_wth, h_avg_thth;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        Gpu::HostVector&lt;Real&gt; h_avg_uu, h_avg_uv, h_avg_uw, h_avg_vv, h_avg_vw, h_avg_ww;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        Gpu::HostVector&lt;Real&gt; h_avg_uiuiu, h_avg_uiuiv, h_avg_uiuiw;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        Gpu::HostVector&lt;Real&gt; h_avg_p, h_avg_pu, h_avg_pv, h_avg_pw;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        Gpu::HostVector&lt;Real&gt; h_avg_tau11, h_avg_tau12, h_avg_tau13, h_avg_tau22, h_avg_tau23, h_avg_tau33;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        Gpu::HostVector&lt;Real&gt; h_avg_sgshfx, h_avg_sgsdiss; <span class="comment">// only output tau_{theta,w} and epsilon for now</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ac1238c1616826c66df1dfd9076e6a3da">NumDataLogs</a>() &gt; 1) {</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;            <a class="code" href="classERF.html#a8e3bb984f352bb1b0887d4cf88bc7139">derive_diag_profiles_stag</a>(h_avg_u, h_avg_v, h_avg_w,</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;                                      h_avg_rho, h_avg_th, h_avg_ksgs,</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                                      h_avg_uu, h_avg_uv, h_avg_uw, h_avg_vv, h_avg_vw, h_avg_ww,</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;                                      h_avg_uth, h_avg_vth, h_avg_wth, h_avg_thth,</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;                                      h_avg_uiuiu, h_avg_uiuiv, h_avg_uiuiw,</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;                                      h_avg_p, h_avg_pu, h_avg_pv, h_avg_pw);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        }</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ac1238c1616826c66df1dfd9076e6a3da">NumDataLogs</a>() &gt; 3) {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;            <a class="code" href="classERF.html#aa1d539b1b91119c61ec5d3efd2897cc9">derive_stress_profiles_stag</a>(h_avg_tau11, h_avg_tau12, h_avg_tau13,</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                                        h_avg_tau22, h_avg_tau23, h_avg_tau33,</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                                        h_avg_sgshfx,</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                                        h_avg_sgsdiss);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        }</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <span class="keywordtype">int</span> unstag_size =  h_avg_w.size() - 1; <span class="comment">// _un_staggered heights</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <span class="keyword">auto</span> <span class="keyword">const</span>&amp; dx = geom[0].CellSizeArray();</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <span class="keywordflow">if</span> (ParallelDescriptor::IOProcessor()) {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ac1238c1616826c66df1dfd9076e6a3da">NumDataLogs</a>() &gt; 1) {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                std::ostream&amp; data_log1 = <a class="code" href="classERF.html#aa2c3ee1910008b828b9da79ccdfe3871">DataLog</a>(1);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                <span class="keywordflow">if</span> (data_log1.good()) {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                  <span class="comment">// Write the quantities at this time</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; unstag_size; k++) {</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                      Real <a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> = k * dx[2];</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                      data_log1 &lt;&lt; std::setw(datwidth) &lt;&lt; std::setprecision(timeprecision) &lt;&lt; time &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                                &lt;&lt; std::setw(datwidth) &lt;&lt; std::setprecision(datprecision) &lt;&lt; <a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                                &lt;&lt; h_avg_u[k]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_v[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_w[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                                &lt;&lt; h_avg_rho[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_th[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_ksgs[k]</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                  } <span class="comment">// loop over z</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                  <span class="comment">// Write top face values</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                  data_log1 &lt;&lt; std::setw(datwidth) &lt;&lt; std::setprecision(timeprecision) &lt;&lt; time &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                            &lt;&lt; std::setw(datwidth) &lt;&lt; std::setprecision(datprecision) &lt;&lt; unstag_size * dx[2] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                            &lt;&lt; 0  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; 0 &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_w[unstag_size+1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                            &lt;&lt; 0 &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; 0 &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; 0</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                } <span class="comment">// if good</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            } <span class="comment">// NumDataLogs</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ac1238c1616826c66df1dfd9076e6a3da">NumDataLogs</a>() &gt; 2) {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                std::ostream&amp; data_log2 = <a class="code" href="classERF.html#aa2c3ee1910008b828b9da79ccdfe3871">DataLog</a>(2);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                <span class="keywordflow">if</span> (data_log2.good()) {</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                  <span class="comment">// Write the perturbational quantities at this time</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                  <span class="comment">// For surface values (k=0), assume w = uw = vw = ww = 0</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                  Real w_cc  = h_avg_w[1] / 2;  <span class="comment">// w at first cell center</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                  Real uw_cc = h_avg_uw[1] / 2; <span class="comment">// u*w at first cell center</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                  Real vw_cc = h_avg_vw[1] / 2; <span class="comment">// v*w at first cell center</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                  Real ww_cc = h_avg_ww[1] / 2; <span class="comment">// w*w at first cell center</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                  data_log2 &lt;&lt; std::setw(datwidth) &lt;&lt; std::setprecision(timeprecision) &lt;&lt; time &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                            &lt;&lt; std::setw(datwidth) &lt;&lt; std::setprecision(datprecision) &lt;&lt; 0 &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                            &lt;&lt; h_avg_uu[0]   - h_avg_u[0]*h_avg_u[0]   &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// u&#39;u&#39;</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                            &lt;&lt; h_avg_uv[0]   - h_avg_u[0]*h_avg_v[0]   &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// u&#39;v&#39;</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                            &lt;&lt; 0                                       &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// u&#39;w&#39;</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                            &lt;&lt; h_avg_vv[0]   - h_avg_v[0]*h_avg_v[0]   &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// v&#39;v&#39;</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                            &lt;&lt; 0                                       &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// v&#39;w&#39;</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                            &lt;&lt; 0                                       &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// w&#39;w&#39;</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                            &lt;&lt; h_avg_uth[0]  - h_avg_u[0]*h_avg_th[0]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// u&#39;th&#39;</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                            &lt;&lt; h_avg_vth[0]  - h_avg_v[0]*h_avg_th[0]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// v&#39;th&#39;</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                            &lt;&lt; 0                                       &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// w&#39;th&#39;</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                            &lt;&lt; h_avg_thth[0] - h_avg_th[0]*h_avg_th[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// th&#39;th&#39;</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                            &lt;&lt; h_avg_uiuiu[0]</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                             - (h_avg_uu[0] + h_avg_vv[0] + ww_cc)*h_avg_u[0]</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                             - 2*(h_avg_u[0]*h_avg_uu[0] + h_avg_v[0]*h_avg_uv[0] + w_cc*uw_cc)</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                             + 2*(h_avg_u[0]*h_avg_u[0] + h_avg_v[0]*h_avg_v[0] + w_cc*w_cc)*h_avg_u[0]</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                               &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// (u&#39;_i u&#39;_i)u&#39;</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                            &lt;&lt; h_avg_uiuiv[0]</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                             - (h_avg_uu[0] + h_avg_vv[0] + ww_cc)*h_avg_v[0]</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                             - 2*(h_avg_u[0]*h_avg_uv[0] + h_avg_v[0]*h_avg_vv[0] + w_cc*vw_cc)</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                             + 2*(h_avg_u[0]*h_avg_u[0] + h_avg_v[0]*h_avg_v[0] + w_cc*w_cc)*h_avg_v[0]</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                               &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// (u&#39;_i u&#39;_i)v&#39;</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                            &lt;&lt; 0 &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// (u&#39;_i u&#39;_i)w&#39;</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                            &lt;&lt; h_avg_pu[0]   - h_avg_p[0]*h_avg_u[0]   &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// pu&#39;</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                            &lt;&lt; h_avg_pv[0]   - h_avg_p[0]*h_avg_v[0]   &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// pv&#39;</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                            &lt;&lt; 0                                              <span class="comment">// pw&#39;</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                  <span class="comment">// For internal values, interpolate scalar quantities to faces</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 1; k &lt; unstag_size; k++) {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                      Real <a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> = k * dx[2];</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                      Real uface  = 0.5*(h_avg_u[k]  + h_avg_u[k-1]);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                      Real vface  = 0.5*(h_avg_v[k]  + h_avg_v[k-1]);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                      Real thface = 0.5*(h_avg_th[k] + h_avg_th[k-1]);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                      Real pface  = 0.5*(h_avg_p[k]  + h_avg_p[k-1]);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                      Real uuface = 0.5*(h_avg_uu[k] + h_avg_uu[k-1]);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                      Real uvface = 0.5*(h_avg_uv[k] + h_avg_uv[k-1]);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                      Real vvface = 0.5*(h_avg_vv[k] + h_avg_vv[k-1]);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                      w_cc   = 0.5*(h_avg_w[k-1]  + h_avg_w[k]);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                      uw_cc  = 0.5*(h_avg_uw[k-1] + h_avg_uw[k]);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                      vw_cc  = 0.5*(h_avg_vw[k-1] + h_avg_vw[k]);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                      ww_cc  = 0.5*(h_avg_ww[k-1] + h_avg_ww[k]);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                      amrex::ignore_unused(uvface);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                      data_log2 &lt;&lt; std::setw(datwidth) &lt;&lt; std::setprecision(timeprecision) &lt;&lt; time &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                                &lt;&lt; std::setw(datwidth) &lt;&lt; std::setprecision(datprecision) &lt;&lt; <a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                                &lt;&lt; h_avg_uu[k]   - h_avg_u[k]*h_avg_u[k]   &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// u&#39;u&#39;</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                                &lt;&lt; h_avg_uv[k]   - h_avg_u[k]*h_avg_v[k]   &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// u&#39;v&#39;</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                                &lt;&lt; h_avg_uw[k]   -      uface*h_avg_w[k]   &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// u&#39;w&#39;</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                                &lt;&lt; h_avg_vv[k]   - h_avg_v[k]*h_avg_v[k]   &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// v&#39;v&#39;</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                                &lt;&lt; h_avg_vw[k]   -      vface*h_avg_w[k]   &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// v&#39;w&#39;</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                                &lt;&lt; h_avg_ww[k]   - h_avg_w[k]*h_avg_w[k]   &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// w&#39;w&#39;</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                                &lt;&lt; h_avg_uth[k]  - h_avg_u[k]*h_avg_th[k]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// u&#39;th&#39;</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                                &lt;&lt; h_avg_vth[k]  - h_avg_v[k]*h_avg_th[k]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// v&#39;th&#39;</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                                &lt;&lt; h_avg_wth[k]  - h_avg_w[k]*thface       &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// w&#39;th&#39;</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                                &lt;&lt; h_avg_thth[k] - h_avg_th[k]*h_avg_th[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// th&#39;th&#39;</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                                <span class="comment">// Note: &lt;u&#39;_i u&#39;_i u&#39;_j&gt; =   &lt;u_i u_i u_j&gt;</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                                <span class="comment">//                        -   &lt;u_i u_i&gt; * &lt;u_j&gt;</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                                <span class="comment">//                        - 2*&lt;u_i&gt; * &lt;u_i u_j&gt;</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                                <span class="comment">//                        + 2*&lt;u_i&gt;*&lt;u_i&gt; * &lt;u_j&gt;</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                                &lt;&lt; h_avg_uiuiu[k]</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                                 - (h_avg_uu[k] + h_avg_vv[k] + ww_cc)*h_avg_u[k]</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                                 - 2*(h_avg_u[k]*h_avg_uu[k] + h_avg_v[k]*h_avg_uv[k] + w_cc*uw_cc)</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                                 + 2*(h_avg_u[k]*h_avg_u[k] + h_avg_v[k]*h_avg_v[k] + w_cc*w_cc)*h_avg_u[k]</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                                   &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// cell-centered (u&#39;_i u&#39;_i)u&#39;</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                                &lt;&lt; h_avg_uiuiv[k]</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                                 - (h_avg_uu[k] + h_avg_vv[k] + ww_cc)*h_avg_v[k]</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                                 - 2*(h_avg_u[k]*h_avg_uv[k] + h_avg_v[k]*h_avg_vv[k] + w_cc*vw_cc)</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                                 + 2*(h_avg_u[k]*h_avg_u[k] + h_avg_v[k]*h_avg_v[k] + w_cc*w_cc)*h_avg_v[k]</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                                   &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// cell-centered (u&#39;_i u&#39;_i)v&#39;</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                                &lt;&lt; h_avg_uiuiw[k]</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                                 - (uuface + vvface + h_avg_ww[k])*h_avg_w[k]</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                                 - 2*(uface*h_avg_uw[k] + vface*h_avg_vw[k] + h_avg_w[k]*h_avg_ww[k])</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                                 + 2*(uface*uface + vface*vface + h_avg_w[k]*h_avg_w[k])*h_avg_w[k]</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                                   &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// face-centered (u&#39;_i u&#39;_i)w&#39;</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                                &lt;&lt; h_avg_pu[k]   - h_avg_p[k]*h_avg_u[k]   &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// pu&#39;</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                                &lt;&lt; h_avg_pv[k]   - h_avg_p[k]*h_avg_v[k]   &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// pv&#39;</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                                &lt;&lt; h_avg_pw[k]   -      pface*h_avg_w[k]          <span class="comment">// pw&#39;</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                  } <span class="comment">// loop over z</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                  <span class="comment">// Write top face values, extrapolating scalar quantities</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">int</span> k = unstag_size;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                  Real uface  = 1.5*h_avg_u[k-1]  - 0.5*h_avg_u[k-2];</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                  Real vface  = 1.5*h_avg_v[k-1]  - 0.5*h_avg_v[k-2];</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                  Real thface = 1.5*h_avg_th[k-1] - 0.5*h_avg_th[k-2];</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                  Real pface  = 1.5*h_avg_p[k-1]  - 0.5*h_avg_p[k-2];</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                  Real uuface = 1.5*h_avg_uu[k-1] - 0.5*h_avg_uu[k-2];</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                  Real uvface = 1.5*h_avg_uv[k-1] - 0.5*h_avg_uv[k-2];</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                  Real vvface = 1.5*h_avg_vv[k-1] - 0.5*h_avg_vv[k-2];</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                  amrex::ignore_unused(uvface);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                  data_log2 &lt;&lt; std::setw(datwidth) &lt;&lt; std::setprecision(timeprecision) &lt;&lt; time &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                            &lt;&lt; std::setw(datwidth) &lt;&lt; std::setprecision(datprecision) &lt;&lt; k * dx[2] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                            &lt;&lt; 0                                     &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// u&#39;u&#39;</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                            &lt;&lt; 0                                     &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// u&#39;v&#39;</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                            &lt;&lt; h_avg_uw[k]   -      uface*h_avg_w[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// u&#39;w&#39;</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                            &lt;&lt; 0                                     &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// v&#39;v&#39;</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                            &lt;&lt; h_avg_vw[k]   -      vface*h_avg_w[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// v&#39;w&#39;</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                            &lt;&lt; h_avg_ww[k]   - h_avg_w[k]*h_avg_w[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// w&#39;w&#39;</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                            &lt;&lt; 0                                     &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// u&#39;th&#39;</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                            &lt;&lt; 0                                     &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// v&#39;th&#39;</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                            &lt;&lt; h_avg_wth[k]  -     thface*h_avg_w[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// w&#39;th&#39;</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                            &lt;&lt; 0                                     &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// th&#39;th&#39;</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                            &lt;&lt; 0                                     &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// (u&#39;_i u&#39;_i)u&#39;</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                            &lt;&lt; 0                                     &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// (u&#39;_i u&#39;_i)v&#39;</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                            &lt;&lt; h_avg_uiuiw[k]</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                             - (uuface + vvface + h_avg_ww[k])*h_avg_w[k]</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                             - 2*(uface*h_avg_uw[k] + vface*h_avg_vw[k] + h_avg_w[k]*h_avg_ww[k])</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                             + 2*(uface*uface + vface*vface + h_avg_w[k]*h_avg_w[k])*h_avg_w[k]</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                               &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// (u&#39;_i u&#39;_i)w&#39;</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                            &lt;&lt; 0                                     &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// pu&#39;</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                            &lt;&lt; 0                                     &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// pv&#39;</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                            &lt;&lt; h_avg_pw[k]   -      pface*h_avg_w[k]        <span class="comment">// pw&#39;</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                } <span class="comment">// if good</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            } <span class="comment">// NumDataLogs</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160; </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ac1238c1616826c66df1dfd9076e6a3da">NumDataLogs</a>() &gt; 3) {</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                std::ostream&amp; data_log3 = <a class="code" href="classERF.html#aa2c3ee1910008b828b9da79ccdfe3871">DataLog</a>(3);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                <span class="keywordflow">if</span> (data_log3.good()) {</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                  <span class="comment">// Write the average stresses</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; unstag_size; k++) {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                      Real <a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> = k * dx[2];</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                      data_log3 &lt;&lt; std::setw(datwidth) &lt;&lt; std::setprecision(timeprecision) &lt;&lt; time &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                                &lt;&lt; std::setw(datwidth) &lt;&lt; std::setprecision(datprecision) &lt;&lt; <a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                                &lt;&lt; h_avg_tau11[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_tau12[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_tau13[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                                &lt;&lt; h_avg_tau22[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_tau23[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_tau33[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                                &lt;&lt; h_avg_sgshfx[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_sgsdiss[k]</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                  } <span class="comment">// loop over z</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                  <span class="comment">// Write top face values</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                  data_log3 &lt;&lt; std::setw(datwidth) &lt;&lt; std::setprecision(timeprecision) &lt;&lt; time &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                            &lt;&lt; std::setw(datwidth) &lt;&lt; std::setprecision(datprecision) &lt;&lt; unstag_size * dx[2] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                            &lt;&lt; 0 &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; 0 &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_tau13[unstag_size] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                            &lt;&lt; 0 &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_tau23[unstag_size] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; 0 &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                            &lt;&lt; 0 &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; 0</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                } <span class="comment">// if good</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            } <span class="comment">// NumDataLogs</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        } <span class="comment">// if IOProcessor</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    } <span class="comment">// if verbose</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_a8e3bb984f352bb1b0887d4cf88bc7139"><div class="ttname"><a href="classERF.html#a8e3bb984f352bb1b0887d4cf88bc7139">ERF::derive_diag_profiles_stag</a></div><div class="ttdeci">void derive_diag_profiles_stag(amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_u, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_v, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_w, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_rho, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_th, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_ksgs, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_uu, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_uv, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_uw, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_vv, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_vw, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_ww, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_uth, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_vth, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_wth, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_thth, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_ku, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_kv, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_kw, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_p, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_pu, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_pv, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_pw)</div><div class="ttdef"><b>Definition:</b> ERF_Write1DProfiles_stag.cpp:261</div></div>
<div class="ttc" id="aclassERF_html_aa1d539b1b91119c61ec5d3efd2897cc9"><div class="ttname"><a href="classERF.html#aa1d539b1b91119c61ec5d3efd2897cc9">ERF::derive_stress_profiles_stag</a></div><div class="ttdeci">void derive_stress_profiles_stag(amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_tau11, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_tau12, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_tau13, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_tau22, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_tau23, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_tau33, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_hfx3, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_diss)</div><div class="ttdef"><b>Definition:</b> ERF_Write1DProfiles_stag.cpp:474</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae6afed5b3a72ca80ccf0d791b08516aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6afed5b3a72ca80ccf0d791b08516aa">&#9670;&nbsp;</a></span>writeBuildInfo()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::writeBuildInfo </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>os</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;{</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  std::string PrettyLine = std::string(78, <span class="charliteral">&#39;=&#39;</span>) + <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  std::string OtherLine = std::string(78, <span class="charliteral">&#39;-&#39;</span>) + <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  std::string SkipSpace = std::string(8, <span class="charliteral">&#39; &#39;</span>);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="comment">// build information</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  os &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot; ERF Build Information\n&quot;</span>;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  os &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;build date:    &quot;</span> &lt;&lt; <a class="code" href="namespaceamrex.html#a8f794ff24efbc4b60058492d1a073c78">buildInfoGetBuildDate</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;build machine: &quot;</span> &lt;&lt; buildInfoGetBuildMachine() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;build dir:     &quot;</span> &lt;&lt; buildInfoGetBuildDir() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;AMReX dir:     &quot;</span> &lt;&lt; buildInfoGetAMReXDir() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;COMP:          &quot;</span> &lt;&lt; <a class="code" href="namespaceamrex.html#a9d270ec83f99e836cca454cac4e0af5e">buildInfoGetComp</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;COMP version:  &quot;</span> &lt;&lt; <a class="code" href="namespaceamrex.html#aab3ca155f0d0a6d198817df9c35352f8">buildInfoGetCompVersion</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;C++ compiler:  &quot;</span> &lt;&lt; buildInfoGetCXXName() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;C++ flags:     &quot;</span> &lt;&lt; buildInfoGetCXXFlags() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;Link flags:    &quot;</span> &lt;&lt; buildInfoGetLinkFlags() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;Libraries:     &quot;</span> &lt;&lt; buildInfoGetLibraries() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 1; n &lt;= buildInfoGetNumModules(); n++) {</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    os &lt;&lt; buildInfoGetModuleName(n) &lt;&lt; <span class="stringliteral">&quot;: &quot;</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;       &lt;&lt; buildInfoGetModuleVal(n) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  }</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* githash1 = <a class="code" href="namespaceamrex.html#afa2dbdd17ead719f97272c9a0a2b0f8a">buildInfoGetGitHash</a>(1);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* githash2 = <a class="code" href="namespaceamrex.html#afa2dbdd17ead719f97272c9a0a2b0f8a">buildInfoGetGitHash</a>(2);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="keywordflow">if</span> (strlen(githash1) &gt; 0) {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;ERF       git hash: &quot;</span> &lt;&lt; githash1 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  }</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="keywordflow">if</span> (strlen(githash2) &gt; 0) {</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;AMReX       git hash: &quot;</span> &lt;&lt; githash2 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  }</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* buildgithash = buildInfoGetBuildGitHash();</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* buildgitname = buildInfoGetBuildGitName();</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="keywordflow">if</span> (strlen(buildgithash) &gt; 0) {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    os &lt;&lt; buildgitname &lt;&lt; <span class="stringliteral">&quot; git hash: &quot;</span> &lt;&lt; buildgithash &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot; ERF Compile time variables: \n&quot;</span>;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot; ERF Defines: \n&quot;</span>;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  os &lt;&lt; std::setw(35) &lt;&lt; std::left &lt;&lt; <span class="stringliteral">&quot;_OPENMP &quot;</span> &lt;&lt; std::setw(6) &lt;&lt; <span class="stringliteral">&quot;ON&quot;</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;     &lt;&lt; std::endl;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  os &lt;&lt; std::setw(35) &lt;&lt; std::left &lt;&lt; <span class="stringliteral">&quot;_OPENMP &quot;</span> &lt;&lt; std::setw(6) &lt;&lt; <span class="stringliteral">&quot;OFF&quot;</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;     &lt;&lt; std::endl;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="preprocessor">#ifdef MPI_VERSION</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  os &lt;&lt; std::setw(35) &lt;&lt; std::left &lt;&lt; <span class="stringliteral">&quot;MPI_VERSION &quot;</span> &lt;&lt; std::setw(6)</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;     &lt;&lt; MPI_VERSION &lt;&lt; std::endl;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  os &lt;&lt; std::setw(35) &lt;&lt; std::left &lt;&lt; <span class="stringliteral">&quot;MPI_VERSION &quot;</span> &lt;&lt; std::setw(6)</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;     &lt;&lt; <span class="stringliteral">&quot;UNDEFINED&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160; </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="preprocessor">#ifdef MPI_SUBVERSION</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  os &lt;&lt; std::setw(35) &lt;&lt; std::left &lt;&lt; <span class="stringliteral">&quot;MPI_SUBVERSION &quot;</span> &lt;&lt; std::setw(6)</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;     &lt;&lt; MPI_SUBVERSION &lt;&lt; std::endl;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  os &lt;&lt; std::setw(35) &lt;&lt; std::left &lt;&lt; <span class="stringliteral">&quot;MPI_SUBVERSION &quot;</span> &lt;&lt; std::setw(6)</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;     &lt;&lt; <span class="stringliteral">&quot;UNDEFINED&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_ae6afed5b3a72ca80ccf0d791b08516aa_cgraph.png" border="0" usemap="#aclassERF_ae6afed5b3a72ca80ccf0d791b08516aa_cgraph" alt=""/></div>
<map name="aclassERF_ae6afed5b3a72ca80ccf0d791b08516aa_cgraph" id="aclassERF_ae6afed5b3a72ca80ccf0d791b08516aa_cgraph">
<area shape="rect" title=" " alt="" coords="5,81,151,108"/>
<area shape="rect" href="namespaceamrex.html#a8f794ff24efbc4b60058492d1a073c78" title=" " alt="" coords="210,5,426,32"/>
<area shape="rect" href="namespaceamrex.html#a9d270ec83f99e836cca454cac4e0af5e" title=" " alt="" coords="223,56,413,83"/>
<area shape="rect" href="namespaceamrex.html#aab3ca155f0d0a6d198817df9c35352f8" title=" " alt="" coords="199,107,437,133"/>
<area shape="rect" href="namespaceamrex.html#afa2dbdd17ead719f97272c9a0a2b0f8a" title=" " alt="" coords="216,157,420,184"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_ae6afed5b3a72ca80ccf0d791b08516aa_icgraph.png" border="0" usemap="#aclassERF_ae6afed5b3a72ca80ccf0d791b08516aa_icgraph" alt=""/></div>
<map name="aclassERF_ae6afed5b3a72ca80ccf0d791b08516aa_icgraph" id="aclassERF_ae6afed5b3a72ca80ccf0d791b08516aa_icgraph">
<area shape="rect" title=" " alt="" coords="108,5,253,32"/>
<area shape="rect" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,60,32"/>
</map>
</div>

</div>
</div>
<a id="ad101fd46096db2d6b21544bfede6551f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad101fd46096db2d6b21544bfede6551f">&#9670;&nbsp;</a></span>WriteCheckpointFile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::WriteCheckpointFile </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p><a class="el" href="classERF.html">ERF</a> function for writing a checkpoint file. </p>
<div class="fragment"><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;{</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="comment">// chk00010            write a checkpoint file with this root directory</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="comment">// chk00010/Header     this contains information you need to save (e.g., finest_level, t_new, etc.) and also</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="comment">//                     the BoxArrays at each level</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="comment">// chk00010/Level_0/</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="comment">// chk00010/Level_1/</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="comment">// etc.                these subdirectories will hold the MultiFab data at each level of refinement</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="comment">// checkpoint file name, e.g., chk00010</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keyword">const</span> std::string&amp; checkpointname = Concatenate(<a class="code" href="classERF.html#ae701564fbe3da5bbd88587e5a08eca4e">check_file</a>,<a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[0],5);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    Print() &lt;&lt; <span class="stringliteral">&quot;Writing native checkpoint &quot;</span> &lt;&lt; checkpointname &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> nlevels = finest_level+1;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="comment">// ---- prebuild a hierarchy of directories</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="comment">// ---- dirName is built first.  if dirName exists, it is renamed.  then build</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="comment">// ---- dirName/subDirPrefix_0 .. dirName/subDirPrefix_nlevels-1</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="comment">// ---- if callBarrier is true, call ParallelDescriptor::Barrier()</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="comment">// ---- after all directories are built</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="comment">// ---- ParallelDescriptor::IOProcessor() creates the directories</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    PreBuildDirectorHierarchy(checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, nlevels, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordtype">int</span> ncomp_cons = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[0][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nComp();</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="comment">// write Header file</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="keywordflow">if</span> (ParallelDescriptor::IOProcessor()) {</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;       std::string HeaderFileName(checkpointname + <span class="stringliteral">&quot;/Header&quot;</span>);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;       VisMF::IO_Buffer io_buffer(VisMF::IO_Buffer_Size);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;       std::ofstream HeaderFile;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;       HeaderFile.rdbuf()-&gt;pubsetbuf(io_buffer.dataPtr(), io_buffer.size());</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;       HeaderFile.open(HeaderFileName.c_str(), std::ofstream::out   |</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                                               std::ofstream::trunc |</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                                               std::ofstream::binary);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;       <span class="keywordflow">if</span>( ! HeaderFile.good()) {</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;           FileOpenFailed(HeaderFileName);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;       }</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;       HeaderFile.precision(17);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;       <span class="comment">// write out title line</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;       HeaderFile &lt;&lt; <span class="stringliteral">&quot;Checkpoint file for ERF\n&quot;</span>;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;       <span class="comment">// write out finest_level</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;       HeaderFile &lt;&lt; finest_level &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;       <span class="comment">// write the number of components</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;       <span class="comment">// for each variable we store</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;       <span class="comment">// conservative, cell-centered vars</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;       HeaderFile &lt;&lt; ncomp_cons &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;       <span class="comment">// x-velocity on faces</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;       HeaderFile &lt;&lt; 1 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;       <span class="comment">// y-velocity on faces</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;       HeaderFile &lt;&lt; 1 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;       <span class="comment">// z-velocity on faces</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;       HeaderFile &lt;&lt; 1 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;       <span class="comment">// write out array of istep</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>.size(); ++i) {</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;           HeaderFile &lt;&lt; <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;       }</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;       HeaderFile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;       <span class="comment">// write out array of dt</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>.size(); ++i) {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;           HeaderFile &lt;&lt; <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;       }</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;       HeaderFile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;       <span class="comment">// write out array of t_new</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>.size(); ++i) {</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;           HeaderFile &lt;&lt; <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;       }</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;       HeaderFile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;       <span class="comment">// write the BoxArray at each level</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;           boxArray(lev).writeOn(HeaderFile);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;           HeaderFile &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;       }</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;   }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="comment">// write the MultiFab data to, e.g., chk00010/Level_0/</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="comment">// Here we make copies of the MultiFab with no ghost cells</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev)</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        MultiFab <a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">cons</a>(grids[lev],dmap[lev],ncomp_cons,0);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        MultiFab::Copy(<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">cons</a>,<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],0,0,ncomp_cons,0);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        VisMF::Write(<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">cons</a>, MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;Cell&quot;</span>));</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        MultiFab <a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">xvel</a>(convert(grids[lev],IntVect(1,0,0)),dmap[lev],1,0);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        MultiFab::Copy(<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">xvel</a>,<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],0,0,1,0);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        VisMF::Write(<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">xvel</a>, MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;XFace&quot;</span>));</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        MultiFab <a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">yvel</a>(convert(grids[lev],IntVect(0,1,0)),dmap[lev],1,0);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        MultiFab::Copy(<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">yvel</a>,<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],0,0,1,0);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        VisMF::Write(<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">yvel</a>, MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;YFace&quot;</span>));</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        MultiFab <a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">zvel</a>(convert(grids[lev],IntVect(0,0,1)),dmap[lev],1,0);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        MultiFab::Copy(<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">zvel</a>,<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>],0,0,1,0);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        VisMF::Write(<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">zvel</a>, MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;ZFace&quot;</span>));</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <span class="comment">// Note that we write the ghost cells of the base state (unlike above)</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        IntVect ng = <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].nGrowVect();</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        MultiFab base(grids[lev],dmap[lev],<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].nComp(),ng);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        MultiFab::Copy(base,<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev],0,0,base.nComp(),ng);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        VisMF::Write(base, MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;BaseState&quot;</span>));</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a063a88594452100497651e8aaf1f68d7">use_terrain</a>)  {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            <span class="comment">// Note that we also write the ghost cells of z_phys_nd</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            ng = <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev]-&gt;nGrowVect();</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            MultiFab z_height(convert(grids[lev],IntVect(1,1,1)),dmap[lev],1,ng);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            MultiFab::Copy(z_height,*<a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev],0,0,1,ng);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            VisMF::Write(z_height, MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;Z_Phys_nd&quot;</span>));</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a43c1741535574c7e6f4fe6bf90552f31">lsm_type</a> != <a class="code" href="DataStruct_8H.html#abeec366fd5381f3bb7ba39f6e5c1e7e4a6adf97f83acf6453d4a6a4b1070f3754">LandSurfaceType::None</a>) {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> mvar(0); mvar&lt;<a class="code" href="classERF.html#ad03da3399e893728741fac33100ce476">lsm_data</a>[lev].size(); ++mvar) {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                BoxArray ba = <a class="code" href="classERF.html#ad03da3399e893728741fac33100ce476">lsm_data</a>[lev][mvar]-&gt;boxArray();</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                DistributionMapping dm = <a class="code" href="classERF.html#ad03da3399e893728741fac33100ce476">lsm_data</a>[lev][mvar]-&gt;DistributionMap();</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                ng = <a class="code" href="classERF.html#ad03da3399e893728741fac33100ce476">lsm_data</a>[lev][mvar]-&gt;nGrowVect();</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                <span class="keywordtype">int</span> nvar = <a class="code" href="classERF.html#ad03da3399e893728741fac33100ce476">lsm_data</a>[lev][mvar]-&gt;nComp();</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                MultiFab lsm_vars(ba,dm,nvar,ng);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                MultiFab::Copy(lsm_vars,*(<a class="code" href="classERF.html#ad03da3399e893728741fac33100ce476">lsm_data</a>[lev][mvar]),0,0,nvar,ng);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                VisMF::Write(lsm_vars, MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;LsmVars&quot;</span>));</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            }</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        }</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="comment">// Note that we also write the ghost cells of the mapfactors (2D)</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        BoxList bl2d = grids[lev].boxList();</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; b : bl2d) {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            b.setRange(2,0);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        }</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        BoxArray ba2d(std::move(bl2d));</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        ng = <a class="code" href="classERF.html#a23aacdb72e9d2dfed8e2ebd2c2526497">mapfac_m</a>[lev]-&gt;nGrowVect();</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        MultiFab mf_m(ba2d,dmap[lev],1,ng);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        MultiFab::Copy(mf_m,*<a class="code" href="classERF.html#a23aacdb72e9d2dfed8e2ebd2c2526497">mapfac_m</a>[lev],0,0,1,ng);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        VisMF::Write(mf_m, MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;MapFactor_m&quot;</span>));</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        ng = <a class="code" href="classERF.html#a1e8afee1508b720dab56f5d044deb301">mapfac_u</a>[lev]-&gt;nGrowVect();</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        MultiFab mf_u(convert(ba2d,IntVect(1,0,0)),dmap[lev],1,ng);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        MultiFab::Copy(mf_u,*<a class="code" href="classERF.html#a1e8afee1508b720dab56f5d044deb301">mapfac_u</a>[lev],0,0,1,ng);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        VisMF::Write(mf_u, MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;MapFactor_u&quot;</span>));</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        ng = <a class="code" href="classERF.html#ae49b5055f9a7117fa15918a5daa775b7">mapfac_v</a>[lev]-&gt;nGrowVect();</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        MultiFab mf_v(convert(ba2d,IntVect(0,1,0)),dmap[lev],1,ng);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        MultiFab::Copy(mf_v,*<a class="code" href="classERF.html#ae49b5055f9a7117fa15918a5daa775b7">mapfac_v</a>[lev],0,0,1,ng);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        VisMF::Write(mf_v, MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;MapFactor_v&quot;</span>));</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    }</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="preprocessor">#ifdef ERF_USE_PARTICLES</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;   particleData.Checkpoint(checkpointname);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="preprocessor">#ifdef ERF_USE_NETCDF</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;   <span class="comment">// Write bdy_data files</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;   <span class="keywordflow">if</span> (ParallelDescriptor::IOProcessor() &amp;&amp; ((<a class="code" href="classERF.html#af5ac3d88a33a1a284bcc120ce0599cf7">init_type</a>==<span class="stringliteral">&quot;real&quot;</span>) || (<a class="code" href="classERF.html#af5ac3d88a33a1a284bcc120ce0599cf7">init_type</a>==<span class="stringliteral">&quot;metgrid&quot;</span>))) {</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;     <span class="comment">// Vector dimensions</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;     <span class="keywordtype">int</span> num_time = bdy_data_xlo.size();</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;     <span class="keywordtype">int</span> num_var  = bdy_data_xlo[0].size();</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;     <span class="comment">// Open header file and write to it</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;     std::ofstream bdy_h_file(MultiFabFileFullPrefix(0, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;bdy_H&quot;</span>));</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;     bdy_h_file &lt;&lt; std::setprecision(1) &lt;&lt; std::fixed;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;     bdy_h_file &lt;&lt; num_time &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;     bdy_h_file &lt;&lt; num_var  &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;     bdy_h_file &lt;&lt; start_bdy_time &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;     bdy_h_file &lt;&lt; bdy_time_interval &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;     bdy_h_file &lt;&lt; <a class="code" href="classERF.html#abb15119348ad5399947bc8883084b230">real_width</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ivar(0); ivar&lt;num_var; ++ivar) {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;       bdy_h_file &lt;&lt; bdy_data_xlo[0][ivar].box() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;       bdy_h_file &lt;&lt; bdy_data_xhi[0][ivar].box() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;       bdy_h_file &lt;&lt; bdy_data_ylo[0][ivar].box() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;       bdy_h_file &lt;&lt; bdy_data_yhi[0][ivar].box() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;     }</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;     <span class="comment">// Open data file and write to it</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;     std::ofstream bdy_d_file(MultiFabFileFullPrefix(0, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;bdy_D&quot;</span>));</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> itime(0); itime&lt;num_time; ++itime) {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ivar(0); ivar&lt;num_var; ++ivar) {</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;         bdy_data_xlo[itime][ivar].writeOn(bdy_d_file,0,1);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;         bdy_data_xhi[itime][ivar].writeOn(bdy_d_file,0,1);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;         bdy_data_ylo[itime][ivar].writeOn(bdy_d_file,0,1);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;         bdy_data_yhi[itime][ivar].writeOn(bdy_d_file,0,1);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;       }</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;     }</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;   }</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a16e49fd65c68e2afc2140bd9e97bcbe9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16e49fd65c68e2afc2140bd9e97bcbe9">&#9670;&nbsp;</a></span>WriteGenericPlotfileHeaderWithTerrain()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::WriteGenericPlotfileHeaderWithTerrain </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>HeaderFile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlevels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Vector&lt; amrex::BoxArray &gt; &amp;&#160;</td>
          <td class="paramname"><em>bArray</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>varnames</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Vector&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>level_steps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>versionName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>levelPrefix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>mfPrefix</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;{</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;        BL_ASSERT(nlevels &lt;= bArray.size());</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;        BL_ASSERT(nlevels &lt;= ref_ratio.size()+1);</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;        BL_ASSERT(nlevels &lt;= level_steps.size());</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160; </div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;        HeaderFile.precision(17);</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160; </div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;        <span class="comment">// ---- this is the generic plot file type name</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;        HeaderFile &lt;&lt; versionName &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160; </div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;        HeaderFile &lt;&lt; varnames.size() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160; </div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ivar = 0; ivar &lt; varnames.size(); ++ivar) {</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;            HeaderFile &lt;&lt; varnames[ivar] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;        }</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;        HeaderFile &lt;&lt; AMREX_SPACEDIM &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;        HeaderFile &lt;&lt; time &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;        HeaderFile &lt;&lt; finest_level &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; ++i) {</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;            HeaderFile &lt;&lt; geom[0].ProbLo(i) &lt;&lt; <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;        }</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;        HeaderFile &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; ++i) {</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;            HeaderFile &lt;&lt; geom[0].ProbHi(i) &lt;&lt; <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;        }</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;        HeaderFile &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; finest_level; ++i) {</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;            HeaderFile &lt;&lt; ref_ratio[i][0] &lt;&lt; <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;        }</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;        HeaderFile &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= finest_level; ++i) {</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;            HeaderFile &lt;&lt; geom[i].Domain() &lt;&lt; <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;        }</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;        HeaderFile &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= finest_level; ++i) {</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;            HeaderFile &lt;&lt; level_steps[i] &lt;&lt; <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;        }</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;        HeaderFile &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= finest_level; ++i) {</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; AMREX_SPACEDIM; ++k) {</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;                HeaderFile &lt;&lt; geom[i].CellSize()[k] &lt;&lt; <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;            }</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;            HeaderFile &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;        }</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;        HeaderFile &lt;&lt; (int) geom[0].<a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01">Coord</a>() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;        HeaderFile &lt;&lt; <span class="stringliteral">&quot;0\n&quot;</span>;</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160; </div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> level = 0; level &lt;= finest_level; ++level) {</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;            HeaderFile &lt;&lt; level &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; bArray[level].size() &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; time &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;            HeaderFile &lt;&lt; level_steps[level] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160; </div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;            <span class="keyword">const</span> IntVect&amp; domain_lo = geom[level].Domain().smallEnd();</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; bArray[level].size(); ++i)</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;            {</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;                <span class="comment">// Need to shift because the RealBox ctor we call takes the</span></div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;                <span class="comment">// physical location of index (0,0,0).  This does not affect</span></div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;                <span class="comment">// the usual cases where the domain index starts with 0.</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;                <span class="keyword">const</span> Box&amp; b = shift(bArray[level][i], -domain_lo);</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;                RealBox loc = RealBox(b, geom[level].CellSize(), geom[level].ProbLo());</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; AMREX_SPACEDIM; ++n) {</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;                    HeaderFile &lt;&lt; loc.lo(n) &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; loc.hi(n) &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;                }</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;            }</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160; </div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;            HeaderFile &lt;&lt; MultiFabHeaderPath(level, levelPrefix, mfPrefix) &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;        }</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;        HeaderFile &lt;&lt; <span class="stringliteral">&quot;1&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;        HeaderFile &lt;&lt; <span class="stringliteral">&quot;3&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;        HeaderFile &lt;&lt; <span class="stringliteral">&quot;amrexvec_nu_x&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;        HeaderFile &lt;&lt; <span class="stringliteral">&quot;amrexvec_nu_y&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;        HeaderFile &lt;&lt; <span class="stringliteral">&quot;amrexvec_nu_z&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;        std::string mf_nodal_prefix = <span class="stringliteral">&quot;Nu_nd&quot;</span>;</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> level = 0; level &lt;= finest_level; ++level) {</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;            HeaderFile &lt;&lt; MultiFabHeaderPath(level, levelPrefix, mf_nodal_prefix) &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;        }</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;}</div>
<div class="ttc" id="aDataStruct_8H_html_a627f1f843904477f763577ad1460de01"><div class="ttname"><a href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01">Coord</a></div><div class="ttdeci">Coord</div><div class="ttdef"><b>Definition:</b> DataStruct.H:47</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa2d8099655a8779836e63e3e98ea4372"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2d8099655a8779836e63e3e98ea4372">&#9670;&nbsp;</a></span>writeJobInfo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::writeJobInfo </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>dir</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;{</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;  <span class="comment">// job_info file with details about the run</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;  std::ofstream jobInfoFile;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;  std::string FullPathJobInfoFile = dir;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;  FullPathJobInfoFile += <span class="stringliteral">&quot;/job_info&quot;</span>;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;  jobInfoFile.open(FullPathJobInfoFile.c_str(), std::ios::out);</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  std::string PrettyLine = <span class="stringliteral">&quot;===================================================&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;                           <span class="stringliteral">&quot;============================\n&quot;</span>;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  std::string OtherLine = <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;                          <span class="stringliteral">&quot;----------------------------\n&quot;</span>;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  std::string SkipSpace = <span class="stringliteral">&quot;        &quot;</span>;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <span class="comment">// job information</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot; ERF Job Information\n&quot;</span>;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;inputs file: &quot;</span> &lt;&lt; <a class="code" href="writeJobInfo_8cpp.html#aabaa127a3a319c1b86090d6c88568965">inputs_name</a> &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;number of MPI processes: &quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;              &lt;&lt; ParallelDescriptor::NProcs() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;number of threads:       &quot;</span> &lt;&lt; omp_get_max_threads() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;CPU time used since start of simulation (CPU-hours): &quot;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;              &lt;&lt; <a class="code" href="classERF.html#ae0597da6edf955cd138e52fd00380ff2">getCPUTime</a>() / 3600.0;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <span class="comment">// plotfile information</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot; Plotfile Information\n&quot;</span>;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  time_t now = time(<span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="comment">// Convert now to tm struct for local timezone</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  tm* localtm = localtime(&amp;now);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;output data / time: &quot;</span> &lt;&lt; asctime(localtm);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  std::string currentDir = FileSystem::CurrentPath();</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;output dir:         &quot;</span> &lt;&lt; currentDir &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="comment">// build information</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot; Build Information\n&quot;</span>;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;build date:    &quot;</span> &lt;&lt; <a class="code" href="namespaceamrex.html#a8f794ff24efbc4b60058492d1a073c78">buildInfoGetBuildDate</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;build machine: &quot;</span> &lt;&lt; buildInfoGetBuildMachine() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;build dir:     &quot;</span> &lt;&lt; buildInfoGetBuildDir() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;AMReX dir:     &quot;</span> &lt;&lt; buildInfoGetAMReXDir() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;COMP:          &quot;</span> &lt;&lt; <a class="code" href="namespaceamrex.html#a9d270ec83f99e836cca454cac4e0af5e">buildInfoGetComp</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;COMP version:  &quot;</span> &lt;&lt; <a class="code" href="namespaceamrex.html#aab3ca155f0d0a6d198817df9c35352f8">buildInfoGetCompVersion</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 1; n &lt;= buildInfoGetNumModules(); n++) {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    jobInfoFile &lt;&lt; buildInfoGetModuleName(n) &lt;&lt; <span class="stringliteral">&quot;: &quot;</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                &lt;&lt; buildInfoGetModuleVal(n) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* githash1 = <a class="code" href="namespaceamrex.html#afa2dbdd17ead719f97272c9a0a2b0f8a">buildInfoGetGitHash</a>(1);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* githash2 = <a class="code" href="namespaceamrex.html#afa2dbdd17ead719f97272c9a0a2b0f8a">buildInfoGetGitHash</a>(2);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="keywordflow">if</span> (strlen(githash1) &gt; 0) {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;ERF       git hash: &quot;</span> &lt;&lt; githash1 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  }</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="keywordflow">if</span> (strlen(githash2) &gt; 0) {</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;AMReX       git hash: &quot;</span> &lt;&lt; githash2 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  }</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* buildgithash = buildInfoGetBuildGitHash();</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* buildgitname = buildInfoGetBuildGitName();</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="keywordflow">if</span> (strlen(buildgithash) &gt; 0) {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    jobInfoFile &lt;&lt; buildgitname &lt;&lt; <span class="stringliteral">&quot; git hash: &quot;</span> &lt;&lt; buildgithash &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  }</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="comment">// grid information</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot; Grid Information\n&quot;</span>;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keywordtype">int</span> f_lev = finest_level;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= f_lev; i++) {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot; level: &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;   number of boxes = &quot;</span> &lt;&lt; grids[i].size() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;   maximum zones   = &quot;</span>;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; AMREX_SPACEDIM; n++) {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      jobInfoFile &lt;&lt; geom[i].Domain().length(n) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    }</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  }</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot; Boundary conditions\n&quot;</span>;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;   -x: &quot;</span> &lt;&lt; <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[0] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;   +x: &quot;</span> &lt;&lt; <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[3] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;   -y: &quot;</span> &lt;&lt; <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[1] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;   +y: &quot;</span> &lt;&lt; <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[4] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;   -z: &quot;</span> &lt;&lt; <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[2] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;   +z: &quot;</span> &lt;&lt; <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[5] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="comment">// runtime parameters</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot; Inputs File Parameters\n&quot;</span>;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  ParmParse::dumpTable(jobInfoFile, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  jobInfoFile.close();</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_ae0597da6edf955cd138e52fd00380ff2"><div class="ttname"><a href="classERF.html#ae0597da6edf955cd138e52fd00380ff2">ERF::getCPUTime</a></div><div class="ttdeci">static amrex::Real getCPUTime()</div><div class="ttdef"><b>Definition:</b> ERF.H:971</div></div>
<div class="ttc" id="awriteJobInfo_8cpp_html_aabaa127a3a319c1b86090d6c88568965"><div class="ttname"><a href="writeJobInfo_8cpp.html#aabaa127a3a319c1b86090d6c88568965">inputs_name</a></div><div class="ttdeci">std::string inputs_name</div><div class="ttdef"><b>Definition:</b> main.cpp:14</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_aa2d8099655a8779836e63e3e98ea4372_cgraph.png" border="0" usemap="#aclassERF_aa2d8099655a8779836e63e3e98ea4372_cgraph" alt=""/></div>
<map name="aclassERF_aa2d8099655a8779836e63e3e98ea4372_cgraph" id="aclassERF_aa2d8099655a8779836e63e3e98ea4372_cgraph">
<area shape="rect" title=" " alt="" coords="5,81,137,108"/>
<area shape="rect" href="namespaceamrex.html#a8f794ff24efbc4b60058492d1a073c78" title=" " alt="" coords="197,5,413,32"/>
<area shape="rect" href="namespaceamrex.html#a9d270ec83f99e836cca454cac4e0af5e" title=" " alt="" coords="209,56,400,83"/>
<area shape="rect" href="namespaceamrex.html#aab3ca155f0d0a6d198817df9c35352f8" title=" " alt="" coords="185,107,424,133"/>
<area shape="rect" href="namespaceamrex.html#afa2dbdd17ead719f97272c9a0a2b0f8a" title=" " alt="" coords="203,157,407,184"/>
</map>
</div>

</div>
</div>
<a id="a898410553492b2add00a72374dcec6ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a898410553492b2add00a72374dcec6ba">&#9670;&nbsp;</a></span>WriteMultiLevelPlotfileWithTerrain()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::WriteMultiLevelPlotfileWithTerrain </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>plotfilename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlevels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Vector&lt; const amrex::MultiFab * &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Vector&lt; const amrex::MultiFab * &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_nd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>varnames</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Vector&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>level_steps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>versionName</em> = <code>&quot;HyperCLaw-V1.1&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>levelPrefix</em> = <code>&quot;Level_&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>mfPrefix</em> = <code>&quot;Cell&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>extra_dirs</em> = <code>amrex::Vector&lt;std::string&gt;()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;{</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;    BL_PROFILE(<span class="stringliteral">&quot;WriteMultiLevelPlotfileWithTerrain()&quot;</span>);</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160; </div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    BL_ASSERT(nlevels &lt;= mf.size());</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    BL_ASSERT(nlevels &lt;= ref_ratio.size()+1);</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    BL_ASSERT(nlevels &lt;= level_steps.size());</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    BL_ASSERT(mf[0]-&gt;nComp() == varnames.size());</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160; </div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    <span class="keywordtype">bool</span> callBarrier(<span class="keyword">false</span>);</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    PreBuildDirectorHierarchy(plotfilename, levelPrefix, nlevels, callBarrier);</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    <span class="keywordflow">if</span> (!extra_dirs.empty()) {</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; d : extra_dirs) {</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;            <span class="keyword">const</span> std::string ed = plotfilename+<span class="stringliteral">&quot;/&quot;</span>+d;</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;            PreBuildDirectorHierarchy(ed, levelPrefix, nlevels, callBarrier);</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;        }</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    }</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    ParallelDescriptor::Barrier();</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160; </div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;    <span class="keywordflow">if</span> (ParallelDescriptor::MyProc() == ParallelDescriptor::NProcs()-1) {</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;        Vector&lt;BoxArray&gt; boxArrays(nlevels);</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> level(0); level &lt; boxArrays.size(); ++level) {</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;            boxArrays[level] = mf[level]-&gt;boxArray();</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;        }</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160; </div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;        <span class="keyword">auto</span> f = [=]() {</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;            VisMF::IO_Buffer io_buffer(VisMF::IO_Buffer_Size);</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;            std::string HeaderFileName(plotfilename + <span class="stringliteral">&quot;/Header&quot;</span>);</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;            std::ofstream HeaderFile;</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;            HeaderFile.rdbuf()-&gt;pubsetbuf(io_buffer.dataPtr(), io_buffer.size());</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;            HeaderFile.open(HeaderFileName.c_str(), std::ofstream::out   |</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;                                                    std::ofstream::trunc |</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;                                                    std::ofstream::binary);</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;            <span class="keywordflow">if</span>( ! HeaderFile.good()) FileOpenFailed(HeaderFileName);</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;            <a class="code" href="classERF.html#a16e49fd65c68e2afc2140bd9e97bcbe9">WriteGenericPlotfileHeaderWithTerrain</a>(HeaderFile, nlevels, boxArrays, varnames,</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;                                                  time, level_steps, versionName,</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;                                                  levelPrefix, mfPrefix);</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;        };</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160; </div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;        <span class="keywordflow">if</span> (AsyncOut::UseAsyncOut()) {</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;            AsyncOut::Submit(std::move(f));</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;            f();</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;        }</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    }</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160; </div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    std::string mf_nodal_prefix = <span class="stringliteral">&quot;Nu_nd&quot;</span>;</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> level = 0; level &lt;= finest_level; ++level)</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    {</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;        <span class="keywordflow">if</span> (AsyncOut::UseAsyncOut()) {</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;            VisMF::AsyncWrite(*mf[level],</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;                              MultiFabFileFullPrefix(level, plotfilename, levelPrefix, mfPrefix),</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;                              <span class="keyword">true</span>);</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;            VisMF::AsyncWrite(*mf_nd[level],</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;                              MultiFabFileFullPrefix(level, plotfilename, levelPrefix, mf_nodal_prefix),</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;                              <span class="keyword">true</span>);</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;            <span class="keyword">const</span> MultiFab* data;</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;            std::unique_ptr&lt;MultiFab&gt; mf_tmp;</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;            <span class="keywordflow">if</span> (mf[level]-&gt;nGrowVect() != 0) {</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;                mf_tmp = std::make_unique&lt;MultiFab&gt;(mf[level]-&gt;boxArray(),</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;                                                    mf[level]-&gt;DistributionMap(),</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;                                                    mf[level]-&gt;nComp(), 0, MFInfo(),</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;                                                    mf[level]-&gt;Factory());</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;                MultiFab::Copy(*mf_tmp, *mf[level], 0, 0, mf[level]-&gt;nComp(), 0);</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;                data = mf_tmp.get();</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;                data = mf[level];</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;            }</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;            VisMF::Write(*data        , MultiFabFileFullPrefix(level, plotfilename, levelPrefix, mfPrefix));</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;            VisMF::Write(*mf_nd[level], MultiFabFileFullPrefix(level, plotfilename, levelPrefix, mf_nodal_prefix));</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;        }</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    }</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_a16e49fd65c68e2afc2140bd9e97bcbe9"><div class="ttname"><a href="classERF.html#a16e49fd65c68e2afc2140bd9e97bcbe9">ERF::WriteGenericPlotfileHeaderWithTerrain</a></div><div class="ttdeci">void WriteGenericPlotfileHeaderWithTerrain(std::ostream &amp;HeaderFile, int nlevels, const amrex::Vector&lt; amrex::BoxArray &gt; &amp;bArray, const amrex::Vector&lt; std::string &gt; &amp;varnames, amrex::Real time, const amrex::Vector&lt; int &gt; &amp;level_steps, const std::string &amp;versionName, const std::string &amp;levelPrefix, const std::string &amp;mfPrefix) const</div><div class="ttdef"><b>Definition:</b> Plotfile.cpp:1204</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af2e4de4eaa0f93149c1aefd58dc7068a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2e4de4eaa0f93149c1aefd58dc7068a">&#9670;&nbsp;</a></span>writeNow()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ERF::writeNow </td>
          <td>(</td>
          <td class="paramtype">const amrex::Real&#160;</td>
          <td class="paramname"><em>cur_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nstep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>plot_int</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real&#160;</td>
          <td class="paramname"><em>plot_per</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;{</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;    <span class="keywordtype">bool</span> write_now = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160; </div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;    <span class="keywordflow">if</span> ( plot_int &gt; 0 &amp;&amp; (nstep % plot_int == 0) ) {</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;        write_now = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160; </div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (plot_per &gt; 0.0) {</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160; </div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;        <span class="comment">// Check to see if we&#39;ve crossed a plot_per interval by comparing</span></div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;        <span class="comment">// the number of intervals that have elapsed for both the current</span></div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;        <span class="comment">// time and the time at the beginning of this timestep.</span></div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160; </div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;        <span class="keyword">const</span> Real eps = std::numeric_limits&lt;Real&gt;::epsilon() * Real(10.0) * std::abs(cur_time);</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160; </div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;        <span class="keywordtype">int</span> num_per_old = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(std::round((cur_time-eps-dt_lev) / plot_per));</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;        <span class="keywordtype">int</span> num_per_new = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(std::round((cur_time-eps       ) / plot_per));</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160; </div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;        <span class="comment">// Before using these, however, we must test for the case where we&#39;re</span></div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;        <span class="comment">// within machine epsilon of the next interval. In that case, increment</span></div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;        <span class="comment">// the counter, because we have indeed reached the next plot_per interval</span></div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;        <span class="comment">// at this point.</span></div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160; </div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;        <span class="keyword">const</span> Real next_plot_time = (num_per_old + 1) * plot_per;</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160; </div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;        <span class="keywordflow">if</span> ((num_per_new == num_per_old) &amp;&amp; std::abs(cur_time - next_plot_time) &lt;= eps)</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;        {</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;            num_per_new += 1;</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;        }</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160; </div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;        <span class="comment">// Similarly, we have to account for the case where the old time is within</span></div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;        <span class="comment">// machine epsilon of the beginning of this interval, so that we don&#39;t double</span></div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;        <span class="comment">// count that time threshold -- we already plotted at that time on the last timestep.</span></div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160; </div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;        <span class="keywordflow">if</span> ((num_per_new != num_per_old) &amp;&amp; std::abs((cur_time - dt_lev) - next_plot_time) &lt;= eps)</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;            num_per_old += 1;</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160; </div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;        <span class="keywordflow">if</span> (num_per_old != num_per_new)</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;            write_now = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;    }</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;    <span class="keywordflow">return</span> write_now;</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0b0b4140e117163895e5e2c89a68d12a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b0b4140e117163895e5e2c89a68d12a">&#9670;&nbsp;</a></span>WritePlotFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::WritePlotFile </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>which</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Vector&lt; std::string &gt;&#160;</td>
          <td class="paramname"><em>plot_var_names</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;{</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keyword">const</span> Vector&lt;std::string&gt; varnames = <a class="code" href="classERF.html#a2dcd22cb915d923c687f60267f44542b">PlotFileVarNames</a>(plot_var_names);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> ncomp_mf = varnames.size();</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordtype">int</span> ncomp_cons = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[0][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nComp();</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160; </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordflow">if</span> (ncomp_mf == 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="comment">// We Fillpatch here because some of the derived quantities require derivatives</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="comment">//     which require ghost cells to be filled.  We do not need to call FillPatcher</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="comment">//     because we don&#39;t need to set interior fine points.</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <span class="keywordtype">bool</span> fillset = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <a class="code" href="classERF.html#a8de69f537859f576fba1d94844cfbd33">FillPatch</a>(lev, <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev], {&amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], &amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                                    &amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>], &amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>]},</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                                   {&amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], &amp;<a class="code" href="classERF.html#a01f3db32272f53dc68025f0a98195e57">rU_new</a>[lev],</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                                    &amp;<a class="code" href="classERF.html#a54e37988486ef96e55e84bd8e91bb688">rV_new</a>[lev], &amp;<a class="code" href="classERF.html#aa46c0b0d20525aed10f447923e54dde7">rW_new</a>[lev]}, fillset);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    }</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="comment">// Get qmoist pointers if using moisture</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keywordtype">bool</span> use_moisture = (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> != <a class="code" href="DataStruct_8H.html#ab34704153a585940411c26587cb82ad0a6adf97f83acf6453d4a6a4b1070f3754">MoistureType::None</a>);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> mvar(0); mvar&lt;<a class="code" href="classERF.html#ae00126a9c2738bf6a6cbbe77321c9cfc">qmoist</a>[lev].size(); ++mvar) {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            <a class="code" href="classERF.html#ae00126a9c2738bf6a6cbbe77321c9cfc">qmoist</a>[lev][mvar] = <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;Get_Qmoist_Ptr(lev,mvar);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        }</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    }</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    Vector&lt;MultiFab&gt; mf(finest_level+1);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        mf[lev].define(grids[lev], dmap[lev], ncomp_mf, 0);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    }</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160; </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    Vector&lt;MultiFab&gt; mf_nd(finest_level+1);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a063a88594452100497651e8aaf1f68d7">use_terrain</a>) {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            BoxArray nodal_grids(grids[lev]); nodal_grids.surroundingNodes();</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            mf_nd[lev].define(nodal_grids, dmap[lev], 3, 0);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            mf_nd[lev].setVal(0.);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        }</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    }</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev)</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    {</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <span class="keywordtype">int</span> mf_comp = 0;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <span class="comment">// First, copy any of the conserved state variables into the output plotfile</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        AMREX_ALWAYS_ASSERT(<a class="code" href="classERF.html#afd8cd5a477754776135befa668fdd0c9">cons_names</a>.size() &gt;= ncomp_cons);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ncomp_cons; ++i) {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <a class="code" href="classERF.html#afd8cd5a477754776135befa668fdd0c9">cons_names</a>[i])) {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                MultiFab::Copy(mf[lev],<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],i,mf_comp,1,0);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                mf_comp++;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            }</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        }</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <span class="comment">// Next, check for velocities and if desired, output them -- note we output none or all, not just some</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;x_velocity&quot;</span>) ||</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            <a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;y_velocity&quot;</span>) ||</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            <a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;z_velocity&quot;</span>)) {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            average_face_to_cellcenter(mf[lev],mf_comp,</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                Array&lt;const MultiFab*,3&gt;{&amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],&amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],&amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>]});</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;            mf_comp += AMREX_SPACEDIM;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        }</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <span class="comment">// Finally, check for any derived quantities and compute them, inserting</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <span class="comment">// them into our output multifab</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <span class="keyword">auto</span> calculate_derived = [&amp;](<span class="keyword">const</span> std::string&amp; der_name,</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                                     decltype(<a class="code" href="namespacederived.html#a7fb98e12fceaa6f691dfef83db453757">derived::erf_dernull</a>)&amp; der_function)</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        {</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, der_name)) {</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                MultiFab dmf(mf[lev], make_alias, mf_comp, 1);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="preprocessor">#pragma omp parallel if (amrex::Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                <span class="keywordflow">for</span> (MFIter mfi(dmf, TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                {</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                    <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                    <span class="keyword">auto</span>&amp; dfab = dmf[mfi];</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                    <span class="keyword">auto</span>&amp; sfab = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>][mfi];</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                    der_function(bx, dfab, 0, 1, sfab, Geom(lev), <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0], <span class="keyword">nullptr</span>, lev);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                }</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                mf_comp++;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            }</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        };</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="comment">// Note: All derived variables must be computed in order of &quot;derived_names&quot; defined in ERF.H</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        calculate_derived(<span class="stringliteral">&quot;soundspeed&quot;</span>,  <a class="code" href="namespacederived.html#afe57e0f13e2e24c73d0ed373a9cd0d09">derived::erf_dersoundspeed</a>);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        calculate_derived(<span class="stringliteral">&quot;temp&quot;</span>,        <a class="code" href="namespacederived.html#a8d96f91847cec51636c122ab27a5f8a2">derived::erf_dertemp</a>);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        calculate_derived(<span class="stringliteral">&quot;theta&quot;</span>,       <a class="code" href="namespacederived.html#adc3c787125484205e4fc7cd85c25ab6c">derived::erf_dertheta</a>);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        calculate_derived(<span class="stringliteral">&quot;KE&quot;</span>,          <a class="code" href="namespacederived.html#acc3f245c73a0826afc9e7626f12126d3">derived::erf_derKE</a>);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        calculate_derived(<span class="stringliteral">&quot;QKE&quot;</span>,         <a class="code" href="namespacederived.html#ad3b06be920cca917ee17183db46d77ba">derived::erf_derQKE</a>);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        calculate_derived(<span class="stringliteral">&quot;scalar&quot;</span>,      <a class="code" href="namespacederived.html#a37560f4d3e2c7c10f64d41db2ce76a06">derived::erf_derscalar</a>);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        MultiFab r_hse(<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev], make_alias, 0, 1); <span class="comment">// r_0 is first  component</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        MultiFab p_hse(<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev], make_alias, 1, 1); <span class="comment">// p_0 is second component</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;pres_hse&quot;</span>))</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            <span class="comment">// p_0 is second component of base_state</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            MultiFab::Copy(mf[lev],p_hse,0,mf_comp,1,0);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            mf_comp += 1;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        }</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;dens_hse&quot;</span>))</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        {</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            <span class="comment">// r_0 is first component of base_state</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            MultiFab::Copy(mf[lev],r_hse,0,mf_comp,1,0);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            mf_comp += 1;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        }</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160; </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;pressure&quot;</span>))</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        {</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="preprocessor">#pragma omp parallel if (amrex::Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            <span class="keywordflow">for</span> ( MFIter mfi(mf[lev],TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            {</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                <span class="keyword">const</span> Array4&lt;Real      &gt;&amp; derdat = mf[lev].array(mfi);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp;  S_arr = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].const_array(mfi);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">int</span> ncomp = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nComp();</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160; </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                {</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                    Real qv_for_p = (use_moisture &amp;&amp; (ncomp &gt; <a class="code" href="IndexDefines_8H.html#aa965e9988f14d5d2a5aef4a942168a15">RhoQ1_comp</a>)) ? S_arr(i,j,k,<a class="code" href="IndexDefines_8H.html#aa965e9988f14d5d2a5aef4a942168a15">RhoQ1_comp</a>)/S_arr(i,j,k,<a class="code" href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>) : 0;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                    <span class="keyword">const</span> Real rhotheta = S_arr(i,j,k,<a class="code" href="IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                    derdat(i, j, k, mf_comp) = <a class="code" href="EOS_8H.html#a08354ab110fb9e873bce9250b4f4b46e">getPgivenRTh</a>(rhotheta,qv_for_p);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                });</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            }</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            mf_comp += 1;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        }</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;pert_pres&quot;</span>))</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        {</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="preprocessor">#pragma omp parallel if (amrex::Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            <span class="keywordflow">for</span> ( MFIter mfi(mf[lev],TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            {</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                <span class="keyword">const</span> Array4&lt;Real&gt;&amp; derdat = mf[lev].array(mfi);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; p0_arr = p_hse.const_array(mfi);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; S_arr = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].const_array(mfi);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">int</span> ncomp = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nComp();</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                {</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                    Real qv_for_p = (use_moisture &amp;&amp; (ncomp &gt; <a class="code" href="IndexDefines_8H.html#aa965e9988f14d5d2a5aef4a942168a15">RhoQ1_comp</a>)) ? S_arr(i,j,k,<a class="code" href="IndexDefines_8H.html#aa965e9988f14d5d2a5aef4a942168a15">RhoQ1_comp</a>)/S_arr(i,j,k,<a class="code" href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>) : 0;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                    <span class="keyword">const</span> Real rhotheta = S_arr(i,j,k,<a class="code" href="IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                    derdat(i, j, k, mf_comp) = <a class="code" href="EOS_8H.html#a08354ab110fb9e873bce9250b4f4b46e">getPgivenRTh</a>(rhotheta,qv_for_p) - p0_arr(i,j,k);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                });</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            }</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            mf_comp += 1;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        }</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;pert_dens&quot;</span>))</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        {</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="preprocessor">#pragma omp parallel if (amrex::Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            <span class="keywordflow">for</span> ( MFIter mfi(mf[lev],TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            {</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                <span class="keyword">const</span> Array4&lt;Real&gt;&amp; derdat  = mf[lev].array(mfi);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; S_arr = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].const_array(mfi);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; r0_arr = r_hse.const_array(mfi);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept {</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                    derdat(i, j, k, mf_comp) = S_arr(i,j,k,<a class="code" href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>) - r0_arr(i,j,k);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                });</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;            mf_comp ++;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        }</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;eq_pot_temp&quot;</span>))</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        {</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="preprocessor">#pragma omp parallel if (amrex::Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            <span class="keywordflow">for</span> ( MFIter mfi(mf[lev],TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            {</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                <span class="keyword">const</span> Array4&lt;Real&gt;&amp; derdat  = mf[lev].array(mfi);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; S_arr = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].const_array(mfi);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">int</span> ncomp = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nComp();</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept {</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                    Real <a class="code" href="namespaceMicVar__Kess.html#ad6f84c7e649afdd998b2f37ba87476beaf099273d19f4b8cdca199c5177231e35">qv</a> = (use_moisture &amp;&amp; (ncomp &gt; <a class="code" href="IndexDefines_8H.html#aa965e9988f14d5d2a5aef4a942168a15">RhoQ1_comp</a>)) ? S_arr(i,j,k,<a class="code" href="IndexDefines_8H.html#aa965e9988f14d5d2a5aef4a942168a15">RhoQ1_comp</a>)/S_arr(i,j,k,<a class="code" href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>) : 0.0;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                    Real qc = (use_moisture &amp;&amp; (ncomp &gt; <a class="code" href="IndexDefines_8H.html#a3bf0a4783e82ba30db2b7c0a332c2f16">RhoQ2_comp</a>)) ? S_arr(i,j,k,<a class="code" href="IndexDefines_8H.html#a3bf0a4783e82ba30db2b7c0a332c2f16">RhoQ2_comp</a>)/S_arr(i,j,k,<a class="code" href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>) : 0.0;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                    Real <a class="code" href="namespaceRealBdyVars.html#aa4743649b85ade11df23692d7c3947bda8ecd2dbb16824e5c68db7daf2254fc79">T</a> = <a class="code" href="EOS_8H.html#a65cf1718b7a1fcc56cb16685642543da">getTgivenRandRTh</a>(S_arr(i,j,k,<a class="code" href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>), S_arr(i,j,k,<a class="code" href="IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>), <a class="code" href="namespaceMicVar__Kess.html#ad6f84c7e649afdd998b2f37ba87476beaf099273d19f4b8cdca199c5177231e35">qv</a>);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                    Real pressure = <a class="code" href="EOS_8H.html#a08354ab110fb9e873bce9250b4f4b46e">getPgivenRTh</a>(S_arr(i,j,k,<a class="code" href="IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>), <a class="code" href="namespaceMicVar__Kess.html#ad6f84c7e649afdd998b2f37ba87476beaf099273d19f4b8cdca199c5177231e35">qv</a>);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                    Real fac = <a class="code" href="ERF__Constants_8H.html#a1ee33e063343c8fb15ed025c456ebd46">Cp_d</a> + <a class="code" href="ERF__Constants_8H.html#acecae1da25fb8c8d32d1f175e18df41f">Cp_l</a>*(<a class="code" href="namespaceMicVar__Kess.html#ad6f84c7e649afdd998b2f37ba87476beaf099273d19f4b8cdca199c5177231e35">qv</a> + qc);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                    Real pv = <a class="code" href="Microphysics__Utils_8H.html#a16a390366e7e68ca35fdac4cad824428">erf_esatw</a>(<a class="code" href="namespaceRealBdyVars.html#aa4743649b85ade11df23692d7c3947bda8ecd2dbb16824e5c68db7daf2254fc79">T</a>)*100.0;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                    derdat(i, j, k, mf_comp) = <a class="code" href="namespaceRealBdyVars.html#aa4743649b85ade11df23692d7c3947bda8ecd2dbb16824e5c68db7daf2254fc79">T</a>*std::pow((pressure - pv)/<a class="code" href="ERF__Constants_8H.html#a994fea25f28c33c2e8f1e9c63d5b8b56">p_0</a>, -<a class="code" href="ERF__Constants_8H.html#aeb133d0ac46d639050313ce36187e870">R_d</a>/fac)*std::exp(<a class="code" href="ERF__Constants_8H.html#aee80ef06f62b6528b776d02de062cdd5">L_v</a>*<a class="code" href="namespaceMicVar__Kess.html#ad6f84c7e649afdd998b2f37ba87476beaf099273d19f4b8cdca199c5177231e35">qv</a>/(fac*<a class="code" href="namespaceRealBdyVars.html#aa4743649b85ade11df23692d7c3947bda8ecd2dbb16824e5c68db7daf2254fc79">T</a>)) ;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                });</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            }</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            mf_comp ++;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        }</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160; </div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        <span class="keywordtype">int</span> klo = geom[lev].Domain().smallEnd(2);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        <span class="keywordtype">int</span> khi = geom[lev].Domain().bigEnd(2);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160; </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;dpdx&quot;</span>))</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        {</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            <span class="keyword">auto</span> dxInv = geom[lev].InvCellSizeArray();</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;            MultiFab <a class="code" href="namespaceMicVar__Kess.html#ad6f84c7e649afdd998b2f37ba87476bea82dd7c202e6cce14520ac01cfaa4f4ad">pres</a>(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].boxArray(), <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].DistributionMap(), 1, 1);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="preprocessor">#pragma omp parallel if (amrex::Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            <span class="keywordflow">for</span> ( MFIter mfi(mf[lev],TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;            {</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                <span class="comment">// First define pressure on grown box</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                <span class="keyword">const</span> Box&amp; gbx = mfi.growntilebox(1);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                <span class="keyword">const</span> Array4&lt;Real&gt; &amp; p_arr  = <a class="code" href="namespaceMicVar__Kess.html#ad6f84c7e649afdd998b2f37ba87476bea82dd7c202e6cce14520ac01cfaa4f4ad">pres</a>.array(mfi);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; S_arr = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].const_array(mfi);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                ParallelFor(gbx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept {</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                    p_arr(i,j,k) = <a class="code" href="EOS_8H.html#a08354ab110fb9e873bce9250b4f4b46e">getPgivenRTh</a>(S_arr(i,j,k,<a class="code" href="IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>));</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                });</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            }</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            <a class="code" href="namespaceMicVar__Kess.html#ad6f84c7e649afdd998b2f37ba87476bea82dd7c202e6cce14520ac01cfaa4f4ad">pres</a>.FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="preprocessor">#pragma omp parallel if (amrex::Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;            <span class="keywordflow">for</span> ( MFIter mfi(mf[lev],TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            {</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                <span class="comment">// Now compute pressure gradient on valid box</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                <span class="keyword">const</span> Array4&lt;Real&gt;&amp; derdat = mf[lev].array(mfi);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                <span class="keyword">const</span> Array4&lt;Real&gt; &amp; p_arr  = <a class="code" href="namespaceMicVar__Kess.html#ad6f84c7e649afdd998b2f37ba87476bea82dd7c202e6cce14520ac01cfaa4f4ad">pres</a>.array(mfi);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160; </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a063a88594452100497651e8aaf1f68d7">use_terrain</a>) {</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                    <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; z_nd = <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160; </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                    ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept {</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160; </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                        <span class="comment">// Pgrad at lower I face</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                        Real met_h_xi_lo   = <a class="code" href="TerrainMetrics_8H.html#a2116df83b61a39fb50b9a2d7474c00d7">Compute_h_xi_AtIface</a>  (i, j, k, dxInv, z_nd);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                        Real met_h_zeta_lo = <a class="code" href="TerrainMetrics_8H.html#a8d96671d41364f1e24391375a2bc0f1e">Compute_h_zeta_AtIface</a>(i, j, k, dxInv, z_nd);</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                        Real gp_xi_lo = dxInv[0] * (p_arr(i,j,k) - p_arr(i-1,j,k));</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                        Real gp_zeta_on_iface_lo;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                        <span class="keywordflow">if</span>(k == klo) {</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                            gp_zeta_on_iface_lo = 0.5 * dxInv[2] * (</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                                p_arr(i-1,j,k+1) + p_arr(i,j,k+1)</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                              - p_arr(i-1,j,k  ) - p_arr(i,j,k  ) );</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k == khi) {</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                            gp_zeta_on_iface_lo = 0.5 * dxInv[2] * (</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                                p_arr(i-1,j,k  ) + p_arr(i,j,k  )</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                              - p_arr(i-1,j,k-1) - p_arr(i,j,k-1) );</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                            gp_zeta_on_iface_lo = 0.25 * dxInv[2] * (</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                                p_arr(i-1,j,k+1) + p_arr(i,j,k+1)</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                              - p_arr(i-1,j,k-1) - p_arr(i,j,k-1) );</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                        }</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                        Real gpx_lo = gp_xi_lo - (met_h_xi_lo/ met_h_zeta_lo) * gp_zeta_on_iface_lo;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160; </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                        <span class="comment">// Pgrad at higher I face</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                        Real met_h_xi_hi   = <a class="code" href="TerrainMetrics_8H.html#a2116df83b61a39fb50b9a2d7474c00d7">Compute_h_xi_AtIface</a>  (i+1, j, k, dxInv, z_nd);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                        Real met_h_zeta_hi = <a class="code" href="TerrainMetrics_8H.html#a8d96671d41364f1e24391375a2bc0f1e">Compute_h_zeta_AtIface</a>(i+1, j, k, dxInv, z_nd);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                        Real gp_xi_hi = dxInv[0] * (p_arr(i+1,j,k) - p_arr(i,j,k));</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                        Real gp_zeta_on_iface_hi;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                        <span class="keywordflow">if</span>(k == klo) {</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                            gp_zeta_on_iface_hi = 0.5 * dxInv[2] * (</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                                p_arr(i+1,j,k+1) + p_arr(i,j,k+1)</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                                - p_arr(i+1,j,k  ) - p_arr(i,j,k  ) );</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k == khi) {</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                            gp_zeta_on_iface_hi = 0.5 * dxInv[2] * (</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                                p_arr(i+1,j,k  ) + p_arr(i,j,k  )</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                                - p_arr(i+1,j,k-1) - p_arr(i,j,k-1) );</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                            gp_zeta_on_iface_hi = 0.25 * dxInv[2] * (</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                                p_arr(i+1,j,k+1) + p_arr(i,j,k+1)</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                                - p_arr(i+1,j,k-1) - p_arr(i,j,k-1) );</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                        }</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                        Real gpx_hi = gp_xi_hi - (met_h_xi_hi/ met_h_zeta_hi) * gp_zeta_on_iface_hi;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160; </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                        <span class="comment">// Average P grad to CC</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                        derdat(i ,j ,k, mf_comp) = 0.5 * (gpx_lo + gpx_hi);</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                    });</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                    ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept {</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                        derdat(i ,j ,k, mf_comp) = 0.5 * (p_arr(i+1,j,k) - p_arr(i-1,j,k)) * dxInv[0];</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                    });</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                }</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;            } <span class="comment">// mfi</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;            mf_comp ++;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        } <span class="comment">// dpdx</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;dpdy&quot;</span>))</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        {</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            <span class="keyword">auto</span> dxInv = geom[lev].InvCellSizeArray();</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160; </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;            MultiFab <a class="code" href="namespaceMicVar__Kess.html#ad6f84c7e649afdd998b2f37ba87476bea82dd7c202e6cce14520ac01cfaa4f4ad">pres</a>(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].boxArray(), <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].DistributionMap(), 1, 1);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="preprocessor">#pragma omp parallel if (amrex::Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;            <span class="keywordflow">for</span> ( MFIter mfi(mf[lev],TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;            {</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                <span class="comment">// First define pressure on grown box</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                <span class="keyword">const</span> Box&amp; gbx = mfi.growntilebox(1);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                <span class="keyword">const</span> Array4&lt;Real&gt; &amp; p_arr  = <a class="code" href="namespaceMicVar__Kess.html#ad6f84c7e649afdd998b2f37ba87476bea82dd7c202e6cce14520ac01cfaa4f4ad">pres</a>.array(mfi);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; S_arr = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].const_array(mfi);</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                ParallelFor(gbx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept {</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                    p_arr(i,j,k) = <a class="code" href="EOS_8H.html#a08354ab110fb9e873bce9250b4f4b46e">getPgivenRTh</a>(S_arr(i,j,k,<a class="code" href="IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>));</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                });</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            }</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;            <a class="code" href="namespaceMicVar__Kess.html#ad6f84c7e649afdd998b2f37ba87476bea82dd7c202e6cce14520ac01cfaa4f4ad">pres</a>.FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160; </div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="preprocessor">#pragma omp parallel if (amrex::Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;            <span class="keywordflow">for</span> ( MFIter mfi(mf[lev],TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;            {</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                <span class="comment">// Now compute pressure gradient on valid box</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                <span class="keyword">const</span> Array4&lt;Real&gt;&amp; derdat = mf[lev].array(mfi);</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                <span class="keyword">const</span> Array4&lt;Real&gt; &amp; p_arr  = <a class="code" href="namespaceMicVar__Kess.html#ad6f84c7e649afdd998b2f37ba87476bea82dd7c202e6cce14520ac01cfaa4f4ad">pres</a>.array(mfi);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160; </div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a063a88594452100497651e8aaf1f68d7">use_terrain</a>) {</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                    <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; z_nd = <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160; </div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                    ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept {</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160; </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                        Real met_h_eta_lo  = <a class="code" href="TerrainMetrics_8H.html#ae609a5c1f84347b66e9a8b712271c4ce">Compute_h_eta_AtJface</a> (i, j, k, dxInv, z_nd);</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                        Real met_h_zeta_lo = <a class="code" href="TerrainMetrics_8H.html#ada12bcb6beb3fa0d00dbdacb37f3c60f">Compute_h_zeta_AtJface</a>(i, j, k, dxInv, z_nd);</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                        Real gp_eta_lo = dxInv[1] * (p_arr(i,j,k) - p_arr(i,j-1,k));</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                        Real gp_zeta_on_jface_lo;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                        <span class="keywordflow">if</span> (k == klo) {</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                            gp_zeta_on_jface_lo = 0.5 * dxInv[2] * (</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                                p_arr(i,j,k+1) + p_arr(i,j-1,k+1)</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                                - p_arr(i,j,k  ) - p_arr(i,j-1,k  ) );</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k == khi) {</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                            gp_zeta_on_jface_lo = 0.5 * dxInv[2] * (</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                                p_arr(i,j,k  ) + p_arr(i,j-1,k  )</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                                - p_arr(i,j,k-1) - p_arr(i,j-1,k-1) );</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                            gp_zeta_on_jface_lo = 0.25 * dxInv[2] * (</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                                p_arr(i,j,k+1) + p_arr(i,j-1,k+1)</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                                - p_arr(i,j,k-1) - p_arr(i,j-1,k-1) );</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                        }</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                        Real gpy_lo = gp_eta_lo - (met_h_eta_lo / met_h_zeta_lo) * gp_zeta_on_jface_lo;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160; </div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                        Real met_h_eta_hi  = <a class="code" href="TerrainMetrics_8H.html#ae609a5c1f84347b66e9a8b712271c4ce">Compute_h_eta_AtJface</a> (i, j+1, k, dxInv, z_nd);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                        Real met_h_zeta_hi = <a class="code" href="TerrainMetrics_8H.html#ada12bcb6beb3fa0d00dbdacb37f3c60f">Compute_h_zeta_AtJface</a>(i, j+1, k, dxInv, z_nd);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                        Real gp_eta_hi = dxInv[1] * (p_arr(i,j+1,k) - p_arr(i,j,k));</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                        Real gp_zeta_on_jface_hi;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                        <span class="keywordflow">if</span> (k == klo) {</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                            gp_zeta_on_jface_hi = 0.5 * dxInv[2] * (</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                                p_arr(i,j+1,k+1) + p_arr(i,j,k+1)</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                                - p_arr(i,j+1,k  ) - p_arr(i,j,k  ) );</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k == khi) {</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                            gp_zeta_on_jface_hi = 0.5 * dxInv[2] * (</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                                p_arr(i,j+1,k  ) + p_arr(i,j,k  )</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                                - p_arr(i,j+1,k-1) - p_arr(i,j,k-1) );</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                            gp_zeta_on_jface_hi = 0.25 * dxInv[2] * (</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                                p_arr(i,j+1,k+1) + p_arr(i,j,k+1)</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                                - p_arr(i,j+1,k-1) - p_arr(i,j,k-1) );</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                        }</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                        Real gpy_hi = gp_eta_hi - (met_h_eta_hi / met_h_zeta_hi) * gp_zeta_on_jface_hi;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160; </div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                        derdat(i ,j ,k, mf_comp) = 0.5 * (gpy_lo + gpy_hi);</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                    });</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                    ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept {</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                        derdat(i ,j ,k, mf_comp) = 0.5 * (p_arr(i,j+1,k) - p_arr(i,j-1,k)) * dxInv[1];</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                    });</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                }</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;            } <span class="comment">// mf</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;            mf_comp ++;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        } <span class="comment">// dpdy</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160; </div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;pres_hse_x&quot;</span>))</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        {</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;            <span class="keyword">auto</span> dxInv = geom[lev].InvCellSizeArray();</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="preprocessor">#pragma omp parallel if (amrex::Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;            <span class="keywordflow">for</span> ( MFIter mfi(mf[lev],TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;            {</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                <span class="keyword">const</span> Array4&lt;Real      &gt;&amp;  derdat = mf[lev].array(mfi);</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp;   p_arr = p_hse.const_array(mfi);</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160; </div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                <span class="comment">//USE_TERRAIN POSSIBLE ISSUE HERE</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; z_nd  = <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160; </div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept {</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                    Real met_h_xi_lo   = <a class="code" href="TerrainMetrics_8H.html#a2116df83b61a39fb50b9a2d7474c00d7">Compute_h_xi_AtIface</a>  (i, j, k, dxInv, z_nd);</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                    Real met_h_zeta_lo = <a class="code" href="TerrainMetrics_8H.html#a8d96671d41364f1e24391375a2bc0f1e">Compute_h_zeta_AtIface</a>(i, j, k, dxInv, z_nd);</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                    Real gp_xi_lo = dxInv[0] * (p_arr(i,j,k) - p_arr(i-1,j,k));</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                    Real gp_zeta_on_iface_lo;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                    <span class="keywordflow">if</span> (k == klo) {</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                      gp_zeta_on_iface_lo = 0.5 * dxInv[2] * (</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                                                              p_arr(i-1,j,k+1) + p_arr(i,j,k+1)</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                                                            - p_arr(i-1,j,k  ) - p_arr(i,j,k  ) );</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k == khi) {</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                      gp_zeta_on_iface_lo = 0.5 * dxInv[2] * (</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                                                              p_arr(i-1,j,k  ) + p_arr(i,j,k  )</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                                                            - p_arr(i-1,j,k-1) - p_arr(i,j,k-1) );</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                      gp_zeta_on_iface_lo = 0.25 * dxInv[2] * (</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                                                               p_arr(i-1,j,k+1) + p_arr(i,j,k+1)</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                                                             - p_arr(i-1,j,k-1) - p_arr(i,j,k-1) );</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                    }</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                    Real gpx_lo = gp_xi_lo - (met_h_xi_lo/ met_h_zeta_lo) * gp_zeta_on_iface_lo;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160; </div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                    Real met_h_xi_hi   = <a class="code" href="TerrainMetrics_8H.html#a2116df83b61a39fb50b9a2d7474c00d7">Compute_h_xi_AtIface</a>  (i+1, j, k, dxInv, z_nd);</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                    Real met_h_zeta_hi = <a class="code" href="TerrainMetrics_8H.html#a8d96671d41364f1e24391375a2bc0f1e">Compute_h_zeta_AtIface</a>(i+1, j, k, dxInv, z_nd);</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                    Real gp_xi_hi = dxInv[0] * (p_arr(i+1,j,k) - p_arr(i,j,k));</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                    Real gp_zeta_on_iface_hi;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                    <span class="keywordflow">if</span> (k == klo) {</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                      gp_zeta_on_iface_hi = 0.5 * dxInv[2] * (</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                                                              p_arr(i+1,j,k+1) + p_arr(i,j,k+1)</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                                                            - p_arr(i+1,j,k  ) - p_arr(i,j,k  ) );</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k == khi) {</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                      gp_zeta_on_iface_hi = 0.5 * dxInv[2] * (</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                                                              p_arr(i+1,j,k  ) + p_arr(i,j,k  )</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                                                            - p_arr(i+1,j,k-1) - p_arr(i,j,k-1) );</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                      gp_zeta_on_iface_hi = 0.25 * dxInv[2] * (</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                                                               p_arr(i+1,j,k+1) + p_arr(i,j,k+1)</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                                                             - p_arr(i+1,j,k-1) - p_arr(i,j,k-1) );</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                    }</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                    Real gpx_hi = gp_xi_hi - (met_h_xi_hi/ met_h_zeta_hi) * gp_zeta_on_iface_hi;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160; </div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                    derdat(i ,j ,k, mf_comp) = 0.5 * (gpx_lo + gpx_hi);</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                });</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;            }</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;            mf_comp += 1;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        } <span class="comment">// pres_hse_x</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160; </div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;pres_hse_y&quot;</span>))</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        {</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;            <span class="keyword">auto</span> dxInv = geom[lev].InvCellSizeArray();</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="preprocessor">#pragma omp parallel if (amrex::Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;            <span class="keywordflow">for</span> ( MFIter mfi(mf[lev],TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;            {</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                <span class="keyword">const</span> Array4&lt;Real      &gt;&amp; derdat = mf[lev].array(mfi);</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp;   p_arr = p_hse.const_array(mfi);</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; z_nd    = <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept {</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                    Real met_h_eta_lo  = <a class="code" href="TerrainMetrics_8H.html#ae609a5c1f84347b66e9a8b712271c4ce">Compute_h_eta_AtJface</a> (i, j, k, dxInv, z_nd);</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                    Real met_h_zeta_lo = <a class="code" href="TerrainMetrics_8H.html#ada12bcb6beb3fa0d00dbdacb37f3c60f">Compute_h_zeta_AtJface</a>(i, j, k, dxInv, z_nd);</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                    Real gp_eta_lo = dxInv[1] * (p_arr(i,j,k) - p_arr(i,j-1,k));</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                    Real gp_zeta_on_jface_lo;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                    <span class="keywordflow">if</span> (k == klo) {</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;                      gp_zeta_on_jface_lo = 0.5 * dxInv[2] * (</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                                                              p_arr(i,j,k+1) + p_arr(i,j-1,k+1)</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                                                            - p_arr(i,j,k  ) - p_arr(i,j-1,k  ) );</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k == khi) {</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                      gp_zeta_on_jface_lo = 0.5 * dxInv[2] * (</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                                                              p_arr(i,j,k  ) + p_arr(i,j-1,k  )</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                                                            - p_arr(i,j,k-1) - p_arr(i,j-1,k-1) );</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                      gp_zeta_on_jface_lo = 0.25 * dxInv[2] * (</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                                                               p_arr(i,j,k+1) + p_arr(i,j-1,k+1)</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                                                             - p_arr(i,j,k-1) - p_arr(i,j-1,k-1) );</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                    }</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                    Real gpy_lo = gp_eta_lo - (met_h_eta_lo / met_h_zeta_lo) * gp_zeta_on_jface_lo;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160; </div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                    Real met_h_eta_hi  = <a class="code" href="TerrainMetrics_8H.html#ae609a5c1f84347b66e9a8b712271c4ce">Compute_h_eta_AtJface</a> (i, j+1, k, dxInv, z_nd);</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                    Real met_h_zeta_hi = <a class="code" href="TerrainMetrics_8H.html#ada12bcb6beb3fa0d00dbdacb37f3c60f">Compute_h_zeta_AtJface</a>(i, j+1, k, dxInv, z_nd);</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                    Real gp_eta_hi = dxInv[1] * (p_arr(i,j+1,k) - p_arr(i,j,k));</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                    Real gp_zeta_on_jface_hi;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                    <span class="keywordflow">if</span> (k == klo) {</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                      gp_zeta_on_jface_hi = 0.5 * dxInv[2] * (</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                                                              p_arr(i,j+1,k+1) + p_arr(i,j,k+1)</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                                                            - p_arr(i,j+1,k  ) - p_arr(i,j,k  ) );</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k == khi) {</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                      gp_zeta_on_jface_hi = 0.5 * dxInv[2] * (</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                                                              p_arr(i,j+1,k  ) + p_arr(i,j,k  )</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                                                            - p_arr(i,j+1,k-1) - p_arr(i,j,k-1) );</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                      gp_zeta_on_jface_hi = 0.25 * dxInv[2] * (</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                                                               p_arr(i,j+1,k+1) + p_arr(i,j,k+1)</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                                                             - p_arr(i,j+1,k-1) - p_arr(i,j,k-1) );</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                    }</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                    Real gpy_hi = gp_eta_hi - (met_h_eta_hi / met_h_zeta_hi) * gp_zeta_on_jface_hi;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160; </div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                    derdat(i ,j ,k, mf_comp) = 0.5 * (gpy_lo + gpy_hi);</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                });</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;            }</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;            mf_comp += 1;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        } <span class="comment">// pres_hse_y</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160; </div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a063a88594452100497651e8aaf1f68d7">use_terrain</a>) {</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;z_phys&quot;</span>))</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;            {</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                MultiFab::Copy(mf[lev],*<a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[lev],0,mf_comp,1,0);</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                mf_comp ++;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;            }</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160; </div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;detJ&quot;</span>))</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;            {</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                MultiFab::Copy(mf[lev],*<a class="code" href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">detJ_cc</a>[lev],0,mf_comp,1,0);</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                mf_comp ++;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;            }</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        } <span class="comment">// use_terrain</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160; </div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;mapfac&quot;</span>)) {</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="preprocessor">#pragma omp parallel if (amrex::Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;            <span class="keywordflow">for</span> ( MFIter mfi(mf[lev],TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;            {</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                <span class="keyword">const</span> Array4&lt;Real&gt;&amp; derdat = mf[lev].array(mfi);</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                <span class="keyword">const</span> Array4&lt;Real&gt;&amp; mf_m   = <a class="code" href="classERF.html#a23aacdb72e9d2dfed8e2ebd2c2526497">mapfac_m</a>[lev]-&gt;array(mfi);</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept {</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                   derdat(i ,j ,k, mf_comp) = mf_m(i,j,0);</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                });</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;            }</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;            mf_comp ++;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        }</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160; </div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;Kmv&quot;</span>)) {</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;            MultiFab::Copy(mf[lev],*<a class="code" href="classERF.html#a327d704704abd516be19339cb2d226f9">eddyDiffs_lev</a>[lev],<a class="code" href="namespaceEddyDiff.html#a7e7e94a6b49fe20d106a1ea7317d149ea61ed124b350a1b26da1bd26aebfa5f82">EddyDiff::Mom_v</a>,mf_comp,1,0);</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;            mf_comp ++;</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        }</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;Kmh&quot;</span>)) {</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;            MultiFab::Copy(mf[lev],*<a class="code" href="classERF.html#a327d704704abd516be19339cb2d226f9">eddyDiffs_lev</a>[lev],<a class="code" href="namespaceEddyDiff.html#a7e7e94a6b49fe20d106a1ea7317d149ea2e96e6d5e84e7d7b9857e73159dfbe2b">EddyDiff::Mom_h</a>,mf_comp,1,0);</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;            mf_comp ++;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        }</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;Khv&quot;</span>)) {</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;            MultiFab::Copy(mf[lev],*<a class="code" href="classERF.html#a327d704704abd516be19339cb2d226f9">eddyDiffs_lev</a>[lev],<a class="code" href="namespaceEddyDiff.html#a7e7e94a6b49fe20d106a1ea7317d149ea0af64d676c5c6f4312eb892f9a7a46cd">EddyDiff::Theta_v</a>,mf_comp,1,0);</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;            mf_comp ++;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        }</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;Khh&quot;</span>)) {</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;            MultiFab::Copy(mf[lev],*<a class="code" href="classERF.html#a327d704704abd516be19339cb2d226f9">eddyDiffs_lev</a>[lev],<a class="code" href="namespaceEddyDiff.html#a7e7e94a6b49fe20d106a1ea7317d149ead0cfc6c50b43867895cbc2c02eb2b99a">EddyDiff::Theta_h</a>,mf_comp,1,0);</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;            mf_comp ++;</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        }</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;Lpbl&quot;</span>)) {</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;            MultiFab::Copy(mf[lev],*<a class="code" href="classERF.html#a327d704704abd516be19339cb2d226f9">eddyDiffs_lev</a>[lev],<a class="code" href="namespaceEddyDiff.html#a7e7e94a6b49fe20d106a1ea7317d149ea6a553b28d62930bdda7b473e28464b73">EddyDiff::PBL_lengthscale</a>,mf_comp,1,0);</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;            mf_comp ++;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        }</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160; </div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        <span class="comment">// TODO: The size of the q variables can vary with different</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        <span class="comment">//       moisture models. Therefore, certain components may</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        <span class="comment">//       reside at different indices. For example, Kessler is</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        <span class="comment">//       warm but precipitating. This puts qp at index 3.</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        <span class="comment">//       However, SAM is cold and precipitating so qp is index 4.</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;        <span class="comment">//       Need to built an external enum struct or a better pathway.</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160; </div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;        <span class="comment">// NOTE: Protect against accessing non-existent data</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;        <span class="keywordflow">if</span> (use_moisture) {</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;            <span class="keywordtype">int</span> n_qstate   = <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;Get_Qstate_Size();</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160; </div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;            <span class="comment">// Non-precipitating components</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;            <span class="comment">//--------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;qt&quot;</span>))</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;            {</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                <span class="keywordtype">int</span> n_start = <a class="code" href="IndexDefines_8H.html#aa965e9988f14d5d2a5aef4a942168a15">RhoQ1_comp</a>;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                <span class="keywordtype">int</span> n_end   = <a class="code" href="IndexDefines_8H.html#a3bf0a4783e82ba30db2b7c0a332c2f16">RhoQ2_comp</a>;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                <span class="keywordflow">if</span> (n_qstate &gt; 3) n_end = <a class="code" href="IndexDefines_8H.html#a49fe20d81f4d923a4a6ec4eb1652072b">RhoQ3_comp</a>;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                MultiFab Sm(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],make_alias,0,ncomp_cons);</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                MultiFab::Copy(  mf[lev], Sm, n_start, mf_comp, 1, 0);</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n_comp(n_start+1); n_comp &lt;= n_end; ++n_comp) {</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                    MultiFab::Add(  mf[lev], Sm, n_comp, mf_comp, 1, 0);</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                }</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                MultiFab::Divide(mf[lev], Sm, <a class="code" href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>  , mf_comp, 1, 0);</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                mf_comp += 1;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;            }</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160; </div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;qv&quot;</span>) &amp;&amp; (n_qstate &gt;= 1))</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;            {</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                MultiFab Sm(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],make_alias,0,<a class="code" href="IndexDefines_8H.html#aa965e9988f14d5d2a5aef4a942168a15">RhoQ1_comp</a>+1);</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                MultiFab::Copy(  mf[lev], Sm, <a class="code" href="IndexDefines_8H.html#aa965e9988f14d5d2a5aef4a942168a15">RhoQ1_comp</a>, mf_comp, 1, 0);</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                MultiFab::Divide(mf[lev], Sm, <a class="code" href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>  , mf_comp, 1, 0);</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                mf_comp += 1;</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;            }</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160; </div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;qc&quot;</span>) &amp;&amp; (n_qstate &gt;= 2))</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;            {</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                MultiFab Sm(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],make_alias,0,<a class="code" href="IndexDefines_8H.html#a3bf0a4783e82ba30db2b7c0a332c2f16">RhoQ2_comp</a>+1);</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                MultiFab::Copy(  mf[lev], Sm, <a class="code" href="IndexDefines_8H.html#a3bf0a4783e82ba30db2b7c0a332c2f16">RhoQ2_comp</a>, mf_comp, 1, 0);</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                MultiFab::Divide(mf[lev], Sm, <a class="code" href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>  , mf_comp, 1, 0);</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                mf_comp += 1;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;            }</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160; </div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;qi&quot;</span>) &amp;&amp; (n_qstate &gt;= 4))</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;            {</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                MultiFab Sm(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],make_alias,0,<a class="code" href="IndexDefines_8H.html#a49fe20d81f4d923a4a6ec4eb1652072b">RhoQ3_comp</a>+1);</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                MultiFab::Copy(  mf[lev], Sm, <a class="code" href="IndexDefines_8H.html#a49fe20d81f4d923a4a6ec4eb1652072b">RhoQ3_comp</a>, mf_comp, 1, 0);</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                MultiFab::Divide(mf[lev], Sm, <a class="code" href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>  , mf_comp, 1, 0);</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                mf_comp += 1;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;            }</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160; </div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;            <span class="comment">// Precipitating components</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;            <span class="comment">//--------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;qp&quot;</span>))</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;            {</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                <span class="keywordtype">int</span> n_start = <a class="code" href="IndexDefines_8H.html#a49fe20d81f4d923a4a6ec4eb1652072b">RhoQ3_comp</a>;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                <span class="keywordtype">int</span> n_end   = ncomp_cons - 1;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                <span class="keywordflow">if</span> (n_qstate &gt; 3) n_start = <a class="code" href="IndexDefines_8H.html#a28c5deab9008c0999c26affeff2fa6da">RhoQ4_comp</a>;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                MultiFab Sm(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],make_alias,0,ncomp_cons);</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                MultiFab::Copy(  mf[lev], Sm, n_start, mf_comp, 1, 0);</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n_comp(n_start+1); n_comp &lt;= n_end; ++n_comp) {</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                    MultiFab::Add(  mf[lev], Sm, n_comp, mf_comp, 1, 0);</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                }</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                MultiFab::Divide(mf[lev], Sm, <a class="code" href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>  , mf_comp, 1, 0);</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                mf_comp += 1;</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;            }</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160; </div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;qrain&quot;</span>) &amp;&amp; (n_qstate &gt;= 3))</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;            {</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                <span class="keywordtype">int</span> n_start = <a class="code" href="IndexDefines_8H.html#a49fe20d81f4d923a4a6ec4eb1652072b">RhoQ3_comp</a>;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                <span class="keywordflow">if</span> (n_qstate &gt; 3) n_start = <a class="code" href="IndexDefines_8H.html#a28c5deab9008c0999c26affeff2fa6da">RhoQ4_comp</a>;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                MultiFab Sm(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],make_alias,0,ncomp_cons);</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                MultiFab::Copy(  mf[lev], Sm, n_start , mf_comp, 1, 0);</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                MultiFab::Divide(mf[lev], Sm, <a class="code" href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>, mf_comp, 1, 0);</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                mf_comp += 1;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;            }</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160; </div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;qsnow&quot;</span>) &amp;&amp; (n_qstate &gt;= 5))</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;            {</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                MultiFab Sm(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],make_alias,0,<a class="code" href="IndexDefines_8H.html#ac46d015fd5b1ee0060bbaf22e79113e7">RhoQ5_comp</a>+1);</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                MultiFab::Copy( mf[lev], Sm, <a class="code" href="IndexDefines_8H.html#ac46d015fd5b1ee0060bbaf22e79113e7">RhoQ5_comp</a>, mf_comp, 1, 0);</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                MultiFab::Divide(mf[lev], Sm, <a class="code" href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>  , mf_comp, 1, 0);</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                mf_comp += 1;</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;            }</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160; </div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;qgraup&quot;</span>) &amp;&amp; (n_qstate &gt;= 6))</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;            {</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                MultiFab Sm(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],make_alias,0,<a class="code" href="IndexDefines_8H.html#aae057dae5f599b944184a0ecf7801064">RhoQ6_comp</a>+1);</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                MultiFab::Copy(  mf[lev], Sm, <a class="code" href="IndexDefines_8H.html#aae057dae5f599b944184a0ecf7801064">RhoQ6_comp</a>, mf_comp, 1, 0);</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                MultiFab::Divide(mf[lev], Sm, <a class="code" href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>  , mf_comp, 1, 0);</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                mf_comp += 1;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;            }</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160; </div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;rain_accum&quot;</span>))</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;            {</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                MultiFab rain_accum_mf(*(<a class="code" href="classERF.html#ae00126a9c2738bf6a6cbbe77321c9cfc">qmoist</a>[lev][0]), make_alias, 0, 1);</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                MultiFab::Copy(mf[lev],rain_accum_mf,0,mf_comp,1,0);</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                mf_comp += 1;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;            }</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        }</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160; </div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;<span class="preprocessor">#ifdef ERF_USE_PARTICLES</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span>&amp; particles_namelist( particleData.getNames() );</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;        <span class="keywordflow">for</span> (ParticlesNamesVector::size_type i = 0; i &lt; particles_namelist.size(); i++) {</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, std::string(particles_namelist[i]+<span class="stringliteral">&quot;_count&quot;</span>))) {</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                MultiFab temp_dat(mf[lev].boxArray(), mf[lev].DistributionMap(), 1, 0);</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                temp_dat.setVal(0);</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                particleData[particles_namelist[i]]-&gt;Increment(temp_dat, lev);</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                MultiFab::Copy(mf[lev], temp_dat, 0, mf_comp, 1, 0);</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                mf_comp += 1;</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;            }</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;        }</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160; </div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        Vector&lt;std::string&gt; particle_mesh_plot_names(0);</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        particleData.GetMeshPlotVarNames( particle_mesh_plot_names );</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; particle_mesh_plot_names.size(); i++) {</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;            std::string plot_var_name(particle_mesh_plot_names[i]);</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, plot_var_name) ) {</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                MultiFab temp_dat(mf[lev].boxArray(), mf[lev].DistributionMap(), 1, 1);</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                temp_dat.setVal(0);</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                particleData.GetMeshPlotVar(plot_var_name, temp_dat, lev);</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                MultiFab::Copy(mf[lev], temp_dat, 0, mf_comp, 1, 0);</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                mf_comp += 1;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;            }</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        }</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160; </div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="preprocessor">#ifdef ERF_COMPUTE_ERROR</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;        <span class="comment">// Next, check for error in velocities and if desired, output them -- note we output none or all, not just some</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;xvel_err&quot;</span>) ||</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;            <a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;yvel_err&quot;</span>) ||</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;            <a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;zvel_err&quot;</span>))</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        {</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;            <span class="comment">// Moving terrain ANALYTICAL</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;            Real H           = geom[lev].ProbHi()[2];</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;            Real Ampl        = 0.16;</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;            Real wavelength  = 100.;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;            Real kp          = 2. * <a class="code" href="ERF__Constants_8H.html#a988c4efd6fd0d855e241e77a73191428">PI</a> / wavelength;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;            Real g           = <a class="code" href="ERF__Constants_8H.html#ac2d0c304ab1117368778efcda612de43">CONST_GRAV</a>;</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;            Real <a class="code" href="namespaceMicVar.html#a1609c4386a90fb1c27791fa3cd511fa8a40820295afd4707e596461de893e54ae">omega</a>       = std::sqrt(g * kp);</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;            Real omega_t     = <a class="code" href="namespaceMicVar.html#a1609c4386a90fb1c27791fa3cd511fa8a40820295afd4707e596461de893e54ae">omega</a> * <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev];</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160; </div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;            <span class="keyword">const</span> <span class="keyword">auto</span> dx = geom[lev].CellSizeArray();</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160; </div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="preprocessor">#pragma omp parallel if (amrex::Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;            <span class="keywordflow">for</span> (MFIter mfi(mf[lev], TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;            {</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.validbox();</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                Box xbx(bx); xbx.surroundingNodes(0);</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                <span class="keyword">const</span> Array4&lt;Real&gt; xvel_arr = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].array(mfi);</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;                <span class="keyword">const</span> Array4&lt;Real&gt; zvel_arr = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].array(mfi);</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160; </div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; z_nd = <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160; </div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                ParallelFor(xbx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                {</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;                    Real <a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01a9dd4e461268c8034f5c8564e155c67a6">x</a> = i * dx[0];</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                    Real <a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> = 0.25 * (z_nd(i,j,k) + z_nd(i,j+1,k) + z_nd(i,j,k+1) + z_nd(i,j+1,k+1));</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160; </div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                    Real z_base = Ampl * std::sin(kp * <a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01a9dd4e461268c8034f5c8564e155c67a6">x</a> - omega_t);</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                    <a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> -= z_base;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160; </div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                    Real fac = std::cosh( kp * (<a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> - H) ) / std::sinh(kp * H);</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160; </div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                    xvel_arr(i,j,k) -= -Ampl * <a class="code" href="namespaceMicVar.html#a1609c4386a90fb1c27791fa3cd511fa8a40820295afd4707e596461de893e54ae">omega</a> * fac * std::sin(kp * <a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01a9dd4e461268c8034f5c8564e155c67a6">x</a> - omega_t);</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                });</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160; </div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                ParallelFor(bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                {</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                    Real <a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01a9dd4e461268c8034f5c8564e155c67a6">x</a>   = (i + 0.5) * dx[0];</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                    Real <a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a>   = 0.25 * ( z_nd(i,j,k) + z_nd(i+1,j,k) + z_nd(i,j+1,k) + z_nd(i+1,j+1,k));</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160; </div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                    Real z_base = Ampl * std::sin(kp * <a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01a9dd4e461268c8034f5c8564e155c67a6">x</a> - omega_t);</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                    <a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> -= z_base;</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160; </div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;                    Real fac = std::sinh( kp * (<a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> - H) ) / std::sinh(kp * H);</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160; </div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                    zvel_arr(i,j,k) -= Ampl * <a class="code" href="namespaceMicVar.html#a1609c4386a90fb1c27791fa3cd511fa8a40820295afd4707e596461de893e54ae">omega</a> * fac * std::cos(kp * <a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01a9dd4e461268c8034f5c8564e155c67a6">x</a> - omega_t);</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                });</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;            }</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160; </div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;            MultiFab temp_mf(mf[lev].boxArray(), mf[lev].DistributionMap(), AMREX_SPACEDIM, 0);</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;            average_face_to_cellcenter(temp_mf,0,</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;                Array&lt;const MultiFab*,3&gt;{&amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],&amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],&amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>]});</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160; </div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;xvel_err&quot;</span>)) {</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                MultiFab::Copy(mf[lev],temp_mf,0,mf_comp,1,0);</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                mf_comp += 1;</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;            }</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;yvel_err&quot;</span>)) {</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                MultiFab::Copy(mf[lev],temp_mf,1,mf_comp,1,0);</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                mf_comp += 1;</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;            }</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;zvel_err&quot;</span>)) {</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                MultiFab::Copy(mf[lev],temp_mf,2,mf_comp,1,0);</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                mf_comp += 1;</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;            }</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160; </div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;            <span class="comment">// Now restore the velocities to what they were</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="preprocessor">#pragma omp parallel if (amrex::Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;            <span class="keywordflow">for</span> (MFIter mfi(mf[lev], TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;            {</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.validbox();</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;                Box xbx(bx); xbx.surroundingNodes(0);</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160; </div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                <span class="keyword">const</span> Array4&lt;Real&gt; xvel_arr = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].array(mfi);</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;                <span class="keyword">const</span> Array4&lt;Real&gt; zvel_arr = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].array(mfi);</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160; </div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; z_nd = <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160; </div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                ParallelFor(xbx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;                {</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                    Real <a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01a9dd4e461268c8034f5c8564e155c67a6">x</a> = i * dx[0];</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;                    Real <a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> = 0.25 * (z_nd(i,j,k) + z_nd(i,j+1,k) + z_nd(i,j,k+1) + z_nd(i,j+1,k+1));</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                    Real z_base = Ampl * std::sin(kp * <a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01a9dd4e461268c8034f5c8564e155c67a6">x</a> - omega_t);</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160; </div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                    <a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> -= z_base;</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160; </div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                    Real fac = std::cosh( kp * (<a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> - H) ) / std::sinh(kp * H);</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                    xvel_arr(i,j,k) += -Ampl * <a class="code" href="namespaceMicVar.html#a1609c4386a90fb1c27791fa3cd511fa8a40820295afd4707e596461de893e54ae">omega</a> * fac * std::sin(kp * <a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01a9dd4e461268c8034f5c8564e155c67a6">x</a> - omega_t);</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                });</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                ParallelFor(bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                {</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                    Real <a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01a9dd4e461268c8034f5c8564e155c67a6">x</a>   = (i + 0.5) * dx[0];</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                    Real <a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a>   = 0.25 * ( z_nd(i,j,k) + z_nd(i+1,j,k) + z_nd(i,j+1,k) + z_nd(i+1,j+1,k));</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                    Real z_base = Ampl * std::sin(kp * <a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01a9dd4e461268c8034f5c8564e155c67a6">x</a> - omega_t);</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160; </div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                    <a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> -= z_base;</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                    Real fac = std::sinh( kp * (<a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> - H) ) / std::sinh(kp * H);</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160; </div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                    zvel_arr(i,j,k) += Ampl * <a class="code" href="namespaceMicVar.html#a1609c4386a90fb1c27791fa3cd511fa8a40820295afd4707e596461de893e54ae">omega</a> * fac * std::cos(kp * <a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01a9dd4e461268c8034f5c8564e155c67a6">x</a> - omega_t);</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                });</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;            }</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;        } <span class="comment">// end xvel_err, yvel_err, zvel_err</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160; </div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;pp_err&quot;</span>))</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        {</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;            <span class="comment">// Moving terrain ANALYTICAL</span></div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;<span class="preprocessor">#pragma omp parallel if (amrex::Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;            <span class="keywordflow">for</span> ( MFIter mfi(mf[lev],TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;            {</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                <span class="keyword">const</span> Array4&lt;Real&gt;&amp; derdat = mf[lev].array(mfi);</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; p0_arr = p_hse.const_array(mfi);</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; S_arr = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a161eed9b529c2108b15a09099729c3b9a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].const_array(mfi);</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160; </div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;                <span class="keyword">const</span> <span class="keyword">auto</span> dx = geom[lev].CellSizeArray();</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; z_nd = <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; r0_arr = r_hse.const_array(mfi);</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160; </div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                Real H           = geom[lev].ProbHi()[2];</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                Real Ampl        = 0.16;</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                Real wavelength  = 100.;</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                Real kp          = 2. * <a class="code" href="ERF__Constants_8H.html#a988c4efd6fd0d855e241e77a73191428">PI</a> / wavelength;</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                Real g           = <a class="code" href="ERF__Constants_8H.html#ac2d0c304ab1117368778efcda612de43">CONST_GRAV</a>;</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;                Real <a class="code" href="namespaceMicVar.html#a1609c4386a90fb1c27791fa3cd511fa8a40820295afd4707e596461de893e54ae">omega</a>       = std::sqrt(g * kp);</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;                Real omega_t     = <a class="code" href="namespaceMicVar.html#a1609c4386a90fb1c27791fa3cd511fa8a40820295afd4707e596461de893e54ae">omega</a> * <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev];</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160; </div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                {</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;                    <span class="keyword">const</span> Real rhotheta = S_arr(i,j,k,<a class="code" href="IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>);</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                    derdat(i, j, k, mf_comp) = <a class="code" href="EOS_8H.html#a08354ab110fb9e873bce9250b4f4b46e">getPgivenRTh</a>(rhotheta) - p0_arr(i,j,k);</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160; </div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                    Real rho_hse     = r0_arr(i,j,k);</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160; </div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;                    Real <a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01a9dd4e461268c8034f5c8564e155c67a6">x</a>   = (i + 0.5) * dx[0];</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                    Real <a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a>   = 0.125 * ( z_nd(i,j,k  ) + z_nd(i+1,j,k  ) + z_nd(i,j+1,k  ) + z_nd(i+1,j+1,k  )</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;                                        +z_nd(i,j,k+1) + z_nd(i+1,j,k+1) + z_nd(i,j+1,k+1) + z_nd(i+1,j+1,k+1) );</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;                    Real z_base = Ampl * std::sin(kp * <a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01a9dd4e461268c8034f5c8564e155c67a6">x</a> - omega_t);</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160; </div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;                    <a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> -= z_base;</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;                    Real fac = std::cosh( kp * (<a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> - H) ) / std::sinh(kp * H);</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                    Real pprime_exact = -(Ampl * <a class="code" href="namespaceMicVar.html#a1609c4386a90fb1c27791fa3cd511fa8a40820295afd4707e596461de893e54ae">omega</a> * <a class="code" href="namespaceMicVar.html#a1609c4386a90fb1c27791fa3cd511fa8a40820295afd4707e596461de893e54ae">omega</a> / kp) * fac *</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                                              std::sin(kp * <a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01a9dd4e461268c8034f5c8564e155c67a6">x</a> - omega_t) * r0_arr(i,j,k);</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160; </div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;                    derdat(i,j,k,mf_comp) -= pprime_exact;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                });</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;            }</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;            mf_comp += 1;</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;        }</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    }</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160; </div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    <span class="comment">// Fill terrain distortion MF</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a063a88594452100497651e8aaf1f68d7">use_terrain</a>) {</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev(0); lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;            MultiFab::Copy(mf_nd[lev],*<a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev],0,2,1,0);</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;            Real dz = Geom()[lev].CellSizeArray()[2];</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;            <span class="keywordflow">for</span> (MFIter mfi(mf_nd[lev], TilingIfNotGPU()); mfi.isValid(); ++mfi) {</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                Array4&lt;      Real&gt; mf_arr = mf_nd[lev].array(mfi);</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;                ParallelFor(bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) {</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;                    mf_arr(i,j,k,2) -= k * dz;</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                });</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;            }</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        }</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    }</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160; </div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    std::string plotfilename;</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    <span class="keywordflow">if</span> (which == 1)</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;       plotfilename = Concatenate(<a class="code" href="classERF.html#aa54aaa938a18d34caa4d86e977647899">plot_file_1</a>, <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[0], 5);</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (which == 2)</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;       plotfilename = Concatenate(<a class="code" href="classERF.html#a18fa84b06132715757d97ec38678aa2c">plot_file_2</a>, <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[0], 5);</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160; </div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    <span class="comment">// LSM writes it&#39;s own data</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <span class="keywordflow">if</span> (which==1 &amp;&amp; <a class="code" href="classERF.html#afc653b103aa26c56acafed85cdd95f52">plot_lsm</a>) {</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;        <a class="code" href="classERF.html#ae0e9a78f120ba632d78cbf23c97b851c">lsm</a>.<a class="code" href="classLandSurface.html#a61290767bd3f0bc65db7a0a344b10899">Plot_Lsm_Data</a>(<a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0], <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>, refRatio());</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    }</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160; </div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    <span class="keywordflow">if</span> (finest_level == 0)</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    {</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ae7b9991150042eb38e2abc89399c0c7c">plotfile_type</a> == <span class="stringliteral">&quot;amrex&quot;</span>) {</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;            Print() &lt;&lt; <span class="stringliteral">&quot;Writing native plotfile &quot;</span> &lt;&lt; plotfilename &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a063a88594452100497651e8aaf1f68d7">use_terrain</a>) {</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;                <a class="code" href="classERF.html#a898410553492b2add00a72374dcec6ba">WriteMultiLevelPlotfileWithTerrain</a>(plotfilename, finest_level+1,</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;                                                   GetVecOfConstPtrs(mf),</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;                                                   GetVecOfConstPtrs(mf_nd),</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;                                                   varnames,</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                                                   <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0], <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>);</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;                WriteMultiLevelPlotfile(plotfilename, finest_level+1,</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;                                        GetVecOfConstPtrs(mf),</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;                                        varnames,</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                                        Geom(), <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0], <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>, refRatio());</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;            }</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;            <a class="code" href="classERF.html#aa2d8099655a8779836e63e3e98ea4372">writeJobInfo</a>(plotfilename);</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160; </div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="preprocessor">#ifdef ERF_USE_PARTICLES</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;            particleData.Checkpoint(plotfilename);</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;<span class="preprocessor">#ifdef ERF_USE_HDF5</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ae7b9991150042eb38e2abc89399c0c7c">plotfile_type</a> == <span class="stringliteral">&quot;hdf5&quot;</span> || <a class="code" href="classERF.html#ae7b9991150042eb38e2abc89399c0c7c">plotfile_type</a> == <span class="stringliteral">&quot;HDF5&quot;</span>) {</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;            Print() &lt;&lt; <span class="stringliteral">&quot;Writing plotfile &quot;</span> &lt;&lt; plotfilename+<span class="stringliteral">&quot;d01.h5&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;            WriteMultiLevelPlotfileHDF5(plotfilename, finest_level+1,</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;                                        GetVecOfConstPtrs(mf),</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;                                        varnames,</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;                                        Geom(), <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0], <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>, refRatio());</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="preprocessor">#ifdef ERF_USE_NETCDF</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ae7b9991150042eb38e2abc89399c0c7c">plotfile_type</a> == <span class="stringliteral">&quot;netcdf&quot;</span> || <a class="code" href="classERF.html#ae7b9991150042eb38e2abc89399c0c7c">plotfile_type</a> == <span class="stringliteral">&quot;NetCDF&quot;</span>) {</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;             <span class="keywordtype">int</span> lev   = 0;</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;             <span class="keywordtype">int</span> l_which = 0;</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;             writeNCPlotFile(lev, l_which, plotfilename, GetVecOfConstPtrs(mf), varnames, <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>, <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0]);</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;            Print() &lt;&lt; <span class="stringliteral">&quot;User specified plot_filetype = &quot;</span> &lt;&lt; <a class="code" href="classERF.html#ae7b9991150042eb38e2abc89399c0c7c">plotfile_type</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;            Abort(<span class="stringliteral">&quot;Dont know this plot_filetype&quot;</span>);</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;        }</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160; </div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    } <span class="keywordflow">else</span> { <span class="comment">// multilevel</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160; </div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;        Vector&lt;IntVect&gt;   r2(finest_level);</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;        Vector&lt;Geometry&gt;  g2(finest_level+1);</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;        Vector&lt;MultiFab&gt; mf2(finest_level+1);</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160; </div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;        mf2[0].define(grids[0], dmap[0], ncomp_mf, 0);</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160; </div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;        <span class="comment">// Copy level 0 as is</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        MultiFab::Copy(mf2[0],mf[0],0,0,mf[0].nComp(),0);</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160; </div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;        <span class="comment">// Define a new multi-level array of Geometry&#39;s so that we pass the new &quot;domain&quot; at lev &gt; 0</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;        Array&lt;int,AMREX_SPACEDIM&gt; periodicity =</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;                     {Geom()[0].isPeriodic(0),Geom()[0].isPeriodic(1),Geom()[0].isPeriodic(2)};</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        g2[0].define(Geom()[0].Domain(),&amp;(Geom()[0].ProbDomain()),0,periodicity.data());</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160; </div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ae7b9991150042eb38e2abc89399c0c7c">plotfile_type</a> == <span class="stringliteral">&quot;amrex&quot;</span>) {</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;            r2[0] = IntVect(1,1,ref_ratio[0][0]);</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 1; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;                <span class="keywordflow">if</span> (lev &gt; 1) {</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;                    r2[lev-1][0] = 1;</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;                    r2[lev-1][1] = 1;</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;                    r2[lev-1][2] = r2[lev-2][2] * ref_ratio[lev-1][0];</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;                }</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160; </div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;                mf2[lev].define(refine(grids[lev],r2[lev-1]), dmap[lev], ncomp_mf, 0);</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160; </div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;                <span class="comment">// Set the new problem domain</span></div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;                Box d2(Geom()[lev].Domain());</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;                d2.refine(r2[lev-1]);</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160; </div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;                g2[lev].define(d2,&amp;(Geom()[lev].ProbDomain()),0,periodicity.data());</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;            }</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160; </div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;            <span class="comment">// Do piecewise interpolation of mf into mf2</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 1; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;<span class="preprocessor">#pragma omp parallel if (amrex::Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;                <span class="keywordflow">for</span> (MFIter mfi(mf2[lev], TilingIfNotGPU()); mfi.isValid(); ++mfi) {</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;                    <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                    pcinterp_interp(bx,mf2[lev].array(mfi), 0, mf[lev].nComp(), mf[lev].const_array(mfi),0,r2[lev-1]);</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                }</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;            }</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160; </div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;            <span class="comment">// Define an effective ref_ratio which is isotropic to be passed into WriteMultiLevelPlotfile</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;            Vector&lt;IntVect&gt; rr(finest_level);</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt; finest_level; ++lev) {</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;                rr[lev] = IntVect(ref_ratio[lev][0],ref_ratio[lev][1],ref_ratio[lev][0]);</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;            }</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160; </div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;            Print() &lt;&lt; <span class="stringliteral">&quot;Writing plotfile &quot;</span> &lt;&lt; plotfilename &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a063a88594452100497651e8aaf1f68d7">use_terrain</a>) {</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                <a class="code" href="classERF.html#a898410553492b2add00a72374dcec6ba">WriteMultiLevelPlotfileWithTerrain</a>(plotfilename, finest_level+1,</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;                                                   GetVecOfConstPtrs(mf),</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;                                                   GetVecOfConstPtrs(mf_nd),</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;                                                   varnames,</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;                                                   <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0], <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>);</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;                WriteMultiLevelPlotfile(plotfilename, finest_level+1,</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;                                        GetVecOfConstPtrs(mf2), varnames,</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;                                        g2, <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0], <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>, rr);</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;            }</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160; </div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;            <a class="code" href="classERF.html#aa2d8099655a8779836e63e3e98ea4372">writeJobInfo</a>(plotfilename);</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160; </div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;<span class="preprocessor">#ifdef ERF_USE_PARTICLES</span></div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;            particleData.Checkpoint(plotfilename);</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;<span class="preprocessor">#ifdef ERF_USE_NETCDF</span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ae7b9991150042eb38e2abc89399c0c7c">plotfile_type</a> == <span class="stringliteral">&quot;netcdf&quot;</span> || <a class="code" href="classERF.html#ae7b9991150042eb38e2abc89399c0c7c">plotfile_type</a> == <span class="stringliteral">&quot;NetCDF&quot;</span>) {</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> which_box = 0; which_box &lt; <a class="code" href="classERF.html#adcd9f23975ffa605247b41d391c2a2f0">num_boxes_at_level</a>[lev]; which_box++) {</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;                     writeNCPlotFile(lev, which_box, plotfilename, GetVecOfConstPtrs(mf), varnames, <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>, <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0]);</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;                 }</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;             }</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;        }</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    } <span class="comment">// end multi-level</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;}</div>
<div class="ttc" id="aDataStruct_8H_html_a627f1f843904477f763577ad1460de01a9dd4e461268c8034f5c8564e155c67a6"><div class="ttname"><a href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01a9dd4e461268c8034f5c8564e155c67a6">Coord::x</a></div><div class="ttdeci">@ x</div></div>
<div class="ttc" id="aEOS_8H_html_a65cf1718b7a1fcc56cb16685642543da"><div class="ttname"><a href="EOS_8H.html#a65cf1718b7a1fcc56cb16685642543da">getTgivenRandRTh</a></div><div class="ttdeci">AMREX_GPU_HOST_DEVICE AMREX_FORCE_INLINE amrex::Real getTgivenRandRTh(const amrex::Real rho, const amrex::Real rhotheta, const amrex::Real qv=0.0)</div><div class="ttdef"><b>Definition:</b> EOS.H:29</div></div>
<div class="ttc" id="aERF__Constants_8H_html_a1ee33e063343c8fb15ed025c456ebd46"><div class="ttname"><a href="ERF__Constants_8H.html#a1ee33e063343c8fb15ed025c456ebd46">Cp_d</a></div><div class="ttdeci">constexpr amrex::Real Cp_d</div><div class="ttdef"><b>Definition:</b> ERF_Constants.H:12</div></div>
<div class="ttc" id="aERF__Constants_8H_html_a988c4efd6fd0d855e241e77a73191428"><div class="ttname"><a href="ERF__Constants_8H.html#a988c4efd6fd0d855e241e77a73191428">PI</a></div><div class="ttdeci">constexpr amrex::Real PI</div><div class="ttdef"><b>Definition:</b> ERF_Constants.H:6</div></div>
<div class="ttc" id="aERF__Constants_8H_html_ac2d0c304ab1117368778efcda612de43"><div class="ttname"><a href="ERF__Constants_8H.html#ac2d0c304ab1117368778efcda612de43">CONST_GRAV</a></div><div class="ttdeci">constexpr amrex::Real CONST_GRAV</div><div class="ttdef"><b>Definition:</b> ERF_Constants.H:21</div></div>
<div class="ttc" id="aERF__Constants_8H_html_acecae1da25fb8c8d32d1f175e18df41f"><div class="ttname"><a href="ERF__Constants_8H.html#acecae1da25fb8c8d32d1f175e18df41f">Cp_l</a></div><div class="ttdeci">constexpr amrex::Real Cp_l</div><div class="ttdef"><b>Definition:</b> ERF_Constants.H:14</div></div>
<div class="ttc" id="aERF__Constants_8H_html_aeb133d0ac46d639050313ce36187e870"><div class="ttname"><a href="ERF__Constants_8H.html#aeb133d0ac46d639050313ce36187e870">R_d</a></div><div class="ttdeci">constexpr amrex::Real R_d</div><div class="ttdef"><b>Definition:</b> ERF_Constants.H:10</div></div>
<div class="ttc" id="aERF__Constants_8H_html_aee80ef06f62b6528b776d02de062cdd5"><div class="ttname"><a href="ERF__Constants_8H.html#aee80ef06f62b6528b776d02de062cdd5">L_v</a></div><div class="ttdeci">constexpr amrex::Real L_v</div><div class="ttdef"><b>Definition:</b> ERF_Constants.H:16</div></div>
<div class="ttc" id="aIndexDefines_8H_html_a28c5deab9008c0999c26affeff2fa6da"><div class="ttname"><a href="IndexDefines_8H.html#a28c5deab9008c0999c26affeff2fa6da">RhoQ4_comp</a></div><div class="ttdeci">#define RhoQ4_comp</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:20</div></div>
<div class="ttc" id="aIndexDefines_8H_html_a49fe20d81f4d923a4a6ec4eb1652072b"><div class="ttname"><a href="IndexDefines_8H.html#a49fe20d81f4d923a4a6ec4eb1652072b">RhoQ3_comp</a></div><div class="ttdeci">#define RhoQ3_comp</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:19</div></div>
<div class="ttc" id="aIndexDefines_8H_html_aae057dae5f599b944184a0ecf7801064"><div class="ttname"><a href="IndexDefines_8H.html#aae057dae5f599b944184a0ecf7801064">RhoQ6_comp</a></div><div class="ttdeci">#define RhoQ6_comp</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:22</div></div>
<div class="ttc" id="aIndexDefines_8H_html_ac46d015fd5b1ee0060bbaf22e79113e7"><div class="ttname"><a href="IndexDefines_8H.html#ac46d015fd5b1ee0060bbaf22e79113e7">RhoQ5_comp</a></div><div class="ttdeci">#define RhoQ5_comp</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:21</div></div>
<div class="ttc" id="aMicrophysics__Utils_8H_html_a16a390366e7e68ca35fdac4cad824428"><div class="ttname"><a href="Microphysics__Utils_8H.html#a16a390366e7e68ca35fdac4cad824428">erf_esatw</a></div><div class="ttdeci">AMREX_GPU_HOST_DEVICE AMREX_FORCE_INLINE amrex::Real erf_esatw(amrex::Real t)</div><div class="ttdef"><b>Definition:</b> Microphysics_Utils.H:44</div></div>
<div class="ttc" id="aTerrainMetrics_8H_html_a2116df83b61a39fb50b9a2d7474c00d7"><div class="ttname"><a href="TerrainMetrics_8H.html#a2116df83b61a39fb50b9a2d7474c00d7">Compute_h_xi_AtIface</a></div><div class="ttdeci">AMREX_GPU_DEVICE AMREX_FORCE_INLINE amrex::Real Compute_h_xi_AtIface(const int &amp;i, const int &amp;j, const int &amp;k, const amrex::GpuArray&lt; amrex::Real, AMREX_SPACEDIM &gt; &amp;cellSizeInv, const amrex::Array4&lt; const amrex::Real &gt; &amp;z_nd)</div><div class="ttdef"><b>Definition:</b> TerrainMetrics.H:93</div></div>
<div class="ttc" id="aTerrainMetrics_8H_html_a8d96671d41364f1e24391375a2bc0f1e"><div class="ttname"><a href="TerrainMetrics_8H.html#a8d96671d41364f1e24391375a2bc0f1e">Compute_h_zeta_AtIface</a></div><div class="ttdeci">AMREX_GPU_DEVICE AMREX_FORCE_INLINE amrex::Real Compute_h_zeta_AtIface(const int &amp;i, const int &amp;j, const int &amp;k, const amrex::GpuArray&lt; amrex::Real, AMREX_SPACEDIM &gt; &amp;cellSizeInv, const amrex::Array4&lt; const amrex::Real &gt; &amp;z_nd)</div><div class="ttdef"><b>Definition:</b> TerrainMetrics.H:79</div></div>
<div class="ttc" id="aTerrainMetrics_8H_html_ada12bcb6beb3fa0d00dbdacb37f3c60f"><div class="ttname"><a href="TerrainMetrics_8H.html#ada12bcb6beb3fa0d00dbdacb37f3c60f">Compute_h_zeta_AtJface</a></div><div class="ttdeci">AMREX_GPU_DEVICE AMREX_FORCE_INLINE amrex::Real Compute_h_zeta_AtJface(const int &amp;i, const int &amp;j, const int &amp;k, const amrex::GpuArray&lt; amrex::Real, AMREX_SPACEDIM &gt; &amp;cellSizeInv, const amrex::Array4&lt; const amrex::Real &gt; &amp;z_nd)</div><div class="ttdef"><b>Definition:</b> TerrainMetrics.H:122</div></div>
<div class="ttc" id="aTerrainMetrics_8H_html_ae609a5c1f84347b66e9a8b712271c4ce"><div class="ttname"><a href="TerrainMetrics_8H.html#ae609a5c1f84347b66e9a8b712271c4ce">Compute_h_eta_AtJface</a></div><div class="ttdeci">AMREX_GPU_DEVICE AMREX_FORCE_INLINE amrex::Real Compute_h_eta_AtJface(const int &amp;i, const int &amp;j, const int &amp;k, const amrex::GpuArray&lt; amrex::Real, AMREX_SPACEDIM &gt; &amp;cellSizeInv, const amrex::Array4&lt; const amrex::Real &gt; &amp;z_nd)</div><div class="ttdef"><b>Definition:</b> TerrainMetrics.H:150</div></div>
<div class="ttc" id="aclassERF_html_a2dcd22cb915d923c687f60267f44542b"><div class="ttname"><a href="classERF.html#a2dcd22cb915d923c687f60267f44542b">ERF::PlotFileVarNames</a></div><div class="ttdeci">static amrex::Vector&lt; std::string &gt; PlotFileVarNames(amrex::Vector&lt; std::string &gt; plot_var_names)</div><div class="ttdef"><b>Definition:</b> Plotfile.cpp:131</div></div>
<div class="ttc" id="aclassERF_html_a898410553492b2add00a72374dcec6ba"><div class="ttname"><a href="classERF.html#a898410553492b2add00a72374dcec6ba">ERF::WriteMultiLevelPlotfileWithTerrain</a></div><div class="ttdeci">void WriteMultiLevelPlotfileWithTerrain(const std::string &amp;plotfilename, int nlevels, const amrex::Vector&lt; const amrex::MultiFab * &gt; &amp;mf, const amrex::Vector&lt; const amrex::MultiFab * &gt; &amp;mf_nd, const amrex::Vector&lt; std::string &gt; &amp;varnames, amrex::Real time, const amrex::Vector&lt; int &gt; &amp;level_steps, const std::string &amp;versionName=&quot;HyperCLaw-V1.1&quot;, const std::string &amp;levelPrefix=&quot;Level_&quot;, const std::string &amp;mfPrefix=&quot;Cell&quot;, const amrex::Vector&lt; std::string &gt; &amp;extra_dirs=amrex::Vector&lt; std::string &gt;()) const</div><div class="ttdef"><b>Definition:</b> Plotfile.cpp:1119</div></div>
<div class="ttc" id="aclassERF_html_aa2d8099655a8779836e63e3e98ea4372"><div class="ttname"><a href="classERF.html#aa2d8099655a8779836e63e3e98ea4372">ERF::writeJobInfo</a></div><div class="ttdeci">void writeJobInfo(const std::string &amp;dir) const</div><div class="ttdef"><b>Definition:</b> writeJobInfo.cpp:9</div></div>
<div class="ttc" id="aclassLandSurface_html_a61290767bd3f0bc65db7a0a344b10899"><div class="ttname"><a href="classLandSurface.html#a61290767bd3f0bc65db7a0a344b10899">LandSurface::Plot_Lsm_Data</a></div><div class="ttdeci">void Plot_Lsm_Data(amrex::Real time, const amrex::Vector&lt; int &gt; &amp;level_steps, const amrex::Vector&lt; amrex::IntVect &gt; &amp;ref_ratio)</div><div class="ttdef"><b>Definition:</b> LandSurface.H:80</div></div>
<div class="ttc" id="anamespaceEddyDiff_html_a7e7e94a6b49fe20d106a1ea7317d149ea0af64d676c5c6f4312eb892f9a7a46cd"><div class="ttname"><a href="namespaceEddyDiff.html#a7e7e94a6b49fe20d106a1ea7317d149ea0af64d676c5c6f4312eb892f9a7a46cd">EddyDiff::Theta_v</a></div><div class="ttdeci">@ Theta_v</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:128</div></div>
<div class="ttc" id="anamespaceEddyDiff_html_a7e7e94a6b49fe20d106a1ea7317d149ea2e96e6d5e84e7d7b9857e73159dfbe2b"><div class="ttname"><a href="namespaceEddyDiff.html#a7e7e94a6b49fe20d106a1ea7317d149ea2e96e6d5e84e7d7b9857e73159dfbe2b">EddyDiff::Mom_h</a></div><div class="ttdeci">@ Mom_h</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:121</div></div>
<div class="ttc" id="anamespaceEddyDiff_html_a7e7e94a6b49fe20d106a1ea7317d149ea61ed124b350a1b26da1bd26aebfa5f82"><div class="ttname"><a href="namespaceEddyDiff.html#a7e7e94a6b49fe20d106a1ea7317d149ea61ed124b350a1b26da1bd26aebfa5f82">EddyDiff::Mom_v</a></div><div class="ttdeci">@ Mom_v</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:127</div></div>
<div class="ttc" id="anamespaceEddyDiff_html_a7e7e94a6b49fe20d106a1ea7317d149ea6a553b28d62930bdda7b473e28464b73"><div class="ttname"><a href="namespaceEddyDiff.html#a7e7e94a6b49fe20d106a1ea7317d149ea6a553b28d62930bdda7b473e28464b73">EddyDiff::PBL_lengthscale</a></div><div class="ttdeci">@ PBL_lengthscale</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:133</div></div>
<div class="ttc" id="anamespaceEddyDiff_html_a7e7e94a6b49fe20d106a1ea7317d149ead0cfc6c50b43867895cbc2c02eb2b99a"><div class="ttname"><a href="namespaceEddyDiff.html#a7e7e94a6b49fe20d106a1ea7317d149ead0cfc6c50b43867895cbc2c02eb2b99a">EddyDiff::Theta_h</a></div><div class="ttdeci">@ Theta_h</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:122</div></div>
<div class="ttc" id="anamespaceMicVar__Kess_html_ad6f84c7e649afdd998b2f37ba87476beaf099273d19f4b8cdca199c5177231e35"><div class="ttname"><a href="namespaceMicVar__Kess.html#ad6f84c7e649afdd998b2f37ba87476beaf099273d19f4b8cdca199c5177231e35">MicVar_Kess::qv</a></div><div class="ttdeci">@ qv</div><div class="ttdef"><b>Definition:</b> Kessler.H:36</div></div>
<div class="ttc" id="anamespaceMicVar_html_a1609c4386a90fb1c27791fa3cd511fa8a40820295afd4707e596461de893e54ae"><div class="ttname"><a href="namespaceMicVar.html#a1609c4386a90fb1c27791fa3cd511fa8a40820295afd4707e596461de893e54ae">MicVar::omega</a></div><div class="ttdeci">@ omega</div><div class="ttdef"><b>Definition:</b> SAM.H:46</div></div>
<div class="ttc" id="anamespacederived_html_a7fb98e12fceaa6f691dfef83db453757"><div class="ttname"><a href="namespacederived.html#a7fb98e12fceaa6f691dfef83db453757">derived::erf_dernull</a></div><div class="ttdeci">void erf_dernull(const Box &amp;, FArrayBox &amp;, int, int, const FArrayBox &amp;, const Geometry &amp;, Real, const int *, const int)</div><div class="ttdef"><b>Definition:</b> Derive.cpp:39</div></div>
<div class="ttc" id="anamespacederived_html_a8d96f91847cec51636c122ab27a5f8a2"><div class="ttname"><a href="namespacederived.html#a8d96f91847cec51636c122ab27a5f8a2">derived::erf_dertemp</a></div><div class="ttdeci">void erf_dertemp(const Box &amp;bx, FArrayBox &amp;derfab, int, int, const FArrayBox &amp;datfab, const Geometry &amp;, Real, const int *, const int)</div><div class="ttdef"><b>Definition:</b> Derive.cpp:91</div></div>
<div class="ttc" id="anamespacederived_html_acc3f245c73a0826afc9e7626f12126d3"><div class="ttname"><a href="namespacederived.html#acc3f245c73a0826afc9e7626f12126d3">derived::erf_derKE</a></div><div class="ttdeci">void erf_derKE(const Box &amp;bx, FArrayBox &amp;derfab, int, int, const FArrayBox &amp;datfab, const Geometry &amp;, Real, const int *, const int)</div><div class="ttdef"><b>Definition:</b> Derive.cpp:163</div></div>
<div class="ttc" id="anamespacederived_html_ad3b06be920cca917ee17183db46d77ba"><div class="ttname"><a href="namespacederived.html#ad3b06be920cca917ee17183db46d77ba">derived::erf_derQKE</a></div><div class="ttdeci">void erf_derQKE(const Box &amp;bx, FArrayBox &amp;derfab, int, int, const FArrayBox &amp;datfab, const Geometry &amp;, Real, const int *, const int)</div><div class="ttdef"><b>Definition:</b> Derive.cpp:184</div></div>
<div class="ttc" id="anamespacederived_html_afe57e0f13e2e24c73d0ed373a9cd0d09"><div class="ttname"><a href="namespacederived.html#afe57e0f13e2e24c73d0ed373a9cd0d09">derived::erf_dersoundspeed</a></div><div class="ttdeci">void erf_dersoundspeed(const Box &amp;bx, FArrayBox &amp;derfab, int, int, const FArrayBox &amp;datfab, const Geometry &amp;, Real, const int *, const int)</div><div class="ttdef"><b>Definition:</b> Derive.cpp:58</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a0b0b4140e117163895e5e2c89a68d12a_cgraph.png" border="0" usemap="#aclassERF_a0b0b4140e117163895e5e2c89a68d12a_cgraph" alt=""/></div>
<map name="aclassERF_a0b0b4140e117163895e5e2c89a68d12a_cgraph" id="aclassERF_a0b0b4140e117163895e5e2c89a68d12a_cgraph">
<area shape="rect" title=" " alt="" coords="5,360,143,387"/>
<area shape="rect" href="TerrainMetrics_8H.html#ae609a5c1f84347b66e9a8b712271c4ce" title=" " alt="" coords="203,5,381,32"/>
<area shape="rect" href="TerrainMetrics_8H.html#a2116df83b61a39fb50b9a2d7474c00d7" title=" " alt="" coords="208,56,376,83"/>
<area shape="rect" href="TerrainMetrics_8H.html#a8d96671d41364f1e24391375a2bc0f1e" title=" " alt="" coords="200,107,384,133"/>
<area shape="rect" href="TerrainMetrics_8H.html#ada12bcb6beb3fa0d00dbdacb37f3c60f" title=" " alt="" coords="200,157,384,184"/>
<area shape="rect" href="Plotfile_8cpp.html#a1f8554e7b211b0acfc202e8a600e7d67" title=" " alt="" coords="211,208,373,235"/>
<area shape="rect" href="namespacederived.html#acc3f245c73a0826afc9e7626f12126d3" title=" " alt="" coords="221,259,363,285"/>
<area shape="rect" href="namespacederived.html#a7fb98e12fceaa6f691dfef83db453757" title=" " alt="" coords="217,309,367,336"/>
<area shape="rect" href="namespacederived.html#ad3b06be920cca917ee17183db46d77ba" title=" " alt="" coords="216,360,368,387"/>
<area shape="rect" href="namespacederived.html#a37560f4d3e2c7c10f64d41db2ce76a06" title=" " alt="" coords="210,411,374,437"/>
<area shape="rect" href="namespacederived.html#afe57e0f13e2e24c73d0ed373a9cd0d09" title=" " alt="" coords="191,512,393,539"/>
<area shape="rect" href="EOS_8H.html#a08354ab110fb9e873bce9250b4f4b46e" title=" " alt="" coords="479,537,590,564"/>
<area shape="rect" href="namespacederived.html#a8d96f91847cec51636c122ab27a5f8a2" title=" " alt="" coords="213,613,371,640"/>
<area shape="rect" href="EOS_8H.html#a65cf1718b7a1fcc56cb16685642543da" title=" " alt="" coords="463,639,607,665"/>
<area shape="rect" href="namespacederived.html#adc3c787125484205e4fc7cd85c25ab6c" title=" " alt="" coords="213,461,371,488"/>
<area shape="rect" href="Microphysics__Utils_8H.html#a16a390366e7e68ca35fdac4cad824428" title=" " alt="" coords="249,715,335,741"/>
<area shape="rect" href="namespacederived.html#a3786c6a8399bc2508bc129337c446af1" title=" " alt="" coords="441,385,628,412"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a86a0bc8e41668411ee0ab5801d4688a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86a0bc8e41668411ee0ab5801d4688a7">&#9670;&nbsp;</a></span>advflux_reg</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::YAFluxRegister*&gt; ERF::advflux_reg</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classERF.html#a4d6d990d8111c170692b1e9cc0e918b8">getAdvFluxReg()</a>.</p>

</div>
</div>
<a id="a4c1fae5e620fcd64cc9ede73715e3b7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c1fae5e620fcd64cc9ede73715e3b7c">&#9670;&nbsp;</a></span>base_state</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::MultiFab&gt; ERF::base_state</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a37b2a4257df8ff53d4450de47f16ace1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37b2a4257df8ff53d4450de47f16ace1">&#9670;&nbsp;</a></span>base_state_new</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::MultiFab&gt; ERF::base_state_new</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aab4575d8fb57595a2f1aaf088c60447a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab4575d8fb57595a2f1aaf088c60447a">&#9670;&nbsp;</a></span>bndry_output_planes_interval</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::bndry_output_planes_interval = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a5f99e949c83d86507e003ae556cf7c22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f99e949c83d86507e003ae556cf7c22">&#9670;&nbsp;</a></span>bndry_output_planes_per</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Real ERF::bndry_output_planes_per = -1.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a87e58f16f44a6cb35d6983ed3fe7d3c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87e58f16f44a6cb35d6983ed3fe7d3c1">&#9670;&nbsp;</a></span>bndry_output_planes_start_time</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Real ERF::bndry_output_planes_start_time = 0.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a050dbd236c9bf246554a53008e09f683"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a050dbd236c9bf246554a53008e09f683">&#9670;&nbsp;</a></span>boxes_at_level</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Vector&lt;amrex::Box&gt; &gt; ERF::boxes_at_level</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a2aa0f6b2edd9efd9b090e39db1effcdf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2aa0f6b2edd9efd9b090e39db1effcdf">&#9670;&nbsp;</a></span>cc_profiles</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool ERF::cc_profiles = true</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a1e3e2855b6e811596226c167573ad62d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e3e2855b6e811596226c167573ad62d">&#9670;&nbsp;</a></span>cf_set_width</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::cf_set_width {0}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ad9084179f7384e10a519989ffd51fd34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9084179f7384e10a519989ffd51fd34">&#9670;&nbsp;</a></span>cf_width</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::cf_width {0}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a89f605d1a1eae06a7c79f9b6b65c637f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89f605d1a1eae06a7c79f9b6b65c637f">&#9670;&nbsp;</a></span>cfl</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Real ERF::cfl = 0.8</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ae16d413b172bb3b3400af6d5cb236fd4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae16d413b172bb3b3400af6d5cb236fd4">&#9670;&nbsp;</a></span>change_max</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Real ERF::change_max = 1.1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ae701564fbe3da5bbd88587e5a08eca4e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae701564fbe3da5bbd88587e5a08eca4e">&#9670;&nbsp;</a></span>check_file</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ERF::check_file {&quot;chk&quot;}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a32e0d0f5ae0db18ee81f9d4325a14f64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a32e0d0f5ae0db18ee81f9d4325a14f64">&#9670;&nbsp;</a></span>check_type</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ERF::check_type {&quot;native&quot;}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a48bba6b1c1b39940b09aefbe56311e2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48bba6b1c1b39940b09aefbe56311e2f">&#9670;&nbsp;</a></span>column_file_name</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ERF::column_file_name = &quot;column_data.nc&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="afa0bef6d3146788302b81c0d4f4802d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa0bef6d3146788302b81c0d4f4802d1">&#9670;&nbsp;</a></span>column_interval</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::column_interval = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a930b7d48218b3fc41d8719b50b3f6086"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a930b7d48218b3fc41d8719b50b3f6086">&#9670;&nbsp;</a></span>column_loc_x</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Real ERF::column_loc_x = 0.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a2b911f3a5a324813b1ff4462df6044a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b911f3a5a324813b1ff4462df6044a6">&#9670;&nbsp;</a></span>column_loc_y</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Real ERF::column_loc_y = 0.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a7b0175190c6fcf829c7f2841f729b12a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b0175190c6fcf829c7f2841f729b12a">&#9670;&nbsp;</a></span>column_per</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Real ERF::column_per = -1.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="afd8cd5a477754776135befa668fdd0c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd8cd5a477754776135befa668fdd0c9">&#9670;&nbsp;</a></span>cons_names</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const amrex::Vector&lt;std::string&gt; ERF::cons_names</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">{<span class="stringliteral">&quot;density&quot;</span>, <span class="stringliteral">&quot;rhotheta&quot;</span>, <span class="stringliteral">&quot;rhoKE&quot;</span>, <span class="stringliteral">&quot;rhoQKE&quot;</span>, <span class="stringliteral">&quot;rhoadv_0&quot;</span>,</div>
<div class="line">                                                     <span class="stringliteral">&quot;rhoQ1&quot;</span>, <span class="stringliteral">&quot;rhoQ2&quot;</span>, <span class="stringliteral">&quot;rhoQ3&quot;</span>,</div>
<div class="line">                                                     <span class="stringliteral">&quot;rhoQ4&quot;</span>, <span class="stringliteral">&quot;rhoQ5&quot;</span>, <span class="stringliteral">&quot;rhoQ6&quot;</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a84cf7616e7b3928f08f4bd56112db01e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84cf7616e7b3928f08f4bd56112db01e">&#9670;&nbsp;</a></span>d_havg_density</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Gpu::DeviceVector&lt;amrex::Real&gt; ERF::d_havg_density</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a9a4f076c56f31fbb5e68c09706605a05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a4f076c56f31fbb5e68c09706605a05">&#9670;&nbsp;</a></span>d_havg_pressure</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Gpu::DeviceVector&lt;amrex::Real&gt; ERF::d_havg_pressure</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a8199cc1ec38b9dfd47262ccc7df6a941"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8199cc1ec38b9dfd47262ccc7df6a941">&#9670;&nbsp;</a></span>d_havg_qc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Gpu::DeviceVector&lt;amrex::Real&gt; ERF::d_havg_qc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a2b0085123e02051ac4c2a72e9972e6ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b0085123e02051ac4c2a72e9972e6ee">&#9670;&nbsp;</a></span>d_havg_qv</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Gpu::DeviceVector&lt;amrex::Real&gt; ERF::d_havg_qv</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a20350959b7b3e252ee3a802e7998ca8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20350959b7b3e252ee3a802e7998ca8d">&#9670;&nbsp;</a></span>d_havg_temperature</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Gpu::DeviceVector&lt;amrex::Real&gt; ERF::d_havg_temperature</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ad598bde8e728479faaa7c2820096b47a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad598bde8e728479faaa7c2820096b47a">&#9670;&nbsp;</a></span>d_rayleigh_ptrs</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Vector&lt;amrex::Gpu::DeviceVector&lt;amrex::Real&gt; &gt; &gt; ERF::d_rayleigh_ptrs</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a838687881ef3626f932d0e95ceff0e53"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a838687881ef3626f932d0e95ceff0e53">&#9670;&nbsp;</a></span>d_rhoqt_src</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Gpu::DeviceVector&lt;amrex::Real&gt; &gt; ERF::d_rhoqt_src</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a0c1fdcfbc9cbd6cb13e41d1170b161f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c1fdcfbc9cbd6cb13e41d1170b161f8">&#9670;&nbsp;</a></span>d_rhotheta_src</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Gpu::DeviceVector&lt;amrex::Real&gt; &gt; ERF::d_rhotheta_src</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ac94ddee2f501dbcea2a516284b7119b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac94ddee2f501dbcea2a516284b7119b5">&#9670;&nbsp;</a></span>d_w_subsid</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Gpu::DeviceVector&lt;amrex::Real&gt; &gt; ERF::d_w_subsid</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a1cade630b005dbcc0f644987ef3db287"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1cade630b005dbcc0f644987ef3db287">&#9670;&nbsp;</a></span>datalog</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;std::fstream&gt; &gt; ERF::datalog</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classERF.html#aa2c3ee1910008b828b9da79ccdfe3871">DataLog()</a>, <a class="el" href="classERF.html#ac1238c1616826c66df1dfd9076e6a3da">NumDataLogs()</a>, and <a class="el" href="classERF.html#a2486b49bb0d7917f812318822e42a03c">setRecordDataInfo()</a>.</p>

</div>
</div>
<a id="a9248a4eb025c2647e003f838cba52a21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9248a4eb025c2647e003f838cba52a21">&#9670;&nbsp;</a></span>datalogname</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::string&gt; ERF::datalogname</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classERF.html#a16e1f6b8bbb05ae738daf2abe626c159">DataLogName()</a>.</p>

</div>
</div>
<a id="a9fc0f6e6ca35036d2e3a36dd42e66435"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fc0f6e6ca35036d2e3a36dd42e66435">&#9670;&nbsp;</a></span>derived_names</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const amrex::Vector&lt;std::string&gt; ERF::derived_names</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">{<span class="stringliteral">&quot;soundspeed&quot;</span>, <span class="stringliteral">&quot;temp&quot;</span>, <span class="stringliteral">&quot;theta&quot;</span>, <span class="stringliteral">&quot;KE&quot;</span>, <span class="stringliteral">&quot;QKE&quot;</span>, <span class="stringliteral">&quot;scalar&quot;</span>,</div>
<div class="line">                                                    <span class="stringliteral">&quot;pres_hse&quot;</span>, <span class="stringliteral">&quot;dens_hse&quot;</span>, <span class="stringliteral">&quot;pressure&quot;</span>, <span class="stringliteral">&quot;pert_pres&quot;</span>, <span class="stringliteral">&quot;pert_dens&quot;</span>, <span class="stringliteral">&quot;eq_pot_temp&quot;</span>,</div>
<div class="line">                                                    <span class="stringliteral">&quot;dpdx&quot;</span>, <span class="stringliteral">&quot;dpdy&quot;</span>, <span class="stringliteral">&quot;pres_hse_x&quot;</span>, <span class="stringliteral">&quot;pres_hse_y&quot;</span>,</div>
<div class="line">                                                    <span class="stringliteral">&quot;z_phys&quot;</span>, <span class="stringliteral">&quot;detJ&quot;</span> , <span class="stringliteral">&quot;mapfac&quot;</span>,</div>
<div class="line">                                                    </div>
<div class="line">                                                    <span class="stringliteral">&quot;Kmv&quot;</span>,<span class="stringliteral">&quot;Kmh&quot;</span>,</div>
<div class="line">                                                    </div>
<div class="line">                                                    <span class="stringliteral">&quot;Khv&quot;</span>,<span class="stringliteral">&quot;Khh&quot;</span>,</div>
<div class="line">                                                    </div>
<div class="line">                                                    <span class="stringliteral">&quot;Lpbl&quot;</span>,</div>
<div class="line">                                                    </div>
<div class="line">                                                    <span class="stringliteral">&quot;qt&quot;</span>, <span class="stringliteral">&quot;qv&quot;</span>, <span class="stringliteral">&quot;qc&quot;</span>, <span class="stringliteral">&quot;qi&quot;</span>, <span class="stringliteral">&quot;qp&quot;</span>, <span class="stringliteral">&quot;qrain&quot;</span>, <span class="stringliteral">&quot;qsnow&quot;</span>, <span class="stringliteral">&quot;qgraup&quot;</span>, <span class="stringliteral">&quot;rain_accum&quot;</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">                                                   }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a30f8b851ed29d38695d44cff257f14e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30f8b851ed29d38695d44cff257f14e6">&#9670;&nbsp;</a></span>detJ_cc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::detJ_cc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ae39bf64c5306b1dd939d82d9df728daa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae39bf64c5306b1dd939d82d9df728daa">&#9670;&nbsp;</a></span>detJ_cc_new</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::detJ_cc_new</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a9a411e0ea9d9bdbfab957c8081229091"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a411e0ea9d9bdbfab957c8081229091">&#9670;&nbsp;</a></span>detJ_cc_src</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::detJ_cc_src</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ae5968f1bed602fa87cdd5cb7905b7e5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5968f1bed602fa87cdd5cb7905b7e5e">&#9670;&nbsp;</a></span>domain_bc_type</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Array&lt;std::string,2*AMREX_SPACEDIM&gt; ERF::domain_bc_type</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a574521986a6e403159f83c8b8123ba90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a574521986a6e403159f83c8b8123ba90">&#9670;&nbsp;</a></span>domain_bcs_type</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::BCRec&gt; ERF::domain_bcs_type</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a8a99e22b1111c803e31b4afd5fcdea60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a99e22b1111c803e31b4afd5fcdea60">&#9670;&nbsp;</a></span>domain_bcs_type_d</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Gpu::DeviceVector&lt;amrex::BCRec&gt; ERF::domain_bcs_type_d</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ad34bae243fdb6c3029f5abe4fb4bca2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad34bae243fdb6c3029f5abe4fb4bca2d">&#9670;&nbsp;</a></span>dt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Real&gt; ERF::dt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a3cf7cb2e51eb7b69cb4079ffc6722459"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3cf7cb2e51eb7b69cb4079ffc6722459">&#9670;&nbsp;</a></span>dt_mri_ratio</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;long&gt; ERF::dt_mri_ratio</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a0656573ffb79f0fda8d02d5ea0482ed2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0656573ffb79f0fda8d02d5ea0482ed2">&#9670;&nbsp;</a></span>dz_min</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real ERF::dz_min</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a327d704704abd516be19339cb2d226f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a327d704704abd516be19339cb2d226f9">&#9670;&nbsp;</a></span>eddyDiffs_lev</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::eddyDiffs_lev</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a83c244120a15f0d9b9bca54e93976428"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83c244120a15f0d9b9bca54e93976428">&#9670;&nbsp;</a></span>fine_mask</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::MultiFab ERF::fine_mask</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="acd88606a88916719171a267e9edf54c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd88606a88916719171a267e9edf54c7">&#9670;&nbsp;</a></span>fixed_dt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Real ERF::fixed_dt = -1.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a20f8ed606dd006f84efa4ebed7b96130"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20f8ed606dd006f84efa4ebed7b96130">&#9670;&nbsp;</a></span>fixed_fast_dt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Real ERF::fixed_fast_dt = -1.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ad2e1a979c0ad68e87eaee349beb7e9fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2e1a979c0ad68e87eaee349beb7e9fd">&#9670;&nbsp;</a></span>fixed_mri_dt_ratio</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::fixed_mri_dt_ratio = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a34160ca20fb400ee285664117cb80512"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34160ca20fb400ee285664117cb80512">&#9670;&nbsp;</a></span>FPr_c</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;<a class="el" href="classERFFillPatcher.html">ERFFillPatcher</a>&gt; ERF::FPr_c</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a0ef3455d5b4fc9a178e023b233d389a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ef3455d5b4fc9a178e023b233d389a4">&#9670;&nbsp;</a></span>FPr_u</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;<a class="el" href="classERFFillPatcher.html">ERFFillPatcher</a>&gt; ERF::FPr_u</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a1dc7086aec533a042e6033706845b0c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1dc7086aec533a042e6033706845b0c3">&#9670;&nbsp;</a></span>FPr_v</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;<a class="el" href="classERFFillPatcher.html">ERFFillPatcher</a>&gt; ERF::FPr_v</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ac9a11403c2238d0d1e7b65b2d100dbaf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9a11403c2238d0d1e7b65b2d100dbaf">&#9670;&nbsp;</a></span>FPr_w</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;<a class="el" href="classERFFillPatcher.html">ERFFillPatcher</a>&gt; ERF::FPr_w</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a4dd7c603e65d230105a4f1e0afb4cf8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4dd7c603e65d230105a4f1e0afb4cf8a">&#9670;&nbsp;</a></span>h_havg_density</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Real&gt; ERF::h_havg_density</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a413293737b0021c97b50c62756561446"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a413293737b0021c97b50c62756561446">&#9670;&nbsp;</a></span>h_havg_pressure</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Real&gt; ERF::h_havg_pressure</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a45233bcc95ac50c112b7146595164a8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45233bcc95ac50c112b7146595164a8d">&#9670;&nbsp;</a></span>h_havg_qc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Real&gt; ERF::h_havg_qc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ae8de26569516b41e5dc3cbb3419e891c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8de26569516b41e5dc3cbb3419e891c">&#9670;&nbsp;</a></span>h_havg_qv</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Real&gt; ERF::h_havg_qv</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a9683c7b07c287e57856ee5a9c99917a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9683c7b07c287e57856ee5a9c99917a1">&#9670;&nbsp;</a></span>h_havg_temperature</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Real&gt; ERF::h_havg_temperature</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ad9939824ea7b7d06ab252fed28d5a911"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9939824ea7b7d06ab252fed28d5a911">&#9670;&nbsp;</a></span>h_rayleigh_ptrs</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Vector&lt; amrex::Vector&lt;amrex::Real&gt; &gt; &gt; ERF::h_rayleigh_ptrs</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a3c5eca26a28dda3a981b3581abadfca0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c5eca26a28dda3a981b3581abadfca0">&#9670;&nbsp;</a></span>h_rhoqt_src</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt; amrex::Vector&lt;amrex::Real&gt; &gt; ERF::h_rhoqt_src</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a87aad7caaf3b575734994b47628a2faf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87aad7caaf3b575734994b47628a2faf">&#9670;&nbsp;</a></span>h_rhotheta_src</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt; amrex::Vector&lt;amrex::Real&gt; &gt; ERF::h_rhotheta_src</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a1a5d0d0b4e8c196f56dfab98f245aff5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a5d0d0b4e8c196f56dfab98f245aff5">&#9670;&nbsp;</a></span>h_w_subsid</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt; amrex::Vector&lt;amrex::Real&gt; &gt; ERF::h_w_subsid</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ad353aa9e275612ff2110c5a1405c1176"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad353aa9e275612ff2110c5a1405c1176">&#9670;&nbsp;</a></span>init_shrink</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Real ERF::init_shrink = 1.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a2eb81c590271b429f132103c9af25830"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2eb81c590271b429f132103c9af25830">&#9670;&nbsp;</a></span>init_sounding_ideal</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool ERF::init_sounding_ideal = false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="af5ac3d88a33a1a284bcc120ce0599cf7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5ac3d88a33a1a284bcc120ce0599cf7">&#9670;&nbsp;</a></span>init_type</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ERF::init_type</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a80ad08512968ec45635df68abe66b1fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80ad08512968ec45635df68abe66b1fc">&#9670;&nbsp;</a></span>input_bndry_planes</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::input_bndry_planes = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a83572d8dfad51158945b4a5ab06b2f72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83572d8dfad51158945b4a5ab06b2f72">&#9670;&nbsp;</a></span>input_sounding_data</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structInputSoundingData.html">InputSoundingData</a> ERF::input_sounding_data</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a536424e14c4139e4683b15c59e742362"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a536424e14c4139e4683b15c59e742362">&#9670;&nbsp;</a></span>input_sounding_file</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ERF::input_sounding_file = &quot;input_sounding&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aefa640a036c25b7b770e88a5f838eb2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aefa640a036c25b7b770e88a5f838eb2a">&#9670;&nbsp;</a></span>istep</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;int&gt; ERF::istep</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a02722d16f3c26efe590702200f1296d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02722d16f3c26efe590702200f1296d7">&#9670;&nbsp;</a></span>last_check_file_step</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::last_check_file_step</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a7d54d3f2317d06a8dfcde4f65cfc3e92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d54d3f2317d06a8dfcde4f65cfc3e92">&#9670;&nbsp;</a></span>last_plot_file_step_1</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::last_plot_file_step_1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a09017292c9943ac2ed20ce7ed5c3c767"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09017292c9943ac2ed20ce7ed5c3c767">&#9670;&nbsp;</a></span>last_plot_file_step_2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::last_plot_file_step_2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a3f3e29874221e43e13e2a431e77e0e4e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f3e29874221e43e13e2a431e77e0e4e">&#9670;&nbsp;</a></span>lmask_lev</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Vector&lt;std::unique_ptr&lt;amrex::iMultiFab&gt; &gt; &gt; ERF::lmask_lev</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ae0e9a78f120ba632d78cbf23c97b851c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0e9a78f120ba632d78cbf23c97b851c">&#9670;&nbsp;</a></span>lsm</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classLandSurface.html">LandSurface</a> ERF::lsm</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ad03da3399e893728741fac33100ce476"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad03da3399e893728741fac33100ce476">&#9670;&nbsp;</a></span>lsm_data</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Vector&lt;amrex::MultiFab*&gt; &gt; ERF::lsm_data</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aa5f6a6ceae0087393f386649d8bbbc31"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5f6a6ceae0087393f386649d8bbbc31">&#9670;&nbsp;</a></span>lsm_flux</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Vector&lt;amrex::MultiFab*&gt; &gt; ERF::lsm_flux</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a199add69cee34c6611a5dc9ee965971c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a199add69cee34c6611a5dc9ee965971c">&#9670;&nbsp;</a></span>m_bc_extdir_vals</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Array&lt;amrex::Array&lt;amrex::Real, AMREX_SPACEDIM*2&gt;, AMREX_SPACEDIM+<a class="el" href="IndexDefines_8H.html#a46e292b965f80d15acfbdc11ffe1e0f0">NVAR_max</a>&gt; ERF::m_bc_extdir_vals</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a69ea003766c97b1a667b002b3661f0f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69ea003766c97b1a667b002b3661f0f2">&#9670;&nbsp;</a></span>m_bc_neumann_vals</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Array&lt;amrex::Array&lt;amrex::Real, AMREX_SPACEDIM*2&gt;, AMREX_SPACEDIM+<a class="el" href="IndexDefines_8H.html#a46e292b965f80d15acfbdc11ffe1e0f0">NVAR_max</a>&gt; ERF::m_bc_neumann_vals</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a69a3f925e95ec4244b0257f9de16d65a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69a3f925e95ec4244b0257f9de16d65a">&#9670;&nbsp;</a></span>m_check_int</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::m_check_int = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a5fbf17cfc8d9e5b994783e05ec3594b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5fbf17cfc8d9e5b994783e05ec3594b2">&#9670;&nbsp;</a></span>m_check_per</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real ERF::m_check_per = -1.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a051364b2373d8d86151c0b4a958035bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a051364b2373d8d86151c0b4a958035bd">&#9670;&nbsp;</a></span>m_most</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classABLMost.html">ABLMost</a>&gt; ERF::m_most = nullptr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a57cfb4bfead8525174646964992c7e69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57cfb4bfead8525174646964992c7e69">&#9670;&nbsp;</a></span>m_plot_int_1</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::m_plot_int_1 = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ad3311c9ceacd17f34bdb5e03cefa33b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3311c9ceacd17f34bdb5e03cefa33b3">&#9670;&nbsp;</a></span>m_plot_int_2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::m_plot_int_2 = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a3167adc9518cce649a90ab82e9f9c85d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3167adc9518cce649a90ab82e9f9c85d">&#9670;&nbsp;</a></span>m_plot_per_1</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real ERF::m_plot_per_1 = -1.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aff879a9c686293a10a3a03027b765c51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff879a9c686293a10a3a03027b765c51">&#9670;&nbsp;</a></span>m_plot_per_2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real ERF::m_plot_per_2 = -1.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="addf62bfc534515447b94e928ac0b7135"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addf62bfc534515447b94e928ac0b7135">&#9670;&nbsp;</a></span>m_r2d</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classReadBndryPlanes.html">ReadBndryPlanes</a>&gt; ERF::m_r2d = nullptr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aa53035f34ba133b86172e180abda4209"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa53035f34ba133b86172e180abda4209">&#9670;&nbsp;</a></span>m_w2d</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classWriteBndryPlanes.html">WriteBndryPlanes</a>&gt; ERF::m_w2d = nullptr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a23aacdb72e9d2dfed8e2ebd2c2526497"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23aacdb72e9d2dfed8e2ebd2c2526497">&#9670;&nbsp;</a></span>mapfac_m</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::mapfac_m</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a1e8afee1508b720dab56f5d044deb301"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e8afee1508b720dab56f5d044deb301">&#9670;&nbsp;</a></span>mapfac_u</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::mapfac_u</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ae49b5055f9a7117fa15918a5daa775b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae49b5055f9a7117fa15918a5daa775b7">&#9670;&nbsp;</a></span>mapfac_v</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::mapfac_v</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a9108040a44e5e64853ac7d6529538315"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9108040a44e5e64853ac7d6529538315">&#9670;&nbsp;</a></span>max_k_at_level</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;int&gt; ERF::max_k_at_level</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a0634154e8e58379c495c3e7fe7c5e4d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0634154e8e58379c495c3e7fe7c5e4d6">&#9670;&nbsp;</a></span>max_step</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::max_step = std::numeric_limits&lt;int&gt;::max()</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a4b7277d54649219f31fe286eee9d415a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b7277d54649219f31fe286eee9d415a">&#9670;&nbsp;</a></span>micro</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classMicrophysics.html">Microphysics</a>&gt; ERF::micro</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a46a3587ddcfacba35dcf52189cc1be86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46a3587ddcfacba35dcf52189cc1be86">&#9670;&nbsp;</a></span>min_k_at_level</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;int&gt; ERF::min_k_at_level</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a09d0fb2bd609c898a665d9530a744585"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09d0fb2bd609c898a665d9530a744585">&#9670;&nbsp;</a></span>mri_integrator_mem</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;<a class="el" href="classMRISplitIntegrator.html">MRISplitIntegrator</a>&lt;amrex::Vector&lt;amrex::MultiFab&gt; &gt; &gt; &gt; ERF::mri_integrator_mem</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a7e9040f32464f1a6dee6e0384393451d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e9040f32464f1a6dee6e0384393451d">&#9670;&nbsp;</a></span>nc_bdy_file</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ERF::nc_bdy_file</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a7ef14f6028b577eba70aef46b508be19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ef14f6028b577eba70aef46b508be19">&#9670;&nbsp;</a></span>nc_init_file</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Vector&lt; Vector&lt; std::string &gt; &gt; ERF::nc_init_file = {{&quot;&quot;}}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="addf0fb2aae0efaa649c69685a4dcca83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addf0fb2aae0efaa649c69685a4dcca83">&#9670;&nbsp;</a></span>ng_dens_hse</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::ng_dens_hse</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a87dc6c0720462bfd088c909289cdca0b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87dc6c0720462bfd088c909289cdca0b">&#9670;&nbsp;</a></span>ng_pres_hse</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::ng_pres_hse</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aa3db2dd1b65310c66c4038650c22aaee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3db2dd1b65310c66c4038650c22aaee">&#9670;&nbsp;</a></span>nsubsteps</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;int&gt; ERF::nsubsteps</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a8e6f53a430ed3842f51fd569b908fa28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e6f53a430ed3842f51fd569b908fa28">&#9670;&nbsp;</a></span>Nturb</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::MultiFab&gt; ERF::Nturb</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="adcd9f23975ffa605247b41d391c2a2f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adcd9f23975ffa605247b41d391c2a2f0">&#9670;&nbsp;</a></span>num_boxes_at_level</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;int&gt; ERF::num_boxes_at_level</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a610a988f46e0496e6dbd0471ae817f75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a610a988f46e0496e6dbd0471ae817f75">&#9670;&nbsp;</a></span>num_files_at_level</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;int&gt; ERF::num_files_at_level</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ad17ff2753e754ff3eb1330612b820b5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad17ff2753e754ff3eb1330612b820b5f">&#9670;&nbsp;</a></span>output_1d_column</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::output_1d_column = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a7c448670f7a5cadd6fe56f7e615c9eb6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c448670f7a5cadd6fe56f7e615c9eb6">&#9670;&nbsp;</a></span>output_bndry_planes</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::output_bndry_planes = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ae6df94c25ac21bf6a2e856a9901e3a15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6df94c25ac21bf6a2e856a9901e3a15">&#9670;&nbsp;</a></span>phys_bc_type</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::GpuArray&lt;<a class="el" href="IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9">ERF_BC</a>, AMREX_SPACEDIM*2&gt; ERF::phys_bc_type</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a2e9b04043853d25f2d76edbc0bed2e72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e9b04043853d25f2d76edbc0bed2e72">&#9670;&nbsp;</a></span>physbcs_cons</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;<a class="el" href="classERFPhysBCFunct__cons.html">ERFPhysBCFunct_cons</a>&gt; &gt; ERF::physbcs_cons</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a64e55e5ae9df06433146db657eb9e72e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64e55e5ae9df06433146db657eb9e72e">&#9670;&nbsp;</a></span>physbcs_u</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;<a class="el" href="classERFPhysBCFunct__u.html">ERFPhysBCFunct_u</a>&gt; &gt; ERF::physbcs_u</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a79231b5cfd4576a742e46ae0082b5121"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79231b5cfd4576a742e46ae0082b5121">&#9670;&nbsp;</a></span>physbcs_v</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;<a class="el" href="classERFPhysBCFunct__v.html">ERFPhysBCFunct_v</a>&gt; &gt; ERF::physbcs_v</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a45c8ecd777f47732993777a0afb8e140"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45c8ecd777f47732993777a0afb8e140">&#9670;&nbsp;</a></span>physbcs_w</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;<a class="el" href="classERFPhysBCFunct__w.html">ERFPhysBCFunct_w</a>&gt; &gt; ERF::physbcs_w</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a4d717bb9fe936fd1a124d0d3e720f9d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d717bb9fe936fd1a124d0d3e720f9d1">&#9670;&nbsp;</a></span>physbcs_w_no_terrain</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;<a class="el" href="classERFPhysBCFunct__w__no__terrain.html">ERFPhysBCFunct_w_no_terrain</a>&gt; &gt; ERF::physbcs_w_no_terrain</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aa54aaa938a18d34caa4d86e977647899"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa54aaa938a18d34caa4d86e977647899">&#9670;&nbsp;</a></span>plot_file_1</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ERF::plot_file_1 {&quot;plt_1_&quot;}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a18fa84b06132715757d97ec38678aa2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18fa84b06132715757d97ec38678aa2c">&#9670;&nbsp;</a></span>plot_file_2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ERF::plot_file_2 {&quot;plt_2_&quot;}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="adc00038dfe4c332e5d15f621184c69e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc00038dfe4c332e5d15f621184c69e8">&#9670;&nbsp;</a></span>plot_file_on_restart</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::plot_file_on_restart = 1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="afc653b103aa26c56acafed85cdd95f52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc653b103aa26c56acafed85cdd95f52">&#9670;&nbsp;</a></span>plot_lsm</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool ERF::plot_lsm = false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a6865cf87abbb5aab0db00ff3b1ce94ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6865cf87abbb5aab0db00ff3b1ce94ac">&#9670;&nbsp;</a></span>plot_var_names_1</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::string&gt; ERF::plot_var_names_1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a79705c02d6f25fbdcec14ca2432e5da1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79705c02d6f25fbdcec14ca2432e5da1">&#9670;&nbsp;</a></span>plot_var_names_2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::string&gt; ERF::plot_var_names_2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ae7b9991150042eb38e2abc89399c0c7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7b9991150042eb38e2abc89399c0c7c">&#9670;&nbsp;</a></span>plotfile_type</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ERF::plotfile_type = &quot;amrex&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a59df30e7a5537c8543bb00772bd98b58"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59df30e7a5537c8543bb00772bd98b58">&#9670;&nbsp;</a></span>pp_prefix</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string ERF::pp_prefix {&quot;erf&quot;}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a1f412097e565c23acb4c17c67db10e22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f412097e565c23acb4c17c67db10e22">&#9670;&nbsp;</a></span>previousCPUTimeUsed</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Real ERF::previousCPUTimeUsed = 0.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classERF.html#ae0597da6edf955cd138e52fd00380ff2">getCPUTime()</a>.</p>

</div>
</div>
<a id="a60e8cb933f237903e3fbcd6376c26db0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60e8cb933f237903e3fbcd6376c26db0">&#9670;&nbsp;</a></span>prob</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classProblemBase.html">ProblemBase</a>&gt; ERF::prob = nullptr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a633cd0b44d2e38f02c23e953aecd69eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a633cd0b44d2e38f02c23e953aecd69eb">&#9670;&nbsp;</a></span>profile_int</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::profile_int = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ae00126a9c2738bf6a6cbbe77321c9cfc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae00126a9c2738bf6a6cbbe77321c9cfc">&#9670;&nbsp;</a></span>qmoist</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Vector&lt;amrex::MultiFab*&gt; &gt; ERF::qmoist</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a521d1faf157e3bccc86c0f26ee923576"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a521d1faf157e3bccc86c0f26ee923576">&#9670;&nbsp;</a></span>Qv_prim</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::Qv_prim</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="acab120bb9324e7298534d765c447d703"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acab120bb9324e7298534d765c447d703">&#9670;&nbsp;</a></span>real_set_width</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::real_set_width {0}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="abb15119348ad5399947bc8883084b230"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb15119348ad5399947bc8883084b230">&#9670;&nbsp;</a></span>real_width</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::real_width {0}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ac81b3dfd7c6f21ba8479834e2ff1e652"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac81b3dfd7c6f21ba8479834e2ff1e652">&#9670;&nbsp;</a></span>ref_tags</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Vector&lt; AMRErrorTag &gt; ERF::ref_tags</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a3937527f96c81674fa38dc34ed24f3f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3937527f96c81674fa38dc34ed24f3f5">&#9670;&nbsp;</a></span>regrid_int</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::regrid_int = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a8e758060d3dede9694fbfcabddc17169"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e758060d3dede9694fbfcabddc17169">&#9670;&nbsp;</a></span>restart_chkfile</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ERF::restart_chkfile = &quot;&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a30a0b9e3a037c71580d1feb3b30a8258"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30a0b9e3a037c71580d1feb3b30a8258">&#9670;&nbsp;</a></span>restart_type</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ERF::restart_type {&quot;native&quot;}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a01f3db32272f53dc68025f0a98195e57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01f3db32272f53dc68025f0a98195e57">&#9670;&nbsp;</a></span>rU_new</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::MultiFab&gt; ERF::rU_new</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a6eecc44323f77917c95869928284f61d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6eecc44323f77917c95869928284f61d">&#9670;&nbsp;</a></span>rU_old</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::MultiFab&gt; ERF::rU_old</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a54e37988486ef96e55e84bd8e91bb688"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54e37988486ef96e55e84bd8e91bb688">&#9670;&nbsp;</a></span>rV_new</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::MultiFab&gt; ERF::rV_new</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aeb64e3b4def989ce68d873aefeed5e0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb64e3b4def989ce68d873aefeed5e0e">&#9670;&nbsp;</a></span>rV_old</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::MultiFab&gt; ERF::rV_old</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aa46c0b0d20525aed10f447923e54dde7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa46c0b0d20525aed10f447923e54dde7">&#9670;&nbsp;</a></span>rW_new</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::MultiFab&gt; ERF::rW_new</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ac1fa56ec90f44e3cdf487af46804163f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1fa56ec90f44e3cdf487af46804163f">&#9670;&nbsp;</a></span>rW_old</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::MultiFab&gt; ERF::rW_old</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a0fa1582bb13357895d2aba91b695624a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0fa1582bb13357895d2aba91b695624a">&#9670;&nbsp;</a></span>sampleline</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::IntVect&gt; ERF::sampleline</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classERF.html#a70d78ca624acf09d8faab9a2d51264d9">NumSampleLines()</a>, and <a class="el" href="classERF.html#a54357e2f81f3d7d3a9189a3e21283e6b">SampleLine()</a>.</p>

</div>
</div>
<a id="a4990f1796b65ec8ee602f177a66afc3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4990f1796b65ec8ee602f177a66afc3e">&#9670;&nbsp;</a></span>samplelinelog</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;std::fstream&gt; &gt; ERF::samplelinelog</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classERF.html#a14f922bdc3a0f23c087afa32c67ac119">NumSampleLineLogs()</a>, <a class="el" href="classERF.html#aa559426d0435e669b04148c58b20caef">SampleLineLog()</a>, and <a class="el" href="classERF.html#ae1a8856961aaee53016122facba03dbe">setRecordSampleLineInfo()</a>.</p>

</div>
</div>
<a id="a0553967f1131860bb8ecb47c0f192eaa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0553967f1131860bb8ecb47c0f192eaa">&#9670;&nbsp;</a></span>samplelinelogname</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::string&gt; ERF::samplelinelogname</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classERF.html#a59eae161173111d66e88dc3acc65b552">SampleLineLogName()</a>.</p>

</div>
</div>
<a id="ae8a57b7fbf5a67c99d04b7d4f43ad100"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8a57b7fbf5a67c99d04b7d4f43ad100">&#9670;&nbsp;</a></span>samplepoint</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::IntVect&gt; ERF::samplepoint</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classERF.html#a5bc7dd2c7e1ebf65b7dc1d9bf0dfb36f">NumSamplePoints()</a>, and <a class="el" href="classERF.html#a9095d1b641b4d7f32ca5acb679786891">SamplePoint()</a>.</p>

</div>
</div>
<a id="a9737ddb0de6b9e8a5b17c109d5ad3e08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9737ddb0de6b9e8a5b17c109d5ad3e08">&#9670;&nbsp;</a></span>sampleptlog</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;std::fstream&gt; &gt; ERF::sampleptlog</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classERF.html#a41324a4b5610fde725fe721550b23c85">NumSamplePointLogs()</a>, <a class="el" href="classERF.html#af5f6c32cc5463e52901f21117d3156c7">SamplePointLog()</a>, and <a class="el" href="classERF.html#af8d930dce1b926ecc3bdc6787dd47818">setRecordSamplePointInfo()</a>.</p>

</div>
</div>
<a id="a8fbfa8bb47c0a3b53e244081aa1e8ad3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8fbfa8bb47c0a3b53e244081aa1e8ad3">&#9670;&nbsp;</a></span>sampleptlogname</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::string&gt; ERF::sampleptlogname</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classERF.html#aa87242f053bfae4efb2a7698ef417ab9">SamplePointLogName()</a>.</p>

</div>
</div>
<a id="a6e1ad417e3bd062468d74830b65911fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e1ad417e3bd062468d74830b65911fb">&#9670;&nbsp;</a></span>SFS_diss_lev</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::SFS_diss_lev</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a25174b4ae6cfcac8f7d183ce5c9fe67b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25174b4ae6cfcac8f7d183ce5c9fe67b">&#9670;&nbsp;</a></span>SFS_hfx1_lev</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::SFS_hfx1_lev</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="acb607b2e675b45fdcabc09b640ce5ae2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb607b2e675b45fdcabc09b640ce5ae2">&#9670;&nbsp;</a></span>SFS_hfx2_lev</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::SFS_hfx2_lev</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a1a2e3faf5dd90ad2f9ded28b486f3b46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a2e3faf5dd90ad2f9ded28b486f3b46">&#9670;&nbsp;</a></span>SFS_hfx3_lev</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::SFS_hfx3_lev</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a9faaa96a7c270d2b2b062d9f30f19711"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9faaa96a7c270d2b2b062d9f30f19711">&#9670;&nbsp;</a></span>SmnSmn_lev</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::SmnSmn_lev</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a32dd48049e8acbe95decdd4b01b782c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a32dd48049e8acbe95decdd4b01b782c4">&#9670;&nbsp;</a></span>solverChoice</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structSolverChoice.html">SolverChoice</a> ERF::solverChoice</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a5a5395054a212d8f3fc577562c14b66e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a5395054a212d8f3fc577562c14b66e">&#9670;&nbsp;</a></span>sst_lev</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; &gt; ERF::sst_lev</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aa0c07f31b23d977646b8161e5473fab5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0c07f31b23d977646b8161e5473fab5">&#9670;&nbsp;</a></span>start_time</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real ERF::start_time = 0.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a6d00e1cb76bfbcbada173e092b6accf3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d00e1cb76bfbcbada173e092b6accf3">&#9670;&nbsp;</a></span>startCPUTime</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Real ERF::startCPUTime = 0.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classERF.html#ae0597da6edf955cd138e52fd00380ff2">getCPUTime()</a>.</p>

</div>
</div>
<a id="a405556a52bef334ab68294c1a540e107"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a405556a52bef334ab68294c1a540e107">&#9670;&nbsp;</a></span>stop_time</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real ERF::stop_time = std::numeric_limits&lt;amrex::Real&gt;::max()</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a5232e98479611a24fe97994640c61faa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5232e98479611a24fe97994640c61faa">&#9670;&nbsp;</a></span>sum_interval</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::sum_interval = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a1cf2ba396f4404724824516da4c4a084"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1cf2ba396f4404724824516da4c4a084">&#9670;&nbsp;</a></span>sum_per</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Real ERF::sum_per = -1.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a65741b6379d273c19a25cf48bb947614"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65741b6379d273c19a25cf48bb947614">&#9670;&nbsp;</a></span>t_new</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Real&gt; ERF::t_new</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a7085d7d5fc94a0f84efc06957267d58e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7085d7d5fc94a0f84efc06957267d58e">&#9670;&nbsp;</a></span>t_old</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Real&gt; ERF::t_old</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aeb9348353b2415d023d8f52c293cad7e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb9348353b2415d023d8f52c293cad7e">&#9670;&nbsp;</a></span>Tau11_lev</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::Tau11_lev</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ad8c2eca71737b102cc5cf75f97c6bd63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8c2eca71737b102cc5cf75f97c6bd63">&#9670;&nbsp;</a></span>Tau12_lev</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::Tau12_lev</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a5392e6104804d799b3fd943dfe390766"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5392e6104804d799b3fd943dfe390766">&#9670;&nbsp;</a></span>Tau13_lev</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::Tau13_lev</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a547864dc0347f4620feb99ed564acb4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a547864dc0347f4620feb99ed564acb4d">&#9670;&nbsp;</a></span>Tau21_lev</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::Tau21_lev</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="afb4294f848d86e4aefb74848bb71047e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb4294f848d86e4aefb74848bb71047e">&#9670;&nbsp;</a></span>Tau22_lev</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::Tau22_lev</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a03a4ad7368c1c98b492cd9d9fec9cbc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03a4ad7368c1c98b492cd9d9fec9cbc5">&#9670;&nbsp;</a></span>Tau23_lev</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::Tau23_lev</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a203e7334296218672e36bab93174e146"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a203e7334296218672e36bab93174e146">&#9670;&nbsp;</a></span>Tau31_lev</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::Tau31_lev</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aa650bf1f6885b179fd8d4c24b48668cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa650bf1f6885b179fd8d4c24b48668cb">&#9670;&nbsp;</a></span>Tau32_lev</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::Tau32_lev</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a60a185c47f07bf4fb537a15d5a226d8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60a185c47f07bf4fb537a15d5a226d8a">&#9670;&nbsp;</a></span>Tau33_lev</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::Tau33_lev</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a71629ae2fda396472198691b75d83b2e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71629ae2fda396472198691b75d83b2e">&#9670;&nbsp;</a></span>Theta_prim</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::Theta_prim</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a86208285bf705f360a3c318a75097f61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86208285bf705f360a3c318a75097f61">&#9670;&nbsp;</a></span>use_real_bcs</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool ERF::use_real_bcs</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a47c13e4cf7d4bd9b7b2be81886619fd9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47c13e4cf7d4bd9b7b2be81886619fd9">&#9670;&nbsp;</a></span>vars_fitch</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::MultiFab&gt; ERF::vars_fitch</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a1204ca4dc5d79f5da191ffbe09dfab9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1204ca4dc5d79f5da191ffbe09dfab9b">&#9670;&nbsp;</a></span>vars_new</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Vector&lt;amrex::MultiFab&gt; &gt; ERF::vars_new</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classMultiBlockContainer.html#a92e9b71087c94076b01f13b6cb6fcec5">MultiBlockContainer::FillPatchBlocks()</a>, <a class="el" href="classMultiBlockContainer.html#a154697509fae9c842b83ede2d30b7060">MultiBlockContainer::SetBlockCommMetaData()</a>, and <a class="el" href="classMultiBlockContainer.html#a6965a65ae5ef2533298b274797b5d8c7">MultiBlockContainer::SetBoxLists()</a>.</p>

</div>
</div>
<a id="af31e928baa970a1507dfb0233b352542"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af31e928baa970a1507dfb0233b352542">&#9670;&nbsp;</a></span>vars_old</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Vector&lt;amrex::MultiFab&gt; &gt; ERF::vars_old</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a43d0b17f6e155691a1e9474526df3af5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43d0b17f6e155691a1e9474526df3af5">&#9670;&nbsp;</a></span>verbose</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::verbose = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a31be0f1ae705c52c8ccc520369013284"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31be0f1ae705c52c8ccc520369013284">&#9670;&nbsp;</a></span>z_phys_cc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::z_phys_cc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a93e63e5af35efa564fd4195e8703f84c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93e63e5af35efa564fd4195e8703f84c">&#9670;&nbsp;</a></span>z_phys_nd</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::z_phys_nd</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a4ef635c22e72c715f5703a6b95a7abe5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ef635c22e72c715f5703a6b95a7abe5">&#9670;&nbsp;</a></span>z_phys_nd_new</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::z_phys_nd_new</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a30dcf40e8f104fb6b6132805d2eff47c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30dcf40e8f104fb6b6132805d2eff47c">&#9670;&nbsp;</a></span>z_phys_nd_src</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::z_phys_nd_src</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a72a59614c6d5ab840b924c84d5682270"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72a59614c6d5ab840b924c84d5682270">&#9670;&nbsp;</a></span>z_t_rk</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::z_t_rk</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a7a4d6e7887fa8f30c33a0b8899035ddb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a4d6e7887fa8f30c33a0b8899035ddb">&#9670;&nbsp;</a></span>zlevels_stag</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Real&gt; ERF::zlevels_stag</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>Source/<a class="el" href="ERF_8H_source.html">ERF.H</a></li>
<li>Source/BoundaryConditions/<a class="el" href="BoundaryConditions__bndryreg_8cpp.html">BoundaryConditions_bndryreg.cpp</a></li>
<li>Source/BoundaryConditions/<a class="el" href="ERF__FillPatch_8cpp.html">ERF_FillPatch.cpp</a></li>
<li>Source/<a class="el" href="ERF_8cpp.html">ERF.cpp</a></li>
<li>Source/<a class="el" href="ERF__make__new__level_8cpp.html">ERF_make_new_level.cpp</a></li>
<li>Source/<a class="el" href="ERF__Tagging_8cpp.html">ERF_Tagging.cpp</a></li>
<li>Source/Initialization/<a class="el" href="ERF__init1d_8cpp.html">ERF_init1d.cpp</a></li>
<li>Source/Initialization/<a class="el" href="ERF__init__bcs_8cpp.html">ERF_init_bcs.cpp</a></li>
<li>Source/Initialization/<a class="el" href="ERF__init__custom_8cpp.html">ERF_init_custom.cpp</a></li>
<li>Source/Initialization/<a class="el" href="ERF__init__from__hse_8cpp.html">ERF_init_from_hse.cpp</a></li>
<li>Source/Initialization/<a class="el" href="ERF__init__from__input__sounding_8cpp.html">ERF_init_from_input_sounding.cpp</a></li>
<li>Source/Initialization/<a class="el" href="ERF__init__uniform_8cpp.html">ERF_init_uniform.cpp</a></li>
<li>Source/IO/<a class="el" href="Checkpoint_8cpp.html">Checkpoint.cpp</a></li>
<li>Source/IO/<a class="el" href="console__io_8cpp.html">console_io.cpp</a></li>
<li>Source/IO/<a class="el" href="ERF__Write1DProfiles_8cpp.html">ERF_Write1DProfiles.cpp</a></li>
<li>Source/IO/<a class="el" href="ERF__Write1DProfiles__stag_8cpp.html">ERF_Write1DProfiles_stag.cpp</a></li>
<li>Source/IO/<a class="el" href="ERF__WriteScalarProfiles_8cpp.html">ERF_WriteScalarProfiles.cpp</a></li>
<li>Source/IO/<a class="el" href="Plotfile_8cpp.html">Plotfile.cpp</a></li>
<li>Source/IO/<a class="el" href="writeJobInfo_8cpp.html">writeJobInfo.cpp</a></li>
<li>Source/TimeIntegration/<a class="el" href="ERF__Advance_8cpp.html">ERF_Advance.cpp</a></li>
<li>Source/TimeIntegration/<a class="el" href="ERF__advance__dycore_8cpp.html">ERF_advance_dycore.cpp</a></li>
<li>Source/TimeIntegration/<a class="el" href="ERF__advance__lsm_8cpp.html">ERF_advance_lsm.cpp</a></li>
<li>Source/TimeIntegration/<a class="el" href="ERF__advance__microphysics_8cpp.html">ERF_advance_microphysics.cpp</a></li>
<li>Source/TimeIntegration/<a class="el" href="ERF__ComputeTimestep_8cpp.html">ERF_ComputeTimestep.cpp</a></li>
<li>Source/TimeIntegration/<a class="el" href="ERF__TimeStep_8cpp.html">ERF_TimeStep.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classERF.html">ERF</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
