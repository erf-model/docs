<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ERF: ERF Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ERF
   </div>
   <div id="projectbrief">Energy Research and Forecasting: An Atmospheric Modeling Code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('classERF.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-static-methods">Static Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="#pri-static-attribs">Static Private Attributes</a> &#124;
<a href="classERF-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">ERF Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="ERF_8H_source.html">ERF.H</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for ERF:</div>
<div class="dyncontent">
<div class="center"><img src="classERF__inherit__graph.png" border="0" usemap="#ERF_inherit__map" alt="Inheritance graph"/></div>
<map name="ERF_inherit__map" id="ERF_inherit__map">
<area shape="rect" title=" " alt="" coords="47,80,93,107"/>
<area shape="rect" title=" " alt="" coords="5,5,135,32"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for ERF:</div>
<div class="dyncontent">
<div class="center"><img src="classERF__coll__graph.png" border="0" usemap="#ERF_coll__map" alt="Collaboration graph"/></div>
<map name="ERF_coll__map" id="ERF_coll__map">
<area shape="rect" title=" " alt="" coords="1485,1795,1532,1821"/>
<area shape="rect" title=" " alt="" coords="1121,117,1251,144"/>
<area shape="rect" title=" " alt="" coords="1083,1375,1289,1401"/>
<area shape="rect" href="classABLMost.html" title=" " alt="" coords="751,1717,830,1744"/>
<area shape="rect" href="classABLMostData.html" title=" " alt="" coords="345,1536,456,1563"/>
<area shape="rect" title=" " alt="" coords="49,829,100,856"/>
<area shape="rect" href="classReadBndryPlanes.html" title=" " alt="" coords="723,1229,859,1256"/>
<area shape="rect" href="structSolverChoice.html" title=" " alt="" coords="737,2115,844,2141"/>
<area shape="rect" href="structInputSoundingData.html" title=" " alt="" coords="717,407,864,433"/>
<area shape="rect" title=" " alt="" coords="297,1613,505,1640"/>
<area shape="rect" title=" " alt="" coords="342,1664,459,1691"/>
<area shape="rect" title=" " alt="" coords="296,1715,505,1741"/>
<area shape="rect" title="STL class." alt="" coords="712,1307,869,1333"/>
<area shape="rect" title=" " alt="" coords="1083,1277,1289,1318"/>
<area shape="rect" title=" " alt="" coords="1083,1186,1289,1227"/>
<area shape="rect" title=" " alt="" coords="381,1461,420,1488"/>
<area shape="rect" title=" " alt="" coords="1099,1889,1273,1945"/>
<area shape="rect" title=" " alt="" coords="357,1359,444,1385"/>
<area shape="rect" title=" " alt="" coords="316,1293,485,1334"/>
<area shape="rect" title=" " alt="" coords="321,560,480,587"/>
<area shape="rect" href="classWriteBndryPlanes.html" title=" " alt="" coords="721,929,860,956"/>
<area shape="rect" title=" " alt="" coords="361,1068,440,1095"/>
<area shape="rect" title=" " alt="" coords="381,1765,420,1792"/>
<area shape="rect" title=" " alt="" coords="315,675,487,701"/>
<area shape="rect" title="STL class." alt="" coords="357,1411,444,1437"/>
<area shape="rect" title="STL class." alt="" coords="5,1990,144,2031"/>
<area shape="rect" title=" " alt="" coords="345,935,456,961"/>
<area shape="rect" title=" " alt="" coords="1101,1970,1271,2011"/>
<area shape="rect" title=" " alt="" coords="1093,2035,1279,2106"/>
<area shape="rect" title=" " alt="" coords="1125,2131,1247,2157"/>
<area shape="rect" title=" " alt="" coords="1073,2181,1299,2208"/>
<area shape="rect" title=" " alt="" coords="1101,2233,1271,2274"/>
<area shape="rect" title=" " alt="" coords="1100,2298,1272,2339"/>
<area shape="rect" title=" " alt="" coords="289,884,512,911"/>
<area shape="rect" title=" " alt="" coords="310,2026,491,2067"/>
<area shape="rect" title=" " alt="" coords="363,2092,438,2119"/>
<area shape="rect" title=" " alt="" coords="363,2143,438,2169"/>
<area shape="rect" title=" " alt="" coords="375,2413,426,2440"/>
<area shape="rect" title=" " alt="" coords="343,2193,458,2220"/>
<area shape="rect" title=" " alt="" coords="352,2244,449,2271"/>
<area shape="rect" title=" " alt="" coords="342,2295,459,2321"/>
<area shape="rect" title=" " alt="" coords="1103,2363,1269,2405"/>
<area shape="rect" title=" " alt="" coords="318,307,483,349"/>
<area shape="rect" title=" " alt="" coords="1147,2429,1225,2456"/>
<area shape="rect" title=" " alt="" coords="1068,2480,1304,2507"/>
<area shape="rect" title=" " alt="" coords="1101,2531,1271,2573"/>
<area shape="rect" title=" " alt="" coords="1095,2597,1277,2638"/>
<area shape="rect" title=" " alt="" coords="1101,2662,1271,2703"/>
<area shape="rect" title=" " alt="" coords="1093,2728,1279,2755"/>
<area shape="rect" title=" " alt="" coords="1101,2779,1271,2821"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a30129012dd367825e5e4fd1406694f58"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a30129012dd367825e5e4fd1406694f58">ERF</a> ()</td></tr>
<tr class="separator:a30129012dd367825e5e4fd1406694f58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9980a8792a2ab137ad7c9121a5cf58bf"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a9980a8792a2ab137ad7c9121a5cf58bf">~ERF</a> ()</td></tr>
<tr class="separator:a9980a8792a2ab137ad7c9121a5cf58bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0be12798b46f52fa4b5a995f147c3f96"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a0be12798b46f52fa4b5a995f147c3f96">Evolve</a> ()</td></tr>
<tr class="separator:a0be12798b46f52fa4b5a995f147c3f96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18e6dbbf968b4492e78aa427791620f4"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a18e6dbbf968b4492e78aa427791620f4">ErrorEst</a> (int lev, amrex::TagBoxArray &amp;tags, amrex::Real time, int ngrow) override</td></tr>
<tr class="separator:a18e6dbbf968b4492e78aa427791620f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5d585e110291969767013a515719224"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ad5d585e110291969767013a515719224">InitData</a> ()</td></tr>
<tr class="separator:ad5d585e110291969767013a515719224"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80981e20939a6a38ba17478da2253ff1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a80981e20939a6a38ba17478da2253ff1">init_only</a> (int lev, amrex::Real time)</td></tr>
<tr class="separator:a80981e20939a6a38ba17478da2253ff1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a530d2ce59e6fd46e9fb00e4d11eaf737"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a530d2ce59e6fd46e9fb00e4d11eaf737">restart</a> ()</td></tr>
<tr class="separator:a530d2ce59e6fd46e9fb00e4d11eaf737"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58f6683aff0fbe6949bfe8b49275a8b3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a58f6683aff0fbe6949bfe8b49275a8b3">post_timestep</a> (int nstep, amrex::Real time, amrex::Real dt_lev)</td></tr>
<tr class="separator:a58f6683aff0fbe6949bfe8b49275a8b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a922892a05ee0c5bccd210a3e5a8599e1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a922892a05ee0c5bccd210a3e5a8599e1">sum_integrated_quantities</a> (amrex::Real time)</td></tr>
<tr class="separator:a922892a05ee0c5bccd210a3e5a8599e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cdc63885e5fec54f89cdcaffcbdc188"><td class="memItemLeft" align="right" valign="top">amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a2cdc63885e5fec54f89cdcaffcbdc188">volWgtSumMF</a> (int lev, const amrex::MultiFab &amp;mf, int comp, bool local, bool finemask)</td></tr>
<tr class="separator:a2cdc63885e5fec54f89cdcaffcbdc188"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4c61fad53912d1e8d0f774d365bcf0f"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ad4c61fad53912d1e8d0f774d365bcf0f">is_it_time_for_action</a> (int nstep, amrex::Real time, amrex::Real <a class="el" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>, int action_interval, amrex::Real action_per)</td></tr>
<tr class="separator:ad4c61fad53912d1e8d0f774d365bcf0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb6175c28b36d23f5dda2994ca4a85e7"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#abb6175c28b36d23f5dda2994ca4a85e7">MakeNewLevelFromCoarse</a> (int lev, amrex::Real time, const amrex::BoxArray &amp;ba, const amrex::DistributionMapping &amp;dm) override</td></tr>
<tr class="separator:abb6175c28b36d23f5dda2994ca4a85e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae7a3a76e08e54c618cf79b30ed2d73d"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aae7a3a76e08e54c618cf79b30ed2d73d">RemakeLevel</a> (int lev, amrex::Real time, const amrex::BoxArray &amp;ba, const amrex::DistributionMapping &amp;dm) override</td></tr>
<tr class="separator:aae7a3a76e08e54c618cf79b30ed2d73d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac44e400a7ce68e18fa44e9416cb1344e"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ac44e400a7ce68e18fa44e9416cb1344e">ClearLevel</a> (int lev) override</td></tr>
<tr class="separator:ac44e400a7ce68e18fa44e9416cb1344e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf10bbf8c9a5dbc257a88c4c1b650fee"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aaf10bbf8c9a5dbc257a88c4c1b650fee">MakeNewLevelFromScratch</a> (int lev, amrex::Real time, const amrex::BoxArray &amp;ba, const amrex::DistributionMapping &amp;dm) override</td></tr>
<tr class="separator:aaf10bbf8c9a5dbc257a88c4c1b650fee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b1d727e63de2e49aa4f8e00b0dda1d5"><td class="memItemLeft" align="right" valign="top">amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a6b1d727e63de2e49aa4f8e00b0dda1d5">estTimeStep</a> (int lev, long &amp;dt_fast_ratio) const</td></tr>
<tr class="separator:a6b1d727e63de2e49aa4f8e00b0dda1d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3151f4f965fcd44456952f69a9c28fc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aa3151f4f965fcd44456952f69a9c28fc">erf_advance</a> (int level, amrex::MultiFab &amp;cons_old, amrex::MultiFab &amp;cons_new, amrex::MultiFab &amp;xvel_old, amrex::MultiFab &amp;yvel_old, amrex::MultiFab &amp;zvel_old, amrex::MultiFab &amp;xvel_new, amrex::MultiFab &amp;yvel_new, amrex::MultiFab &amp;zvel_new, amrex::MultiFab &amp;xmom_crse, amrex::MultiFab &amp;ymom_crse, amrex::MultiFab &amp;zmom_crse, amrex::MultiFab &amp;source, std::array&lt; amrex::MultiFab, AMREX_SPACEDIM &gt; &amp;flux, const amrex::Geometry fine_geom, const amrex::Real <a class="el" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>, const amrex::Real time, amrex::InterpFaceRegister *ifr, const amrex::Real *dptr_dens_hse, const amrex::Real *dptr_pres_hse, const amrex::Real *dptr_rayleigh_tau, const amrex::Real *dptr_rayleigh_ubar, const amrex::Real *dptr_rayleigh_vbar, const amrex::Real *dptr_rayleigh_thetabar)</td></tr>
<tr class="separator:aa3151f4f965fcd44456952f69a9c28fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a419ba9adca32073e70aae4a8fe8cfcee"><td class="memItemLeft" align="right" valign="top">amrex::MultiFab &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a419ba9adca32073e70aae4a8fe8cfcee">build_fine_mask</a> (int lev)</td></tr>
<tr class="separator:a419ba9adca32073e70aae4a8fe8cfcee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01987b2556834788694f2f3741a2afe4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a01987b2556834788694f2f3741a2afe4">MakeHorizontalAverages</a> ()</td></tr>
<tr class="separator:a01987b2556834788694f2f3741a2afe4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6fd6592c50f03c55ca0f0c9137c7e48"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aa6fd6592c50f03c55ca0f0c9137c7e48">init_from_input_sounding</a> (const amrex::Box &amp;bx, amrex::Array4&lt; amrex::Real &gt; const &amp;state, amrex::Array4&lt; amrex::Real &gt; const &amp;x_vel, amrex::Array4&lt; amrex::Real &gt; const &amp;y_vel, amrex::Array4&lt; amrex::Real &gt; const &amp;z_vel, amrex::GeometryData const &amp;geomdata, <a class="el" href="structInputSoundingData.html">InputSoundingData</a> const &amp;inputSoundingData)</td></tr>
<tr class="separator:aa6fd6592c50f03c55ca0f0c9137c7e48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abed910c4bcc14524b3c1a7d353d40de5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#abed910c4bcc14524b3c1a7d353d40de5">WritePlotFile</a> ()</td></tr>
<tr class="separator:abed910c4bcc14524b3c1a7d353d40de5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae994c0e7f0d87b787de9bb971f0da64c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ae994c0e7f0d87b787de9bb971f0da64c">erf_enforce_hse</a> (int lev, amrex::Vector&lt; amrex::Real &gt; &amp;dens, amrex::Vector&lt; amrex::Real &gt; &amp;pres)</td></tr>
<tr class="separator:ae994c0e7f0d87b787de9bb971f0da64c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2d8099655a8779836e63e3e98ea4372"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aa2d8099655a8779836e63e3e98ea4372">writeJobInfo</a> (const std::string &amp;dir) const</td></tr>
<tr class="separator:aa2d8099655a8779836e63e3e98ea4372"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:ae6afed5b3a72ca80ccf0d791b08516aa"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ae6afed5b3a72ca80ccf0d791b08516aa">writeBuildInfo</a> (std::ostream &amp;os)</td></tr>
<tr class="separator:ae6afed5b3a72ca80ccf0d791b08516aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a2d39cd3bdc3d90609ad3b14e266d190a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a2d39cd3bdc3d90609ad3b14e266d190a">ReadParameters</a> ()</td></tr>
<tr class="separator:a2d39cd3bdc3d90609ad3b14e266d190a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8202de1f8f372e3e6fdc483447c6a55f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a8202de1f8f372e3e6fdc483447c6a55f">AverageDown</a> ()</td></tr>
<tr class="separator:a8202de1f8f372e3e6fdc483447c6a55f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7261c4eb7722af0dfe6cdfb8e2e9e4db"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a7261c4eb7722af0dfe6cdfb8e2e9e4db">init1DArrays</a> ()</td></tr>
<tr class="separator:a7261c4eb7722af0dfe6cdfb8e2e9e4db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a618e8fdff3239cc79d4145d02b1ecaa2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a618e8fdff3239cc79d4145d02b1ecaa2">init_bcs</a> ()</td></tr>
<tr class="separator:a618e8fdff3239cc79d4145d02b1ecaa2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40ebca562ac79fcc9250e17e0f4a5b41"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a40ebca562ac79fcc9250e17e0f4a5b41">AverageDownTo</a> (int crse_lev)</td></tr>
<tr class="separator:a40ebca562ac79fcc9250e17e0f4a5b41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d8f63f2178b1cb5ba78a433ece34e1c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a3d8f63f2178b1cb5ba78a433ece34e1c">FillPatch</a> (int lev, amrex::Real time, amrex::Vector&lt; amrex::MultiFab &gt; &amp;mf)</td></tr>
<tr class="separator:a3d8f63f2178b1cb5ba78a433ece34e1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17edcb4fd8fa664054acdbcfa0f7d9a3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a17edcb4fd8fa664054acdbcfa0f7d9a3">FillIntermediatePatch</a> (int lev, amrex::Real time, amrex::Vector&lt; std::reference_wrapper&lt; amrex::MultiFab &gt; &gt; mfs, bool rho_only=false)</td></tr>
<tr class="separator:a17edcb4fd8fa664054acdbcfa0f7d9a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ba9c9e09efe07e5f2404be80a9af5d2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a7ba9c9e09efe07e5f2404be80a9af5d2">FillCoarsePatch</a> (int lev, amrex::Real time, amrex::MultiFab &amp;mf, int icomp, int ncomp, int var_idx)</td></tr>
<tr class="separator:a7ba9c9e09efe07e5f2404be80a9af5d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a252eec287326f8dcc72dee7f3cc105c4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a252eec287326f8dcc72dee7f3cc105c4">FillCoarsePatchAllVars</a> (int lev, amrex::Real time, amrex::Vector&lt; amrex::MultiFab &gt; &amp;vmf)</td></tr>
<tr class="separator:a252eec287326f8dcc72dee7f3cc105c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92248817d31fce8771fba3532d819421"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structTimeInterpolatedData.html">TimeInterpolatedData</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a92248817d31fce8771fba3532d819421">GetDataAtTime</a> (int lev, amrex::Real time)</td></tr>
<tr class="separator:a92248817d31fce8771fba3532d819421"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff397ccf7eb99c51d7c705a35e85ec5f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aff397ccf7eb99c51d7c705a35e85ec5f">timeStep</a> (int lev, amrex::Real time, int iteration)</td></tr>
<tr class="separator:aff397ccf7eb99c51d7c705a35e85ec5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47413fe5588f7dd71a1d5087a9e804f9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a47413fe5588f7dd71a1d5087a9e804f9">Advance</a> (int lev, amrex::Real time, amrex::Real dt_lev, int iteration, int ncycle)</td></tr>
<tr class="separator:a47413fe5588f7dd71a1d5087a9e804f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92c020bfaa43e40fb5ffc449427a0318"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a92c020bfaa43e40fb5ffc449427a0318">initHSE</a> ()</td></tr>
<tr class="memdesc:a92c020bfaa43e40fb5ffc449427a0318"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize HSE.  <a href="classERF.html#a92c020bfaa43e40fb5ffc449427a0318">More...</a><br /></td></tr>
<tr class="separator:a92c020bfaa43e40fb5ffc449427a0318"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a039a764a1d942c484e8aea49e87bc046"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a039a764a1d942c484e8aea49e87bc046">initRayleigh</a> ()</td></tr>
<tr class="memdesc:a039a764a1d942c484e8aea49e87bc046"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize Rayleigh damping profiles.  <a href="classERF.html#a039a764a1d942c484e8aea49e87bc046">More...</a><br /></td></tr>
<tr class="separator:a039a764a1d942c484e8aea49e87bc046"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62a5ed3c3806eaa918257e0ad1382df5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a62a5ed3c3806eaa918257e0ad1382df5">ComputeDt</a> ()</td></tr>
<tr class="separator:a62a5ed3c3806eaa918257e0ad1382df5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54f6c5d799e51521ad10bb57d29d0c44"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a54f6c5d799e51521ad10bb57d29d0c44">PlotFileName</a> (int lev) const</td></tr>
<tr class="separator:a54f6c5d799e51521ad10bb57d29d0c44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e2f504a37e9b721618d135030c7ae04"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a7e2f504a37e9b721618d135030c7ae04">PlotFileVarNames</a> () const</td></tr>
<tr class="separator:a7e2f504a37e9b721618d135030c7ae04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef40b8ba6cb32fe3b11b8d9381f16cef"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aef40b8ba6cb32fe3b11b8d9381f16cef">setPlotVariables</a> ()</td></tr>
<tr class="separator:aef40b8ba6cb32fe3b11b8d9381f16cef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad101fd46096db2d6b21544bfede6551f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ad101fd46096db2d6b21544bfede6551f">WriteCheckpointFile</a> () const</td></tr>
<tr class="separator:ad101fd46096db2d6b21544bfede6551f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af285247b24b173cd851fe49799d17f42"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#af285247b24b173cd851fe49799d17f42">ReadCheckpointFile</a> ()</td></tr>
<tr class="separator:af285247b24b173cd851fe49799d17f42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e1874d47d95c7c858c2a2336fd0eee6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a2e1874d47d95c7c858c2a2336fd0eee6">InitializeFromFile</a> ()</td></tr>
<tr class="separator:a2e1874d47d95c7c858c2a2336fd0eee6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a914f576acc2d1a54203a220cce10df62"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a914f576acc2d1a54203a220cce10df62">InitializeLevelFromData</a> (int lev, const amrex::MultiFab &amp;initial_data)</td></tr>
<tr class="separator:a914f576acc2d1a54203a220cce10df62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae41b0a6d3d44d8f07fbcef60143e6bad"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ae41b0a6d3d44d8f07fbcef60143e6bad">post_update</a> (amrex::MultiFab &amp;state_mf, const amrex::Real time, const amrex::Geometry &amp;geom)</td></tr>
<tr class="separator:ae41b0a6d3d44d8f07fbcef60143e6bad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18cd93c567c9ca162e07433ed7345608"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a18cd93c567c9ca162e07433ed7345608">fill_rhs</a> (amrex::MultiFab &amp;rhs_mf, const amrex::MultiFab &amp;state_mf, const amrex::Real time, const amrex::Geometry &amp;geom)</td></tr>
<tr class="separator:a18cd93c567c9ca162e07433ed7345608"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67da556b4b4cbdc891da06eb5e17aac8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a67da556b4b4cbdc891da06eb5e17aac8">setupABLMost</a> (int lev)</td></tr>
<tr class="separator:a67da556b4b4cbdc891da06eb5e17aac8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa90c9756f684404f8b69b8a23568b535"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aa90c9756f684404f8b69b8a23568b535">refinement_criteria_setup</a> ()</td></tr>
<tr class="separator:aa90c9756f684404f8b69b8a23568b535"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f5b892bf373e46ae54597683e0f9685"><td class="memItemLeft" align="right" valign="top">AMREX_FORCE_INLINE int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a0f5b892bf373e46ae54597683e0f9685">ComputeGhostCells</a> (const int &amp;spatial_order)</td></tr>
<tr class="separator:a0f5b892bf373e46ae54597683e0f9685"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd3cbffc97b8a89e58042e029c5c6b7c"><td class="memItemLeft" align="right" valign="top">AMREX_FORCE_INLINE amrex::FluxRegister &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#afd3cbffc97b8a89e58042e029c5c6b7c">get_flux_reg</a> (int lev)</td></tr>
<tr class="separator:afd3cbffc97b8a89e58042e029c5c6b7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2c3ee1910008b828b9da79ccdfe3871"><td class="memItemLeft" align="right" valign="top">AMREX_FORCE_INLINE std::ostream &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aa2c3ee1910008b828b9da79ccdfe3871">DataLog</a> (int i)</td></tr>
<tr class="separator:aa2c3ee1910008b828b9da79ccdfe3871"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1238c1616826c66df1dfd9076e6a3da"><td class="memItemLeft" align="right" valign="top">AMREX_FORCE_INLINE int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ac1238c1616826c66df1dfd9076e6a3da">NumDataLogs</a> () noexcept</td></tr>
<tr class="separator:ac1238c1616826c66df1dfd9076e6a3da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cafd68de724845533efea8d284aacb4"><td class="memItemLeft" align="right" valign="top">amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a5cafd68de724845533efea8d284aacb4">getCPUTime</a> () const</td></tr>
<tr class="separator:a5cafd68de724845533efea8d284aacb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2486b49bb0d7917f812318822e42a03c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a2486b49bb0d7917f812318822e42a03c">setRecordDataInfo</a> (int i, const std::string &amp;filename)</td></tr>
<tr class="separator:a2486b49bb0d7917f812318822e42a03c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbf411b8cb24554d9aad7c76b0210e92"><td class="memItemLeft" align="right" valign="top">const std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#afbf411b8cb24554d9aad7c76b0210e92">DataLogName</a> (int i) const noexcept</td></tr>
<tr class="memdesc:afbf411b8cb24554d9aad7c76b0210e92"><td class="mdescLeft">&#160;</td><td class="mdescRight">The filename of the ith datalog file.  <a href="classERF.html#afbf411b8cb24554d9aad7c76b0210e92">More...</a><br /></td></tr>
<tr class="separator:afbf411b8cb24554d9aad7c76b0210e92"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-methods"></a>
Static Private Member Functions</h2></td></tr>
<tr class="memitem:aaee255b031e63bd9b5807f6612739dbd"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aaee255b031e63bd9b5807f6612739dbd">GotoNextLine</a> (std::istream &amp;is)</td></tr>
<tr class="separator:aaee255b031e63bd9b5807f6612739dbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a83572d8dfad51158945b4a5ab06b2f72"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structInputSoundingData.html">InputSoundingData</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a83572d8dfad51158945b4a5ab06b2f72">input_sounding_data</a></td></tr>
<tr class="separator:a83572d8dfad51158945b4a5ab06b2f72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35360b65d1afd233a6e6461938fa4522"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::FArrayBox &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a35360b65d1afd233a6e6461938fa4522">bdy_data_xlo</a></td></tr>
<tr class="separator:a35360b65d1afd233a6e6461938fa4522"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ac5b4b865dc8a029812bf1a20cd9b9b"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::FArrayBox &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a4ac5b4b865dc8a029812bf1a20cd9b9b">bdy_data_xhi</a></td></tr>
<tr class="separator:a4ac5b4b865dc8a029812bf1a20cd9b9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21e2e459ae54d580e40f0ffdbcdc68a4"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::FArrayBox &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a21e2e459ae54d580e40f0ffdbcdc68a4">bdy_data_ylo</a></td></tr>
<tr class="separator:a21e2e459ae54d580e40f0ffdbcdc68a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa1c7e25ca002544fc80dcea620bda8d"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::FArrayBox &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aaa1c7e25ca002544fc80dcea620bda8d">bdy_data_yhi</a></td></tr>
<tr class="separator:aaa1c7e25ca002544fc80dcea620bda8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcd9f23975ffa605247b41d391c2a2f0"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#adcd9f23975ffa605247b41d391c2a2f0">num_boxes_at_level</a></td></tr>
<tr class="separator:adcd9f23975ffa605247b41d391c2a2f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a050dbd236c9bf246554a53008e09f683"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Vector&lt; amrex::Box &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a050dbd236c9bf246554a53008e09f683">boxes_at_level</a></td></tr>
<tr class="separator:a050dbd236c9bf246554a53008e09f683"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefa640a036c25b7b770e88a5f838eb2a"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a></td></tr>
<tr class="separator:aefa640a036c25b7b770e88a5f838eb2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3db2dd1b65310c66c4038650c22aaee"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aa3db2dd1b65310c66c4038650c22aaee">nsubsteps</a></td></tr>
<tr class="separator:aa3db2dd1b65310c66c4038650c22aaee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65741b6379d273c19a25cf48bb947614"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a></td></tr>
<tr class="separator:a65741b6379d273c19a25cf48bb947614"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7085d7d5fc94a0f84efc06957267d58e"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a7085d7d5fc94a0f84efc06957267d58e">t_old</a></td></tr>
<tr class="separator:a7085d7d5fc94a0f84efc06957267d58e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad34bae243fdb6c3029f5abe4fb4bca2d"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a></td></tr>
<tr class="separator:ad34bae243fdb6c3029f5abe4fb4bca2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3cf7cb2e51eb7b69cb4079ffc6722459"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; long &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a3cf7cb2e51eb7b69cb4079ffc6722459">dt_mri_ratio</a></td></tr>
<tr class="separator:a3cf7cb2e51eb7b69cb4079ffc6722459"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1204ca4dc5d79f5da191ffbe09dfab9b"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Vector&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a></td></tr>
<tr class="separator:a1204ca4dc5d79f5da191ffbe09dfab9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af31e928baa970a1507dfb0233b352542"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Vector&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a></td></tr>
<tr class="separator:af31e928baa970a1507dfb0233b352542"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e89a339e79b2b4f177a05e9f0df32fa"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Vector&lt; amrex::Real &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a7e89a339e79b2b4f177a05e9f0df32fa">h_dens_hse</a></td></tr>
<tr class="separator:a7e89a339e79b2b4f177a05e9f0df32fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff6f5d2bd989b5a0f7c28e2e10e27e8c"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Vector&lt; amrex::Real &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aff6f5d2bd989b5a0f7c28e2e10e27e8c">h_pres_hse</a></td></tr>
<tr class="separator:aff6f5d2bd989b5a0f7c28e2e10e27e8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3407564246f176655d0dc97733997e52"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Gpu::DeviceVector&lt; amrex::Real &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a3407564246f176655d0dc97733997e52">d_dens_hse</a></td></tr>
<tr class="separator:a3407564246f176655d0dc97733997e52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7990255d32f7bca694acab7521101b93"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Gpu::DeviceVector&lt; amrex::Real &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a7990255d32f7bca694acab7521101b93">d_pres_hse</a></td></tr>
<tr class="separator:a7990255d32f7bca694acab7521101b93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ef8ab09aed437467e2e87a37bcd999d"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::FluxRegister * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a2ef8ab09aed437467e2e87a37bcd999d">flux_registers</a></td></tr>
<tr class="separator:a2ef8ab09aed437467e2e87a37bcd999d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a574521986a6e403159f83c8b8123ba90"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::BCRec &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a></td></tr>
<tr class="separator:a574521986a6e403159f83c8b8123ba90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a99e22b1111c803e31b4afd5fcdea60"><td class="memItemLeft" align="right" valign="top">amrex::Gpu::DeviceVector&lt; amrex::BCRec &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a8a99e22b1111c803e31b4afd5fcdea60">domain_bcs_type_d</a></td></tr>
<tr class="separator:a8a99e22b1111c803e31b4afd5fcdea60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5968f1bed602fa87cdd5cb7905b7e5e"><td class="memItemLeft" align="right" valign="top">amrex::Array&lt; std::string, 2 *AMREX_SPACEDIM &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a></td></tr>
<tr class="separator:ae5968f1bed602fa87cdd5cb7905b7e5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d5ea71a2772d2ce602b90d80e32ad37"><td class="memItemLeft" align="right" valign="top">amrex::Array&lt; amrex::Array&lt; amrex::Real, AMREX_SPACEDIM *2 &gt;, AMREX_SPACEDIM+<a class="el" href="IndexDefines_8H.html#ad5195ac8f863f5a9a7eaa0db094f7639">NVAR</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">m_bc_extdir_vals</a></td></tr>
<tr class="separator:a7d5ea71a2772d2ce602b90d80e32ad37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8f4a61c714936efc1c669447b009c29"><td class="memItemLeft" align="right" valign="top">amrex::GpuArray&lt; <a class="el" href="IndexDefines_8H.html#a6e1412fca31cbd35d0f50f12fcc70b0f">BC</a>, AMREX_SPACEDIM *2 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ab8f4a61c714936efc1c669447b009c29">phys_bc_type</a></td></tr>
<tr class="separator:ab8f4a61c714936efc1c669447b009c29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e3d0f4486b62037fce08fca0aa2d0a9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a4e3d0f4486b62037fce08fca0aa2d0a9">last_plot_file_step</a></td></tr>
<tr class="separator:a4e3d0f4486b62037fce08fca0aa2d0a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02722d16f3c26efe590702200f1296d7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a02722d16f3c26efe590702200f1296d7">last_check_file_step</a></td></tr>
<tr class="separator:a02722d16f3c26efe590702200f1296d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc00038dfe4c332e5d15f621184c69e8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#adc00038dfe4c332e5d15f621184c69e8">plot_file_on_restart</a> = 1</td></tr>
<tr class="separator:adc00038dfe4c332e5d15f621184c69e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0634154e8e58379c495c3e7fe7c5e4d6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a0634154e8e58379c495c3e7fe7c5e4d6">max_step</a> = std::numeric_limits&lt;int&gt;::max()</td></tr>
<tr class="separator:a0634154e8e58379c495c3e7fe7c5e4d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a405556a52bef334ab68294c1a540e107"><td class="memItemLeft" align="right" valign="top">amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a405556a52bef334ab68294c1a540e107">stop_time</a> = std::numeric_limits&lt;amrex::Real&gt;::max()</td></tr>
<tr class="separator:a405556a52bef334ab68294c1a540e107"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e758060d3dede9694fbfcabddc17169"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a> = &quot;&quot;</td></tr>
<tr class="separator:a8e758060d3dede9694fbfcabddc17169"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3937527f96c81674fa38dc34ed24f3f5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a3937527f96c81674fa38dc34ed24f3f5">regrid_int</a> = 2</td></tr>
<tr class="separator:a3937527f96c81674fa38dc34ed24f3f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad02c77d3f4a7dfa0ad679877f0f05fc1"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ad02c77d3f4a7dfa0ad679877f0f05fc1">plot_file</a> {&quot;plt&quot;}</td></tr>
<tr class="separator:ad02c77d3f4a7dfa0ad679877f0f05fc1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3aa38bc97a888d859a640220d2bc4456"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a3aa38bc97a888d859a640220d2bc4456">plot_type</a> {&quot;native&quot;}</td></tr>
<tr class="separator:a3aa38bc97a888d859a640220d2bc4456"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe64c2ff781da4cc0642ee1d29c912d6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#abe64c2ff781da4cc0642ee1d29c912d6">plot_int</a> = -1</td></tr>
<tr class="separator:abe64c2ff781da4cc0642ee1d29c912d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae701564fbe3da5bbd88587e5a08eca4e"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ae701564fbe3da5bbd88587e5a08eca4e">check_file</a> {&quot;chk&quot;}</td></tr>
<tr class="separator:ae701564fbe3da5bbd88587e5a08eca4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32e0d0f5ae0db18ee81f9d4325a14f64"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a32e0d0f5ae0db18ee81f9d4325a14f64">check_type</a> {&quot;native&quot;}</td></tr>
<tr class="separator:a32e0d0f5ae0db18ee81f9d4325a14f64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f48ec3caf326a6b1b986d061d36ee90"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a1f48ec3caf326a6b1b986d061d36ee90">check_int</a> = -1</td></tr>
<tr class="separator:a1f48ec3caf326a6b1b986d061d36ee90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5239b3dae0bf9ba78876bf2e8d497016"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a5239b3dae0bf9ba78876bf2e8d497016">plot_state_names</a></td></tr>
<tr class="separator:a5239b3dae0bf9ba78876bf2e8d497016"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a123e428e6385285dfb646bc6f85ce654"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a123e428e6385285dfb646bc6f85ce654">plot_deriv_names</a></td></tr>
<tr class="separator:a123e428e6385285dfb646bc6f85ce654"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f2ea7f5eeeb3634944550e5a1de8f7a"><td class="memItemLeft" align="right" valign="top">const amrex::Vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a2f2ea7f5eeeb3634944550e5a1de8f7a">velocity_names</a> {&quot;x_velocity&quot;, &quot;y_velocity&quot;, &quot;z_velocity&quot;}</td></tr>
<tr class="separator:a2f2ea7f5eeeb3634944550e5a1de8f7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd8cd5a477754776135befa668fdd0c9"><td class="memItemLeft" align="right" valign="top">const amrex::Vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#afd8cd5a477754776135befa668fdd0c9">cons_names</a></td></tr>
<tr class="separator:afd8cd5a477754776135befa668fdd0c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fc0f6e6ca35036d2e3a36dd42e66435"><td class="memItemLeft" align="right" valign="top">const amrex::Vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a></td></tr>
<tr class="separator:a9fc0f6e6ca35036d2e3a36dd42e66435"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1bc503c07e76f2a4791a76e6907e6dd7"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Vector&lt; amrex::Real &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a1bc503c07e76f2a4791a76e6907e6dd7">h_rayleigh_tau</a></td></tr>
<tr class="separator:a1bc503c07e76f2a4791a76e6907e6dd7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4dc443840da3593fe66b8693803f006"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Vector&lt; amrex::Real &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ac4dc443840da3593fe66b8693803f006">h_rayleigh_ubar</a></td></tr>
<tr class="separator:ac4dc443840da3593fe66b8693803f006"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e0624ac1d76fbde394c7ba4b01ed7eb"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Vector&lt; amrex::Real &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a6e0624ac1d76fbde394c7ba4b01ed7eb">h_rayleigh_vbar</a></td></tr>
<tr class="separator:a6e0624ac1d76fbde394c7ba4b01ed7eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f074d984fb0a319cf7a781b2efc3d63"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Vector&lt; amrex::Real &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a0f074d984fb0a319cf7a781b2efc3d63">h_rayleigh_thetabar</a></td></tr>
<tr class="separator:a0f074d984fb0a319cf7a781b2efc3d63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91e9618892751232c4067c253f904a3d"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Gpu::DeviceVector&lt; amrex::Real &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a91e9618892751232c4067c253f904a3d">d_rayleigh_tau</a></td></tr>
<tr class="separator:a91e9618892751232c4067c253f904a3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af33ee878e24ced10b3da319795723db0"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Gpu::DeviceVector&lt; amrex::Real &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#af33ee878e24ced10b3da319795723db0">d_rayleigh_ubar</a></td></tr>
<tr class="separator:af33ee878e24ced10b3da319795723db0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a879501e88824fa6a00ffe1509059b21e"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Gpu::DeviceVector&lt; amrex::Real &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a879501e88824fa6a00ffe1509059b21e">d_rayleigh_vbar</a></td></tr>
<tr class="separator:a879501e88824fa6a00ffe1509059b21e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c992f63bcc9d7e7693990bf046bfc4b"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Gpu::DeviceVector&lt; amrex::Real &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a4c992f63bcc9d7e7693990bf046bfc4b">d_rayleigh_thetabar</a></td></tr>
<tr class="separator:a4c992f63bcc9d7e7693990bf046bfc4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4dd7c603e65d230105a4f1e0afb4cf8a"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a4dd7c603e65d230105a4f1e0afb4cf8a">h_havg_density</a></td></tr>
<tr class="separator:a4dd7c603e65d230105a4f1e0afb4cf8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9683c7b07c287e57856ee5a9c99917a1"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a9683c7b07c287e57856ee5a9c99917a1">h_havg_temperature</a></td></tr>
<tr class="separator:a9683c7b07c287e57856ee5a9c99917a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a413293737b0021c97b50c62756561446"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a413293737b0021c97b50c62756561446">h_havg_pressure</a></td></tr>
<tr class="separator:a413293737b0021c97b50c62756561446"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84cf7616e7b3928f08f4bd56112db01e"><td class="memItemLeft" align="right" valign="top">amrex::Gpu::DeviceVector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a84cf7616e7b3928f08f4bd56112db01e">d_havg_density</a></td></tr>
<tr class="separator:a84cf7616e7b3928f08f4bd56112db01e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20350959b7b3e252ee3a802e7998ca8d"><td class="memItemLeft" align="right" valign="top">amrex::Gpu::DeviceVector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a20350959b7b3e252ee3a802e7998ca8d">d_havg_temperature</a></td></tr>
<tr class="separator:a20350959b7b3e252ee3a802e7998ca8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a4f076c56f31fbb5e68c09706605a05"><td class="memItemLeft" align="right" valign="top">amrex::Gpu::DeviceVector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a9a4f076c56f31fbb5e68c09706605a05">d_havg_pressure</a></td></tr>
<tr class="separator:a9a4f076c56f31fbb5e68c09706605a05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa53035f34ba133b86172e180abda4209"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classWriteBndryPlanes.html">WriteBndryPlanes</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aa53035f34ba133b86172e180abda4209">m_w2d</a> = nullptr</td></tr>
<tr class="separator:aa53035f34ba133b86172e180abda4209"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addf62bfc534515447b94e928ac0b7135"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classReadBndryPlanes.html">ReadBndryPlanes</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a> = nullptr</td></tr>
<tr class="separator:addf62bfc534515447b94e928ac0b7135"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a051364b2373d8d86151c0b4a958035bd"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classABLMost.html">ABLMost</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a051364b2373d8d86151c0b4a958035bd">m_most</a> = nullptr</td></tr>
<tr class="separator:a051364b2373d8d86151c0b4a958035bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83c244120a15f0d9b9bca54e93976428"><td class="memItemLeft" align="right" valign="top">amrex::MultiFab&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a83c244120a15f0d9b9bca54e93976428">fine_mask</a></td></tr>
<tr class="separator:a83c244120a15f0d9b9bca54e93976428"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cade630b005dbcc0f644987ef3db287"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; std::fstream &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a1cade630b005dbcc0f644987ef3db287">datalog</a></td></tr>
<tr class="separator:a1cade630b005dbcc0f644987ef3db287"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9248a4eb025c2647e003f838cba52a21"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a9248a4eb025c2647e003f838cba52a21">datalogname</a></td></tr>
<tr class="separator:a9248a4eb025c2647e003f838cba52a21"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-attribs"></a>
Static Private Attributes</h2></td></tr>
<tr class="memitem:ae52fe861ffb051a11920238c8210d69f"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ae52fe861ffb051a11920238c8210d69f">cfl</a> = 0.8</td></tr>
<tr class="separator:ae52fe861ffb051a11920238c8210d69f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa30548378350788543d15076cdcd404d"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aa30548378350788543d15076cdcd404d">init_shrink</a> = 1.0</td></tr>
<tr class="separator:aa30548378350788543d15076cdcd404d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac793fe23b026c18bb7dcce791317c6c3"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ac793fe23b026c18bb7dcce791317c6c3">change_max</a> = 1.1</td></tr>
<tr class="separator:ac793fe23b026c18bb7dcce791317c6c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e9d302b096a12999c8ff4a6bfa9a072"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a6e9d302b096a12999c8ff4a6bfa9a072">fixed_dt</a> = -1.0</td></tr>
<tr class="separator:a6e9d302b096a12999c8ff4a6bfa9a072"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa30dffc28e24ac50c880539ca2e36ffd"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aa30dffc28e24ac50c880539ca2e36ffd">fixed_fast_dt</a> = -1.0</td></tr>
<tr class="separator:aa30dffc28e24ac50c880539ca2e36ffd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2e1a979c0ad68e87eaee349beb7e9fd"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ad2e1a979c0ad68e87eaee349beb7e9fd">fixed_mri_dt_ratio</a> = 0</td></tr>
<tr class="separator:ad2e1a979c0ad68e87eaee349beb7e9fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad09820d3e29638db7c3d499304c8aed"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aad09820d3e29638db7c3d499304c8aed">use_lowM_dt</a> = false</td></tr>
<tr class="separator:aad09820d3e29638db7c3d499304c8aed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32dd48049e8acbe95decdd4b01b782c4"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="structSolverChoice.html">SolverChoice</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a></td></tr>
<tr class="separator:a32dd48049e8acbe95decdd4b01b782c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43d0b17f6e155691a1e9474526df3af5"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a43d0b17f6e155691a1e9474526df3af5">verbose</a> = 0</td></tr>
<tr class="separator:a43d0b17f6e155691a1e9474526df3af5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a279f0f572da168852d954df55abe2e"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a4a279f0f572da168852d954df55abe2e">use_native_mri</a> = 1</td></tr>
<tr class="separator:a4a279f0f572da168852d954df55abe2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4615db015b395b3a44f1fbf6d6e4fe43"><td class="memItemLeft" align="right" valign="top">static std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a4615db015b395b3a44f1fbf6d6e4fe43">coupling_type</a> = &quot;OneWay&quot;</td></tr>
<tr class="separator:a4615db015b395b3a44f1fbf6d6e4fe43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af25f70d7d9e4edeedcc40c117cc15505"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#af25f70d7d9e4edeedcc40c117cc15505">do_reflux</a> = 0</td></tr>
<tr class="separator:af25f70d7d9e4edeedcc40c117cc15505"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a778cdd6547e8cf1613cda8b4a8274bf0"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a778cdd6547e8cf1613cda8b4a8274bf0">do_avg_down</a> = 0</td></tr>
<tr class="separator:a778cdd6547e8cf1613cda8b4a8274bf0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5232e98479611a24fe97994640c61faa"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a5232e98479611a24fe97994640c61faa">sum_interval</a> = -1</td></tr>
<tr class="separator:a5232e98479611a24fe97994640c61faa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f9e05e91a9b4a16d615af290966a973"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a6f9e05e91a9b4a16d615af290966a973">sum_per</a> = -1.0</td></tr>
<tr class="separator:a6f9e05e91a9b4a16d615af290966a973"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7b9991150042eb38e2abc89399c0c7c"><td class="memItemLeft" align="right" valign="top">static std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ae7b9991150042eb38e2abc89399c0c7c">plotfile_type</a> = &quot;amrex&quot;</td></tr>
<tr class="separator:ae7b9991150042eb38e2abc89399c0c7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5ac3d88a33a1a284bcc120ce0599cf7"><td class="memItemLeft" align="right" valign="top">static std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#af5ac3d88a33a1a284bcc120ce0599cf7">init_type</a> = &quot;custom&quot;</td></tr>
<tr class="separator:af5ac3d88a33a1a284bcc120ce0599cf7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99757524a49a79368069f66f71797c9d"><td class="memItemLeft" align="right" valign="top">static amrex::Vector&lt; amrex::Vector&lt; std::string &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a99757524a49a79368069f66f71797c9d">nc_init_file</a> = {{&quot;&quot;}}</td></tr>
<tr class="separator:a99757524a49a79368069f66f71797c9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e9040f32464f1a6dee6e0384393451d"><td class="memItemLeft" align="right" valign="top">static std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a7e9040f32464f1a6dee6e0384393451d">nc_bdy_file</a> = &quot;&quot;</td></tr>
<tr class="separator:a7e9040f32464f1a6dee6e0384393451d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a536424e14c4139e4683b15c59e742362"><td class="memItemLeft" align="right" valign="top">static std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a536424e14c4139e4683b15c59e742362">input_sounding_file</a> = &quot;&quot;</td></tr>
<tr class="separator:a536424e14c4139e4683b15c59e742362"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad17ff2753e754ff3eb1330612b820b5f"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ad17ff2753e754ff3eb1330612b820b5f">output_1d_column</a> = 0</td></tr>
<tr class="separator:ad17ff2753e754ff3eb1330612b820b5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa0bef6d3146788302b81c0d4f4802d1"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#afa0bef6d3146788302b81c0d4f4802d1">column_interval</a> = -1</td></tr>
<tr class="separator:afa0bef6d3146788302b81c0d4f4802d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fedd41de89817a23b1c3b3c6ef7443f"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a9fedd41de89817a23b1c3b3c6ef7443f">column_per</a> = -1.0</td></tr>
<tr class="separator:a9fedd41de89817a23b1c3b3c6ef7443f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab10bfe15c2d15fdd22201b64722a4022"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ab10bfe15c2d15fdd22201b64722a4022">column_loc_x</a> = 0.0</td></tr>
<tr class="separator:ab10bfe15c2d15fdd22201b64722a4022"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30a1b51c733c3a20dc6948f9a3620bbb"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a30a1b51c733c3a20dc6948f9a3620bbb">column_loc_y</a> = 0.0</td></tr>
<tr class="separator:a30a1b51c733c3a20dc6948f9a3620bbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48bba6b1c1b39940b09aefbe56311e2f"><td class="memItemLeft" align="right" valign="top">static std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a48bba6b1c1b39940b09aefbe56311e2f">column_file_name</a> = &quot;column_data.nc&quot;</td></tr>
<tr class="separator:a48bba6b1c1b39940b09aefbe56311e2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c448670f7a5cadd6fe56f7e615c9eb6"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a7c448670f7a5cadd6fe56f7e615c9eb6">output_bndry_planes</a> = 0</td></tr>
<tr class="separator:a7c448670f7a5cadd6fe56f7e615c9eb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab4575d8fb57595a2f1aaf088c60447a"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aab4575d8fb57595a2f1aaf088c60447a">bndry_output_planes_interval</a> = -1</td></tr>
<tr class="separator:aab4575d8fb57595a2f1aaf088c60447a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a479132ab37232f208597c7a27c132866"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a479132ab37232f208597c7a27c132866">bndry_output_planes_per</a> = -1.0</td></tr>
<tr class="separator:a479132ab37232f208597c7a27c132866"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2be0759e68086d0e9026c61492fa225"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ac2be0759e68086d0e9026c61492fa225">bndry_output_planes_start_time</a> = 0.0</td></tr>
<tr class="separator:ac2be0759e68086d0e9026c61492fa225"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80ad08512968ec45635df68abe66b1fc"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a80ad08512968ec45635df68abe66b1fc">input_bndry_planes</a> = 0</td></tr>
<tr class="separator:a80ad08512968ec45635df68abe66b1fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addf0fb2aae0efaa649c69685a4dcca83"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#addf0fb2aae0efaa649c69685a4dcca83">ng_dens_hse</a> = 1</td></tr>
<tr class="separator:addf0fb2aae0efaa649c69685a4dcca83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87dc6c0720462bfd088c909289cdca0b"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a87dc6c0720462bfd088c909289cdca0b">ng_pres_hse</a> = 1</td></tr>
<tr class="separator:a87dc6c0720462bfd088c909289cdca0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac81b3dfd7c6f21ba8479834e2ff1e652"><td class="memItemLeft" align="right" valign="top">static amrex::Vector&lt; amrex::AMRErrorTag &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ac81b3dfd7c6f21ba8479834e2ff1e652">ref_tags</a></td></tr>
<tr class="separator:ac81b3dfd7c6f21ba8479834e2ff1e652"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3890ee3bf2586cf0ef2822b671c5d8c4"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a3890ee3bf2586cf0ef2822b671c5d8c4">startCPUTime</a> = 0.0</td></tr>
<tr class="separator:a3890ee3bf2586cf0ef2822b671c5d8c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7948479fe1497dc592dd748c9567fdaa"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a7948479fe1497dc592dd748c9567fdaa">previousCPUTimeUsed</a> = 0.0</td></tr>
<tr class="separator:a7948479fe1497dc592dd748c9567fdaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a30129012dd367825e5e4fd1406694f58"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30129012dd367825e5e4fd1406694f58">&#9670;&nbsp;</a></span>ERF()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ERF::ERF </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;{</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordflow">if</span> (amrex::ParallelDescriptor::IOProcessor()) {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span>* erf_hash = amrex::buildInfoGetGitHash(1);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span>* amrex_hash = amrex::buildInfoGetGitHash(2);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span>* buildgithash = amrex::buildInfoGetBuildGitHash();</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span>* buildgitname = amrex::buildInfoGetBuildGitName();</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="keywordflow">if</span> (strlen(erf_hash) &gt; 0) {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;          amrex::Print() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                         &lt;&lt; <span class="stringliteral">&quot;ERF git hash: &quot;</span> &lt;&lt; erf_hash &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        }</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <span class="keywordflow">if</span> (strlen(amrex_hash) &gt; 0) {</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;          amrex::Print() &lt;&lt; <span class="stringliteral">&quot;AMReX git hash: &quot;</span> &lt;&lt; amrex_hash &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        }</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="keywordflow">if</span> (strlen(buildgithash) &gt; 0) {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;          amrex::Print() &lt;&lt; buildgitname &lt;&lt; <span class="stringliteral">&quot; git hash: &quot;</span> &lt;&lt; buildgithash &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        }</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <a class="code" href="classERF.html#a2d39cd3bdc3d90609ad3b14e266d190a">ReadParameters</a>();</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <a class="code" href="classERF.html#aef40b8ba6cb32fe3b11b8d9381f16cef">setPlotVariables</a>();</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <a class="code" href="prob__common_8H.html#afef32e2116829d24b864c64caebf5ea6">amrex_probinit</a>(geom[0].ProbLo(),geom[0].ProbHi());</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="comment">// Geometry on all levels has been defined already.</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="comment">// No valid BoxArray and DistributionMapping have been defined.</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="comment">// But the arrays for them have been resized.</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keywordtype">int</span> nlevs_max = max_level + 1;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>.resize(nlevs_max, 0);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <a class="code" href="classERF.html#aa3db2dd1b65310c66c4038650c22aaee">nsubsteps</a>.resize(nlevs_max, 1);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 1; lev &lt;= max_level; ++lev) {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <a class="code" href="classERF.html#aa3db2dd1b65310c66c4038650c22aaee">nsubsteps</a>[lev] = MaxRefRatio(lev-1);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>.resize(nlevs_max, 0.0);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <a class="code" href="classERF.html#a7085d7d5fc94a0f84efc06957267d58e">t_old</a>.resize(nlevs_max, -1.e100);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>.resize(nlevs_max, 1.e100);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <a class="code" href="classERF.html#a3cf7cb2e51eb7b69cb4079ffc6722459">dt_mri_ratio</a>.resize(nlevs_max, 1);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160; </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt; nlevs_max; ++lev) {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev].resize(<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca5deccaa24d5e74279425d7749f7d1494">Vars::NumTypes</a>);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev].resize(<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca5deccaa24d5e74279425d7749f7d1494">Vars::NumTypes</a>);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    }</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <a class="code" href="classERF.html#a2ef8ab09aed437467e2e87a37bcd999d">flux_registers</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="comment">// Initialize tagging criteria for mesh refinement</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <a class="code" href="classERF.html#aa90c9756f684404f8b69b8a23568b535">refinement_criteria_setup</a>();</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="comment">// We have already read in the ref_Ratio (via amr.ref_ratio =) but we need to enforce</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="comment">//     that there is no refinement in the vertical so we test on that here.</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt; max_level; ++lev)</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    {</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;       amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Refinement ratio at level &quot;</span> &lt;&lt; lev &lt;&lt; <span class="stringliteral">&quot; set to be &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;          ref_ratio[lev][0]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; ref_ratio[lev][1]  &lt;&lt;  <span class="stringliteral">&quot; &quot;</span> &lt;&lt; ref_ratio[lev][2] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;       <span class="keywordflow">if</span> (ref_ratio[lev][2] != 1)</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;       {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;           amrex::Error(<span class="stringliteral">&quot;We don&#39;t allow refinement in the vertical -- make sure to set ref_ratio = 1 in z&quot;</span>);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;       }</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    }</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a30129012dd367825e5e4fd1406694f58_cgraph.png" border="0" usemap="#classERF_a30129012dd367825e5e4fd1406694f58_cgraph" alt=""/></div>
<map name="classERF_a30129012dd367825e5e4fd1406694f58_cgraph" id="classERF_a30129012dd367825e5e4fd1406694f58_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,84,32"/>
<area shape="rect" href="prob__common_8H.html#afef32e2116829d24b864c64caebf5ea6" title=" " alt="" coords="132,5,253,32"/>
</map>
</div>

</div>
</div>
<a id="a9980a8792a2ab137ad7c9121a5cf58bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9980a8792a2ab137ad7c9121a5cf58bf">&#9670;&nbsp;</a></span>~ERF()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ERF::~ERF </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;{</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a47413fe5588f7dd71a1d5087a9e804f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47413fe5588f7dd71a1d5087a9e804f9">&#9670;&nbsp;</a></span>Advance()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::Advance </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>dt_lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iteration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ncycle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;{</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    BL_PROFILE(<span class="stringliteral">&quot;ERF::Advance()&quot;</span>);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="comment">// We must swap the pointers so the previous step&#39;s &quot;new&quot; is now this step&#39;s &quot;old&quot;</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    std::swap(<a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev]);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    MultiFab&amp; S_old = <a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev][<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>];</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    MultiFab&amp; S_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>];</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    MultiFab&amp; U_old = <a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev][<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>];</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    MultiFab&amp; V_old = <a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev][<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>];</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    MultiFab&amp; W_old = <a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev][<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>];</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    MultiFab&amp; U_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>];</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    MultiFab&amp; V_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>];</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    MultiFab&amp; W_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>];</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <a class="code" href="classERF.html#a3d8f63f2178b1cb5ba78a433ece34e1c">FillPatch</a>(lev, time, <a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev]);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    MultiFab* S_crse;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    MultiFab rU_crse, rV_crse, rW_crse;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keywordflow">if</span> (lev &gt; 0)</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        S_crse = &amp;<a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev-1][<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>];</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        MultiFab&amp; U_crse = <a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev-1][<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>];</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        MultiFab&amp; V_crse = <a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev-1][<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>];</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        MultiFab&amp; W_crse = <a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev-1][<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>];</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        rU_crse.define(U_crse.boxArray(), U_crse.DistributionMap(), 1, U_crse.nGrow());</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        rV_crse.define(V_crse.boxArray(), V_crse.DistributionMap(), 1, V_crse.nGrow());</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        rW_crse.define(W_crse.boxArray(), W_crse.DistributionMap(), 1, W_crse.nGrow());</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <a class="code" href="SpatialStencils_8H.html#afc02a222736ea1f0219b287fb472a765">VelocityToMomentum</a>(U_crse, U_crse.nGrowVect(),</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                           V_crse, V_crse.nGrowVect(),</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                           W_crse, W_crse.nGrowVect(),</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                          *S_crse,rU_crse,rV_crse,rW_crse);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    }</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="comment">// configure ABLMost params if used MostWall boundary condition</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ab8f4a61c714936efc1c669447b009c29">phys_bc_type</a>[Orientation(Direction::z,Orientation::low)] != <a class="code" href="IndexDefines_8H.html#a6e1412fca31cbd35d0f50f12fcc70b0fa882dd232c0425bb9366544f84f0a7b6c">BC::MOST</a>) {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a051364b2373d8d86151c0b4a958035bd">m_most</a>) <a class="code" href="classERF.html#a67da556b4b4cbdc891da06eb5e17aac8">setupABLMost</a>(lev);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="comment">// Do an error check</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a0a031373331c9aca22a47b0995729f46">pbl_type</a> == <a class="code" href="DataStruct_8H.html#a4a079f2650ca30c787a8375ec5f17ca5abdeb9a753db1d1f3fe0e944eab1d0601">PBLType::MYNN25</a> &amp;&amp;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <a class="code" href="classERF.html#ab8f4a61c714936efc1c669447b009c29">phys_bc_type</a>[Orientation(Direction::z,Orientation::low)] != <a class="code" href="IndexDefines_8H.html#a6e1412fca31cbd35d0f50f12fcc70b0fa882dd232c0425bb9366544f84f0a7b6c">BC::MOST</a>) {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        amrex::Error(<span class="stringliteral">&quot;Must use MOST BC for MYNN2.5 PBL model&quot;</span>);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; local_ref_ratio = (lev &gt; 0) ? ref_ratio[lev-1] : IntVect(1,1,1);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    InterpFaceRegister ifr;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keywordflow">if</span> (lev &gt; 0)</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        ifr.define(S_old.boxArray(), S_old.DistributionMap(), Geom(lev), local_ref_ratio);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    }</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keyword">const</span> BoxArray&amp;            ba = S_old.boxArray();</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keyword">const</span> DistributionMapping&amp; dm = S_old.DistributionMap();</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keywordtype">int</span> nvars = S_old.nComp();</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="comment">// Place-holder for source array -- for now just set to 0</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    MultiFab source(ba,dm,nvars,1);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    source.setVal(0.0);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="comment">// These are the actual fluxes we will use to fill the flux registers</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    std::array&lt; MultiFab, AMREX_SPACEDIM &gt; flux;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160; </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    flux[0].define(convert(ba,IntVect(1,0,0)), dm, nvars, 0);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    flux[1].define(convert(ba,IntVect(0,1,0)), dm, nvars, 0);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    flux[2].define(convert(ba,IntVect(0,0,1)), dm, nvars, 0);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    flux[0].setVal(0.);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    flux[1].setVal(0.);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    flux[2].setVal(0.);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="comment">// We don&#39;t need to call FillPatch on cons_mf because we have fillpatch&#39;ed S_old above</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    MultiFab cons_mf(ba,dm,nvars,S_old.nGrowVect());</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    MultiFab::Copy(cons_mf,S_old,0,0,S_old.nComp(),S_old.nGrowVect());</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="comment">// Pass the 1D arrays if relevant</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="preprocessor">#ifdef ERF_USE_TERRAIN</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    MultiFab&amp; r0 = dens_hse[lev];</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    MultiFab&amp; p0 = pres_hse[lev];</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    amrex::Real* dptr_dens_hse = <a class="code" href="classERF.html#a3407564246f176655d0dc97733997e52">d_dens_hse</a>[lev].data() + <a class="code" href="classERF.html#addf0fb2aae0efaa649c69685a4dcca83">ng_dens_hse</a>;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    amrex::Real* dptr_pres_hse = <a class="code" href="classERF.html#a7990255d32f7bca694acab7521101b93">d_pres_hse</a>[lev].data() + <a class="code" href="classERF.html#a87dc6c0720462bfd088c909289cdca0b">ng_pres_hse</a>;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    amrex::Real* dptr_rayleigh_tau      = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a27ced9266434a4680ef175e7b2ba8f01">use_rayleigh_damping</a> ? <a class="code" href="classERF.html#a91e9618892751232c4067c253f904a3d">d_rayleigh_tau</a>[lev].data() : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    amrex::Real* dptr_rayleigh_ubar     = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a27ced9266434a4680ef175e7b2ba8f01">use_rayleigh_damping</a> ? <a class="code" href="classERF.html#af33ee878e24ced10b3da319795723db0">d_rayleigh_ubar</a>[lev].data() : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    amrex::Real* dptr_rayleigh_vbar     = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a27ced9266434a4680ef175e7b2ba8f01">use_rayleigh_damping</a> ? <a class="code" href="classERF.html#a879501e88824fa6a00ffe1509059b21e">d_rayleigh_vbar</a>[lev].data() : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    amrex::Real* dptr_rayleigh_thetabar = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a27ced9266434a4680ef175e7b2ba8f01">use_rayleigh_damping</a> ? <a class="code" href="classERF.html#a4c992f63bcc9d7e7693990bf046bfc4b">d_rayleigh_thetabar</a>[lev].data() : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="comment">// *****************************************************************</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="comment">// Update the cell-centered state and face-based velocity using</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="comment">// a time integrator.</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="comment">// Inputs:</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="comment">//          S_old    (state on cell centers)</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="comment">//          U_old    (x-velocity on x-faces)</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="comment">//          V_old    (y-velocity on y-faces)</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="comment">//          W_old    (z-velocity on z-faces)</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="comment">//          source   (source term on cell centers)</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="comment">// Outputs:</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="comment">//          S_new    (state on cell centers)</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="comment">//          U_new    (x-velocity on x-faces)</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="comment">//          V_new    (y-velocity on y-faces)</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="comment">//          W_new    (z-velocity on z-faces)</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="comment">// *****************************************************************</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <a class="code" href="classERF.html#aa3151f4f965fcd44456952f69a9c28fc">erf_advance</a>(lev,</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                cons_mf, S_new,</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                U_old, V_old, W_old,</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                U_new, V_new, W_new,</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                rU_crse, rV_crse, rW_crse,</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                source, flux,</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                Geom(lev), dt_lev, time,</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                &amp;ifr,</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;#ifdef ERF_USE_TERRAIN</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                r0, p0,</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;#<span class="keywordflow">else</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                dptr_dens_hse, dptr_pres_hse,</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;#endif</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                dptr_rayleigh_tau, dptr_rayleigh_ubar,</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                dptr_rayleigh_vbar, dptr_rayleigh_thetabar);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="comment">// *****************************************************************</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="comment">// Now fill the flux registers with the fluxes so we can reflux later</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="comment">// *****************************************************************</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; dx = Geom(lev).CellSize();</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordflow">if</span> (finest_level &gt; 0 &amp;&amp; <a class="code" href="classERF.html#af25f70d7d9e4edeedcc40c117cc15505">do_reflux</a>)</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    {</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="keywordflow">if</span> (lev &lt; finest_level) {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            <a class="code" href="classERF.html#a2ef8ab09aed437467e2e87a37bcd999d">flux_registers</a>[lev+1]-&gt;setVal(0.0);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            <a class="code" href="classERF.html#a2ef8ab09aed437467e2e87a37bcd999d">flux_registers</a>[lev+1]-&gt;CrseInit(flux[0],0,0,0,nvars,-dx[1]*dx[2],amrex::FluxRegister::ADD);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            <a class="code" href="classERF.html#a2ef8ab09aed437467e2e87a37bcd999d">flux_registers</a>[lev+1]-&gt;CrseInit(flux[1],1,0,0,nvars,-dx[0]*dx[2],amrex::FluxRegister::ADD);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            <a class="code" href="classERF.html#a2ef8ab09aed437467e2e87a37bcd999d">flux_registers</a>[lev+1]-&gt;CrseInit(flux[2],2,0,0,nvars,-dx[0]*dx[1],amrex::FluxRegister::ADD);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        }</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <span class="keywordflow">if</span> (lev &gt; 0) {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;          <a class="code" href="classERF.html#a2ef8ab09aed437467e2e87a37bcd999d">flux_registers</a>[lev]-&gt;FineAdd(flux[0], 0, 0, 0, nvars, dx[1]*dx[2]);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;          <a class="code" href="classERF.html#a2ef8ab09aed437467e2e87a37bcd999d">flux_registers</a>[lev]-&gt;FineAdd(flux[1], 1, 0, 0, nvars, dx[0]*dx[2]);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;          <a class="code" href="classERF.html#a2ef8ab09aed437467e2e87a37bcd999d">flux_registers</a>[lev]-&gt;FineAdd(flux[2], 2, 0, 0, nvars, dx[0]*dx[1]);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        }</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    }</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a47413fe5588f7dd71a1d5087a9e804f9_cgraph.png" border="0" usemap="#classERF_a47413fe5588f7dd71a1d5087a9e804f9_cgraph" alt=""/></div>
<map name="classERF_a47413fe5588f7dd71a1d5087a9e804f9_cgraph" id="classERF_a47413fe5588f7dd71a1d5087a9e804f9_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,116,32"/>
<area shape="rect" href="SpatialStencils_8H.html#afc02a222736ea1f0219b287fb472a765" title=" " alt="" coords="164,5,327,32"/>
</map>
</div>

</div>
</div>
<a id="a8202de1f8f372e3e6fdc483447c6a55f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8202de1f8f372e3e6fdc483447c6a55f">&#9670;&nbsp;</a></span>AverageDown()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::AverageDown </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;{</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = finest_level-1; lev &gt;= 0; --lev)</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    {</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        <a class="code" href="classERF.html#a40ebca562ac79fcc9250e17e0f4a5b41">AverageDownTo</a>(lev);</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    }</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a40ebca562ac79fcc9250e17e0f4a5b41"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40ebca562ac79fcc9250e17e0f4a5b41">&#9670;&nbsp;</a></span>AverageDownTo()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::AverageDownTo </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>crse_lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;{</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> var_idx = 0; var_idx &lt; <a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca5deccaa24d5e74279425d7749f7d1494">Vars::NumTypes</a>; ++var_idx) {</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        <span class="keyword">const</span> BoxArray&amp; ba(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[crse_lev][var_idx].boxArray());</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        <span class="keywordflow">if</span> (ba[0].type() == IntVect::TheZeroVector())</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;            amrex::average_down(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[crse_lev+1][var_idx], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[crse_lev][var_idx],</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;                                0, <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[crse_lev][var_idx].nComp(), refRatio(crse_lev));</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;        <span class="keywordflow">else</span> <span class="comment">// We assume the arrays are face-centered if not cell-centered</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;            amrex::average_down_faces(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[crse_lev+1][var_idx], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[crse_lev][var_idx],</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;                                      refRatio(crse_lev),geom[crse_lev]);</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    }</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a419ba9adca32073e70aae4a8fe8cfcee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a419ba9adca32073e70aae4a8fe8cfcee">&#9670;&nbsp;</a></span>build_fine_mask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::MultiFab &amp; ERF::build_fine_mask </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;{</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="comment">// Mask for zeroing covered cells</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  AMREX_ASSERT(level &gt; 0);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keyword">const</span> amrex::BoxArray&amp; cba = grids[level-1];</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="keyword">const</span> amrex::DistributionMapping&amp; cdm = dmap[level-1];</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="comment">// TODO -- we should make a vector of these a member of ERF class</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <a class="code" href="classERF.html#a83c244120a15f0d9b9bca54e93976428">fine_mask</a>.define(cba, cdm, 1, 0, amrex::MFInfo());</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <a class="code" href="classERF.html#a83c244120a15f0d9b9bca54e93976428">fine_mask</a>.setVal(1.0);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  amrex::BoxArray fba = grids[level];</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  amrex::iMultiFab ifine_mask = makeFineMask(cba, cdm, fba, ref_ratio[level-1], 1, 0);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="preprocessor">#pragma omp parallel if (amrex::Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keywordflow">for</span> (amrex::MFIter mfi(<a class="code" href="classERF.html#a83c244120a15f0d9b9bca54e93976428">fine_mask</a>, amrex::TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="keyword">auto</span>&amp; fab = <a class="code" href="classERF.html#a83c244120a15f0d9b9bca54e93976428">fine_mask</a>[mfi];</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="keyword">auto</span>&amp; ifab = ifine_mask[mfi];</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> arr = fab.array();</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> iarr = ifab.array();</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        amrex::ParallelFor(</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;          fab.box(), [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="preprocessor">#pragma omp atomic write</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            arr(i, j, k) = iarr(i, j, k);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;          });</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    }</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160; </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classERF.html#a83c244120a15f0d9b9bca54e93976428">fine_mask</a>;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac44e400a7ce68e18fa44e9416cb1344e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac44e400a7ce68e18fa44e9416cb1344e">&#9670;&nbsp;</a></span>ClearLevel()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::ClearLevel </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;{</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> var_idx = 0; var_idx &lt; <a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca5deccaa24d5e74279425d7749f7d1494">Vars::NumTypes</a>; ++var_idx) {</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][var_idx].clear();</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        <a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev][var_idx].clear();</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    }</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a62a5ed3c3806eaa918257e0ad1382df5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62a5ed3c3806eaa918257e0ad1382df5">&#9670;&nbsp;</a></span>ComputeDt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::ComputeDt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;{</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;    Vector&lt;Real&gt; dt_tmp(finest_level+1);</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160; </div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev)</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    {</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;        dt_tmp[lev] = <a class="code" href="classERF.html#a6b1d727e63de2e49aa4f8e00b0dda1d5">estTimeStep</a>(lev, <a class="code" href="classERF.html#a3cf7cb2e51eb7b69cb4079ffc6722459">dt_mri_ratio</a>[lev]);</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    }</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    ParallelDescriptor::ReduceRealMin(&amp;dt_tmp[0], dt_tmp.size());</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> dt_0 = dt_tmp[0];</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <span class="keywordtype">int</span> n_factor = 1;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;        dt_tmp[lev] = amrex::min(dt_tmp[lev], <a class="code" href="classERF.html#ac793fe23b026c18bb7dcce791317c6c3">change_max</a>*<a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[lev]);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;        n_factor *= <a class="code" href="classERF.html#aa3db2dd1b65310c66c4038650c22aaee">nsubsteps</a>[lev];</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;        dt_0 = amrex::min(dt_0, n_factor*dt_tmp[lev]);</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    }</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="comment">// Limit dt&#39;s by the value of stop_time.</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> eps = 1.e-3*dt_0;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0] + dt_0 &gt; <a class="code" href="classERF.html#a405556a52bef334ab68294c1a540e107">stop_time</a> - eps) {</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        dt_0 = <a class="code" href="classERF.html#a405556a52bef334ab68294c1a540e107">stop_time</a> - <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0];</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    }</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[0] = dt_0;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 1; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[lev] = <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[lev-1] / <a class="code" href="classERF.html#aa3db2dd1b65310c66c4038650c22aaee">nsubsteps</a>[lev];</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    }</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0f5b892bf373e46ae54597683e0f9685"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f5b892bf373e46ae54597683e0f9685">&#9670;&nbsp;</a></span>ComputeGhostCells()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">AMREX_FORCE_INLINE int ERF::ComputeGhostCells </td>
          <td>(</td>
          <td class="paramtype">const int &amp;&#160;</td>
          <td class="paramname"><em>spatial_order</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                                                {</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;      <span class="keywordtype">int</span> nGhostCells;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160; </div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;      <span class="keywordflow">switch</span> (spatial_order) {</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;          nGhostCells = 2; <span class="comment">// We need this many to compute the eddy viscosity in the ghost cells</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        <span class="keywordflow">case</span> 3:</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;          nGhostCells = 2;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        <span class="keywordflow">case</span> 4:</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;          nGhostCells = 2;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        <span class="keywordflow">case</span> 5:</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;          nGhostCells = 3;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        <span class="keywordflow">case</span> 6:</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;          nGhostCells = 3;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;          amrex::Error(<span class="stringliteral">&quot;Must specify spatial order to be 2,3,4,5 or 6&quot;</span>);</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      }</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160; </div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;      <span class="keywordflow">return</span> nGhostCells;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa2c3ee1910008b828b9da79ccdfe3871"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2c3ee1910008b828b9da79ccdfe3871">&#9670;&nbsp;</a></span>DataLog()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">AMREX_FORCE_INLINE std::ostream&amp; ERF::DataLog </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    {</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        <span class="keywordflow">return</span> *<a class="code" href="classERF.html#a1cade630b005dbcc0f644987ef3db287">datalog</a>[i];</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="afbf411b8cb24554d9aad7c76b0210e92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afbf411b8cb24554d9aad7c76b0210e92">&#9670;&nbsp;</a></span>DataLogName()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::string ERF::DataLogName </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The filename of the ith datalog file. </p>
<div class="fragment"><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classERF.html#a9248a4eb025c2647e003f838cba52a21">datalogname</a>[i]; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa3151f4f965fcd44456952f69a9c28fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3151f4f965fcd44456952f69a9c28fc">&#9670;&nbsp;</a></span>erf_advance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::erf_advance </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>level</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>cons_old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>cons_new</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>xvel_old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>yvel_old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>zvel_old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>xvel_new</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>yvel_new</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>zvel_new</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>xmom_crse</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>ymom_crse</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>zmom_crse</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::array&lt; amrex::MultiFab, AMREX_SPACEDIM &gt; &amp;&#160;</td>
          <td class="paramname"><em>flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Geometry&#160;</td>
          <td class="paramname"><em>fine_geom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::InterpFaceRegister *&#160;</td>
          <td class="paramname"><em>ifr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real *&#160;</td>
          <td class="paramname"><em>dptr_dens_hse</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real *&#160;</td>
          <td class="paramname"><em>dptr_pres_hse</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real *&#160;</td>
          <td class="paramname"><em>dptr_rayleigh_tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real *&#160;</td>
          <td class="paramname"><em>dptr_rayleigh_ubar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real *&#160;</td>
          <td class="paramname"><em>dptr_rayleigh_vbar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real *&#160;</td>
          <td class="paramname"><em>dptr_rayleigh_thetabar</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;{</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    BL_PROFILE_VAR(<span class="stringliteral">&quot;erf_advance()&quot;</span>,<a class="code" href="classERF.html#aa3151f4f965fcd44456952f69a9c28fc">erf_advance</a>);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keywordtype">int</span> nvars = cons_old.nComp();</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keyword">const</span> BoxArray&amp; ba            = cons_old.boxArray();</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="keyword">const</span> DistributionMapping&amp; dm = cons_old.DistributionMap();</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="comment">// **************************************************************************************</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="comment">// Temporary array that we use to store primitive advected quantities for the RHS</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="comment">// **************************************************************************************</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keyword">auto</span> cons_to_prim = [&amp;](<span class="keyword">const</span> MultiFab&amp; cons_state, MultiFab&amp; prim_state) {</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#pragma omp parallel if (amrex::Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      <span class="keywordflow">for</span> (MFIter mfi(cons_state,TilingIfNotGPU()); mfi.isValid(); ++mfi) {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;          <span class="keyword">const</span> Box&amp; gbx = mfi.growntilebox(cons_state.nGrowVect());</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;          <span class="keyword">const</span> Array4&lt;const Real&gt;&amp; cons_arr = cons_state.array(mfi);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;          <span class="keyword">const</span> Array4&lt;Real&gt;&amp; prim_arr = prim_state.array(mfi);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;          amrex::ParallelFor(gbx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; <a class="code" href="IndexDefines_8H.html#a76cb673ca03cd7f8ae6cc8544d6dd0fa">NUM_PRIM</a>; ++n) {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;              prim_arr(i,j,k,<a class="code" href="IndexDefines_8H.html#a8b9c5b827b61f426a3879bc5d2883040">PrimTheta_comp</a> + n) = cons_arr(i,j,k,<a class="code" href="IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a> + n) / cons_arr(i,j,k,<a class="code" href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;            }</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;          });</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      } <span class="comment">// mfi</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    };</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    MultiFab S_prim(ba, dm, <a class="code" href="IndexDefines_8H.html#a76cb673ca03cd7f8ae6cc8544d6dd0fa">NUM_PRIM</a>, cons_old.nGrowVect());</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="comment">// **************************************************************************************</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="comment">// These are temporary arrays that we use to store the accumulation of the fluxes</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="comment">// **************************************************************************************</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    std::array&lt; MultiFab, AMREX_SPACEDIM &gt;  advflux;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    std::array&lt; MultiFab, AMREX_SPACEDIM &gt; diffflux;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;     advflux[0].define(convert(ba,IntVect(1,0,0)), dm, nvars, 0);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    diffflux[0].define(convert(ba,IntVect(1,0,0)), dm, nvars, 0);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;     advflux[1].define(convert(ba,IntVect(0,1,0)), dm, nvars, 0);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    diffflux[1].define(convert(ba,IntVect(0,1,0)), dm, nvars, 0);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;     advflux[2].define(convert(ba,IntVect(0,0,1)), dm, nvars, 0);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    diffflux[2].define(convert(ba,IntVect(0,0,1)), dm, nvars, 0);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;     advflux[0].setVal(0.);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;     advflux[1].setVal(0.);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;     advflux[2].setVal(0.);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    diffflux[0].setVal(0.);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    diffflux[1].setVal(0.);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    diffflux[2].setVal(0.);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="comment">// **************************************************************************************</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">// Here we define state_old and state_new which are to be advanced</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="comment">// **************************************************************************************</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="comment">// Initial solution</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    amrex::Vector&lt;amrex::MultiFab&gt; state_old;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    state_old.push_back(MultiFab(ba, dm, nvars, cons_old.nGrow())); <span class="comment">// cons</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    state_old.push_back(MultiFab(convert(ba,IntVect(1,0,0)), dm, 1, xvel_old.nGrow())); <span class="comment">// xmom</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    state_old.push_back(MultiFab(convert(ba,IntVect(0,1,0)), dm, 1, yvel_old.nGrow())); <span class="comment">// ymom</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    state_old.push_back(MultiFab(convert(ba,IntVect(0,0,1)), dm, 1, zvel_old.nGrow())); <span class="comment">// zmom</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    state_old.push_back(MultiFab(convert(ba,IntVect(1,0,0)), dm, nvars, 1)); <span class="comment">// x-fluxes</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    state_old.push_back(MultiFab(convert(ba,IntVect(0,1,0)), dm, nvars, 1)); <span class="comment">// y-fluxes</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    state_old.push_back(MultiFab(convert(ba,IntVect(0,0,1)), dm, nvars, 1)); <span class="comment">// z-fluxes</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="comment">// Final solution</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    amrex::Vector&lt;amrex::MultiFab&gt; state_new;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    state_new.push_back(MultiFab(ba, dm, nvars, cons_old.nGrow())); <span class="comment">// cons</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    state_new.push_back(MultiFab(convert(ba,IntVect(1,0,0)), dm, 1, xvel_old.nGrow())); <span class="comment">// xmom</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    state_new.push_back(MultiFab(convert(ba,IntVect(0,1,0)), dm, 1, yvel_old.nGrow())); <span class="comment">// ymom</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    state_new.push_back(MultiFab(convert(ba,IntVect(0,0,1)), dm, 1, zvel_old.nGrow())); <span class="comment">// zmom</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    state_new.push_back(MultiFab(convert(ba,IntVect(1,0,0)), dm, nvars, 1)); <span class="comment">// x-fluxes</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    state_new.push_back(MultiFab(convert(ba,IntVect(0,1,0)), dm, nvars, 1)); <span class="comment">// y-fluxes</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    state_new.push_back(MultiFab(convert(ba,IntVect(0,0,1)), dm, nvars, 1)); <span class="comment">// z-fluxes</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="comment">// ***********************************************************************************************</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="comment">// Prepare the old-time data for calling the integrator</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="comment">// Note that we have filled the ghost cells of cons_old and we are copying the ghost cell values</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="comment">//      so we don&#39;t need to enforce BCs again here before calling VelocityToMomentum</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="comment">// ***********************************************************************************************</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    MultiFab::Copy(state_old[<a class="code" href="namespaceIntVar.html#ae96c1cd796f723e15dfbf718f1a9c76da22501eeeb48d3d47f802dcb78c88f7ae">IntVar::cons</a>], cons_old, 0, 0, cons_old.nComp(), cons_old.nGrow());</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="comment">// ***********************************************************************************************</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="comment">// Convert old velocity available on faces to old momentum on faces to be used in time integration</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="comment">// ***********************************************************************************************</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <a class="code" href="SpatialStencils_8H.html#afc02a222736ea1f0219b287fb472a765">VelocityToMomentum</a>(xvel_old, xvel_old.nGrowVect(),</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                       yvel_old, yvel_old.nGrowVect(),</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                       zvel_old, zvel_old.nGrowVect(),</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                       state_old[<a class="code" href="namespaceIntVar.html#ae96c1cd796f723e15dfbf718f1a9c76da22501eeeb48d3d47f802dcb78c88f7ae">IntVar::cons</a>],</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                       state_old[<a class="code" href="namespaceIntVar.html#ae96c1cd796f723e15dfbf718f1a9c76dad22d96cf9b7b4dd875cea33d3ec0b481">IntVar::xmom</a>],</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                       state_old[<a class="code" href="namespaceIntVar.html#ae96c1cd796f723e15dfbf718f1a9c76daa06e9caed4d0b72c322646815c1a96ce">IntVar::ymom</a>],</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                       state_old[<a class="code" href="namespaceIntVar.html#ae96c1cd796f723e15dfbf718f1a9c76dabde409cfd9edf4a3581fe26dfa9613cd">IntVar::zmom</a>]);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="comment">// ***********************************************************************************************</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="comment">// Initialize the fluxes to zero</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="comment">// ***********************************************************************************************</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    state_old[<a class="code" href="namespaceIntVar.html#ae96c1cd796f723e15dfbf718f1a9c76da21245d0eca9226a6441feac35602c9be">IntVar::xflux</a>].setVal(0.0_rt);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    state_old[<a class="code" href="namespaceIntVar.html#ae96c1cd796f723e15dfbf718f1a9c76daf204c2311e68c84ad19b3759183bdd09">IntVar::yflux</a>].setVal(0.0_rt);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    state_old[<a class="code" href="namespaceIntVar.html#ae96c1cd796f723e15dfbf718f1a9c76da9b94534904513cb3b68ef8b0c7bfed51">IntVar::zflux</a>].setVal(0.0_rt);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="comment">// ***************************************************************************************</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="comment">// This routine is called before the first step of the time integration, *and* in the case</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="comment">//  of a multi-stage method like RK3, this is called from &quot;post_update_fun&quot; which is called</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="comment">//  before every subsequent stage.  Since we advance the variables in conservative form,</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="comment">//  we must convert momentum to velocity before imposing the bcs.</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="comment">// ***************************************************************************************</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keyword">auto</span> apply_bcs = [&amp;](Vector&lt;MultiFab&gt;&amp; S_data, <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> time_for_fp)</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    {</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        amrex::Array&lt;const MultiFab*,3&gt; cmf_const{&amp;xmom_crse, &amp;ymom_crse, &amp;zmom_crse};</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        amrex::Array&lt;MultiFab*,3&gt; fmf{&amp;S_data[<a class="code" href="namespaceIntVar.html#ae96c1cd796f723e15dfbf718f1a9c76dad22d96cf9b7b4dd875cea33d3ec0b481">IntVar::xmom</a>],</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                                      &amp;S_data[<a class="code" href="namespaceIntVar.html#ae96c1cd796f723e15dfbf718f1a9c76daa06e9caed4d0b72c322646815c1a96ce">IntVar::ymom</a>],</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                                      &amp;S_data[<a class="code" href="namespaceIntVar.html#ae96c1cd796f723e15dfbf718f1a9c76dabde409cfd9edf4a3581fe26dfa9613cd">IntVar::zmom</a>]};</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <span class="comment">// ***************************************************************************************</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="comment">// Interpolate momentum from coarse faces to fine faces *only* on the coarse-fine boundary</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="comment">// ***************************************************************************************</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="keywordflow">if</span> (level &gt; 0) {</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            ifr-&gt;interp(fmf,cmf_const,0,1);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        }</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <span class="comment">// ***************************************************************************************</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="comment">// Call FillPatch routines for the density only because we need it to convert between</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="comment">//      momentum and velocity</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <span class="comment">// This fills ghost cells/faces from</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="comment">//     1) coarser level if lev &gt; 0</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="comment">//     2) physical boundaries</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="comment">//     3) other grids at the same level</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="comment">// ***************************************************************************************</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="keywordtype">bool</span> rho_only = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <a class="code" href="classERF.html#a17edcb4fd8fa664054acdbcfa0f7d9a3">FillIntermediatePatch</a>(level, time_for_fp, {S_data[<a class="code" href="namespaceIntVar.html#ae96c1cd796f723e15dfbf718f1a9c76da22501eeeb48d3d47f802dcb78c88f7ae">IntVar::cons</a>], xvel_new, yvel_new, zvel_new},</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                              rho_only);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="comment">// Here we don&#39;t use include any of the ghost region because we have only updated</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="comment">//      momentum on valid faces</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <a class="code" href="MomentumToVelocity_8cpp.html#a79080d9506305b3b98f783cc6c2cda47">MomentumToVelocity</a>(xvel_new, IntVect::TheZeroVector(),</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                           yvel_new, IntVect::TheZeroVector(),</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                           zvel_new, IntVect::TheZeroVector(),</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                           S_data[<a class="code" href="namespaceIntVar.html#ae96c1cd796f723e15dfbf718f1a9c76da22501eeeb48d3d47f802dcb78c88f7ae">IntVar::cons</a>],</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                           S_data[<a class="code" href="namespaceIntVar.html#ae96c1cd796f723e15dfbf718f1a9c76dad22d96cf9b7b4dd875cea33d3ec0b481">IntVar::xmom</a>],</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                           S_data[<a class="code" href="namespaceIntVar.html#ae96c1cd796f723e15dfbf718f1a9c76daa06e9caed4d0b72c322646815c1a96ce">IntVar::ymom</a>],</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                           S_data[<a class="code" href="namespaceIntVar.html#ae96c1cd796f723e15dfbf718f1a9c76dabde409cfd9edf4a3581fe26dfa9613cd">IntVar::zmom</a>]);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="comment">// ***************************************************************************************</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="comment">// Call FillPatch routines for all data</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="comment">// This fills ghost cells/faces from</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <span class="comment">//     1) coarser level if lev &gt; 0</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="comment">//     2) physical boundaries</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="comment">//     3) other grids at the same level</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <span class="comment">// ***************************************************************************************</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <a class="code" href="classERF.html#a17edcb4fd8fa664054acdbcfa0f7d9a3">FillIntermediatePatch</a>(level, time_for_fp, {S_data[<a class="code" href="namespaceIntVar.html#ae96c1cd796f723e15dfbf718f1a9c76da22501eeeb48d3d47f802dcb78c88f7ae">IntVar::cons</a>], xvel_new, yvel_new, zvel_new});</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="comment">// Now we can convert back to momentum on valid+ghost since we have</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <span class="comment">//     filled the ghost regions for both velocity and density</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <a class="code" href="SpatialStencils_8H.html#afc02a222736ea1f0219b287fb472a765">VelocityToMomentum</a>(xvel_new, xvel_new.nGrowVect(),</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                           yvel_new, yvel_new.nGrowVect(),</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                           zvel_new, zvel_new.nGrowVect(),</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                           S_data[<a class="code" href="namespaceIntVar.html#ae96c1cd796f723e15dfbf718f1a9c76da22501eeeb48d3d47f802dcb78c88f7ae">IntVar::cons</a>],</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                           S_data[<a class="code" href="namespaceIntVar.html#ae96c1cd796f723e15dfbf718f1a9c76dad22d96cf9b7b4dd875cea33d3ec0b481">IntVar::xmom</a>],</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                           S_data[<a class="code" href="namespaceIntVar.html#ae96c1cd796f723e15dfbf718f1a9c76daa06e9caed4d0b72c322646815c1a96ce">IntVar::ymom</a>],</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                           S_data[<a class="code" href="namespaceIntVar.html#ae96c1cd796f723e15dfbf718f1a9c76dabde409cfd9edf4a3581fe26dfa9613cd">IntVar::zmom</a>]);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    };</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    apply_bcs(state_old, old_time);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    cons_to_prim(state_old[<a class="code" href="namespaceIntVar.html#ae96c1cd796f723e15dfbf718f1a9c76da22501eeeb48d3d47f802dcb78c88f7ae">IntVar::cons</a>], S_prim);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="comment">//Create function lambdas</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keyword">auto</span> rhs_fun = [&amp;](      Vector&lt;MultiFab&gt;&amp; S_rhs,</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                       <span class="keyword">const</span> Vector&lt;MultiFab&gt;&amp; S_data,</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                       <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> time,</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                       <span class="keyword">const</span> <span class="keywordtype">int</span> rhs_vars=<a class="code" href="namespaceRHSVar.html#a9c3323327b60ac367bfd4f28e8f81459a663b433383c61be43231a25243ec832d">RHSVar::all</a>) {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a43d0b17f6e155691a1e9474526df3af5">verbose</a>) Print() &lt;&lt; <span class="stringliteral">&quot;Calling rhs, time = &quot;</span> &lt;&lt; time &lt;&lt; std::endl;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        Vector &lt;MultiFab&gt; S_scratch;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <a class="code" href="ERF__slow__rhs_8cpp.html#aeb90f678958be8a571b087d0b61f93b6">erf_slow_rhs</a>(level, S_rhs, S_data, S_prim, S_scratch,</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                     xvel_new, yvel_new, zvel_new,</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                     source, advflux, diffflux,</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                     fine_geom, ifr, <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>,</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                     <a class="code" href="classERF.html#a051364b2373d8d86151c0b4a958035bd">m_most</a>, <a class="code" href="classERF.html#a8a99e22b1111c803e31b4afd5fcdea60">domain_bcs_type_d</a>,</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;#ifdef ERF_USE_TERRAIN</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                     z_phys_nd[level], detJ_cc[level],</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                     r0, p0,</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;#<span class="keywordflow">else</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                     dptr_dens_hse, dptr_pres_hse,</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;#endif</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                     dptr_rayleigh_tau, dptr_rayleigh_ubar,</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                     dptr_rayleigh_vbar, dptr_rayleigh_thetabar,</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                     rhs_vars);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    };</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="comment">//Create function lambdas</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keyword">auto</span> slow_rhs_fun = [&amp;](      Vector&lt;MultiFab&gt;&amp; S_rhs,</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                            <span class="keyword">const</span> Vector&lt;MultiFab&gt;&amp; S_data,</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                                  Vector&lt;MultiFab&gt;&amp; S_scratch,</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                            <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> time,</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                            <span class="keyword">const</span> <span class="keywordtype">int</span> rhs_vars=<a class="code" href="namespaceRHSVar.html#a9c3323327b60ac367bfd4f28e8f81459a663b433383c61be43231a25243ec832d">RHSVar::all</a>) {</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a43d0b17f6e155691a1e9474526df3af5">verbose</a>) Print() &lt;&lt; <span class="stringliteral">&quot;Calling slow rhs, time = &quot;</span> &lt;&lt; time &lt;&lt; std::endl;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        <a class="code" href="ERF__slow__rhs_8cpp.html#aeb90f678958be8a571b087d0b61f93b6">erf_slow_rhs</a>(level, S_rhs, S_data, S_prim, S_scratch,</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                     xvel_new, yvel_new, zvel_new,</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                     source, advflux, diffflux,</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                     fine_geom, ifr, <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>, <a class="code" href="classERF.html#a051364b2373d8d86151c0b4a958035bd">m_most</a>, <a class="code" href="classERF.html#a8a99e22b1111c803e31b4afd5fcdea60">domain_bcs_type_d</a>,</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;#ifdef ERF_USE_TERRAIN</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                     z_phys_nd[level], detJ_cc[level],</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                     r0, p0,</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;#<span class="keywordflow">else</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                     dptr_dens_hse, dptr_pres_hse,</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;#endif</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                     dptr_rayleigh_tau, dptr_rayleigh_ubar,</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                     dptr_rayleigh_vbar, dptr_rayleigh_thetabar,</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                     rhs_vars);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    };</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keyword">auto</span> fast_rhs_fun = [&amp;](      Vector&lt;MultiFab&gt;&amp; S_rhs,</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                                  Vector&lt;MultiFab&gt;&amp; S_slow_rhs,</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                                  Vector&lt;MultiFab&gt;&amp; S_stage_data,</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                            <span class="keyword">const</span> Vector&lt;MultiFab&gt;&amp; S_data,</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                                  Vector&lt;MultiFab&gt;&amp; S_scratch,</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                            <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> fast_dt, <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> inv_fac)</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    {</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a43d0b17f6e155691a1e9474526df3af5">verbose</a>) Print() &lt;&lt; <span class="stringliteral">&quot;  Calling fast rhs with dtau = &quot;</span> &lt;&lt; fast_dt &lt;&lt; std::endl;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <a class="code" href="ERF__fast__rhs_8cpp.html#a18222666585d1c3a0c934fc2fadcfd48">erf_fast_rhs</a>(level, S_rhs, S_slow_rhs, S_stage_data, S_prim,</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                     S_data, S_scratch, advflux, fine_geom, ifr, <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>,</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;#ifdef ERF_USE_TERRAIN</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                     z_phys_nd[level], detJ_cc[level], r0, p0,</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;#<span class="keywordflow">else</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                     dptr_dens_hse, dptr_pres_hse,</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;#endif</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                     fast_dt, inv_fac);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    };</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keyword">auto</span> post_update_fun = [&amp;](Vector&lt;MultiFab&gt;&amp; S_data, <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> time_for_fp)</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    {</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        apply_bcs(S_data, time_for_fp);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        cons_to_prim(S_data[<a class="code" href="namespaceIntVar.html#ae96c1cd796f723e15dfbf718f1a9c76da22501eeeb48d3d47f802dcb78c88f7ae">IntVar::cons</a>], S_prim);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    };</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keyword">auto</span> post_substep_fun = [&amp;](Vector&lt;MultiFab&gt;&amp; S_data, <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> time_for_fp)</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    {</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="comment">// TODO: we only need to apply bcs for the &quot;fast&quot; variables -- this would be an optimization</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="comment">//       but shouldn&#39;t affect correctness</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        apply_bcs(S_data, time_for_fp);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    };</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="comment">// ***************************************************************************************</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="comment">// Setup the integrator</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="comment">// **************************************************************************************</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a4a279f0f572da168852d954df55abe2e">use_native_mri</a>) {</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      <a class="code" href="classMRISplitIntegrator.html">MRISplitIntegrator&lt;Vector&lt;MultiFab&gt;</a> &gt; lev_integrator(state_old);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      <span class="comment">// define rhs and &#39;post update&#39; utility function that is called after calculating</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      <span class="comment">// any state data (e.g. at RK stages or at the end of a timestep)</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      lev_integrator.set_slow_rhs(slow_rhs_fun);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      lev_integrator.set_fast_rhs(fast_rhs_fun);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      lev_integrator.set_slow_fast_timestep_ratio(<a class="code" href="classERF.html#ad2e1a979c0ad68e87eaee349beb7e9fd">fixed_mri_dt_ratio</a> &gt; 0 ? <a class="code" href="classERF.html#ad2e1a979c0ad68e87eaee349beb7e9fd">fixed_mri_dt_ratio</a> : <a class="code" href="classERF.html#a3cf7cb2e51eb7b69cb4079ffc6722459">dt_mri_ratio</a>[level]);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      lev_integrator.set_post_update(post_update_fun);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      lev_integrator.set_post_substep(post_substep_fun);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      <span class="comment">// **************************************************************************************</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      <span class="comment">// Integrate for a single timestep</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      <span class="comment">// **************************************************************************************</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      lev_integrator.advance(state_old, state_new, old_time, dt_advance);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      TimeIntegrator&lt;Vector&lt;MultiFab&gt; &gt; lev_integrator(state_old);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      <span class="comment">// define rhs and &#39;post update&#39; utility function that is called after calculating</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      <span class="comment">// any state data (e.g. at RK stages or at the end of a timestep)</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      lev_integrator.set_rhs(rhs_fun);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classERF.html#aa30dffc28e24ac50c880539ca2e36ffd">fixed_fast_dt</a> &gt; 0.0)</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        lev_integrator.set_fast_timestep(<a class="code" href="classERF.html#aa30dffc28e24ac50c880539ca2e36ffd">fixed_fast_dt</a>);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        lev_integrator.set_slow_fast_timestep_ratio(<a class="code" href="classERF.html#ad2e1a979c0ad68e87eaee349beb7e9fd">fixed_mri_dt_ratio</a> &gt; 0 ? <a class="code" href="classERF.html#ad2e1a979c0ad68e87eaee349beb7e9fd">fixed_mri_dt_ratio</a> : <a class="code" href="classERF.html#a3cf7cb2e51eb7b69cb4079ffc6722459">dt_mri_ratio</a>[level]);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      lev_integrator.set_post_update(post_update_fun);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      <span class="comment">// **************************************************************************************</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      <span class="comment">// Integrate for a single timestep</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      <span class="comment">// **************************************************************************************</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      lev_integrator.advance(state_old, state_new, old_time, dt_advance);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    }</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="comment">// **************************************************************************************</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="comment">// Convert updated momentum to updated velocity on faces after we have taken a timestep</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="comment">// **************************************************************************************</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <a class="code" href="MomentumToVelocity_8cpp.html#a79080d9506305b3b98f783cc6c2cda47">MomentumToVelocity</a>(xvel_new, IntVect::TheZeroVector(),</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                       yvel_new, IntVect::TheZeroVector(),</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                       zvel_new, IntVect::TheZeroVector(),</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                       state_new[<a class="code" href="namespaceIntVar.html#ae96c1cd796f723e15dfbf718f1a9c76da22501eeeb48d3d47f802dcb78c88f7ae">IntVar::cons</a>],</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                       state_new[<a class="code" href="namespaceIntVar.html#ae96c1cd796f723e15dfbf718f1a9c76dad22d96cf9b7b4dd875cea33d3ec0b481">IntVar::xmom</a>],</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                       state_new[<a class="code" href="namespaceIntVar.html#ae96c1cd796f723e15dfbf718f1a9c76daa06e9caed4d0b72c322646815c1a96ce">IntVar::ymom</a>],</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                       state_new[<a class="code" href="namespaceIntVar.html#ae96c1cd796f723e15dfbf718f1a9c76dabde409cfd9edf4a3581fe26dfa9613cd">IntVar::zmom</a>]);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="comment">// **************************************************************************************</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="comment">// Get the final cell centered variables after the step</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="comment">// (do this at the very end because its a swap not a copy)</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="comment">// **************************************************************************************</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    std::swap(cons_new, state_new[<a class="code" href="namespaceIntVar.html#ae96c1cd796f723e15dfbf718f1a9c76da22501eeeb48d3d47f802dcb78c88f7ae">IntVar::cons</a>]);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160; </div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    std::swap(flux[0], state_new[<a class="code" href="namespaceIntVar.html#ae96c1cd796f723e15dfbf718f1a9c76da21245d0eca9226a6441feac35602c9be">IntVar::xflux</a>]);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    std::swap(flux[1], state_new[<a class="code" href="namespaceIntVar.html#ae96c1cd796f723e15dfbf718f1a9c76daf204c2311e68c84ad19b3759183bdd09">IntVar::yflux</a>]);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    std::swap(flux[2], state_new[<a class="code" href="namespaceIntVar.html#ae96c1cd796f723e15dfbf718f1a9c76da9b94534904513cb3b68ef8b0c7bfed51">IntVar::zflux</a>]);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="comment">// One final BC fill</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    amrex::Real new_time = old_time + dt_advance;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <a class="code" href="classERF.html#a17edcb4fd8fa664054acdbcfa0f7d9a3">FillIntermediatePatch</a>(level, new_time, {cons_new, xvel_new, yvel_new, zvel_new});</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_aa3151f4f965fcd44456952f69a9c28fc_cgraph.png" border="0" usemap="#classERF_aa3151f4f965fcd44456952f69a9c28fc_cgraph" alt=""/></div>
<map name="classERF_aa3151f4f965fcd44456952f69a9c28fc_cgraph" id="classERF_aa3151f4f965fcd44456952f69a9c28fc_cgraph">
<area shape="rect" title=" " alt="" coords="5,939,140,966"/>
<area shape="rect" href="classMRISplitIntegrator.html#ad78b5d1908a131c3597232a041ca267b" title=" " alt="" coords="229,191,369,232"/>
<area shape="rect" href="ERF__fast__rhs_8cpp.html#a18222666585d1c3a0c934fc2fadcfd48" title=" " alt="" coords="249,797,348,823"/>
<area shape="rect" href="ERF__slow__rhs_8cpp.html#aeb90f678958be8a571b087d0b61f93b6" title=" " alt="" coords="247,442,351,469"/>
<area shape="rect" href="MomentumToVelocity_8cpp.html#a79080d9506305b3b98f783cc6c2cda47" title=" " alt="" coords="217,847,380,874"/>
<area shape="rect" href="classMRISplitIntegrator.html#a26a7a9dca99cfa7c2b5884085e4a4916" title=" " alt="" coords="229,899,369,940"/>
<area shape="rect" href="classMRISplitIntegrator.html#af8fc7299736dd82bc73206afce2af746" title=" " alt="" coords="227,964,370,1005"/>
<area shape="rect" href="classMRISplitIntegrator.html#a2f725549d38dfef0890da90e604e7192" title=" " alt="" coords="229,1029,369,1071"/>
<area shape="rect" href="classMRISplitIntegrator.html#ad31fb2cda1fc2dce80820ed7c4a3c052" title=" " alt="" coords="188,1095,409,1136"/>
<area shape="rect" href="classMRISplitIntegrator.html#a2c7d34b0ebbea32725fefcfa6053c9a8" title=" " alt="" coords="229,1160,369,1201"/>
<area shape="rect" href="SpatialStencils_8H.html#afc02a222736ea1f0219b287fb472a765" title=" " alt="" coords="217,1226,380,1253"/>
<area shape="rect" href="classMRISplitIntegrator.html#aba63019a6ac3ea9135772dcd91f49c86" title=" " alt="" coords="457,5,680,47"/>
<area shape="rect" href="Advection_8cpp.html#aa3340ec12693f3f7157373ddd51ffb4a" title=" " alt="" coords="488,746,649,773"/>
<area shape="rect" href="TerrainMetrics_8H.html#aa583c7ebfef25f449af86111b0572533" title=" " alt="" coords="756,797,924,823"/>
<area shape="rect" href="TerrainMetrics_8H.html#adcaa7dd1b91191b54eb2f59a4cbb567b" title=" " alt="" coords="756,695,924,722"/>
<area shape="rect" href="TerrainMetrics_8H.html#adb62ee7692551a4bacfa38a3e8592fdf" title=" " alt="" coords="783,923,897,950"/>
<area shape="rect" href="EOS_8H.html#ab7699bc24a134b44f2b6de545901a182" title=" " alt="" coords="499,847,639,874"/>
<area shape="rect" href="TerrainMetrics_8H.html#a81366cf4ca04adcfbf0988099b906cd7" title=" " alt="" coords="511,949,626,975"/>
<area shape="rect" href="Interpolation_8cpp.html#a3046bc73f0e1b5c442705c4fee050e45" title=" " alt="" coords="743,518,937,545"/>
<area shape="rect" href="Interpolation_8cpp.html#a7321650cd25732fac66a766e7c20d477" title=" " alt="" coords="1037,315,1159,342"/>
<area shape="rect" href="Advection_8cpp.html#a0ffa6a8e256960ea70b649cdd87936b7" title=" " alt="" coords="484,543,653,570"/>
<area shape="rect" href="Advection_8cpp.html#ab87576e21eae735694d8601d0b7b6250" title=" " alt="" coords="485,442,653,469"/>
<area shape="rect" href="Advection_8cpp.html#a2a41c25dab85a5d86445206df6dd5515" title=" " alt="" coords="484,493,653,519"/>
<area shape="rect" href="TerrainMetrics_8H.html#a9b9ea28f72372c04f5a671bfb72ef285" title=" " alt="" coords="482,239,655,266"/>
<area shape="rect" href="PBLModels_8H.html#a5f1ee0e32da7a54a6b5a3670fd401bc6" title=" " alt="" coords="473,290,664,317"/>
<area shape="rect" href="EddyViscosity_8H.html#a6501a4340bdc21e1b6ac8dad90b6e4fb" title=" " alt="" coords="753,71,927,98"/>
<area shape="rect" href="ComputeTurbulentViscosity_8cpp.html#ab6df21759a0fbc49cc70bf928780e275" title=" " alt="" coords="469,122,669,149"/>
<area shape="rect" href="Diffusion_8cpp.html#afd13530393efae27de451b0d4a2a8275" title=" " alt="" coords="492,594,645,621"/>
<area shape="rect" href="Diffusion_8cpp.html#a5bfd10fe63061ac7bf3ca1f01d3e9287" title=" " alt="" coords="491,341,646,367"/>
<area shape="rect" href="EOS_8H.html#a62f564807713abf368002e68c9b40e1e" title=" " alt="" coords="494,391,643,418"/>
<area shape="rect" href="Interpolation_8cpp.html#a30da715cd63557a92abefcfc967a4fe8" title=" " alt="" coords="467,173,670,215"/>
<area shape="rect" href="EddyViscosity_8H.html#a0e836a37ea501d7590d1a6c2cc280c9a" title=" " alt="" coords="1029,122,1167,149"/>
<area shape="rect" href="StrainRate_8H.html#a8ac68f19d36d81499a2455b68156a452" title=" " alt="" coords="1244,173,1349,199"/>
<area shape="rect" href="StrainRate_8H.html#a1875a27a119f7d397b90cea2db6d78fb" title=" " alt="" coords="1397,426,1503,453"/>
<area shape="rect" href="StrainRate_8H.html#a418dc497481811accc55011eab2ccc40" title=" " alt="" coords="1397,350,1503,377"/>
<area shape="rect" href="StrainRate_8H.html#a215aa33cfd329b4856b0623dd43e942f" title=" " alt="" coords="1244,223,1349,250"/>
<area shape="rect" href="StrainRate_8H.html#a5e8c93e1026165d28a35772151daa5a5" title=" " alt="" coords="1397,502,1503,529"/>
<area shape="rect" href="StrainRate_8H.html#a92ba368343a7bf7fea37976eb6e5e82b" title=" " alt="" coords="1244,274,1349,301"/>
<area shape="rect" href="StrainRate_8H.html#afbebd7a5caa9e22797c3b0336613cda4" title=" " alt="" coords="1551,426,1641,453"/>
<area shape="rect" href="ComputeTurbulentViscosity_8cpp.html#a2f1a03ceadfdae92cffc0005a119ce1e" title=" " alt="" coords="729,122,951,149"/>
<area shape="rect" href="PBLModels_8H.html#a6b7b829386b28f2bcdc63d51b754896c" title=" " alt="" coords="728,173,952,199"/>
<area shape="rect" href="SpatialStencils_8H.html#a064b000717a0cd0ee754310df4a8bf91" title=" " alt="" coords="763,582,917,609"/>
<area shape="rect" href="ExpansionRate_8H.html#a62040e6a2ff50d4c39f83bea3c2da1c1" title=" " alt="" coords="1009,557,1187,583"/>
<area shape="rect" href="StrainRate_8H.html#a859d45bf3d575320908933f1dac6198d" title=" " alt="" coords="1023,401,1173,427"/>
<area shape="rect" href="StressTerm_8H.html#ae08c36d0cdab8a95d0e4042d55dc4d94" title=" " alt="" coords="1000,607,1196,634"/>
<area shape="rect" href="StrainRate_8H.html#a2fbe1b896e549d0b060c491e495f593c" title=" " alt="" coords="1244,426,1349,453"/>
<area shape="rect" href="StrainRate_8H.html#acdaf0797abe21f888ac81a01be4355b9" title=" " alt="" coords="1244,325,1349,351"/>
<area shape="rect" href="StrainRate_8H.html#acd99df2bffb1593b07b1dc9ab816bf9f" title=" " alt="" coords="1244,527,1349,554"/>
<area shape="rect" href="Diffusion_8cpp.html#ac6b47884c250647cfa0c56d209918b40" title=" " alt="" coords="729,341,951,367"/>
<area shape="rect" href="Interpolation_8cpp.html#a156aef3decb40de82fa31cef7199aaba" title=" " alt="" coords="751,257,929,283"/>
</map>
</div>

</div>
</div>
<a id="ae994c0e7f0d87b787de9bb971f0da64c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae994c0e7f0d87b787de9bb971f0da64c">&#9670;&nbsp;</a></span>erf_enforce_hse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::erf_enforce_hse </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Vector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>dens</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Vector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>pres</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;{</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    AMREX_ALWAYS_ASSERT(dens.size() == pres.size());</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    amrex::Real l_gravity = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a47a54f2e44955202b5b437e4b1b4a61b">gravity</a>;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> geomdata = geom[lev].data();</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> dz = geomdata.CellSize(2);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordtype">int</span> nz = geom[lev].Domain().length(2);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="comment">// We start by assuming pressure on the ground is p_0 (in ERF_Constants.H)</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="comment">// Note that gravity is positive</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>* hptr_dens = <a class="code" href="classERF.html#a7e89a339e79b2b4f177a05e9f0df32fa">h_dens_hse</a>[lev].data() + <a class="code" href="classERF.html#addf0fb2aae0efaa649c69685a4dcca83">ng_dens_hse</a>;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>* hptr_pres = <a class="code" href="classERF.html#aff6f5d2bd989b5a0f7c28e2e10e27e8c">h_pres_hse</a>[lev].data() + <a class="code" href="classERF.html#a87dc6c0720462bfd088c909289cdca0b">ng_pres_hse</a>;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> dens_interp;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="comment">// We integrate to the first cell (and below) by using rho in this cell</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="comment">// If gravity == 0 this is constant pressure</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="comment">// If gravity != 0, hence this is a wall, this gives gp0 = dens[0] * gravity</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="comment">// (dens_hse*gravity would also be dens[0]*gravity because we use foextrap for rho at k = -1)</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="comment">// Note ng_pres_hse = 1</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    hptr_pres[-1] = <a class="code" href="ERF__Constants_8H.html#a60be2e6257954ef746019c916741cb2c">p_0</a> + (0.5*dz) * dens[0] * l_gravity;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    hptr_pres[ 0] = <a class="code" href="ERF__Constants_8H.html#a60be2e6257954ef746019c916741cb2c">p_0</a> - (0.5*dz) * dens[0] * l_gravity;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="comment">//amrex::Print() &lt;&lt; &quot;erf_enforce_hse: p[-1] = &quot; &lt;&lt; hptr_pres[-1] &lt;&lt; &quot; (ghost)&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="comment">//amrex::Print() &lt;&lt; &quot;erf_enforce_hse: p[ 0] = &quot; &lt;&lt; hptr_pres[ 0] &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 1; k &lt; nz+<a class="code" href="classERF.html#a87dc6c0720462bfd088c909289cdca0b">ng_pres_hse</a>; k++)</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;       dens_interp = 0.5*(hptr_dens[k] + hptr_dens[k-1]);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;       hptr_pres[k] = hptr_pres[k-1] - dz * dens_interp * l_gravity;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    }</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a18e6dbbf968b4492e78aa427791620f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18e6dbbf968b4492e78aa427791620f4">&#9670;&nbsp;</a></span>ErrorEst()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::ErrorEst </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::TagBoxArray &amp;&#160;</td>
          <td class="paramname"><em>tags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ngrow</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;{</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> clearval = TagBox::CLEAR;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span>   tagval = TagBox::SET;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt; <a class="code" href="classERF.html#ac81b3dfd7c6f21ba8479834e2ff1e652">ref_tags</a>.size(); ++j)</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    {</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;        std::unique_ptr&lt;MultiFab&gt; mf;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;        <span class="comment">// This will work for static refinement</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;        <a class="code" href="classERF.html#ac81b3dfd7c6f21ba8479834e2ff1e652">ref_tags</a>[j](tags,mf.get(),clearval,tagval,time,level,geom[level]);</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  }</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6b1d727e63de2e49aa4f8e00b0dda1d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b1d727e63de2e49aa4f8e00b0dda1d5">&#9670;&nbsp;</a></span>estTimeStep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> ERF::estTimeStep </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long &amp;&#160;</td>
          <td class="paramname"><em>dt_fast_ratio</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;{</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  BL_PROFILE(<span class="stringliteral">&quot;ERF::estTimeStep()&quot;</span>);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  amrex::Real estdt_comp = 1.e20;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  amrex::Real estdt_lowM = 1.e20;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keyword">auto</span> <span class="keyword">const</span> dxinv = geom[level].InvCellSizeArray();</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  MultiFab <span class="keyword">const</span>&amp; S_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[level][<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>];</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  MultiFab ccvel(grids[level],dmap[level],3,0);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  average_face_to_cellcenter(ccvel,0,</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      Array&lt;const MultiFab*,3&gt;{&amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[level][<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                               &amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[level][<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                               &amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[level][<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>]});</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> estdt_comp_inv = amrex::ReduceMax(S_new, ccvel, 0,</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;       [=] AMREX_GPU_HOST_DEVICE (Box <span class="keyword">const</span>&amp; b,</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                                  Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; s,</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                                  Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; <a class="code" href="DataStruct_8H.html#a07130f00a795700d6b2b83f773b807b4a7b774effe4a349c6dd82ad4f4f21d34c">u</a>) -&gt; <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;       {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;           <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> new_comp_dt = -1.e100;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;           amrex::Loop(b, [=,&amp;new_comp_dt] (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;           {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;               <span class="keyword">const</span> amrex::Real rho      = s(i, j, k, <a class="code" href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;               <span class="keyword">const</span> amrex::Real rhotheta = s(i, j, k, <a class="code" href="IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;               amrex::Real pressure = <a class="code" href="EOS_8H.html#a292ce90ab26c75f4a444808a807b532b">getPgivenRTh</a>(rhotheta);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;               amrex::Real c = std::sqrt(<a class="code" href="ERF__Constants_8H.html#ae8ca591ba2325c0ad8b464de45f4c6b3">Gamma</a> * pressure / rho);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;               new_comp_dt = amrex::max(((amrex::Math::abs(<a class="code" href="DataStruct_8H.html#a07130f00a795700d6b2b83f773b807b4a7b774effe4a349c6dd82ad4f4f21d34c">u</a>(i,j,k,0))+c)*dxinv[0]),</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                                        ((amrex::Math::abs(<a class="code" href="DataStruct_8H.html#a07130f00a795700d6b2b83f773b807b4a7b774effe4a349c6dd82ad4f4f21d34c">u</a>(i,j,k,1))+c)*dxinv[1]),</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                                        ((amrex::Math::abs(<a class="code" href="DataStruct_8H.html#a07130f00a795700d6b2b83f773b807b4a7b774effe4a349c6dd82ad4f4f21d34c">u</a>(i,j,k,2))+c)*dxinv[2]), new_comp_dt);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;           });</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;           <span class="keywordflow">return</span> new_comp_dt;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;       });</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;   amrex::ParallelDescriptor::ReduceRealMax(estdt_comp_inv);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;   estdt_comp = <a class="code" href="classERF.html#ae52fe861ffb051a11920238c8210d69f">cfl</a> / estdt_comp_inv;;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;   <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> estdt_lowM_inv = amrex::ReduceMax(ccvel, 0,</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;       [=] AMREX_GPU_HOST_DEVICE (Box <span class="keyword">const</span>&amp; b,</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                                  Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; <a class="code" href="DataStruct_8H.html#a07130f00a795700d6b2b83f773b807b4a7b774effe4a349c6dd82ad4f4f21d34c">u</a>) -&gt; <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;       {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;           <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> new_lm_dt = -1.e100;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;           amrex::Loop(b, [=,&amp;new_lm_dt] (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;           {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;               new_lm_dt = amrex::max(((amrex::Math::abs(<a class="code" href="DataStruct_8H.html#a07130f00a795700d6b2b83f773b807b4a7b774effe4a349c6dd82ad4f4f21d34c">u</a>(i,j,k,0)))*dxinv[0]),</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                                      ((amrex::Math::abs(<a class="code" href="DataStruct_8H.html#a07130f00a795700d6b2b83f773b807b4a7b774effe4a349c6dd82ad4f4f21d34c">u</a>(i,j,k,1)))*dxinv[1]),</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                                      ((amrex::Math::abs(<a class="code" href="DataStruct_8H.html#a07130f00a795700d6b2b83f773b807b4a7b774effe4a349c6dd82ad4f4f21d34c">u</a>(i,j,k,2)))*dxinv[2]), new_lm_dt);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;           });</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;           <span class="keywordflow">return</span> new_lm_dt;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;       });</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;   amrex::ParallelDescriptor::ReduceRealMax(estdt_lowM_inv);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;   <span class="keywordflow">if</span> (estdt_lowM_inv &gt; 0.0_rt)</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;       estdt_lowM = <a class="code" href="classERF.html#ae52fe861ffb051a11920238c8210d69f">cfl</a> / estdt_lowM_inv;;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a43d0b17f6e155691a1e9474526df3af5">verbose</a>) {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a6e9d302b096a12999c8ff4a6bfa9a072">fixed_dt</a> &lt;= 0.0) {</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Using cfl = &quot;</span> &lt;&lt; <a class="code" href="classERF.html#ae52fe861ffb051a11920238c8210d69f">cfl</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Fast  dt at level &quot;</span> &lt;&lt; level &lt;&lt; <span class="stringliteral">&quot;:  &quot;</span> &lt;&lt; estdt_comp &lt;&lt; std::endl;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="keywordflow">if</span> (estdt_lowM_inv &gt; 0.0_rt) {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Slow  dt at level &quot;</span> &lt;&lt; level &lt;&lt; <span class="stringliteral">&quot;:  &quot;</span> &lt;&lt; estdt_lowM &lt;&lt; std::endl;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Slow  dt at level &quot;</span> &lt;&lt; level &lt;&lt; <span class="stringliteral">&quot;: undefined &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        }</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a6e9d302b096a12999c8ff4a6bfa9a072">fixed_dt</a> &gt; 0.0) {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Based on cfl of 1.0 &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Fast  dt at level &quot;</span> &lt;&lt; level &lt;&lt; <span class="stringliteral">&quot; would be:  &quot;</span> &lt;&lt; estdt_comp/<a class="code" href="classERF.html#ae52fe861ffb051a11920238c8210d69f">cfl</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="keywordflow">if</span> (estdt_lowM_inv &gt; 0.0_rt) {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Slow  dt at level &quot;</span> &lt;&lt; level &lt;&lt; <span class="stringliteral">&quot; would be:  &quot;</span> &lt;&lt; estdt_lowM/<a class="code" href="classERF.html#ae52fe861ffb051a11920238c8210d69f">cfl</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Slow  dt at level &quot;</span> &lt;&lt; level &lt;&lt; <span class="stringliteral">&quot; would be undefined &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        }</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Fixed dt at level &quot;</span> &lt;&lt; level &lt;&lt; <span class="stringliteral">&quot;       is:  &quot;</span> &lt;&lt; <a class="code" href="classERF.html#a6e9d302b096a12999c8ff4a6bfa9a072">fixed_dt</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#aa30dffc28e24ac50c880539ca2e36ffd">fixed_fast_dt</a> &gt; 0.0) {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Fixed fast dt at level &quot;</span> &lt;&lt; level &lt;&lt; <span class="stringliteral">&quot;       is:  &quot;</span> &lt;&lt; <a class="code" href="classERF.html#aa30dffc28e24ac50c880539ca2e36ffd">fixed_fast_dt</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        }</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  }</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a6e9d302b096a12999c8ff4a6bfa9a072">fixed_dt</a> &gt; 0. &amp;&amp; <a class="code" href="classERF.html#aa30dffc28e24ac50c880539ca2e36ffd">fixed_fast_dt</a> &gt; 0.) {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      dt_fast_ratio = <span class="keyword">static_cast&lt;</span><span class="keywordtype">long</span><span class="keyword">&gt;</span>( <a class="code" href="classERF.html#a6e9d302b096a12999c8ff4a6bfa9a072">fixed_dt</a> / <a class="code" href="classERF.html#aa30dffc28e24ac50c880539ca2e36ffd">fixed_fast_dt</a> );</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a6e9d302b096a12999c8ff4a6bfa9a072">fixed_dt</a> &gt; 0.) {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      dt_fast_ratio = <span class="keyword">static_cast&lt;</span><span class="keywordtype">long</span><span class="keyword">&gt;</span>( std::ceil((<a class="code" href="classERF.html#a6e9d302b096a12999c8ff4a6bfa9a072">fixed_dt</a>/estdt_comp)) );</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      dt_fast_ratio = (estdt_lowM_inv &gt; 0.0) ? <span class="keyword">static_cast&lt;</span><span class="keywordtype">long</span><span class="keyword">&gt;</span>( std::ceil((estdt_lowM/estdt_comp)) ) : 1;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  }</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a43d0b17f6e155691a1e9474526df3af5">verbose</a>) {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      <span class="keywordflow">if</span> ( dt_fast_ratio%2 == 0) { <span class="comment">// if already even</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;          amrex::Print() &lt;&lt; <span class="stringliteral">&quot;ratio is: &quot;</span> &lt;&lt; dt_fast_ratio &lt;&lt; std::endl;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;          amrex::Print() &lt;&lt; <span class="stringliteral">&quot;smallest ratio is: &quot;</span> &lt;&lt; dt_fast_ratio &lt;&lt; std::endl;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;          dt_fast_ratio += 1;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;          amrex::Print() &lt;&lt; <span class="stringliteral">&quot;but smallest even ratio is: &quot;</span> &lt;&lt; dt_fast_ratio &lt;&lt; std::endl;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      }</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  }</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a6e9d302b096a12999c8ff4a6bfa9a072">fixed_dt</a> &gt; 0.0) {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classERF.html#a6e9d302b096a12999c8ff4a6bfa9a072">fixed_dt</a>;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#aad09820d3e29638db7c3d499304c8aed">use_lowM_dt</a>) {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="keywordflow">return</span> estdt_lowM;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="keywordflow">return</span> estdt_comp;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    }</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  }</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a6b1d727e63de2e49aa4f8e00b0dda1d5_cgraph.png" border="0" usemap="#classERF_a6b1d727e63de2e49aa4f8e00b0dda1d5_cgraph" alt=""/></div>
<map name="classERF_a6b1d727e63de2e49aa4f8e00b0dda1d5_cgraph" id="classERF_a6b1d727e63de2e49aa4f8e00b0dda1d5_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,141,32"/>
<area shape="rect" href="EOS_8H.html#a292ce90ab26c75f4a444808a807b532b" title=" " alt="" coords="189,5,300,32"/>
</map>
</div>

</div>
</div>
<a id="a0be12798b46f52fa4b5a995f147c3f96"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0be12798b46f52fa4b5a995f147c3f96">&#9670;&nbsp;</a></span>Evolve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::Evolve </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;{</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cur_time = <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0];</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="comment">// Take one coarse timestep by calling timeStep -- which recursively calls timeStep</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="comment">//      for finer levels (with or without subcycling)</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> step = <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[0]; step &lt; <a class="code" href="classERF.html#a0634154e8e58379c495c3e7fe7c5e4d6">max_step</a> &amp;&amp; cur_time &lt; <a class="code" href="classERF.html#a405556a52bef334ab68294c1a540e107">stop_time</a>; ++step)</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;\nCoarse STEP &quot;</span> &lt;&lt; step+1 &lt;&lt; <span class="stringliteral">&quot; starts ...&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <a class="code" href="classERF.html#a62a5ed3c3806eaa918257e0ad1382df5">ComputeDt</a>();</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="comment">// Make sure we have read enough of the boundary plane data to make it through this timestep</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a80ad08512968ec45635df68abe66b1fc">input_bndry_planes</a>)</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        {</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;read_input_files(cur_time,<a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[0],<a class="code" href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">m_bc_extdir_vals</a>);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        }</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <span class="keywordtype">int</span> lev = 0;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="keywordtype">int</span> iteration = 1;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <a class="code" href="classERF.html#aff397ccf7eb99c51d7c705a35e85ec5f">timeStep</a>(lev, cur_time, iteration);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        cur_time  += <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[0];</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Coarse STEP &quot;</span> &lt;&lt; step+1 &lt;&lt; <span class="stringliteral">&quot; ends.&quot;</span> &lt;&lt; <span class="stringliteral">&quot; TIME = &quot;</span> &lt;&lt; cur_time</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot; DT = &quot;</span> &lt;&lt; <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[0]  &lt;&lt; std::endl;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#abe64c2ff781da4cc0642ee1d29c912d6">plot_int</a> &gt; 0 &amp;&amp; (step+1) % <a class="code" href="classERF.html#abe64c2ff781da4cc0642ee1d29c912d6">plot_int</a> == 0) {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            <a class="code" href="classERF.html#a4e3d0f4486b62037fce08fca0aa2d0a9">last_plot_file_step</a> = step+1;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            <a class="code" href="classERF.html#abed910c4bcc14524b3c1a7d353d40de5">WritePlotFile</a>();</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        }</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a1f48ec3caf326a6b1b986d061d36ee90">check_int</a> &gt; 0 &amp;&amp; (step+1) % <a class="code" href="classERF.html#a1f48ec3caf326a6b1b986d061d36ee90">check_int</a> == 0) {</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            <a class="code" href="classERF.html#a02722d16f3c26efe590702200f1296d7">last_check_file_step</a> = step+1;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="preprocessor">#ifdef ERF_USE_NETCDF</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32e0d0f5ae0db18ee81f9d4325a14f64">check_type</a> == <span class="stringliteral">&quot;netcdf&quot;</span>) {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;               WriteNCCheckpointFile();</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            }</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32e0d0f5ae0db18ee81f9d4325a14f64">check_type</a> == <span class="stringliteral">&quot;native&quot;</span>) {</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;               <a class="code" href="classERF.html#ad101fd46096db2d6b21544bfede6551f">WriteCheckpointFile</a>();</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            }</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        }</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <a class="code" href="classERF.html#a58f6683aff0fbe6949bfe8b49275a8b3">post_timestep</a>(step, cur_time, <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[0]);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="preprocessor">#ifdef AMREX_MEM_PROFILING</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            std::ostringstream ss;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            ss &lt;&lt; <span class="stringliteral">&quot;[STEP &quot;</span> &lt;&lt; step+1 &lt;&lt; <span class="stringliteral">&quot;]&quot;</span>;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            MemProfiler::report(ss.str());</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        }</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <span class="keywordflow">if</span> (cur_time &gt;= <a class="code" href="classERF.html#a405556a52bef334ab68294c1a540e107">stop_time</a> - 1.e-6*<a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[0]) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    }</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#abe64c2ff781da4cc0642ee1d29c912d6">plot_int</a> &gt; 0 &amp;&amp; <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[0] &gt; <a class="code" href="classERF.html#a4e3d0f4486b62037fce08fca0aa2d0a9">last_plot_file_step</a>) {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <a class="code" href="classERF.html#abed910c4bcc14524b3c1a7d353d40de5">WritePlotFile</a>();</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    }</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a1f48ec3caf326a6b1b986d061d36ee90">check_int</a> &gt; 0 &amp;&amp; <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[0] &gt; <a class="code" href="classERF.html#a02722d16f3c26efe590702200f1296d7">last_check_file_step</a>) {</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="preprocessor">#ifdef ERF_USE_NETCDF</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32e0d0f5ae0db18ee81f9d4325a14f64">check_type</a> == <span class="stringliteral">&quot;netcdf&quot;</span>) {</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;           WriteNCCheckpointFile();</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        }</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32e0d0f5ae0db18ee81f9d4325a14f64">check_type</a> == <span class="stringliteral">&quot;native&quot;</span>) {</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;           <a class="code" href="classERF.html#ad101fd46096db2d6b21544bfede6551f">WriteCheckpointFile</a>();</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        }</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    }</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a0be12798b46f52fa4b5a995f147c3f96_icgraph.png" border="0" usemap="#classERF_a0be12798b46f52fa4b5a995f147c3f96_icgraph" alt=""/></div>
<map name="classERF_a0be12798b46f52fa4b5a995f147c3f96_icgraph" id="classERF_a0be12798b46f52fa4b5a995f147c3f96_icgraph">
<area shape="rect" title=" " alt="" coords="108,5,207,32"/>
<area shape="rect" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,60,32"/>
</map>
</div>

</div>
</div>
<a id="a18cd93c567c9ca162e07433ed7345608"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18cd93c567c9ca162e07433ed7345608">&#9670;&nbsp;</a></span>fill_rhs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::fill_rhs </td>
          <td>(</td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>rhs_mf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>state_mf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Geometry &amp;&#160;</td>
          <td class="paramname"><em>geom</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a7ba9c9e09efe07e5f2404be80a9af5d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ba9c9e09efe07e5f2404be80a9af5d2">&#9670;&nbsp;</a></span>FillCoarsePatch()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::FillCoarsePatch </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>mf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>icomp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ncomp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>var_idx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;{</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    AMREX_ASSERT(lev &gt; 0);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160; </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keywordtype">int</span> bccomp;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    amrex::Interpolater* mapper;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160; </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keywordflow">if</span> (var_idx == <a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>)</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    {</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        bccomp = 0;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        mapper = &amp;cell_cons_interp;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    }</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (var_idx == <a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca2a10a6e726515894b07621908abd4c0c">Vars::xvel</a> || var_idx == <a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca35b6db75aef9a4eca57e85396dc5dc12">Vars::xmom</a>)</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    {</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        bccomp = <a class="code" href="IndexDefines_8H.html#ad5195ac8f863f5a9a7eaa0db094f7639">NVAR</a>;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        mapper = &amp;face_linear_interp;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    }</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (var_idx == <a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a> || var_idx == <a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1caa92727db248ec616aa835c2faa22f44c">Vars::ymom</a>)</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    {</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        bccomp = <a class="code" href="IndexDefines_8H.html#ad5195ac8f863f5a9a7eaa0db094f7639">NVAR</a>+1;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        mapper = &amp;face_linear_interp;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    }</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (var_idx == <a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a> || var_idx == <a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1cada7d061afb1d0d7089d9dfe4874c965d">Vars::zmom</a>)</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    {</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        bccomp = <a class="code" href="IndexDefines_8H.html#ad5195ac8f863f5a9a7eaa0db094f7639">NVAR</a>+2;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        mapper = &amp;face_linear_interp;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    }</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160; </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <a class="code" href="structTimeInterpolatedData.html">TimeInterpolatedData</a> cdata = <a class="code" href="classERF.html#a92248817d31fce8771fba3532d819421">GetDataAtTime</a>(lev-1, time);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <a class="code" href="structTimeInterpolatedData.html">TimeInterpolatedData</a> fdata = <a class="code" href="classERF.html#a92248817d31fce8771fba3532d819421">GetDataAtTime</a>(lev  , time);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    Vector&lt;MultiFab*&gt; cmf = {&amp;cdata.<a class="code" href="structTimeInterpolatedData.html#a65f3edf3f03a779a931f5c58bd438602">get_var</a>(var_idx)};</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    Vector&lt;MultiFab*&gt; fmf = {&amp;fdata.<a class="code" href="structTimeInterpolatedData.html#a65f3edf3f03a779a931f5c58bd438602">get_var</a>(var_idx)};</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    Vector&lt;Real&gt; ctime = {cdata.<a class="code" href="structTimeInterpolatedData.html#a3f1217eba0582186b1ea1b43babcc5f4">get_time</a>()};</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    Vector&lt;Real&gt; ftime = {fdata.<a class="code" href="structTimeInterpolatedData.html#a3f1217eba0582186b1ea1b43babcc5f4">get_time</a>()};</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <a class="code" href="classERFPhysBCFunct.html">ERFPhysBCFunct</a> cphysbc(lev-1,geom[lev-1],<a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>,<a class="code" href="classERF.html#a8a99e22b1111c803e31b4afd5fcdea60">domain_bcs_type_d</a>,var_idx,cdata,</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                           <a class="code" href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">m_bc_extdir_vals</a>,</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;#ifdef ERF_USE_TERRAIN</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                           z_phys_nd[lev-1],detJ_cc[lev-1],</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;#endif</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;#ifdef ERF_USE_NETCDF</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                           <a class="code" href="classERF.html#a35360b65d1afd233a6e6461938fa4522">bdy_data_xlo</a>, <a class="code" href="classERF.html#a4ac5b4b865dc8a029812bf1a20cd9b9b">bdy_data_xhi</a>, <a class="code" href="classERF.html#a21e2e459ae54d580e40f0ffdbcdc68a4">bdy_data_ylo</a>, <a class="code" href="classERF.html#aaa1c7e25ca002544fc80dcea620bda8d">bdy_data_yhi</a>,</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;#endif</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                           <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <a class="code" href="classERFPhysBCFunct.html">ERFPhysBCFunct</a> fphysbc(lev,geom[lev],<a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>,<a class="code" href="classERF.html#a8a99e22b1111c803e31b4afd5fcdea60">domain_bcs_type_d</a>,var_idx,fdata,</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                           <a class="code" href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">m_bc_extdir_vals</a>,</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;#ifdef ERF_USE_TERRAIN</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                           z_phys_nd[lev],detJ_cc[lev],</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;#endif</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;#ifdef ERF_USE_NETCDF</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                           <a class="code" href="classERF.html#a35360b65d1afd233a6e6461938fa4522">bdy_data_xlo</a>, <a class="code" href="classERF.html#a4ac5b4b865dc8a029812bf1a20cd9b9b">bdy_data_xhi</a>, <a class="code" href="classERF.html#a21e2e459ae54d580e40f0ffdbcdc68a4">bdy_data_ylo</a>, <a class="code" href="classERF.html#aaa1c7e25ca002544fc80dcea620bda8d">bdy_data_yhi</a>,</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;#endif</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                           <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    amrex::InterpFromCoarseLevel(mf, time, *cmf[0], 0, icomp, ncomp, geom[lev-1], geom[lev],</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                                    cphysbc, 0, fphysbc, 0, refRatio(lev-1),</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                                    mapper, <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>, bccomp);</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a7ba9c9e09efe07e5f2404be80a9af5d2_cgraph.png" border="0" usemap="#classERF_a7ba9c9e09efe07e5f2404be80a9af5d2_cgraph" alt=""/></div>
<map name="classERF_a7ba9c9e09efe07e5f2404be80a9af5d2_cgraph" id="classERF_a7ba9c9e09efe07e5f2404be80a9af5d2_cgraph">
<area shape="rect" title=" " alt="" coords="5,46,159,73"/>
<area shape="rect" href="structTimeInterpolatedData.html#a3f1217eba0582186b1ea1b43babcc5f4" title=" " alt="" coords="207,5,372,47"/>
<area shape="rect" href="structTimeInterpolatedData.html#a65f3edf3f03a779a931f5c58bd438602" title=" " alt="" coords="207,71,372,112"/>
</map>
</div>

</div>
</div>
<a id="a252eec287326f8dcc72dee7f3cc105c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a252eec287326f8dcc72dee7f3cc105c4">&#9670;&nbsp;</a></span>FillCoarsePatchAllVars()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::FillCoarsePatchAllVars </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Vector&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>vmf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;{</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> var_idx = 0; var_idx &lt; vmf.size(); ++var_idx) {</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        <a class="code" href="classERF.html#a7ba9c9e09efe07e5f2404be80a9af5d2">FillCoarsePatch</a>(lev, time, vmf[var_idx], 0, vmf[var_idx].nComp(), var_idx);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    }</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a17edcb4fd8fa664054acdbcfa0f7d9a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17edcb4fd8fa664054acdbcfa0f7d9a3">&#9670;&nbsp;</a></span>FillIntermediatePatch()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::FillIntermediatePatch </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Vector&lt; std::reference_wrapper&lt; amrex::MultiFab &gt; &gt;&#160;</td>
          <td class="paramname"><em>mfs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>rho_only</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;{</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordtype">int</span> bccomp;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    amrex::Interpolater* mapper;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <a class="code" href="structTimeInterpolatedData.html">TimeInterpolatedData</a> level_data;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="comment">// We should always pass cons, xvel, yvel, and zvel (in that order) in the mfs vector</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    AMREX_ALWAYS_ASSERT(mfs.size() == <a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca5deccaa24d5e74279425d7749f7d1494">Vars::NumTypes</a>);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> imf = 0; imf &lt; <a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca5deccaa24d5e74279425d7749f7d1494">Vars::NumTypes</a>; ++imf) {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        level_data.<a class="code" href="structTimeInterpolatedData.html#a3b9292eb3012672361abacc2ab7d9b2c">add_var</a>(&amp;mfs[imf].get(), level_data.<a class="code" href="structTimeInterpolatedData.html#a39ab53c6a67f3b87c895483a89e2fc0f">non_owning</a>);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    }</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    level_data.<a class="code" href="structTimeInterpolatedData.html#a0d6dcefbf7407a24669d2a37c7f558d4">set_time</a>(time);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160; </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> var_idx = 0; var_idx &lt; <a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca5deccaa24d5e74279425d7749f7d1494">Vars::NumTypes</a>; ++var_idx)</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        <span class="keywordflow">if</span> (rho_only &amp;&amp; var_idx != <a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        MultiFab&amp; mf = mfs[var_idx].get();</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> icomp = 0;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <span class="keywordtype">int</span> ncomp = mf.nComp();</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <span class="keywordflow">if</span> (rho_only &amp;&amp; var_idx == <a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>) ncomp = 1;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <span class="keywordflow">if</span> (var_idx == <a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>)</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        {</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            bccomp = 0;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            mapper = &amp;cell_cons_interp;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        }</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (var_idx == <a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>)</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        {</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            bccomp = <a class="code" href="IndexDefines_8H.html#ad5195ac8f863f5a9a7eaa0db094f7639">NVAR</a>;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            mapper = &amp;face_linear_interp;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (var_idx == <a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>)</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        {</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            bccomp = <a class="code" href="IndexDefines_8H.html#ad5195ac8f863f5a9a7eaa0db094f7639">NVAR</a>+1;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            mapper = &amp;face_linear_interp;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        }</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (var_idx == <a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>)</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            bccomp = <a class="code" href="IndexDefines_8H.html#ad5195ac8f863f5a9a7eaa0db094f7639">NVAR</a>+2;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            mapper = &amp;face_linear_interp;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <span class="keywordflow">if</span> (lev == 0)</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            <span class="comment">// on lev, use the mf data and time passed to FillIntermediatePatch().</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            Vector&lt;MultiFab*&gt; smf { &amp;mf };</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            Vector&lt;Real&gt; stime { time };</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            <a class="code" href="classERFPhysBCFunct.html">ERFPhysBCFunct</a> physbc(lev,geom[lev],<a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>,<a class="code" href="classERF.html#a8a99e22b1111c803e31b4afd5fcdea60">domain_bcs_type_d</a>,var_idx,level_data,</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                                  <a class="code" href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">m_bc_extdir_vals</a>,</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;#ifdef ERF_USE_TERRAIN</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                                  z_phys_nd[lev],detJ_cc[lev],</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;#endif</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;#ifdef ERF_USE_NETCDF</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                                   <a class="code" href="classERF.html#a35360b65d1afd233a6e6461938fa4522">bdy_data_xlo</a>, <a class="code" href="classERF.html#a4ac5b4b865dc8a029812bf1a20cd9b9b">bdy_data_xhi</a>, <a class="code" href="classERF.html#a21e2e459ae54d580e40f0ffdbcdc68a4">bdy_data_ylo</a>, <a class="code" href="classERF.html#aaa1c7e25ca002544fc80dcea620bda8d">bdy_data_yhi</a>,</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;#endif</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                                   <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            amrex::FillPatchSingleLevel(mf, time, smf, stime, 0, icomp, ncomp,</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                                        geom[lev], physbc, bccomp);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        }</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            MultiFab mf_temp(mf.boxArray(), mf.DistributionMap(), mf.nComp(), mf.nGrowVect());</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            <a class="code" href="structTimeInterpolatedData.html">TimeInterpolatedData</a> cdata = <a class="code" href="classERF.html#a92248817d31fce8771fba3532d819421">GetDataAtTime</a>(lev-1, time);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            Vector&lt;MultiFab*&gt; cmf = {&amp;cdata.<a class="code" href="structTimeInterpolatedData.html#a65f3edf3f03a779a931f5c58bd438602">get_var</a>(var_idx)};</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            Vector&lt;MultiFab*&gt; fmf = {&amp;mf};</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            Vector&lt;Real&gt; ctime = {cdata.<a class="code" href="structTimeInterpolatedData.html#a3f1217eba0582186b1ea1b43babcc5f4">get_time</a>()};</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            Vector&lt;Real&gt; ftime = {level_data.<a class="code" href="structTimeInterpolatedData.html#a3f1217eba0582186b1ea1b43babcc5f4">get_time</a>()};</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            <a class="code" href="classERFPhysBCFunct.html">ERFPhysBCFunct</a> cphysbc(lev-1,geom[lev-1],<a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>,<a class="code" href="classERF.html#a8a99e22b1111c803e31b4afd5fcdea60">domain_bcs_type_d</a>,var_idx,cdata,</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                                  <a class="code" href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">m_bc_extdir_vals</a>,</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;#ifdef ERF_USE_TERRAIN</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                                   z_phys_nd[lev-1],detJ_cc[lev-1],</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;#endif</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;#ifdef ERF_USE_NETCDF</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                                   <a class="code" href="classERF.html#a35360b65d1afd233a6e6461938fa4522">bdy_data_xlo</a>, <a class="code" href="classERF.html#a4ac5b4b865dc8a029812bf1a20cd9b9b">bdy_data_xhi</a>, <a class="code" href="classERF.html#a21e2e459ae54d580e40f0ffdbcdc68a4">bdy_data_ylo</a>, <a class="code" href="classERF.html#aaa1c7e25ca002544fc80dcea620bda8d">bdy_data_yhi</a>,</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;#endif</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                                   <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            <a class="code" href="classERFPhysBCFunct.html">ERFPhysBCFunct</a> fphysbc(lev,geom[lev],<a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>,<a class="code" href="classERF.html#a8a99e22b1111c803e31b4afd5fcdea60">domain_bcs_type_d</a>,var_idx,level_data,</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                                  <a class="code" href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">m_bc_extdir_vals</a>,</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;#ifdef ERF_USE_TERRAIN</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                                   z_phys_nd[lev],detJ_cc[lev],</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;#endif</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;#ifdef ERF_USE_NETCDF</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                                   <a class="code" href="classERF.html#a35360b65d1afd233a6e6461938fa4522">bdy_data_xlo</a>, <a class="code" href="classERF.html#a4ac5b4b865dc8a029812bf1a20cd9b9b">bdy_data_xhi</a>, <a class="code" href="classERF.html#a21e2e459ae54d580e40f0ffdbcdc68a4">bdy_data_ylo</a>, <a class="code" href="classERF.html#aaa1c7e25ca002544fc80dcea620bda8d">bdy_data_yhi</a>,</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;#endif</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                                   <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            amrex::FillPatchTwoLevels(mf_temp, time, cmf, ctime, fmf, ftime,</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                                    0, icomp, ncomp, geom[lev-1], geom[lev],</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                                    cphysbc, 0, fphysbc, 0, refRatio(lev-1),</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                                    mapper, <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>, bccomp);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160; </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            <span class="comment">// Replace mf with mf_temp</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            std::swap(mf_temp, mf);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        }</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    }</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160; </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="comment">// It is important that we apply the MOST bcs after we have imposed all the others</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="comment">//    so that we have enough information in the ghost cells to calculate the viscosity</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keywordflow">if</span> (!rho_only &amp;&amp; <a class="code" href="classERF.html#a051364b2373d8d86151c0b4a958035bd">m_most</a>)</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    {</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        MultiFab eddyDiffs(mfs[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].get().boxArray(),</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                           mfs[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].get().DistributionMap(),</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                           <a class="code" href="namespaceEddyDiff.html#a8e591238ddc3313566df853a4372e977aa3900ab375460932d825b615bb532446">EddyDiff::NumDiffs</a>,3);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        <span class="keywordtype">bool</span> vert_only = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <a class="code" href="ComputeTurbulentViscosity_8cpp.html#ab6df21759a0fbc49cc70bf928780e275">ComputeTurbulentViscosity</a>(mfs[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].get(), mfs[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].get(),</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                                  mfs[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].get(), mfs[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].get(),</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                                  eddyDiffs, geom[lev], <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>, <a class="code" href="classERF.html#a051364b2373d8d86151c0b4a958035bd">m_most</a>, <a class="code" href="classERF.html#a8a99e22b1111c803e31b4afd5fcdea60">domain_bcs_type_d</a>, vert_only);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        eddyDiffs.FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> var_idx = 0; var_idx &lt; <a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca5deccaa24d5e74279425d7749f7d1494">Vars::NumTypes</a>; ++var_idx)</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        {</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            MultiFab&amp; mf = mfs[var_idx].get();</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> icomp = 0;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            <span class="keywordflow">for</span> (MFIter mfi(mf); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;            {</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                <span class="keyword">const</span> Box&amp; bx       = mf[mfi].box();</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                      <span class="keyword">auto</span> dest_arr = mf[mfi].array();</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                <span class="keyword">const</span> <span class="keyword">auto</span> velx_arr = level_data.<a class="code" href="structTimeInterpolatedData.html#a65f3edf3f03a779a931f5c58bd438602">get_var</a>(<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>)[mfi].array();</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                <span class="keyword">const</span> <span class="keyword">auto</span> vely_arr = level_data.<a class="code" href="structTimeInterpolatedData.html#a65f3edf3f03a779a931f5c58bd438602">get_var</a>(<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>)[mfi].array();</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                <span class="keyword">const</span> <span class="keyword">auto</span> cons_arr = level_data.<a class="code" href="structTimeInterpolatedData.html#a65f3edf3f03a779a931f5c58bd438602">get_var</a>(<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>)[mfi].array();</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                <span class="keyword">const</span> <span class="keyword">auto</span>  eta_arr = eddyDiffs[mfi].array();</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                <span class="keywordtype">int</span> zlo = 0;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                <a class="code" href="classERF.html#a051364b2373d8d86151c0b4a958035bd">m_most</a>-&gt;impose_most_bcs(lev,bx,dest_arr,cons_arr,velx_arr,vely_arr,eta_arr,var_idx,icomp,zlo);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            } <span class="comment">// mf</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        } <span class="comment">// var_idx</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    } <span class="comment">// most</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a17edcb4fd8fa664054acdbcfa0f7d9a3_cgraph.png" border="0" usemap="#classERF_a17edcb4fd8fa664054acdbcfa0f7d9a3_cgraph" alt=""/></div>
<map name="classERF_a17edcb4fd8fa664054acdbcfa0f7d9a3_cgraph" id="classERF_a17edcb4fd8fa664054acdbcfa0f7d9a3_cgraph">
<area shape="rect" title=" " alt="" coords="5,216,197,243"/>
<area shape="rect" href="structTimeInterpolatedData.html#a3b9292eb3012672361abacc2ab7d9b2c" title=" " alt="" coords="263,91,428,133"/>
<area shape="rect" href="ComputeTurbulentViscosity_8cpp.html#ab6df21759a0fbc49cc70bf928780e275" title=" " alt="" coords="245,157,445,184"/>
<area shape="rect" href="structTimeInterpolatedData.html#a3f1217eba0582186b1ea1b43babcc5f4" title=" " alt="" coords="263,209,428,250"/>
<area shape="rect" href="structTimeInterpolatedData.html#a65f3edf3f03a779a931f5c58bd438602" title=" " alt="" coords="263,274,428,315"/>
<area shape="rect" href="structTimeInterpolatedData.html#a0d6dcefbf7407a24669d2a37c7f558d4" title=" " alt="" coords="263,339,428,381"/>
<area shape="rect" href="ComputeTurbulentViscosity_8cpp.html#a2f1a03ceadfdae92cffc0005a119ce1e" title=" " alt="" coords="494,132,717,159"/>
<area shape="rect" href="PBLModels_8H.html#a6b7b829386b28f2bcdc63d51b754896c" title=" " alt="" coords="493,183,717,209"/>
<area shape="rect" href="EddyViscosity_8H.html#a0e836a37ea501d7590d1a6c2cc280c9a" title=" " alt="" coords="765,132,904,159"/>
<area shape="rect" href="StrainRate_8H.html#a8ac68f19d36d81499a2455b68156a452" title=" " alt="" coords="952,5,1057,32"/>
<area shape="rect" href="StrainRate_8H.html#a1875a27a119f7d397b90cea2db6d78fb" title=" " alt="" coords="952,56,1057,83"/>
<area shape="rect" href="StrainRate_8H.html#a418dc497481811accc55011eab2ccc40" title=" " alt="" coords="952,107,1057,133"/>
<area shape="rect" href="StrainRate_8H.html#a215aa33cfd329b4856b0623dd43e942f" title=" " alt="" coords="952,157,1057,184"/>
<area shape="rect" href="StrainRate_8H.html#a5e8c93e1026165d28a35772151daa5a5" title=" " alt="" coords="952,208,1057,235"/>
<area shape="rect" href="StrainRate_8H.html#a92ba368343a7bf7fea37976eb6e5e82b" title=" " alt="" coords="952,259,1057,285"/>
<area shape="rect" href="StrainRate_8H.html#afbebd7a5caa9e22797c3b0336613cda4" title=" " alt="" coords="1105,107,1196,133"/>
</map>
</div>

</div>
</div>
<a id="a3d8f63f2178b1cb5ba78a433ece34e1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d8f63f2178b1cb5ba78a433ece34e1c">&#9670;&nbsp;</a></span>FillPatch()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::FillPatch </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Vector&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;{</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keywordtype">int</span> bccomp;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    amrex::Interpolater* mapper = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <a class="code" href="structTimeInterpolatedData.html">TimeInterpolatedData</a> fdata = <a class="code" href="classERF.html#a92248817d31fce8771fba3532d819421">GetDataAtTime</a>(lev, time);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    Vector&lt;Real&gt; ftime         = {fdata.<a class="code" href="structTimeInterpolatedData.html#a3f1217eba0582186b1ea1b43babcc5f4">get_time</a>()};</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> var_idx = 0; var_idx &lt; <a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca5deccaa24d5e74279425d7749f7d1494">Vars::NumTypes</a>; ++var_idx) {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        MultiFab&amp; mf = mfs[var_idx];</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> icomp = 0;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> ncomp = mf.nComp();</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="keywordflow">if</span> (var_idx == <a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>)</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        {</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;            bccomp = 0;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            mapper = &amp;cell_cons_interp;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        }</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (var_idx == <a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>)</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            bccomp = <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            mapper = &amp;face_linear_interp;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        }</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (var_idx == <a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>)</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            bccomp = <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a>;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            mapper = &amp;face_linear_interp;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        }</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (var_idx == <a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>)</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            bccomp = <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa03b35ec9e83f34bb1349a86965d34e34">BCVars::zvel_bc</a>;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            mapper = &amp;face_linear_interp;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;          amrex::Abort(<span class="stringliteral">&quot;Dont recognize this variable type in ERF_Fillpatch&quot;</span>);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        }</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="keywordflow">if</span> (lev == 0)</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            Vector&lt;MultiFab*&gt; smf = {&amp;fdata.<a class="code" href="structTimeInterpolatedData.html#a65f3edf3f03a779a931f5c58bd438602">get_var</a>(var_idx)};</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;            <a class="code" href="classERFPhysBCFunct.html">ERFPhysBCFunct</a> physbc(lev,geom[lev],<a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>,<a class="code" href="classERF.html#a8a99e22b1111c803e31b4afd5fcdea60">domain_bcs_type_d</a>,var_idx,fdata,</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                                  <a class="code" href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">m_bc_extdir_vals</a>,</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;#ifdef ERF_USE_TERRAIN</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                                  z_phys_nd[lev], detJ_cc[lev],</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;#endif</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;#ifdef ERF_USE_NETCDF</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                                  <a class="code" href="classERF.html#a35360b65d1afd233a6e6461938fa4522">bdy_data_xlo</a>, <a class="code" href="classERF.html#a4ac5b4b865dc8a029812bf1a20cd9b9b">bdy_data_xhi</a>, <a class="code" href="classERF.html#a21e2e459ae54d580e40f0ffdbcdc68a4">bdy_data_ylo</a>, <a class="code" href="classERF.html#aaa1c7e25ca002544fc80dcea620bda8d">bdy_data_yhi</a>,</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;#endif</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                                  <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            amrex::FillPatchSingleLevel(mf, time, smf, ftime, 0, icomp, ncomp,</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                                        geom[lev], physbc, bccomp);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        }</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            <a class="code" href="structTimeInterpolatedData.html">TimeInterpolatedData</a> cdata = <a class="code" href="classERF.html#a92248817d31fce8771fba3532d819421">GetDataAtTime</a>(lev-1, time);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            Vector&lt;Real&gt; ctime = {cdata.<a class="code" href="structTimeInterpolatedData.html#a3f1217eba0582186b1ea1b43babcc5f4">get_time</a>()};</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            Vector&lt;MultiFab*&gt; cmf = {&amp;cdata.<a class="code" href="structTimeInterpolatedData.html#a65f3edf3f03a779a931f5c58bd438602">get_var</a>(var_idx)};</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            Vector&lt;MultiFab*&gt; fmf = {&amp;fdata.<a class="code" href="structTimeInterpolatedData.html#a65f3edf3f03a779a931f5c58bd438602">get_var</a>(var_idx)};</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            <a class="code" href="classERFPhysBCFunct.html">ERFPhysBCFunct</a> cphysbc(lev-1,geom[lev-1],<a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>,<a class="code" href="classERF.html#a8a99e22b1111c803e31b4afd5fcdea60">domain_bcs_type_d</a>,var_idx,cdata,</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                                   <a class="code" href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">m_bc_extdir_vals</a>,</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;#ifdef ERF_USE_TERRAIN</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                                   z_phys_nd[lev-1],detJ_cc[lev-1],</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;#endif</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;#ifdef ERF_USE_NETCDF</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                                   <a class="code" href="classERF.html#a35360b65d1afd233a6e6461938fa4522">bdy_data_xlo</a>, <a class="code" href="classERF.html#a4ac5b4b865dc8a029812bf1a20cd9b9b">bdy_data_xhi</a>, <a class="code" href="classERF.html#a21e2e459ae54d580e40f0ffdbcdc68a4">bdy_data_ylo</a>, <a class="code" href="classERF.html#aaa1c7e25ca002544fc80dcea620bda8d">bdy_data_yhi</a>,</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;#endif</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                                   <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            <a class="code" href="classERFPhysBCFunct.html">ERFPhysBCFunct</a> fphysbc(lev,geom[lev],<a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>,<a class="code" href="classERF.html#a8a99e22b1111c803e31b4afd5fcdea60">domain_bcs_type_d</a>,var_idx,fdata,</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                                   <a class="code" href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">m_bc_extdir_vals</a>,</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;#ifdef ERF_USE_TERRAIN</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                                   z_phys_nd[lev],detJ_cc[lev],</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;#endif</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;#ifdef ERF_USE_NETCDF</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                                   <a class="code" href="classERF.html#a35360b65d1afd233a6e6461938fa4522">bdy_data_xlo</a>, <a class="code" href="classERF.html#a4ac5b4b865dc8a029812bf1a20cd9b9b">bdy_data_xhi</a>, <a class="code" href="classERF.html#a21e2e459ae54d580e40f0ffdbcdc68a4">bdy_data_ylo</a>, <a class="code" href="classERF.html#aaa1c7e25ca002544fc80dcea620bda8d">bdy_data_yhi</a>,</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;#endif</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                                   <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            amrex::FillPatchTwoLevels(mf, time, cmf, ctime, fmf, ftime,</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                                      0, icomp, ncomp, geom[lev-1], geom[lev],</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                                      cphysbc, bccomp, fphysbc, bccomp, refRatio(lev-1),</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                                      mapper, <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>, bccomp);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        } <span class="comment">// lev &gt; 0</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    } <span class="comment">// var_idx</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="comment">// It is important that we apply the MOST bcs after we have imposed all the others</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="comment">//    so that we have enough information in the ghost cells to calculate the viscosity</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="comment">// Note that we don&#39;t test on the BCRec&#39;s for these variables because those have been set</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="comment">//      to match those of no-slip-wall in order to fill values before computing viscosity</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a051364b2373d8d86151c0b4a958035bd">m_most</a>)</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        MultiFab eddyDiffs(fdata.<a class="code" href="structTimeInterpolatedData.html#a65f3edf3f03a779a931f5c58bd438602">get_var</a>(<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>).boxArray(),</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                           fdata.<a class="code" href="structTimeInterpolatedData.html#a65f3edf3f03a779a931f5c58bd438602">get_var</a>(<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>).DistributionMap(),</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                           <a class="code" href="namespaceEddyDiff.html#a8e591238ddc3313566df853a4372e977aa3900ab375460932d825b615bb532446">EddyDiff::NumDiffs</a>,3);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <span class="keywordtype">bool</span> vert_only = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <a class="code" href="ComputeTurbulentViscosity_8cpp.html#ab6df21759a0fbc49cc70bf928780e275">ComputeTurbulentViscosity</a>(fdata.<a class="code" href="structTimeInterpolatedData.html#a65f3edf3f03a779a931f5c58bd438602">get_var</a>(<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>), fdata.<a class="code" href="structTimeInterpolatedData.html#a65f3edf3f03a779a931f5c58bd438602">get_var</a>(<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>),</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                                  fdata.<a class="code" href="structTimeInterpolatedData.html#a65f3edf3f03a779a931f5c58bd438602">get_var</a>(<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>), fdata.<a class="code" href="structTimeInterpolatedData.html#a65f3edf3f03a779a931f5c58bd438602">get_var</a>(<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>),</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                                  eddyDiffs, geom[lev], <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>, <a class="code" href="classERF.html#a051364b2373d8d86151c0b4a958035bd">m_most</a>, <a class="code" href="classERF.html#a8a99e22b1111c803e31b4afd5fcdea60">domain_bcs_type_d</a>, vert_only);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        eddyDiffs.FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> var_idx = 0; var_idx &lt; <a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca5deccaa24d5e74279425d7749f7d1494">Vars::NumTypes</a>; ++var_idx)</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        {</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            MultiFab&amp; mf = mfs[var_idx];</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> icomp = 0;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            <span class="keywordflow">for</span> (MFIter mfi(mf); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                <span class="keyword">const</span> Box&amp; bx       = mfs[var_idx][mfi].box();</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                      <span class="keyword">auto</span> dest_arr = mfs[var_idx][mfi].array();</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                <span class="keyword">const</span> <span class="keyword">auto</span> velx_arr = fdata.<a class="code" href="structTimeInterpolatedData.html#a65f3edf3f03a779a931f5c58bd438602">get_var</a>(<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>)[mfi].array();</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                <span class="keyword">const</span> <span class="keyword">auto</span> vely_arr = fdata.<a class="code" href="structTimeInterpolatedData.html#a65f3edf3f03a779a931f5c58bd438602">get_var</a>(<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>)[mfi].array();</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                <span class="keyword">const</span> <span class="keyword">auto</span> cons_arr = fdata.<a class="code" href="structTimeInterpolatedData.html#a65f3edf3f03a779a931f5c58bd438602">get_var</a>(<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>)[mfi].array();</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                <span class="keyword">const</span> <span class="keyword">auto</span>  eta_arr = eddyDiffs[mfi].array();</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                <span class="keywordtype">int</span> zlo = 0;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                <a class="code" href="classERF.html#a051364b2373d8d86151c0b4a958035bd">m_most</a>-&gt;impose_most_bcs(lev,bx,dest_arr,cons_arr,velx_arr,vely_arr,eta_arr,var_idx,icomp,zlo);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            } <span class="comment">// mf</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        } <span class="comment">// var_idx</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    } <span class="comment">// most</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a3d8f63f2178b1cb5ba78a433ece34e1c_cgraph.png" border="0" usemap="#classERF_a3d8f63f2178b1cb5ba78a433ece34e1c_cgraph" alt=""/></div>
<map name="classERF_a3d8f63f2178b1cb5ba78a433ece34e1c_cgraph" id="classERF_a3d8f63f2178b1cb5ba78a433ece34e1c_cgraph">
<area shape="rect" title=" " alt="" coords="5,216,113,243"/>
<area shape="rect" href="ComputeTurbulentViscosity_8cpp.html#ab6df21759a0fbc49cc70bf928780e275" title=" " alt="" coords="161,157,361,184"/>
<area shape="rect" href="structTimeInterpolatedData.html#a3f1217eba0582186b1ea1b43babcc5f4" title=" " alt="" coords="179,209,344,250"/>
<area shape="rect" href="structTimeInterpolatedData.html#a65f3edf3f03a779a931f5c58bd438602" title=" " alt="" coords="179,274,344,315"/>
<area shape="rect" href="ComputeTurbulentViscosity_8cpp.html#a2f1a03ceadfdae92cffc0005a119ce1e" title=" " alt="" coords="410,132,633,159"/>
<area shape="rect" href="PBLModels_8H.html#a6b7b829386b28f2bcdc63d51b754896c" title=" " alt="" coords="409,183,633,209"/>
<area shape="rect" href="EddyViscosity_8H.html#a0e836a37ea501d7590d1a6c2cc280c9a" title=" " alt="" coords="681,132,820,159"/>
<area shape="rect" href="StrainRate_8H.html#a8ac68f19d36d81499a2455b68156a452" title=" " alt="" coords="868,5,973,32"/>
<area shape="rect" href="StrainRate_8H.html#a1875a27a119f7d397b90cea2db6d78fb" title=" " alt="" coords="868,56,973,83"/>
<area shape="rect" href="StrainRate_8H.html#a418dc497481811accc55011eab2ccc40" title=" " alt="" coords="868,107,973,133"/>
<area shape="rect" href="StrainRate_8H.html#a215aa33cfd329b4856b0623dd43e942f" title=" " alt="" coords="868,157,973,184"/>
<area shape="rect" href="StrainRate_8H.html#a5e8c93e1026165d28a35772151daa5a5" title=" " alt="" coords="868,208,973,235"/>
<area shape="rect" href="StrainRate_8H.html#a92ba368343a7bf7fea37976eb6e5e82b" title=" " alt="" coords="868,259,973,285"/>
<area shape="rect" href="StrainRate_8H.html#afbebd7a5caa9e22797c3b0336613cda4" title=" " alt="" coords="1021,107,1112,133"/>
</map>
</div>

</div>
</div>
<a id="afd3cbffc97b8a89e58042e029c5c6b7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd3cbffc97b8a89e58042e029c5c6b7c">&#9670;&nbsp;</a></span>get_flux_reg()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">AMREX_FORCE_INLINE amrex::FluxRegister&amp; ERF::get_flux_reg </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    {</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;      <span class="keywordflow">return</span> *<a class="code" href="classERF.html#a2ef8ab09aed437467e2e87a37bcd999d">flux_registers</a>[lev];</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5cafd68de724845533efea8d284aacb4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5cafd68de724845533efea8d284aacb4">&#9670;&nbsp;</a></span>getCPUTime()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real ERF::getCPUTime </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    {</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;      <span class="keywordtype">int</span> numCores = amrex::ParallelDescriptor::NProcs();</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;      numCores = numCores * omp_get_max_threads();</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160; </div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;      amrex::Real T =</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        numCores * (amrex::ParallelDescriptor::second() - <a class="code" href="classERF.html#a3890ee3bf2586cf0ef2822b671c5d8c4">startCPUTime</a>) +</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        <a class="code" href="classERF.html#a7948479fe1497dc592dd748c9567fdaa">previousCPUTimeUsed</a>;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160; </div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;      <span class="keywordflow">return</span> T;</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classERF.html#aa2d8099655a8779836e63e3e98ea4372">writeJobInfo()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a5cafd68de724845533efea8d284aacb4_icgraph.png" border="0" usemap="#classERF_a5cafd68de724845533efea8d284aacb4_icgraph" alt=""/></div>
<map name="classERF_a5cafd68de724845533efea8d284aacb4_icgraph" id="classERF_a5cafd68de724845533efea8d284aacb4_icgraph">
<area shape="rect" title=" " alt="" coords="185,5,320,32"/>
<area shape="rect" href="classERF.html#aa2d8099655a8779836e63e3e98ea4372" title=" " alt="" coords="5,5,137,32"/>
</map>
</div>

</div>
</div>
<a id="a92248817d31fce8771fba3532d819421"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92248817d31fce8771fba3532d819421">&#9670;&nbsp;</a></span>GetDataAtTime()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structTimeInterpolatedData.html">TimeInterpolatedData</a> ERF::GetDataAtTime </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;{</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    <a class="code" href="structTimeInterpolatedData.html">TimeInterpolatedData</a> data;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> teps = (<a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev] - <a class="code" href="classERF.html#a7085d7d5fc94a0f84efc06957267d58e">t_old</a>[lev]) * 1.e-3;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160; </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <span class="keywordflow">if</span> (time &gt; <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev] - teps &amp;&amp; time &lt; <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev] + teps)</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    {</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca5deccaa24d5e74279425d7749f7d1494">Vars::NumTypes</a>; ++i) {</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;            data.<a class="code" href="structTimeInterpolatedData.html#a3b9292eb3012672361abacc2ab7d9b2c">add_var</a>(&amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][i], data.<a class="code" href="structTimeInterpolatedData.html#a39ab53c6a67f3b87c895483a89e2fc0f">non_owning</a>);</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;        }</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;        data.<a class="code" href="structTimeInterpolatedData.html#a0d6dcefbf7407a24669d2a37c7f558d4">set_time</a>(<a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev]);</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    }</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (time &gt; <a class="code" href="classERF.html#a7085d7d5fc94a0f84efc06957267d58e">t_old</a>[lev] - teps &amp;&amp; time &lt; <a class="code" href="classERF.html#a7085d7d5fc94a0f84efc06957267d58e">t_old</a>[lev] + teps)</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    {</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca5deccaa24d5e74279425d7749f7d1494">Vars::NumTypes</a>; ++i) {</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;            data.<a class="code" href="structTimeInterpolatedData.html#a3b9292eb3012672361abacc2ab7d9b2c">add_var</a>(&amp;<a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev][i], data.<a class="code" href="structTimeInterpolatedData.html#a39ab53c6a67f3b87c895483a89e2fc0f">non_owning</a>);</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        }</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        data.<a class="code" href="structTimeInterpolatedData.html#a0d6dcefbf7407a24669d2a37c7f558d4">set_time</a>(<a class="code" href="classERF.html#a7085d7d5fc94a0f84efc06957267d58e">t_old</a>[lev]);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    }</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (time &gt; <a class="code" href="classERF.html#a7085d7d5fc94a0f84efc06957267d58e">t_old</a>[lev] &amp;&amp; time &lt; <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev])</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    {</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        <span class="comment">// do first order interpolation in time between [t_old[lev], t_new[lev]]</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        <span class="comment">// time interpolation includes the ghost cells</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca5deccaa24d5e74279425d7749f7d1494">Vars::NumTypes</a>; ++i) {</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;            MultiFab* mf_temp = <span class="keyword">new</span> MultiFab(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][i].boxArray(),</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;                                             <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][i].DistributionMap(),</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;                                             <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][i].nComp(), <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][i].nGrowVect());</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;            mf_temp-&gt;setVal(0.0_rt);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;            <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> dt_fraction = (time - <a class="code" href="classERF.html#a7085d7d5fc94a0f84efc06957267d58e">t_old</a>[lev]) / (<a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev] - <a class="code" href="classERF.html#a7085d7d5fc94a0f84efc06957267d58e">t_old</a>[lev]);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;            MultiFab::Saxpy(*mf_temp, 1.0_rt - dt_fraction, <a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev][i], 0, 0, mf_temp-&gt;nComp(), mf_temp-&gt;nGrowVect());</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;            MultiFab::Saxpy(*mf_temp,          dt_fraction, <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][i], 0, 0, mf_temp-&gt;nComp(), mf_temp-&gt;nGrowVect());</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;            data.<a class="code" href="structTimeInterpolatedData.html#a3b9292eb3012672361abacc2ab7d9b2c">add_var</a>(mf_temp, data.<a class="code" href="structTimeInterpolatedData.html#af9c5a331c09d13db10c98ad3033114d8">owning</a>);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        }</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        data.<a class="code" href="structTimeInterpolatedData.html#a0d6dcefbf7407a24669d2a37c7f558d4">set_time</a>(time);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    }</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        amrex::Error(<span class="stringliteral">&quot;Requested data at a time outside the interval [t_old, t_new]&quot;</span>);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    }</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="comment">// We need to make sure to fill these before we compute the viscosity</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca5deccaa24d5e74279425d7749f7d1494">Vars::NumTypes</a>; ++i) {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        data.<a class="code" href="structTimeInterpolatedData.html#a65f3edf3f03a779a931f5c58bd438602">get_var</a>(<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>).FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        data.<a class="code" href="structTimeInterpolatedData.html#a65f3edf3f03a779a931f5c58bd438602">get_var</a>(<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>).FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        data.<a class="code" href="structTimeInterpolatedData.html#a65f3edf3f03a779a931f5c58bd438602">get_var</a>(<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>).FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        data.<a class="code" href="structTimeInterpolatedData.html#a65f3edf3f03a779a931f5c58bd438602">get_var</a>(<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>).FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    }</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keywordflow">return</span> data;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a92248817d31fce8771fba3532d819421_cgraph.png" border="0" usemap="#classERF_a92248817d31fce8771fba3532d819421_cgraph" alt=""/></div>
<map name="classERF_a92248817d31fce8771fba3532d819421_cgraph" id="classERF_a92248817d31fce8771fba3532d819421_cgraph">
<area shape="rect" title=" " alt="" coords="5,78,160,105"/>
<area shape="rect" href="structTimeInterpolatedData.html#a3b9292eb3012672361abacc2ab7d9b2c" title=" " alt="" coords="208,5,373,47"/>
<area shape="rect" href="structTimeInterpolatedData.html#a65f3edf3f03a779a931f5c58bd438602" title=" " alt="" coords="208,71,373,112"/>
<area shape="rect" href="structTimeInterpolatedData.html#a0d6dcefbf7407a24669d2a37c7f558d4" title=" " alt="" coords="208,136,373,177"/>
</map>
</div>

</div>
</div>
<a id="aaee255b031e63bd9b5807f6612739dbd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaee255b031e63bd9b5807f6612739dbd">&#9670;&nbsp;</a></span>GotoNextLine()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::GotoNextLine </td>
          <td>(</td>
          <td class="paramtype">std::istream &amp;&#160;</td>
          <td class="paramname"><em>is</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;{</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;    constexpr std::streamsize bl_ignore_max { 100000 };</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    is.ignore(bl_ignore_max, <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7261c4eb7722af0dfe6cdfb8e2e9e4db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7261c4eb7722af0dfe6cdfb8e2e9e4db">&#9670;&nbsp;</a></span>init1DArrays()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::init1DArrays </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a618e8fdff3239cc79d4145d02b1ecaa2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a618e8fdff3239cc79d4145d02b1ecaa2">&#9670;&nbsp;</a></span>init_bcs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::init_bcs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;{</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    <span class="keyword">auto</span> f = [<span class="keyword">this</span>] (std::string <span class="keyword">const</span>&amp; bcid, Orientation ori)</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    {</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;        <span class="comment">// These are simply defaults for Dirichlet faces -- they should be over-written below</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;        <a class="code" href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa559799ff291d4e692283c4056bac8db1">BCVars::Rho_bc_comp</a>][ori]       =  1.0;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;        <a class="code" href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>][ori] = -1.0; <span class="comment">// It is important to set this negative</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;                                               <span class="comment">// because the sign is tested on below</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;        <a class="code" href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa1556c0a3817c6fab60fbb6952cf0124f">BCVars::RhoKE_bc_comp</a>][ori]     = 0.0;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;        <a class="code" href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa3fd5e6f8378f1e1e80146b207c062cd8">BCVars::RhoQKE_bc_comp</a>][ori]     = 0.0;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;        <a class="code" href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa029ef491930290dea3a984ebdb6d6ae4">BCVars::RhoScalar_bc_comp</a>][ori] = 0.0;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;        <a class="code" href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>][ori] = 0.0; <span class="comment">// default</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;        <a class="code" href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a>][ori] = 0.0;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;        <a class="code" href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa03b35ec9e83f34bb1349a86965d34e34">BCVars::zvel_bc</a>][ori] = 0.0;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;        ParmParse pp(bcid);</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;        std::string bc_type_in = <span class="stringliteral">&quot;null&quot;</span>;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        pp.query(<span class="stringliteral">&quot;type&quot;</span>, bc_type_in);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        <span class="comment">//if (pp.query(&quot;type&quot;, bc_type_in))</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        <span class="comment">//   amrex::Print() &lt;&lt; &quot;INPUT BC TYPE &quot; &lt;&lt; bcid &lt;&lt; &quot; &quot; &lt;&lt; bc_type_in &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        std::string bc_type = amrex::toLower(bc_type_in);</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        <span class="keywordflow">if</span> (bc_type == <span class="stringliteral">&quot;symmetry&quot;</span>)</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        {</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;            <span class="comment">// amrex::Print() &lt;&lt; bcid &lt;&lt; &quot; set to symmetry.\n&quot;;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;            <a class="code" href="classERF.html#ab8f4a61c714936efc1c669447b009c29">phys_bc_type</a>[ori] = <a class="code" href="IndexDefines_8H.html#a6e1412fca31cbd35d0f50f12fcc70b0fa40e712f30d56083318ab20a2402921d2">BC::symmetry</a>;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;            <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[ori] = <span class="stringliteral">&quot;Symmetry&quot;</span>;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        }</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bc_type == <span class="stringliteral">&quot;outflow&quot;</span>)</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;            <span class="comment">// amrex::Print() &lt;&lt; bcid &lt;&lt; &quot; set to outflow.\n&quot;;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;            <a class="code" href="classERF.html#ab8f4a61c714936efc1c669447b009c29">phys_bc_type</a>[ori] = <a class="code" href="IndexDefines_8H.html#a6e1412fca31cbd35d0f50f12fcc70b0facac0c32caf84a889ec9b2b4cb2d56972">BC::outflow</a>;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;            <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[ori] = <span class="stringliteral">&quot;Outflow&quot;</span>;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        }</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bc_type == <span class="stringliteral">&quot;inflow&quot;</span>)</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;            <span class="comment">// amrex::Print() &lt;&lt; bcid &lt;&lt; &quot; set to inflow.\n&quot;;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;            <a class="code" href="classERF.html#ab8f4a61c714936efc1c669447b009c29">phys_bc_type</a>[ori] = <a class="code" href="IndexDefines_8H.html#a6e1412fca31cbd35d0f50f12fcc70b0fad37e67db17cfd059f2852e2673b9e8ef">BC::inflow</a>;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;            <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[ori] = <span class="stringliteral">&quot;Inflow&quot;</span>;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;            std::vector&lt;Real&gt; <a class="code" href="DataStruct_8H.html#a07130f00a795700d6b2b83f773b807b4a9e3669d19b675bd57058fd4664205d2a">v</a>;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a80ad08512968ec45635df68abe66b1fc">input_bndry_planes</a> &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_velocity()) {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                <a class="code" href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>][ori] = 0.;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                <a class="code" href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a>][ori] = 0.;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                <a class="code" href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa03b35ec9e83f34bb1349a86965d34e34">BCVars::zvel_bc</a>][ori] = 0.;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                pp.getarr(<span class="stringliteral">&quot;velocity&quot;</span>, <a class="code" href="DataStruct_8H.html#a07130f00a795700d6b2b83f773b807b4a9e3669d19b675bd57058fd4664205d2a">v</a>, 0, AMREX_SPACEDIM);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                <a class="code" href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>][ori] = <a class="code" href="DataStruct_8H.html#a07130f00a795700d6b2b83f773b807b4a9e3669d19b675bd57058fd4664205d2a">v</a>[0];</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                <a class="code" href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a>][ori] = <a class="code" href="DataStruct_8H.html#a07130f00a795700d6b2b83f773b807b4a9e3669d19b675bd57058fd4664205d2a">v</a>[1];</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                <a class="code" href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa03b35ec9e83f34bb1349a86965d34e34">BCVars::zvel_bc</a>][ori] = <a class="code" href="DataStruct_8H.html#a07130f00a795700d6b2b83f773b807b4a9e3669d19b675bd57058fd4664205d2a">v</a>[2];</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;            }</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> rho_in;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a80ad08512968ec45635df68abe66b1fc">input_bndry_planes</a> &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_density()) {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                <a class="code" href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa559799ff291d4e692283c4056bac8db1">BCVars::Rho_bc_comp</a>][ori] = 0.;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                pp.get(<span class="stringliteral">&quot;density&quot;</span>, rho_in);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                <a class="code" href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa559799ff291d4e692283c4056bac8db1">BCVars::Rho_bc_comp</a>][ori] = rho_in;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            }</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> theta_in;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a80ad08512968ec45635df68abe66b1fc">input_bndry_planes</a> &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_theta()) {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                <a class="code" href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>][ori] = 0.;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                pp.get(<span class="stringliteral">&quot;theta&quot;</span>, theta_in);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                <a class="code" href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>][ori] = rho_in*theta_in;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> scalar_in = 0.;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a80ad08512968ec45635df68abe66b1fc">input_bndry_planes</a> &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_scalar()) {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                <a class="code" href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa029ef491930290dea3a984ebdb6d6ae4">BCVars::RhoScalar_bc_comp</a>][ori] = 0.;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                <span class="keywordflow">if</span> (pp.query(<span class="stringliteral">&quot;scalar&quot;</span>, scalar_in))</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                <a class="code" href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa029ef491930290dea3a984ebdb6d6ae4">BCVars::RhoScalar_bc_comp</a>][ori] = rho_in*scalar_in;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            }</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="preprocessor">#ifdef ERF_USE_MOISTURE</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> qv_in = 0.;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a80ad08512968ec45635df68abe66b1fc">input_bndry_planes</a> &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_qv()) {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                <a class="code" href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">m_bc_extdir_vals</a>[BCVars::RhoQv_bc_comp][ori] = 0.;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                <span class="keywordflow">if</span> (pp.query(<span class="stringliteral">&quot;qv&quot;</span>, qv_in))</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                <a class="code" href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">m_bc_extdir_vals</a>[BCVars::RhoQv_bc_comp][ori] = rho_in*qv_in;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> qc_in = 0.;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a80ad08512968ec45635df68abe66b1fc">input_bndry_planes</a> &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_qc()) {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                <a class="code" href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">m_bc_extdir_vals</a>[BCVars::RhoQc_bc_comp][ori] = 0.;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                <span class="keywordflow">if</span> (pp.query(<span class="stringliteral">&quot;qc&quot;</span>, qc_in))</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                <a class="code" href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">m_bc_extdir_vals</a>[BCVars::RhoQc_bc_comp][ori] = rho_in*qc_in;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            }</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> KE_in = 0.;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a80ad08512968ec45635df68abe66b1fc">input_bndry_planes</a> &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_KE()) {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                <a class="code" href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa1556c0a3817c6fab60fbb6952cf0124f">BCVars::RhoKE_bc_comp</a>][ori] = 0.;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                <span class="keywordflow">if</span> (pp.query(<span class="stringliteral">&quot;KE&quot;</span>, KE_in))</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                <a class="code" href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa1556c0a3817c6fab60fbb6952cf0124f">BCVars::RhoKE_bc_comp</a>][ori] = rho_in*KE_in;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;            }</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> QKE_in = 0.;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a80ad08512968ec45635df68abe66b1fc">input_bndry_planes</a> &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_QKE()) {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                <a class="code" href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa3fd5e6f8378f1e1e80146b207c062cd8">BCVars::RhoQKE_bc_comp</a>][ori] = 0.;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                <span class="keywordflow">if</span> (pp.query(<span class="stringliteral">&quot;QKE&quot;</span>, QKE_in))</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                <a class="code" href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa3fd5e6f8378f1e1e80146b207c062cd8">BCVars::RhoQKE_bc_comp</a>][ori] = rho_in*QKE_in;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            }</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        }</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bc_type == <span class="stringliteral">&quot;noslipwall&quot;</span>)</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            <span class="comment">// amrex::Print() &lt;&lt; bcid &lt;&lt;&quot; set to no-slip wall.\n&quot;;</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            <a class="code" href="classERF.html#ab8f4a61c714936efc1c669447b009c29">phys_bc_type</a>[ori] = <a class="code" href="IndexDefines_8H.html#a6e1412fca31cbd35d0f50f12fcc70b0facb8c716b8d9b499d9bc323d8f8a410d3">BC::no_slip_wall</a>;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[ori] = <span class="stringliteral">&quot;NoSlipWall&quot;</span>;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            std::vector&lt;Real&gt; <a class="code" href="DataStruct_8H.html#a07130f00a795700d6b2b83f773b807b4a9e3669d19b675bd57058fd4664205d2a">v</a>;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            <span class="comment">// The values of m_bc_extdir_vals default to 0.</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            <span class="comment">// But if we find &quot;velocity&quot; in the inputs file, use those values instead.</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            <span class="keywordflow">if</span> (pp.queryarr(<span class="stringliteral">&quot;velocity&quot;</span>, <a class="code" href="DataStruct_8H.html#a07130f00a795700d6b2b83f773b807b4a9e3669d19b675bd57058fd4664205d2a">v</a>, 0, AMREX_SPACEDIM))</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                <a class="code" href="DataStruct_8H.html#a07130f00a795700d6b2b83f773b807b4a9e3669d19b675bd57058fd4664205d2a">v</a>[ori.coordDir()] = 0.0;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                <a class="code" href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>][ori] = <a class="code" href="DataStruct_8H.html#a07130f00a795700d6b2b83f773b807b4a9e3669d19b675bd57058fd4664205d2a">v</a>[0];</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                <a class="code" href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a>][ori] = <a class="code" href="DataStruct_8H.html#a07130f00a795700d6b2b83f773b807b4a9e3669d19b675bd57058fd4664205d2a">v</a>[1];</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                <a class="code" href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa03b35ec9e83f34bb1349a86965d34e34">BCVars::zvel_bc</a>][ori] = <a class="code" href="DataStruct_8H.html#a07130f00a795700d6b2b83f773b807b4a9e3669d19b675bd57058fd4664205d2a">v</a>[2];</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            }</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> theta_in;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            <span class="keywordflow">if</span> (pp.query(<span class="stringliteral">&quot;theta&quot;</span>, theta_in))</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;               <a class="code" href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>][ori] = theta_in*<a class="code" href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa559799ff291d4e692283c4056bac8db1">BCVars::Rho_bc_comp</a>][ori];</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            }</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        }</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bc_type == <span class="stringliteral">&quot;slipwall&quot;</span>)</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            <span class="comment">// amrex::Print() &lt;&lt; bcid &lt;&lt;&quot; set to slip wall.\n&quot;;</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            <a class="code" href="classERF.html#ab8f4a61c714936efc1c669447b009c29">phys_bc_type</a>[ori] = <a class="code" href="IndexDefines_8H.html#a6e1412fca31cbd35d0f50f12fcc70b0fa03ee6de9fd100444c5c0567ea01bd538">BC::slip_wall</a>;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[ori] = <span class="stringliteral">&quot;SlipWall&quot;</span>;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160; </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> theta_in;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            <span class="keywordflow">if</span> (pp.query(<span class="stringliteral">&quot;theta&quot;</span>, theta_in))</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            {</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;               <a class="code" href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>][ori] = theta_in*<a class="code" href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa559799ff291d4e692283c4056bac8db1">BCVars::Rho_bc_comp</a>][ori];</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            }</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        }</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bc_type == <span class="stringliteral">&quot;most&quot;</span>)</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            <a class="code" href="classERF.html#ab8f4a61c714936efc1c669447b009c29">phys_bc_type</a>[ori] = <a class="code" href="IndexDefines_8H.html#a6e1412fca31cbd35d0f50f12fcc70b0fa882dd232c0425bb9366544f84f0a7b6c">BC::MOST</a>;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[ori] = <span class="stringliteral">&quot;MOST&quot;</span>;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        }</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        {</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            <a class="code" href="classERF.html#ab8f4a61c714936efc1c669447b009c29">phys_bc_type</a>[ori] = <a class="code" href="IndexDefines_8H.html#a6e1412fca31cbd35d0f50f12fcc70b0fa5e543256c480ac577d30f76f9120eb74">BC::undefined</a>;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        }</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="keywordflow">if</span> (geom[0].isPeriodic(ori.coordDir())) {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[ori] = <span class="stringliteral">&quot;Periodic&quot;</span>;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ab8f4a61c714936efc1c669447b009c29">phys_bc_type</a>[ori] == <a class="code" href="IndexDefines_8H.html#a6e1412fca31cbd35d0f50f12fcc70b0fa5e543256c480ac577d30f76f9120eb74">BC::undefined</a>)</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            {</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                <a class="code" href="classERF.html#ab8f4a61c714936efc1c669447b009c29">phys_bc_type</a>[ori] = <a class="code" href="IndexDefines_8H.html#a6e1412fca31cbd35d0f50f12fcc70b0fae6ffdec5e14fce371eb7ae99edebbbee">BC::periodic</a>;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                amrex::Abort(<span class="stringliteral">&quot;Wrong BC type for periodic boundary&quot;</span>);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            }</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        }</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ab8f4a61c714936efc1c669447b009c29">phys_bc_type</a>[ori] == <a class="code" href="IndexDefines_8H.html#a6e1412fca31cbd35d0f50f12fcc70b0fa5e543256c480ac577d30f76f9120eb74">BC::undefined</a>)</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;             amrex::Print() &lt;&lt; <span class="stringliteral">&quot;BC Type specified for face &quot;</span> &lt;&lt; bcid &lt;&lt; <span class="stringliteral">&quot; is &quot;</span> &lt;&lt; bc_type_in &lt;&lt; std::endl;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;             amrex::Abort(<span class="stringliteral">&quot;This BC type is unknown&quot;</span>);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        }</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    };</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    f(<span class="stringliteral">&quot;xlo&quot;</span>, Orientation(Direction::x,Orientation::low));</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    f(<span class="stringliteral">&quot;xhi&quot;</span>, Orientation(Direction::x,Orientation::high));</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    f(<span class="stringliteral">&quot;ylo&quot;</span>, Orientation(Direction::y,Orientation::low));</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    f(<span class="stringliteral">&quot;yhi&quot;</span>, Orientation(Direction::y,Orientation::high));</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    f(<span class="stringliteral">&quot;zlo&quot;</span>, Orientation(Direction::z,Orientation::low));</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    f(<span class="stringliteral">&quot;zhi&quot;</span>, Orientation(Direction::z,Orientation::high));</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="comment">// *****************************************************************************</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="comment">// Here we translate the physical boundary conditions -- one type per face --</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="comment">//     into logical boundary conditions for each velocity component</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="comment">// *****************************************************************************</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    {</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>.resize(AMREX_SPACEDIM+<a class="code" href="IndexDefines_8H.html#ad5195ac8f863f5a9a7eaa0db094f7639">NVAR</a>);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <a class="code" href="classERF.html#a8a99e22b1111c803e31b4afd5fcdea60">domain_bcs_type_d</a>.resize(AMREX_SPACEDIM+<a class="code" href="IndexDefines_8H.html#ad5195ac8f863f5a9a7eaa0db094f7639">NVAR</a>);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <span class="keywordflow">for</span> (OrientationIter oit; oit; ++oit) {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            Orientation ori = oit();</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            <span class="keywordtype">int</span> dir = ori.coordDir();</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            Orientation::Side side = ori.faceDir();</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;            <span class="keyword">auto</span> <span class="keyword">const</span> bct = <a class="code" href="classERF.html#ab8f4a61c714936efc1c669447b009c29">phys_bc_type</a>[ori];</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            <span class="keywordflow">if</span> ( bct == <a class="code" href="IndexDefines_8H.html#a6e1412fca31cbd35d0f50f12fcc70b0fa40e712f30d56083318ab20a2402921d2">BC::symmetry</a> )</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            {</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++)</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01cabc47f82507730e1734a2f3bc58893cf9">ERFBCType::reflect_even</a>);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                    <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+dir].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca41cecdb4487b15207675ae9ee564e705">ERFBCType::reflect_odd</a>);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++)</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01cabc47f82507730e1734a2f3bc58893cf9">ERFBCType::reflect_even</a>);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                    <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+dir].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca41cecdb4487b15207675ae9ee564e705">ERFBCType::reflect_odd</a>);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                }</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            }</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bct == <a class="code" href="IndexDefines_8H.html#a6e1412fca31cbd35d0f50f12fcc70b0facac0c32caf84a889ec9b2b4cb2d56972">BC::outflow</a>)</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            {</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++)</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4a8d85af949a1ce567934e55c69c2846">ERFBCType::foextrap</a>);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++)</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4a8d85af949a1ce567934e55c69c2846">ERFBCType::foextrap</a>);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                }</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            }</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bct == <a class="code" href="IndexDefines_8H.html#a6e1412fca31cbd35d0f50f12fcc70b0fad37e67db17cfd059f2852e2673b9e8ef">BC::inflow</a>)</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++) {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af">ERFBCType::ext_dir</a>);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a80ad08512968ec45635df68abe66b1fc">input_bndry_planes</a> &amp;&amp; dir &lt; 2 &amp;&amp; m_r2d-&gt;ingested_velocity()) {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                            <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca138e8c6c2427dcd78959f3e0e84b3462">ERFBCType::ext_dir_ingested</a>);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                        }</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                    }</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++) {</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af">ERFBCType::ext_dir</a>);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a80ad08512968ec45635df68abe66b1fc">input_bndry_planes</a> &amp;&amp; dir &lt; 2 &amp;&amp; m_r2d-&gt;ingested_velocity()) {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                            <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca138e8c6c2427dcd78959f3e0e84b3462">ERFBCType::ext_dir_ingested</a>);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                        }</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                    }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                }</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            }</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bct == <a class="code" href="IndexDefines_8H.html#a6e1412fca31cbd35d0f50f12fcc70b0facb8c716b8d9b499d9bc323d8f8a410d3">BC::no_slip_wall</a>)</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            {</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++)</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af">ERFBCType::ext_dir</a>);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++)</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af">ERFBCType::ext_dir</a>);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                }</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            }</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bct == <a class="code" href="IndexDefines_8H.html#a6e1412fca31cbd35d0f50f12fcc70b0fa03ee6de9fd100444c5c0567ea01bd538">BC::slip_wall</a>)</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                    <span class="comment">// Tangential directions have hoextrap</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++)</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4a8d85af949a1ce567934e55c69c2846">ERFBCType::foextrap</a>);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                    <span class="comment">// Only normal direction has ext_dir</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                    <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+dir].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af">ERFBCType::ext_dir</a>);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160; </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                    <span class="comment">// Tangential directions have hoextrap</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++)</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4a8d85af949a1ce567934e55c69c2846">ERFBCType::foextrap</a>);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                    <span class="comment">// Only normal direction has ext_dir</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                    <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+dir].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af">ERFBCType::ext_dir</a>);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                }</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            }</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bct == <a class="code" href="IndexDefines_8H.html#a6e1412fca31cbd35d0f50f12fcc70b0fae6ffdec5e14fce371eb7ae99edebbbee">BC::periodic</a>)</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            {</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++)</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca9f18284526a1054d4e7a4783852ead30">ERFBCType::int_dir</a>);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++)</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca9f18284526a1054d4e7a4783852ead30">ERFBCType::int_dir</a>);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                }</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            }</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( bct == <a class="code" href="IndexDefines_8H.html#a6e1412fca31cbd35d0f50f12fcc70b0fa882dd232c0425bb9366544f84f0a7b6c">BC::MOST</a> )</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            {</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                AMREX_ALWAYS_ASSERT(dir == 2 &amp;&amp; side == Orientation::low);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+0].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca41cecdb4487b15207675ae9ee564e705">ERFBCType::reflect_odd</a>);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+1].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca41cecdb4487b15207675ae9ee564e705">ERFBCType::reflect_odd</a>);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+2].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af">ERFBCType::ext_dir</a>);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            }</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        }</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    }</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="comment">// *****************************************************************************</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="comment">// Here we translate the physical boundary conditions -- one type per face --</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="comment">//     into logical boundary conditions for each cell-centered variable</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="comment">// *****************************************************************************</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    {</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <span class="keywordflow">for</span> (OrientationIter oit; oit; ++oit) {</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            Orientation ori = oit();</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            <span class="keywordtype">int</span> dir = ori.coordDir();</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            Orientation::Side side = ori.faceDir();</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            <span class="keyword">auto</span> <span class="keyword">const</span> bct = <a class="code" href="classERF.html#ab8f4a61c714936efc1c669447b009c29">phys_bc_type</a>[ori];</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;            <span class="keywordflow">if</span> ( bct == <a class="code" href="IndexDefines_8H.html#a6e1412fca31cbd35d0f50f12fcc70b0fa40e712f30d56083318ab20a2402921d2">BC::symmetry</a> )</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#ad5195ac8f863f5a9a7eaa0db094f7639">NVAR</a>; i++)</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01cabc47f82507730e1734a2f3bc58893cf9">ERFBCType::reflect_even</a>);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#ad5195ac8f863f5a9a7eaa0db094f7639">NVAR</a>; i++)</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01cabc47f82507730e1734a2f3bc58893cf9">ERFBCType::reflect_even</a>);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                }</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            }</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( bct == <a class="code" href="IndexDefines_8H.html#a6e1412fca31cbd35d0f50f12fcc70b0facac0c32caf84a889ec9b2b4cb2d56972">BC::outflow</a> )</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            {</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#ad5195ac8f863f5a9a7eaa0db094f7639">NVAR</a>; i++)</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4a8d85af949a1ce567934e55c69c2846">ERFBCType::foextrap</a>);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#ad5195ac8f863f5a9a7eaa0db094f7639">NVAR</a>; i++)</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4a8d85af949a1ce567934e55c69c2846">ERFBCType::foextrap</a>);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                }</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;            }</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( bct == <a class="code" href="IndexDefines_8H.html#a6e1412fca31cbd35d0f50f12fcc70b0facb8c716b8d9b499d9bc323d8f8a410d3">BC::no_slip_wall</a>)</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;            {</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#ad5195ac8f863f5a9a7eaa0db094f7639">NVAR</a>; i++)</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4a8d85af949a1ce567934e55c69c2846">ERFBCType::foextrap</a>);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>][ori] &gt; 0.)</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af">ERFBCType::ext_dir</a>);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#ad5195ac8f863f5a9a7eaa0db094f7639">NVAR</a>; i++)</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4a8d85af949a1ce567934e55c69c2846">ERFBCType::foextrap</a>);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>][ori] &gt; 0.)</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af">ERFBCType::ext_dir</a>);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                }</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            }</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bct == <a class="code" href="IndexDefines_8H.html#a6e1412fca31cbd35d0f50f12fcc70b0fa03ee6de9fd100444c5c0567ea01bd538">BC::slip_wall</a>)</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            {</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#ad5195ac8f863f5a9a7eaa0db094f7639">NVAR</a>; i++)</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4a8d85af949a1ce567934e55c69c2846">ERFBCType::foextrap</a>);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>][ori] &gt; 0.)</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af">ERFBCType::ext_dir</a>);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#ad5195ac8f863f5a9a7eaa0db094f7639">NVAR</a>; i++)</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4a8d85af949a1ce567934e55c69c2846">ERFBCType::foextrap</a>);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>][ori] &gt; 0.)</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af">ERFBCType::ext_dir</a>);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                }</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;            }</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bct == <a class="code" href="IndexDefines_8H.html#a6e1412fca31cbd35d0f50f12fcc70b0fad37e67db17cfd059f2852e2673b9e8ef">BC::inflow</a>)</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            {</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#ad5195ac8f863f5a9a7eaa0db094f7639">NVAR</a>; i++) {</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af">ERFBCType::ext_dir</a>);</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a80ad08512968ec45635df68abe66b1fc">input_bndry_planes</a> &amp;&amp; dir &lt; 2 &amp;&amp; (</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                           ( (<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i == <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa559799ff291d4e692283c4056bac8db1">BCVars::Rho_bc_comp</a>)       &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_density()) ||</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                           ( (<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i == <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>)  &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_theta()  ) ||</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                           ( (<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i == <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa1556c0a3817c6fab60fbb6952cf0124f">BCVars::RhoKE_bc_comp</a>)     &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_KE()     ) ||</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                           ( (<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i == <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa3fd5e6f8378f1e1e80146b207c062cd8">BCVars::RhoQKE_bc_comp</a>)    &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_QKE()    ) ||</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                           ( (<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i == <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa029ef491930290dea3a984ebdb6d6ae4">BCVars::RhoScalar_bc_comp</a>) &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_scalar() )</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;#ifdef ERF_USE_MOISTURE</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                        || ( (<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i == BCVars::RhoQv_bc_comp)     &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_qv()     )</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                        || ( (<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i == BCVars::RhoQc_bc_comp)     &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_qc()     )</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;#endif</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                           ) ) {</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                            <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca138e8c6c2427dcd78959f3e0e84b3462">ERFBCType::ext_dir_ingested</a>);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                           }</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                    }</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#ad5195ac8f863f5a9a7eaa0db094f7639">NVAR</a>; i++) {</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af">ERFBCType::ext_dir</a>);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a80ad08512968ec45635df68abe66b1fc">input_bndry_planes</a> &amp;&amp; dir &lt; 2 &amp;&amp; (</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                           ( (<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i == <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa559799ff291d4e692283c4056bac8db1">BCVars::Rho_bc_comp</a>)       &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_density()) ||</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                           ( (<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i == <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>)  &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_theta()  ) ||</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                           ( (<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i == <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa1556c0a3817c6fab60fbb6952cf0124f">BCVars::RhoKE_bc_comp</a>)     &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_KE()     ) ||</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                           ( (<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i == <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa3fd5e6f8378f1e1e80146b207c062cd8">BCVars::RhoQKE_bc_comp</a>)    &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_QKE()    ) ||</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                           ( (<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i == <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa029ef491930290dea3a984ebdb6d6ae4">BCVars::RhoScalar_bc_comp</a>) &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_scalar() )</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;#ifdef ERF_USE_MOISTURE</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                        || ( (<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i == BCVars::RhoQv_bc_comp)     &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_qv()     )</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                        || ( (<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i == BCVars::RhoQc_bc_comp)     &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_qc()     )</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;#endif</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                           ) ) {</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                            <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca138e8c6c2427dcd78959f3e0e84b3462">ERFBCType::ext_dir_ingested</a>);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                           }</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                    }</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                }</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;            }</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bct == <a class="code" href="IndexDefines_8H.html#a6e1412fca31cbd35d0f50f12fcc70b0fae6ffdec5e14fce371eb7ae99edebbbee">BC::periodic</a>)</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            {</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#ad5195ac8f863f5a9a7eaa0db094f7639">NVAR</a>; i++)</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca9f18284526a1054d4e7a4783852ead30">ERFBCType::int_dir</a>);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#ad5195ac8f863f5a9a7eaa0db094f7639">NVAR</a>; i++)</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                       <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca9f18284526a1054d4e7a4783852ead30">ERFBCType::int_dir</a>);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                }</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;            }</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( bct == <a class="code" href="IndexDefines_8H.html#a6e1412fca31cbd35d0f50f12fcc70b0fa882dd232c0425bb9366544f84f0a7b6c">BC::MOST</a> )</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;            {</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                AMREX_ALWAYS_ASSERT(dir == 2 &amp;&amp; side == Orientation::low);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="IndexDefines_8H.html#ad5195ac8f863f5a9a7eaa0db094f7639">NVAR</a>; i++) {</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                    <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4a8d85af949a1ce567934e55c69c2846">ERFBCType::foextrap</a>);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                }</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;            }</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        }</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    }</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160; </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="preprocessor">#ifdef AMREX_USE_GPU</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    Gpu::htod_memcpy</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        (<a class="code" href="classERF.html#a8a99e22b1111c803e31b4afd5fcdea60">domain_bcs_type_d</a>.data(), <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>.data(),</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;         <span class="keyword">sizeof</span>(amrex::BCRec)*(<a class="code" href="IndexDefines_8H.html#ad5195ac8f863f5a9a7eaa0db094f7639">NVAR</a>+AMREX_SPACEDIM));</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    std::memcpy</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        (<a class="code" href="classERF.html#a8a99e22b1111c803e31b4afd5fcdea60">domain_bcs_type_d</a>.data(), <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>.data(),</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;         <span class="keyword">sizeof</span>(amrex::BCRec)*(<a class="code" href="IndexDefines_8H.html#ad5195ac8f863f5a9a7eaa0db094f7639">NVAR</a>+AMREX_SPACEDIM));</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa6fd6592c50f03c55ca0f0c9137c7e48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6fd6592c50f03c55ca0f0c9137c7e48">&#9670;&nbsp;</a></span>init_from_input_sounding()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::init_from_input_sounding </td>
          <td>(</td>
          <td class="paramtype">const amrex::Box &amp;&#160;</td>
          <td class="paramname"><em>bx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt; const &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt; const &amp;&#160;</td>
          <td class="paramname"><em>x_vel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt; const &amp;&#160;</td>
          <td class="paramname"><em>y_vel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array4&lt; amrex::Real &gt; const &amp;&#160;</td>
          <td class="paramname"><em>z_vel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::GeometryData const &amp;&#160;</td>
          <td class="paramname"><em>geomdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structInputSoundingData.html">InputSoundingData</a> const &amp;&#160;</td>
          <td class="paramname"><em>inputSoundingData</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                                                    {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>* z_inp_sound     = inputSoundingData.z_inp_sound_d.dataPtr();</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>* theta_inp_sound = inputSoundingData.theta_inp_sound_d.dataPtr();</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>* U_inp_sound     = inputSoundingData.U_inp_sound_d.dataPtr();</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>* V_inp_sound     = inputSoundingData.V_inp_sound_d.dataPtr();</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span>   inp_sound_size  = inputSoundingData.size();</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    amrex::ParallelFor(bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="comment">// Geometry</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="keyword">const</span> amrex::Real* prob_lo = geomdata.ProbLo();</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="keyword">const</span> amrex::Real* dx = geomdata.CellSize();</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="keyword">const</span> amrex::Real <a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> = prob_lo[2] + (k + 0.5) * dx[2];</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <span class="comment">// TODO: Read this from file, the way we do for custom problems</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="comment">// Or provide rho = rho (z) as applicable or computer rho = rho(z) as WRF does</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> rho_0 = 1.0;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="comment">// Set the density</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        state(i, j, k, <a class="code" href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>) = rho_0;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <span class="comment">// Initial Rho0*Theta0</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        state(i, j, k, <a class="code" href="IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>) = rho_0 * <a class="code" href="ERF__Math_8H.html#a803d0d35d4ca4791556cbe02bbf51cbb">interpolate_1d</a>(z_inp_sound, theta_inp_sound, <a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a>, inp_sound_size);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <span class="comment">// Set scalar = A_0*exp(-10r^2), where r is distance from center of domain</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        state(i, j, k, <a class="code" href="IndexDefines_8H.html#a0296f21cd48e5d8236c62ae4ce319b2f">RhoScalar_comp</a>) = 0;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    });</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="comment">// Construct a box that is on x-faces</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keyword">const</span> amrex::Box&amp; xbx = amrex::surroundingNodes(bx,0);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="comment">// Construct a box that is on y-faces</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keyword">const</span> amrex::Box&amp; ybx = amrex::surroundingNodes(bx,1);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="comment">// Construct a box that is on z-faces</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keyword">const</span> amrex::Box&amp; zbx = amrex::surroundingNodes(bx,2);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="comment">// Set the x,y,z-velocities</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    amrex::ParallelFor(xbx, ybx, zbx,</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="comment">// Note that this is called on a box of x-faces</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="keyword">const</span> amrex::Real* prob_lo = geomdata.ProbLo();</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="keyword">const</span> amrex::Real* dx = geomdata.CellSize();</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="keyword">const</span> amrex::Real <a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> = prob_lo[2] + (k + 0.5) * dx[2];</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <span class="comment">// Set the x-velocity</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        x_vel(i, j, k) = <a class="code" href="ERF__Math_8H.html#a803d0d35d4ca4791556cbe02bbf51cbb">interpolate_1d</a>(z_inp_sound, U_inp_sound, <a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a>, inp_sound_size);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    },</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="comment">// Note that this is called on a box of y-faces</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="keyword">const</span> amrex::Real* prob_lo = geomdata.ProbLo();</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="keyword">const</span> amrex::Real* dx = geomdata.CellSize();</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <span class="keyword">const</span> amrex::Real <a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> = prob_lo[2] + (k + 0.5) * dx[2];</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="comment">// Set the y-velocity</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        y_vel(i, j, k) = <a class="code" href="ERF__Math_8H.html#a803d0d35d4ca4791556cbe02bbf51cbb">interpolate_1d</a>(z_inp_sound, V_inp_sound, <a class="code" href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a>, inp_sound_size);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    },</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept {</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="comment">// Note that this is called on a box of z-faces</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="comment">// Set the z-velocity</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        z_vel(i, j, k) = 0.0;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    });</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_aa6fd6592c50f03c55ca0f0c9137c7e48_cgraph.png" border="0" usemap="#classERF_aa6fd6592c50f03c55ca0f0c9137c7e48_cgraph" alt=""/></div>
<map name="classERF_aa6fd6592c50f03c55ca0f0c9137c7e48_cgraph" id="classERF_aa6fd6592c50f03c55ca0f0c9137c7e48_cgraph">
<area shape="rect" title=" " alt="" coords="5,23,159,65"/>
<area shape="rect" href="ERF__Math_8H.html#a803d0d35d4ca4791556cbe02bbf51cbb" title=" " alt="" coords="239,5,355,32"/>
<area shape="rect" href="structInputSoundingData.html#af2e8c00eb0bd0d64abf35528b33b3240" title=" " alt="" coords="207,56,387,83"/>
</map>
</div>

</div>
</div>
<a id="a80981e20939a6a38ba17478da2253ff1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80981e20939a6a38ba17478da2253ff1">&#9670;&nbsp;</a></span>init_only()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::init_only </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;{</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev] = time;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <a class="code" href="classERF.html#a7085d7d5fc94a0f84efc06957267d58e">t_old</a>[lev] = time - 1.e200;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160; </div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <span class="comment">// We only want to read the file once -- here we fill one FArrayBox (per variable) that spans the domain</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="keywordflow">if</span> (lev == 0) {</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#af5ac3d88a33a1a284bcc120ce0599cf7">init_type</a> == <span class="stringliteral">&quot;input_sounding&quot;</span>) {</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a536424e14c4139e4683b15c59e742362">input_sounding_file</a>.empty())</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                amrex::Error(<span class="stringliteral">&quot;input_sounding file name must be provided via input&quot;</span>);</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;            <a class="code" href="classERF.html#a83572d8dfad51158945b4a5ab06b2f72">input_sounding_data</a>.<a class="code" href="structInputSoundingData.html#a6c176f22c90b76170e1fa254d4583de3">read_from_file</a>(<a class="code" href="classERF.html#a536424e14c4139e4683b15c59e742362">input_sounding_file</a>);</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        }</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    }</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160; </div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="preprocessor">#ifdef ERF_USE_NETCDF</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;     <span class="comment">// Note that we read the initial data at all the levels</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#af5ac3d88a33a1a284bcc120ce0599cf7">init_type</a> == <span class="stringliteral">&quot;ideal&quot;</span> || <a class="code" href="classERF.html#af5ac3d88a33a1a284bcc120ce0599cf7">init_type</a> == <span class="stringliteral">&quot;real&quot;</span>) {</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a99757524a49a79368069f66f71797c9d">nc_init_file</a>.size() == 0)</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;            amrex::Error(<span class="stringliteral">&quot;NetCDF initialization file name must be provided via input&quot;</span>);</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        read_from_wrfinput(lev);</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        }</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <span class="keywordflow">if</span> (lev == 0) {</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#af5ac3d88a33a1a284bcc120ce0599cf7">init_type</a> == <span class="stringliteral">&quot;real&quot;</span> &amp;&amp; (!geom[0].isPeriodic(0) || !geom[0].isPeriodic(1))) {</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a7e9040f32464f1a6dee6e0384393451d">nc_bdy_file</a>.empty())</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                amrex::Error(<span class="stringliteral">&quot;NetCDF boundary file name must be provided via input&quot;</span>);</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;            <span class="comment">//read_from_wrfbdy(); // TODO: Uncomment after it&#39;s working correctly</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        }</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    }</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="preprocessor">#endif //ERF_USE_NETCDF</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160; </div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="keyword">auto</span>&amp; lev_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev];</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160; </div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <span class="comment">// Loop over grids at this level to initialize our grid data</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    lev_new[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].setVal(0.0);</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    lev_new[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].setVal(0.0);</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    lev_new[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].setVal(0.0);</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    lev_new[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].setVal(0.0);</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160; </div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#af5ac3d88a33a1a284bcc120ce0599cf7">init_type</a> == <span class="stringliteral">&quot;custom&quot;</span> || <a class="code" href="classERF.html#af5ac3d88a33a1a284bcc120ce0599cf7">init_type</a> == <span class="stringliteral">&quot;input_sounding&quot;</span>) {</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160; </div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="preprocessor">#pragma omp parallel if (amrex::Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        <span class="keywordflow">for</span> (MFIter mfi(lev_new[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], TilingIfNotGPU()); mfi.isValid(); ++mfi) {</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;            <span class="keyword">const</span> Box &amp;bx = mfi.tilebox();</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;            <span class="keyword">const</span> <span class="keyword">auto</span> &amp;cons_arr = lev_new[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].array(mfi);</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;            <span class="keyword">const</span> <span class="keyword">auto</span> &amp;xvel_arr = lev_new[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].array(mfi);</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;            <span class="keyword">const</span> <span class="keyword">auto</span> &amp;yvel_arr = lev_new[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].array(mfi);</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;            <span class="keyword">const</span> <span class="keyword">auto</span> &amp;zvel_arr = lev_new[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].array(mfi);</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160; </div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#af5ac3d88a33a1a284bcc120ce0599cf7">init_type</a> == <span class="stringliteral">&quot;custom&quot;</span>) {</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="preprocessor">#ifndef ERF_USE_TERRAIN</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                <a class="code" href="prob__common_8H.html#aaa081a4255fd836eef28bb48e3bf7856">init_custom_prob</a>(bx, cons_arr, xvel_arr, yvel_arr, zvel_arr, geom[lev].data());</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                <span class="keyword">const</span> <span class="keyword">auto</span>&amp; r_hse_arr = dens_hse[lev].array(mfi);</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                <span class="keyword">const</span> <span class="keyword">auto</span>&amp; p_hse_arr = pres_hse[lev].array(mfi);</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                <span class="keyword">const</span> <span class="keyword">auto</span>&amp; z_nd_arr  = z_phys_nd[lev].const_array(mfi);</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                <span class="keyword">const</span> <span class="keyword">auto</span>&amp; z_cc_arr  = z_phys_cc[lev].const_array(mfi);</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160; </div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                <a class="code" href="prob__common_8H.html#aaa081a4255fd836eef28bb48e3bf7856">init_custom_prob</a>(bx, cons_arr, xvel_arr, yvel_arr, zvel_arr,</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                              r_hse_arr, p_hse_arr, z_nd_arr, z_cc_arr,</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                              geom[lev].data());</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;            }</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;            <span class="keywordflow">else</span> { <span class="comment">// init_type == &quot;input_sounding&quot;, simplified problem, shouldn&#39;t depend on ERF_USE_TERRAIN</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                <a class="code" href="classERF.html#aa6fd6592c50f03c55ca0f0c9137c7e48">init_from_input_sounding</a>(bx, cons_arr, xvel_arr, yvel_arr, zvel_arr,</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                                         geom[lev].data(), <a class="code" href="classERF.html#a83572d8dfad51158945b4a5ab06b2f72">input_sounding_data</a>);</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;            }</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        } <span class="comment">//mfi</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    } <span class="comment">// init_type == &quot;custom&quot; || init_type == &quot;input_sounding&quot;</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160; </div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="preprocessor">#ifdef ERF_USE_NETCDF</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classERF.html#af5ac3d88a33a1a284bcc120ce0599cf7">init_type</a> == <span class="stringliteral">&quot;ideal&quot;</span> || <a class="code" href="classERF.html#af5ac3d88a33a1a284bcc120ce0599cf7">init_type</a> == <span class="stringliteral">&quot;real&quot;</span>) {</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="preprocessor">#pragma omp parallel if (amrex::Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        <span class="comment">// INITIAL DATA common for &quot;ideal&quot; as well as &quot;real&quot; simulation</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        <span class="keywordflow">for</span> ( MFIter mfi(lev_new[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], TilingIfNotGPU()); mfi.isValid(); ++mfi ) {</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;            <span class="keyword">const</span> Box &amp;bx = mfi.tilebox();</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;            <span class="comment">// Define fabs for holding the initial data</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;            FArrayBox &amp;cons_fab = lev_new[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>][mfi];</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;            FArrayBox &amp;xvel_fab = lev_new[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>][mfi];</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;            FArrayBox &amp;yvel_fab = lev_new[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>][mfi];</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;            FArrayBox &amp;zvel_fab = lev_new[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>][mfi];</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160; </div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="preprocessor">#ifdef ERF_USE_TERRAIN</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;          FArrayBox&amp; z_phys_nd_fab = z_phys_nd[lev][mfi];</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;          init_from_wrfinput(lev, bx, cons_fab, xvel_fab, yvel_fab, zvel_fab,</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                             z_phys_nd_fab);</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;          init_from_wrfinput(lev, bx, cons_fab, xvel_fab, yvel_fab, zvel_fab);</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        }</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    } <span class="comment">// init_type == &quot;ideal&quot; || init_type == &quot;real&quot;</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="preprocessor">#endif //ERF_USE_NETCDF</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160; </div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <span class="comment">// Ensure that the face-based data are the same on both sides of a periodic domain.</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <span class="comment">// The data associated with the lower grid ID is considered the correct value.</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    lev_new[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].OverrideSync(geom[lev].periodicity());</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    lev_new[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].OverrideSync(geom[lev].periodicity());</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    lev_new[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].OverrideSync(geom[lev].periodicity());</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a80981e20939a6a38ba17478da2253ff1_cgraph.png" border="0" usemap="#classERF_a80981e20939a6a38ba17478da2253ff1_cgraph" alt=""/></div>
<map name="classERF_a80981e20939a6a38ba17478da2253ff1_cgraph" id="classERF_a80981e20939a6a38ba17478da2253ff1_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,116,32"/>
<area shape="rect" href="prob__common_8H.html#aaa081a4255fd836eef28bb48e3bf7856" title=" " alt="" coords="164,5,299,32"/>
</map>
</div>

</div>
</div>
<a id="ad5d585e110291969767013a515719224"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5d585e110291969767013a515719224">&#9670;&nbsp;</a></span>InitData()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::InitData </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;{</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="comment">// Initialize the start time for our CPU-time tracker</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <a class="code" href="classERF.html#a3890ee3bf2586cf0ef2822b671c5d8c4">startCPUTime</a> = amrex::ParallelDescriptor::second();</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160; </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="comment">// Map the words in the inputs file to BC types, then translate</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="comment">//     those types into what they mean for each variable</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <a class="code" href="classERF.html#a618e8fdff3239cc79d4145d02b1ecaa2">init_bcs</a>();</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160; </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="comment">// Verify BCs are compatible sith solver choice</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a0a031373331c9aca22a47b0995729f46">pbl_type</a> == <a class="code" href="DataStruct_8H.html#a4a079f2650ca30c787a8375ec5f17ca5abdeb9a753db1d1f3fe0e944eab1d0601">PBLType::MYNN25</a> &amp;&amp;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <a class="code" href="classERF.html#ab8f4a61c714936efc1c669447b009c29">phys_bc_type</a>[Orientation(Direction::z,Orientation::low)] != <a class="code" href="IndexDefines_8H.html#a6e1412fca31cbd35d0f50f12fcc70b0fa882dd232c0425bb9366544f84f0a7b6c">BC::MOST</a>) {</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        amrex::Abort(<span class="stringliteral">&quot;MYNN2.5 PBL Model requires MOST at lower boundary&quot;</span>);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160; </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <a class="code" href="classERF.html#a4e3d0f4486b62037fce08fca0aa2d0a9">last_plot_file_step</a> = -1;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <a class="code" href="classERF.html#a02722d16f3c26efe590702200f1296d7">last_check_file_step</a> = -1;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a> == <span class="stringliteral">&quot;&quot;</span>) {</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        <span class="comment">// start simulation from the beginning</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> time = 0.0;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        InitFromScratch(time);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        <span class="comment">// For now we initialize rho_KE to 0</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = finest_level-1; lev &gt;= 0; --lev)</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].setVal(0.0,<a class="code" href="IndexDefines_8H.html#ae15721db2cb4c2ab4732afe226bbba64">RhoKE_comp</a>,1,0);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="preprocessor">#ifdef ERF_USE_TERRAIN</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; lev++)</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        {</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;            init_ideal_terrain(lev);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;            <a class="code" href="TerrainMetrics_8cpp.html#a55942b90d16d1e216ce1459858c70af7">init_terrain_grid</a>(lev,geom[lev],z_phys_nd[lev]);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            <a class="code" href="TerrainMetrics_8H.html#a53363537d3e953e585899d27b19b0f7f">make_metrics</a>(geom[lev],z_phys_nd[lev],z_phys_cc[lev],detJ_cc[lev]);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        }</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; lev++)</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            <a class="code" href="classERF.html#a80981e20939a6a38ba17478da2253ff1">init_only</a>(lev, time);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <a class="code" href="classERF.html#a8202de1f8f372e3e6fdc483447c6a55f">AverageDown</a>();</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160; </div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a1f48ec3caf326a6b1b986d061d36ee90">check_int</a> &gt; 0)</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        {</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="preprocessor">#ifdef ERF_USE_NETCDF</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32e0d0f5ae0db18ee81f9d4325a14f64">check_type</a> == <span class="stringliteral">&quot;netcdf&quot;</span>) {</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;               WriteNCCheckpointFile();</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            }</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32e0d0f5ae0db18ee81f9d4325a14f64">check_type</a> == <span class="stringliteral">&quot;native&quot;</span>) {</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;               <a class="code" href="classERF.html#ad101fd46096db2d6b21544bfede6551f">WriteCheckpointFile</a>();</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;            }</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            <a class="code" href="classERF.html#a02722d16f3c26efe590702200f1296d7">last_check_file_step</a> = 0;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        }</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160; </div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    } <span class="keywordflow">else</span> { <span class="comment">// Restart from a checkpoint</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160; </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <a class="code" href="classERF.html#a530d2ce59e6fd46e9fb00e4d11eaf737">restart</a>();</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160; </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="preprocessor">#ifdef ERF_USE_TERRAIN</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        <span class="comment">// This must come after the call to restart because that</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        <span class="comment">//      is where we read in the mesh data</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = finest_level-1; lev &gt;= 0; --lev)</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;            <a class="code" href="TerrainMetrics_8H.html#a53363537d3e953e585899d27b19b0f7f">make_metrics</a>(geom[lev],z_phys_nd[lev],z_phys_cc[lev],detJ_cc[lev]);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    }</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160; </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a80ad08512968ec45635df68abe66b1fc">input_bndry_planes</a>) {</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <span class="comment">// Create the ReadBndryPlanes object so we can handle reading of boundary plane data</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Defining r2d for the first time &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a> = std::make_unique&lt; ReadBndryPlanes&gt;(geom[0]);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160; </div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <span class="comment">// Read the &quot;time.dat&quot; file to know what data is available</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;read_time_file();</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160; </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        amrex::Real dt_dummy = 1.e200;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;read_input_files(<a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0],dt_dummy,<a class="code" href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">m_bc_extdir_vals</a>);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    }</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160; </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="comment">// Initialize flux registers (whether we start from scratch or restart)</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#af25f70d7d9e4edeedcc40c117cc15505">do_reflux</a>) {</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <a class="code" href="classERF.html#a2ef8ab09aed437467e2e87a37bcd999d">flux_registers</a>[0] = 0;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 1; lev &lt;= finest_level; lev++)</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        {</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            <a class="code" href="classERF.html#a2ef8ab09aed437467e2e87a37bcd999d">flux_registers</a>[lev] = <span class="keyword">new</span> FluxRegister(grids[lev], dmap[lev], ref_ratio[lev-1], lev, <a class="code" href="IndexDefines_8H.html#ad5195ac8f863f5a9a7eaa0db094f7639">NVAR</a>);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        }</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    }</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160; </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <a class="code" href="classERF.html#a92c020bfaa43e40fb5ffc449427a0318">initHSE</a>();</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="comment">// Configure ABLMost params if used MostWall boundary condition</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="comment">// NOTE: we must set up the MOST routine before calling WritePlotFile because</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="comment">//       WritePlotFile calls FillPatch in order to compute gradients</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ab8f4a61c714936efc1c669447b009c29">phys_bc_type</a>[Orientation(Direction::z,Orientation::low)] == <a class="code" href="IndexDefines_8H.html#a6e1412fca31cbd35d0f50f12fcc70b0fa882dd232c0425bb9366544f84f0a7b6c">BC::MOST</a>)</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    {</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <a class="code" href="classERF.html#a051364b2373d8d86151c0b4a958035bd">m_most</a> = std::make_unique&lt;ABLMost&gt;(geom);</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; lev++)</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            <a class="code" href="classERF.html#a67da556b4b4cbdc891da06eb5e17aac8">setupABLMost</a>(lev);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    }</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160; </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#abe64c2ff781da4cc0642ee1d29c912d6">plot_int</a> &gt; 0)</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    {</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        <span class="keywordflow">if</span> ( (<a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a> == <span class="stringliteral">&quot;&quot;</span>) ||</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;             (<a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a> != <span class="stringliteral">&quot;&quot;</span> &amp;&amp; <a class="code" href="classERF.html#adc00038dfe4c332e5d15f621184c69e8">plot_file_on_restart</a>) )</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        {</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;            <a class="code" href="classERF.html#abed910c4bcc14524b3c1a7d353d40de5">WritePlotFile</a>();</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;            <a class="code" href="classERF.html#a4e3d0f4486b62037fce08fca0aa2d0a9">last_plot_file_step</a> = <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[0];</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        }</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    }</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a27ced9266434a4680ef175e7b2ba8f01">use_rayleigh_damping</a>)</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    {</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        <a class="code" href="classERF.html#a039a764a1d942c484e8aea49e87bc046">initRayleigh</a>();</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    }</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160; </div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ad4c61fad53912d1e8d0f774d365bcf0f">is_it_time_for_action</a>(<a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[0], <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0], <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[0], <a class="code" href="classERF.html#a5232e98479611a24fe97994640c61faa">sum_interval</a>, <a class="code" href="classERF.html#a6f9e05e91a9b4a16d615af290966a973">sum_per</a>)) {</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        <a class="code" href="classERF.html#a922892a05ee0c5bccd210a3e5a8599e1">sum_integrated_quantities</a>(<a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0]);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    }</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160; </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="comment">// We only write the file at level 0 for now</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a7c448670f7a5cadd6fe56f7e615c9eb6">output_bndry_planes</a>)</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    {</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        <span class="comment">// Create the WriteBndryPlanes object so we can handle writing of boundary plane data</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        <a class="code" href="classERF.html#aa53035f34ba133b86172e180abda4209">m_w2d</a> = std::make_unique&lt;WriteBndryPlanes&gt;(grids,geom);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160; </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        amrex::Real time = 0.;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        <span class="keywordflow">if</span> (time &gt;= <a class="code" href="classERF.html#ac2be0759e68086d0e9026c61492fa225">bndry_output_planes_start_time</a>) {</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;            <a class="code" href="classERF.html#aa53035f34ba133b86172e180abda4209">m_w2d</a>-&gt;write_planes(0, time, <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>);</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        }</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    }</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="comment">// Fill ghost cells/faces</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = finest_level-1; lev &gt;= 0; --lev)</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    {</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        <span class="keyword">auto</span>&amp; lev_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev];</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        <span class="keyword">auto</span>&amp; lev_old = <a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev];</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160; </div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        <a class="code" href="classERF.html#a3d8f63f2178b1cb5ba78a433ece34e1c">FillPatch</a>(lev, <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev], lev_new);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160; </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        <span class="comment">// Copy from new into old just in case</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        <span class="keywordtype">int</span> ngs   = lev_new[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nGrow();</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        <span class="keywordtype">int</span> ngvel = lev_new[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].nGrow();</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        MultiFab::Copy(lev_old[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],lev_new[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],0,0,<a class="code" href="IndexDefines_8H.html#ad5195ac8f863f5a9a7eaa0db094f7639">NVAR</a>,ngs);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        MultiFab::Copy(lev_old[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],lev_new[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],0,0,1,ngvel);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        MultiFab::Copy(lev_old[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],lev_new[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],0,0,1,ngvel);</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        MultiFab::Copy(lev_old[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>],lev_new[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>],0,0,1,ngvel);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    }</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160; </div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_ad5d585e110291969767013a515719224_cgraph.png" border="0" usemap="#classERF_ad5d585e110291969767013a515719224_cgraph" alt=""/></div>
<map name="classERF_ad5d585e110291969767013a515719224_cgraph" id="classERF_ad5d585e110291969767013a515719224_cgraph">
<area shape="rect" title=" " alt="" coords="5,38,112,65"/>
<area shape="rect" href="TerrainMetrics_8cpp.html#a55942b90d16d1e216ce1459858c70af7" title=" " alt="" coords="160,13,285,39"/>
<area shape="rect" href="TerrainMetrics_8H.html#a53363537d3e953e585899d27b19b0f7f" title=" " alt="" coords="165,63,280,90"/>
<area shape="rect" href="TerrainMetrics_8H.html#a71f983fb17fbd1efe4db041d6a36b36c" title=" " alt="" coords="333,5,477,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_ad5d585e110291969767013a515719224_icgraph.png" border="0" usemap="#classERF_ad5d585e110291969767013a515719224_icgraph" alt=""/></div>
<map name="classERF_ad5d585e110291969767013a515719224_icgraph" id="classERF_ad5d585e110291969767013a515719224_icgraph">
<area shape="rect" title=" " alt="" coords="108,5,215,32"/>
<area shape="rect" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,60,32"/>
</map>
</div>

</div>
</div>
<a id="a92c020bfaa43e40fb5ffc449427a0318"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92c020bfaa43e40fb5ffc449427a0318">&#9670;&nbsp;</a></span>initHSE()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::initHSE </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize HSE. </p>
<div class="fragment"><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;{</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#ifdef ERF_USE_TERRAIN</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; lev++)</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <a class="code" href="prob__common_8H.html#ae1b3e66694fef92a0c9fd18b186d6d5d">erf_init_dens_hse</a>(dens_hse[lev], z_phys_nd[lev], z_phys_cc[lev], geom[lev]);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <a class="code" href="classERF.html#ae994c0e7f0d87b787de9bb971f0da64c">erf_enforce_hse</a>(lev, dens_hse[lev], pres_hse[lev], z_phys_cc[lev]);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    }</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="comment">// Setup Base State Arrays</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <a class="code" href="classERF.html#a7e89a339e79b2b4f177a05e9f0df32fa">h_dens_hse</a>.resize(max_level+1, amrex::Vector&lt;Real&gt;(0));</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <a class="code" href="classERF.html#aff6f5d2bd989b5a0f7c28e2e10e27e8c">h_pres_hse</a>.resize(max_level+1, amrex::Vector&lt;Real&gt;(0));</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <a class="code" href="classERF.html#a3407564246f176655d0dc97733997e52">d_dens_hse</a>.resize(max_level+1, amrex::Gpu::DeviceVector&lt;Real&gt;(0));</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <a class="code" href="classERF.html#a7990255d32f7bca694acab7521101b93">d_pres_hse</a>.resize(max_level+1, amrex::Gpu::DeviceVector&lt;Real&gt;(0));</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; lev++)</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    {</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> zlen_dens = geom[lev].Domain().length(2) + 2*<a class="code" href="classERF.html#addf0fb2aae0efaa649c69685a4dcca83">ng_dens_hse</a>;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <a class="code" href="classERF.html#a7e89a339e79b2b4f177a05e9f0df32fa">h_dens_hse</a>[lev].resize(zlen_dens, 0.0_rt);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <a class="code" href="classERF.html#a3407564246f176655d0dc97733997e52">d_dens_hse</a>[lev].resize(zlen_dens, 0.0_rt);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> zlen_pres = geom[lev].Domain().length(2) + 2*<a class="code" href="classERF.html#a87dc6c0720462bfd088c909289cdca0b">ng_pres_hse</a>;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <a class="code" href="classERF.html#aff6f5d2bd989b5a0f7c28e2e10e27e8c">h_pres_hse</a>[lev].resize(zlen_pres, <a class="code" href="ERF__Constants_8H.html#a60be2e6257954ef746019c916741cb2c">p_0</a>);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <a class="code" href="classERF.html#a7990255d32f7bca694acab7521101b93">d_pres_hse</a>[lev].resize(zlen_pres, <a class="code" href="ERF__Constants_8H.html#a60be2e6257954ef746019c916741cb2c">p_0</a>);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a>* hptr_dens = <a class="code" href="classERF.html#a7e89a339e79b2b4f177a05e9f0df32fa">h_dens_hse</a>[lev].data() + <a class="code" href="classERF.html#addf0fb2aae0efaa649c69685a4dcca83">ng_dens_hse</a>;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <a class="code" href="prob__common_8H.html#ae1b3e66694fef92a0c9fd18b186d6d5d">erf_init_dens_hse</a>(hptr_dens,geom[lev],<a class="code" href="classERF.html#addf0fb2aae0efaa649c69685a4dcca83">ng_dens_hse</a>);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <a class="code" href="classERF.html#ae994c0e7f0d87b787de9bb971f0da64c">erf_enforce_hse</a>(lev,<a class="code" href="classERF.html#a7e89a339e79b2b4f177a05e9f0df32fa">h_dens_hse</a>[lev],<a class="code" href="classERF.html#aff6f5d2bd989b5a0f7c28e2e10e27e8c">h_pres_hse</a>[lev]);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <span class="comment">// Copy from host version to device version</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        amrex::Gpu::copy(amrex::Gpu::hostToDevice, <a class="code" href="classERF.html#a7e89a339e79b2b4f177a05e9f0df32fa">h_dens_hse</a>[lev].begin(), <a class="code" href="classERF.html#a7e89a339e79b2b4f177a05e9f0df32fa">h_dens_hse</a>[lev].end(),</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                         <a class="code" href="classERF.html#a3407564246f176655d0dc97733997e52">d_dens_hse</a>[lev].begin());</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        amrex::Gpu::copy(amrex::Gpu::hostToDevice, <a class="code" href="classERF.html#aff6f5d2bd989b5a0f7c28e2e10e27e8c">h_pres_hse</a>[lev].begin(), <a class="code" href="classERF.html#aff6f5d2bd989b5a0f7c28e2e10e27e8c">h_pres_hse</a>[lev].end(),</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                     <a class="code" href="classERF.html#a7990255d32f7bca694acab7521101b93">d_pres_hse</a>[lev].begin());</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    }</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a92c020bfaa43e40fb5ffc449427a0318_cgraph.png" border="0" usemap="#classERF_a92c020bfaa43e40fb5ffc449427a0318_cgraph" alt=""/></div>
<map name="classERF_a92c020bfaa43e40fb5ffc449427a0318_cgraph" id="classERF_a92c020bfaa43e40fb5ffc449427a0318_cgraph">
<area shape="rect" title="Initialize HSE." alt="" coords="5,5,107,32"/>
<area shape="rect" href="prob__common_8H.html#ae1b3e66694fef92a0c9fd18b186d6d5d" title=" " alt="" coords="155,5,291,32"/>
</map>
</div>

</div>
</div>
<a id="a2e1874d47d95c7c858c2a2336fd0eee6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e1874d47d95c7c858c2a2336fd0eee6">&#9670;&nbsp;</a></span>InitializeFromFile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::InitializeFromFile </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a914f576acc2d1a54203a220cce10df62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a914f576acc2d1a54203a220cce10df62">&#9670;&nbsp;</a></span>InitializeLevelFromData()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::InitializeLevelFromData </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>initial_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a039a764a1d942c484e8aea49e87bc046"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a039a764a1d942c484e8aea49e87bc046">&#9670;&nbsp;</a></span>initRayleigh()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::initRayleigh </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize Rayleigh damping profiles. </p>
<div class="fragment"><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;{</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;    AMREX_ALWAYS_ASSERT(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a27ced9266434a4680ef175e7b2ba8f01">use_rayleigh_damping</a>);</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160; </div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    <a class="code" href="classERF.html#a1bc503c07e76f2a4791a76e6907e6dd7">h_rayleigh_tau</a>.resize(max_level+1, amrex::Vector&lt;Real&gt;(0));</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    <a class="code" href="classERF.html#ac4dc443840da3593fe66b8693803f006">h_rayleigh_ubar</a>.resize(max_level+1, amrex::Vector&lt;Real&gt;(0));</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    <a class="code" href="classERF.html#a6e0624ac1d76fbde394c7ba4b01ed7eb">h_rayleigh_vbar</a>.resize(max_level+1, amrex::Vector&lt;Real&gt;(0));</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    <a class="code" href="classERF.html#a0f074d984fb0a319cf7a781b2efc3d63">h_rayleigh_thetabar</a>.resize(max_level+1, amrex::Vector&lt;Real&gt;(0));</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <a class="code" href="classERF.html#a91e9618892751232c4067c253f904a3d">d_rayleigh_tau</a>.resize(max_level+1, amrex::Gpu::DeviceVector&lt;Real&gt;(0));</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <a class="code" href="classERF.html#af33ee878e24ced10b3da319795723db0">d_rayleigh_ubar</a>.resize(max_level+1, amrex::Gpu::DeviceVector&lt;Real&gt;(0));</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <a class="code" href="classERF.html#a879501e88824fa6a00ffe1509059b21e">d_rayleigh_vbar</a>.resize(max_level+1, amrex::Gpu::DeviceVector&lt;Real&gt;(0));</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <a class="code" href="classERF.html#a4c992f63bcc9d7e7693990bf046bfc4b">d_rayleigh_thetabar</a>.resize(max_level+1, amrex::Gpu::DeviceVector&lt;Real&gt;(0));</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; lev++)</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    {</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> zlen_rayleigh = geom[lev].Domain().length(2);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;        <a class="code" href="classERF.html#a1bc503c07e76f2a4791a76e6907e6dd7">h_rayleigh_tau</a>[lev].resize(zlen_rayleigh, 0.0_rt);</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;        <a class="code" href="classERF.html#a91e9618892751232c4067c253f904a3d">d_rayleigh_tau</a>[lev].resize(zlen_rayleigh, 0.0_rt);</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;        <a class="code" href="classERF.html#ac4dc443840da3593fe66b8693803f006">h_rayleigh_ubar</a>[lev].resize(zlen_rayleigh, 0.0_rt);</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        <a class="code" href="classERF.html#af33ee878e24ced10b3da319795723db0">d_rayleigh_ubar</a>[lev].resize(zlen_rayleigh, 0.0_rt);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        <a class="code" href="classERF.html#a6e0624ac1d76fbde394c7ba4b01ed7eb">h_rayleigh_vbar</a>[lev].resize(zlen_rayleigh, 0.0_rt);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        <a class="code" href="classERF.html#a879501e88824fa6a00ffe1509059b21e">d_rayleigh_vbar</a>[lev].resize(zlen_rayleigh, 0.0_rt);</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        <a class="code" href="classERF.html#a0f074d984fb0a319cf7a781b2efc3d63">h_rayleigh_thetabar</a>[lev].resize(zlen_rayleigh, 0.0_rt);</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        <a class="code" href="classERF.html#a4c992f63bcc9d7e7693990bf046bfc4b">d_rayleigh_thetabar</a>[lev].resize(zlen_rayleigh, 0.0_rt);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        <a class="code" href="prob__common_8H.html#ad0da799211f82f28a9e0d53008febb1b">erf_init_rayleigh</a>(<a class="code" href="classERF.html#a1bc503c07e76f2a4791a76e6907e6dd7">h_rayleigh_tau</a>[lev], <a class="code" href="classERF.html#ac4dc443840da3593fe66b8693803f006">h_rayleigh_ubar</a>[lev], <a class="code" href="classERF.html#a6e0624ac1d76fbde394c7ba4b01ed7eb">h_rayleigh_vbar</a>[lev],</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;                          <a class="code" href="classERF.html#a0f074d984fb0a319cf7a781b2efc3d63">h_rayleigh_thetabar</a>[lev], geom[lev]);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        <span class="comment">// Copy from host version to device version</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        amrex::Gpu::copy(amrex::Gpu::hostToDevice, <a class="code" href="classERF.html#a1bc503c07e76f2a4791a76e6907e6dd7">h_rayleigh_tau</a>[lev].begin(), <a class="code" href="classERF.html#a1bc503c07e76f2a4791a76e6907e6dd7">h_rayleigh_tau</a>[lev].end(),</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;                         <a class="code" href="classERF.html#a91e9618892751232c4067c253f904a3d">d_rayleigh_tau</a>[lev].begin());</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        amrex::Gpu::copy(amrex::Gpu::hostToDevice, <a class="code" href="classERF.html#ac4dc443840da3593fe66b8693803f006">h_rayleigh_ubar</a>[lev].begin(), <a class="code" href="classERF.html#ac4dc443840da3593fe66b8693803f006">h_rayleigh_ubar</a>[lev].end(),</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                         <a class="code" href="classERF.html#af33ee878e24ced10b3da319795723db0">d_rayleigh_ubar</a>[lev].begin());</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        amrex::Gpu::copy(amrex::Gpu::hostToDevice, <a class="code" href="classERF.html#a6e0624ac1d76fbde394c7ba4b01ed7eb">h_rayleigh_vbar</a>[lev].begin(), <a class="code" href="classERF.html#a6e0624ac1d76fbde394c7ba4b01ed7eb">h_rayleigh_vbar</a>[lev].end(),</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;                         <a class="code" href="classERF.html#a879501e88824fa6a00ffe1509059b21e">d_rayleigh_vbar</a>[lev].begin());</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        amrex::Gpu::copy(amrex::Gpu::hostToDevice, <a class="code" href="classERF.html#a0f074d984fb0a319cf7a781b2efc3d63">h_rayleigh_thetabar</a>[lev].begin(), <a class="code" href="classERF.html#a0f074d984fb0a319cf7a781b2efc3d63">h_rayleigh_thetabar</a>[lev].end(),</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;                         <a class="code" href="classERF.html#a4c992f63bcc9d7e7693990bf046bfc4b">d_rayleigh_thetabar</a>[lev].begin());</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    }</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a039a764a1d942c484e8aea49e87bc046_cgraph.png" border="0" usemap="#classERF_a039a764a1d942c484e8aea49e87bc046_cgraph" alt=""/></div>
<map name="classERF_a039a764a1d942c484e8aea49e87bc046_cgraph" id="classERF_a039a764a1d942c484e8aea49e87bc046_cgraph">
<area shape="rect" title="Initialize Rayleigh damping profiles." alt="" coords="5,5,137,32"/>
<area shape="rect" href="prob__common_8H.html#ad0da799211f82f28a9e0d53008febb1b" title=" " alt="" coords="185,5,313,32"/>
</map>
</div>

</div>
</div>
<a id="ad4c61fad53912d1e8d0f774d365bcf0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4c61fad53912d1e8d0f774d365bcf0f">&#9670;&nbsp;</a></span>is_it_time_for_action()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ERF::is_it_time_for_action </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nstep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>action_interval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>action_per</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;{</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <span class="keywordtype">bool</span> int_test = (action_interval &gt; 0 &amp;&amp; nstep % action_interval == 0);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="keywordtype">bool</span> per_test = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="keywordflow">if</span> (action_per &gt; 0.0) {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> num_per_old = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(amrex::Math::floor((time - dtlev) / action_per));</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> num_per_new = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(amrex::Math::floor((time) / action_per));</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordflow">if</span> (num_per_old != num_per_new) {</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      per_test = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    }</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  }</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="keywordflow">return</span> int_test || per_test;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a01987b2556834788694f2f3741a2afe4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01987b2556834788694f2f3741a2afe4">&#9670;&nbsp;</a></span>MakeHorizontalAverages()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::MakeHorizontalAverages </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;{</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <span class="comment">// We need to create horizontal averages for 5 variables:</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    <span class="comment">// density, temperature, pressure, qc, qv (if present)</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160; </div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    <span class="comment">// First, average down all levels</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    <a class="code" href="classERF.html#a8202de1f8f372e3e6fdc483447c6a55f">AverageDown</a>();</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160; </div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    <span class="comment">// get the number of cells in z at level 0</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    <span class="keywordtype">int</span> dir_z = AMREX_SPACEDIM-1;</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <span class="keyword">auto</span> domain = geom[0].Domain();</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    <span class="keywordtype">int</span> size_z = domain.length(dir_z);</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    <span class="keywordtype">int</span> start_z = domain.smallEnd()[dir_z];</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> area_z = <span class="keyword">static_cast&lt;</span><a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a><span class="keyword">&gt;</span>(domain.length(0));</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    area_z *= domain.length(1);</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160; </div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    <span class="comment">// resize the level 0 horizontal average vectors</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    <a class="code" href="classERF.html#a4dd7c603e65d230105a4f1e0afb4cf8a">h_havg_density</a>.resize(size_z, 0.0_rt);</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    <a class="code" href="classERF.html#a9683c7b07c287e57856ee5a9c99917a1">h_havg_temperature</a>.resize(size_z, 0.0_rt);</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    <a class="code" href="classERF.html#a413293737b0021c97b50c62756561446">h_havg_pressure</a>.resize(size_z, 0.0_rt);</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="preprocessor">#ifdef ERF_USE_MOISTURE</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    h_havg_qv.resize(size_z, 0.0_rt);</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    h_havg_qc.resize(size_z, 0.0_rt);</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160; </div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    <span class="comment">// get the cell centered data and construct sums</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    <span class="keyword">auto</span>&amp; mf_cons = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[0][<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>];</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;<span class="preprocessor">#pragma omp parallel if (amrex::Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    <span class="keywordflow">for</span> (MFIter mfi(mf_cons); mfi.isValid(); ++mfi) {</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        <span class="keyword">const</span> Box&amp; box = mfi.validbox();</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;        <span class="keyword">const</span> IntVect&amp; se = box.smallEnd();</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        <span class="keyword">const</span> IntVect&amp; be = box.bigEnd();</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;        <span class="keyword">auto</span>  arr_cons = mf_cons[mfi].array();</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160; </div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;<span class="preprocessor">#ifdef ERF_USE_MOISTURE</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;        FArrayBox fab_reduce(box, 5);</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;        FArrayBox fab_reduce(box, 3);</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        Elixir elx_reduce = fab_reduce.elixir();</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        <span class="keyword">auto</span> arr_reduce = fab_reduce.array();</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160; </div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;        ParallelFor(box, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) {</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> dens = arr_cons(i, j, k, <a class="code" href="namespaceCons.html#ab92931555eff5e3d0d9eb62ae0225cc1a5c9c77ea576137ca2664783567e7f588">Cons::Rho</a>);</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;            arr_reduce(i, j, k, 0) = dens;</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;            arr_reduce(i, j, k, 1) = arr_cons(i, j, k, <a class="code" href="namespaceCons.html#ab92931555eff5e3d0d9eb62ae0225cc1a7ba34ebd02f164da2892ceb823948315">Cons::RhoTheta</a>) / dens;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;            arr_reduce(i, j, k, 2) = <a class="code" href="EOS_8H.html#a292ce90ab26c75f4a444808a807b532b">getPgivenRTh</a>(arr_cons(i, j, k, <a class="code" href="namespaceCons.html#ab92931555eff5e3d0d9eb62ae0225cc1a7ba34ebd02f164da2892ceb823948315">Cons::RhoTheta</a>));</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="preprocessor">#ifdef ERF_USE_MOISTURE</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;            arr_reduce(i, j, k, 3) = arr_cons(i, j, k, Cons::RhoQv) / dens;</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;            arr_reduce(i, j, k, 4) = arr_cons(i, j, k, Cons::RhoQc) / dens;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        });</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160; </div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=se[dir_z]; k &lt;= be[dir_z]; ++k) {</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;            Box kbox(box); kbox.setSmall(dir_z,k); kbox.setBig(dir_z,k);</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;            <a class="code" href="classERF.html#a4dd7c603e65d230105a4f1e0afb4cf8a">h_havg_density</a>     [k-start_z] += fab_reduce.sum&lt;RunOn::Device&gt;(kbox,0);</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;            <a class="code" href="classERF.html#a9683c7b07c287e57856ee5a9c99917a1">h_havg_temperature</a> [k-start_z] += fab_reduce.sum&lt;RunOn::Device&gt;(kbox,1);</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;            <a class="code" href="classERF.html#a413293737b0021c97b50c62756561446">h_havg_pressure</a>    [k-start_z] += fab_reduce.sum&lt;RunOn::Device&gt;(kbox,2);</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;<span class="preprocessor">#ifdef ERF_USE_MOISTURE</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;            h_havg_qv          [k-start_z] += fab_reduce.sum&lt;RunOn::Device&gt;(kbox,3);</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;            h_havg_qc          [k-start_z] += fab_reduce.sum&lt;RunOn::Device&gt;(kbox,4);</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;        }</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    }</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160; </div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    <span class="comment">// combine sums from different MPI ranks</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    ParallelDescriptor::ReduceRealSum(<a class="code" href="classERF.html#a4dd7c603e65d230105a4f1e0afb4cf8a">h_havg_density</a>.dataPtr(), <a class="code" href="classERF.html#a4dd7c603e65d230105a4f1e0afb4cf8a">h_havg_density</a>.size());</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    ParallelDescriptor::ReduceRealSum(<a class="code" href="classERF.html#a9683c7b07c287e57856ee5a9c99917a1">h_havg_temperature</a>.dataPtr(), <a class="code" href="classERF.html#a9683c7b07c287e57856ee5a9c99917a1">h_havg_temperature</a>.size());</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    ParallelDescriptor::ReduceRealSum(<a class="code" href="classERF.html#a413293737b0021c97b50c62756561446">h_havg_pressure</a>.dataPtr(), <a class="code" href="classERF.html#a413293737b0021c97b50c62756561446">h_havg_pressure</a>.size());</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<span class="preprocessor">#ifdef ERF_USE_MOISTURE</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    ParallelDescriptor::ReduceRealSum(h_havg_qv.dataPtr(), h_havg_qv.size());</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    ParallelDescriptor::ReduceRealSum(h_havg_qc.dataPtr(), h_havg_qc.size());</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160; </div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    <span class="comment">// divide by the total number of cells we are averaging over</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; size_z; ++k) {</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;        <a class="code" href="classERF.html#a4dd7c603e65d230105a4f1e0afb4cf8a">h_havg_density</a>[k]     /= area_z;</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;        <a class="code" href="classERF.html#a9683c7b07c287e57856ee5a9c99917a1">h_havg_temperature</a>[k] /= area_z;</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;        <a class="code" href="classERF.html#a413293737b0021c97b50c62756561446">h_havg_pressure</a>[k]    /= area_z;</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="preprocessor">#ifdef ERF_USE_MOISTURE</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;        h_havg_qv[k]          /= area_z;</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;        h_havg_qc[k]          /= area_z;</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    }</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160; </div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    <span class="comment">// resize device vectors</span></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    <a class="code" href="classERF.html#a84cf7616e7b3928f08f4bd56112db01e">d_havg_density</a>.resize(size_z, 0.0_rt);</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    <a class="code" href="classERF.html#a20350959b7b3e252ee3a802e7998ca8d">d_havg_temperature</a>.resize(size_z, 0.0_rt);</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    <a class="code" href="classERF.html#a9a4f076c56f31fbb5e68c09706605a05">d_havg_pressure</a>.resize(size_z, 0.0_rt);</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<span class="preprocessor">#ifdef ERF_USE_MOISTURE</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    d_havg_qv.resize(size_z, 0.0_rt);</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    d_havg_qc.resize(size_z, 0.0_rt);</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160; </div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    <span class="comment">// copy host vectors to device vectors</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    amrex::Gpu::copy(amrex::Gpu::hostToDevice, <a class="code" href="classERF.html#a4dd7c603e65d230105a4f1e0afb4cf8a">h_havg_density</a>.begin(), <a class="code" href="classERF.html#a4dd7c603e65d230105a4f1e0afb4cf8a">h_havg_density</a>.end(), <a class="code" href="classERF.html#a84cf7616e7b3928f08f4bd56112db01e">d_havg_density</a>.begin());</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    amrex::Gpu::copy(amrex::Gpu::hostToDevice, <a class="code" href="classERF.html#a9683c7b07c287e57856ee5a9c99917a1">h_havg_temperature</a>.begin(), <a class="code" href="classERF.html#a9683c7b07c287e57856ee5a9c99917a1">h_havg_temperature</a>.end(), <a class="code" href="classERF.html#a20350959b7b3e252ee3a802e7998ca8d">d_havg_temperature</a>.begin());</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    amrex::Gpu::copy(amrex::Gpu::hostToDevice, <a class="code" href="classERF.html#a413293737b0021c97b50c62756561446">h_havg_pressure</a>.begin(), <a class="code" href="classERF.html#a413293737b0021c97b50c62756561446">h_havg_pressure</a>.end(), <a class="code" href="classERF.html#a9a4f076c56f31fbb5e68c09706605a05">d_havg_pressure</a>.begin());</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;<span class="preprocessor">#ifdef ERF_USE_MOISTURE</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    amrex::Gpu::copy(amrex::Gpu::hostToDevice, h_havg_qv.begin(), h_havg_qv.end(), d_havg_qv.begin());</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    amrex::Gpu::copy(amrex::Gpu::hostToDevice, h_havg_qc.begin(), h_havg_qc.end(), d_havg_qc.begin());</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a01987b2556834788694f2f3741a2afe4_cgraph.png" border="0" usemap="#classERF_a01987b2556834788694f2f3741a2afe4_cgraph" alt=""/></div>
<map name="classERF_a01987b2556834788694f2f3741a2afe4_cgraph" id="classERF_a01987b2556834788694f2f3741a2afe4_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,221,32"/>
<area shape="rect" href="EOS_8H.html#a292ce90ab26c75f4a444808a807b532b" title=" " alt="" coords="269,5,380,32"/>
</map>
</div>

</div>
</div>
<a id="abb6175c28b36d23f5dda2994ca4a85e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb6175c28b36d23f5dda2994ca4a85e7">&#9670;&nbsp;</a></span>MakeNewLevelFromCoarse()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::MakeNewLevelFromCoarse </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::BoxArray &amp;&#160;</td>
          <td class="paramname"><em>ba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::DistributionMapping &amp;&#160;</td>
          <td class="paramname"><em>dm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;{</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; crse_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev-1];</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="keyword">auto</span>&amp; lev_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev];</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="keyword">auto</span>&amp; lev_old = <a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev];</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160; </div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    lev_new[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].define(ba, dm, crse_new[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nComp(), crse_new[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nGrowVect());</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    lev_old[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].define(ba, dm, crse_new[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nComp(), crse_new[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nGrowVect());</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160; </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    lev_new[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].define(convert(ba, IntVect(1,0,0)), dm, 1, crse_new[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].nGrowVect());</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    lev_old[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].define(convert(ba, IntVect(1,0,0)), dm, 1, crse_new[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].nGrowVect());</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160; </div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    lev_new[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].define(convert(ba, IntVect(0,1,0)), dm, 1, crse_new[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].nGrowVect());</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    lev_old[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].define(convert(ba, IntVect(0,1,0)), dm, 1, crse_new[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].nGrowVect());</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160; </div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    lev_new[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].define(convert(ba, IntVect(0,0,1)), dm, 1, crse_new[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].nGrowVect());</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    lev_old[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].define(convert(ba, IntVect(0,0,1)), dm, 1, crse_new[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].nGrowVect());</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160; </div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev] = time;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <a class="code" href="classERF.html#a7085d7d5fc94a0f84efc06957267d58e">t_old</a>[lev] = time - 1.e200;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160; </div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <a class="code" href="classERF.html#a252eec287326f8dcc72dee7f3cc105c4">FillCoarsePatchAllVars</a>(lev, time, <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev]);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aaf10bbf8c9a5dbc257a88c4c1b650fee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf10bbf8c9a5dbc257a88c4c1b650fee">&#9670;&nbsp;</a></span>MakeNewLevelFromScratch()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::MakeNewLevelFromScratch </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::BoxArray &amp;&#160;</td>
          <td class="paramname"><em>ba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::DistributionMapping &amp;&#160;</td>
          <td class="paramname"><em>dm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;{</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="comment">// Set BoxArray grids and DistributionMapping dmap in AMReX_AmrMesh.H class</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    SetBoxArray(lev, ba);</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    SetDistributionMap(lev, dm);</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160; </div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="comment">// The number of ghost cells for density must be 1 greater than that for velocity</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="comment">//     so that we can go back in forth betwen velocity and momentum on all faces</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="keywordtype">int</span> ngrow_state = <a class="code" href="classERF.html#a0f5b892bf373e46ae54597683e0f9685">ComputeGhostCells</a>(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a8e053ce39997ed619ac81aa4d5a1fd44">spatial_order</a>)+1;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="keywordtype">int</span> ngrow_vels  = <a class="code" href="classERF.html#a0f5b892bf373e46ae54597683e0f9685">ComputeGhostCells</a>(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a8e053ce39997ed619ac81aa4d5a1fd44">spatial_order</a>);</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160; </div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="keyword">auto</span>&amp; lev_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev];</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="keyword">auto</span>&amp; lev_old = <a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev];</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160; </div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    lev_new[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].define(ba, dm, <a class="code" href="namespaceCons.html#ab92931555eff5e3d0d9eb62ae0225cc1a5934ebcc17d4dfd56ed8cf6221c9a5ed">Cons::NumVars</a>, ngrow_state);</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    lev_old[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].define(ba, dm, <a class="code" href="namespaceCons.html#ab92931555eff5e3d0d9eb62ae0225cc1a5934ebcc17d4dfd56ed8cf6221c9a5ed">Cons::NumVars</a>, ngrow_state);</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160; </div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    lev_new[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].define(convert(ba, IntVect(1,0,0)), dm, 1, ngrow_vels);</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    lev_old[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].define(convert(ba, IntVect(1,0,0)), dm, 1, ngrow_vels);</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160; </div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    lev_new[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].define(convert(ba, IntVect(0,1,0)), dm, 1, ngrow_vels);</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    lev_old[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].define(convert(ba, IntVect(0,1,0)), dm, 1, ngrow_vels);</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160; </div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    lev_new[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].define(convert(ba, IntVect(0,0,1)), dm, 1, IntVect(ngrow_vels,ngrow_vels,0));</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    lev_old[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].define(convert(ba, IntVect(0,0,1)), dm, 1, IntVect(ngrow_vels,ngrow_vels,0));</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160; </div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="preprocessor">#ifdef ERF_USE_TERRAIN</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    z_phys_nd.resize(lev+1);</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    z_phys_cc.resize(lev+1);</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    detJ_cc.resize(lev+1);</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    dens_hse.resize(lev+1);</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    pres_hse.resize(lev+1);</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160; </div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    pres_hse[lev].define(ba,dm,1,1);</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    dens_hse[lev].define(ba,dm,1,1);</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    z_phys_cc[lev].define(ba,dm,1,1);</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    detJ_cc[lev].define(ba,dm,1,1);</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160; </div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    BoxArray ba_nd(ba);</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    ba_nd.surroundingNodes();</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    z_phys_nd[lev].define(ba_nd,dm,1,2);</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160; </div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="preprocessor">#ifdef ERF_USE_NETCDF</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    NC_xvel_fab.resize(lev+1);</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    NC_yvel_fab.resize(lev+1);</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    NC_zvel_fab.resize(lev+1);</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    NC_rho_fab.resize(lev+1);</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    NC_rhotheta_fab.resize(lev+1);</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160; </div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="preprocessor">#ifdef ERF_USE_TERRAIN</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    NC_PH_fab.resize(lev+1);</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    NC_PHB_fab.resize(lev+1);</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac1238c1616826c66df1dfd9076e6a3da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1238c1616826c66df1dfd9076e6a3da">&#9670;&nbsp;</a></span>NumDataLogs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">AMREX_FORCE_INLINE int ERF::NumDataLogs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    {</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classERF.html#a1cade630b005dbcc0f644987ef3db287">datalog</a>.size();</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a54f6c5d799e51521ad10bb57d29d0c44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54f6c5d799e51521ad10bb57d29d0c44">&#9670;&nbsp;</a></span>PlotFileName()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ERF::PlotFileName </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;{</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <span class="keywordflow">return</span> Concatenate(<a class="code" href="classERF.html#ad02c77d3f4a7dfa0ad679877f0f05fc1">plot_file</a>, lev, 5);</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7e2f504a37e9b721618d135030c7ae04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e2f504a37e9b721618d135030c7ae04">&#9670;&nbsp;</a></span>PlotFileVarNames()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Vector&lt; std::string &gt; ERF::PlotFileVarNames </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;{</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    Vector&lt;std::string&gt; names;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    names.insert(names.end(), <a class="code" href="classERF.html#a5239b3dae0bf9ba78876bf2e8d497016">plot_state_names</a>.begin(), <a class="code" href="classERF.html#a5239b3dae0bf9ba78876bf2e8d497016">plot_state_names</a>.end());</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    names.insert(names.end(), <a class="code" href="classERF.html#a123e428e6385285dfb646bc6f85ce654">plot_deriv_names</a>.begin(), <a class="code" href="classERF.html#a123e428e6385285dfb646bc6f85ce654">plot_deriv_names</a>.end());</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordflow">return</span> names;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a58f6683aff0fbe6949bfe8b49275a8b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58f6683aff0fbe6949bfe8b49275a8b3">&#9670;&nbsp;</a></span>post_timestep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::post_timestep </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nstep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>dt_lev</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;{</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    BL_PROFILE(<span class="stringliteral">&quot;ERF::post_timestep()&quot;</span>);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#af25f70d7d9e4edeedcc40c117cc15505">do_reflux</a>)</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    {</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = finest_level-1; lev &gt;= 0; lev--)</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        {</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            <span class="comment">// This call refluxes from the lev/lev+1 interface onto lev</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            <a class="code" href="classERF.html#afd3cbffc97b8a89e58042e029c5c6b7c">get_flux_reg</a>(lev+1).Reflux(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],1.0, 0, 0, <a class="code" href="IndexDefines_8H.html#ad5195ac8f863f5a9a7eaa0db094f7639">NVAR</a>, geom[lev]);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            <span class="comment">// We need to do this before anything else because refluxing changes the</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            <span class="comment">// values of coarse cells underneath fine grids with the assumption they&#39;ll</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            <span class="comment">// be over-written by averaging down</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            <a class="code" href="classERF.html#a40ebca562ac79fcc9250e17e0f4a5b41">AverageDownTo</a>(lev);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        }</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    }</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ad4c61fad53912d1e8d0f774d365bcf0f">is_it_time_for_action</a>(nstep, time, dt_lev0, <a class="code" href="classERF.html#a5232e98479611a24fe97994640c61faa">sum_interval</a>, <a class="code" href="classERF.html#a6f9e05e91a9b4a16d615af290966a973">sum_per</a>)) {</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        <a class="code" href="classERF.html#a922892a05ee0c5bccd210a3e5a8599e1">sum_integrated_quantities</a>(time);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    }</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160; </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ad17ff2753e754ff3eb1330612b820b5f">output_1d_column</a>) {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="preprocessor">#ifdef ERF_USE_NETCDF</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ad4c61fad53912d1e8d0f774d365bcf0f">is_it_time_for_action</a>(nstep, time, dt_lev0, <a class="code" href="classERF.html#afa0bef6d3146788302b81c0d4f4802d1">column_interval</a>, <a class="code" href="classERF.html#a9fedd41de89817a23b1c3b3c6ef7443f">column_per</a>))</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      {</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;         <span class="keywordtype">int</span> lev_column = 0;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = finest_level; lev &gt;= 0; lev--)</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;         {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> dx_lev = geom[lev].CellSize(0);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> dy_lev = geom[lev].CellSize(1);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            <span class="keywordtype">int</span> i_lev = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(std::floor(<a class="code" href="classERF.html#ab10bfe15c2d15fdd22201b64722a4022">column_loc_x</a> / dx_lev));</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            <span class="keywordtype">int</span> j_lev = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(std::floor(<a class="code" href="classERF.html#a30a1b51c733c3a20dc6948f9a3620bbb">column_loc_y</a> / dy_lev));</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            <span class="keywordflow">if</span> (grids[lev].contains(IntVect(i_lev,j_lev,0))) lev_column = lev;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;         }</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;         writeToNCColumnFile(lev_column, <a class="code" href="classERF.html#a48bba6b1c1b39940b09aefbe56311e2f">column_file_name</a>, <a class="code" href="classERF.html#ab10bfe15c2d15fdd22201b64722a4022">column_loc_x</a>, <a class="code" href="classERF.html#a30a1b51c733c3a20dc6948f9a3620bbb">column_loc_y</a>, time);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      }</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      amrex::Abort(<span class="stringliteral">&quot;To output 1D column files ERF must be compiled with NetCDF&quot;</span>);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    }</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160; </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a7c448670f7a5cadd6fe56f7e615c9eb6">output_bndry_planes</a>)</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    {</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ad4c61fad53912d1e8d0f774d365bcf0f">is_it_time_for_action</a>(<a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[0], time, dt_lev0, <a class="code" href="classERF.html#aab4575d8fb57595a2f1aaf088c60447a">bndry_output_planes_interval</a>, <a class="code" href="classERF.html#a479132ab37232f208597c7a27c132866">bndry_output_planes_per</a>) &amp;&amp;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;          time &gt;= <a class="code" href="classERF.html#ac2be0759e68086d0e9026c61492fa225">bndry_output_planes_start_time</a>)</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      {</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;         <a class="code" href="classERF.html#aa53035f34ba133b86172e180abda4209">m_w2d</a>-&gt;write_planes(<a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[0], time, <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      }</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    }</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae41b0a6d3d44d8f07fbcef60143e6bad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae41b0a6d3d44d8f07fbcef60143e6bad">&#9670;&nbsp;</a></span>post_update()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::post_update </td>
          <td>(</td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>state_mf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Geometry &amp;&#160;</td>
          <td class="paramname"><em>geom</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="af285247b24b173cd851fe49799d17f42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af285247b24b173cd851fe49799d17f42">&#9670;&nbsp;</a></span>ReadCheckpointFile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::ReadCheckpointFile </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;{</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Restart from checkpoint &quot;</span> &lt;&lt; <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="comment">// Header</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    std::string File(<a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a> + <span class="stringliteral">&quot;/Header&quot;</span>);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    VisMF::IO_Buffer io_buffer(VisMF::GetIOBufferSize());</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    Vector&lt;char&gt; fileCharPtr;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    ParallelDescriptor::ReadAndBcastFile(File, fileCharPtr);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    std::string fileCharPtrString(fileCharPtr.dataPtr());</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    std::istringstream is(fileCharPtrString, std::istringstream::in);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    std::string line, word;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordtype">int</span> chk_ncomp;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="comment">// read in title line</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    std::getline(is, line);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="comment">// read in finest_level</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    is &gt;&gt; finest_level;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <a class="code" href="classERF.html#aaee255b031e63bd9b5807f6612739dbd">GotoNextLine</a>(is);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="comment">// read the number of components</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="comment">// for each variable we store</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="comment">// conservative, cell-centered vars</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    is &gt;&gt; chk_ncomp;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <a class="code" href="classERF.html#aaee255b031e63bd9b5807f6612739dbd">GotoNextLine</a>(is);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    AMREX_ASSERT(chk_ncomp == <a class="code" href="namespaceCons.html#ab92931555eff5e3d0d9eb62ae0225cc1a5934ebcc17d4dfd56ed8cf6221c9a5ed">Cons::NumVars</a>);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="comment">// x-velocity on faces</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    is &gt;&gt; chk_ncomp;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <a class="code" href="classERF.html#aaee255b031e63bd9b5807f6612739dbd">GotoNextLine</a>(is);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    AMREX_ASSERT(chk_ncomp == 1);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="comment">// y-velocity on faces</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    is &gt;&gt; chk_ncomp;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <a class="code" href="classERF.html#aaee255b031e63bd9b5807f6612739dbd">GotoNextLine</a>(is);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    AMREX_ASSERT(chk_ncomp == 1);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="comment">// z-velocity on faces</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    is &gt;&gt; chk_ncomp;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <a class="code" href="classERF.html#aaee255b031e63bd9b5807f6612739dbd">GotoNextLine</a>(is);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    AMREX_ASSERT(chk_ncomp == 1);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="comment">// read in array of istep</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    std::getline(is, line);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    {</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        std::istringstream lis(line);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="keywordflow">while</span> (lis &gt;&gt; word) {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[i++] = std::stoi(word);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        }</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="comment">// read in array of dt</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    std::getline(is, line);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        std::istringstream lis(line);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <span class="keywordflow">while</span> (lis &gt;&gt; word) {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[i++] = std::stod(word);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        }</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    }</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="comment">// read in array of t_new</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    std::getline(is, line);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        std::istringstream lis(line);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <span class="keywordflow">while</span> (lis &gt;&gt; word) {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;            <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[i++] = std::stod(word);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        }</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    }</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <span class="comment">// read in level &#39;lev&#39; BoxArray from Header</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        BoxArray ba;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        ba.readFrom(is);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <a class="code" href="classERF.html#aaee255b031e63bd9b5807f6612739dbd">GotoNextLine</a>(is);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160; </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        <span class="comment">// create a distribution mapping</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        DistributionMapping dm { ba, ParallelDescriptor::NProcs() };</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <a class="code" href="classERF.html#aaf10bbf8c9a5dbc257a88c4c1b650fee">MakeNewLevelFromScratch</a> (lev, <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev], ba, dm);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    }</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="comment">// read in the MultiFab data</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev)</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        MultiFab <a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">cons</a>(grids[lev],dmap[lev],<a class="code" href="namespaceCons.html#ab92931555eff5e3d0d9eb62ae0225cc1a5934ebcc17d4dfd56ed8cf6221c9a5ed">Cons::NumVars</a>,0);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        VisMF::Read(<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">cons</a>, amrex::MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;Cell&quot;</span>));</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <span class="comment">//vars_new[lev][Vars::cons].setVal(0.);</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        MultiFab::Copy(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">cons</a>,0,0,<a class="code" href="namespaceCons.html#ab92931555eff5e3d0d9eb62ae0225cc1a5934ebcc17d4dfd56ed8cf6221c9a5ed">Cons::NumVars</a>,0);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        MultiFab <a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca2a10a6e726515894b07621908abd4c0c">xvel</a>(convert(grids[lev],IntVect(1,0,0)),dmap[lev],1,0);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        VisMF::Read(<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca2a10a6e726515894b07621908abd4c0c">xvel</a>, amrex::MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;XFace&quot;</span>));</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        MultiFab::Copy(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca2a10a6e726515894b07621908abd4c0c">xvel</a>,0,0,1,0);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        MultiFab <a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca81793b83204cfa56d4683bc676fbbfb6">yvel</a>(convert(grids[lev],IntVect(0,1,0)),dmap[lev],1,0);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        VisMF::Read(<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca81793b83204cfa56d4683bc676fbbfb6">yvel</a>, amrex::MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;YFace&quot;</span>));</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        MultiFab::Copy(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca81793b83204cfa56d4683bc676fbbfb6">yvel</a>,0,0,1,0);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        MultiFab <a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca48ee63b17bc216e9661511c33c68bd8b">zvel</a>(convert(grids[lev],IntVect(0,0,1)),dmap[lev],1,0);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        VisMF::Read(<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca48ee63b17bc216e9661511c33c68bd8b">zvel</a>, amrex::MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;ZFace&quot;</span>));</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        MultiFab::Copy(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>],<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca48ee63b17bc216e9661511c33c68bd8b">zvel</a>,0,0,1,0);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="preprocessor">#ifdef ERF_USE_TERRAIN</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;       <span class="comment">// Note that we read the ghost cells of z_phys_nd (unlike above)</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;       MultiFab z_height(convert(grids[lev],IntVect(1,1,1)),dmap[lev],1,1);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;       VisMF::Read(z_height, amrex::MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;Z_Phys_nd&quot;</span>));</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;       MultiFab::Copy(z_phys_nd[lev],z_height,0,0,1,1);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    }</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2d39cd3bdc3d90609ad3b14e266d190a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d39cd3bdc3d90609ad3b14e266d190a">&#9670;&nbsp;</a></span>ReadParameters()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::ReadParameters </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;{</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    {</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        ParmParse pp;  <span class="comment">// Traditionally, max_step and stop_time do not have prefix.</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        pp.query(<span class="stringliteral">&quot;max_step&quot;</span>, <a class="code" href="classERF.html#a0634154e8e58379c495c3e7fe7c5e4d6">max_step</a>);</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        pp.query(<span class="stringliteral">&quot;stop_time&quot;</span>, <a class="code" href="classERF.html#a405556a52bef334ab68294c1a540e107">stop_time</a>);</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    }</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160; </div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    {</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;        ParmParse pp(<span class="stringliteral">&quot;amr&quot;</span>); <span class="comment">// Traditionally, these have prefix, amr.</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160; </div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        pp.query(<span class="stringliteral">&quot;regrid_int&quot;</span>, <a class="code" href="classERF.html#a3937527f96c81674fa38dc34ed24f3f5">regrid_int</a>);</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        pp.query(<span class="stringliteral">&quot;plot_file&quot;</span>, <a class="code" href="classERF.html#ad02c77d3f4a7dfa0ad679877f0f05fc1">plot_file</a>);</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        pp.query(<span class="stringliteral">&quot;plot_type&quot;</span>, <a class="code" href="classERF.html#a3aa38bc97a888d859a640220d2bc4456">plot_type</a>);</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        pp.query(<span class="stringliteral">&quot;plot_int&quot;</span>, <a class="code" href="classERF.html#abe64c2ff781da4cc0642ee1d29c912d6">plot_int</a>);</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;        pp.query(<span class="stringliteral">&quot;check_file&quot;</span>, <a class="code" href="classERF.html#ae701564fbe3da5bbd88587e5a08eca4e">check_file</a>);</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        pp.query(<span class="stringliteral">&quot;check_type&quot;</span>, <a class="code" href="classERF.html#a32e0d0f5ae0db18ee81f9d4325a14f64">check_type</a>);</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        pp.query(<span class="stringliteral">&quot;check_int&quot;</span>, <a class="code" href="classERF.html#a1f48ec3caf326a6b1b986d061d36ee90">check_int</a>);</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160; </div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;        pp.query(<span class="stringliteral">&quot;restart&quot;</span>, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>);</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160; </div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        <span class="keywordflow">if</span> (pp.contains(<span class="stringliteral">&quot;data_log&quot;</span>))</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        {</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;            <span class="keywordtype">int</span> num_datalogs = pp.countval(<span class="stringliteral">&quot;data_log&quot;</span>);</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;            <a class="code" href="classERF.html#a1cade630b005dbcc0f644987ef3db287">datalog</a>.resize(num_datalogs);</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;            <a class="code" href="classERF.html#a9248a4eb025c2647e003f838cba52a21">datalogname</a>.resize(num_datalogs);</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;            pp.queryarr(<span class="stringliteral">&quot;data_log&quot;</span>,<a class="code" href="classERF.html#a9248a4eb025c2647e003f838cba52a21">datalogname</a>,0,num_datalogs);</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num_datalogs; i++)</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                <a class="code" href="classERF.html#a2486b49bb0d7917f812318822e42a03c">setRecordDataInfo</a>(i,<a class="code" href="classERF.html#a9248a4eb025c2647e003f838cba52a21">datalogname</a>[i]);</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        }</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    }</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160; </div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    {</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        ParmParse pp(<span class="stringliteral">&quot;erf&quot;</span>);</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160; </div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;        <span class="comment">// Verbosity</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        pp.query(<span class="stringliteral">&quot;v&quot;</span>, <a class="code" href="classERF.html#a43d0b17f6e155691a1e9474526df3af5">verbose</a>);</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160; </div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        <span class="comment">// Use the native ERF MRI integrator</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;        pp.query(<span class="stringliteral">&quot;use_native_mri&quot;</span>, <a class="code" href="classERF.html#a4a279f0f572da168852d954df55abe2e">use_native_mri</a>);</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160; </div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;        <span class="comment">// Frequency of diagnostic output</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        pp.query(<span class="stringliteral">&quot;sum_interval&quot;</span>, <a class="code" href="classERF.html#a5232e98479611a24fe97994640c61faa">sum_interval</a>);</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;        pp.query(<span class="stringliteral">&quot;sum_period&quot;</span>  , <a class="code" href="classERF.html#a6f9e05e91a9b4a16d615af290966a973">sum_per</a>);</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160; </div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;        <span class="comment">// Time step controls</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;        pp.query(<span class="stringliteral">&quot;cfl&quot;</span>, <a class="code" href="classERF.html#ae52fe861ffb051a11920238c8210d69f">cfl</a>);</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        pp.query(<span class="stringliteral">&quot;init_shrink&quot;</span>, <a class="code" href="classERF.html#aa30548378350788543d15076cdcd404d">init_shrink</a>);</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        pp.query(<span class="stringliteral">&quot;change_max&quot;</span>, <a class="code" href="classERF.html#ac793fe23b026c18bb7dcce791317c6c3">change_max</a>);</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160; </div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        pp.query(<span class="stringliteral">&quot;fixed_dt&quot;</span>, <a class="code" href="classERF.html#a6e9d302b096a12999c8ff4a6bfa9a072">fixed_dt</a>);</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        pp.query(<span class="stringliteral">&quot;fixed_fast_dt&quot;</span>, <a class="code" href="classERF.html#aa30dffc28e24ac50c880539ca2e36ffd">fixed_fast_dt</a>);</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        pp.query(<span class="stringliteral">&quot;fixed_mri_dt_ratio&quot;</span>, <a class="code" href="classERF.html#ad2e1a979c0ad68e87eaee349beb7e9fd">fixed_mri_dt_ratio</a>);</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;        pp.query(<span class="stringliteral">&quot;use_lowM_dt&quot;</span>, <a class="code" href="classERF.html#aad09820d3e29638db7c3d499304c8aed">use_lowM_dt</a>);</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160; </div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a6e9d302b096a12999c8ff4a6bfa9a072">fixed_dt</a> &gt; 0. &amp;&amp; <a class="code" href="classERF.html#aa30dffc28e24ac50c880539ca2e36ffd">fixed_fast_dt</a> &gt; 0.) {</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ad2e1a979c0ad68e87eaee349beb7e9fd">fixed_mri_dt_ratio</a> &gt; 0 &amp;&amp;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;               <a class="code" href="classERF.html#a6e9d302b096a12999c8ff4a6bfa9a072">fixed_dt</a> / <a class="code" href="classERF.html#aa30dffc28e24ac50c880539ca2e36ffd">fixed_fast_dt</a> != <a class="code" href="classERF.html#ad2e1a979c0ad68e87eaee349beb7e9fd">fixed_mri_dt_ratio</a>)</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;            {</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                amrex::Abort(<span class="stringliteral">&quot;Dt is over-specfied&quot;</span>);</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                <a class="code" href="classERF.html#ad2e1a979c0ad68e87eaee349beb7e9fd">fixed_mri_dt_ratio</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="classERF.html#a6e9d302b096a12999c8ff4a6bfa9a072">fixed_dt</a> / <a class="code" href="classERF.html#aa30dffc28e24ac50c880539ca2e36ffd">fixed_fast_dt</a>);</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ad2e1a979c0ad68e87eaee349beb7e9fd">fixed_mri_dt_ratio</a>%2 != 0)</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                    <a class="code" href="classERF.html#ad2e1a979c0ad68e87eaee349beb7e9fd">fixed_mri_dt_ratio</a> += 1; <span class="comment">// This ratio must be even</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;            }</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;        }</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160; </div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;        AMREX_ASSERT(<a class="code" href="classERF.html#ae52fe861ffb051a11920238c8210d69f">cfl</a> &gt; 0. || <a class="code" href="classERF.html#a6e9d302b096a12999c8ff4a6bfa9a072">fixed_dt</a> &gt; 0.);</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    }</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160; </div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    {  <span class="comment">// Mesh refinement</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160; </div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        ParmParse pp(<span class="stringliteral">&quot;erf&quot;</span>);</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160; </div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;        pp.query(<span class="stringliteral">&quot;coupling_type&quot;</span>,<a class="code" href="classERF.html#a4615db015b395b3a44f1fbf6d6e4fe43">coupling_type</a>);</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a4615db015b395b3a44f1fbf6d6e4fe43">coupling_type</a> == <span class="stringliteral">&quot;OneWay&quot;</span>)</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        {</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;            <a class="code" href="classERF.html#af25f70d7d9e4edeedcc40c117cc15505">do_reflux</a> = 0;</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;            <a class="code" href="classERF.html#a778cdd6547e8cf1613cda8b4a8274bf0">do_avg_down</a> = 0;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        }</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a4615db015b395b3a44f1fbf6d6e4fe43">coupling_type</a> == <span class="stringliteral">&quot;TwoWay&quot;</span>)</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;        {</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;            <a class="code" href="classERF.html#af25f70d7d9e4edeedcc40c117cc15505">do_reflux</a> = 1;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;            <a class="code" href="classERF.html#a778cdd6547e8cf1613cda8b4a8274bf0">do_avg_down</a> = 1;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;            amrex::Error(<span class="stringliteral">&quot;Unknown coupling type&quot;</span>);</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        }</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    }</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160; </div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    {  <span class="comment">// How to initialize</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        ParmParse pp(<span class="stringliteral">&quot;erf&quot;</span>);</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        pp.query(<span class="stringliteral">&quot;init_type&quot;</span>,<a class="code" href="classERF.html#af5ac3d88a33a1a284bcc120ce0599cf7">init_type</a>);</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#af5ac3d88a33a1a284bcc120ce0599cf7">init_type</a> != <span class="stringliteral">&quot;custom&quot;</span> &amp;&amp;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;            <a class="code" href="classERF.html#af5ac3d88a33a1a284bcc120ce0599cf7">init_type</a> != <span class="stringliteral">&quot;ideal&quot;</span> &amp;&amp;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;            <a class="code" href="classERF.html#af5ac3d88a33a1a284bcc120ce0599cf7">init_type</a> != <span class="stringliteral">&quot;real&quot;</span> &amp;&amp;</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;            <a class="code" href="classERF.html#af5ac3d88a33a1a284bcc120ce0599cf7">init_type</a> != <span class="stringliteral">&quot;input_sounding&quot;</span>)</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;        {</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;            amrex::Error(<span class="stringliteral">&quot;init_type must be custom, ideal, real, or input_sounding&quot;</span>);</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;        }</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160; </div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        <span class="comment">// We use this to keep track of how many boxes we read in from WRF initialization</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;        <a class="code" href="classERF.html#adcd9f23975ffa605247b41d391c2a2f0">num_boxes_at_level</a>.resize(max_level+1,0);</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;            <a class="code" href="classERF.html#a050dbd236c9bf246554a53008e09f683">boxes_at_level</a>.resize(max_level+1);</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160; </div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        <span class="comment">// We always have exactly one file at level 0</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        <a class="code" href="classERF.html#adcd9f23975ffa605247b41d391c2a2f0">num_boxes_at_level</a>[0] = 1;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160; </div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;<span class="preprocessor">#ifdef ERF_USE_NETCDF</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        <a class="code" href="classERF.html#a99757524a49a79368069f66f71797c9d">nc_init_file</a>.resize(max_level+1);</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160; </div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        <span class="comment">// NetCDF wrfinput initialization files -- possibly multiple files at each of multiple levels</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        <span class="comment">//        but we always have exactly one file at level 0</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= max_level; i++)</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        {</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;            <span class="keyword">const</span> std::string nc_file_names = amrex::Concatenate(<span class="stringliteral">&quot;nc_init_file_&quot;</span>,i,1);</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;            <span class="keywordflow">if</span> (pp.contains(nc_file_names.c_str()))</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;            {</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;                <span class="keywordtype">int</span> num_files = pp.countval(nc_file_names.c_str());</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                <a class="code" href="classERF.html#adcd9f23975ffa605247b41d391c2a2f0">num_boxes_at_level</a>[i] = num_files;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                <a class="code" href="classERF.html#a99757524a49a79368069f66f71797c9d">nc_init_file</a>[i].resize(num_files);</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                pp.queryarr(nc_file_names.c_str(), <a class="code" href="classERF.html#a99757524a49a79368069f66f71797c9d">nc_init_file</a>[i],0,num_files);</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; num_files; j++)</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                    amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Reading NC init file at level &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; and index &quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot; : &quot;</span> &lt;&lt; <a class="code" href="classERF.html#a99757524a49a79368069f66f71797c9d">nc_init_file</a>[i][j] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;            }</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        }</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160; </div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        <span class="comment">// NetCDF wrfbdy lateral boundary file</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        pp.query(<span class="stringliteral">&quot;nc_bdy_file&quot;</span>, <a class="code" href="classERF.html#a7e9040f32464f1a6dee6e0384393451d">nc_bdy_file</a>);</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160; </div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        <span class="comment">// Text input_sounding file</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;        pp.query(<span class="stringliteral">&quot;input_sounding_file&quot;</span>, <a class="code" href="classERF.html#a536424e14c4139e4683b15c59e742362">input_sounding_file</a>);</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    }</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160; </div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    {  <span class="comment">// Output format</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        ParmParse pp(<span class="stringliteral">&quot;erf&quot;</span>);</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;        pp.query(<span class="stringliteral">&quot;plotfile_type&quot;</span>, <a class="code" href="classERF.html#ae7b9991150042eb38e2abc89399c0c7c">plotfile_type</a>);</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160; </div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        pp.query(<span class="stringliteral">&quot;output_1d_column&quot;</span>, <a class="code" href="classERF.html#ad17ff2753e754ff3eb1330612b820b5f">output_1d_column</a>);</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;        pp.query(<span class="stringliteral">&quot;column_per&quot;</span>, <a class="code" href="classERF.html#a9fedd41de89817a23b1c3b3c6ef7443f">column_per</a>);</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        pp.query(<span class="stringliteral">&quot;column_interval&quot;</span>, <a class="code" href="classERF.html#afa0bef6d3146788302b81c0d4f4802d1">column_interval</a>);</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;        pp.query(<span class="stringliteral">&quot;column_loc_x&quot;</span>, <a class="code" href="classERF.html#ab10bfe15c2d15fdd22201b64722a4022">column_loc_x</a>);</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;        pp.query(<span class="stringliteral">&quot;column_loc_y&quot;</span>, <a class="code" href="classERF.html#a30a1b51c733c3a20dc6948f9a3620bbb">column_loc_y</a>);</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        pp.query(<span class="stringliteral">&quot;column_file_name&quot;</span>, <a class="code" href="classERF.html#a48bba6b1c1b39940b09aefbe56311e2f">column_file_name</a>);</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160; </div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;        <span class="comment">// Specify information about outputting planes of data</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;        pp.query(<span class="stringliteral">&quot;output_bndry_planes&quot;</span>, <a class="code" href="classERF.html#a7c448670f7a5cadd6fe56f7e615c9eb6">output_bndry_planes</a>);</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        pp.query(<span class="stringliteral">&quot;bndry_output_planes_interval&quot;</span>, <a class="code" href="classERF.html#aab4575d8fb57595a2f1aaf088c60447a">bndry_output_planes_interval</a>);</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        pp.query(<span class="stringliteral">&quot;bndry_output_planes_per&quot;</span>, <a class="code" href="classERF.html#a479132ab37232f208597c7a27c132866">bndry_output_planes_per</a>);</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;        pp.query(<span class="stringliteral">&quot;bndry_output_start_time&quot;</span>, <a class="code" href="classERF.html#ac2be0759e68086d0e9026c61492fa225">bndry_output_planes_start_time</a>);</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160; </div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;        <span class="comment">// Specify whether ingest boundary planes of data</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;        pp.query(<span class="stringliteral">&quot;input_bndry_planes&quot;</span>, <a class="code" href="classERF.html#a80ad08512968ec45635df68abe66b1fc">input_bndry_planes</a>);</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    }</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160; </div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a4829661b558b213e32970a02e147077f">init_params</a>();</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa90c9756f684404f8b69b8a23568b535"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa90c9756f684404f8b69b8a23568b535">&#9670;&nbsp;</a></span>refinement_criteria_setup()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::refinement_criteria_setup </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;{</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="keywordflow">if</span> (max_level &gt; 0)</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    {</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        std::string amr_prefix = <span class="stringliteral">&quot;amr&quot;</span>;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        ParmParse ppamr(amr_prefix);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        Vector&lt;std::string&gt; refinement_indicators;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        ppamr.queryarr(<span class="stringliteral">&quot;refinement_indicators&quot;</span>,refinement_indicators,0,ppamr.countval(<span class="stringliteral">&quot;refinement_indicators&quot;</span>));</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;refinement_indicators.size(); ++i)</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        {</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;            std::string ref_prefix = amr_prefix + <span class="stringliteral">&quot;.&quot;</span> + refinement_indicators[i];</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;            ParmParse ppr(ref_prefix);</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;            RealBox realbox;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;            <span class="keywordtype">int</span> lev_for_box;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;            <span class="keywordflow">if</span> (ppr.countval(<span class="stringliteral">&quot;in_box_lo&quot;</span>)) {</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                std::vector&lt;Real&gt; box_lo(3), box_hi(3);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;                ppr.get(<span class="stringliteral">&quot;max_level&quot;</span>,lev_for_box);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;                <span class="keywordflow">if</span> (lev_for_box &lt;= max_level)</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;                {</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;                    ppr.getarr(<span class="stringliteral">&quot;in_box_lo&quot;</span>,box_lo,0,2);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;                    ppr.getarr(<span class="stringliteral">&quot;in_box_hi&quot;</span>,box_hi,0,2);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;                    box_lo[2] = geom[0].ProbLo(2);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                    box_hi[2] = geom[0].ProbHi(2);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;                    realbox = RealBox(&amp;(box_lo[0]),&amp;(box_hi[0]));</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;                    amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Reading &quot;</span> &lt;&lt; realbox &lt;&lt; <span class="stringliteral">&quot; at level lev &quot;</span> &lt;&lt; lev_for_box &lt;&lt; std::endl;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                    <a class="code" href="classERF.html#adcd9f23975ffa605247b41d391c2a2f0">num_boxes_at_level</a>[lev_for_box] += 1;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                    <span class="keyword">auto</span> dx = geom[lev_for_box].CellSize();</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                    <span class="keywordtype">int</span> ilo = box_lo[0]/dx[0]; <span class="keywordtype">int</span> jlo = box_lo[1]/dx[1]; <span class="keywordtype">int</span> klo = box_lo[2]/dx[2];</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                    <span class="keywordtype">int</span> ihi = box_hi[0]/dx[0]; <span class="keywordtype">int</span> jhi = box_hi[1]/dx[1]; <span class="keywordtype">int</span> khi = box_hi[2]/dx[2];</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                    Box bx(IntVect(ilo,jlo,klo),IntVect(ihi,jhi,khi));</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                    <a class="code" href="classERF.html#a050dbd236c9bf246554a53008e09f683">boxes_at_level</a>[lev_for_box].push_back(bx);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                    amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Saving in &#39;boxes at level&#39; as &quot;</span> &lt;&lt; bx &lt;&lt; std::endl;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                } <span class="comment">// lev</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;            }</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;            AMRErrorTagInfo info;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            <span class="keywordflow">if</span> (realbox.ok()) {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                info.SetRealBox(realbox);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;            }</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;            <span class="keywordflow">if</span> (ppr.countval(<span class="stringliteral">&quot;start_time&quot;</span>) &gt; 0) {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> ref_min_time; ppr.get(<span class="stringliteral">&quot;start_time&quot;</span>,ref_min_time);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                info.SetMinTime(ref_min_time);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;            }</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            <span class="keywordflow">if</span> (ppr.countval(<span class="stringliteral">&quot;end_time&quot;</span>) &gt; 0) {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> ref_max_time; ppr.get(<span class="stringliteral">&quot;end_time&quot;</span>,ref_max_time);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                info.SetMaxTime(ref_max_time);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            }</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;            <span class="keywordflow">if</span> (ppr.countval(<span class="stringliteral">&quot;max_level&quot;</span>) &gt; 0) {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                <span class="keywordtype">int</span> ref_max_level; ppr.get(<span class="stringliteral">&quot;max_level&quot;</span>,ref_max_level);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                info.SetMaxLevel(ref_max_level);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            <span class="keywordflow">if</span> (ppr.countval(<span class="stringliteral">&quot;value_greater&quot;</span>)) {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            <span class="keywordtype">int</span> num_val = ppr.countval(<span class="stringliteral">&quot;value_greater&quot;</span>);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;            Vector&lt;Real&gt; value(num_val);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            ppr.getarr(<span class="stringliteral">&quot;value_greater&quot;</span>,value,0,num_val);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                std::string field; ppr.get(<span class="stringliteral">&quot;field_name&quot;</span>,field);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                <a class="code" href="classERF.html#ac81b3dfd7c6f21ba8479834e2ff1e652">ref_tags</a>.push_back(AMRErrorTag(value,AMRErrorTag::GREATER,field,info));</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;            }</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ppr.countval(<span class="stringliteral">&quot;value_less&quot;</span>)) {</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            <span class="keywordtype">int</span> num_val = ppr.countval(<span class="stringliteral">&quot;value_less&quot;</span>);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            Vector&lt;Real&gt; value(num_val);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            ppr.getarr(<span class="stringliteral">&quot;value_less&quot;</span>,value,0,num_val);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                std::string field; ppr.get(<span class="stringliteral">&quot;field_name&quot;</span>,field);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                <a class="code" href="classERF.html#ac81b3dfd7c6f21ba8479834e2ff1e652">ref_tags</a>.push_back(AMRErrorTag(value,AMRErrorTag::LESS,field,info));</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ppr.countval(<span class="stringliteral">&quot;adjacent_difference_greater&quot;</span>)) {</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            <span class="keywordtype">int</span> num_val = ppr.countval(<span class="stringliteral">&quot;adjacent_difference_greater&quot;</span>);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            Vector&lt;Real&gt; value(num_val);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            ppr.getarr(<span class="stringliteral">&quot;adjacent_difference_greater&quot;</span>,value,0,num_val);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                std::string field; ppr.get(<span class="stringliteral">&quot;field_name&quot;</span>,field);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                <a class="code" href="classERF.html#ac81b3dfd7c6f21ba8479834e2ff1e652">ref_tags</a>.push_back(AMRErrorTag(value,AMRErrorTag::GRAD,field,info));</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            }</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (realbox.ok())</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;            {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                <a class="code" href="classERF.html#ac81b3dfd7c6f21ba8479834e2ff1e652">ref_tags</a>.push_back(AMRErrorTag(info));</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                Abort(std::string(<span class="stringliteral">&quot;Unrecognized refinement indicator for &quot;</span> + refinement_indicators[i]).c_str());</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;            }</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        } <span class="comment">// loop over criteria</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    } <span class="comment">// if max_level &gt; 0</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aae7a3a76e08e54c618cf79b30ed2d73d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae7a3a76e08e54c618cf79b30ed2d73d">&#9670;&nbsp;</a></span>RemakeLevel()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::RemakeLevel </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::BoxArray &amp;&#160;</td>
          <td class="paramname"><em>ba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::DistributionMapping &amp;&#160;</td>
          <td class="paramname"><em>dm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;{</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    Vector&lt;MultiFab&gt; temp_lev_new(<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca5deccaa24d5e74279425d7749f7d1494">Vars::NumTypes</a>);</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    Vector&lt;MultiFab&gt; temp_lev_old(<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca5deccaa24d5e74279425d7749f7d1494">Vars::NumTypes</a>);</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160; </div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="keywordtype">int</span> ngrow_state = <a class="code" href="classERF.html#a0f5b892bf373e46ae54597683e0f9685">ComputeGhostCells</a>(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a8e053ce39997ed619ac81aa4d5a1fd44">spatial_order</a>)+1;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="keywordtype">int</span> ngrow_vels  = <a class="code" href="classERF.html#a0f5b892bf373e46ae54597683e0f9685">ComputeGhostCells</a>(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a8e053ce39997ed619ac81aa4d5a1fd44">spatial_order</a>);</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160; </div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    temp_lev_new[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].define(ba, dm, <a class="code" href="namespaceCons.html#ab92931555eff5e3d0d9eb62ae0225cc1a5934ebcc17d4dfd56ed8cf6221c9a5ed">Cons::NumVars</a>, ngrow_state);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    temp_lev_old[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].define(ba, dm, <a class="code" href="namespaceCons.html#ab92931555eff5e3d0d9eb62ae0225cc1a5934ebcc17d4dfd56ed8cf6221c9a5ed">Cons::NumVars</a>, ngrow_state);</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160; </div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    temp_lev_new[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].define(convert(ba, IntVect(1,0,0)), dm, 1, ngrow_vels);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    temp_lev_old[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].define(convert(ba, IntVect(1,0,0)), dm, 1, ngrow_vels);</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160; </div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    temp_lev_new[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].define(convert(ba, IntVect(0,1,0)), dm, 1, ngrow_vels);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    temp_lev_old[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].define(convert(ba, IntVect(0,1,0)), dm, 1, ngrow_vels);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160; </div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    temp_lev_new[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].define(convert(ba, IntVect(0,0,1)), dm, 1, IntVect(ngrow_vels,ngrow_vels,0));</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    temp_lev_old[<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].define(convert(ba, IntVect(0,0,1)), dm, 1, IntVect(ngrow_vels,ngrow_vels,0));</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160; </div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="comment">// This will fill the temporary MultiFabs with data from vars_new</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <a class="code" href="classERF.html#a3d8f63f2178b1cb5ba78a433ece34e1c">FillPatch</a>(lev, time, temp_lev_new);</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <a class="code" href="classERF.html#a3d8f63f2178b1cb5ba78a433ece34e1c">FillPatch</a>(lev, time, temp_lev_old);</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160; </div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> var_idx = 0; var_idx &lt; <a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca5deccaa24d5e74279425d7749f7d1494">Vars::NumTypes</a>; ++var_idx) {</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        std::swap(temp_lev_new[var_idx], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][var_idx]);</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        std::swap(temp_lev_old[var_idx], <a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev][var_idx]);</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    }</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160; </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev] = time;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <a class="code" href="classERF.html#a7085d7d5fc94a0f84efc06957267d58e">t_old</a>[lev] = time - 1.e200;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a530d2ce59e6fd46e9fb00e4d11eaf737"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a530d2ce59e6fd46e9fb00e4d11eaf737">&#9670;&nbsp;</a></span>restart()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::restart </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;{</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="preprocessor">#ifdef ERF_USE_NETCDF</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a3aa38bc97a888d859a640220d2bc4456">plot_type</a> == <span class="stringliteral">&quot;netcdf&quot;</span>) {</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;       ReadNCCheckpointFile();</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    }</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a3aa38bc97a888d859a640220d2bc4456">plot_type</a> == <span class="stringliteral">&quot;native&quot;</span>) {</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;       <a class="code" href="classERF.html#af285247b24b173cd851fe49799d17f42">ReadCheckpointFile</a>();</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    }</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160; </div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="comment">// We set this here so that we don&#39;t over-write the checkpoint file we just started from</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <a class="code" href="classERF.html#a02722d16f3c26efe590702200f1296d7">last_check_file_step</a> = <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[0];</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aef40b8ba6cb32fe3b11b8d9381f16cef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef40b8ba6cb32fe3b11b8d9381f16cef">&#9670;&nbsp;</a></span>setPlotVariables()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::setPlotVariables </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;{</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    ParmParse pp(<span class="stringliteral">&quot;amr&quot;</span>);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160; </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="keywordflow">if</span> (pp.contains(<span class="stringliteral">&quot;plot_vars&quot;</span>))</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    {</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;        std::string nm;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        <span class="keywordtype">int</span> nPltVars = pp.countval(<span class="stringliteral">&quot;plot_vars&quot;</span>);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nPltVars; i++)</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        {</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;            pp.get(<span class="stringliteral">&quot;plot_vars&quot;</span>, nm, i);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;            <span class="keywordflow">if</span> (nm == <span class="stringliteral">&quot;ALL&quot;</span>) {</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;                <span class="comment">// put all conserved state variables in the plot variables list</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;                <a class="code" href="classERF.html#a5239b3dae0bf9ba78876bf2e8d497016">plot_state_names</a> = <a class="code" href="classERF.html#afd8cd5a477754776135befa668fdd0c9">cons_names</a>;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;                <span class="comment">// put all velocity components in the plot variables list</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;                <a class="code" href="classERF.html#a5239b3dae0bf9ba78876bf2e8d497016">plot_state_names</a>.insert(<a class="code" href="classERF.html#a5239b3dae0bf9ba78876bf2e8d497016">plot_state_names</a>.end(), <a class="code" href="classERF.html#a2f2ea7f5eeeb3634944550e5a1de8f7a">velocity_names</a>.begin(), <a class="code" href="classERF.html#a2f2ea7f5eeeb3634944550e5a1de8f7a">velocity_names</a>.end());</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nm == <span class="stringliteral">&quot;NONE&quot;</span> || nm == <span class="stringliteral">&quot;None&quot;</span>) {</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                <span class="comment">// put no state variables in the plot variable list</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;                <a class="code" href="classERF.html#a5239b3dae0bf9ba78876bf2e8d497016">plot_state_names</a>.clear();</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;                <span class="comment">// add the named variable to our list of plot variables</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;                <span class="comment">// if it is not already in the list</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="ERF_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(<a class="code" href="classERF.html#a5239b3dae0bf9ba78876bf2e8d497016">plot_state_names</a>, nm)) {</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;                    <a class="code" href="classERF.html#a5239b3dae0bf9ba78876bf2e8d497016">plot_state_names</a>.push_back(nm);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                }</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;            }</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        }</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    }</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <span class="comment">// The default is to add all state conserved and velocity variables to the plot variables list</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <a class="code" href="classERF.html#a5239b3dae0bf9ba78876bf2e8d497016">plot_state_names</a> = <a class="code" href="classERF.html#afd8cd5a477754776135befa668fdd0c9">cons_names</a>;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <a class="code" href="classERF.html#a5239b3dae0bf9ba78876bf2e8d497016">plot_state_names</a>.insert(<a class="code" href="classERF.html#a5239b3dae0bf9ba78876bf2e8d497016">plot_state_names</a>.end(), <a class="code" href="classERF.html#a2f2ea7f5eeeb3634944550e5a1de8f7a">velocity_names</a>.begin(), <a class="code" href="classERF.html#a2f2ea7f5eeeb3634944550e5a1de8f7a">velocity_names</a>.end());</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    }</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="comment">// Get state variables in the same order as we define them,</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="comment">// since they may be in any order in the input list</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    Vector&lt;std::string&gt; tmp_plot_names;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="namespaceCons.html#ab92931555eff5e3d0d9eb62ae0225cc1a5934ebcc17d4dfd56ed8cf6221c9a5ed">Cons::NumVars</a>; ++i) {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(<a class="code" href="classERF.html#a5239b3dae0bf9ba78876bf2e8d497016">plot_state_names</a>, <a class="code" href="classERF.html#afd8cd5a477754776135befa668fdd0c9">cons_names</a>[i])) {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;            tmp_plot_names.push_back(<a class="code" href="classERF.html#afd8cd5a477754776135befa668fdd0c9">cons_names</a>[i]);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        }</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    }</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="comment">// check for velocity since it&#39;s not in cons_names</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="comment">// if we are asked for any velocity component, we will need them all</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ERF_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(<a class="code" href="classERF.html#a5239b3dae0bf9ba78876bf2e8d497016">plot_state_names</a>, <span class="stringliteral">&quot;x_velocity&quot;</span>) ||</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <a class="code" href="ERF_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(<a class="code" href="classERF.html#a5239b3dae0bf9ba78876bf2e8d497016">plot_state_names</a>, <span class="stringliteral">&quot;y_velocity&quot;</span>) ||</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <a class="code" href="ERF_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(<a class="code" href="classERF.html#a5239b3dae0bf9ba78876bf2e8d497016">plot_state_names</a>, <span class="stringliteral">&quot;z_velocity&quot;</span>)) {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        tmp_plot_names.push_back(<span class="stringliteral">&quot;x_velocity&quot;</span>);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        tmp_plot_names.push_back(<span class="stringliteral">&quot;y_velocity&quot;</span>);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        tmp_plot_names.push_back(<span class="stringliteral">&quot;z_velocity&quot;</span>);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="comment">// check to see if we found all the requested vairables</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> plot_name : <a class="code" href="classERF.html#a5239b3dae0bf9ba78876bf2e8d497016">plot_state_names</a>) {</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="ERF_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(tmp_plot_names, plot_name)) {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    Warning(<span class="stringliteral">&quot;\nWARNING: Requested to plot variable &#39;&quot;</span> + plot_name + <span class="stringliteral">&quot;&#39; but it is not available&quot;</span>);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      }</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    }</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <a class="code" href="classERF.html#a5239b3dae0bf9ba78876bf2e8d497016">plot_state_names</a> = tmp_plot_names;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordflow">if</span> (pp.contains(<span class="stringliteral">&quot;derive_plot_vars&quot;</span>))</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    {</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        std::string nm;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <span class="keywordtype">int</span> nDrvPltVars = pp.countval(<span class="stringliteral">&quot;derive_plot_vars&quot;</span>);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nDrvPltVars; i++)</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            pp.get(<span class="stringliteral">&quot;derive_plot_vars&quot;</span>, nm, i);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            <span class="keywordflow">if</span> (nm == <span class="stringliteral">&quot;ALL&quot;</span>) {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                <span class="comment">// put all diagnostic variables in the plot variables list</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                <a class="code" href="classERF.html#a123e428e6385285dfb646bc6f85ce654">plot_deriv_names</a> = <a class="code" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nm == <span class="stringliteral">&quot;NONE&quot;</span> || nm == <span class="stringliteral">&quot;None&quot;</span>) {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                <span class="comment">// put no diagnostic variables in the plot variable list</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                <a class="code" href="classERF.html#a123e428e6385285dfb646bc6f85ce654">plot_deriv_names</a>.clear();</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                <span class="comment">// add the named variable to our list of plot variables</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                <span class="comment">// if it is not already in the list</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="ERF_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(<a class="code" href="classERF.html#a123e428e6385285dfb646bc6f85ce654">plot_deriv_names</a>, nm)) {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                    <a class="code" href="classERF.html#a123e428e6385285dfb646bc6f85ce654">plot_deriv_names</a>.push_back(nm);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                }</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            }</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        }</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="comment">// The default is to add none of the diagnostic variables to the plot variables list</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <a class="code" href="classERF.html#a123e428e6385285dfb646bc6f85ce654">plot_deriv_names</a>.clear();</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    }</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="comment">// Get derived variables in the same order as we define them,</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="comment">// since they may be in any order in the input list</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    Vector&lt;std::string&gt; tmp_deriv_names;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a>.size(); ++i) {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(<a class="code" href="classERF.html#a123e428e6385285dfb646bc6f85ce654">plot_deriv_names</a>, <a class="code" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a>[i])) {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            tmp_deriv_names.push_back(<a class="code" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a>[i]);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        }</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="comment">// check to see if we found all the requested vairables</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> plot_name : <a class="code" href="classERF.html#a123e428e6385285dfb646bc6f85ce654">plot_deriv_names</a>) {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="ERF_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(tmp_deriv_names, plot_name)) {</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            Warning(<span class="stringliteral">&quot;\nWARNING: Requested to plot derived variable &#39;&quot;</span> + plot_name + <span class="stringliteral">&quot;&#39; but it is not available&quot;</span>);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        }</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    }</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <a class="code" href="classERF.html#a123e428e6385285dfb646bc6f85ce654">plot_deriv_names</a> = tmp_deriv_names;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_aef40b8ba6cb32fe3b11b8d9381f16cef_cgraph.png" border="0" usemap="#classERF_aef40b8ba6cb32fe3b11b8d9381f16cef_cgraph" alt=""/></div>
<map name="classERF_aef40b8ba6cb32fe3b11b8d9381f16cef_cgraph" id="classERF_aef40b8ba6cb32fe3b11b8d9381f16cef_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,164,32"/>
<area shape="rect" href="ERF_8H.html#a1f8554e7b211b0acfc202e8a600e7d67" title=" " alt="" coords="212,5,375,32"/>
</map>
</div>

</div>
</div>
<a id="a2486b49bb0d7917f812318822e42a03c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2486b49bb0d7917f812318822e42a03c">&#9670;&nbsp;</a></span>setRecordDataInfo()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::setRecordDataInfo </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>filename</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    {</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        <span class="keywordflow">if</span> (amrex::ParallelDescriptor::IOProcessor())</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;        {</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;            <a class="code" href="classERF.html#a1cade630b005dbcc0f644987ef3db287">datalog</a>[i] = std::make_unique&lt;std::fstream&gt;();</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;            <a class="code" href="classERF.html#a1cade630b005dbcc0f644987ef3db287">datalog</a>[i]-&gt;open(filename.c_str(),std::ios::out|std::ios::app);</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classERF.html#a1cade630b005dbcc0f644987ef3db287">datalog</a>[i]-&gt;good()) {</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                amrex::FileOpenFailed(filename);</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;            }</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        }</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        amrex::ParallelDescriptor::Barrier(<span class="stringliteral">&quot;ERF::setRecordDataInfo&quot;</span>);</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a67da556b4b4cbdc891da06eb5e17aac8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67da556b4b4cbdc891da06eb5e17aac8">&#9670;&nbsp;</a></span>setupABLMost()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::setupABLMost </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;{</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    MultiFab&amp; S_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>];</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    MultiFab&amp; U_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>];</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    MultiFab&amp; V_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>];</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    MultiFab&amp; W_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>];</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160; </div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    <span class="comment">// Multifab to store primitive Theta, which is what we want to average</span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    MultiFab Theta_prim(S_new.boxArray(), S_new.DistributionMap(), 1, 0);</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    MultiFab::Copy(Theta_prim, S_new, <a class="code" href="namespaceCons.html#ab92931555eff5e3d0d9eb62ae0225cc1a7ba34ebd02f164da2892ceb823948315">Cons::RhoTheta</a>, 0, 1, 0);</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    MultiFab::Divide(Theta_prim, S_new, <a class="code" href="namespaceCons.html#ab92931555eff5e3d0d9eb62ae0225cc1a5c9c77ea576137ca2664783567e7f588">Cons::Rho</a>, 0, 1, 0);</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160; </div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    <a class="code" href="classERF.html#a051364b2373d8d86151c0b4a958035bd">m_most</a>-&gt;update_fluxes(lev,Theta_prim,U_new,V_new,W_new);</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a922892a05ee0c5bccd210a3e5a8599e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a922892a05ee0c5bccd210a3e5a8599e1">&#9670;&nbsp;</a></span>sum_integrated_quantities()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::sum_integrated_quantities </td>
          <td>(</td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;{</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;    BL_PROFILE(<span class="stringliteral">&quot;ERF::sum_integrated_quantities()&quot;</span>);</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160; </div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a43d0b17f6e155691a1e9474526df3af5">verbose</a> &lt;= 0)</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    <span class="keywordtype">int</span> datwidth = 14;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <span class="keywordtype">int</span> datprecision = 6;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160; </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    amrex::Real <a class="code" href="DataStruct_8H.html#a07130f00a795700d6b2b83f773b807b4aa27a6549ade38cc036f7b8c58a840510">scalar</a> = 0.0;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    amrex::Real mass   = 0.0;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; lev++) {</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;        mass   += <a class="code" href="classERF.html#a2cdc63885e5fec54f89cdcaffcbdc188">volWgtSumMF</a>(lev,<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],<a class="code" href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>,<span class="keyword">true</span>,<span class="keyword">true</span>);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;        <a class="code" href="DataStruct_8H.html#a07130f00a795700d6b2b83f773b807b4aa27a6549ade38cc036f7b8c58a840510">scalar</a> += <a class="code" href="classERF.html#a2cdc63885e5fec54f89cdcaffcbdc188">volWgtSumMF</a>(lev,<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],<a class="code" href="IndexDefines_8H.html#a0296f21cd48e5d8236c62ae4ce319b2f">RhoScalar_comp</a>,<span class="keyword">true</span>,<span class="keyword">true</span>);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    }</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a43d0b17f6e155691a1e9474526df3af5">verbose</a> &gt; 0) {</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> nfoo = 2;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        amrex::Real foo[nfoo] = {mass,<a class="code" href="DataStruct_8H.html#a07130f00a795700d6b2b83f773b807b4aa27a6549ade38cc036f7b8c58a840510">scalar</a>};</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#ifdef AMREX_LAZY</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        Lazy::QueueReduction([=]() <span class="keyword">mutable</span> {</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        amrex::ParallelDescriptor::ReduceRealSum(</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;            foo, nfoo, amrex::ParallelDescriptor::IOProcessorNumber());</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;          <span class="keywordflow">if</span> (amrex::ParallelDescriptor::IOProcessor()) {</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;            <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;            mass   = foo[i++];</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;            <a class="code" href="DataStruct_8H.html#a07130f00a795700d6b2b83f773b807b4aa27a6549ade38cc036f7b8c58a840510">scalar</a> = foo[i++];</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;            amrex::Print() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;            amrex::Print() &lt;&lt; <span class="stringliteral">&quot;TIME= &quot;</span> &lt;&lt; time &lt;&lt; <span class="stringliteral">&quot; MASS        = &quot;</span> &lt;&lt; mass   &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;            amrex::Print() &lt;&lt; <span class="stringliteral">&quot;TIME= &quot;</span> &lt;&lt; time &lt;&lt; <span class="stringliteral">&quot; SCALAR      = &quot;</span> &lt;&lt; <a class="code" href="DataStruct_8H.html#a07130f00a795700d6b2b83f773b807b4aa27a6549ade38cc036f7b8c58a840510">scalar</a> &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ac1238c1616826c66df1dfd9076e6a3da">NumDataLogs</a>() &gt; 0) {</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;                std::ostream&amp; data_log1 = <a class="code" href="classERF.html#aa2c3ee1910008b828b9da79ccdfe3871">DataLog</a>(0);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;                <span class="keywordflow">if</span> (data_log1.good()) {</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                    <span class="keywordflow">if</span> (time == 0.0) {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;                        data_log1 &lt;&lt; std::setw(datwidth) &lt;&lt; <span class="stringliteral">&quot;          time&quot;</span>;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;                        data_log1 &lt;&lt; std::setw(datwidth) &lt;&lt; <span class="stringliteral">&quot;          mass&quot;</span>;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;                        data_log1 &lt;&lt; std::setw(datwidth) &lt;&lt; <span class="stringliteral">&quot;        scalar&quot;</span>;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                        data_log1 &lt;&lt; std::endl;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                    }</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                  <span class="comment">// Write the quantities at this time</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                  data_log1 &lt;&lt; std::setw(datwidth) &lt;&lt; time;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                  data_log1 &lt;&lt; std::setw(datwidth) &lt;&lt; std::setprecision(datprecision)</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                            &lt;&lt; mass;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                  data_log1 &lt;&lt; std::setw(datwidth) &lt;&lt; std::setprecision(datprecision)</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                            &lt;&lt; <a class="code" href="DataStruct_8H.html#a07130f00a795700d6b2b83f773b807b4aa27a6549ade38cc036f7b8c58a840510">scalar</a>;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                  data_log1 &lt;&lt; std::endl;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;              }</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;            }</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;          }</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">#ifdef AMREX_LAZY</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        });</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    }</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aff397ccf7eb99c51d7c705a35e85ec5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff397ccf7eb99c51d7c705a35e85ec5f">&#9670;&nbsp;</a></span>timeStep()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::timeStep </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iteration</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;{</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a3937527f96c81674fa38dc34ed24f3f5">regrid_int</a> &gt; 0)  <span class="comment">// We may need to regrid</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    {</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;        <span class="comment">// help keep track of whether a level was already regridded</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;        <span class="comment">// from a coarser level call to regrid</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;        <span class="keyword">static</span> Vector&lt;int&gt; last_regrid_step(max_level+1, 0);</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160; </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;        <span class="comment">// regrid changes level &quot;lev+1&quot; so we don&#39;t regrid on max_level</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;        <span class="comment">// also make sure we don&#39;t regrid fine levels again if</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;        <span class="comment">// it was taken care of during a coarser regrid</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;        <span class="keywordflow">if</span> (lev &lt; max_level &amp;&amp; <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[lev] &gt; last_regrid_step[lev])</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;        {</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[lev] % <a class="code" href="classERF.html#a3937527f96c81674fa38dc34ed24f3f5">regrid_int</a> == 0)</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;            {</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;                <span class="comment">// regrid could add newly refine levels (if finest_level &lt; max_level)</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;                <span class="comment">// so we save the previous finest level index</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;                <span class="keywordtype">int</span> old_finest = finest_level;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;                regrid(lev, time);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;                <span class="comment">// mark that we have regridded this level already</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = lev; k &lt;= finest_level; ++k) {</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;                    last_regrid_step[k] = <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[k];</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;                }</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;                <span class="comment">// if there are newly created levels, set the time step</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = old_finest+1; k &lt;= finest_level; ++k) {</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;                    <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[k] = <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[k-1] / MaxRefRatio(k-1);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;                }</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;            }</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        }</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    }</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="comment">// Update what we call &quot;old&quot; and &quot;new&quot; time</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <a class="code" href="classERF.html#a7085d7d5fc94a0f84efc06957267d58e">t_old</a>[lev] = <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev];</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev] += <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[lev];</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordflow">if</span> (Verbose()) {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;[Level &quot;</span> &lt;&lt; lev &lt;&lt; <span class="stringliteral">&quot; step &quot;</span> &lt;&lt; <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[lev]+1 &lt;&lt; <span class="stringliteral">&quot;] &quot;</span>;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;ADVANCE from time = &quot;</span> &lt;&lt; <a class="code" href="classERF.html#a7085d7d5fc94a0f84efc06957267d58e">t_old</a>[lev] &lt;&lt; <span class="stringliteral">&quot; to &quot;</span> &lt;&lt; <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev]</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot; with dt = &quot;</span> &lt;&lt; <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[lev] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    }</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="comment">// Advance a single level for a single time step, updates flux registers</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <a class="code" href="classERF.html#a47413fe5588f7dd71a1d5087a9e804f9">Advance</a>(lev, time, <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[lev], iteration, <a class="code" href="classERF.html#aa3db2dd1b65310c66c4038650c22aaee">nsubsteps</a>[lev]);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    ++<a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[lev];</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keywordflow">if</span> (Verbose())</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    {</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;[Level &quot;</span> &lt;&lt; lev &lt;&lt; <span class="stringliteral">&quot; step &quot;</span> &lt;&lt; <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[lev] &lt;&lt; <span class="stringliteral">&quot;] &quot;</span>;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Advanced &quot;</span> &lt;&lt; CountCells(lev) &lt;&lt; <span class="stringliteral">&quot; cells&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    }</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keywordflow">if</span> (lev &lt; finest_level)</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <span class="comment">// recursive call for next-finer level</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt;= <a class="code" href="classERF.html#aa3db2dd1b65310c66c4038650c22aaee">nsubsteps</a>[lev+1]; ++i)</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        {</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;            <a class="code" href="classERF.html#aff397ccf7eb99c51d7c705a35e85ec5f">timeStep</a>(lev+1, time+(i-1)*<a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[lev+1], i);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        }</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <a class="code" href="classERF.html#a40ebca562ac79fcc9250e17e0f4a5b41">AverageDownTo</a>(lev); <span class="comment">// average lev+1 down to lev</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    }</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2cdc63885e5fec54f89cdcaffcbdc188"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2cdc63885e5fec54f89cdcaffcbdc188">&#9670;&nbsp;</a></span>volWgtSumMF()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real ERF::volWgtSumMF </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>mf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>comp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>local</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>finemask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;{</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    BL_PROFILE(<span class="stringliteral">&quot;ERF::volWgtSumMF()&quot;</span>);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    amrex::Real sum = 0.0;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    amrex::MultiFab tmp(grids[lev], dmap[lev], 1, 0);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    amrex::MultiFab::Copy(tmp, mf, comp, 0, 1, 0);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keywordflow">if</span> (lev &lt; finest_level &amp;&amp; finemask) {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="keyword">const</span> amrex::MultiFab&amp; mask = <a class="code" href="classERF.html#a419ba9adca32073e70aae4a8fe8cfcee">build_fine_mask</a>(lev+1);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        amrex::MultiFab::Multiply(tmp, mask, 0, 0, 1, 0);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    }</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    amrex::MultiFab volume(grids[lev], dmap[lev], 1, 0);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span>&amp; dx = geom[lev].CellSizeArray();</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> cell_vol = dx[0]*dx[1]*dx[2];</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    volume.setVal(cell_vol);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="preprocessor">#ifdef ERF_USE_TERRAIN</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    amrex::MultiFab::Multiply(volume, detJ_cc[lev], 0, 0, 1, 0);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    sum = amrex::MultiFab::Dot(tmp, 0, volume, 0, 1, 0, local);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordflow">if</span> (!local)</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      amrex::ParallelDescriptor::ReduceRealSum(sum);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordflow">return</span> sum;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae6afed5b3a72ca80ccf0d791b08516aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6afed5b3a72ca80ccf0d791b08516aa">&#9670;&nbsp;</a></span>writeBuildInfo()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::writeBuildInfo </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>os</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;{</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  std::string PrettyLine = std::string(78, <span class="charliteral">&#39;=&#39;</span>) + <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  std::string OtherLine = std::string(78, <span class="charliteral">&#39;-&#39;</span>) + <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  std::string SkipSpace = std::string(8, <span class="charliteral">&#39; &#39;</span>);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="comment">// build information</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  os &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot; ERF Build Information\n&quot;</span>;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  os &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;build date:    &quot;</span> &lt;&lt; amrex::buildInfoGetBuildDate() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;build machine: &quot;</span> &lt;&lt; amrex::buildInfoGetBuildMachine() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;build dir:     &quot;</span> &lt;&lt; amrex::buildInfoGetBuildDir() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;AMReX dir:     &quot;</span> &lt;&lt; amrex::buildInfoGetAMReXDir() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;COMP:          &quot;</span> &lt;&lt; amrex::buildInfoGetComp() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;COMP version:  &quot;</span> &lt;&lt; amrex::buildInfoGetCompVersion() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;C++ compiler:  &quot;</span> &lt;&lt; amrex::buildInfoGetCXXName() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;C++ flags:     &quot;</span> &lt;&lt; amrex::buildInfoGetCXXFlags() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;Link flags:    &quot;</span> &lt;&lt; amrex::buildInfoGetLinkFlags() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;Libraries:     &quot;</span> &lt;&lt; amrex::buildInfoGetLibraries() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 1; n &lt;= amrex::buildInfoGetNumModules(); n++) {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    os &lt;&lt; amrex::buildInfoGetModuleName(n) &lt;&lt; <span class="stringliteral">&quot;: &quot;</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;       &lt;&lt; amrex::buildInfoGetModuleVal(n) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  }</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* githash1 = amrex::buildInfoGetGitHash(1);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* githash2 = amrex::buildInfoGetGitHash(2);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keywordflow">if</span> (strlen(githash1) &gt; 0) {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;ERF       git hash: &quot;</span> &lt;&lt; githash1 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  }</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="keywordflow">if</span> (strlen(githash2) &gt; 0) {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;AMReX       git hash: &quot;</span> &lt;&lt; githash2 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  }</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* buildgithash = amrex::buildInfoGetBuildGitHash();</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* buildgitname = amrex::buildInfoGetBuildGitName();</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="keywordflow">if</span> (strlen(buildgithash) &gt; 0) {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    os &lt;&lt; buildgitname &lt;&lt; <span class="stringliteral">&quot; git hash: &quot;</span> &lt;&lt; buildgithash &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  }</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot; ERF Compile time variables: \n&quot;</span>;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot; ERF Defines: \n&quot;</span>;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  os &lt;&lt; std::setw(35) &lt;&lt; std::left &lt;&lt; <span class="stringliteral">&quot;_OPENMP &quot;</span> &lt;&lt; std::setw(6) &lt;&lt; <span class="stringliteral">&quot;ON&quot;</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;     &lt;&lt; std::endl;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  os &lt;&lt; std::setw(35) &lt;&lt; std::left &lt;&lt; <span class="stringliteral">&quot;_OPENMP &quot;</span> &lt;&lt; std::setw(6) &lt;&lt; <span class="stringliteral">&quot;OFF&quot;</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;     &lt;&lt; std::endl;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="preprocessor">#ifdef MPI_VERSION</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  os &lt;&lt; std::setw(35) &lt;&lt; std::left &lt;&lt; <span class="stringliteral">&quot;MPI_VERSION &quot;</span> &lt;&lt; std::setw(6)</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;     &lt;&lt; MPI_VERSION &lt;&lt; std::endl;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  os &lt;&lt; std::setw(35) &lt;&lt; std::left &lt;&lt; <span class="stringliteral">&quot;MPI_VERSION &quot;</span> &lt;&lt; std::setw(6)</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;     &lt;&lt; <span class="stringliteral">&quot;UNDEFINED&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="preprocessor">#ifdef MPI_SUBVERSION</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  os &lt;&lt; std::setw(35) &lt;&lt; std::left &lt;&lt; <span class="stringliteral">&quot;MPI_SUBVERSION &quot;</span> &lt;&lt; std::setw(6)</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;     &lt;&lt; MPI_SUBVERSION &lt;&lt; std::endl;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  os &lt;&lt; std::setw(35) &lt;&lt; std::left &lt;&lt; <span class="stringliteral">&quot;MPI_SUBVERSION &quot;</span> &lt;&lt; std::setw(6)</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;     &lt;&lt; <span class="stringliteral">&quot;UNDEFINED&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160; </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_ae6afed5b3a72ca80ccf0d791b08516aa_icgraph.png" border="0" usemap="#classERF_ae6afed5b3a72ca80ccf0d791b08516aa_icgraph" alt=""/></div>
<map name="classERF_ae6afed5b3a72ca80ccf0d791b08516aa_icgraph" id="classERF_ae6afed5b3a72ca80ccf0d791b08516aa_icgraph">
<area shape="rect" title=" " alt="" coords="108,5,253,32"/>
<area shape="rect" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,60,32"/>
</map>
</div>

</div>
</div>
<a id="ad101fd46096db2d6b21544bfede6551f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad101fd46096db2d6b21544bfede6551f">&#9670;&nbsp;</a></span>WriteCheckpointFile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::WriteCheckpointFile </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;{</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <span class="comment">// chk00010            write a checkpoint file with this root directory</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <span class="comment">// chk00010/Header     this contains information you need to save (e.g., finest_level, t_new, etc.) and also</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <span class="comment">//                     the BoxArrays at each level</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <span class="comment">// chk00010/Level_0/</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="comment">// chk00010/Level_1/</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <span class="comment">// etc.                these subdirectories will hold the MultiFab data at each level of refinement</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160; </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="comment">// checkpoint file name, e.g., chk00010</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="keyword">const</span> std::string&amp; checkpointname = amrex::Concatenate(<a class="code" href="classERF.html#ae701564fbe3da5bbd88587e5a08eca4e">check_file</a>,<a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[0],5);</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Writing checkpoint &quot;</span> &lt;&lt; checkpointname &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> nlevels = finest_level+1;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="comment">// ---- prebuild a hierarchy of directories</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="comment">// ---- dirName is built first.  if dirName exists, it is renamed.  then build</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="comment">// ---- dirName/subDirPrefix_0 .. dirName/subDirPrefix_nlevels-1</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="comment">// ---- if callBarrier is true, call ParallelDescriptor::Barrier()</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="comment">// ---- after all directories are built</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="comment">// ---- ParallelDescriptor::IOProcessor() creates the directories</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    amrex::PreBuildDirectorHierarchy(checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, nlevels, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="comment">// write Header file</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;   <span class="keywordflow">if</span> (ParallelDescriptor::IOProcessor()) {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;       std::string HeaderFileName(checkpointname + <span class="stringliteral">&quot;/Header&quot;</span>);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;       VisMF::IO_Buffer io_buffer(VisMF::IO_Buffer_Size);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;       std::ofstream HeaderFile;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;       HeaderFile.rdbuf()-&gt;pubsetbuf(io_buffer.dataPtr(), io_buffer.size());</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;       HeaderFile.open(HeaderFileName.c_str(), std::ofstream::out   |</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                                               std::ofstream::trunc |</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;                                               std::ofstream::binary);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;       <span class="keywordflow">if</span>( ! HeaderFile.good()) {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;           amrex::FileOpenFailed(HeaderFileName);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;       }</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;       HeaderFile.precision(17);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;       <span class="comment">// write out title line</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;       HeaderFile &lt;&lt; <span class="stringliteral">&quot;Checkpoint file for ERF\n&quot;</span>;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;       <span class="comment">// write out finest_level</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;       HeaderFile &lt;&lt; finest_level &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;       <span class="comment">// write the number of components</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;       <span class="comment">// for each variable we store</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;       <span class="comment">// conservative, cell-centered vars</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;       HeaderFile &lt;&lt; <a class="code" href="namespaceCons.html#ab92931555eff5e3d0d9eb62ae0225cc1a5934ebcc17d4dfd56ed8cf6221c9a5ed">Cons::NumVars</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;       <span class="comment">// x-velocity on faces</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;       HeaderFile &lt;&lt; 1 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;       <span class="comment">// y-velocity on faces</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;       HeaderFile &lt;&lt; 1 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;       <span class="comment">// z-velocity on faces</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;       HeaderFile &lt;&lt; 1 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;       <span class="comment">// write out array of istep</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>.size(); ++i) {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;           HeaderFile &lt;&lt; <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;       }</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;       HeaderFile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;       <span class="comment">// write out array of dt</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>.size(); ++i) {</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;           HeaderFile &lt;&lt; <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;       }</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;       HeaderFile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;       <span class="comment">// write out array of t_new</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>.size(); ++i) {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;           HeaderFile &lt;&lt; <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;       }</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;       HeaderFile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;       <span class="comment">// write the BoxArray at each level</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;           boxArray(lev).writeOn(HeaderFile);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;           HeaderFile &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;       }</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;   }</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;   <span class="comment">// write the MultiFab data to, e.g., chk00010/Level_0/</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;   <span class="comment">// Here we make copies of the MultiFab with no ghost cells</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev)</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;   {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;       MultiFab <a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">cons</a>(grids[lev],dmap[lev],<a class="code" href="namespaceCons.html#ab92931555eff5e3d0d9eb62ae0225cc1a5934ebcc17d4dfd56ed8cf6221c9a5ed">Cons::NumVars</a>,0);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;       MultiFab::Copy(<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">cons</a>,<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],0,0,<a class="code" href="IndexDefines_8H.html#ad5195ac8f863f5a9a7eaa0db094f7639">NVAR</a>,0);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;       VisMF::Write(<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">cons</a>, amrex::MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;Cell&quot;</span>));</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;       MultiFab <a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca2a10a6e726515894b07621908abd4c0c">xvel</a>(convert(grids[lev],IntVect(1,0,0)),dmap[lev],1,0);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;       MultiFab::Copy(<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca2a10a6e726515894b07621908abd4c0c">xvel</a>,<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],0,0,1,0);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;       VisMF::Write(<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca2a10a6e726515894b07621908abd4c0c">xvel</a>, amrex::MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;XFace&quot;</span>));</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;       MultiFab <a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca81793b83204cfa56d4683bc676fbbfb6">yvel</a>(convert(grids[lev],IntVect(0,1,0)),dmap[lev],1,0);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;       MultiFab::Copy(<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca81793b83204cfa56d4683bc676fbbfb6">yvel</a>,<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],0,0,1,0);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;       VisMF::Write(<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca81793b83204cfa56d4683bc676fbbfb6">yvel</a>, amrex::MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;YFace&quot;</span>));</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;       MultiFab <a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca48ee63b17bc216e9661511c33c68bd8b">zvel</a>(convert(grids[lev],IntVect(0,0,1)),dmap[lev],1,0);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;       MultiFab::Copy(<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca48ee63b17bc216e9661511c33c68bd8b">zvel</a>,<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>],0,0,1,0);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;       VisMF::Write(<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca48ee63b17bc216e9661511c33c68bd8b">zvel</a>, amrex::MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;ZFace&quot;</span>));</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="preprocessor">#ifdef ERF_USE_TERRAIN</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;       <span class="comment">// Note that we write the ghost cells of z_phys_nd (unlike above)</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;       MultiFab z_height(convert(grids[lev],IntVect(1,1,1)),dmap[lev],1,1);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;       MultiFab::Copy(z_height,z_phys_nd[lev],0,0,1,1);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;       VisMF::Write(z_height, amrex::MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;Z_Phys_nd&quot;</span>));</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;   }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa2d8099655a8779836e63e3e98ea4372"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2d8099655a8779836e63e3e98ea4372">&#9670;&nbsp;</a></span>writeJobInfo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::writeJobInfo </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>dir</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;{</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;  <span class="comment">// job_info file with details about the run</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;  std::ofstream jobInfoFile;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;  std::string FullPathJobInfoFile = dir;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;  FullPathJobInfoFile += <span class="stringliteral">&quot;/job_info&quot;</span>;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;  jobInfoFile.open(FullPathJobInfoFile.c_str(), std::ios::out);</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;  std::string PrettyLine = <span class="stringliteral">&quot;===================================================&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;                           <span class="stringliteral">&quot;============================\n&quot;</span>;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  std::string OtherLine = <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;                          <span class="stringliteral">&quot;----------------------------\n&quot;</span>;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  std::string SkipSpace = <span class="stringliteral">&quot;        &quot;</span>;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <span class="comment">// job information</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot; ERF Job Information\n&quot;</span>;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;inputs file: &quot;</span> &lt;&lt; <a class="code" href="writeJobInfo_8cpp.html#aabaa127a3a319c1b86090d6c88568965">inputs_name</a> &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;number of MPI processes: &quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;              &lt;&lt; amrex::ParallelDescriptor::NProcs() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;number of threads:       &quot;</span> &lt;&lt; omp_get_max_threads() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;CPU time used since start of simulation (CPU-hours): &quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;              &lt;&lt; <a class="code" href="classERF.html#a5cafd68de724845533efea8d284aacb4">getCPUTime</a>() / 3600.0;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="comment">// plotfile information</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot; Plotfile Information\n&quot;</span>;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  time_t now = time(0);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="comment">// Convert now to tm struct for local timezone</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  tm* localtm = localtime(&amp;now);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;output data / time: &quot;</span> &lt;&lt; asctime(localtm);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  std::string currentDir = amrex::FileSystem::CurrentPath();</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;output dir:         &quot;</span> &lt;&lt; currentDir &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="comment">// build information</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot; Build Information\n&quot;</span>;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;build date:    &quot;</span> &lt;&lt; amrex::buildInfoGetBuildDate() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;build machine: &quot;</span> &lt;&lt; amrex::buildInfoGetBuildMachine() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;build dir:     &quot;</span> &lt;&lt; amrex::buildInfoGetBuildDir() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;AMReX dir:     &quot;</span> &lt;&lt; amrex::buildInfoGetAMReXDir() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;COMP:          &quot;</span> &lt;&lt; amrex::buildInfoGetComp() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;COMP version:  &quot;</span> &lt;&lt; amrex::buildInfoGetCompVersion() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 1; n &lt;= amrex::buildInfoGetNumModules(); n++) {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    jobInfoFile &lt;&lt; amrex::buildInfoGetModuleName(n) &lt;&lt; <span class="stringliteral">&quot;: &quot;</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                &lt;&lt; amrex::buildInfoGetModuleVal(n) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* githash1 = amrex::buildInfoGetGitHash(1);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* githash2 = amrex::buildInfoGetGitHash(2);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="keywordflow">if</span> (strlen(githash1) &gt; 0) {</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;ERF       git hash: &quot;</span> &lt;&lt; githash1 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  }</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordflow">if</span> (strlen(githash2) &gt; 0) {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;AMReX       git hash: &quot;</span> &lt;&lt; githash2 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  }</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* buildgithash = amrex::buildInfoGetBuildGitHash();</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* buildgitname = amrex::buildInfoGetBuildGitName();</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keywordflow">if</span> (strlen(buildgithash) &gt; 0) {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    jobInfoFile &lt;&lt; buildgitname &lt;&lt; <span class="stringliteral">&quot; git hash: &quot;</span> &lt;&lt; buildgithash &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="comment">// grid information</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot; Grid Information\n&quot;</span>;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="keywordtype">int</span> f_lev = finest_level;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= f_lev; i++) {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot; level: &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;   number of boxes = &quot;</span> &lt;&lt; grids[i].size() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;   maximum zones   = &quot;</span>;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; AMREX_SPACEDIM; n++) {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      jobInfoFile &lt;&lt; geom[i].Domain().length(n) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    }</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  }</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot; Boundary conditions\n&quot;</span>;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;   -x: &quot;</span> &lt;&lt; <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[0] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;   +x: &quot;</span> &lt;&lt; <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[3] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;   -y: &quot;</span> &lt;&lt; <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[1] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;   +y: &quot;</span> &lt;&lt; <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[4] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;   -z: &quot;</span> &lt;&lt; <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[2] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;   +z: &quot;</span> &lt;&lt; <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[5] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="comment">// runtime parameters</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  jobInfoFile &lt;&lt; <span class="stringliteral">&quot; Inputs File Parameters\n&quot;</span>;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  amrex::ParmParse::dumpTable(jobInfoFile, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  jobInfoFile.close();</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_aa2d8099655a8779836e63e3e98ea4372_cgraph.png" border="0" usemap="#classERF_aa2d8099655a8779836e63e3e98ea4372_cgraph" alt=""/></div>
<map name="classERF_aa2d8099655a8779836e63e3e98ea4372_cgraph" id="classERF_aa2d8099655a8779836e63e3e98ea4372_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,137,32"/>
<area shape="rect" href="classERF.html#a5cafd68de724845533efea8d284aacb4" title=" " alt="" coords="185,5,320,32"/>
</map>
</div>

</div>
</div>
<a id="abed910c4bcc14524b3c1a7d353d40de5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abed910c4bcc14524b3c1a7d353d40de5">&#9670;&nbsp;</a></span>WritePlotFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::WritePlotFile </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;{</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keyword">const</span> Vector&lt;std::string&gt; varnames = <a class="code" href="classERF.html#a7e2f504a37e9b721618d135030c7ae04">PlotFileVarNames</a>();</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> ncomp_mf = varnames.size();</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="comment">// We fillpatch here because some of the derived quantities require derivatives</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="comment">//     which require ghost cells to be filled</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <a class="code" href="classERF.html#a3d8f63f2178b1cb5ba78a433ece34e1c">FillPatch</a>(lev, <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev]);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordflow">if</span> (ncomp_mf == 0)</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    Vector&lt;MultiFab&gt; mf(finest_level+1);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        mf[lev].define(grids[lev], dmap[lev], ncomp_mf, 0);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    }</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="preprocessor">#ifdef ERF_USE_TERRAIN</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    Vector&lt;MultiFab&gt; mf_nd(finest_level+1);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        BoxArray nodal_grids(grids[lev]); nodal_grids.surroundingNodes();</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        mf_nd[lev].define(nodal_grids, dmap[lev], ncomp_mf, 0);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        mf_nd[lev].setVal(0.);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    }</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="keywordtype">int</span> mf_comp = 0;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="comment">// First, copy any of the conserved state variables into the output plotfile</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        AMREX_ALWAYS_ASSERT(<a class="code" href="classERF.html#afd8cd5a477754776135befa668fdd0c9">cons_names</a>.size() == <a class="code" href="namespaceCons.html#ab92931555eff5e3d0d9eb62ae0225cc1a5934ebcc17d4dfd56ed8cf6221c9a5ed">Cons::NumVars</a>);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="namespaceCons.html#ab92931555eff5e3d0d9eb62ae0225cc1a5934ebcc17d4dfd56ed8cf6221c9a5ed">Cons::NumVars</a>; ++i) {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="ERF_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(<a class="code" href="classERF.html#a5239b3dae0bf9ba78876bf2e8d497016">plot_state_names</a>, <a class="code" href="classERF.html#afd8cd5a477754776135befa668fdd0c9">cons_names</a>[i])) {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                MultiFab::Copy(mf[lev],<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],i,mf_comp,1,0);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                mf_comp++;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            }</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        }</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        <span class="comment">// Next, check for velocities and if desired, output them</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(<a class="code" href="classERF.html#a5239b3dae0bf9ba78876bf2e8d497016">plot_state_names</a>, <span class="stringliteral">&quot;x_velocity&quot;</span>) ||</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            <a class="code" href="ERF_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(<a class="code" href="classERF.html#a5239b3dae0bf9ba78876bf2e8d497016">plot_state_names</a>, <span class="stringliteral">&quot;y_velocity&quot;</span>) ||</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            <a class="code" href="ERF_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(<a class="code" href="classERF.html#a5239b3dae0bf9ba78876bf2e8d497016">plot_state_names</a>, <span class="stringliteral">&quot;z_velocity&quot;</span>)) {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            average_face_to_cellcenter(mf[lev],mf_comp,</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                Array&lt;const MultiFab*,3&gt;{&amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],&amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],&amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>]});</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            mf_comp += AMREX_SPACEDIM;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        }</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <span class="comment">// Finally, check for any derived quantities and compute them, inserting</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="comment">// them into our output multifab</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <span class="keyword">auto</span> calculate_derived = [&amp;](std::string der_name,</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                                     decltype(<a class="code" href="namespacederived.html#af8efb799157f5dbb8fe00416458db9e1">derived::erf_dernull</a>)&amp; der_function)</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        {</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="ERF_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(<a class="code" href="classERF.html#a123e428e6385285dfb646bc6f85ce654">plot_deriv_names</a>, der_name)) {</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                MultiFab dmf(mf[lev], make_alias, mf_comp, 1);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                <span class="keywordflow">for</span> (MFIter mfi(dmf, TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                {</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                    <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                    <span class="keyword">auto</span>&amp; dfab = dmf[mfi];</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                    <span class="keyword">auto</span>&amp; sfab = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>][mfi];</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                    der_function(bx, dfab, 0, 1, sfab, Geom(lev), <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0], <span class="keyword">nullptr</span>, lev);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                }</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                mf_comp++;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            }</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        };</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <span class="comment">// Note: All derived variables must be computed in order of &quot;derived_names&quot; defined in ERF.H</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        calculate_derived(<span class="stringliteral">&quot;pressure&quot;</span>,    <a class="code" href="namespacederived.html#ab144cda2ef3e2bd18cbd0837ce723521">derived::erf_derpres</a>);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        calculate_derived(<span class="stringliteral">&quot;soundspeed&quot;</span>,  <a class="code" href="namespacederived.html#ae13ef28ab10c6102bf43c9a7fbe99f35">derived::erf_dersoundspeed</a>);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        calculate_derived(<span class="stringliteral">&quot;temp&quot;</span>,        <a class="code" href="namespacederived.html#ab3c82aef26b750dfedc3d29ca9fae7e3">derived::erf_dertemp</a>);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        calculate_derived(<span class="stringliteral">&quot;theta&quot;</span>,       <a class="code" href="namespacederived.html#ab8895d9d9775ea0b8f643483a5a4127e">derived::erf_dertheta</a>);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        calculate_derived(<span class="stringliteral">&quot;KE&quot;</span>,          <a class="code" href="namespacederived.html#aa1fcac44ae779cdfa2fd5266bc206e2d">derived::erf_derKE</a>);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        calculate_derived(<span class="stringliteral">&quot;QKE&quot;</span>,         <a class="code" href="namespacederived.html#aa850437283651e137b82322c0437d487">derived::erf_derQKE</a>);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        calculate_derived(<span class="stringliteral">&quot;scalar&quot;</span>,      <a class="code" href="namespacederived.html#a2d9c0cabf04515367f2b721320dcddab">derived::erf_derscalar</a>);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(<a class="code" href="classERF.html#a123e428e6385285dfb646bc6f85ce654">plot_deriv_names</a>, <span class="stringliteral">&quot;pres_hse&quot;</span>))</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="preprocessor">#ifdef ERF_USE_TERRAIN</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            MultiFab::Copy(mf[lev],pres_hse[lev],0,mf_comp,1,0);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            <span class="keyword">auto</span> d_pres_hse_lev = <a class="code" href="classERF.html#a7990255d32f7bca694acab7521101b93">d_pres_hse</a>[lev].dataPtr();</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            <span class="keywordflow">for</span> ( MFIter mfi(mf[lev],TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                <span class="keyword">const</span> Array4&lt;Real&gt;&amp; derdat = mf[lev].array(mfi);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                ParallelFor(bx, [=, <a class="code" href="classERF.html#a87dc6c0720462bfd088c909289cdca0b">ng_pres_hse</a>=<a class="code" href="classERF.html#a87dc6c0720462bfd088c909289cdca0b">ng_pres_hse</a>] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                    derdat(i, j, k, mf_comp) = d_pres_hse_lev[k+<a class="code" href="classERF.html#a87dc6c0720462bfd088c909289cdca0b">ng_pres_hse</a>];</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                });</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            mf_comp += 1;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        }</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(<a class="code" href="classERF.html#a123e428e6385285dfb646bc6f85ce654">plot_deriv_names</a>, <span class="stringliteral">&quot;dens_hse&quot;</span>))</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        {</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="preprocessor">#ifdef ERF_USE_TERRAIN</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            MultiFab::Copy(mf[lev],dens_hse[lev],0,mf_comp,1,0);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            <span class="keyword">auto</span> d_dens_hse_lev = <a class="code" href="classERF.html#a3407564246f176655d0dc97733997e52">d_dens_hse</a>[lev].dataPtr();</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            <span class="keywordflow">for</span> ( MFIter mfi(mf[lev],TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            { <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                <span class="keyword">const</span> Array4&lt;Real&gt;&amp; derdat = mf[lev].array(mfi);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                ParallelFor(bx, [=, <a class="code" href="classERF.html#addf0fb2aae0efaa649c69685a4dcca83">ng_dens_hse</a>=<a class="code" href="classERF.html#addf0fb2aae0efaa649c69685a4dcca83">ng_dens_hse</a>] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                    derdat(i, j, k, mf_comp) = d_dens_hse_lev[k+<a class="code" href="classERF.html#addf0fb2aae0efaa649c69685a4dcca83">ng_dens_hse</a>];</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                });</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;            }</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            mf_comp ++;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        }</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160; </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(<a class="code" href="classERF.html#a123e428e6385285dfb646bc6f85ce654">plot_deriv_names</a>, <span class="stringliteral">&quot;pert_pres&quot;</span>))</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        {</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="preprocessor">#ifndef ERF_USE_TERRAIN</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            <span class="keyword">auto</span> d_pres_hse_lev = <a class="code" href="classERF.html#a7990255d32f7bca694acab7521101b93">d_pres_hse</a>[lev].dataPtr();</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            <span class="keywordflow">for</span> ( MFIter mfi(mf[lev],TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                <span class="keyword">const</span> Array4&lt;Real&gt;&amp; derdat = mf[lev].array(mfi);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="preprocessor">#ifdef ERF_USE_TERRAIN</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; p0_arr = pres_hse[lev].const_array(mfi);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; S_arr = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].const_array(mfi);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                ParallelFor(bx, [=, <a class="code" href="classERF.html#a87dc6c0720462bfd088c909289cdca0b">ng_pres_hse</a>=<a class="code" href="classERF.html#a87dc6c0720462bfd088c909289cdca0b">ng_pres_hse</a>] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                    <span class="keyword">const</span> <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> rhotheta = S_arr(i,j,k,<a class="code" href="IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="preprocessor">#ifdef ERF_USE_TERRAIN</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                    derdat(i, j, k, mf_comp) = <a class="code" href="EOS_8H.html#a292ce90ab26c75f4a444808a807b532b">getPgivenRTh</a>(rhotheta) - p0_arr(i,j,k);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                    derdat(i, j, k, mf_comp) = <a class="code" href="EOS_8H.html#a292ce90ab26c75f4a444808a807b532b">getPgivenRTh</a>(rhotheta) - d_pres_hse_lev[k+<a class="code" href="classERF.html#a87dc6c0720462bfd088c909289cdca0b">ng_pres_hse</a>];</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                });</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            }</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            mf_comp ++;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        }</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(<a class="code" href="classERF.html#a123e428e6385285dfb646bc6f85ce654">plot_deriv_names</a>, <span class="stringliteral">&quot;pert_dens&quot;</span>))</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        {</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="preprocessor">#ifndef ERF_USE_TERRAIN</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            <span class="keyword">auto</span> d_dens_hse_lev = <a class="code" href="classERF.html#a3407564246f176655d0dc97733997e52">d_dens_hse</a>[lev].dataPtr();</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;            <span class="keywordflow">for</span> ( MFIter mfi(mf[lev],TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            {</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                <span class="keyword">const</span> Array4&lt;Real&gt;&amp; derdat  = mf[lev].array(mfi);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; S_arr = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].const_array(mfi);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="preprocessor">#ifdef ERF_USE_TERRAIN</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; r0_arr = dens_hse[lev].const_array(mfi);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                ParallelFor(bx, [=, <a class="code" href="classERF.html#addf0fb2aae0efaa649c69685a4dcca83">ng_dens_hse</a>=<a class="code" href="classERF.html#addf0fb2aae0efaa649c69685a4dcca83">ng_dens_hse</a>] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept {</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="preprocessor">#ifdef ERF_USE_TERRAIN</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                    derdat(i, j, k, mf_comp) = S_arr(i,j,k,<a class="code" href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>) - r0_arr(i,j,k);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                    derdat(i, j, k, mf_comp) = S_arr(i,j,k,<a class="code" href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>) - d_dens_hse_lev[k+<a class="code" href="classERF.html#addf0fb2aae0efaa649c69685a4dcca83">ng_dens_hse</a>];</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                });</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;            mf_comp ++;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        }</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <span class="keywordtype">int</span> klo = geom[lev].Domain().smallEnd(2);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <span class="keywordtype">int</span> khi = geom[lev].Domain().bigEnd(2);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160; </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(<a class="code" href="classERF.html#a123e428e6385285dfb646bc6f85ce654">plot_deriv_names</a>, <span class="stringliteral">&quot;dpdx&quot;</span>))</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        {</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            <span class="keyword">auto</span> dxInv = geom[lev].InvCellSizeArray();</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            MultiFab pres(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].boxArray(), <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].DistributionMap(), 1, 1);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            <span class="keywordflow">for</span> ( MFIter mfi(mf[lev],TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            {</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                <span class="comment">// First define pressure on grown box</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                <span class="keyword">const</span> Box&amp; gbx = mfi.growntilebox(1);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                <span class="keyword">const</span> Array4&lt;Real&gt; &amp; p_arr  = pres.array(mfi);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; S_arr = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].const_array(mfi);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                amrex::ParallelFor(gbx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept {</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                    p_arr(i,j,k) = <a class="code" href="EOS_8H.html#a292ce90ab26c75f4a444808a807b532b">getPgivenRTh</a>(S_arr(i,j,k,<a class="code" href="IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>));</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                });</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            }</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            pres.FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            <span class="keywordflow">for</span> ( MFIter mfi(mf[lev],TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            {</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                <span class="comment">// Now compute pressure gradient on valid box</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                <span class="keyword">const</span> Array4&lt;Real&gt;&amp; derdat = mf[lev].array(mfi);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                <span class="keyword">const</span> Array4&lt;Real&gt; &amp; p_arr  = pres.array(mfi);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="preprocessor">#ifdef ERF_USE_TERRAIN</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; z_nd  = z_phys_nd[lev].const_array(mfi);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept {</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="preprocessor">#ifdef ERF_USE_TERRAIN</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                    <span class="comment">// Pgrad at lower I face</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> met_h_xi_lo,met_h_eta_lo,met_h_zeta_lo;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                    <a class="code" href="TerrainMetrics_8H.html#aa583c7ebfef25f449af86111b0572533">ComputeMetricAtIface</a>(i,j,k,met_h_xi_lo,met_h_eta_lo,met_h_zeta_lo,dxInv,z_nd,TerrainMet::h_xi_zeta);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> gp_xi_lo = dxInv[0] * (p_arr(i,j,k) - p_arr(i-1,j,k));</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> gp_zeta_on_iface_lo;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                    <span class="keywordflow">if</span>(k == klo) {</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                      gp_zeta_on_iface_lo = 0.5 * dxInv[2] * (</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                                                              p_arr(i-1,j,k+1) + p_arr(i,j,k+1)</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                                                            - p_arr(i-1,j,k  ) - p_arr(i,j,k  ) );</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k == khi) {</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                      gp_zeta_on_iface_lo = 0.5 * dxInv[2] * (</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                                                              p_arr(i-1,j,k  ) + p_arr(i,j,k  )</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                                                            - p_arr(i-1,j,k-1) - p_arr(i,j,k-1) );</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                      gp_zeta_on_iface_lo = 0.25 * dxInv[2] * (</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                                                               p_arr(i-1,j,k+1) + p_arr(i,j,k+1)</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                                                             - p_arr(i-1,j,k-1) - p_arr(i,j,k-1) );</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                    }</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                    amrex::Real gpx_lo = gp_xi_lo - (met_h_xi_lo/ met_h_zeta_lo) * gp_zeta_on_iface_lo;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160; </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                    <span class="comment">// Pgrad at higher I face</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> met_h_xi_hi,met_h_eta_hi,met_h_zeta_hi;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                    <a class="code" href="TerrainMetrics_8H.html#aa583c7ebfef25f449af86111b0572533">ComputeMetricAtIface</a>(i+1,j,k,met_h_xi_hi,met_h_eta_hi,met_h_zeta_hi,dxInv,z_nd,TerrainMet::h_xi_zeta);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> gp_xi_hi = dxInv[0] * (p_arr(i+1,j,k) - p_arr(i,j,k));</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> gp_zeta_on_iface_hi;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                    <span class="keywordflow">if</span>(k == klo) {</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                      gp_zeta_on_iface_hi = 0.5 * dxInv[2] * (</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                                                              p_arr(i+1,j,k+1) + p_arr(i,j,k+1)</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                                                            - p_arr(i+1,j,k  ) - p_arr(i,j,k  ) );</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k == khi) {</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                      gp_zeta_on_iface_hi = 0.5 * dxInv[2] * (</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                                                              p_arr(i+1,j,k  ) + p_arr(i,j,k  )</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                                                            - p_arr(i+1,j,k-1) - p_arr(i,j,k-1) );</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                      gp_zeta_on_iface_hi = 0.25 * dxInv[2] * (</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                                                               p_arr(i+1,j,k+1) + p_arr(i,j,k+1)</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                                                             - p_arr(i+1,j,k-1) - p_arr(i,j,k-1) );</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                    }</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                    amrex::Real gpx_hi = gp_xi_hi - (met_h_xi_hi/ met_h_zeta_hi) * gp_zeta_on_iface_hi;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160; </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                    <span class="comment">// Average P grad to CC</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                    derdat(i ,j ,k, mf_comp) = 0.5 * (gpx_lo + gpx_hi);</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                    derdat(i ,j ,k, mf_comp) = 0.5 * (p_arr(i+1,j,k) - p_arr(i-1,j,k)) * dxInv[0];</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                });</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;            }</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            mf_comp ++;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        }</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160; </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(<a class="code" href="classERF.html#a123e428e6385285dfb646bc6f85ce654">plot_deriv_names</a>, <span class="stringliteral">&quot;dpdy&quot;</span>))</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        {</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;            <span class="keyword">auto</span> dxInv = geom[lev].InvCellSizeArray();</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;            MultiFab pres(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].boxArray(), <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].DistributionMap(), 1, 1);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;            <span class="keywordflow">for</span> ( MFIter mfi(mf[lev],TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;            {</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                <span class="comment">// First define pressure on grown box</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                <span class="keyword">const</span> Box&amp; gbx = mfi.growntilebox(1);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                <span class="keyword">const</span> Array4&lt;Real&gt; &amp; p_arr  = pres.array(mfi);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; S_arr = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].const_array(mfi);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                amrex::ParallelFor(gbx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept {</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                    p_arr(i,j,k) = <a class="code" href="EOS_8H.html#a292ce90ab26c75f4a444808a807b532b">getPgivenRTh</a>(S_arr(i,j,k,<a class="code" href="IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>));</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                });</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;            }</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            pres.FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160; </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;            <span class="keywordflow">for</span> ( MFIter mfi(mf[lev],TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            {</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                <span class="comment">// Now compute pressure gradient on valid box</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                <span class="keyword">const</span> Array4&lt;Real&gt;&amp; derdat = mf[lev].array(mfi);</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                <span class="keyword">const</span> Array4&lt;Real&gt; &amp; p_arr  = pres.array(mfi);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="preprocessor">#ifdef ERF_USE_TERRAIN</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; z_nd  = z_phys_nd[lev].const_array(mfi);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept {</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="preprocessor">#ifdef ERF_USE_TERRAIN</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> met_h_xi_lo,met_h_eta_lo,met_h_zeta_lo;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                    <a class="code" href="TerrainMetrics_8H.html#adcaa7dd1b91191b54eb2f59a4cbb567b">ComputeMetricAtJface</a>(i,j,k,met_h_xi_lo,met_h_eta_lo,met_h_zeta_lo,dxInv,z_nd,TerrainMet::h_eta_zeta);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> gp_eta_lo = dxInv[1] * (p_arr(i,j,k) - p_arr(i,j-1,k));</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> gp_zeta_on_jface_lo;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                    <span class="keywordflow">if</span> (k == klo) {</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                      gp_zeta_on_jface_lo = 0.5 * dxInv[2] * (</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                                                              p_arr(i,j,k+1) + p_arr(i,j-1,k+1)</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                                                            - p_arr(i,j,k  ) - p_arr(i,j-1,k  ) );</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k == khi) {</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                      gp_zeta_on_jface_lo = 0.5 * dxInv[2] * (</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                                                              p_arr(i,j,k  ) + p_arr(i,j-1,k  )</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                                                            - p_arr(i,j,k-1) - p_arr(i,j-1,k-1) );</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                      gp_zeta_on_jface_lo = 0.25 * dxInv[2] * (</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                                                               p_arr(i,j,k+1) + p_arr(i,j-1,k+1)</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                                                             - p_arr(i,j,k-1) - p_arr(i,j-1,k-1) );</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                    }</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                    amrex::Real gpy_lo = gp_eta_lo - (met_h_eta_lo / met_h_zeta_lo) * gp_zeta_on_jface_lo;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160; </div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> met_h_xi_hi,met_h_eta_hi,met_h_zeta_hi;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                    <a class="code" href="TerrainMetrics_8H.html#adcaa7dd1b91191b54eb2f59a4cbb567b">ComputeMetricAtJface</a>(i,j+1,k,met_h_xi_hi,met_h_eta_hi,met_h_zeta_hi,dxInv,z_nd,TerrainMet::h_eta_zeta);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> gp_eta_hi = dxInv[1] * (p_arr(i,j+1,k) - p_arr(i,j,k));</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> gp_zeta_on_jface_hi;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                    <span class="keywordflow">if</span> (k == klo) {</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                      gp_zeta_on_jface_hi = 0.5 * dxInv[2] * (</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                                                              p_arr(i,j+1,k+1) + p_arr(i,j,k+1)</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                                                            - p_arr(i,j+1,k  ) - p_arr(i,j,k  ) );</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k == khi) {</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                      gp_zeta_on_jface_hi = 0.5 * dxInv[2] * (</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                                                              p_arr(i,j+1,k  ) + p_arr(i,j,k  )</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                                                            - p_arr(i,j+1,k-1) - p_arr(i,j,k-1) );</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                      gp_zeta_on_jface_hi = 0.25 * dxInv[2] * (</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                                                               p_arr(i,j+1,k+1) + p_arr(i,j,k+1)</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                                                             - p_arr(i,j+1,k-1) - p_arr(i,j,k-1) );</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                    }</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                    amrex::Real gpy_hi = gp_eta_hi - (met_h_eta_hi / met_h_zeta_hi) * gp_zeta_on_jface_hi;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160; </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                    derdat(i ,j ,k, mf_comp) = 0.5 * (gpy_lo + gpy_hi);</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                    derdat(i ,j ,k, mf_comp) = 0.5 * (p_arr(i,j+1,k) - p_arr(i,j-1,k)) * dxInv[1];</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                });</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;            }</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;            mf_comp ++;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        }</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160; </div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="preprocessor">#ifdef ERF_USE_TERRAIN</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160; </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(<a class="code" href="classERF.html#a123e428e6385285dfb646bc6f85ce654">plot_deriv_names</a>, <span class="stringliteral">&quot;pres_hse_x&quot;</span>))</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        {</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            <span class="keyword">auto</span> dxInv = geom[lev].InvCellSizeArray();</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            <span class="keywordflow">for</span> ( MFIter mfi(mf[lev],TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;            {</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                <span class="keyword">const</span> Array4&lt;Real      &gt;&amp;  derdat =       mf[lev].array(mfi);</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp;   p_arr = pres_hse[lev].const_array(mfi);</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; z_nd  = z_phys_nd[lev].const_array(mfi);</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept {</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> met_h_xi_lo,met_h_eta_lo,met_h_zeta_lo;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                    <a class="code" href="TerrainMetrics_8H.html#aa583c7ebfef25f449af86111b0572533">ComputeMetricAtIface</a>(i,j,k,met_h_xi_lo,met_h_eta_lo,met_h_zeta_lo,dxInv,z_nd,TerrainMet::h_xi_zeta);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> gp_xi_lo = dxInv[0] * (p_arr(i,j,k) - p_arr(i-1,j,k));</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> gp_zeta_on_iface_lo;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                    <span class="keywordflow">if</span> (k == klo) {</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                      gp_zeta_on_iface_lo = 0.5 * dxInv[2] * (</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                                                              p_arr(i-1,j,k+1) + p_arr(i,j,k+1)</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                                                            - p_arr(i-1,j,k  ) - p_arr(i,j,k  ) );</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k == khi) {</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                      gp_zeta_on_iface_lo = 0.5 * dxInv[2] * (</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                                                              p_arr(i-1,j,k  ) + p_arr(i,j,k  )</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                                                            - p_arr(i-1,j,k-1) - p_arr(i,j,k-1) );</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                      gp_zeta_on_iface_lo = 0.25 * dxInv[2] * (</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                                                               p_arr(i-1,j,k+1) + p_arr(i,j,k+1)</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                                                             - p_arr(i-1,j,k-1) - p_arr(i,j,k-1) );</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                    }</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                    amrex::Real gpx_lo = gp_xi_lo - (met_h_xi_lo/ met_h_zeta_lo) * gp_zeta_on_iface_lo;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160; </div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> met_h_xi_hi,met_h_eta_hi,met_h_zeta_hi;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                    <a class="code" href="TerrainMetrics_8H.html#aa583c7ebfef25f449af86111b0572533">ComputeMetricAtIface</a>(i+1,j,k,met_h_xi_hi,met_h_eta_hi,met_h_zeta_hi,dxInv,z_nd,TerrainMet::h_xi_zeta);</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> gp_xi_hi = dxInv[0] * (p_arr(i+1,j,k) - p_arr(i,j,k));</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> gp_zeta_on_iface_hi;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                    <span class="keywordflow">if</span> (k == klo) {</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                      gp_zeta_on_iface_hi = 0.5 * dxInv[2] * (</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                                                              p_arr(i+1,j,k+1) + p_arr(i,j,k+1)</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                                                            - p_arr(i+1,j,k  ) - p_arr(i,j,k  ) );</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k == khi) {</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                      gp_zeta_on_iface_hi = 0.5 * dxInv[2] * (</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                                                              p_arr(i+1,j,k  ) + p_arr(i,j,k  )</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                                                            - p_arr(i+1,j,k-1) - p_arr(i,j,k-1) );</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                      gp_zeta_on_iface_hi = 0.25 * dxInv[2] * (</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                                                               p_arr(i+1,j,k+1) + p_arr(i,j,k+1)</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                                                             - p_arr(i+1,j,k-1) - p_arr(i,j,k-1) );</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                    }</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                    amrex::Real gpx_hi = gp_xi_hi - (met_h_xi_hi/ met_h_zeta_hi) * gp_zeta_on_iface_hi;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160; </div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                    derdat(i ,j ,k, mf_comp) = 0.5 * (gpx_lo + gpx_hi);</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                });</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;            }</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;            mf_comp += 1;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        }</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160; </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(<a class="code" href="classERF.html#a123e428e6385285dfb646bc6f85ce654">plot_deriv_names</a>, <span class="stringliteral">&quot;pres_hse_y&quot;</span>))</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        {</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;            <span class="keyword">auto</span> dxInv = geom[lev].InvCellSizeArray();</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;            <span class="keywordflow">for</span> ( MFIter mfi(mf[lev],TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;            {</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                <span class="keyword">const</span> Array4&lt;Real      &gt;&amp; derdat = mf[lev].array(mfi);</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp;   p_arr = pres_hse[lev].const_array(mfi);</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; z_nd  = z_phys_nd[lev].const_array(mfi);</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept {</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> met_h_xi_lo,met_h_eta_lo,met_h_zeta_lo;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                    <a class="code" href="TerrainMetrics_8H.html#adcaa7dd1b91191b54eb2f59a4cbb567b">ComputeMetricAtJface</a>(i,j,k,met_h_xi_lo,met_h_eta_lo,met_h_zeta_lo,dxInv,z_nd,TerrainMet::h_eta_zeta);</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> gp_eta_lo = dxInv[1] * (p_arr(i,j,k) - p_arr(i,j-1,k));</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> gp_zeta_on_jface_lo;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                    <span class="keywordflow">if</span> (k == klo) {</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                      gp_zeta_on_jface_lo = 0.5 * dxInv[2] * (</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                                                              p_arr(i,j,k+1) + p_arr(i,j-1,k+1)</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                                                            - p_arr(i,j,k  ) - p_arr(i,j-1,k  ) );</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k == khi) {</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                      gp_zeta_on_jface_lo = 0.5 * dxInv[2] * (</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                                                              p_arr(i,j,k  ) + p_arr(i,j-1,k  )</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                                                            - p_arr(i,j,k-1) - p_arr(i,j-1,k-1) );</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                      gp_zeta_on_jface_lo = 0.25 * dxInv[2] * (</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                                                               p_arr(i,j,k+1) + p_arr(i,j-1,k+1)</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                                                             - p_arr(i,j,k-1) - p_arr(i,j-1,k-1) );</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                    }</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                    amrex::Real gpy_lo = gp_eta_lo - (met_h_eta_lo / met_h_zeta_lo) * gp_zeta_on_jface_lo;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160; </div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> met_h_xi_hi,met_h_eta_hi,met_h_zeta_hi;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                    <a class="code" href="TerrainMetrics_8H.html#adcaa7dd1b91191b54eb2f59a4cbb567b">ComputeMetricAtJface</a>(i,j+1,k,met_h_xi_hi,met_h_eta_hi,met_h_zeta_hi,dxInv,z_nd,TerrainMet::h_eta_zeta);</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> gp_eta_hi = dxInv[1] * (p_arr(i,j+1,k) - p_arr(i,j,k));</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                    <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> gp_zeta_on_jface_hi;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                    <span class="keywordflow">if</span> (k == klo) {</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                      gp_zeta_on_jface_hi = 0.5 * dxInv[2] * (</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                                                              p_arr(i,j+1,k+1) + p_arr(i,j,k+1)</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                                                            - p_arr(i,j+1,k  ) - p_arr(i,j,k  ) );</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k == khi) {</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                      gp_zeta_on_jface_hi = 0.5 * dxInv[2] * (</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                                                              p_arr(i,j+1,k  ) + p_arr(i,j,k  )</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                                                            - p_arr(i,j+1,k-1) - p_arr(i,j,k-1) );</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                      gp_zeta_on_jface_hi = 0.25 * dxInv[2] * (</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                                                               p_arr(i,j+1,k+1) + p_arr(i,j,k+1)</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                                                             - p_arr(i,j+1,k-1) - p_arr(i,j,k-1) );</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                    }</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                    amrex::Real gpy_hi = gp_eta_hi - (met_h_eta_hi / met_h_zeta_hi) * gp_zeta_on_jface_hi;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160; </div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                    derdat(i ,j ,k, mf_comp) = 0.5 * (gpy_lo + gpy_hi);</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                });</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;            }</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;            mf_comp += 1;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        }</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160; </div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(<a class="code" href="classERF.html#a123e428e6385285dfb646bc6f85ce654">plot_deriv_names</a>, <span class="stringliteral">&quot;z_phys&quot;</span>))</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        {</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;            MultiFab::Copy(mf[lev],z_phys_cc[lev],0,mf_comp,1,0);</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;            mf_comp ++;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        }</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ERF_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(<a class="code" href="classERF.html#a123e428e6385285dfb646bc6f85ce654">plot_deriv_names</a>, <span class="stringliteral">&quot;detJ&quot;</span>))</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        {</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;            MultiFab::Copy(mf[lev],detJ_cc[lev],0,mf_comp,1,0);</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;            mf_comp ++;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        }</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    }</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160; </div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <span class="keyword">const</span> std::string&amp; plotfilename = <a class="code" href="classERF.html#a54f6c5d799e51521ad10bb57d29d0c44">PlotFileName</a>(<a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[0]);</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Writing plotfile &quot;</span> &lt;&lt; plotfilename &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160; </div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <span class="keywordflow">if</span> (finest_level == 0)</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    {</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ae7b9991150042eb38e2abc89399c0c7c">plotfile_type</a> == <span class="stringliteral">&quot;amrex&quot;</span>) {</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="preprocessor">#ifdef ERF_USE_TERRAIN</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;            <span class="comment">// We started with mf_nd holding 0 in every component; here we fill only the offset in z</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;            <span class="keywordtype">int</span> lev = 0;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;            MultiFab::Copy(mf_nd[lev],z_phys_nd[lev],0,2,1,0);</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;            <a class="code" href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">Real</a> dz = Geom()[lev].CellSizeArray()[2];</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;            <span class="keywordflow">for</span> (MFIter mfi(mf_nd[lev], TilingIfNotGPU()); mfi.isValid(); ++mfi) {</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                Array4&lt;      Real&gt; mf_arr = mf_nd[lev].array(mfi);</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                ParallelFor(bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) {</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                    mf_arr(i,j,k,2) -= k * dz;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                });</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;            }</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;            WriteMultiLevelPlotfileWithTerrain(plotfilename, finest_level+1,</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                                               GetVecOfConstPtrs(mf),</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                                               GetVecOfConstPtrs(mf_nd),</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                                               varnames,</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                                               <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0], <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>);</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;            WriteMultiLevelPlotfile(plotfilename, finest_level+1,</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                                           GetVecOfConstPtrs(mf),</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                                           varnames,</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                                           Geom(), <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0], <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>, refRatio());</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;            <a class="code" href="classERF.html#aa2d8099655a8779836e63e3e98ea4372">writeJobInfo</a>(plotfilename);</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="preprocessor">#ifdef ERF_USE_NETCDF</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;             writeNCPlotFile(plotfilename, GetVecOfConstPtrs(mf), varnames, <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>, <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0]);</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        }</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160; </div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160; </div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        Vector&lt;IntVect&gt;   r2(finest_level);</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        Vector&lt;Geometry&gt;  g2(finest_level+1);</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        Vector&lt;MultiFab&gt; mf2(finest_level+1);</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160; </div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        mf2[0].define(grids[0], dmap[0], ncomp_mf, 0);</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160; </div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        <span class="comment">// Copy level 0 as is</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;        MultiFab::Copy(mf2[0],mf[0],0,0,mf[0].nComp(),0);</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160; </div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        <span class="comment">// Define a new multi-level array of Geometry&#39;s so that we pass the new &quot;domain&quot; at lev &gt; 0</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        Array&lt;int,AMREX_SPACEDIM&gt; periodicity =</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                     {Geom()[0].isPeriodic(0),Geom()[0].isPeriodic(1),Geom()[0].isPeriodic(2)};</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        g2[0].define(Geom()[0].Domain(),&amp;(Geom()[0].ProbDomain()),0,periodicity.data());</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160; </div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        r2[0] = IntVect(1,1,ref_ratio[0][0]);</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 1; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;            <span class="keywordflow">if</span> (lev &gt; 1) {</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                r2[lev-1][0] = 1;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                r2[lev-1][1] = 1;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                r2[lev-1][2] = r2[lev-2][2] * ref_ratio[lev-1][0];</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;            }</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160; </div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;            mf2[lev].define(refine(grids[lev],r2[lev-1]), dmap[lev], ncomp_mf, 0);</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160; </div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;            <span class="comment">// Set the new problem domain</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;            Box d2(Geom()[lev].Domain());</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;            d2.refine(r2[lev-1]);</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160; </div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;            g2[lev].define(d2,&amp;(Geom()[lev].ProbDomain()),0,periodicity.data());</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        }</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160; </div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        <span class="comment">// Do piecewise interpolation of mf into mf2</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 1; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;            <span class="keywordflow">for</span> (MFIter mfi(mf2[lev], TilingIfNotGPU()); mfi.isValid(); ++mfi) {</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                pcinterp_interp(bx,mf2[lev].array(mfi), 0, mf[lev].nComp(), mf[lev].const_array(mfi),0,r2[lev-1]);</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;            }</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        }</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160; </div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        <span class="comment">// Define an effective ref_ratio which is isotropic to be passed into WriteMultiLevelPlotfile</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        Vector&lt;IntVect&gt; rr(finest_level);</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt; finest_level; ++lev) {</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;            rr[lev] = IntVect(ref_ratio[lev][0],ref_ratio[lev][1],ref_ratio[lev][0]);</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        }</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160; </div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ae7b9991150042eb38e2abc89399c0c7c">plotfile_type</a> == <span class="stringliteral">&quot;amrex&quot;</span>) {</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;            WriteMultiLevelPlotfile(plotfilename, finest_level+1, GetVecOfConstPtrs(mf2), varnames,</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                                           g2, <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0], <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>, rr);</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;            <a class="code" href="classERF.html#aa2d8099655a8779836e63e3e98ea4372">writeJobInfo</a>(plotfilename);</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="preprocessor">#ifdef ERF_USE_NETCDF</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;             writeNCPlotFile(plotfilename, GetVecOfConstPtrs(mf2), varnames, <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>, <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0]);</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        }</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    } <span class="comment">// end multi-level</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_abed910c4bcc14524b3c1a7d353d40de5_cgraph.png" border="0" usemap="#classERF_abed910c4bcc14524b3c1a7d353d40de5_cgraph" alt=""/></div>
<map name="classERF_abed910c4bcc14524b3c1a7d353d40de5_cgraph" id="classERF_abed910c4bcc14524b3c1a7d353d40de5_cgraph">
<area shape="rect" title=" " alt="" coords="5,284,143,311"/>
<area shape="rect" href="TerrainMetrics_8H.html#aa583c7ebfef25f449af86111b0572533" title=" " alt="" coords="208,5,376,32"/>
<area shape="rect" href="TerrainMetrics_8H.html#adcaa7dd1b91191b54eb2f59a4cbb567b" title=" " alt="" coords="208,56,376,83"/>
<area shape="rect" href="ERF_8H.html#a1f8554e7b211b0acfc202e8a600e7d67" title=" " alt="" coords="211,107,373,133"/>
<area shape="rect" href="namespacederived.html#aa1fcac44ae779cdfa2fd5266bc206e2d" title=" " alt="" coords="221,157,363,184"/>
<area shape="rect" href="namespacederived.html#af8efb799157f5dbb8fe00416458db9e1" title=" " alt="" coords="217,208,367,235"/>
<area shape="rect" href="namespacederived.html#ab144cda2ef3e2bd18cbd0837ce723521" title=" " alt="" coords="215,411,369,437"/>
<area shape="rect" href="EOS_8H.html#a292ce90ab26c75f4a444808a807b532b" title=" " alt="" coords="479,461,590,488"/>
<area shape="rect" href="namespacederived.html#aa850437283651e137b82322c0437d487" title=" " alt="" coords="216,259,368,285"/>
<area shape="rect" href="namespacederived.html#a2d9c0cabf04515367f2b721320dcddab" title=" " alt="" coords="210,309,374,336"/>
<area shape="rect" href="namespacederived.html#ae13ef28ab10c6102bf43c9a7fbe99f35" title=" " alt="" coords="191,512,393,539"/>
<area shape="rect" href="namespacederived.html#ab3c82aef26b750dfedc3d29ca9fae7e3" title=" " alt="" coords="213,563,371,589"/>
<area shape="rect" href="namespacederived.html#ab8895d9d9775ea0b8f643483a5a4127e" title=" " alt="" coords="213,360,371,387"/>
<area shape="rect" href="namespacederived.html#a9935603239fe8510b11179da8e76c39c" title=" " alt="" coords="441,284,628,311"/>
<area shape="rect" href="EOS_8H.html#a652d566aef658cc423ced929a816f869" title=" " alt="" coords="463,563,607,589"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a4ac5b4b865dc8a029812bf1a20cd9b9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ac5b4b865dc8a029812bf1a20cd9b9b">&#9670;&nbsp;</a></span>bdy_data_xhi</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::FArrayBox&gt; ERF::bdy_data_xhi</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a35360b65d1afd233a6e6461938fa4522"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35360b65d1afd233a6e6461938fa4522">&#9670;&nbsp;</a></span>bdy_data_xlo</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::FArrayBox&gt; ERF::bdy_data_xlo</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aaa1c7e25ca002544fc80dcea620bda8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa1c7e25ca002544fc80dcea620bda8d">&#9670;&nbsp;</a></span>bdy_data_yhi</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::FArrayBox&gt; ERF::bdy_data_yhi</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a21e2e459ae54d580e40f0ffdbcdc68a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21e2e459ae54d580e40f0ffdbcdc68a4">&#9670;&nbsp;</a></span>bdy_data_ylo</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::FArrayBox&gt; ERF::bdy_data_ylo</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aab4575d8fb57595a2f1aaf088c60447a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab4575d8fb57595a2f1aaf088c60447a">&#9670;&nbsp;</a></span>bndry_output_planes_interval</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::bndry_output_planes_interval = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a479132ab37232f208597c7a27c132866"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a479132ab37232f208597c7a27c132866">&#9670;&nbsp;</a></span>bndry_output_planes_per</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real ERF::bndry_output_planes_per = -1.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ac2be0759e68086d0e9026c61492fa225"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2be0759e68086d0e9026c61492fa225">&#9670;&nbsp;</a></span>bndry_output_planes_start_time</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real ERF::bndry_output_planes_start_time = 0.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a050dbd236c9bf246554a53008e09f683"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a050dbd236c9bf246554a53008e09f683">&#9670;&nbsp;</a></span>boxes_at_level</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Vector&lt;amrex::Box&gt; &gt; ERF::boxes_at_level</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ae52fe861ffb051a11920238c8210d69f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae52fe861ffb051a11920238c8210d69f">&#9670;&nbsp;</a></span>cfl</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real ERF::cfl = 0.8</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ac793fe23b026c18bb7dcce791317c6c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac793fe23b026c18bb7dcce791317c6c3">&#9670;&nbsp;</a></span>change_max</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real ERF::change_max = 1.1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ae701564fbe3da5bbd88587e5a08eca4e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae701564fbe3da5bbd88587e5a08eca4e">&#9670;&nbsp;</a></span>check_file</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ERF::check_file {&quot;chk&quot;}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a1f48ec3caf326a6b1b986d061d36ee90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f48ec3caf326a6b1b986d061d36ee90">&#9670;&nbsp;</a></span>check_int</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::check_int = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a32e0d0f5ae0db18ee81f9d4325a14f64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a32e0d0f5ae0db18ee81f9d4325a14f64">&#9670;&nbsp;</a></span>check_type</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ERF::check_type {&quot;native&quot;}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a48bba6b1c1b39940b09aefbe56311e2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48bba6b1c1b39940b09aefbe56311e2f">&#9670;&nbsp;</a></span>column_file_name</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ERF::column_file_name = &quot;column_data.nc&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="afa0bef6d3146788302b81c0d4f4802d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa0bef6d3146788302b81c0d4f4802d1">&#9670;&nbsp;</a></span>column_interval</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::column_interval = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ab10bfe15c2d15fdd22201b64722a4022"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab10bfe15c2d15fdd22201b64722a4022">&#9670;&nbsp;</a></span>column_loc_x</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real ERF::column_loc_x = 0.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a30a1b51c733c3a20dc6948f9a3620bbb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30a1b51c733c3a20dc6948f9a3620bbb">&#9670;&nbsp;</a></span>column_loc_y</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real ERF::column_loc_y = 0.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a9fedd41de89817a23b1c3b3c6ef7443f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fedd41de89817a23b1c3b3c6ef7443f">&#9670;&nbsp;</a></span>column_per</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real ERF::column_per = -1.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="afd8cd5a477754776135befa668fdd0c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd8cd5a477754776135befa668fdd0c9">&#9670;&nbsp;</a></span>cons_names</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const amrex::Vector&lt;std::string&gt; ERF::cons_names</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">{ <span class="stringliteral">&quot;density&quot;</span>, <span class="stringliteral">&quot;rhotheta&quot;</span>, <span class="stringliteral">&quot;rhoKE&quot;</span>, <span class="stringliteral">&quot;rhoQKE&quot;</span>, <span class="stringliteral">&quot;rhoadv_0&quot;</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">                                                 }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4615db015b395b3a44f1fbf6d6e4fe43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4615db015b395b3a44f1fbf6d6e4fe43">&#9670;&nbsp;</a></span>coupling_type</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ERF::coupling_type = &quot;OneWay&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a3407564246f176655d0dc97733997e52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3407564246f176655d0dc97733997e52">&#9670;&nbsp;</a></span>d_dens_hse</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Gpu::DeviceVector&lt;amrex::Real&gt; &gt; ERF::d_dens_hse</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a84cf7616e7b3928f08f4bd56112db01e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84cf7616e7b3928f08f4bd56112db01e">&#9670;&nbsp;</a></span>d_havg_density</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Gpu::DeviceVector&lt;amrex::Real&gt; ERF::d_havg_density</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a9a4f076c56f31fbb5e68c09706605a05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a4f076c56f31fbb5e68c09706605a05">&#9670;&nbsp;</a></span>d_havg_pressure</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Gpu::DeviceVector&lt;amrex::Real&gt; ERF::d_havg_pressure</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a20350959b7b3e252ee3a802e7998ca8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20350959b7b3e252ee3a802e7998ca8d">&#9670;&nbsp;</a></span>d_havg_temperature</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Gpu::DeviceVector&lt;amrex::Real&gt; ERF::d_havg_temperature</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a7990255d32f7bca694acab7521101b93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7990255d32f7bca694acab7521101b93">&#9670;&nbsp;</a></span>d_pres_hse</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Gpu::DeviceVector&lt;amrex::Real&gt; &gt; ERF::d_pres_hse</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a91e9618892751232c4067c253f904a3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91e9618892751232c4067c253f904a3d">&#9670;&nbsp;</a></span>d_rayleigh_tau</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Gpu::DeviceVector&lt;amrex::Real&gt; &gt; ERF::d_rayleigh_tau</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a4c992f63bcc9d7e7693990bf046bfc4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c992f63bcc9d7e7693990bf046bfc4b">&#9670;&nbsp;</a></span>d_rayleigh_thetabar</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Gpu::DeviceVector&lt;amrex::Real&gt; &gt; ERF::d_rayleigh_thetabar</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="af33ee878e24ced10b3da319795723db0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af33ee878e24ced10b3da319795723db0">&#9670;&nbsp;</a></span>d_rayleigh_ubar</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Gpu::DeviceVector&lt;amrex::Real&gt; &gt; ERF::d_rayleigh_ubar</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a879501e88824fa6a00ffe1509059b21e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a879501e88824fa6a00ffe1509059b21e">&#9670;&nbsp;</a></span>d_rayleigh_vbar</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Gpu::DeviceVector&lt;amrex::Real&gt; &gt; ERF::d_rayleigh_vbar</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a1cade630b005dbcc0f644987ef3db287"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1cade630b005dbcc0f644987ef3db287">&#9670;&nbsp;</a></span>datalog</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;std::fstream&gt; &gt; ERF::datalog</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a9248a4eb025c2647e003f838cba52a21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9248a4eb025c2647e003f838cba52a21">&#9670;&nbsp;</a></span>datalogname</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::string&gt; ERF::datalogname</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a9fc0f6e6ca35036d2e3a36dd42e66435"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fc0f6e6ca35036d2e3a36dd42e66435">&#9670;&nbsp;</a></span>derived_names</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const amrex::Vector&lt;std::string&gt; ERF::derived_names</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">{<span class="stringliteral">&quot;pressure&quot;</span>, <span class="stringliteral">&quot;soundspeed&quot;</span>, <span class="stringliteral">&quot;temp&quot;</span>, <span class="stringliteral">&quot;theta&quot;</span>, <span class="stringliteral">&quot;KE&quot;</span>, <span class="stringliteral">&quot;QKE&quot;</span>, <span class="stringliteral">&quot;scalar&quot;</span>, <span class="stringliteral">&quot;pres_hse&quot;</span>,</div>
<div class="line">                                                    <span class="stringliteral">&quot;dens_hse&quot;</span>, <span class="stringliteral">&quot;pert_pres&quot;</span>, <span class="stringliteral">&quot;pert_dens&quot;</span>, <span class="stringliteral">&quot;dpdx&quot;</span>, <span class="stringliteral">&quot;dpdy&quot;</span>,</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">                                                   }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a778cdd6547e8cf1613cda8b4a8274bf0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a778cdd6547e8cf1613cda8b4a8274bf0">&#9670;&nbsp;</a></span>do_avg_down</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::do_avg_down = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="af25f70d7d9e4edeedcc40c117cc15505"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af25f70d7d9e4edeedcc40c117cc15505">&#9670;&nbsp;</a></span>do_reflux</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::do_reflux = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ae5968f1bed602fa87cdd5cb7905b7e5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5968f1bed602fa87cdd5cb7905b7e5e">&#9670;&nbsp;</a></span>domain_bc_type</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Array&lt;std::string,2*AMREX_SPACEDIM&gt; ERF::domain_bc_type</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classERF.html#aa2d8099655a8779836e63e3e98ea4372">writeJobInfo()</a>.</p>

</div>
</div>
<a id="a574521986a6e403159f83c8b8123ba90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a574521986a6e403159f83c8b8123ba90">&#9670;&nbsp;</a></span>domain_bcs_type</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::BCRec&gt; ERF::domain_bcs_type</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a8a99e22b1111c803e31b4afd5fcdea60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a99e22b1111c803e31b4afd5fcdea60">&#9670;&nbsp;</a></span>domain_bcs_type_d</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Gpu::DeviceVector&lt;amrex::BCRec&gt; ERF::domain_bcs_type_d</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ad34bae243fdb6c3029f5abe4fb4bca2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad34bae243fdb6c3029f5abe4fb4bca2d">&#9670;&nbsp;</a></span>dt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Real&gt; ERF::dt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a3cf7cb2e51eb7b69cb4079ffc6722459"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3cf7cb2e51eb7b69cb4079ffc6722459">&#9670;&nbsp;</a></span>dt_mri_ratio</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;long&gt; ERF::dt_mri_ratio</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a83c244120a15f0d9b9bca54e93976428"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83c244120a15f0d9b9bca54e93976428">&#9670;&nbsp;</a></span>fine_mask</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::MultiFab ERF::fine_mask</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a6e9d302b096a12999c8ff4a6bfa9a072"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e9d302b096a12999c8ff4a6bfa9a072">&#9670;&nbsp;</a></span>fixed_dt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real ERF::fixed_dt = -1.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aa30dffc28e24ac50c880539ca2e36ffd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa30dffc28e24ac50c880539ca2e36ffd">&#9670;&nbsp;</a></span>fixed_fast_dt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real ERF::fixed_fast_dt = -1.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ad2e1a979c0ad68e87eaee349beb7e9fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2e1a979c0ad68e87eaee349beb7e9fd">&#9670;&nbsp;</a></span>fixed_mri_dt_ratio</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::fixed_mri_dt_ratio = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a2ef8ab09aed437467e2e87a37bcd999d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ef8ab09aed437467e2e87a37bcd999d">&#9670;&nbsp;</a></span>flux_registers</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::FluxRegister*&gt; ERF::flux_registers</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a7e89a339e79b2b4f177a05e9f0df32fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e89a339e79b2b4f177a05e9f0df32fa">&#9670;&nbsp;</a></span>h_dens_hse</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Vector&lt;amrex::Real&gt; &gt; ERF::h_dens_hse</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a4dd7c603e65d230105a4f1e0afb4cf8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4dd7c603e65d230105a4f1e0afb4cf8a">&#9670;&nbsp;</a></span>h_havg_density</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Real&gt; ERF::h_havg_density</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a413293737b0021c97b50c62756561446"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a413293737b0021c97b50c62756561446">&#9670;&nbsp;</a></span>h_havg_pressure</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Real&gt; ERF::h_havg_pressure</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a9683c7b07c287e57856ee5a9c99917a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9683c7b07c287e57856ee5a9c99917a1">&#9670;&nbsp;</a></span>h_havg_temperature</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Real&gt; ERF::h_havg_temperature</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aff6f5d2bd989b5a0f7c28e2e10e27e8c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff6f5d2bd989b5a0f7c28e2e10e27e8c">&#9670;&nbsp;</a></span>h_pres_hse</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Vector&lt;amrex::Real&gt; &gt; ERF::h_pres_hse</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a1bc503c07e76f2a4791a76e6907e6dd7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1bc503c07e76f2a4791a76e6907e6dd7">&#9670;&nbsp;</a></span>h_rayleigh_tau</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Vector&lt;amrex::Real&gt; &gt; ERF::h_rayleigh_tau</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a0f074d984fb0a319cf7a781b2efc3d63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f074d984fb0a319cf7a781b2efc3d63">&#9670;&nbsp;</a></span>h_rayleigh_thetabar</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Vector&lt;amrex::Real&gt; &gt; ERF::h_rayleigh_thetabar</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ac4dc443840da3593fe66b8693803f006"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4dc443840da3593fe66b8693803f006">&#9670;&nbsp;</a></span>h_rayleigh_ubar</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Vector&lt;amrex::Real&gt; &gt; ERF::h_rayleigh_ubar</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a6e0624ac1d76fbde394c7ba4b01ed7eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e0624ac1d76fbde394c7ba4b01ed7eb">&#9670;&nbsp;</a></span>h_rayleigh_vbar</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Vector&lt;amrex::Real&gt; &gt; ERF::h_rayleigh_vbar</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aa30548378350788543d15076cdcd404d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa30548378350788543d15076cdcd404d">&#9670;&nbsp;</a></span>init_shrink</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real ERF::init_shrink = 1.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="af5ac3d88a33a1a284bcc120ce0599cf7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5ac3d88a33a1a284bcc120ce0599cf7">&#9670;&nbsp;</a></span>init_type</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ERF::init_type = &quot;custom&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a80ad08512968ec45635df68abe66b1fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80ad08512968ec45635df68abe66b1fc">&#9670;&nbsp;</a></span>input_bndry_planes</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::input_bndry_planes = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a83572d8dfad51158945b4a5ab06b2f72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83572d8dfad51158945b4a5ab06b2f72">&#9670;&nbsp;</a></span>input_sounding_data</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structInputSoundingData.html">InputSoundingData</a> ERF::input_sounding_data</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a536424e14c4139e4683b15c59e742362"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a536424e14c4139e4683b15c59e742362">&#9670;&nbsp;</a></span>input_sounding_file</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ERF::input_sounding_file = &quot;&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aefa640a036c25b7b770e88a5f838eb2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aefa640a036c25b7b770e88a5f838eb2a">&#9670;&nbsp;</a></span>istep</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;int&gt; ERF::istep</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a02722d16f3c26efe590702200f1296d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02722d16f3c26efe590702200f1296d7">&#9670;&nbsp;</a></span>last_check_file_step</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::last_check_file_step</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a4e3d0f4486b62037fce08fca0aa2d0a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e3d0f4486b62037fce08fca0aa2d0a9">&#9670;&nbsp;</a></span>last_plot_file_step</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::last_plot_file_step</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a7d5ea71a2772d2ce602b90d80e32ad37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d5ea71a2772d2ce602b90d80e32ad37">&#9670;&nbsp;</a></span>m_bc_extdir_vals</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Array&lt;amrex::Array&lt;amrex::Real, AMREX_SPACEDIM*2&gt;,AMREX_SPACEDIM+<a class="el" href="IndexDefines_8H.html#ad5195ac8f863f5a9a7eaa0db094f7639">NVAR</a>&gt; ERF::m_bc_extdir_vals</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a051364b2373d8d86151c0b4a958035bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a051364b2373d8d86151c0b4a958035bd">&#9670;&nbsp;</a></span>m_most</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classABLMost.html">ABLMost</a>&gt; ERF::m_most = nullptr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="addf62bfc534515447b94e928ac0b7135"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addf62bfc534515447b94e928ac0b7135">&#9670;&nbsp;</a></span>m_r2d</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classReadBndryPlanes.html">ReadBndryPlanes</a>&gt; ERF::m_r2d = nullptr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aa53035f34ba133b86172e180abda4209"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa53035f34ba133b86172e180abda4209">&#9670;&nbsp;</a></span>m_w2d</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classWriteBndryPlanes.html">WriteBndryPlanes</a>&gt; ERF::m_w2d = nullptr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a0634154e8e58379c495c3e7fe7c5e4d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0634154e8e58379c495c3e7fe7c5e4d6">&#9670;&nbsp;</a></span>max_step</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::max_step = std::numeric_limits&lt;int&gt;::max()</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a7e9040f32464f1a6dee6e0384393451d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e9040f32464f1a6dee6e0384393451d">&#9670;&nbsp;</a></span>nc_bdy_file</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ERF::nc_bdy_file = &quot;&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a99757524a49a79368069f66f71797c9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99757524a49a79368069f66f71797c9d">&#9670;&nbsp;</a></span>nc_init_file</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt; amrex::Vector&lt; std::string &gt; &gt; ERF::nc_init_file = {{&quot;&quot;}}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="addf0fb2aae0efaa649c69685a4dcca83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addf0fb2aae0efaa649c69685a4dcca83">&#9670;&nbsp;</a></span>ng_dens_hse</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::ng_dens_hse = 1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a87dc6c0720462bfd088c909289cdca0b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87dc6c0720462bfd088c909289cdca0b">&#9670;&nbsp;</a></span>ng_pres_hse</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::ng_pres_hse = 1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aa3db2dd1b65310c66c4038650c22aaee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3db2dd1b65310c66c4038650c22aaee">&#9670;&nbsp;</a></span>nsubsteps</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;int&gt; ERF::nsubsteps</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="adcd9f23975ffa605247b41d391c2a2f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adcd9f23975ffa605247b41d391c2a2f0">&#9670;&nbsp;</a></span>num_boxes_at_level</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;int&gt; ERF::num_boxes_at_level</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ad17ff2753e754ff3eb1330612b820b5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad17ff2753e754ff3eb1330612b820b5f">&#9670;&nbsp;</a></span>output_1d_column</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::output_1d_column = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a7c448670f7a5cadd6fe56f7e615c9eb6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c448670f7a5cadd6fe56f7e615c9eb6">&#9670;&nbsp;</a></span>output_bndry_planes</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::output_bndry_planes = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ab8f4a61c714936efc1c669447b009c29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8f4a61c714936efc1c669447b009c29">&#9670;&nbsp;</a></span>phys_bc_type</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::GpuArray&lt;<a class="el" href="IndexDefines_8H.html#a6e1412fca31cbd35d0f50f12fcc70b0f">BC</a>, AMREX_SPACEDIM*2&gt; ERF::phys_bc_type</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a123e428e6385285dfb646bc6f85ce654"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a123e428e6385285dfb646bc6f85ce654">&#9670;&nbsp;</a></span>plot_deriv_names</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::string&gt; ERF::plot_deriv_names</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ad02c77d3f4a7dfa0ad679877f0f05fc1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad02c77d3f4a7dfa0ad679877f0f05fc1">&#9670;&nbsp;</a></span>plot_file</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ERF::plot_file {&quot;plt&quot;}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="adc00038dfe4c332e5d15f621184c69e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc00038dfe4c332e5d15f621184c69e8">&#9670;&nbsp;</a></span>plot_file_on_restart</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::plot_file_on_restart = 1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="abe64c2ff781da4cc0642ee1d29c912d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe64c2ff781da4cc0642ee1d29c912d6">&#9670;&nbsp;</a></span>plot_int</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::plot_int = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a5239b3dae0bf9ba78876bf2e8d497016"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5239b3dae0bf9ba78876bf2e8d497016">&#9670;&nbsp;</a></span>plot_state_names</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::string&gt; ERF::plot_state_names</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a3aa38bc97a888d859a640220d2bc4456"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3aa38bc97a888d859a640220d2bc4456">&#9670;&nbsp;</a></span>plot_type</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ERF::plot_type {&quot;native&quot;}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ae7b9991150042eb38e2abc89399c0c7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7b9991150042eb38e2abc89399c0c7c">&#9670;&nbsp;</a></span>plotfile_type</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ERF::plotfile_type = &quot;amrex&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a7948479fe1497dc592dd748c9567fdaa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7948479fe1497dc592dd748c9567fdaa">&#9670;&nbsp;</a></span>previousCPUTimeUsed</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real ERF::previousCPUTimeUsed = 0.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ac81b3dfd7c6f21ba8479834e2ff1e652"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac81b3dfd7c6f21ba8479834e2ff1e652">&#9670;&nbsp;</a></span>ref_tags</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Vector&lt; AMRErrorTag &gt; ERF::ref_tags</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a3937527f96c81674fa38dc34ed24f3f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3937527f96c81674fa38dc34ed24f3f5">&#9670;&nbsp;</a></span>regrid_int</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::regrid_int = 2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a8e758060d3dede9694fbfcabddc17169"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e758060d3dede9694fbfcabddc17169">&#9670;&nbsp;</a></span>restart_chkfile</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ERF::restart_chkfile = &quot;&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a32dd48049e8acbe95decdd4b01b782c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a32dd48049e8acbe95decdd4b01b782c4">&#9670;&nbsp;</a></span>solverChoice</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structSolverChoice.html">SolverChoice</a> ERF::solverChoice</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a3890ee3bf2586cf0ef2822b671c5d8c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3890ee3bf2586cf0ef2822b671c5d8c4">&#9670;&nbsp;</a></span>startCPUTime</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real ERF::startCPUTime = 0.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a405556a52bef334ab68294c1a540e107"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a405556a52bef334ab68294c1a540e107">&#9670;&nbsp;</a></span>stop_time</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real ERF::stop_time = std::numeric_limits&lt;amrex::Real&gt;::max()</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a5232e98479611a24fe97994640c61faa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5232e98479611a24fe97994640c61faa">&#9670;&nbsp;</a></span>sum_interval</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::sum_interval = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a6f9e05e91a9b4a16d615af290966a973"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f9e05e91a9b4a16d615af290966a973">&#9670;&nbsp;</a></span>sum_per</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real ERF::sum_per = -1.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a65741b6379d273c19a25cf48bb947614"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65741b6379d273c19a25cf48bb947614">&#9670;&nbsp;</a></span>t_new</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Real&gt; ERF::t_new</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a7085d7d5fc94a0f84efc06957267d58e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7085d7d5fc94a0f84efc06957267d58e">&#9670;&nbsp;</a></span>t_old</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Real&gt; ERF::t_old</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aad09820d3e29638db7c3d499304c8aed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad09820d3e29638db7c3d499304c8aed">&#9670;&nbsp;</a></span>use_lowM_dt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool ERF::use_lowM_dt = false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a4a279f0f572da168852d954df55abe2e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a279f0f572da168852d954df55abe2e">&#9670;&nbsp;</a></span>use_native_mri</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::use_native_mri = 1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a1204ca4dc5d79f5da191ffbe09dfab9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1204ca4dc5d79f5da191ffbe09dfab9b">&#9670;&nbsp;</a></span>vars_new</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Vector&lt;amrex::MultiFab&gt; &gt; ERF::vars_new</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="af31e928baa970a1507dfb0233b352542"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af31e928baa970a1507dfb0233b352542">&#9670;&nbsp;</a></span>vars_old</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Vector&lt;amrex::MultiFab&gt; &gt; ERF::vars_old</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a2f2ea7f5eeeb3634944550e5a1de8f7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f2ea7f5eeeb3634944550e5a1de8f7a">&#9670;&nbsp;</a></span>velocity_names</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const amrex::Vector&lt;std::string&gt; ERF::velocity_names {&quot;x_velocity&quot;, &quot;y_velocity&quot;, &quot;z_velocity&quot;}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a43d0b17f6e155691a1e9474526df3af5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43d0b17f6e155691a1e9474526df3af5">&#9670;&nbsp;</a></span>verbose</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::verbose = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/runner/work/ERF/ERF/Source/<a class="el" href="ERF_8H_source.html">ERF.H</a></li>
<li>/home/runner/work/ERF/ERF/Source/<a class="el" href="ERF_8cpp.html">ERF.cpp</a></li>
<li>/home/runner/work/ERF/ERF/Source/<a class="el" href="ERF__ComputeTimestep_8cpp.html">ERF_ComputeTimestep.cpp</a></li>
<li>/home/runner/work/ERF/ERF/Source/<a class="el" href="ERF__FillPatch_8cpp.html">ERF_FillPatch.cpp</a></li>
<li>/home/runner/work/ERF/ERF/Source/<a class="el" href="ERF__init_8cpp.html">ERF_init.cpp</a></li>
<li>/home/runner/work/ERF/ERF/Source/<a class="el" href="ERF__init1d_8cpp.html">ERF_init1d.cpp</a></li>
<li>/home/runner/work/ERF/ERF/Source/<a class="el" href="ERF__init__bcs_8cpp.html">ERF_init_bcs.cpp</a></li>
<li>/home/runner/work/ERF/ERF/Source/<a class="el" href="ERF__SumIQ_8cpp.html">ERF_SumIQ.cpp</a></li>
<li>/home/runner/work/ERF/ERF/Source/<a class="el" href="ERF__Tagging_8cpp.html">ERF_Tagging.cpp</a></li>
<li>/home/runner/work/ERF/ERF/Source/<a class="el" href="ERF__TimeStepping_8cpp.html">ERF_TimeStepping.cpp</a></li>
<li>/home/runner/work/ERF/ERF/Source/IO/<a class="el" href="Checkpoint_8cpp.html">Checkpoint.cpp</a></li>
<li>/home/runner/work/ERF/ERF/Source/IO/<a class="el" href="Plotfile_8cpp.html">Plotfile.cpp</a></li>
<li>/home/runner/work/ERF/ERF/Source/IO/<a class="el" href="writeJobInfo_8cpp.html">writeJobInfo.cpp</a></li>
<li>/home/runner/work/ERF/ERF/Source/TimeIntegration/<a class="el" href="TimeIntegration__driver_8cpp.html">TimeIntegration_driver.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="aIndexDefines_8H_html_a6e1412fca31cbd35d0f50f12fcc70b0facac0c32caf84a889ec9b2b4cb2d56972"><div class="ttname"><a href="IndexDefines_8H.html#a6e1412fca31cbd35d0f50f12fcc70b0facac0c32caf84a889ec9b2b4cb2d56972">BC::outflow</a></div><div class="ttdeci">@ outflow</div></div>
<div class="ttc" id="aIndexDefines_8H_html_a27dcc910aeb002a0fd44727954dc0e49"><div class="ttname"><a href="IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a></div><div class="ttdeci">#define Rho_comp</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:8</div></div>
<div class="ttc" id="aComputeTurbulentViscosity_8cpp_html_ab6df21759a0fbc49cc70bf928780e275"><div class="ttname"><a href="ComputeTurbulentViscosity_8cpp.html#ab6df21759a0fbc49cc70bf928780e275">ComputeTurbulentViscosity</a></div><div class="ttdeci">void ComputeTurbulentViscosity(const amrex::MultiFab &amp;xvel, const amrex::MultiFab &amp;yvel, const amrex::MultiFab &amp;zvel, const amrex::MultiFab &amp;cons_in, amrex::MultiFab &amp;eddyViscosity, const amrex::Geometry &amp;geom, const SolverChoice &amp;solverChoice, std::unique_ptr&lt; ABLMost &gt; &amp;most, const amrex::Gpu::DeviceVector&lt; amrex::BCRec &gt; domain_bcs_type_d, bool vert_only)</div><div class="ttdef"><b>Definition:</b> ComputeTurbulentViscosity.cpp:198</div></div>
<div class="ttc" id="aTerrainMetrics_8H_html_aa583c7ebfef25f449af86111b0572533"><div class="ttname"><a href="TerrainMetrics_8H.html#aa583c7ebfef25f449af86111b0572533">ComputeMetricAtIface</a></div><div class="ttdeci">AMREX_GPU_DEVICE void ComputeMetricAtIface(const int &amp;i, const int &amp;j, const int &amp;k, amrex::Real &amp;met_h_xi, amrex::Real &amp;met_h_eta, amrex::Real &amp;met_h_zeta, const amrex::GpuArray&lt; amrex::Real, AMREX_SPACEDIM &gt; &amp;cellSizeInv, const amrex::Array4&lt; const amrex::Real &gt; &amp;z_nd, const int flag)</div><div class="ttdef"><b>Definition:</b> TerrainMetrics.H:131</div></div>
<div class="ttc" id="aclassERF_html_a3aa38bc97a888d859a640220d2bc4456"><div class="ttname"><a href="classERF.html#a3aa38bc97a888d859a640220d2bc4456">ERF::plot_type</a></div><div class="ttdeci">std::string plot_type</div><div class="ttdef"><b>Definition:</b> ERF.H:499</div></div>
<div class="ttc" id="astructTimeInterpolatedData_html_a65f3edf3f03a779a931f5c58bd438602"><div class="ttname"><a href="structTimeInterpolatedData.html#a65f3edf3f03a779a931f5c58bd438602">TimeInterpolatedData::get_var</a></div><div class="ttdeci">amrex::MultiFab &amp; get_var(int var_idx)</div><div class="ttdef"><b>Definition:</b> TimeInterpolatedData.H:28</div></div>
<div class="ttc" id="anamespaceERFBCType_html_a40fbdd5a379a92debb4bcaaccac6e01cabc47f82507730e1734a2f3bc58893cf9"><div class="ttname"><a href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01cabc47f82507730e1734a2f3bc58893cf9">ERFBCType::reflect_even</a></div><div class="ttdeci">@ reflect_even</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:134</div></div>
<div class="ttc" id="aclassERF_html_a8202de1f8f372e3e6fdc483447c6a55f"><div class="ttname"><a href="classERF.html#a8202de1f8f372e3e6fdc483447c6a55f">ERF::AverageDown</a></div><div class="ttdeci">void AverageDown()</div><div class="ttdef"><b>Definition:</b> ERF.cpp:977</div></div>
<div class="ttc" id="aclassERF_html_a84cf7616e7b3928f08f4bd56112db01e"><div class="ttname"><a href="classERF.html#a84cf7616e7b3928f08f4bd56112db01e">ERF::d_havg_density</a></div><div class="ttdeci">amrex::Gpu::DeviceVector&lt; amrex::Real &gt; d_havg_density</div><div class="ttdef"><b>Definition:</b> ERF.H:592</div></div>
<div class="ttc" id="aclassERF_html_a92c020bfaa43e40fb5ffc449427a0318"><div class="ttname"><a href="classERF.html#a92c020bfaa43e40fb5ffc449427a0318">ERF::initHSE</a></div><div class="ttdeci">void initHSE()</div><div class="ttdoc">Initialize HSE.</div><div class="ttdef"><b>Definition:</b> ERF_init1d.cpp:49</div></div>
<div class="ttc" id="aclassERF_html_a574521986a6e403159f83c8b8123ba90"><div class="ttname"><a href="classERF.html#a574521986a6e403159f83c8b8123ba90">ERF::domain_bcs_type</a></div><div class="ttdeci">amrex::Vector&lt; amrex::BCRec &gt; domain_bcs_type</div><div class="ttdef"><b>Definition:</b> ERF.H:456</div></div>
<div class="ttc" id="aclassERF_html_a9a4f076c56f31fbb5e68c09706605a05"><div class="ttname"><a href="classERF.html#a9a4f076c56f31fbb5e68c09706605a05">ERF::d_havg_pressure</a></div><div class="ttdeci">amrex::Gpu::DeviceVector&lt; amrex::Real &gt; d_havg_pressure</div><div class="ttdef"><b>Definition:</b> ERF.H:594</div></div>
<div class="ttc" id="aclassERF_html_a6e0624ac1d76fbde394c7ba4b01ed7eb"><div class="ttname"><a href="classERF.html#a6e0624ac1d76fbde394c7ba4b01ed7eb">ERF::h_rayleigh_vbar</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; amrex::Real &gt; &gt; h_rayleigh_vbar</div><div class="ttdef"><b>Definition:</b> ERF.H:578</div></div>
<div class="ttc" id="aclassERF_html_a3890ee3bf2586cf0ef2822b671c5d8c4"><div class="ttname"><a href="classERF.html#a3890ee3bf2586cf0ef2822b671c5d8c4">ERF::startCPUTime</a></div><div class="ttdeci">static amrex::Real startCPUTime</div><div class="ttdef"><b>Definition:</b> ERF.H:666</div></div>
<div class="ttc" id="aclassERF_html_a17edcb4fd8fa664054acdbcfa0f7d9a3"><div class="ttname"><a href="classERF.html#a17edcb4fd8fa664054acdbcfa0f7d9a3">ERF::FillIntermediatePatch</a></div><div class="ttdeci">void FillIntermediatePatch(int lev, amrex::Real time, amrex::Vector&lt; std::reference_wrapper&lt; amrex::MultiFab &gt; &gt; mfs, bool rho_only=false)</div><div class="ttdef"><b>Definition:</b> ERF_FillPatch.cpp:199</div></div>
<div class="ttc" id="aclassERF_html_a91e9618892751232c4067c253f904a3d"><div class="ttname"><a href="classERF.html#a91e9618892751232c4067c253f904a3d">ERF::d_rayleigh_tau</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Gpu::DeviceVector&lt; amrex::Real &gt; &gt; d_rayleigh_tau</div><div class="ttdef"><b>Definition:</b> ERF.H:580</div></div>
<div class="ttc" id="anamespaceRHSVar_html_a9c3323327b60ac367bfd4f28e8f81459a663b433383c61be43231a25243ec832d"><div class="ttname"><a href="namespaceRHSVar.html#a9c3323327b60ac367bfd4f28e8f81459a663b433383c61be43231a25243ec832d">RHSVar::all</a></div><div class="ttdeci">@ all</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:58</div></div>
<div class="ttc" id="anamespaceERFBCType_html_a40fbdd5a379a92debb4bcaaccac6e01ca138e8c6c2427dcd78959f3e0e84b3462"><div class="ttname"><a href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca138e8c6c2427dcd78959f3e0e84b3462">ERFBCType::ext_dir_ingested</a></div><div class="ttdeci">@ ext_dir_ingested</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:140</div></div>
<div class="ttc" id="aprob__common_8H_html_ad0da799211f82f28a9e0d53008febb1b"><div class="ttname"><a href="prob__common_8H.html#ad0da799211f82f28a9e0d53008febb1b">erf_init_rayleigh</a></div><div class="ttdeci">void erf_init_rayleigh(amrex::Vector&lt; amrex::Real &gt; &amp;tau, amrex::Vector&lt; amrex::Real &gt; &amp;ubar, amrex::Vector&lt; amrex::Real &gt; &amp;vbar, amrex::Vector&lt; amrex::Real &gt; &amp;thetabar, amrex::Geometry const &amp;geom)</div></div>
<div class="ttc" id="anamespaceIntVar_html_ae96c1cd796f723e15dfbf718f1a9c76daa06e9caed4d0b72c322646815c1a96ce"><div class="ttname"><a href="namespaceIntVar.html#ae96c1cd796f723e15dfbf718f1a9c76daa06e9caed4d0b72c322646815c1a96ce">IntVar::ymom</a></div><div class="ttdeci">@ ymom</div><div class="ttdef"><b>Definition:</b> TimeIntegration.H:15</div></div>
<div class="ttc" id="aclassERF_html_aff6f5d2bd989b5a0f7c28e2e10e27e8c"><div class="ttname"><a href="classERF.html#aff6f5d2bd989b5a0f7c28e2e10e27e8c">ERF::h_pres_hse</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; amrex::Real &gt; &gt; h_pres_hse</div><div class="ttdef"><b>Definition:</b> ERF.H:445</div></div>
<div class="ttc" id="aclassERF_html_ae5968f1bed602fa87cdd5cb7905b7e5e"><div class="ttname"><a href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">ERF::domain_bc_type</a></div><div class="ttdeci">amrex::Array&lt; std::string, 2 *AMREX_SPACEDIM &gt; domain_bc_type</div><div class="ttdef"><b>Definition:</b> ERF.H:460</div></div>
<div class="ttc" id="anamespaceBCVars_html_a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4"><div class="ttname"><a href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a></div><div class="ttdeci">@ xvel_bc</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:47</div></div>
<div class="ttc" id="aIndexDefines_8H_html_a6e1412fca31cbd35d0f50f12fcc70b0fa5e543256c480ac577d30f76f9120eb74"><div class="ttname"><a href="IndexDefines_8H.html#a6e1412fca31cbd35d0f50f12fcc70b0fa5e543256c480ac577d30f76f9120eb74">BC::undefined</a></div><div class="ttdeci">@ undefined</div></div>
<div class="ttc" id="aERF__Constants_8H_html_a60be2e6257954ef746019c916741cb2c"><div class="ttname"><a href="ERF__Constants_8H.html#a60be2e6257954ef746019c916741cb2c">p_0</a></div><div class="ttdeci">#define p_0</div><div class="ttdef"><b>Definition:</b> ERF_Constants.H:11</div></div>
<div class="ttc" id="aclassERF_html_a92248817d31fce8771fba3532d819421"><div class="ttname"><a href="classERF.html#a92248817d31fce8771fba3532d819421">ERF::GetDataAtTime</a></div><div class="ttdeci">TimeInterpolatedData GetDataAtTime(int lev, amrex::Real time)</div><div class="ttdef"><b>Definition:</b> ERF_FillPatch.cpp:10</div></div>
<div class="ttc" id="aTerrainMetrics_8cpp_html_a55942b90d16d1e216ce1459858c70af7"><div class="ttname"><a href="TerrainMetrics_8cpp.html#a55942b90d16d1e216ce1459858c70af7">init_terrain_grid</a></div><div class="ttdeci">void init_terrain_grid(int lev, amrex::Geometry &amp;geom, amrex::MultiFab &amp;z_phys_nd)</div><div class="ttdef"><b>Definition:</b> TerrainMetrics.cpp:13</div></div>
<div class="ttc" id="aclassERF_html_ad17ff2753e754ff3eb1330612b820b5f"><div class="ttname"><a href="classERF.html#ad17ff2753e754ff3eb1330612b820b5f">ERF::output_1d_column</a></div><div class="ttdeci">static int output_1d_column</div><div class="ttdef"><b>Definition:</b> ERF.H:556</div></div>
<div class="ttc" id="aclassERF_html_a618e8fdff3239cc79d4145d02b1ecaa2"><div class="ttname"><a href="classERF.html#a618e8fdff3239cc79d4145d02b1ecaa2">ERF::init_bcs</a></div><div class="ttdeci">void init_bcs()</div><div class="ttdef"><b>Definition:</b> ERF_init_bcs.cpp:9</div></div>
<div class="ttc" id="aclassERF_html_ad2e1a979c0ad68e87eaee349beb7e9fd"><div class="ttname"><a href="classERF.html#ad2e1a979c0ad68e87eaee349beb7e9fd">ERF::fixed_mri_dt_ratio</a></div><div class="ttdeci">static int fixed_mri_dt_ratio</div><div class="ttdef"><b>Definition:</b> ERF.H:490</div></div>
<div class="ttc" id="aclassERF_html_a5239b3dae0bf9ba78876bf2e8d497016"><div class="ttname"><a href="classERF.html#a5239b3dae0bf9ba78876bf2e8d497016">ERF::plot_state_names</a></div><div class="ttdeci">amrex::Vector&lt; std::string &gt; plot_state_names</div><div class="ttdef"><b>Definition:</b> ERF.H:507</div></div>
<div class="ttc" id="aclassERF_html_ab8f4a61c714936efc1c669447b009c29"><div class="ttname"><a href="classERF.html#ab8f4a61c714936efc1c669447b009c29">ERF::phys_bc_type</a></div><div class="ttdeci">amrex::GpuArray&lt; BC, AMREX_SPACEDIM *2 &gt; phys_bc_type</div><div class="ttdef"><b>Definition:</b> ERF.H:466</div></div>
<div class="ttc" id="aclassERF_html_af31e928baa970a1507dfb0233b352542"><div class="ttname"><a href="classERF.html#af31e928baa970a1507dfb0233b352542">ERF::vars_old</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; amrex::MultiFab &gt; &gt; vars_old</div><div class="ttdef"><b>Definition:</b> ERF.H:434</div></div>
<div class="ttc" id="aclassERF_html_a051364b2373d8d86151c0b4a958035bd"><div class="ttname"><a href="classERF.html#a051364b2373d8d86151c0b4a958035bd">ERF::m_most</a></div><div class="ttdeci">std::unique_ptr&lt; ABLMost &gt; m_most</div><div class="ttdef"><b>Definition:</b> ERF.H:604</div></div>
<div class="ttc" id="aprob__common_8H_html_aaa081a4255fd836eef28bb48e3bf7856"><div class="ttname"><a href="prob__common_8H.html#aaa081a4255fd836eef28bb48e3bf7856">init_custom_prob</a></div><div class="ttdeci">void init_custom_prob(const amrex::Box &amp;bx, amrex::Array4&lt; amrex::Real &gt; const &amp;state, amrex::Array4&lt; amrex::Real &gt; const &amp;x_vel, amrex::Array4&lt; amrex::Real &gt; const &amp;y_vel, amrex::Array4&lt; amrex::Real &gt; const &amp;z_vel, amrex::GeometryData const &amp;geomdata)</div></div>
<div class="ttc" id="aclassERF_html_a6f9e05e91a9b4a16d615af290966a973"><div class="ttname"><a href="classERF.html#a6f9e05e91a9b4a16d615af290966a973">ERF::sum_per</a></div><div class="ttdeci">static amrex::Real sum_per</div><div class="ttdef"><b>Definition:</b> ERF.H:538</div></div>
<div class="ttc" id="anamespaceVars_html_a2aa680f90abb6ff6d5c1875f8beb4b1ca81793b83204cfa56d4683bc676fbbfb6"><div class="ttname"><a href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a></div><div class="ttdeci">@ yvel</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:66</div></div>
<div class="ttc" id="aclassERF_html_af33ee878e24ced10b3da319795723db0"><div class="ttname"><a href="classERF.html#af33ee878e24ced10b3da319795723db0">ERF::d_rayleigh_ubar</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Gpu::DeviceVector&lt; amrex::Real &gt; &gt; d_rayleigh_ubar</div><div class="ttdef"><b>Definition:</b> ERF.H:581</div></div>
<div class="ttc" id="aclassERF_html_addf0fb2aae0efaa649c69685a4dcca83"><div class="ttname"><a href="classERF.html#addf0fb2aae0efaa649c69685a4dcca83">ERF::ng_dens_hse</a></div><div class="ttdeci">static int ng_dens_hse</div><div class="ttdef"><b>Definition:</b> ERF.H:572</div></div>
<div class="ttc" id="astructTimeInterpolatedData_html"><div class="ttname"><a href="structTimeInterpolatedData.html">TimeInterpolatedData</a></div><div class="ttdef"><b>Definition:</b> TimeInterpolatedData.H:8</div></div>
<div class="ttc" id="aclassERF_html_aa6fd6592c50f03c55ca0f0c9137c7e48"><div class="ttname"><a href="classERF.html#aa6fd6592c50f03c55ca0f0c9137c7e48">ERF::init_from_input_sounding</a></div><div class="ttdeci">void init_from_input_sounding(const amrex::Box &amp;bx, amrex::Array4&lt; amrex::Real &gt; const &amp;state, amrex::Array4&lt; amrex::Real &gt; const &amp;x_vel, amrex::Array4&lt; amrex::Real &gt; const &amp;y_vel, amrex::Array4&lt; amrex::Real &gt; const &amp;z_vel, amrex::GeometryData const &amp;geomdata, InputSoundingData const &amp;inputSoundingData)</div><div class="ttdef"><b>Definition:</b> ERF_init.cpp:88</div></div>
<div class="ttc" id="aclassERF_html_a3407564246f176655d0dc97733997e52"><div class="ttname"><a href="classERF.html#a3407564246f176655d0dc97733997e52">ERF::d_dens_hse</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Gpu::DeviceVector&lt; amrex::Real &gt; &gt; d_dens_hse</div><div class="ttdef"><b>Definition:</b> ERF.H:446</div></div>
<div class="ttc" id="aclassERF_html_a6b1d727e63de2e49aa4f8e00b0dda1d5"><div class="ttname"><a href="classERF.html#a6b1d727e63de2e49aa4f8e00b0dda1d5">ERF::estTimeStep</a></div><div class="ttdeci">amrex::Real estTimeStep(int lev, long &amp;dt_fast_ratio) const</div><div class="ttdef"><b>Definition:</b> ERF_ComputeTimestep.cpp:40</div></div>
<div class="ttc" id="aclassERF_html_a21e2e459ae54d580e40f0ffdbcdc68a4"><div class="ttname"><a href="classERF.html#a21e2e459ae54d580e40f0ffdbcdc68a4">ERF::bdy_data_ylo</a></div><div class="ttdeci">amrex::Vector&lt; amrex::FArrayBox &gt; bdy_data_ylo</div><div class="ttdef"><b>Definition:</b> ERF.H:376</div></div>
<div class="ttc" id="anamespacederived_html_ab8895d9d9775ea0b8f643483a5a4127e"><div class="ttname"><a href="namespacederived.html#ab8895d9d9775ea0b8f643483a5a4127e">derived::erf_dertheta</a></div><div class="ttdeci">void erf_dertheta(const amrex::Box &amp;bx, amrex::FArrayBox &amp;derfab, int, int, const amrex::FArrayBox &amp;datfab, const amrex::Geometry &amp;, amrex::Real, const int *, const int)</div><div class="ttdef"><b>Definition:</b> Derive.cpp:105</div></div>
<div class="ttc" id="aclassERF_html_a3d8f63f2178b1cb5ba78a433ece34e1c"><div class="ttname"><a href="classERF.html#a3d8f63f2178b1cb5ba78a433ece34e1c">ERF::FillPatch</a></div><div class="ttdeci">void FillPatch(int lev, amrex::Real time, amrex::Vector&lt; amrex::MultiFab &gt; &amp;mf)</div><div class="ttdef"><b>Definition:</b> ERF_FillPatch.cpp:69</div></div>
<div class="ttc" id="aclassERF_html_a80981e20939a6a38ba17478da2253ff1"><div class="ttname"><a href="classERF.html#a80981e20939a6a38ba17478da2253ff1">ERF::init_only</a></div><div class="ttdeci">void init_only(int lev, amrex::Real time)</div><div class="ttdef"><b>Definition:</b> ERF.cpp:604</div></div>
<div class="ttc" id="astructTimeInterpolatedData_html_af9c5a331c09d13db10c98ad3033114d8"><div class="ttname"><a href="structTimeInterpolatedData.html#af9c5a331c09d13db10c98ad3033114d8">TimeInterpolatedData::owning</a></div><div class="ttdeci">const int owning</div><div class="ttdef"><b>Definition:</b> TimeInterpolatedData.H:49</div></div>
<div class="ttc" id="aclassERF_html_aa53035f34ba133b86172e180abda4209"><div class="ttname"><a href="classERF.html#aa53035f34ba133b86172e180abda4209">ERF::m_w2d</a></div><div class="ttdeci">std::unique_ptr&lt; WriteBndryPlanes &gt; m_w2d</div><div class="ttdef"><b>Definition:</b> ERF.H:602</div></div>
<div class="ttc" id="aIndexDefines_8H_html_a6e1412fca31cbd35d0f50f12fcc70b0fa03ee6de9fd100444c5c0567ea01bd538"><div class="ttname"><a href="IndexDefines_8H.html#a6e1412fca31cbd35d0f50f12fcc70b0fa03ee6de9fd100444c5c0567ea01bd538">BC::slip_wall</a></div><div class="ttdeci">@ slip_wall</div></div>
<div class="ttc" id="aclassERF_html_aaa1c7e25ca002544fc80dcea620bda8d"><div class="ttname"><a href="classERF.html#aaa1c7e25ca002544fc80dcea620bda8d">ERF::bdy_data_yhi</a></div><div class="ttdeci">amrex::Vector&lt; amrex::FArrayBox &gt; bdy_data_yhi</div><div class="ttdef"><b>Definition:</b> ERF.H:377</div></div>
<div class="ttc" id="aclassERF_html_aab4575d8fb57595a2f1aaf088c60447a"><div class="ttname"><a href="classERF.html#aab4575d8fb57595a2f1aaf088c60447a">ERF::bndry_output_planes_interval</a></div><div class="ttdeci">static int bndry_output_planes_interval</div><div class="ttdef"><b>Definition:</b> ERF.H:565</div></div>
<div class="ttc" id="aclassERF_html_a9fc0f6e6ca35036d2e3a36dd42e66435"><div class="ttname"><a href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">ERF::derived_names</a></div><div class="ttdeci">const amrex::Vector&lt; std::string &gt; derived_names</div><div class="ttdef"><b>Definition:</b> ERF.H:518</div></div>
<div class="ttc" id="anamespaceEddyDiff_html_a8e591238ddc3313566df853a4372e977aa3900ab375460932d825b615bb532446"><div class="ttname"><a href="namespaceEddyDiff.html#a8e591238ddc3313566df853a4372e977aa3900ab375460932d825b615bb532446">EddyDiff::NumDiffs</a></div><div class="ttdeci">@ NumDiffs</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:119</div></div>
<div class="ttc" id="aclassERF_html_a123e428e6385285dfb646bc6f85ce654"><div class="ttname"><a href="classERF.html#a123e428e6385285dfb646bc6f85ce654">ERF::plot_deriv_names</a></div><div class="ttdeci">amrex::Vector&lt; std::string &gt; plot_deriv_names</div><div class="ttdef"><b>Definition:</b> ERF.H:508</div></div>
<div class="ttc" id="aclassERF_html_a2d39cd3bdc3d90609ad3b14e266d190a"><div class="ttname"><a href="classERF.html#a2d39cd3bdc3d90609ad3b14e266d190a">ERF::ReadParameters</a></div><div class="ttdeci">void ReadParameters()</div><div class="ttdef"><b>Definition:</b> ERF.cpp:709</div></div>
<div class="ttc" id="astructSolverChoice_html_a27ced9266434a4680ef175e7b2ba8f01"><div class="ttname"><a href="structSolverChoice.html#a27ced9266434a4680ef175e7b2ba8f01">SolverChoice::use_rayleigh_damping</a></div><div class="ttdeci">bool use_rayleigh_damping</div><div class="ttdef"><b>Definition:</b> DataStruct.H:322</div></div>
<div class="ttc" id="aclassERF_html_a7948479fe1497dc592dd748c9567fdaa"><div class="ttname"><a href="classERF.html#a7948479fe1497dc592dd748c9567fdaa">ERF::previousCPUTimeUsed</a></div><div class="ttdeci">static amrex::Real previousCPUTimeUsed</div><div class="ttdef"><b>Definition:</b> ERF.H:667</div></div>
<div class="ttc" id="aclassERF_html_a252eec287326f8dcc72dee7f3cc105c4"><div class="ttname"><a href="classERF.html#a252eec287326f8dcc72dee7f3cc105c4">ERF::FillCoarsePatchAllVars</a></div><div class="ttdeci">void FillCoarsePatchAllVars(int lev, amrex::Real time, amrex::Vector&lt; amrex::MultiFab &gt; &amp;vmf)</div><div class="ttdef"><b>Definition:</b> ERF_FillPatch.cpp:404</div></div>
<div class="ttc" id="aclassERF_html_aef40b8ba6cb32fe3b11b8d9381f16cef"><div class="ttname"><a href="classERF.html#aef40b8ba6cb32fe3b11b8d9381f16cef">ERF::setPlotVariables</a></div><div class="ttdeci">void setPlotVariables()</div><div class="ttdef"><b>Definition:</b> Plotfile.cpp:20</div></div>
<div class="ttc" id="aclassERFPhysBCFunct_html"><div class="ttname"><a href="classERFPhysBCFunct.html">ERFPhysBCFunct</a></div><div class="ttdef"><b>Definition:</b> ERF_PhysBCFunct.H:42</div></div>
<div class="ttc" id="aclassERF_html_ac4dc443840da3593fe66b8693803f006"><div class="ttname"><a href="classERF.html#ac4dc443840da3593fe66b8693803f006">ERF::h_rayleigh_ubar</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; amrex::Real &gt; &gt; h_rayleigh_ubar</div><div class="ttdef"><b>Definition:</b> ERF.H:577</div></div>
<div class="ttc" id="anamespaceERFBCType_html_a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af"><div class="ttname"><a href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af">ERFBCType::ext_dir</a></div><div class="ttdeci">@ ext_dir</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:136</div></div>
<div class="ttc" id="aclassERF_html_a2486b49bb0d7917f812318822e42a03c"><div class="ttname"><a href="classERF.html#a2486b49bb0d7917f812318822e42a03c">ERF::setRecordDataInfo</a></div><div class="ttdeci">void setRecordDataInfo(int i, const std::string &amp;filename)</div><div class="ttdef"><b>Definition:</b> ERF.H:684</div></div>
<div class="ttc" id="anamespaceVars_html_a2aa680f90abb6ff6d5c1875f8beb4b1cada7d061afb1d0d7089d9dfe4874c965d"><div class="ttname"><a href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1cada7d061afb1d0d7089d9dfe4874c965d">Vars::zmom</a></div><div class="ttdeci">@ zmom</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:71</div></div>
<div class="ttc" id="aclassERF_html_a778cdd6547e8cf1613cda8b4a8274bf0"><div class="ttname"><a href="classERF.html#a778cdd6547e8cf1613cda8b4a8274bf0">ERF::do_avg_down</a></div><div class="ttdeci">static int do_avg_down</div><div class="ttdef"><b>Definition:</b> ERF.H:534</div></div>
<div class="ttc" id="aprob__common_8H_html_ae1b3e66694fef92a0c9fd18b186d6d5d"><div class="ttname"><a href="prob__common_8H.html#ae1b3e66694fef92a0c9fd18b186d6d5d">erf_init_dens_hse</a></div><div class="ttdeci">void erf_init_dens_hse(amrex::Real *dens_hse_ptr, amrex::Geometry const &amp;geom, const int ng_dens_hse)</div></div>
<div class="ttc" id="aclassERF_html_afd3cbffc97b8a89e58042e029c5c6b7c"><div class="ttname"><a href="classERF.html#afd3cbffc97b8a89e58042e029c5c6b7c">ERF::get_flux_reg</a></div><div class="ttdeci">AMREX_FORCE_INLINE amrex::FluxRegister &amp; get_flux_reg(int lev)</div><div class="ttdef"><b>Definition:</b> ERF.H:647</div></div>
<div class="ttc" id="aclassERF_html_a83c244120a15f0d9b9bca54e93976428"><div class="ttname"><a href="classERF.html#a83c244120a15f0d9b9bca54e93976428">ERF::fine_mask</a></div><div class="ttdeci">amrex::MultiFab fine_mask</div><div class="ttdef"><b>Definition:</b> ERF.H:615</div></div>
<div class="ttc" id="aERF__Math_8H_html_a803d0d35d4ca4791556cbe02bbf51cbb"><div class="ttname"><a href="ERF__Math_8H.html#a803d0d35d4ca4791556cbe02bbf51cbb">interpolate_1d</a></div><div class="ttdeci">AMREX_GPU_HOST_DEVICE AMREX_FORCE_INLINE amrex::Real interpolate_1d(const amrex::Real *alpha, const amrex::Real *beta, const amrex::Real alpha_interp, const int alpha_size)</div><div class="ttdef"><b>Definition:</b> ERF_Math.H:6</div></div>
<div class="ttc" id="aclassERF_html_ad101fd46096db2d6b21544bfede6551f"><div class="ttname"><a href="classERF.html#ad101fd46096db2d6b21544bfede6551f">ERF::WriteCheckpointFile</a></div><div class="ttdeci">void WriteCheckpointFile() const</div><div class="ttdef"><b>Definition:</b> Checkpoint.cpp:15</div></div>
<div class="ttc" id="aclassERF_html_a7e89a339e79b2b4f177a05e9f0df32fa"><div class="ttname"><a href="classERF.html#a7e89a339e79b2b4f177a05e9f0df32fa">ERF::h_dens_hse</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; amrex::Real &gt; &gt; h_dens_hse</div><div class="ttdef"><b>Definition:</b> ERF.H:444</div></div>
<div class="ttc" id="aIndexDefines_8H_html_a6e1412fca31cbd35d0f50f12fcc70b0facb8c716b8d9b499d9bc323d8f8a410d3"><div class="ttname"><a href="IndexDefines_8H.html#a6e1412fca31cbd35d0f50f12fcc70b0facb8c716b8d9b499d9bc323d8f8a410d3">BC::no_slip_wall</a></div><div class="ttdeci">@ no_slip_wall</div></div>
<div class="ttc" id="aclassERF_html_af285247b24b173cd851fe49799d17f42"><div class="ttname"><a href="classERF.html#af285247b24b173cd851fe49799d17f42">ERF::ReadCheckpointFile</a></div><div class="ttdeci">void ReadCheckpointFile()</div><div class="ttdef"><b>Definition:</b> Checkpoint.cpp:131</div></div>
<div class="ttc" id="aERF_8H_html_a1f8554e7b211b0acfc202e8a600e7d67"><div class="ttname"><a href="ERF_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a></div><div class="ttdeci">bool containerHasElement(const V &amp;iterable, const T &amp;query)</div><div class="ttdef"><b>Definition:</b> ERF.H:61</div></div>
<div class="ttc" id="aclassERF_html_ac793fe23b026c18bb7dcce791317c6c3"><div class="ttname"><a href="classERF.html#ac793fe23b026c18bb7dcce791317c6c3">ERF::change_max</a></div><div class="ttdeci">static amrex::Real change_max</div><div class="ttdef"><b>Definition:</b> ERF.H:485</div></div>
<div class="ttc" id="aDataStruct_8H_html_a07130f00a795700d6b2b83f773b807b4a9e3669d19b675bd57058fd4664205d2a"><div class="ttname"><a href="DataStruct_8H.html#a07130f00a795700d6b2b83f773b807b4a9e3669d19b675bd57058fd4664205d2a">AdvectedQuantity::v</a></div><div class="ttdeci">@ v</div></div>
<div class="ttc" id="aclassERF_html_a039a764a1d942c484e8aea49e87bc046"><div class="ttname"><a href="classERF.html#a039a764a1d942c484e8aea49e87bc046">ERF::initRayleigh</a></div><div class="ttdeci">void initRayleigh()</div><div class="ttdoc">Initialize Rayleigh damping profiles.</div><div class="ttdef"><b>Definition:</b> ERF_init1d.cpp:8</div></div>
<div class="ttc" id="anamespaceERFBCType_html_a40fbdd5a379a92debb4bcaaccac6e01ca9f18284526a1054d4e7a4783852ead30"><div class="ttname"><a href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca9f18284526a1054d4e7a4783852ead30">ERFBCType::int_dir</a></div><div class="ttdeci">@ int_dir</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:133</div></div>
<div class="ttc" id="awriteJobInfo_8cpp_html_aabaa127a3a319c1b86090d6c88568965"><div class="ttname"><a href="writeJobInfo_8cpp.html#aabaa127a3a319c1b86090d6c88568965">inputs_name</a></div><div class="ttdeci">std::string inputs_name</div><div class="ttdef"><b>Definition:</b> main.cpp:9</div></div>
<div class="ttc" id="aclassERF_html_aa2d8099655a8779836e63e3e98ea4372"><div class="ttname"><a href="classERF.html#aa2d8099655a8779836e63e3e98ea4372">ERF::writeJobInfo</a></div><div class="ttdeci">void writeJobInfo(const std::string &amp;dir) const</div><div class="ttdef"><b>Definition:</b> writeJobInfo.cpp:7</div></div>
<div class="ttc" id="anamespaceBCVars_html_a00367571247ba920989360b94c156f4aa03b35ec9e83f34bb1349a86965d34e34"><div class="ttname"><a href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa03b35ec9e83f34bb1349a86965d34e34">BCVars::zvel_bc</a></div><div class="ttdeci">@ zvel_bc</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:49</div></div>
<div class="ttc" id="aclassERF_html_a65741b6379d273c19a25cf48bb947614"><div class="ttname"><a href="classERF.html#a65741b6379d273c19a25cf48bb947614">ERF::t_new</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Real &gt; t_new</div><div class="ttdef"><b>Definition:</b> ERF.H:426</div></div>
<div class="ttc" id="aclassERF_html_a02722d16f3c26efe590702200f1296d7"><div class="ttname"><a href="classERF.html#a02722d16f3c26efe590702200f1296d7">ERF::last_check_file_step</a></div><div class="ttdeci">int last_check_file_step</div><div class="ttdef"><b>Definition:</b> ERF.H:469</div></div>
<div class="ttc" id="aclassERF_html_a405556a52bef334ab68294c1a540e107"><div class="ttname"><a href="classERF.html#a405556a52bef334ab68294c1a540e107">ERF::stop_time</a></div><div class="ttdeci">amrex::Real stop_time</div><div class="ttdef"><b>Definition:</b> ERF.H:477</div></div>
<div class="ttc" id="anamespaceIntVar_html_ae96c1cd796f723e15dfbf718f1a9c76dabde409cfd9edf4a3581fe26dfa9613cd"><div class="ttname"><a href="namespaceIntVar.html#ae96c1cd796f723e15dfbf718f1a9c76dabde409cfd9edf4a3581fe26dfa9613cd">IntVar::zmom</a></div><div class="ttdeci">@ zmom</div><div class="ttdef"><b>Definition:</b> TimeIntegration.H:16</div></div>
<div class="ttc" id="aIndexDefines_8H_html_a6e1412fca31cbd35d0f50f12fcc70b0fa882dd232c0425bb9366544f84f0a7b6c"><div class="ttname"><a href="IndexDefines_8H.html#a6e1412fca31cbd35d0f50f12fcc70b0fa882dd232c0425bb9366544f84f0a7b6c">BC::MOST</a></div><div class="ttdeci">@ MOST</div></div>
<div class="ttc" id="anamespaceIntVar_html_ae96c1cd796f723e15dfbf718f1a9c76daf204c2311e68c84ad19b3759183bdd09"><div class="ttname"><a href="namespaceIntVar.html#ae96c1cd796f723e15dfbf718f1a9c76daf204c2311e68c84ad19b3759183bdd09">IntVar::yflux</a></div><div class="ttdeci">@ yflux</div><div class="ttdef"><b>Definition:</b> TimeIntegration.H:18</div></div>
<div class="ttc" id="aclassERF_html_a48bba6b1c1b39940b09aefbe56311e2f"><div class="ttname"><a href="classERF.html#a48bba6b1c1b39940b09aefbe56311e2f">ERF::column_file_name</a></div><div class="ttdeci">static std::string column_file_name</div><div class="ttdef"><b>Definition:</b> ERF.H:561</div></div>
<div class="ttc" id="anamespaceVars_html_a2aa680f90abb6ff6d5c1875f8beb4b1ca35b6db75aef9a4eca57e85396dc5dc12"><div class="ttname"><a href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca35b6db75aef9a4eca57e85396dc5dc12">Vars::xmom</a></div><div class="ttdeci">@ xmom</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:69</div></div>
<div class="ttc" id="anamespaceVars_html_a2aa680f90abb6ff6d5c1875f8beb4b1ca5deccaa24d5e74279425d7749f7d1494"><div class="ttname"><a href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca5deccaa24d5e74279425d7749f7d1494">Vars::NumTypes</a></div><div class="ttdeci">@ NumTypes</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:68</div></div>
<div class="ttc" id="aclassERF_html_a4e3d0f4486b62037fce08fca0aa2d0a9"><div class="ttname"><a href="classERF.html#a4e3d0f4486b62037fce08fca0aa2d0a9">ERF::last_plot_file_step</a></div><div class="ttdeci">int last_plot_file_step</div><div class="ttdef"><b>Definition:</b> ERF.H:468</div></div>
<div class="ttc" id="aclassERF_html_aaf10bbf8c9a5dbc257a88c4c1b650fee"><div class="ttname"><a href="classERF.html#aaf10bbf8c9a5dbc257a88c4c1b650fee">ERF::MakeNewLevelFromScratch</a></div><div class="ttdeci">virtual void MakeNewLevelFromScratch(int lev, amrex::Real time, const amrex::BoxArray &amp;ba, const amrex::DistributionMapping &amp;dm) override</div><div class="ttdef"><b>Definition:</b> ERF.cpp:545</div></div>
<div class="ttc" id="aclassERF_html_a1bc503c07e76f2a4791a76e6907e6dd7"><div class="ttname"><a href="classERF.html#a1bc503c07e76f2a4791a76e6907e6dd7">ERF::h_rayleigh_tau</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; amrex::Real &gt; &gt; h_rayleigh_tau</div><div class="ttdef"><b>Definition:</b> ERF.H:576</div></div>
<div class="ttc" id="aclassERF_html_a7d5ea71a2772d2ce602b90d80e32ad37"><div class="ttname"><a href="classERF.html#a7d5ea71a2772d2ce602b90d80e32ad37">ERF::m_bc_extdir_vals</a></div><div class="ttdeci">amrex::Array&lt; amrex::Array&lt; amrex::Real, AMREX_SPACEDIM *2 &gt;, AMREX_SPACEDIM+NVAR &gt; m_bc_extdir_vals</div><div class="ttdef"><b>Definition:</b> ERF.H:463</div></div>
<div class="ttc" id="anamespaceBCVars_html_a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec"><div class="ttname"><a href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a></div><div class="ttdeci">@ cons_bc</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:37</div></div>
<div class="ttc" id="aDataStruct_8H_html_a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7"><div class="ttname"><a href="DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">Coord::z</a></div><div class="ttdeci">@ z</div></div>
<div class="ttc" id="aclassERF_html_a050dbd236c9bf246554a53008e09f683"><div class="ttname"><a href="classERF.html#a050dbd236c9bf246554a53008e09f683">ERF::boxes_at_level</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; amrex::Box &gt; &gt; boxes_at_level</div><div class="ttdef"><b>Definition:</b> ERF.H:420</div></div>
<div class="ttc" id="aclassERF_html_adcd9f23975ffa605247b41d391c2a2f0"><div class="ttname"><a href="classERF.html#adcd9f23975ffa605247b41d391c2a2f0">ERF::num_boxes_at_level</a></div><div class="ttdeci">amrex::Vector&lt; int &gt; num_boxes_at_level</div><div class="ttdef"><b>Definition:</b> ERF.H:419</div></div>
<div class="ttc" id="aclassERF_html_aff397ccf7eb99c51d7c705a35e85ec5f"><div class="ttname"><a href="classERF.html#aff397ccf7eb99c51d7c705a35e85ec5f">ERF::timeStep</a></div><div class="ttdeci">void timeStep(int lev, amrex::Real time, int iteration)</div><div class="ttdef"><b>Definition:</b> ERF_TimeStepping.cpp:10</div></div>
<div class="ttc" id="aclassERF_html_af25f70d7d9e4edeedcc40c117cc15505"><div class="ttname"><a href="classERF.html#af25f70d7d9e4edeedcc40c117cc15505">ERF::do_reflux</a></div><div class="ttdeci">static int do_reflux</div><div class="ttdef"><b>Definition:</b> ERF.H:533</div></div>
<div class="ttc" id="aclassERF_html_a0f074d984fb0a319cf7a781b2efc3d63"><div class="ttname"><a href="classERF.html#a0f074d984fb0a319cf7a781b2efc3d63">ERF::h_rayleigh_thetabar</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; amrex::Real &gt; &gt; h_rayleigh_thetabar</div><div class="ttdef"><b>Definition:</b> ERF.H:579</div></div>
<div class="ttc" id="aIndexDefines_8H_html_a6e1412fca31cbd35d0f50f12fcc70b0fad37e67db17cfd059f2852e2673b9e8ef"><div class="ttname"><a href="IndexDefines_8H.html#a6e1412fca31cbd35d0f50f12fcc70b0fad37e67db17cfd059f2852e2673b9e8ef">BC::inflow</a></div><div class="ttdeci">@ inflow</div></div>
<div class="ttc" id="aclassERF_html_a87dc6c0720462bfd088c909289cdca0b"><div class="ttname"><a href="classERF.html#a87dc6c0720462bfd088c909289cdca0b">ERF::ng_pres_hse</a></div><div class="ttdeci">static int ng_pres_hse</div><div class="ttdef"><b>Definition:</b> ERF.H:573</div></div>
<div class="ttc" id="aprob__common_8H_html_afef32e2116829d24b864c64caebf5ea6"><div class="ttname"><a href="prob__common_8H.html#afef32e2116829d24b864c64caebf5ea6">amrex_probinit</a></div><div class="ttdeci">void amrex_probinit(const amrex_real *problo, const amrex_real *probhi)</div></div>
<div class="ttc" id="anamespaceBCVars_html_a00367571247ba920989360b94c156f4aa3fd5e6f8378f1e1e80146b207c062cd8"><div class="ttname"><a href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa3fd5e6f8378f1e1e80146b207c062cd8">BCVars::RhoQKE_bc_comp</a></div><div class="ttdeci">@ RhoQKE_bc_comp</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:41</div></div>
<div class="ttc" id="aIndexDefines_8H_html_a8b9c5b827b61f426a3879bc5d2883040"><div class="ttname"><a href="IndexDefines_8H.html#a8b9c5b827b61f426a3879bc5d2883040">PrimTheta_comp</a></div><div class="ttdeci">#define PrimTheta_comp</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:23</div></div>
<div class="ttc" id="aclassERF_html_a7e2f504a37e9b721618d135030c7ae04"><div class="ttname"><a href="classERF.html#a7e2f504a37e9b721618d135030c7ae04">ERF::PlotFileVarNames</a></div><div class="ttdeci">amrex::Vector&lt; std::string &gt; PlotFileVarNames() const</div><div class="ttdef"><b>Definition:</b> Plotfile.cpp:138</div></div>
<div class="ttc" id="aclassERF_html_a0f5b892bf373e46ae54597683e0f9685"><div class="ttname"><a href="classERF.html#a0f5b892bf373e46ae54597683e0f9685">ERF::ComputeGhostCells</a></div><div class="ttdeci">AMREX_FORCE_INLINE int ComputeGhostCells(const int &amp;spatial_order)</div><div class="ttdef"><b>Definition:</b> ERF.H:619</div></div>
<div class="ttc" id="anamespacederived_html_af8efb799157f5dbb8fe00416458db9e1"><div class="ttname"><a href="namespacederived.html#af8efb799157f5dbb8fe00416458db9e1">derived::erf_dernull</a></div><div class="ttdeci">void erf_dernull(const amrex::Box &amp;, amrex::FArrayBox &amp;, int, int, const amrex::FArrayBox &amp;, const amrex::Geometry &amp;, amrex::Real, const int *, const int)</div><div class="ttdef"><b>Definition:</b> Derive.cpp:25</div></div>
<div class="ttc" id="anamespacederived_html_aa1fcac44ae779cdfa2fd5266bc206e2d"><div class="ttname"><a href="namespacederived.html#aa1fcac44ae779cdfa2fd5266bc206e2d">derived::erf_derKE</a></div><div class="ttdeci">void erf_derKE(const amrex::Box &amp;bx, amrex::FArrayBox &amp;derfab, int, int, const amrex::FArrayBox &amp;datfab, const amrex::Geometry &amp;, amrex::Real, const int *, const int)</div><div class="ttdef"><b>Definition:</b> Derive.cpp:135</div></div>
<div class="ttc" id="aclassERF_html_a9683c7b07c287e57856ee5a9c99917a1"><div class="ttname"><a href="classERF.html#a9683c7b07c287e57856ee5a9c99917a1">ERF::h_havg_temperature</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Real &gt; h_havg_temperature</div><div class="ttdef"><b>Definition:</b> ERF.H:586</div></div>
<div class="ttc" id="aclassERF_html_a3937527f96c81674fa38dc34ed24f3f5"><div class="ttname"><a href="classERF.html#a3937527f96c81674fa38dc34ed24f3f5">ERF::regrid_int</a></div><div class="ttdeci">int regrid_int</div><div class="ttdef"><b>Definition:</b> ERF.H:495</div></div>
<div class="ttc" id="anamespaceIntVar_html_ae96c1cd796f723e15dfbf718f1a9c76da9b94534904513cb3b68ef8b0c7bfed51"><div class="ttname"><a href="namespaceIntVar.html#ae96c1cd796f723e15dfbf718f1a9c76da9b94534904513cb3b68ef8b0c7bfed51">IntVar::zflux</a></div><div class="ttdeci">@ zflux</div><div class="ttdef"><b>Definition:</b> TimeIntegration.H:19</div></div>
<div class="ttc" id="aclassERF_html_aefa640a036c25b7b770e88a5f838eb2a"><div class="ttname"><a href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">ERF::istep</a></div><div class="ttdeci">amrex::Vector&lt; int &gt; istep</div><div class="ttdef"><b>Definition:</b> ERF.H:422</div></div>
<div class="ttc" id="astructSolverChoice_html_a4829661b558b213e32970a02e147077f"><div class="ttname"><a href="structSolverChoice.html#a4829661b558b213e32970a02e147077f">SolverChoice::init_params</a></div><div class="ttdeci">void init_params()</div><div class="ttdef"><b>Definition:</b> DataStruct.H:63</div></div>
<div class="ttc" id="aclassERF_html_a7ba9c9e09efe07e5f2404be80a9af5d2"><div class="ttname"><a href="classERF.html#a7ba9c9e09efe07e5f2404be80a9af5d2">ERF::FillCoarsePatch</a></div><div class="ttdeci">void FillCoarsePatch(int lev, amrex::Real time, amrex::MultiFab &amp;mf, int icomp, int ncomp, int var_idx)</div><div class="ttdef"><b>Definition:</b> ERF_FillPatch.cpp:344</div></div>
<div class="ttc" id="aDataStruct_8H_html_a4a079f2650ca30c787a8375ec5f17ca5abdeb9a753db1d1f3fe0e944eab1d0601"><div class="ttname"><a href="DataStruct_8H.html#a4a079f2650ca30c787a8375ec5f17ca5abdeb9a753db1d1f3fe0e944eab1d0601">PBLType::MYNN25</a></div><div class="ttdeci">@ MYNN25</div></div>
<div class="ttc" id="aclassERF_html_a62a5ed3c3806eaa918257e0ad1382df5"><div class="ttname"><a href="classERF.html#a62a5ed3c3806eaa918257e0ad1382df5">ERF::ComputeDt</a></div><div class="ttdeci">void ComputeDt()</div><div class="ttdef"><b>Definition:</b> ERF_ComputeTimestep.cpp:8</div></div>
<div class="ttc" id="aclassERF_html_a83572d8dfad51158945b4a5ab06b2f72"><div class="ttname"><a href="classERF.html#a83572d8dfad51158945b4a5ab06b2f72">ERF::input_sounding_data</a></div><div class="ttdeci">InputSoundingData input_sounding_data</div><div class="ttdef"><b>Definition:</b> ERF.H:372</div></div>
<div class="ttc" id="aclassERF_html_a4615db015b395b3a44f1fbf6d6e4fe43"><div class="ttname"><a href="classERF.html#a4615db015b395b3a44f1fbf6d6e4fe43">ERF::coupling_type</a></div><div class="ttdeci">static std::string coupling_type</div><div class="ttdef"><b>Definition:</b> ERF.H:532</div></div>
<div class="ttc" id="aclassERF_html_ab10bfe15c2d15fdd22201b64722a4022"><div class="ttname"><a href="classERF.html#ab10bfe15c2d15fdd22201b64722a4022">ERF::column_loc_x</a></div><div class="ttdeci">static amrex::Real column_loc_x</div><div class="ttdef"><b>Definition:</b> ERF.H:559</div></div>
<div class="ttc" id="aclassERF_html_a67da556b4b4cbdc891da06eb5e17aac8"><div class="ttname"><a href="classERF.html#a67da556b4b4cbdc891da06eb5e17aac8">ERF::setupABLMost</a></div><div class="ttdeci">void setupABLMost(int lev)</div><div class="ttdef"><b>Definition:</b> ERF.cpp:1001</div></div>
<div class="ttc" id="aclassERF_html_abe64c2ff781da4cc0642ee1d29c912d6"><div class="ttname"><a href="classERF.html#abe64c2ff781da4cc0642ee1d29c912d6">ERF::plot_int</a></div><div class="ttdeci">int plot_int</div><div class="ttdef"><b>Definition:</b> ERF.H:500</div></div>
<div class="ttc" id="aclassERF_html_a58f6683aff0fbe6949bfe8b49275a8b3"><div class="ttname"><a href="classERF.html#a58f6683aff0fbe6949bfe8b49275a8b3">ERF::post_timestep</a></div><div class="ttdeci">void post_timestep(int nstep, amrex::Real time, amrex::Real dt_lev)</div><div class="ttdef"><b>Definition:</b> ERF.cpp:243</div></div>
<div class="ttc" id="aclassERF_html_a879501e88824fa6a00ffe1509059b21e"><div class="ttname"><a href="classERF.html#a879501e88824fa6a00ffe1509059b21e">ERF::d_rayleigh_vbar</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Gpu::DeviceVector&lt; amrex::Real &gt; &gt; d_rayleigh_vbar</div><div class="ttdef"><b>Definition:</b> ERF.H:582</div></div>
<div class="ttc" id="aclassERF_html_a2cdc63885e5fec54f89cdcaffcbdc188"><div class="ttname"><a href="classERF.html#a2cdc63885e5fec54f89cdcaffcbdc188">ERF::volWgtSumMF</a></div><div class="ttdeci">amrex::Real volWgtSumMF(int lev, const amrex::MultiFab &amp;mf, int comp, bool local, bool finemask)</div><div class="ttdef"><b>Definition:</b> ERF_SumIQ.cpp:71</div></div>
<div class="ttc" id="aTerrainMetrics_8H_html_adcaa7dd1b91191b54eb2f59a4cbb567b"><div class="ttname"><a href="TerrainMetrics_8H.html#adcaa7dd1b91191b54eb2f59a4cbb567b">ComputeMetricAtJface</a></div><div class="ttdeci">AMREX_GPU_DEVICE void ComputeMetricAtJface(const int &amp;i, const int &amp;j, const int &amp;k, amrex::Real &amp;met_h_xi, amrex::Real &amp;met_h_eta, amrex::Real &amp;met_h_zeta, const amrex::GpuArray&lt; amrex::Real, AMREX_SPACEDIM &gt; &amp;cellSizeInv, const amrex::Array4&lt; const amrex::Real &gt; &amp;z_nd, const int flag)</div><div class="ttdef"><b>Definition:</b> TerrainMetrics.H:193</div></div>
<div class="ttc" id="aclassERF_html_a8a99e22b1111c803e31b4afd5fcdea60"><div class="ttname"><a href="classERF.html#a8a99e22b1111c803e31b4afd5fcdea60">ERF::domain_bcs_type_d</a></div><div class="ttdeci">amrex::Gpu::DeviceVector&lt; amrex::BCRec &gt; domain_bcs_type_d</div><div class="ttdef"><b>Definition:</b> ERF.H:457</div></div>
<div class="ttc" id="aERF__Constants_8H_html_ae8ca591ba2325c0ad8b464de45f4c6b3"><div class="ttname"><a href="ERF__Constants_8H.html#ae8ca591ba2325c0ad8b464de45f4c6b3">Gamma</a></div><div class="ttdeci">#define Gamma</div><div class="ttdef"><b>Definition:</b> ERF_Constants.H:12</div></div>
<div class="ttc" id="aIndexDefines_8H_html_ad5195ac8f863f5a9a7eaa0db094f7639"><div class="ttname"><a href="IndexDefines_8H.html#ad5195ac8f863f5a9a7eaa0db094f7639">NVAR</a></div><div class="ttdeci">#define NVAR</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:19</div></div>
<div class="ttc" id="aclassERF_html_a530d2ce59e6fd46e9fb00e4d11eaf737"><div class="ttname"><a href="classERF.html#a530d2ce59e6fd46e9fb00e4d11eaf737">ERF::restart</a></div><div class="ttdeci">void restart()</div><div class="ttdef"><b>Definition:</b> ERF.cpp:448</div></div>
<div class="ttc" id="anamespaceCons_html_ab92931555eff5e3d0d9eb62ae0225cc1a7ba34ebd02f164da2892ceb823948315"><div class="ttname"><a href="namespaceCons.html#ab92931555eff5e3d0d9eb62ae0225cc1a7ba34ebd02f164da2892ceb823948315">Cons::RhoTheta</a></div><div class="ttdeci">@ RhoTheta</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:78</div></div>
<div class="ttc" id="aclassERF_html_a536424e14c4139e4683b15c59e742362"><div class="ttname"><a href="classERF.html#a536424e14c4139e4683b15c59e742362">ERF::input_sounding_file</a></div><div class="ttdeci">static std::string input_sounding_file</div><div class="ttdef"><b>Definition:</b> ERF.H:553</div></div>
<div class="ttc" id="aclassERF_html_a4c992f63bcc9d7e7693990bf046bfc4b"><div class="ttname"><a href="classERF.html#a4c992f63bcc9d7e7693990bf046bfc4b">ERF::d_rayleigh_thetabar</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Gpu::DeviceVector&lt; amrex::Real &gt; &gt; d_rayleigh_thetabar</div><div class="ttdef"><b>Definition:</b> ERF.H:583</div></div>
<div class="ttc" id="aclassERF_html_a35360b65d1afd233a6e6461938fa4522"><div class="ttname"><a href="classERF.html#a35360b65d1afd233a6e6461938fa4522">ERF::bdy_data_xlo</a></div><div class="ttdeci">amrex::Vector&lt; amrex::FArrayBox &gt; bdy_data_xlo</div><div class="ttdef"><b>Definition:</b> ERF.H:374</div></div>
<div class="ttc" id="aclassERF_html_aa3db2dd1b65310c66c4038650c22aaee"><div class="ttname"><a href="classERF.html#aa3db2dd1b65310c66c4038650c22aaee">ERF::nsubsteps</a></div><div class="ttdeci">amrex::Vector&lt; int &gt; nsubsteps</div><div class="ttdef"><b>Definition:</b> ERF.H:423</div></div>
<div class="ttc" id="anamespacederived_html_ab3c82aef26b750dfedc3d29ca9fae7e3"><div class="ttname"><a href="namespacederived.html#ab3c82aef26b750dfedc3d29ca9fae7e3">derived::erf_dertemp</a></div><div class="ttdeci">void erf_dertemp(const amrex::Box &amp;bx, amrex::FArrayBox &amp;derfab, int, int, const amrex::FArrayBox &amp;datfab, const amrex::Geometry &amp;, amrex::Real, const int *, const int)</div><div class="ttdef"><b>Definition:</b> Derive.cpp:83</div></div>
<div class="ttc" id="aERF__slow__rhs_8cpp_html_aeb90f678958be8a571b087d0b61f93b6"><div class="ttname"><a href="ERF__slow__rhs_8cpp.html#aeb90f678958be8a571b087d0b61f93b6">erf_slow_rhs</a></div><div class="ttdeci">void erf_slow_rhs(int level, Vector&lt; MultiFab &gt; &amp;S_rhs, const Vector&lt; MultiFab &gt; &amp;S_data, const MultiFab &amp;S_prim, Vector&lt; MultiFab &gt; &amp;S_scratch, const MultiFab &amp;xvel, const MultiFab &amp;yvel, const MultiFab &amp;zvel, MultiFab &amp;source, std::array&lt; MultiFab, AMREX_SPACEDIM &gt; &amp;advflux, std::array&lt; MultiFab, AMREX_SPACEDIM &gt; &amp;diffflux, const amrex::Geometry geom, amrex::InterpFaceRegister *ifr, const SolverChoice &amp;solverChoice, std::unique_ptr&lt; ABLMost &gt; &amp;most, const Gpu::DeviceVector&lt; amrex::BCRec &gt; domain_bcs_type_d, const amrex::Real *dptr_dens_hse, const amrex::Real *dptr_pres_hse, const amrex::Real *dptr_rayleigh_tau, const amrex::Real *dptr_rayleigh_ubar, const amrex::Real *dptr_rayleigh_vbar, const amrex::Real *dptr_rayleigh_thetabar, const int rhs_vars)</div><div class="ttdef"><b>Definition:</b> ERF_slow_rhs.cpp:21</div></div>
<div class="ttc" id="aIndexDefines_8H_html_a28f96fd04e1ff08fa7a8f53ccde0f877"><div class="ttname"><a href="IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a></div><div class="ttdeci">#define RhoTheta_comp</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:9</div></div>
<div class="ttc" id="aclassERF_html_a5232e98479611a24fe97994640c61faa"><div class="ttname"><a href="classERF.html#a5232e98479611a24fe97994640c61faa">ERF::sum_interval</a></div><div class="ttdeci">static int sum_interval</div><div class="ttdef"><b>Definition:</b> ERF.H:537</div></div>
<div class="ttc" id="anamespaceERFBCType_html_a40fbdd5a379a92debb4bcaaccac6e01ca4a8d85af949a1ce567934e55c69c2846"><div class="ttname"><a href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4a8d85af949a1ce567934e55c69c2846">ERFBCType::foextrap</a></div><div class="ttdeci">@ foextrap</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:135</div></div>
<div class="ttc" id="aclassERF_html_adc00038dfe4c332e5d15f621184c69e8"><div class="ttname"><a href="classERF.html#adc00038dfe4c332e5d15f621184c69e8">ERF::plot_file_on_restart</a></div><div class="ttdeci">int plot_file_on_restart</div><div class="ttdef"><b>Definition:</b> ERF.H:470</div></div>
<div class="ttc" id="aclassERF_html_ac81b3dfd7c6f21ba8479834e2ff1e652"><div class="ttname"><a href="classERF.html#ac81b3dfd7c6f21ba8479834e2ff1e652">ERF::ref_tags</a></div><div class="ttdeci">static amrex::Vector&lt; amrex::AMRErrorTag &gt; ref_tags</div><div class="ttdef"><b>Definition:</b> ERF.H:609</div></div>
<div class="ttc" id="aclassERF_html_a1cade630b005dbcc0f644987ef3db287"><div class="ttname"><a href="classERF.html#a1cade630b005dbcc0f644987ef3db287">ERF::datalog</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; std::fstream &gt; &gt; datalog</div><div class="ttdef"><b>Definition:</b> ERF.H:697</div></div>
<div class="ttc" id="astructTimeInterpolatedData_html_a39ab53c6a67f3b87c895483a89e2fc0f"><div class="ttname"><a href="structTimeInterpolatedData.html#a39ab53c6a67f3b87c895483a89e2fc0f">TimeInterpolatedData::non_owning</a></div><div class="ttdeci">const int non_owning</div><div class="ttdef"><b>Definition:</b> TimeInterpolatedData.H:50</div></div>
<div class="ttc" id="aclassERF_html_a20350959b7b3e252ee3a802e7998ca8d"><div class="ttname"><a href="classERF.html#a20350959b7b3e252ee3a802e7998ca8d">ERF::d_havg_temperature</a></div><div class="ttdeci">amrex::Gpu::DeviceVector&lt; amrex::Real &gt; d_havg_temperature</div><div class="ttdef"><b>Definition:</b> ERF.H:593</div></div>
<div class="ttc" id="aclassERF_html_aa30dffc28e24ac50c880539ca2e36ffd"><div class="ttname"><a href="classERF.html#aa30dffc28e24ac50c880539ca2e36ffd">ERF::fixed_fast_dt</a></div><div class="ttdeci">static amrex::Real fixed_fast_dt</div><div class="ttdef"><b>Definition:</b> ERF.H:489</div></div>
<div class="ttc" id="aclassERF_html_a6e9d302b096a12999c8ff4a6bfa9a072"><div class="ttname"><a href="classERF.html#a6e9d302b096a12999c8ff4a6bfa9a072">ERF::fixed_dt</a></div><div class="ttdeci">static amrex::Real fixed_dt</div><div class="ttdef"><b>Definition:</b> ERF.H:488</div></div>
<div class="ttc" id="aclassERF_html_a3cf7cb2e51eb7b69cb4079ffc6722459"><div class="ttname"><a href="classERF.html#a3cf7cb2e51eb7b69cb4079ffc6722459">ERF::dt_mri_ratio</a></div><div class="ttdeci">amrex::Vector&lt; long &gt; dt_mri_ratio</div><div class="ttdef"><b>Definition:</b> ERF.H:429</div></div>
<div class="ttc" id="anamespaceBCVars_html_a00367571247ba920989360b94c156f4aa029ef491930290dea3a984ebdb6d6ae4"><div class="ttname"><a href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa029ef491930290dea3a984ebdb6d6ae4">BCVars::RhoScalar_bc_comp</a></div><div class="ttdeci">@ RhoScalar_bc_comp</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:42</div></div>
<div class="ttc" id="astructSolverChoice_html_a0a031373331c9aca22a47b0995729f46"><div class="ttname"><a href="structSolverChoice.html#a0a031373331c9aca22a47b0995729f46">SolverChoice::pbl_type</a></div><div class="ttdeci">PBLType pbl_type</div><div class="ttdef"><b>Definition:</b> DataStruct.H:359</div></div>
<div class="ttc" id="aclassMRISplitIntegrator_html"><div class="ttname"><a href="classMRISplitIntegrator.html">MRISplitIntegrator</a></div><div class="ttdef"><b>Definition:</b> ERF_MRI.H:11</div></div>
<div class="ttc" id="aclassERF_html_a99757524a49a79368069f66f71797c9d"><div class="ttname"><a href="classERF.html#a99757524a49a79368069f66f71797c9d">ERF::nc_init_file</a></div><div class="ttdeci">static amrex::Vector&lt; amrex::Vector&lt; std::string &gt; &gt; nc_init_file</div><div class="ttdef"><b>Definition:</b> ERF.H:547</div></div>
<div class="ttc" id="aclassERF_html_aa3151f4f965fcd44456952f69a9c28fc"><div class="ttname"><a href="classERF.html#aa3151f4f965fcd44456952f69a9c28fc">ERF::erf_advance</a></div><div class="ttdeci">void erf_advance(int level, amrex::MultiFab &amp;cons_old, amrex::MultiFab &amp;cons_new, amrex::MultiFab &amp;xvel_old, amrex::MultiFab &amp;yvel_old, amrex::MultiFab &amp;zvel_old, amrex::MultiFab &amp;xvel_new, amrex::MultiFab &amp;yvel_new, amrex::MultiFab &amp;zvel_new, amrex::MultiFab &amp;xmom_crse, amrex::MultiFab &amp;ymom_crse, amrex::MultiFab &amp;zmom_crse, amrex::MultiFab &amp;source, std::array&lt; amrex::MultiFab, AMREX_SPACEDIM &gt; &amp;flux, const amrex::Geometry fine_geom, const amrex::Real dt, const amrex::Real time, amrex::InterpFaceRegister *ifr, const amrex::Real *dptr_dens_hse, const amrex::Real *dptr_pres_hse, const amrex::Real *dptr_rayleigh_tau, const amrex::Real *dptr_rayleigh_ubar, const amrex::Real *dptr_rayleigh_vbar, const amrex::Real *dptr_rayleigh_thetabar)</div><div class="ttdef"><b>Definition:</b> TimeIntegration_driver.cpp:12</div></div>
<div class="ttc" id="aIndexDefines_8H_html_a6e1412fca31cbd35d0f50f12fcc70b0fa40e712f30d56083318ab20a2402921d2"><div class="ttname"><a href="IndexDefines_8H.html#a6e1412fca31cbd35d0f50f12fcc70b0fa40e712f30d56083318ab20a2402921d2">BC::symmetry</a></div><div class="ttdeci">@ symmetry</div></div>
<div class="ttc" id="aDataStruct_8H_html_aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1"><div class="ttname"><a href="DataStruct_8H.html#aa307030d99f8c225e1a1adb20224ed36a7f80fcc452c2f1ed2bb51b39d0864df1">IC_BC_Type::Real</a></div><div class="ttdeci">@ Real</div></div>
<div class="ttc" id="aclassERF_html_a30a1b51c733c3a20dc6948f9a3620bbb"><div class="ttname"><a href="classERF.html#a30a1b51c733c3a20dc6948f9a3620bbb">ERF::column_loc_y</a></div><div class="ttdeci">static amrex::Real column_loc_y</div><div class="ttdef"><b>Definition:</b> ERF.H:560</div></div>
<div class="ttc" id="anamespaceBCVars_html_a00367571247ba920989360b94c156f4aa1556c0a3817c6fab60fbb6952cf0124f"><div class="ttname"><a href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa1556c0a3817c6fab60fbb6952cf0124f">BCVars::RhoKE_bc_comp</a></div><div class="ttdeci">@ RhoKE_bc_comp</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:40</div></div>
<div class="ttc" id="anamespacederived_html_ae13ef28ab10c6102bf43c9a7fbe99f35"><div class="ttname"><a href="namespacederived.html#ae13ef28ab10c6102bf43c9a7fbe99f35">derived::erf_dersoundspeed</a></div><div class="ttdeci">void erf_dersoundspeed(const amrex::Box &amp;bx, amrex::FArrayBox &amp;derfab, int, int, const amrex::FArrayBox &amp;datfab, const amrex::Geometry &amp;, amrex::Real, const int *, const int)</div><div class="ttdef"><b>Definition:</b> Derive.cpp:61</div></div>
<div class="ttc" id="anamespaceVars_html_a2aa680f90abb6ff6d5c1875f8beb4b1caa92727db248ec616aa835c2faa22f44c"><div class="ttname"><a href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1caa92727db248ec616aa835c2faa22f44c">Vars::ymom</a></div><div class="ttdeci">@ ymom</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:70</div></div>
<div class="ttc" id="anamespaceERFBCType_html_a40fbdd5a379a92debb4bcaaccac6e01ca41cecdb4487b15207675ae9ee564e705"><div class="ttname"><a href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca41cecdb4487b15207675ae9ee564e705">ERFBCType::reflect_odd</a></div><div class="ttdeci">@ reflect_odd</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:132</div></div>
<div class="ttc" id="anamespaceIntVar_html_ae96c1cd796f723e15dfbf718f1a9c76da22501eeeb48d3d47f802dcb78c88f7ae"><div class="ttname"><a href="namespaceIntVar.html#ae96c1cd796f723e15dfbf718f1a9c76da22501eeeb48d3d47f802dcb78c88f7ae">IntVar::cons</a></div><div class="ttdeci">@ cons</div><div class="ttdef"><b>Definition:</b> TimeIntegration.H:13</div></div>
<div class="ttc" id="aclassERF_html_a419ba9adca32073e70aae4a8fe8cfcee"><div class="ttname"><a href="classERF.html#a419ba9adca32073e70aae4a8fe8cfcee">ERF::build_fine_mask</a></div><div class="ttdeci">amrex::MultiFab &amp; build_fine_mask(int lev)</div><div class="ttdef"><b>Definition:</b> ERF_SumIQ.cpp:101</div></div>
<div class="ttc" id="aclassERF_html_a7c448670f7a5cadd6fe56f7e615c9eb6"><div class="ttname"><a href="classERF.html#a7c448670f7a5cadd6fe56f7e615c9eb6">ERF::output_bndry_planes</a></div><div class="ttdeci">static int output_bndry_planes</div><div class="ttdef"><b>Definition:</b> ERF.H:564</div></div>
<div class="ttc" id="aclassERF_html_a0634154e8e58379c495c3e7fe7c5e4d6"><div class="ttname"><a href="classERF.html#a0634154e8e58379c495c3e7fe7c5e4d6">ERF::max_step</a></div><div class="ttdeci">int max_step</div><div class="ttdef"><b>Definition:</b> ERF.H:476</div></div>
<div class="ttc" id="anamespaceIntVar_html_ae96c1cd796f723e15dfbf718f1a9c76dad22d96cf9b7b4dd875cea33d3ec0b481"><div class="ttname"><a href="namespaceIntVar.html#ae96c1cd796f723e15dfbf718f1a9c76dad22d96cf9b7b4dd875cea33d3ec0b481">IntVar::xmom</a></div><div class="ttdeci">@ xmom</div><div class="ttdef"><b>Definition:</b> TimeIntegration.H:14</div></div>
<div class="ttc" id="aclassERF_html_a4dd7c603e65d230105a4f1e0afb4cf8a"><div class="ttname"><a href="classERF.html#a4dd7c603e65d230105a4f1e0afb4cf8a">ERF::h_havg_density</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Real &gt; h_havg_density</div><div class="ttdef"><b>Definition:</b> ERF.H:585</div></div>
<div class="ttc" id="aclassERF_html_a2f2ea7f5eeeb3634944550e5a1de8f7a"><div class="ttname"><a href="classERF.html#a2f2ea7f5eeeb3634944550e5a1de8f7a">ERF::velocity_names</a></div><div class="ttdeci">const amrex::Vector&lt; std::string &gt; velocity_names</div><div class="ttdef"><b>Definition:</b> ERF.H:509</div></div>
<div class="ttc" id="aIndexDefines_8H_html_ae15721db2cb4c2ab4732afe226bbba64"><div class="ttname"><a href="IndexDefines_8H.html#ae15721db2cb4c2ab4732afe226bbba64">RhoKE_comp</a></div><div class="ttdeci">#define RhoKE_comp</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:10</div></div>
<div class="ttc" id="aclassERF_html_aa30548378350788543d15076cdcd404d"><div class="ttname"><a href="classERF.html#aa30548378350788543d15076cdcd404d">ERF::init_shrink</a></div><div class="ttdeci">static amrex::Real init_shrink</div><div class="ttdef"><b>Definition:</b> ERF.H:484</div></div>
<div class="ttc" id="anamespacederived_html_a2d9c0cabf04515367f2b721320dcddab"><div class="ttname"><a href="namespacederived.html#a2d9c0cabf04515367f2b721320dcddab">derived::erf_derscalar</a></div><div class="ttdeci">void erf_derscalar(const amrex::Box &amp;bx, amrex::FArrayBox &amp;derfab, int, int, const amrex::FArrayBox &amp;datfab, const amrex::Geometry &amp;, amrex::Real, const int *, const int)</div><div class="ttdef"><b>Definition:</b> Derive.cpp:120</div></div>
<div class="ttc" id="anamespaceVars_html_a2aa680f90abb6ff6d5c1875f8beb4b1ca48ee63b17bc216e9661511c33c68bd8b"><div class="ttname"><a href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a></div><div class="ttdeci">@ zvel</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:67</div></div>
<div class="ttc" id="aclassERF_html_aa90c9756f684404f8b69b8a23568b535"><div class="ttname"><a href="classERF.html#aa90c9756f684404f8b69b8a23568b535">ERF::refinement_criteria_setup</a></div><div class="ttdeci">void refinement_criteria_setup()</div><div class="ttdef"><b>Definition:</b> ERF_Tagging.cpp:23</div></div>
<div class="ttc" id="aclassERF_html_ae701564fbe3da5bbd88587e5a08eca4e"><div class="ttname"><a href="classERF.html#ae701564fbe3da5bbd88587e5a08eca4e">ERF::check_file</a></div><div class="ttdeci">std::string check_file</div><div class="ttdef"><b>Definition:</b> ERF.H:503</div></div>
<div class="ttc" id="aclassERF_html_ac1238c1616826c66df1dfd9076e6a3da"><div class="ttname"><a href="classERF.html#ac1238c1616826c66df1dfd9076e6a3da">ERF::NumDataLogs</a></div><div class="ttdeci">AMREX_FORCE_INLINE int NumDataLogs() noexcept</div><div class="ttdef"><b>Definition:</b> ERF.H:661</div></div>
<div class="ttc" id="aclassERF_html_a5cafd68de724845533efea8d284aacb4"><div class="ttname"><a href="classERF.html#a5cafd68de724845533efea8d284aacb4">ERF::getCPUTime</a></div><div class="ttdeci">amrex::Real getCPUTime() const</div><div class="ttdef"><b>Definition:</b> ERF.H:670</div></div>
<div class="ttc" id="anamespaceBCVars_html_a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1"><div class="ttname"><a href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a></div><div class="ttdeci">@ RhoTheta_bc_comp</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:39</div></div>
<div class="ttc" id="anamespaceIntVar_html_ae96c1cd796f723e15dfbf718f1a9c76da21245d0eca9226a6441feac35602c9be"><div class="ttname"><a href="namespaceIntVar.html#ae96c1cd796f723e15dfbf718f1a9c76da21245d0eca9226a6441feac35602c9be">IntVar::xflux</a></div><div class="ttdeci">@ xflux</div><div class="ttdef"><b>Definition:</b> TimeIntegration.H:17</div></div>
<div class="ttc" id="aclassERF_html_ae52fe861ffb051a11920238c8210d69f"><div class="ttname"><a href="classERF.html#ae52fe861ffb051a11920238c8210d69f">ERF::cfl</a></div><div class="ttdeci">static amrex::Real cfl</div><div class="ttdef"><b>Definition:</b> ERF.H:483</div></div>
<div class="ttc" id="aclassERF_html_afa0bef6d3146788302b81c0d4f4802d1"><div class="ttname"><a href="classERF.html#afa0bef6d3146788302b81c0d4f4802d1">ERF::column_interval</a></div><div class="ttdeci">static int column_interval</div><div class="ttdef"><b>Definition:</b> ERF.H:557</div></div>
<div class="ttc" id="anamespaceVars_html_a2aa680f90abb6ff6d5c1875f8beb4b1ca2a10a6e726515894b07621908abd4c0c"><div class="ttname"><a href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca2a10a6e726515894b07621908abd4c0c">Vars::xvel</a></div><div class="ttdeci">@ xvel</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:65</div></div>
<div class="ttc" id="anamespaceCons_html_ab92931555eff5e3d0d9eb62ae0225cc1a5934ebcc17d4dfd56ed8cf6221c9a5ed"><div class="ttname"><a href="namespaceCons.html#ab92931555eff5e3d0d9eb62ae0225cc1a5934ebcc17d4dfd56ed8cf6221c9a5ed">Cons::NumVars</a></div><div class="ttdeci">@ NumVars</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:86</div></div>
<div class="ttc" id="aIndexDefines_8H_html_a0296f21cd48e5d8236c62ae4ce319b2f"><div class="ttname"><a href="IndexDefines_8H.html#a0296f21cd48e5d8236c62ae4ce319b2f">RhoScalar_comp</a></div><div class="ttdeci">#define RhoScalar_comp</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:12</div></div>
<div class="ttc" id="aclassERF_html_a9fedd41de89817a23b1c3b3c6ef7443f"><div class="ttname"><a href="classERF.html#a9fedd41de89817a23b1c3b3c6ef7443f">ERF::column_per</a></div><div class="ttdeci">static amrex::Real column_per</div><div class="ttdef"><b>Definition:</b> ERF.H:558</div></div>
<div class="ttc" id="aclassERF_html_a1f48ec3caf326a6b1b986d061d36ee90"><div class="ttname"><a href="classERF.html#a1f48ec3caf326a6b1b986d061d36ee90">ERF::check_int</a></div><div class="ttdeci">int check_int</div><div class="ttdef"><b>Definition:</b> ERF.H:505</div></div>
<div class="ttc" id="astructSolverChoice_html_a47a54f2e44955202b5b437e4b1b4a61b"><div class="ttname"><a href="structSolverChoice.html#a47a54f2e44955202b5b437e4b1b4a61b">SolverChoice::gravity</a></div><div class="ttdeci">amrex::Real gravity</div><div class="ttdef"><b>Definition:</b> DataStruct.H:324</div></div>
<div class="ttc" id="aclassERF_html_a32e0d0f5ae0db18ee81f9d4325a14f64"><div class="ttname"><a href="classERF.html#a32e0d0f5ae0db18ee81f9d4325a14f64">ERF::check_type</a></div><div class="ttdeci">std::string check_type</div><div class="ttdef"><b>Definition:</b> ERF.H:504</div></div>
<div class="ttc" id="aclassERF_html_a1204ca4dc5d79f5da191ffbe09dfab9b"><div class="ttname"><a href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">ERF::vars_new</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; amrex::MultiFab &gt; &gt; vars_new</div><div class="ttdef"><b>Definition:</b> ERF.H:433</div></div>
<div class="ttc" id="aclassERF_html_a922892a05ee0c5bccd210a3e5a8599e1"><div class="ttname"><a href="classERF.html#a922892a05ee0c5bccd210a3e5a8599e1">ERF::sum_integrated_quantities</a></div><div class="ttdeci">void sum_integrated_quantities(amrex::Real time)</div><div class="ttdef"><b>Definition:</b> ERF_SumIQ.cpp:8</div></div>
<div class="ttc" id="aclassERF_html_ad34bae243fdb6c3029f5abe4fb4bca2d"><div class="ttname"><a href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">ERF::dt</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Real &gt; dt</div><div class="ttdef"><b>Definition:</b> ERF.H:428</div></div>
<div class="ttc" id="aclassERF_html_a9248a4eb025c2647e003f838cba52a21"><div class="ttname"><a href="classERF.html#a9248a4eb025c2647e003f838cba52a21">ERF::datalogname</a></div><div class="ttdeci">amrex::Vector&lt; std::string &gt; datalogname</div><div class="ttdef"><b>Definition:</b> ERF.H:698</div></div>
<div class="ttc" id="aEOS_8H_html_a292ce90ab26c75f4a444808a807b532b"><div class="ttname"><a href="EOS_8H.html#a292ce90ab26c75f4a444808a807b532b">getPgivenRTh</a></div><div class="ttdeci">AMREX_GPU_HOST_DEVICE AMREX_FORCE_INLINE amrex::Real getPgivenRTh(const amrex::Real rhotheta)</div><div class="ttdef"><b>Definition:</b> EOS.H:23</div></div>
<div class="ttc" id="anamespacederived_html_ab144cda2ef3e2bd18cbd0837ce723521"><div class="ttname"><a href="namespacederived.html#ab144cda2ef3e2bd18cbd0837ce723521">derived::erf_derpres</a></div><div class="ttdeci">void erf_derpres(const amrex::Box &amp;bx, amrex::FArrayBox &amp;derfab, int, int, const amrex::FArrayBox &amp;datfab, const amrex::Geometry &amp;, amrex::Real, const int *, const int)</div><div class="ttdef"><b>Definition:</b> Derive.cpp:40</div></div>
<div class="ttc" id="aclassERF_html_a4a279f0f572da168852d954df55abe2e"><div class="ttname"><a href="classERF.html#a4a279f0f572da168852d954df55abe2e">ERF::use_native_mri</a></div><div class="ttdeci">static int use_native_mri</div><div class="ttdef"><b>Definition:</b> ERF.H:529</div></div>
<div class="ttc" id="aclassERF_html_ad4c61fad53912d1e8d0f774d365bcf0f"><div class="ttname"><a href="classERF.html#ad4c61fad53912d1e8d0f774d365bcf0f">ERF::is_it_time_for_action</a></div><div class="ttdeci">bool is_it_time_for_action(int nstep, amrex::Real time, amrex::Real dt, int action_interval, amrex::Real action_per)</div><div class="ttdef"><b>Definition:</b> ERF_SumIQ.cpp:138</div></div>
<div class="ttc" id="astructTimeInterpolatedData_html_a0d6dcefbf7407a24669d2a37c7f558d4"><div class="ttname"><a href="structTimeInterpolatedData.html#a0d6dcefbf7407a24669d2a37c7f558d4">TimeInterpolatedData::set_time</a></div><div class="ttdeci">void set_time(amrex::Real time)</div><div class="ttdef"><b>Definition:</b> TimeInterpolatedData.H:17</div></div>
<div class="ttc" id="aclassERF_html_abed910c4bcc14524b3c1a7d353d40de5"><div class="ttname"><a href="classERF.html#abed910c4bcc14524b3c1a7d353d40de5">ERF::WritePlotFile</a></div><div class="ttdeci">void WritePlotFile()</div><div class="ttdef"><b>Definition:</b> Plotfile.cpp:151</div></div>
<div class="ttc" id="aclassERF_html_a7990255d32f7bca694acab7521101b93"><div class="ttname"><a href="classERF.html#a7990255d32f7bca694acab7521101b93">ERF::d_pres_hse</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Gpu::DeviceVector&lt; amrex::Real &gt; &gt; d_pres_hse</div><div class="ttdef"><b>Definition:</b> ERF.H:447</div></div>
<div class="ttc" id="astructInputSoundingData_html_a6c176f22c90b76170e1fa254d4583de3"><div class="ttname"><a href="structInputSoundingData.html#a6c176f22c90b76170e1fa254d4583de3">InputSoundingData::read_from_file</a></div><div class="ttdeci">void read_from_file(const std::string input_sounding_file)</div><div class="ttdef"><b>Definition:</b> DataStruct.H:395</div></div>
<div class="ttc" id="aSpatialStencils_8H_html_afc02a222736ea1f0219b287fb472a765"><div class="ttname"><a href="SpatialStencils_8H.html#afc02a222736ea1f0219b287fb472a765">VelocityToMomentum</a></div><div class="ttdeci">void VelocityToMomentum(const amrex::MultiFab &amp;xvel_in, const amrex::IntVect &amp;xvel_ngrow, const amrex::MultiFab &amp;yvel_in, const amrex::IntVect &amp;yvel_ngrow, const amrex::MultiFab &amp;zvel_in, const amrex::IntVect &amp;zvel_ngrow, const amrex::MultiFab &amp;cons_in, amrex::MultiFab &amp;xmom_out, amrex::MultiFab &amp;ymom_out, amrex::MultiFab &amp;zmom_out)</div></div>
<div class="ttc" id="aERF__fast__rhs_8cpp_html_a18222666585d1c3a0c934fc2fadcfd48"><div class="ttname"><a href="ERF__fast__rhs_8cpp.html#a18222666585d1c3a0c934fc2fadcfd48">erf_fast_rhs</a></div><div class="ttdeci">void erf_fast_rhs(int level, Vector&lt; MultiFab &gt; &amp;S_rhs, Vector&lt; MultiFab &gt; &amp;S_slow_rhs, Vector&lt; MultiFab &gt; &amp;S_stage_data, const MultiFab &amp;S_stage_prim, const Vector&lt; MultiFab &gt; &amp;S_data, Vector&lt; MultiFab &gt; &amp;S_scratch, std::array&lt; MultiFab, AMREX_SPACEDIM &gt; &amp;advflux, const amrex::Geometry geom, amrex::InterpFaceRegister *ifr, const SolverChoice &amp;solverChoice, const amrex::Real *dptr_dens_hse, const amrex::Real *dptr_pres_hse, const amrex::Real dtau, const amrex::Real facinv)</div><div class="ttdef"><b>Definition:</b> ERF_fast_rhs.cpp:18</div></div>
<div class="ttc" id="aclassERF_html_ad02c77d3f4a7dfa0ad679877f0f05fc1"><div class="ttname"><a href="classERF.html#ad02c77d3f4a7dfa0ad679877f0f05fc1">ERF::plot_file</a></div><div class="ttdeci">std::string plot_file</div><div class="ttdef"><b>Definition:</b> ERF.H:498</div></div>
<div class="ttc" id="aclassERF_html_ae994c0e7f0d87b787de9bb971f0da64c"><div class="ttname"><a href="classERF.html#ae994c0e7f0d87b787de9bb971f0da64c">ERF::erf_enforce_hse</a></div><div class="ttdeci">void erf_enforce_hse(int lev, amrex::Vector&lt; amrex::Real &gt; &amp;dens, amrex::Vector&lt; amrex::Real &gt; &amp;pres)</div><div class="ttdef"><b>Definition:</b> ERF_init1d.cpp:193</div></div>
<div class="ttc" id="aclassERF_html_a413293737b0021c97b50c62756561446"><div class="ttname"><a href="classERF.html#a413293737b0021c97b50c62756561446">ERF::h_havg_pressure</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Real &gt; h_havg_pressure</div><div class="ttdef"><b>Definition:</b> ERF.H:587</div></div>
<div class="ttc" id="aclassERF_html_a40ebca562ac79fcc9250e17e0f4a5b41"><div class="ttname"><a href="classERF.html#a40ebca562ac79fcc9250e17e0f4a5b41">ERF::AverageDownTo</a></div><div class="ttdeci">void AverageDownTo(int crse_lev)</div><div class="ttdef"><b>Definition:</b> ERF.cpp:987</div></div>
<div class="ttc" id="aclassERF_html_a4ac5b4b865dc8a029812bf1a20cd9b9b"><div class="ttname"><a href="classERF.html#a4ac5b4b865dc8a029812bf1a20cd9b9b">ERF::bdy_data_xhi</a></div><div class="ttdeci">amrex::Vector&lt; amrex::FArrayBox &gt; bdy_data_xhi</div><div class="ttdef"><b>Definition:</b> ERF.H:375</div></div>
<div class="ttc" id="aclassERF_html_a43d0b17f6e155691a1e9474526df3af5"><div class="ttname"><a href="classERF.html#a43d0b17f6e155691a1e9474526df3af5">ERF::verbose</a></div><div class="ttdeci">static int verbose</div><div class="ttdef"><b>Definition:</b> ERF.H:528</div></div>
<div class="ttc" id="aMomentumToVelocity_8cpp_html_a79080d9506305b3b98f783cc6c2cda47"><div class="ttname"><a href="MomentumToVelocity_8cpp.html#a79080d9506305b3b98f783cc6c2cda47">MomentumToVelocity</a></div><div class="ttdeci">void MomentumToVelocity(MultiFab &amp;xvel, const IntVect &amp;xvel_ngrow, MultiFab &amp;yvel, const IntVect &amp;yvel_ngrow, MultiFab &amp;zvel, const IntVect &amp;zvel_ngrow, const MultiFab &amp;cons_in, const MultiFab &amp;xmom_in, const MultiFab &amp;ymom_in, const MultiFab &amp;zmom_in)</div><div class="ttdef"><b>Definition:</b> MomentumToVelocity.cpp:14</div></div>
<div class="ttc" id="aclassERF_html_a80ad08512968ec45635df68abe66b1fc"><div class="ttname"><a href="classERF.html#a80ad08512968ec45635df68abe66b1fc">ERF::input_bndry_planes</a></div><div class="ttdeci">static int input_bndry_planes</div><div class="ttdef"><b>Definition:</b> ERF.H:570</div></div>
<div class="ttc" id="aclassERF_html_af5ac3d88a33a1a284bcc120ce0599cf7"><div class="ttname"><a href="classERF.html#af5ac3d88a33a1a284bcc120ce0599cf7">ERF::init_type</a></div><div class="ttdeci">static std::string init_type</div><div class="ttdef"><b>Definition:</b> ERF.H:544</div></div>
<div class="ttc" id="aclassERF_html_aad09820d3e29638db7c3d499304c8aed"><div class="ttname"><a href="classERF.html#aad09820d3e29638db7c3d499304c8aed">ERF::use_lowM_dt</a></div><div class="ttdeci">static bool use_lowM_dt</div><div class="ttdef"><b>Definition:</b> ERF.H:491</div></div>
<div class="ttc" id="aDataStruct_8H_html_a07130f00a795700d6b2b83f773b807b4aa27a6549ade38cc036f7b8c58a840510"><div class="ttname"><a href="DataStruct_8H.html#a07130f00a795700d6b2b83f773b807b4aa27a6549ade38cc036f7b8c58a840510">AdvectedQuantity::scalar</a></div><div class="ttdeci">@ scalar</div></div>
<div class="ttc" id="aclassERF_html_aaee255b031e63bd9b5807f6612739dbd"><div class="ttname"><a href="classERF.html#aaee255b031e63bd9b5807f6612739dbd">ERF::GotoNextLine</a></div><div class="ttdeci">static void GotoNextLine(std::istream &amp;is)</div><div class="ttdef"><b>Definition:</b> Checkpoint.cpp:8</div></div>
<div class="ttc" id="aTerrainMetrics_8H_html_a53363537d3e953e585899d27b19b0f7f"><div class="ttname"><a href="TerrainMetrics_8H.html#a53363537d3e953e585899d27b19b0f7f">make_metrics</a></div><div class="ttdeci">void make_metrics(amrex::Geometry &amp;geom, amrex::MultiFab &amp;z_phys_nd, amrex::MultiFab &amp;z_phys_cc, amrex::MultiFab &amp;detJ_cc)</div><div class="ttdef"><b>Definition:</b> TerrainMetrics.H:619</div></div>
<div class="ttc" id="anamespaceVars_html_a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b"><div class="ttname"><a href="namespaceVars.html#a2aa680f90abb6ff6d5c1875f8beb4b1ca47abe072e12c61d29cde15a509a0664b">Vars::cons</a></div><div class="ttdeci">@ cons</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:64</div></div>
<div class="ttc" id="aclassERF_html_afd8cd5a477754776135befa668fdd0c9"><div class="ttname"><a href="classERF.html#afd8cd5a477754776135befa668fdd0c9">ERF::cons_names</a></div><div class="ttdeci">const amrex::Vector&lt; std::string &gt; cons_names</div><div class="ttdef"><b>Definition:</b> ERF.H:510</div></div>
<div class="ttc" id="astructTimeInterpolatedData_html_a3b9292eb3012672361abacc2ab7d9b2c"><div class="ttname"><a href="structTimeInterpolatedData.html#a3b9292eb3012672361abacc2ab7d9b2c">TimeInterpolatedData::add_var</a></div><div class="ttdeci">void add_var(amrex::MultiFab *var_data, int own_data)</div><div class="ttdef"><b>Definition:</b> TimeInterpolatedData.H:23</div></div>
<div class="ttc" id="aclassERF_html_addf62bfc534515447b94e928ac0b7135"><div class="ttname"><a href="classERF.html#addf62bfc534515447b94e928ac0b7135">ERF::m_r2d</a></div><div class="ttdeci">std::unique_ptr&lt; ReadBndryPlanes &gt; m_r2d</div><div class="ttdef"><b>Definition:</b> ERF.H:603</div></div>
<div class="ttc" id="aclassERF_html_a8e758060d3dede9694fbfcabddc17169"><div class="ttname"><a href="classERF.html#a8e758060d3dede9694fbfcabddc17169">ERF::restart_chkfile</a></div><div class="ttdeci">std::string restart_chkfile</div><div class="ttdef"><b>Definition:</b> ERF.H:480</div></div>
<div class="ttc" id="aclassERF_html_ae7b9991150042eb38e2abc89399c0c7c"><div class="ttname"><a href="classERF.html#ae7b9991150042eb38e2abc89399c0c7c">ERF::plotfile_type</a></div><div class="ttdeci">static std::string plotfile_type</div><div class="ttdef"><b>Definition:</b> ERF.H:541</div></div>
<div class="ttc" id="aclassERF_html_ac2be0759e68086d0e9026c61492fa225"><div class="ttname"><a href="classERF.html#ac2be0759e68086d0e9026c61492fa225">ERF::bndry_output_planes_start_time</a></div><div class="ttdeci">static amrex::Real bndry_output_planes_start_time</div><div class="ttdef"><b>Definition:</b> ERF.H:567</div></div>
<div class="ttc" id="aclassERF_html_a32dd48049e8acbe95decdd4b01b782c4"><div class="ttname"><a href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">ERF::solverChoice</a></div><div class="ttdeci">static SolverChoice solverChoice</div><div class="ttdef"><b>Definition:</b> ERF.H:526</div></div>
<div class="ttc" id="aclassERF_html_aa2c3ee1910008b828b9da79ccdfe3871"><div class="ttname"><a href="classERF.html#aa2c3ee1910008b828b9da79ccdfe3871">ERF::DataLog</a></div><div class="ttdeci">AMREX_FORCE_INLINE std::ostream &amp; DataLog(int i)</div><div class="ttdef"><b>Definition:</b> ERF.H:654</div></div>
<div class="ttc" id="aIndexDefines_8H_html_a76cb673ca03cd7f8ae6cc8544d6dd0fa"><div class="ttname"><a href="IndexDefines_8H.html#a76cb673ca03cd7f8ae6cc8544d6dd0fa">NUM_PRIM</a></div><div class="ttdeci">#define NUM_PRIM</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:33</div></div>
<div class="ttc" id="aclassERF_html_a7085d7d5fc94a0f84efc06957267d58e"><div class="ttname"><a href="classERF.html#a7085d7d5fc94a0f84efc06957267d58e">ERF::t_old</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Real &gt; t_old</div><div class="ttdef"><b>Definition:</b> ERF.H:427</div></div>
<div class="ttc" id="aclassERF_html_a54f6c5d799e51521ad10bb57d29d0c44"><div class="ttname"><a href="classERF.html#a54f6c5d799e51521ad10bb57d29d0c44">ERF::PlotFileName</a></div><div class="ttdeci">std::string PlotFileName(int lev) const</div><div class="ttdef"><b>Definition:</b> Plotfile.cpp:14</div></div>
<div class="ttc" id="aclassERF_html_a2ef8ab09aed437467e2e87a37bcd999d"><div class="ttname"><a href="classERF.html#a2ef8ab09aed437467e2e87a37bcd999d">ERF::flux_registers</a></div><div class="ttdeci">amrex::Vector&lt; amrex::FluxRegister * &gt; flux_registers</div><div class="ttdef"><b>Definition:</b> ERF.H:451</div></div>
<div class="ttc" id="astructTimeInterpolatedData_html_a3f1217eba0582186b1ea1b43babcc5f4"><div class="ttname"><a href="structTimeInterpolatedData.html#a3f1217eba0582186b1ea1b43babcc5f4">TimeInterpolatedData::get_time</a></div><div class="ttdeci">amrex::Real get_time()</div><div class="ttdef"><b>Definition:</b> TimeInterpolatedData.H:21</div></div>
<div class="ttc" id="aDataStruct_8H_html_a07130f00a795700d6b2b83f773b807b4a7b774effe4a349c6dd82ad4f4f21d34c"><div class="ttname"><a href="DataStruct_8H.html#a07130f00a795700d6b2b83f773b807b4a7b774effe4a349c6dd82ad4f4f21d34c">AdvectedQuantity::u</a></div><div class="ttdeci">@ u</div></div>
<div class="ttc" id="anamespaceBCVars_html_a00367571247ba920989360b94c156f4aa559799ff291d4e692283c4056bac8db1"><div class="ttname"><a href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa559799ff291d4e692283c4056bac8db1">BCVars::Rho_bc_comp</a></div><div class="ttdeci">@ Rho_bc_comp</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:38</div></div>
<div class="ttc" id="astructSolverChoice_html_a8e053ce39997ed619ac81aa4d5a1fd44"><div class="ttname"><a href="structSolverChoice.html#a8e053ce39997ed619ac81aa4d5a1fd44">SolverChoice::spatial_order</a></div><div class="ttdeci">int spatial_order</div><div class="ttdef"><b>Definition:</b> DataStruct.H:381</div></div>
<div class="ttc" id="anamespaceCons_html_ab92931555eff5e3d0d9eb62ae0225cc1a5c9c77ea576137ca2664783567e7f588"><div class="ttname"><a href="namespaceCons.html#ab92931555eff5e3d0d9eb62ae0225cc1a5c9c77ea576137ca2664783567e7f588">Cons::Rho</a></div><div class="ttdeci">@ Rho</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:77</div></div>
<div class="ttc" id="anamespacederived_html_aa850437283651e137b82322c0437d487"><div class="ttname"><a href="namespacederived.html#aa850437283651e137b82322c0437d487">derived::erf_derQKE</a></div><div class="ttdeci">void erf_derQKE(const amrex::Box &amp;bx, amrex::FArrayBox &amp;derfab, int, int, const amrex::FArrayBox &amp;datfab, const amrex::Geometry &amp;, amrex::Real, const int *, const int)</div><div class="ttdef"><b>Definition:</b> Derive.cpp:150</div></div>
<div class="ttc" id="aclassERF_html_a47413fe5588f7dd71a1d5087a9e804f9"><div class="ttname"><a href="classERF.html#a47413fe5588f7dd71a1d5087a9e804f9">ERF::Advance</a></div><div class="ttdeci">void Advance(int lev, amrex::Real time, amrex::Real dt_lev, int iteration, int ncycle)</div><div class="ttdef"><b>Definition:</b> ERF_TimeStepping.cpp:78</div></div>
<div class="ttc" id="anamespaceBCVars_html_a00367571247ba920989360b94c156f4aa98ad22810fdfe9e585bc6481fc12454e"><div class="ttname"><a href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a></div><div class="ttdeci">@ yvel_bc</div><div class="ttdef"><b>Definition:</b> IndexDefines.H:48</div></div>
<div class="ttc" id="aclassERF_html_a479132ab37232f208597c7a27c132866"><div class="ttname"><a href="classERF.html#a479132ab37232f208597c7a27c132866">ERF::bndry_output_planes_per</a></div><div class="ttdeci">static amrex::Real bndry_output_planes_per</div><div class="ttdef"><b>Definition:</b> ERF.H:566</div></div>
<div class="ttc" id="aclassERF_html_a7e9040f32464f1a6dee6e0384393451d"><div class="ttname"><a href="classERF.html#a7e9040f32464f1a6dee6e0384393451d">ERF::nc_bdy_file</a></div><div class="ttdeci">static std::string nc_bdy_file</div><div class="ttdef"><b>Definition:</b> ERF.H:550</div></div>
<div class="ttc" id="aIndexDefines_8H_html_a6e1412fca31cbd35d0f50f12fcc70b0fae6ffdec5e14fce371eb7ae99edebbbee"><div class="ttname"><a href="IndexDefines_8H.html#a6e1412fca31cbd35d0f50f12fcc70b0fae6ffdec5e14fce371eb7ae99edebbbee">BC::periodic</a></div><div class="ttdeci">@ periodic</div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classERF.html">ERF</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
