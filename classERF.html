<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ERF: ERF Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ERF
   </div>
   <div id="projectbrief">Energy Research and Forecasting: An Atmospheric Modeling Code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('classERF.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-static-methods">Static Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="#pri-static-attribs">Static Private Attributes</a> &#124;
<a href="classERF-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">ERF Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="ERF_8H_source.html">ERF.H</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for ERF:</div>
<div class="dyncontent">
<div class="center"><img src="classERF__inherit__graph.png" border="0" usemap="#aERF_inherit__map" alt="Inheritance graph"/></div>
<map name="aERF_inherit__map" id="aERF_inherit__map">
<area shape="rect" title=" " alt="" coords="47,80,93,107"/>
<area shape="rect" title=" " alt="" coords="5,5,135,32"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for ERF:</div>
<div class="dyncontent">
<div class="center"><img src="classERF__coll__graph.png" border="0" usemap="#aERF_coll__map" alt="Collaboration graph"/></div>
<map name="aERF_coll__map" id="aERF_coll__map">
<area shape="rect" title=" " alt="" coords="877,2290,924,2317"/>
<area shape="rect" title=" " alt="" coords="499,13,628,40"/>
<area shape="rect" title=" " alt="" coords="460,64,667,120"/>
<area shape="rect" title=" " alt="" coords="493,144,633,170"/>
<area shape="rect" title=" " alt="" coords="437,194,689,221"/>
<area shape="rect" title=" " alt="" coords="20,890,193,946"/>
<area shape="rect" href="structInputSoundingData.html" title=" " alt="" coords="490,2101,637,2128"/>
<area shape="rect" title=" " alt="" coords="461,455,666,496"/>
<area shape="rect" title=" " alt="" coords="481,521,645,548"/>
<area shape="rect" title=" " alt="" coords="478,572,649,614"/>
<area shape="rect" title=" " alt="" coords="462,638,665,679"/>
<area shape="rect" href="structInputSpongeData.html" title=" " alt="" coords="496,913,631,940"/>
<area shape="rect" title=" " alt="" coords="21,1262,193,1289"/>
<area shape="rect" href="structTurbulentPerturbation.html" title=" " alt="" coords="482,2918,645,2945"/>
<area shape="rect" title=" " alt="" coords="63,689,150,716"/>
<area shape="rect" href="structSolverChoice.html" title=" " alt="" coords="510,2050,617,2077"/>
<area shape="rect" title=" " alt="" coords="468,1173,659,1229"/>
<area shape="rect" title=" " alt="" coords="503,1253,624,1280"/>
<area shape="rect" title=" " alt="" coords="450,1304,677,1330"/>
<area shape="rect" title=" " alt="" coords="482,1355,645,1396"/>
<area shape="rect" title=" " alt="" coords="484,1420,643,1462"/>
<area shape="rect" title=" " alt="" coords="455,1486,671,1527"/>
<area shape="rect" title=" " alt="" coords="471,1551,656,1622"/>
<area shape="rect" title=" " alt="" coords="5,3117,208,3144"/>
<area shape="rect" title=" " alt="" coords="81,1678,132,1705"/>
<area shape="rect" title=" " alt="" coords="22,3019,191,3060"/>
<area shape="rect" title=" " alt="" coords="477,2152,649,2194"/>
<area shape="rect" title=" " alt="" coords="482,2218,645,2259"/>
<area shape="rect" title=" " alt="" coords="460,2283,667,2324"/>
<area shape="rect" title=" " alt="" coords="87,2629,126,2656"/>
<area shape="rect" title=" " alt="" coords="81,2202,132,2229"/>
<area shape="rect" title=" " alt="" coords="51,2784,162,2810"/>
<area shape="rect" title=" " alt="" coords="27,3404,186,3430"/>
<area shape="rect" title=" " alt="" coords="481,3198,646,3239"/>
<area shape="rect" title=" " alt="" coords="446,3264,681,3290"/>
<area shape="rect" title=" " alt="" coords="525,3465,602,3492"/>
<area shape="rect" title=" " alt="" coords="471,3516,656,3572"/>
<area shape="rect" title=" " alt="" coords="13,3810,201,3837"/>
<area shape="rect" title=" " alt="" coords="7,3556,206,3582"/>
<area shape="rect" title=" " alt="" coords="463,3975,664,4016"/>
<area shape="rect" title=" " alt="" coords="468,4041,659,4097"/>
<area shape="rect" title=" " alt="" coords="478,4121,649,4177"/>
<area shape="rect" title=" " alt="" coords="449,4201,678,4228"/>
<area shape="rect" title=" " alt="" coords="472,4252,655,4294"/>
<area shape="rect" title=" " alt="" coords="478,4318,649,4374"/>
<area shape="rect" title=" " alt="" coords="488,4399,639,4440"/>
<area shape="rect" title=" " alt="" coords="472,4464,655,4506"/>
<area shape="rect" title=" " alt="" coords="473,4530,654,4571"/>
<area shape="rect" title=" " alt="" coords="469,4595,657,4636"/>
<area shape="rect" title=" " alt="" coords="479,4660,648,4702"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a30129012dd367825e5e4fd1406694f58"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a30129012dd367825e5e4fd1406694f58">ERF</a> ()</td></tr>
<tr class="separator:a30129012dd367825e5e4fd1406694f58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30901583bd41e7bf4dddb3c1ea329dfe"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a30901583bd41e7bf4dddb3c1ea329dfe">~ERF</a> () override</td></tr>
<tr class="separator:a30901583bd41e7bf4dddb3c1ea329dfe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab5871c91a4d8888c110865e9d35e8b2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aab5871c91a4d8888c110865e9d35e8b2">ERF_shared</a> ()</td></tr>
<tr class="separator:aab5871c91a4d8888c110865e9d35e8b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13fc8f3a00573ee7735c3228316164a9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a13fc8f3a00573ee7735c3228316164a9">ERF</a> (<a class="el" href="classERF.html">ERF</a> &amp;&amp;) noexcept=delete</td></tr>
<tr class="separator:a13fc8f3a00573ee7735c3228316164a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbc40e6fe700b80e3666dd3723624f05"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classERF.html">ERF</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#abbc40e6fe700b80e3666dd3723624f05">operator=</a> (<a class="el" href="classERF.html">ERF</a> &amp;&amp;other) noexcept=delete</td></tr>
<tr class="separator:abbc40e6fe700b80e3666dd3723624f05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4f5db4e6643e9ebc8ffeebcbca3978a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#af4f5db4e6643e9ebc8ffeebcbca3978a">ERF</a> (const <a class="el" href="classERF.html">ERF</a> &amp;other)=delete</td></tr>
<tr class="separator:af4f5db4e6643e9ebc8ffeebcbca3978a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72fcc41d6f5225e9ca3b8c9111ff37e7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classERF.html">ERF</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a72fcc41d6f5225e9ca3b8c9111ff37e7">operator=</a> (const <a class="el" href="classERF.html">ERF</a> &amp;other)=delete</td></tr>
<tr class="separator:a72fcc41d6f5225e9ca3b8c9111ff37e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0be12798b46f52fa4b5a995f147c3f96"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a0be12798b46f52fa4b5a995f147c3f96">Evolve</a> ()</td></tr>
<tr class="separator:a0be12798b46f52fa4b5a995f147c3f96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18e6dbbf968b4492e78aa427791620f4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a18e6dbbf968b4492e78aa427791620f4">ErrorEst</a> (int lev, amrex::TagBoxArray &amp;tags, amrex::Real time, int ngrow) override</td></tr>
<tr class="separator:a18e6dbbf968b4492e78aa427791620f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2710f0ac329fa022dd2df41679998b3b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a2710f0ac329fa022dd2df41679998b3b">HurricaneTracker</a> (int lev, const amrex::MultiFab &amp;U_new, const amrex::MultiFab &amp;V_new, const amrex::MultiFab &amp;W_new, const amrex::Real velmag_threshold, const bool is_track_io, amrex::TagBoxArray *tags=nullptr)</td></tr>
<tr class="separator:a2710f0ac329fa022dd2df41679998b3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a758170966de01c9030c39a3840d29395"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a758170966de01c9030c39a3840d29395">MakeVTKFilename</a> (int nstep)</td></tr>
<tr class="separator:a758170966de01c9030c39a3840d29395"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3613d455e3c246e5addf88054fa41db"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ad3613d455e3c246e5addf88054fa41db">WriteVTKPolyline</a> (const std::string &amp;filename, amrex::Vector&lt; std::array&lt; amrex::Real, 2 &gt;&gt; &amp;points_xy)</td></tr>
<tr class="separator:ad3613d455e3c246e5addf88054fa41db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5d585e110291969767013a515719224"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ad5d585e110291969767013a515719224">InitData</a> ()</td></tr>
<tr class="separator:ad5d585e110291969767013a515719224"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9084860e0049795487636a9e0ccbc89e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a9084860e0049795487636a9e0ccbc89e">InitData_pre</a> ()</td></tr>
<tr class="separator:a9084860e0049795487636a9e0ccbc89e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8b243c093bd872b6f7592603ff97792"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aa8b243c093bd872b6f7592603ff97792">InitData_post</a> ()</td></tr>
<tr class="separator:aa8b243c093bd872b6f7592603ff97792"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31b92a0c6fa4e19ff90feef3611f5f06"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a31b92a0c6fa4e19ff90feef3611f5f06">WriteMyEBSurface</a> ()</td></tr>
<tr class="separator:a31b92a0c6fa4e19ff90feef3611f5f06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a757e8303ce8ed936c05f559349f10aa5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a757e8303ce8ed936c05f559349f10aa5">compute_divergence</a> (int lev, amrex::MultiFab &amp;rhs, amrex::Array&lt; amrex::MultiFab const *, AMREX_SPACEDIM &gt; rho0_u_const, amrex::Geometry const &amp;geom_at_lev)</td></tr>
<tr class="separator:a757e8303ce8ed936c05f559349f10aa5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a60eec7b73429ba7bd98341bc4f5a6d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a8a60eec7b73429ba7bd98341bc4f5a6d">project_velocity</a> (int lev, amrex::Real <a class="el" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>)</td></tr>
<tr class="separator:a8a60eec7b73429ba7bd98341bc4f5a6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adff3b3740b634d2cda1b148f3f3ce2ae"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#adff3b3740b634d2cda1b148f3f3ce2ae">project_momenta</a> (int lev, amrex::Real <a class="el" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>, amrex::Vector&lt; amrex::MultiFab &gt; &amp;vars)</td></tr>
<tr class="separator:adff3b3740b634d2cda1b148f3f3ce2ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f36ab3750aa760fb621b40294e0f6c6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a2f36ab3750aa760fb621b40294e0f6c6">project_velocity_tb</a> (int lev, amrex::Real <a class="el" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>, amrex::Vector&lt; amrex::MultiFab &gt; &amp;vars)</td></tr>
<tr class="separator:a2f36ab3750aa760fb621b40294e0f6c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a984c145a81739ab4c7f8fd03a334d239"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a984c145a81739ab4c7f8fd03a334d239">poisson_wall_dist</a> (int lev)</td></tr>
<tr class="separator:a984c145a81739ab4c7f8fd03a334d239"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa31ae8bd097ec65d711070aedf11a14a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aa31ae8bd097ec65d711070aedf11a14a">solve_with_EB_mlmg</a> (int lev, amrex::Vector&lt; amrex::MultiFab &gt; &amp;rhs, amrex::Vector&lt; amrex::MultiFab &gt; &amp;p, amrex::Vector&lt; amrex::Array&lt; amrex::MultiFab, AMREX_SPACEDIM &gt;&gt; &amp;fluxes)</td></tr>
<tr class="separator:aa31ae8bd097ec65d711070aedf11a14a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9866c7874624259ffcfc6edf46dd58ec"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a9866c7874624259ffcfc6edf46dd58ec">solve_with_gmres</a> (int lev, amrex::Vector&lt; amrex::MultiFab &gt; &amp;rhs, amrex::Vector&lt; amrex::MultiFab &gt; &amp;p, amrex::Vector&lt; amrex::Array&lt; amrex::MultiFab, AMREX_SPACEDIM &gt;&gt; &amp;fluxes)</td></tr>
<tr class="separator:a9866c7874624259ffcfc6edf46dd58ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a7c7fe95147d8772047aa0772a09564"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a8a7c7fe95147d8772047aa0772a09564">solve_with_mlmg</a> (int lev, amrex::Vector&lt; amrex::MultiFab &gt; &amp;rhs, amrex::Vector&lt; amrex::MultiFab &gt; &amp;p, amrex::Vector&lt; amrex::Array&lt; amrex::MultiFab, AMREX_SPACEDIM &gt;&gt; &amp;fluxes)</td></tr>
<tr class="separator:a8a7c7fe95147d8772047aa0772a09564"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bc2457e48cf3347af7c600a07982006"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a4bc2457e48cf3347af7c600a07982006">ImposeBCsOnPhi</a> (int lev, amrex::MultiFab &amp;phi)</td></tr>
<tr class="separator:a4bc2457e48cf3347af7c600a07982006"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57580311d47c9fd5e27ba156d287c169"><td class="memItemLeft" align="right" valign="top">amrex::Array&lt; amrex::LinOpBCType, AMREX_SPACEDIM &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a57580311d47c9fd5e27ba156d287c169">get_projection_bc</a> (amrex::Orientation::Side side) const noexcept</td></tr>
<tr class="separator:a57580311d47c9fd5e27ba156d287c169"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8279f37ed1b99d9111c49c7b3f854c47"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a8279f37ed1b99d9111c49c7b3f854c47">projection_has_dirichlet</a> (amrex::Array&lt; amrex::LinOpBCType, AMREX_SPACEDIM &gt; bcs) const</td></tr>
<tr class="separator:a8279f37ed1b99d9111c49c7b3f854c47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80981e20939a6a38ba17478da2253ff1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a80981e20939a6a38ba17478da2253ff1">init_only</a> (int lev, amrex::Real time)</td></tr>
<tr class="separator:a80981e20939a6a38ba17478da2253ff1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a530d2ce59e6fd46e9fb00e4d11eaf737"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a530d2ce59e6fd46e9fb00e4d11eaf737">restart</a> ()</td></tr>
<tr class="separator:a530d2ce59e6fd46e9fb00e4d11eaf737"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2e4de4eaa0f93149c1aefd58dc7068a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#af2e4de4eaa0f93149c1aefd58dc7068a">writeNow</a> (const amrex::Real cur_time, const amrex::Real <a class="el" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>, const int nstep, const int plot_int, const amrex::Real plot_per)</td></tr>
<tr class="separator:af2e4de4eaa0f93149c1aefd58dc7068a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58f6683aff0fbe6949bfe8b49275a8b3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a58f6683aff0fbe6949bfe8b49275a8b3">post_timestep</a> (int nstep, amrex::Real time, amrex::Real dt_lev)</td></tr>
<tr class="separator:a58f6683aff0fbe6949bfe8b49275a8b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a922892a05ee0c5bccd210a3e5a8599e1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a922892a05ee0c5bccd210a3e5a8599e1">sum_integrated_quantities</a> (amrex::Real time)</td></tr>
<tr class="separator:a922892a05ee0c5bccd210a3e5a8599e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91c184ac7e5889fe785aa846112ce2e6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a91c184ac7e5889fe785aa846112ce2e6">sum_derived_quantities</a> (amrex::Real time)</td></tr>
<tr class="separator:a91c184ac7e5889fe785aa846112ce2e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e5b26e9aeb49e5318eb6cb68ed2ee97"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a3e5b26e9aeb49e5318eb6cb68ed2ee97">sum_energy_quantities</a> (amrex::Real time)</td></tr>
<tr class="separator:a3e5b26e9aeb49e5318eb6cb68ed2ee97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55eae94c5363e227b571739738bb26b7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a55eae94c5363e227b571739738bb26b7">write_1D_profiles</a> (amrex::Real time)</td></tr>
<tr class="separator:a55eae94c5363e227b571739738bb26b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39efa3a0f3ae3deb7a43f4ce110ee49a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a39efa3a0f3ae3deb7a43f4ce110ee49a">write_1D_profiles_stag</a> (amrex::Real time)</td></tr>
<tr class="separator:a39efa3a0f3ae3deb7a43f4ce110ee49a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f6effb7eeed11385b20e4bbf516b459"><td class="memItemLeft" align="right" valign="top">amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a0f6effb7eeed11385b20e4bbf516b459">cloud_fraction</a> (amrex::Real time)</td></tr>
<tr class="separator:a0f6effb7eeed11385b20e4bbf516b459"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0857fa7f21e3077bb8bd7808023a6d09"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a0857fa7f21e3077bb8bd7808023a6d09">FillBdyCCVels</a> (amrex::Vector&lt; amrex::MultiFab &gt; &amp;mf_cc_vel, int levc=0)</td></tr>
<tr class="separator:a0857fa7f21e3077bb8bd7808023a6d09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa28182226262c67cfd686d35bfeabcad"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aa28182226262c67cfd686d35bfeabcad">sample_points</a> (int lev, amrex::Real time, amrex::IntVect cell, amrex::MultiFab &amp;mf)</td></tr>
<tr class="separator:aa28182226262c67cfd686d35bfeabcad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb798c72ea4fde6f4da8d01a24c8c165"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#afb798c72ea4fde6f4da8d01a24c8c165">sample_lines</a> (int lev, amrex::Real time, amrex::IntVect cell, amrex::MultiFab &amp;mf)</td></tr>
<tr class="separator:afb798c72ea4fde6f4da8d01a24c8c165"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5b66549344d8b04b126fa0ef16c7ca2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ab5b66549344d8b04b126fa0ef16c7ca2">derive_diag_profiles</a> (amrex::Real time, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_u, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_v, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_w, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_rho, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_th, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_ksgs, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_Kmv, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_Khv, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_qv, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_qc, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_qr, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_wqv, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_wqc, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_wqr, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_qi, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_qs, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_qg, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_uu, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_uv, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_uw, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_vv, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_vw, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_ww, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_uth, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_vth, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_wth, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_thth, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_ku, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_kv, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_kw, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_p, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_pu, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_pv, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_pw, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_wthv)</td></tr>
<tr class="separator:ab5b66549344d8b04b126fa0ef16c7ca2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b93b715895b00e86e7db653d2a7284a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a8b93b715895b00e86e7db653d2a7284a">derive_diag_profiles_stag</a> (amrex::Real time, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_u, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_v, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_w, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_rho, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_th, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_ksgs, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_Kmv, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_Khv, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_qv, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_qc, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_qr, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_wqv, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_wqc, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_wqr, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_qi, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_qs, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_qg, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_uu, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_uv, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_uw, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_vv, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_vw, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_ww, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_uth, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_vth, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_wth, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_thth, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_ku, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_kv, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_kw, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_p, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_pu, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_pv, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_pw, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_wthv)</td></tr>
<tr class="separator:a8b93b715895b00e86e7db653d2a7284a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7886dcab90f37a8fcc91ede0c68b6cb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ad7886dcab90f37a8fcc91ede0c68b6cb">derive_stress_profiles</a> (amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_tau11, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_tau12, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_tau13, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_tau22, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_tau23, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_tau33, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_hfx3, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_q1fx3, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_q2fx3, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_diss)</td></tr>
<tr class="separator:ad7886dcab90f37a8fcc91ede0c68b6cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae09680325ba108583147eb2e254a266e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ae09680325ba108583147eb2e254a266e">derive_stress_profiles_stag</a> (amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_tau11, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_tau12, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_tau13, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_tau22, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_tau23, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_tau33, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_hfx3, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_q1fx3, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_q2fx3, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_diss)</td></tr>
<tr class="separator:ae09680325ba108583147eb2e254a266e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad156903a5d71364b5fb5884000f28a8a"><td class="memItemLeft" align="right" valign="top">amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ad156903a5d71364b5fb5884000f28a8a">volWgtSumMF</a> (int lev, const amrex::MultiFab &amp;mf, int comp, bool finemask)</td></tr>
<tr class="separator:ad156903a5d71364b5fb5884000f28a8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb6175c28b36d23f5dda2994ca4a85e7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#abb6175c28b36d23f5dda2994ca4a85e7">MakeNewLevelFromCoarse</a> (int lev, amrex::Real time, const amrex::BoxArray &amp;ba, const amrex::DistributionMapping &amp;dm) override</td></tr>
<tr class="separator:abb6175c28b36d23f5dda2994ca4a85e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae7a3a76e08e54c618cf79b30ed2d73d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aae7a3a76e08e54c618cf79b30ed2d73d">RemakeLevel</a> (int lev, amrex::Real time, const amrex::BoxArray &amp;ba, const amrex::DistributionMapping &amp;dm) override</td></tr>
<tr class="separator:aae7a3a76e08e54c618cf79b30ed2d73d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac44e400a7ce68e18fa44e9416cb1344e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ac44e400a7ce68e18fa44e9416cb1344e">ClearLevel</a> (int lev) override</td></tr>
<tr class="separator:ac44e400a7ce68e18fa44e9416cb1344e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf10bbf8c9a5dbc257a88c4c1b650fee"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aaf10bbf8c9a5dbc257a88c4c1b650fee">MakeNewLevelFromScratch</a> (int lev, amrex::Real time, const amrex::BoxArray &amp;ba, const amrex::DistributionMapping &amp;dm) override</td></tr>
<tr class="separator:aaf10bbf8c9a5dbc257a88c4c1b650fee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b1d727e63de2e49aa4f8e00b0dda1d5"><td class="memItemLeft" align="right" valign="top">amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a6b1d727e63de2e49aa4f8e00b0dda1d5">estTimeStep</a> (int lev, long &amp;dt_fast_ratio) const</td></tr>
<tr class="separator:a6b1d727e63de2e49aa4f8e00b0dda1d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96a272defae485c5b83fbc123a631f9f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a96a272defae485c5b83fbc123a631f9f">advance_dycore</a> (int level, amrex::Vector&lt; amrex::MultiFab &gt; &amp;state_old, amrex::Vector&lt; amrex::MultiFab &gt; &amp;state_new, amrex::MultiFab &amp;xvel_old, amrex::MultiFab &amp;yvel_old, amrex::MultiFab &amp;zvel_old, amrex::MultiFab &amp;xvel_new, amrex::MultiFab &amp;yvel_new, amrex::MultiFab &amp;zvel_new, amrex::MultiFab &amp;source, amrex::MultiFab &amp;xmom_src, amrex::MultiFab &amp;ymom_src, amrex::MultiFab &amp;zmom_src, amrex::MultiFab &amp;buoyancy, amrex::Geometry fine_geom, amrex::Real <a class="el" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>, amrex::Real time)</td></tr>
<tr class="separator:a96a272defae485c5b83fbc123a631f9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad64b5fe566102dc053b35ad337971a3e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ad64b5fe566102dc053b35ad337971a3e">advance_microphysics</a> (int lev, amrex::MultiFab &amp;cons_in, const amrex::Real &amp;dt_advance, const int &amp;iteration, const amrex::Real &amp;time)</td></tr>
<tr class="separator:ad64b5fe566102dc053b35ad337971a3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab463dd8a88f21f3a5ff33b583a883c28"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ab463dd8a88f21f3a5ff33b583a883c28">advance_lsm</a> (int lev, amrex::MultiFab &amp;cons_in, amrex::MultiFab &amp;xvel_in, amrex::MultiFab &amp;yvel_in, const amrex::Real &amp;dt_advance)</td></tr>
<tr class="separator:ab463dd8a88f21f3a5ff33b583a883c28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3ef30449c979e90c40b0c6f79864e8f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ad3ef30449c979e90c40b0c6f79864e8f">advance_radiation</a> (int lev, amrex::MultiFab &amp;cons_in, const amrex::Real &amp;dt_advance)</td></tr>
<tr class="separator:ad3ef30449c979e90c40b0c6f79864e8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af46289079e053a6d74ddef0bf1a5d8a3"><td class="memItemLeft" align="right" valign="top">amrex::MultiFab &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#af46289079e053a6d74ddef0bf1a5d8a3">build_fine_mask</a> (int lev)</td></tr>
<tr class="separator:af46289079e053a6d74ddef0bf1a5d8a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01987b2556834788694f2f3741a2afe4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a01987b2556834788694f2f3741a2afe4">MakeHorizontalAverages</a> ()</td></tr>
<tr class="separator:a01987b2556834788694f2f3741a2afe4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93ed2dd2c2441da6853d6f48b6467324"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a93ed2dd2c2441da6853d6f48b6467324">MakeDiagnosticAverage</a> (amrex::Vector&lt; amrex::Real &gt; &amp;h_havg, amrex::MultiFab &amp;S, int n)</td></tr>
<tr class="separator:a93ed2dd2c2441da6853d6f48b6467324"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1981699bedbbfd6785f26ca340a74d8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#af1981699bedbbfd6785f26ca340a74d8">derive_upwp</a> (amrex::Vector&lt; amrex::Real &gt; &amp;h_havg)</td></tr>
<tr class="separator:af1981699bedbbfd6785f26ca340a74d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98cccb83ca76c44d6ae583d051e76faf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a98cccb83ca76c44d6ae583d051e76faf">WritePlotFile</a> (int which, PlotFileType plotfile_type, amrex::Vector&lt; std::string &gt; plot_var_names)</td></tr>
<tr class="separator:a98cccb83ca76c44d6ae583d051e76faf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3849ef0f90b5798c571259313a3d501a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a3849ef0f90b5798c571259313a3d501a">WriteSubvolume</a> ()</td></tr>
<tr class="separator:a3849ef0f90b5798c571259313a3d501a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61510e69bdaee84a01cf33943b043a5c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a61510e69bdaee84a01cf33943b043a5c">WriteMultiLevelPlotfileWithTerrain</a> (const std::string &amp;plotfilename, int nlevels, const amrex::Vector&lt; const amrex::MultiFab * &gt; &amp;mf, const amrex::Vector&lt; const amrex::MultiFab * &gt; &amp;mf_nd, const amrex::Vector&lt; std::string &gt; &amp;varnames, const amrex::Vector&lt; amrex::Geometry &gt; &amp;my_geom, amrex::Real time, const amrex::Vector&lt; int &gt; &amp;level_steps, const amrex::Vector&lt; amrex::IntVect &gt; &amp;my_ref_ratio, const std::string &amp;versionName=&quot;HyperCLaw-V1.1&quot;, const std::string &amp;levelPrefix=&quot;Level_&quot;, const std::string &amp;mfPrefix=&quot;Cell&quot;, const amrex::Vector&lt; std::string &gt; &amp;extra_dirs=amrex::Vector&lt; std::string &gt;()) const</td></tr>
<tr class="separator:a61510e69bdaee84a01cf33943b043a5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a918bd26ed0c1dc2efa75c2586ff664"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a3a918bd26ed0c1dc2efa75c2586ff664">WriteGenericPlotfileHeaderWithTerrain</a> (std::ostream &amp;HeaderFile, int nlevels, const amrex::Vector&lt; amrex::BoxArray &gt; &amp;bArray, const amrex::Vector&lt; std::string &gt; &amp;varnames, const amrex::Vector&lt; amrex::Geometry &gt; &amp;my_geom, amrex::Real time, const amrex::Vector&lt; int &gt; &amp;level_steps, const amrex::Vector&lt; amrex::IntVect &gt; &amp;my_ref_ratio, const std::string &amp;versionName, const std::string &amp;levelPrefix, const std::string &amp;mfPrefix) const</td></tr>
<tr class="separator:a3a918bd26ed0c1dc2efa75c2586ff664"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29929644893f3e44beb5ed9403cbdaac"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a29929644893f3e44beb5ed9403cbdaac">erf_enforce_hse</a> (int lev, amrex::MultiFab &amp;dens, amrex::MultiFab &amp;pres, amrex::MultiFab &amp;pi, amrex::MultiFab &amp;th, amrex::MultiFab &amp;qv, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;z_cc)</td></tr>
<tr class="separator:a29929644893f3e44beb5ed9403cbdaac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2908bcd920ab5e3fef171a37302853ec"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a2908bcd920ab5e3fef171a37302853ec">init_from_input_sounding</a> (int lev)</td></tr>
<tr class="separator:a2908bcd920ab5e3fef171a37302853ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfdc95a7c3cf7e413c1352bac38c93e8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#abfdc95a7c3cf7e413c1352bac38c93e8">input_sponge</a> (int lev)</td></tr>
<tr class="separator:abfdc95a7c3cf7e413c1352bac38c93e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a857a8f76768ec4451b995cbf4f4ac176"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a857a8f76768ec4451b995cbf4f4ac176">init_from_hse</a> (int lev)</td></tr>
<tr class="separator:a857a8f76768ec4451b995cbf4f4ac176"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4f87fb01d61c18d8eb85ac5ac159785"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#af4f87fb01d61c18d8eb85ac5ac159785">init_thin_body</a> (int lev, const amrex::BoxArray &amp;ba, const amrex::DistributionMapping &amp;dm)</td></tr>
<tr class="separator:af4f87fb01d61c18d8eb85ac5ac159785"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2135641de33dea5057799569c74cac42"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a2135641de33dea5057799569c74cac42">fill_from_bndryregs</a> (const amrex::Vector&lt; amrex::MultiFab * &gt; &amp;mfs, amrex::Real time)</td></tr>
<tr class="separator:a2135641de33dea5057799569c74cac42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0572de619e757aab7ad9a4e0c7967da4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a0572de619e757aab7ad9a4e0c7967da4">MakeEBGeometry</a> ()</td></tr>
<tr class="separator:a0572de619e757aab7ad9a4e0c7967da4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0cf9cd65604501647629fd69a0d28bb6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a0cf9cd65604501647629fd69a0d28bb6">make_eb_box</a> ()</td></tr>
<tr class="separator:a0cf9cd65604501647629fd69a0d28bb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeca994ecf1b09d58cdc991920504ec34"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aeca994ecf1b09d58cdc991920504ec34">make_eb_regular</a> ()</td></tr>
<tr class="separator:aeca994ecf1b09d58cdc991920504ec34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae17524f168760cf435685a08d97480e7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ae17524f168760cf435685a08d97480e7">AverageDownTo</a> (int crse_lev, int scomp, int ncomp)</td></tr>
<tr class="separator:ae17524f168760cf435685a08d97480e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad101fd46096db2d6b21544bfede6551f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ad101fd46096db2d6b21544bfede6551f">WriteCheckpointFile</a> () const</td></tr>
<tr class="separator:ad101fd46096db2d6b21544bfede6551f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af285247b24b173cd851fe49799d17f42"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#af285247b24b173cd851fe49799d17f42">ReadCheckpointFile</a> ()</td></tr>
<tr class="separator:af285247b24b173cd851fe49799d17f42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afdd04d6a1c2103e654f0cb6eda62436d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#afdd04d6a1c2103e654f0cb6eda62436d">ReadCheckpointFileSurfaceLayer</a> ()</td></tr>
<tr class="separator:afdd04d6a1c2103e654f0cb6eda62436d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f50cd1ba85fbf9ae0579a56ba06eb1b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a8f50cd1ba85fbf9ae0579a56ba06eb1b">init_zphys</a> (int lev, amrex::Real time)</td></tr>
<tr class="separator:a8f50cd1ba85fbf9ae0579a56ba06eb1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a691172d44ab3e8b4d6fb18c068cc1ab4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a691172d44ab3e8b4d6fb18c068cc1ab4">remake_zphys</a> (int lev, amrex::Real time, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;temp_zphys_nd)</td></tr>
<tr class="separator:a691172d44ab3e8b4d6fb18c068cc1ab4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7dba7f9e6bd3f6898fac9ac2efcec692"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a7dba7f9e6bd3f6898fac9ac2efcec692">update_terrain_arrays</a> (int lev)</td></tr>
<tr class="separator:a7dba7f9e6bd3f6898fac9ac2efcec692"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2d8099655a8779836e63e3e98ea4372"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aa2d8099655a8779836e63e3e98ea4372">writeJobInfo</a> (const std::string &amp;dir) const</td></tr>
<tr class="separator:aa2d8099655a8779836e63e3e98ea4372"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:ad4c61fad53912d1e8d0f774d365bcf0f"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ad4c61fad53912d1e8d0f774d365bcf0f">is_it_time_for_action</a> (int nstep, amrex::Real time, amrex::Real <a class="el" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>, int action_interval, amrex::Real action_per)</td></tr>
<tr class="separator:ad4c61fad53912d1e8d0f774d365bcf0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6afed5b3a72ca80ccf0d791b08516aa"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ae6afed5b3a72ca80ccf0d791b08516aa">writeBuildInfo</a> (std::ostream &amp;os)</td></tr>
<tr class="separator:ae6afed5b3a72ca80ccf0d791b08516aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a8eb6bc00080cdbd8df28f6a321ac72"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a1a8eb6bc00080cdbd8df28f6a321ac72">print_banner</a> (MPI_Comm, std::ostream &amp;)</td></tr>
<tr class="separator:a1a8eb6bc00080cdbd8df28f6a321ac72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeaeb11001478b0635ef0fe3baa396df1"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aeaeb11001478b0635ef0fe3baa396df1">print_usage</a> (MPI_Comm, std::ostream &amp;)</td></tr>
<tr class="separator:aeaeb11001478b0635ef0fe3baa396df1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addc510dbf758a33cc095d64a9b17076c"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#addc510dbf758a33cc095d64a9b17076c">print_error</a> (MPI_Comm, const std::string &amp;msg)</td></tr>
<tr class="separator:addc510dbf758a33cc095d64a9b17076c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa432756254529fb37b921088f0960d2"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#afa432756254529fb37b921088f0960d2">print_summary</a> (std::ostream &amp;)</td></tr>
<tr class="separator:afa432756254529fb37b921088f0960d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15af18ae136cf3a11bb63fe0cf3924c8"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a15af18ae136cf3a11bb63fe0cf3924c8">print_tpls</a> (std::ostream &amp;)</td></tr>
<tr class="separator:a15af18ae136cf3a11bb63fe0cf3924c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a90e949ea154768582dd0aff3d691b0db"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::array&lt; amrex::Real, 2 &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a90e949ea154768582dd0aff3d691b0db">hurricane_track_xy</a></td></tr>
<tr class="separator:a90e949ea154768582dd0aff3d691b0db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59df30e7a5537c8543bb00772bd98b58"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a59df30e7a5537c8543bb00772bd98b58">pp_prefix</a> {&quot;erf&quot;}</td></tr>
<tr class="separator:a59df30e7a5537c8543bb00772bd98b58"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a2d39cd3bdc3d90609ad3b14e266d190a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a2d39cd3bdc3d90609ad3b14e266d190a">ReadParameters</a> ()</td></tr>
<tr class="separator:a2d39cd3bdc3d90609ad3b14e266d190a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad71a033b3fd107465a8621eaf7c77b28"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ad71a033b3fd107465a8621eaf7c77b28">ParameterSanityChecks</a> ()</td></tr>
<tr class="separator:ad71a033b3fd107465a8621eaf7c77b28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8202de1f8f372e3e6fdc483447c6a55f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a8202de1f8f372e3e6fdc483447c6a55f">AverageDown</a> ()</td></tr>
<tr class="separator:a8202de1f8f372e3e6fdc483447c6a55f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a419510fced05e9afc05c466beeeb66f7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a419510fced05e9afc05c466beeeb66f7">update_diffusive_arrays</a> (int lev, const amrex::BoxArray &amp;ba, const amrex::DistributionMapping &amp;dm)</td></tr>
<tr class="separator:a419510fced05e9afc05c466beeeb66f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc284f421c5fd9dd15c0e5cbe4ff5fc8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#adc284f421c5fd9dd15c0e5cbe4ff5fc8">Construct_ERFFillPatchers</a> (int lev)</td></tr>
<tr class="separator:adc284f421c5fd9dd15c0e5cbe4ff5fc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0951404aa6802aad7a3be6b7375dfa2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ac0951404aa6802aad7a3be6b7375dfa2">Define_ERFFillPatchers</a> (int lev)</td></tr>
<tr class="separator:ac0951404aa6802aad7a3be6b7375dfa2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7261c4eb7722af0dfe6cdfb8e2e9e4db"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a7261c4eb7722af0dfe6cdfb8e2e9e4db">init1DArrays</a> ()</td></tr>
<tr class="separator:a7261c4eb7722af0dfe6cdfb8e2e9e4db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a618e8fdff3239cc79d4145d02b1ecaa2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a618e8fdff3239cc79d4145d02b1ecaa2">init_bcs</a> ()</td></tr>
<tr class="separator:a618e8fdff3239cc79d4145d02b1ecaa2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a604939a8058f7efa36a427adb889739c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a604939a8058f7efa36a427adb889739c">init_custom</a> (int lev)</td></tr>
<tr class="separator:a604939a8058f7efa36a427adb889739c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae618963cf90e247b72fbd71d5b13599d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ae618963cf90e247b72fbd71d5b13599d">init_uniform</a> (int lev)</td></tr>
<tr class="separator:ae618963cf90e247b72fbd71d5b13599d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf237fbe118d80f149295c0579608579"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aaf237fbe118d80f149295c0579608579">init_stuff</a> (int lev, const amrex::BoxArray &amp;ba, const amrex::DistributionMapping &amp;dm, amrex::Vector&lt; amrex::MultiFab &gt; &amp;lev_new, amrex::Vector&lt; amrex::MultiFab &gt; &amp;lev_old, amrex::MultiFab &amp;tmp_base_state, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;tmp_zphys_nd)</td></tr>
<tr class="separator:aaf237fbe118d80f149295c0579608579"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa89efe0abf37918ce3f212fb0e26f1bc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aa89efe0abf37918ce3f212fb0e26f1bc">turbPert_update</a> (const int lev, const amrex::Real <a class="el" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>)</td></tr>
<tr class="separator:aa89efe0abf37918ce3f212fb0e26f1bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb76c0633e2ba944c543e7a03a5e9424"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#afb76c0633e2ba944c543e7a03a5e9424">turbPert_amplitude</a> (const int lev)</td></tr>
<tr class="separator:afb76c0633e2ba944c543e7a03a5e9424"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5600f8ce250d4811012719fdf5e85f00"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a5600f8ce250d4811012719fdf5e85f00">initialize_integrator</a> (int lev, amrex::MultiFab &amp;cons_mf, amrex::MultiFab &amp;vel_mf)</td></tr>
<tr class="separator:a5600f8ce250d4811012719fdf5e85f00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac81ec7f74a1be1c4a1e6e15e08385ed5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ac81ec7f74a1be1c4a1e6e15e08385ed5">make_physbcs</a> (int lev)</td></tr>
<tr class="separator:ac81ec7f74a1be1c4a1e6e15e08385ed5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc2898daad269536c1a15443abf3fa75"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#afc2898daad269536c1a15443abf3fa75">initializeMicrophysics</a> (const int &amp;)</td></tr>
<tr class="separator:afc2898daad269536c1a15443abf3fa75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afded764725240c356faffa97dddbe03d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#afded764725240c356faffa97dddbe03d">FillPatch</a> (int lev, amrex::Real time, const amrex::Vector&lt; amrex::MultiFab * &gt; &amp;mfs_vel, bool cons_only=false)</td></tr>
<tr class="separator:afded764725240c356faffa97dddbe03d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb10e650516e54568f879e48f81d6187"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#acb10e650516e54568f879e48f81d6187">FillPatch</a> (int lev, amrex::Real time, const amrex::Vector&lt; amrex::MultiFab * &gt; &amp;mfs_vel, const amrex::Vector&lt; amrex::MultiFab * &gt; &amp;mfs_mom, const amrex::MultiFab &amp;old_base_state, const amrex::MultiFab &amp;new_base_state, bool fillset=true, bool cons_only=false)</td></tr>
<tr class="separator:acb10e650516e54568f879e48f81d6187"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f5c620a402f7b1be46e05c0cbe48743"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a6f5c620a402f7b1be46e05c0cbe48743">FillIntermediatePatch</a> (int lev, amrex::Real time, const amrex::Vector&lt; amrex::MultiFab * &gt; &amp;mfs_vel, const amrex::Vector&lt; amrex::MultiFab * &gt; &amp;mfs_mom, int ng_cons, int ng_vel, bool cons_only, int icomp_cons, int ncomp_cons)</td></tr>
<tr class="separator:a6f5c620a402f7b1be46e05c0cbe48743"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4497025ab94461899960ee067c2c72a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ac4497025ab94461899960ee067c2c72a">FillCoarsePatch</a> (int lev, amrex::Real time)</td></tr>
<tr class="separator:ac4497025ab94461899960ee067c2c72a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff397ccf7eb99c51d7c705a35e85ec5f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aff397ccf7eb99c51d7c705a35e85ec5f">timeStep</a> (int lev, amrex::Real time, int iteration)</td></tr>
<tr class="separator:aff397ccf7eb99c51d7c705a35e85ec5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47413fe5588f7dd71a1d5087a9e804f9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a47413fe5588f7dd71a1d5087a9e804f9">Advance</a> (int lev, amrex::Real time, amrex::Real dt_lev, int iteration, int ncycle)</td></tr>
<tr class="separator:a47413fe5588f7dd71a1d5087a9e804f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92c020bfaa43e40fb5ffc449427a0318"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a92c020bfaa43e40fb5ffc449427a0318">initHSE</a> ()</td></tr>
<tr class="memdesc:a92c020bfaa43e40fb5ffc449427a0318"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize HSE.  <a href="classERF.html#a92c020bfaa43e40fb5ffc449427a0318">More...</a><br /></td></tr>
<tr class="separator:a92c020bfaa43e40fb5ffc449427a0318"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69c8fce3b0f5b28e98240599c2ee16bb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a69c8fce3b0f5b28e98240599c2ee16bb">initHSE</a> (int lev)</td></tr>
<tr class="separator:a69c8fce3b0f5b28e98240599c2ee16bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a039a764a1d942c484e8aea49e87bc046"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a039a764a1d942c484e8aea49e87bc046">initRayleigh</a> ()</td></tr>
<tr class="memdesc:a039a764a1d942c484e8aea49e87bc046"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize Rayleigh damping profiles.  <a href="classERF.html#a039a764a1d942c484e8aea49e87bc046">More...</a><br /></td></tr>
<tr class="separator:a039a764a1d942c484e8aea49e87bc046"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab26ec4f9c35a519063af2a938c1012e6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ab26ec4f9c35a519063af2a938c1012e6">initSponge</a> ()</td></tr>
<tr class="memdesc:ab26ec4f9c35a519063af2a938c1012e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize sponge profiles.  <a href="classERF.html#ab26ec4f9c35a519063af2a938c1012e6">More...</a><br /></td></tr>
<tr class="separator:ab26ec4f9c35a519063af2a938c1012e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0877d5a0263641c13b92d2d16f47b689"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a0877d5a0263641c13b92d2d16f47b689">setRayleighRefFromSounding</a> (bool restarting)</td></tr>
<tr class="memdesc:a0877d5a0263641c13b92d2d16f47b689"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set Rayleigh mean profiles from input sounding.  <a href="classERF.html#a0877d5a0263641c13b92d2d16f47b689">More...</a><br /></td></tr>
<tr class="separator:a0877d5a0263641c13b92d2d16f47b689"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae27a45d751287a887769df20dea60633"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ae27a45d751287a887769df20dea60633">setSpongeRefFromSounding</a> (bool restarting)</td></tr>
<tr class="memdesc:ae27a45d751287a887769df20dea60633"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set sponge mean profiles from input sounding.  <a href="classERF.html#ae27a45d751287a887769df20dea60633">More...</a><br /></td></tr>
<tr class="separator:ae27a45d751287a887769df20dea60633"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa38639155e79bab8a0c283aa6e7afa81"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aa38639155e79bab8a0c283aa6e7afa81">ComputeDt</a> (int step=-1)</td></tr>
<tr class="separator:aa38639155e79bab8a0c283aa6e7afa81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54f6c5d799e51521ad10bb57d29d0c44"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a54f6c5d799e51521ad10bb57d29d0c44">PlotFileName</a> (int lev) const</td></tr>
<tr class="separator:a54f6c5d799e51521ad10bb57d29d0c44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1fcb440c67da60c86372aec1fe871cb7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a1fcb440c67da60c86372aec1fe871cb7">setPlotVariables</a> (const std::string &amp;pp_plot_var_names, amrex::Vector&lt; std::string &gt; &amp;plot_var_names)</td></tr>
<tr class="separator:a1fcb440c67da60c86372aec1fe871cb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7758f75dc7c9029eddc4c58ac0567654"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a7758f75dc7c9029eddc4c58ac0567654">appendPlotVariables</a> (const std::string &amp;pp_plot_var_names, amrex::Vector&lt; std::string &gt; &amp;plot_var_names)</td></tr>
<tr class="separator:a7758f75dc7c9029eddc4c58ac0567654"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3079a30cce7e1a01d5c9705f393b5a63"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a3079a30cce7e1a01d5c9705f393b5a63">init_Dirichlet_bc_data</a> (const std::string input_file)</td></tr>
<tr class="separator:a3079a30cce7e1a01d5c9705f393b5a63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e1874d47d95c7c858c2a2336fd0eee6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a2e1874d47d95c7c858c2a2336fd0eee6">InitializeFromFile</a> ()</td></tr>
<tr class="separator:a2e1874d47d95c7c858c2a2336fd0eee6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a914f576acc2d1a54203a220cce10df62"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a914f576acc2d1a54203a220cce10df62">InitializeLevelFromData</a> (int lev, const amrex::MultiFab &amp;initial_data)</td></tr>
<tr class="separator:a914f576acc2d1a54203a220cce10df62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adca0cddd75f33ecb5fb8e0ef9601dae4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#adca0cddd75f33ecb5fb8e0ef9601dae4">post_update</a> (amrex::MultiFab &amp;state_mf, amrex::Real time, const amrex::Geometry &amp;geom)</td></tr>
<tr class="separator:adca0cddd75f33ecb5fb8e0ef9601dae4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76600d7a4a0451c9727d2cc57dae4220"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a76600d7a4a0451c9727d2cc57dae4220">fill_rhs</a> (amrex::MultiFab &amp;rhs_mf, const amrex::MultiFab &amp;state_mf, amrex::Real time, const amrex::Geometry &amp;geom)</td></tr>
<tr class="separator:a76600d7a4a0451c9727d2cc57dae4220"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab564dd3009ef83466b50db6d997b563"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aab564dd3009ef83466b50db6d997b563">init_geo_wind_profile</a> (const std::string input_file, amrex::Vector&lt; amrex::Real &gt; &amp;u_geos, amrex::Gpu::DeviceVector&lt; amrex::Real &gt; &amp;u_geos_d, amrex::Vector&lt; amrex::Real &gt; &amp;v_geos, amrex::Gpu::DeviceVector&lt; amrex::Real &gt; &amp;v_geos_d, const amrex::Geometry &amp;lgeom, const amrex::Vector&lt; amrex::Real &gt; &amp;zlev_stag)</td></tr>
<tr class="separator:aab564dd3009ef83466b50db6d997b563"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa90c9756f684404f8b69b8a23568b535"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aa90c9756f684404f8b69b8a23568b535">refinement_criteria_setup</a> ()</td></tr>
<tr class="separator:aa90c9756f684404f8b69b8a23568b535"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d6d990d8111c170692b1e9cc0e918b8"><td class="memItemLeft" align="right" valign="top">AMREX_FORCE_INLINE amrex::YAFluxRegister *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a4d6d990d8111c170692b1e9cc0e918b8">getAdvFluxReg</a> (int lev)</td></tr>
<tr class="separator:a4d6d990d8111c170692b1e9cc0e918b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2c3ee1910008b828b9da79ccdfe3871"><td class="memItemLeft" align="right" valign="top">AMREX_FORCE_INLINE std::ostream &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aa2c3ee1910008b828b9da79ccdfe3871">DataLog</a> (int i)</td></tr>
<tr class="separator:aa2c3ee1910008b828b9da79ccdfe3871"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07b6ef88ba692152c19381858e2a639e"><td class="memItemLeft" align="right" valign="top">AMREX_FORCE_INLINE std::ostream &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a07b6ef88ba692152c19381858e2a639e">DerDataLog</a> (int i)</td></tr>
<tr class="separator:a07b6ef88ba692152c19381858e2a639e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1238c1616826c66df1dfd9076e6a3da"><td class="memItemLeft" align="right" valign="top">AMREX_FORCE_INLINE int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ac1238c1616826c66df1dfd9076e6a3da">NumDataLogs</a> () noexcept</td></tr>
<tr class="separator:ac1238c1616826c66df1dfd9076e6a3da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf7926f64e3747680861aba9afe5d219"><td class="memItemLeft" align="right" valign="top">AMREX_FORCE_INLINE int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#acf7926f64e3747680861aba9afe5d219">NumDerDataLogs</a> () noexcept</td></tr>
<tr class="separator:acf7926f64e3747680861aba9afe5d219"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5f6c32cc5463e52901f21117d3156c7"><td class="memItemLeft" align="right" valign="top">AMREX_FORCE_INLINE std::ostream &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#af5f6c32cc5463e52901f21117d3156c7">SamplePointLog</a> (int i)</td></tr>
<tr class="separator:af5f6c32cc5463e52901f21117d3156c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41324a4b5610fde725fe721550b23c85"><td class="memItemLeft" align="right" valign="top">AMREX_FORCE_INLINE int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a41324a4b5610fde725fe721550b23c85">NumSamplePointLogs</a> () noexcept</td></tr>
<tr class="separator:a41324a4b5610fde725fe721550b23c85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa559426d0435e669b04148c58b20caef"><td class="memItemLeft" align="right" valign="top">AMREX_FORCE_INLINE std::ostream &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aa559426d0435e669b04148c58b20caef">SampleLineLog</a> (int i)</td></tr>
<tr class="separator:aa559426d0435e669b04148c58b20caef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14f922bdc3a0f23c087afa32c67ac119"><td class="memItemLeft" align="right" valign="top">AMREX_FORCE_INLINE int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a14f922bdc3a0f23c087afa32c67ac119">NumSampleLineLogs</a> () noexcept</td></tr>
<tr class="separator:a14f922bdc3a0f23c087afa32c67ac119"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9095d1b641b4d7f32ca5acb679786891"><td class="memItemLeft" align="right" valign="top">amrex::IntVect &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a9095d1b641b4d7f32ca5acb679786891">SamplePoint</a> (int i)</td></tr>
<tr class="separator:a9095d1b641b4d7f32ca5acb679786891"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5bc7dd2c7e1ebf65b7dc1d9bf0dfb36f"><td class="memItemLeft" align="right" valign="top">AMREX_FORCE_INLINE int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a5bc7dd2c7e1ebf65b7dc1d9bf0dfb36f">NumSamplePoints</a> () noexcept</td></tr>
<tr class="separator:a5bc7dd2c7e1ebf65b7dc1d9bf0dfb36f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54357e2f81f3d7d3a9189a3e21283e6b"><td class="memItemLeft" align="right" valign="top">amrex::IntVect &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a54357e2f81f3d7d3a9189a3e21283e6b">SampleLine</a> (int i)</td></tr>
<tr class="separator:a54357e2f81f3d7d3a9189a3e21283e6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70d78ca624acf09d8faab9a2d51264d9"><td class="memItemLeft" align="right" valign="top">AMREX_FORCE_INLINE int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a70d78ca624acf09d8faab9a2d51264d9">NumSampleLines</a> () noexcept</td></tr>
<tr class="separator:a70d78ca624acf09d8faab9a2d51264d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2486b49bb0d7917f812318822e42a03c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a2486b49bb0d7917f812318822e42a03c">setRecordDataInfo</a> (int i, const std::string &amp;filename)</td></tr>
<tr class="separator:a2486b49bb0d7917f812318822e42a03c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a967434ca06be557118b7a4a27a0b6f1f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a967434ca06be557118b7a4a27a0b6f1f">setRecordDerDataInfo</a> (int i, const std::string &amp;filename)</td></tr>
<tr class="separator:a967434ca06be557118b7a4a27a0b6f1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1a50d2d5abc5bd1d51417583184ac52"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ac1a50d2d5abc5bd1d51417583184ac52">setRecordEnergyDataInfo</a> (int i, const std::string &amp;filename)</td></tr>
<tr class="separator:ac1a50d2d5abc5bd1d51417583184ac52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8d930dce1b926ecc3bdc6787dd47818"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#af8d930dce1b926ecc3bdc6787dd47818">setRecordSamplePointInfo</a> (int i, int lev, amrex::IntVect &amp;cell, const std::string &amp;filename)</td></tr>
<tr class="separator:af8d930dce1b926ecc3bdc6787dd47818"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1a8856961aaee53016122facba03dbe"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ae1a8856961aaee53016122facba03dbe">setRecordSampleLineInfo</a> (int i, int lev, amrex::IntVect &amp;cell, const std::string &amp;filename)</td></tr>
<tr class="separator:ae1a8856961aaee53016122facba03dbe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16e1f6b8bbb05ae738daf2abe626c159"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a16e1f6b8bbb05ae738daf2abe626c159">DataLogName</a> (int i) const noexcept</td></tr>
<tr class="memdesc:a16e1f6b8bbb05ae738daf2abe626c159"><td class="mdescLeft">&#160;</td><td class="mdescRight">The filename of the ith datalog file.  <a href="classERF.html#a16e1f6b8bbb05ae738daf2abe626c159">More...</a><br /></td></tr>
<tr class="separator:a16e1f6b8bbb05ae738daf2abe626c159"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a686848a6c86017d484dc204cee7d979f"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a686848a6c86017d484dc204cee7d979f">DerDataLogName</a> (int i) const noexcept</td></tr>
<tr class="separator:a686848a6c86017d484dc204cee7d979f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa87242f053bfae4efb2a7698ef417ab9"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aa87242f053bfae4efb2a7698ef417ab9">SamplePointLogName</a> (int i) const noexcept</td></tr>
<tr class="memdesc:aa87242f053bfae4efb2a7698ef417ab9"><td class="mdescLeft">&#160;</td><td class="mdescRight">The filename of the ith sampleptlog file.  <a href="classERF.html#aa87242f053bfae4efb2a7698ef417ab9">More...</a><br /></td></tr>
<tr class="separator:aa87242f053bfae4efb2a7698ef417ab9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59eae161173111d66e88dc3acc65b552"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a59eae161173111d66e88dc3acc65b552">SampleLineLogName</a> (int i) const noexcept</td></tr>
<tr class="memdesc:a59eae161173111d66e88dc3acc65b552"><td class="mdescLeft">&#160;</td><td class="mdescRight">The filename of the ith samplelinelog file.  <a href="classERF.html#a59eae161173111d66e88dc3acc65b552">More...</a><br /></td></tr>
<tr class="separator:a59eae161173111d66e88dc3acc65b552"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ae1074c3047ab0eb8286f73f5d4be0e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classeb__.html">eb_</a> const  &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a2ae1074c3047ab0eb8286f73f5d4be0e">get_eb</a> (int lev) const noexcept</td></tr>
<tr class="separator:a2ae1074c3047ab0eb8286f73f5d4be0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad024dd413ab20e5d6f69c1f96e5b78a3"><td class="memItemLeft" align="right" valign="top">amrex::EBFArrayBoxFactory const  &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ad024dd413ab20e5d6f69c1f96e5b78a3">EBFactory</a> (int lev) const noexcept</td></tr>
<tr class="separator:ad024dd413ab20e5d6f69c1f96e5b78a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-methods"></a>
Static Private Member Functions</h2></td></tr>
<tr class="memitem:a2dcd22cb915d923c687f60267f44542b"><td class="memItemLeft" align="right" valign="top">static amrex::Vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a2dcd22cb915d923c687f60267f44542b">PlotFileVarNames</a> (amrex::Vector&lt; std::string &gt; plot_var_names)</td></tr>
<tr class="separator:a2dcd22cb915d923c687f60267f44542b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaee255b031e63bd9b5807f6612739dbd"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aaee255b031e63bd9b5807f6612739dbd">GotoNextLine</a> (std::istream &amp;is)</td></tr>
<tr class="separator:aaee255b031e63bd9b5807f6612739dbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaad87d9eb7e20af21deb83d72f94801c"><td class="memItemLeft" align="right" valign="top">static AMREX_FORCE_INLINE int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aaad87d9eb7e20af21deb83d72f94801c">ComputeGhostCells</a> (const <a class="el" href="structSolverChoice.html">SolverChoice</a> &amp;sc)</td></tr>
<tr class="separator:aaad87d9eb7e20af21deb83d72f94801c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0597da6edf955cd138e52fd00380ff2"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ae0597da6edf955cd138e52fd00380ff2">getCPUTime</a> ()</td></tr>
<tr class="separator:ae0597da6edf955cd138e52fd00380ff2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4601db3087123d6a13e492f742b30d57"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a4601db3087123d6a13e492f742b30d57">nghost_eb_basic</a> ()</td></tr>
<tr class="separator:a4601db3087123d6a13e492f742b30d57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa99507cc3dcb872b74a5491355cd4aa"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aaa99507cc3dcb872b74a5491355cd4aa">nghost_eb_volume</a> ()</td></tr>
<tr class="separator:aaa99507cc3dcb872b74a5491355cd4aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae2f7aa83a893d93b92761cd311f4790"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aae2f7aa83a893d93b92761cd311f4790">nghost_eb_full</a> ()</td></tr>
<tr class="separator:aae2f7aa83a893d93b92761cd311f4790"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:ab54f3fc49bad059469da4e34c82296a6"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ab54f3fc49bad059469da4e34c82296a6">sinPhi_m</a></td></tr>
<tr class="separator:ab54f3fc49bad059469da4e34c82296a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6a92272a5ad07f176892de07353f268"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ad6a92272a5ad07f176892de07353f268">cosPhi_m</a></td></tr>
<tr class="separator:ad6a92272a5ad07f176892de07353f268"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83572d8dfad51158945b4a5ab06b2f72"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structInputSoundingData.html">InputSoundingData</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a83572d8dfad51158945b4a5ab06b2f72">input_sounding_data</a></td></tr>
<tr class="separator:a83572d8dfad51158945b4a5ab06b2f72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8cb877a46fd94b5294425299dcb9cbaf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structInputSpongeData.html">InputSpongeData</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a8cb877a46fd94b5294425299dcb9cbaf">input_sponge_data</a></td></tr>
<tr class="separator:a8cb877a46fd94b5294425299dcb9cbaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a902f60d94be5eaf86361d1d5ad942105"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Gpu::DeviceVector&lt; amrex::Real &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a902f60d94be5eaf86361d1d5ad942105">xvel_bc_data</a></td></tr>
<tr class="separator:a902f60d94be5eaf86361d1d5ad942105"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5e40fcd6dd76c80d0b5b09be5baef97"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Gpu::DeviceVector&lt; amrex::Real &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ae5e40fcd6dd76c80d0b5b09be5baef97">yvel_bc_data</a></td></tr>
<tr class="separator:ae5e40fcd6dd76c80d0b5b09be5baef97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae08c25dcf643c6ef39f27d7dd0cb7423"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Gpu::DeviceVector&lt; amrex::Real &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ae08c25dcf643c6ef39f27d7dd0cb7423">zvel_bc_data</a></td></tr>
<tr class="separator:ae08c25dcf643c6ef39f27d7dd0cb7423"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67c86c65b27f8ceee58b5ca989116e14"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Gpu::DeviceVector&lt; amrex::Real &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a67c86c65b27f8ceee58b5ca989116e14">th_bc_data</a></td></tr>
<tr class="separator:a67c86c65b27f8ceee58b5ca989116e14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60e8cb933f237903e3fbcd6376c26db0"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classProblemBase.html">ProblemBase</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a60e8cb933f237903e3fbcd6376c26db0">prob</a> = nullptr</td></tr>
<tr class="separator:a60e8cb933f237903e3fbcd6376c26db0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcd9f23975ffa605247b41d391c2a2f0"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#adcd9f23975ffa605247b41d391c2a2f0">num_boxes_at_level</a></td></tr>
<tr class="separator:adcd9f23975ffa605247b41d391c2a2f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a610a988f46e0496e6dbd0471ae817f75"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a610a988f46e0496e6dbd0471ae817f75">num_files_at_level</a></td></tr>
<tr class="separator:a610a988f46e0496e6dbd0471ae817f75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a050dbd236c9bf246554a53008e09f683"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Vector&lt; amrex::Box &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a050dbd236c9bf246554a53008e09f683">boxes_at_level</a></td></tr>
<tr class="separator:a050dbd236c9bf246554a53008e09f683"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefa640a036c25b7b770e88a5f838eb2a"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a></td></tr>
<tr class="separator:aefa640a036c25b7b770e88a5f838eb2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3db2dd1b65310c66c4038650c22aaee"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aa3db2dd1b65310c66c4038650c22aaee">nsubsteps</a></td></tr>
<tr class="separator:aa3db2dd1b65310c66c4038650c22aaee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65741b6379d273c19a25cf48bb947614"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a></td></tr>
<tr class="separator:a65741b6379d273c19a25cf48bb947614"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7085d7d5fc94a0f84efc06957267d58e"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a7085d7d5fc94a0f84efc06957267d58e">t_old</a></td></tr>
<tr class="separator:a7085d7d5fc94a0f84efc06957267d58e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad34bae243fdb6c3029f5abe4fb4bca2d"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a></td></tr>
<tr class="separator:ad34bae243fdb6c3029f5abe4fb4bca2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3cf7cb2e51eb7b69cb4079ffc6722459"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; long &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a3cf7cb2e51eb7b69cb4079ffc6722459">dt_mri_ratio</a></td></tr>
<tr class="separator:a3cf7cb2e51eb7b69cb4079ffc6722459"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1204ca4dc5d79f5da191ffbe09dfab9b"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Vector&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a></td></tr>
<tr class="separator:a1204ca4dc5d79f5da191ffbe09dfab9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af31e928baa970a1507dfb0233b352542"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Vector&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a></td></tr>
<tr class="separator:af31e928baa970a1507dfb0233b352542"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29ce17220e488eb840abc53966c34d46"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Vector&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a29ce17220e488eb840abc53966c34d46">gradp</a></td></tr>
<tr class="separator:a29ce17220e488eb840abc53966c34d46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e146164ca6929ec6d4984b6a3f43c81"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a3e146164ca6929ec6d4984b6a3f43c81">vel_t_avg</a></td></tr>
<tr class="separator:a3e146164ca6929ec6d4984b6a3f43c81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6837423e9248e923fcaa1987b59d8160"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a6837423e9248e923fcaa1987b59d8160">t_avg_cnt</a></td></tr>
<tr class="separator:a6837423e9248e923fcaa1987b59d8160"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09d0fb2bd609c898a665d9530a744585"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; <a class="el" href="classMRISplitIntegrator.html">MRISplitIntegrator</a>&lt; amrex::Vector&lt; amrex::MultiFab &gt; &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a09d0fb2bd609c898a665d9530a744585">mri_integrator_mem</a></td></tr>
<tr class="separator:a09d0fb2bd609c898a665d9530a744585"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c5206542d4193bb687f5271be6fe5e5"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::MultiFab &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a0c5206542d4193bb687f5271be6fe5e5">pp_inc</a></td></tr>
<tr class="separator:a0c5206542d4193bb687f5271be6fe5e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e9b04043853d25f2d76edbc0bed2e72"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; <a class="el" href="classERFPhysBCFunct__cons.html">ERFPhysBCFunct_cons</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a2e9b04043853d25f2d76edbc0bed2e72">physbcs_cons</a></td></tr>
<tr class="separator:a2e9b04043853d25f2d76edbc0bed2e72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64e55e5ae9df06433146db657eb9e72e"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; <a class="el" href="classERFPhysBCFunct__u.html">ERFPhysBCFunct_u</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a64e55e5ae9df06433146db657eb9e72e">physbcs_u</a></td></tr>
<tr class="separator:a64e55e5ae9df06433146db657eb9e72e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79231b5cfd4576a742e46ae0082b5121"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; <a class="el" href="classERFPhysBCFunct__v.html">ERFPhysBCFunct_v</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a79231b5cfd4576a742e46ae0082b5121">physbcs_v</a></td></tr>
<tr class="separator:a79231b5cfd4576a742e46ae0082b5121"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45c8ecd777f47732993777a0afb8e140"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; <a class="el" href="classERFPhysBCFunct__w.html">ERFPhysBCFunct_w</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a45c8ecd777f47732993777a0afb8e140">physbcs_w</a></td></tr>
<tr class="separator:a45c8ecd777f47732993777a0afb8e140"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4e7dc93dae16aa2cc94bbb20b699a6f"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; <a class="el" href="classERFPhysBCFunct__base.html">ERFPhysBCFunct_base</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#af4e7dc93dae16aa2cc94bbb20b699a6f">physbcs_base</a></td></tr>
<tr class="separator:af4e7dc93dae16aa2cc94bbb20b699a6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71629ae2fda396472198691b75d83b2e"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a71629ae2fda396472198691b75d83b2e">Theta_prim</a></td></tr>
<tr class="separator:a71629ae2fda396472198691b75d83b2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a521d1faf157e3bccc86c0f26ee923576"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a521d1faf157e3bccc86c0f26ee923576">Qv_prim</a></td></tr>
<tr class="separator:a521d1faf157e3bccc86c0f26ee923576"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57d8432920785f8e58cf11a3232d76b5"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a57d8432920785f8e58cf11a3232d76b5">Qr_prim</a></td></tr>
<tr class="separator:a57d8432920785f8e58cf11a3232d76b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6eecc44323f77917c95869928284f61d"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::MultiFab &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a6eecc44323f77917c95869928284f61d">rU_old</a></td></tr>
<tr class="separator:a6eecc44323f77917c95869928284f61d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01f3db32272f53dc68025f0a98195e57"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::MultiFab &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a01f3db32272f53dc68025f0a98195e57">rU_new</a></td></tr>
<tr class="separator:a01f3db32272f53dc68025f0a98195e57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb64e3b4def989ce68d873aefeed5e0e"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::MultiFab &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aeb64e3b4def989ce68d873aefeed5e0e">rV_old</a></td></tr>
<tr class="separator:aeb64e3b4def989ce68d873aefeed5e0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54e37988486ef96e55e84bd8e91bb688"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::MultiFab &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a54e37988486ef96e55e84bd8e91bb688">rV_new</a></td></tr>
<tr class="separator:a54e37988486ef96e55e84bd8e91bb688"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1fa56ec90f44e3cdf487af46804163f"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::MultiFab &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ac1fa56ec90f44e3cdf487af46804163f">rW_old</a></td></tr>
<tr class="separator:ac1fa56ec90f44e3cdf487af46804163f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa46c0b0d20525aed10f447923e54dde7"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::MultiFab &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aa46c0b0d20525aed10f447923e54dde7">rW_new</a></td></tr>
<tr class="separator:aa46c0b0d20525aed10f447923e54dde7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf7e8e28172eebdfe2224e4ee823310d"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::MultiFab &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aaf7e8e28172eebdfe2224e4ee823310d">zmom_crse_rhs</a></td></tr>
<tr class="separator:aaf7e8e28172eebdfe2224e4ee823310d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b7277d54649219f31fe286eee9d415a"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classMicrophysics.html">Microphysics</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a></td></tr>
<tr class="separator:a4b7277d54649219f31fe286eee9d415a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae00126a9c2738bf6a6cbbe77321c9cfc"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Vector&lt; amrex::MultiFab * &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ae00126a9c2738bf6a6cbbe77321c9cfc">qmoist</a></td></tr>
<tr class="separator:ae00126a9c2738bf6a6cbbe77321c9cfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0e9a78f120ba632d78cbf23c97b851c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classLandSurface.html">LandSurface</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ae0e9a78f120ba632d78cbf23c97b851c">lsm</a></td></tr>
<tr class="separator:ae0e9a78f120ba632d78cbf23c97b851c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad03da3399e893728741fac33100ce476"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Vector&lt; amrex::MultiFab * &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ad03da3399e893728741fac33100ce476">lsm_data</a></td></tr>
<tr class="separator:ad03da3399e893728741fac33100ce476"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5f6a6ceae0087393f386649d8bbbc31"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Vector&lt; amrex::MultiFab * &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aa5f6a6ceae0087393f386649d8bbbc31">lsm_flux</a></td></tr>
<tr class="separator:aa5f6a6ceae0087393f386649d8bbbc31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a609b41a1de9c6b28f23dcdc6843f9ef5"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; <a class="el" href="classIRadiation.html">IRadiation</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a609b41a1de9c6b28f23dcdc6843f9ef5">rad</a></td></tr>
<tr class="separator:a609b41a1de9c6b28f23dcdc6843f9ef5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa4c3753628a106460dbb708277de511"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#afa4c3753628a106460dbb708277de511">qheating_rates</a></td></tr>
<tr class="separator:afa4c3753628a106460dbb708277de511"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a3799aabf8337159aa290946fef8404"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a1a3799aabf8337159aa290946fef8404">sw_lw_fluxes</a></td></tr>
<tr class="separator:a1a3799aabf8337159aa290946fef8404"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69e6a357fd92f2c2ad9f6e0843372b16"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a69e6a357fd92f2c2ad9f6e0843372b16">solar_zenith</a></td></tr>
<tr class="separator:a69e6a357fd92f2c2ad9f6e0843372b16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34f2eb136e6747a7e6461fb95e50076e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a34f2eb136e6747a7e6461fb95e50076e">plot_rad</a> = false</td></tr>
<tr class="separator:a34f2eb136e6747a7e6461fb95e50076e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9194db6f65f3cfa366010648eaa4affd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a9194db6f65f3cfa366010648eaa4affd">rad_datalog_int</a> = -1</td></tr>
<tr class="separator:a9194db6f65f3cfa366010648eaa4affd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9084179f7384e10a519989ffd51fd34"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ad9084179f7384e10a519989ffd51fd34">cf_width</a> {0}</td></tr>
<tr class="separator:ad9084179f7384e10a519989ffd51fd34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e3e2855b6e811596226c167573ad62d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a1e3e2855b6e811596226c167573ad62d">cf_set_width</a> {0}</td></tr>
<tr class="separator:a1e3e2855b6e811596226c167573ad62d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34160ca20fb400ee285664117cb80512"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; <a class="el" href="classERFFillPatcher.html">ERFFillPatcher</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a34160ca20fb400ee285664117cb80512">FPr_c</a></td></tr>
<tr class="separator:a34160ca20fb400ee285664117cb80512"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ef3455d5b4fc9a178e023b233d389a4"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; <a class="el" href="classERFFillPatcher.html">ERFFillPatcher</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a0ef3455d5b4fc9a178e023b233d389a4">FPr_u</a></td></tr>
<tr class="separator:a0ef3455d5b4fc9a178e023b233d389a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1dc7086aec533a042e6033706845b0c3"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; <a class="el" href="classERFFillPatcher.html">ERFFillPatcher</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a1dc7086aec533a042e6033706845b0c3">FPr_v</a></td></tr>
<tr class="separator:a1dc7086aec533a042e6033706845b0c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9a11403c2238d0d1e7b65b2d100dbaf"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; <a class="el" href="classERFFillPatcher.html">ERFFillPatcher</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ac9a11403c2238d0d1e7b65b2d100dbaf">FPr_w</a></td></tr>
<tr class="separator:ac9a11403c2238d0d1e7b65b2d100dbaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d4a3ed54fb357c02e6494461f182aa1"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a3d4a3ed54fb357c02e6494461f182aa1">Tau</a></td></tr>
<tr class="separator:a3d4a3ed54fb357c02e6494461f182aa1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a327d704704abd516be19339cb2d226f9"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a327d704704abd516be19339cb2d226f9">eddyDiffs_lev</a></td></tr>
<tr class="separator:a327d704704abd516be19339cb2d226f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9faaa96a7c270d2b2b062d9f30f19711"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a9faaa96a7c270d2b2b062d9f30f19711">SmnSmn_lev</a></td></tr>
<tr class="separator:a9faaa96a7c270d2b2b062d9f30f19711"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a5395054a212d8f3fc577562c14b66e"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a5a5395054a212d8f3fc577562c14b66e">sst_lev</a></td></tr>
<tr class="separator:a5a5395054a212d8f3fc577562c14b66e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af89fb8b555dde334c978cdfd3fcd9d07"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#af89fb8b555dde334c978cdfd3fcd9d07">tsk_lev</a></td></tr>
<tr class="separator:af89fb8b555dde334c978cdfd3fcd9d07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f3e29874221e43e13e2a431e77e0e4e"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Vector&lt; std::unique_ptr&lt; amrex::iMultiFab &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a3f3e29874221e43e13e2a431e77e0e4e">lmask_lev</a></td></tr>
<tr class="separator:a3f3e29874221e43e13e2a431e77e0e4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25174b4ae6cfcac8f7d183ce5c9fe67b"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a25174b4ae6cfcac8f7d183ce5c9fe67b">SFS_hfx1_lev</a></td></tr>
<tr class="separator:a25174b4ae6cfcac8f7d183ce5c9fe67b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb607b2e675b45fdcabc09b640ce5ae2"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#acb607b2e675b45fdcabc09b640ce5ae2">SFS_hfx2_lev</a></td></tr>
<tr class="separator:acb607b2e675b45fdcabc09b640ce5ae2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a2e3faf5dd90ad2f9ded28b486f3b46"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a1a2e3faf5dd90ad2f9ded28b486f3b46">SFS_hfx3_lev</a></td></tr>
<tr class="separator:a1a2e3faf5dd90ad2f9ded28b486f3b46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e1ad417e3bd062468d74830b65911fb"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a6e1ad417e3bd062468d74830b65911fb">SFS_diss_lev</a></td></tr>
<tr class="separator:a6e1ad417e3bd062468d74830b65911fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0316d5ae567a2da8439d204bace12ce"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ae0316d5ae567a2da8439d204bace12ce">SFS_q1fx1_lev</a></td></tr>
<tr class="separator:ae0316d5ae567a2da8439d204bace12ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53fab1172ec3f01356355f8cda0919fe"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a53fab1172ec3f01356355f8cda0919fe">SFS_q1fx2_lev</a></td></tr>
<tr class="separator:a53fab1172ec3f01356355f8cda0919fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a101ceb89b1a249efeea3f4e8052bc8c0"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a101ceb89b1a249efeea3f4e8052bc8c0">SFS_q1fx3_lev</a></td></tr>
<tr class="separator:a101ceb89b1a249efeea3f4e8052bc8c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ea10ef7383e594b6ee5e7a9ad67607b"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a3ea10ef7383e594b6ee5e7a9ad67607b">SFS_q2fx3_lev</a></td></tr>
<tr class="separator:a3ea10ef7383e594b6ee5e7a9ad67607b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace4f0c79f84075dd7a43bd2b0ede1a9b"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Vector&lt; amrex::Real &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a></td></tr>
<tr class="separator:ace4f0c79f84075dd7a43bd2b0ede1a9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93e63e5af35efa564fd4195e8703f84c"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a></td></tr>
<tr class="separator:a93e63e5af35efa564fd4195e8703f84c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31be0f1ae705c52c8ccc520369013284"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a></td></tr>
<tr class="separator:a31be0f1ae705c52c8ccc520369013284"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30f8b851ed29d38695d44cff257f14e6"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">detJ_cc</a></td></tr>
<tr class="separator:a30f8b851ed29d38695d44cff257f14e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93bc9185c89cbeaceffaf40b8cf4a75c"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a93bc9185c89cbeaceffaf40b8cf4a75c">ax</a></td></tr>
<tr class="separator:a93bc9185c89cbeaceffaf40b8cf4a75c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade870f983d113c64406bdcb8a9194044"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ade870f983d113c64406bdcb8a9194044">ay</a></td></tr>
<tr class="separator:ade870f983d113c64406bdcb8a9194044"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a391914523e66645f7e947cefcd19c011"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a391914523e66645f7e947cefcd19c011">az</a></td></tr>
<tr class="separator:a391914523e66645f7e947cefcd19c011"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30dcf40e8f104fb6b6132805d2eff47c"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a30dcf40e8f104fb6b6132805d2eff47c">z_phys_nd_src</a></td></tr>
<tr class="separator:a30dcf40e8f104fb6b6132805d2eff47c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfa333375bd02a72cc80ba1e7552aba5"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#abfa333375bd02a72cc80ba1e7552aba5">z_phys_cc_src</a></td></tr>
<tr class="separator:abfa333375bd02a72cc80ba1e7552aba5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a411e0ea9d9bdbfab957c8081229091"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a9a411e0ea9d9bdbfab957c8081229091">detJ_cc_src</a></td></tr>
<tr class="separator:a9a411e0ea9d9bdbfab957c8081229091"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe77a4434d27561109ffc666546511dc"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#abe77a4434d27561109ffc666546511dc">ax_src</a></td></tr>
<tr class="separator:abe77a4434d27561109ffc666546511dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa20bd15dbe2c801bda2d3bfdb5b81eab"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aa20bd15dbe2c801bda2d3bfdb5b81eab">ay_src</a></td></tr>
<tr class="separator:aa20bd15dbe2c801bda2d3bfdb5b81eab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2d8e37fbdac323eda857e0b8c151852"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ad2d8e37fbdac323eda857e0b8c151852">az_src</a></td></tr>
<tr class="separator:ad2d8e37fbdac323eda857e0b8c151852"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ef635c22e72c715f5703a6b95a7abe5"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a4ef635c22e72c715f5703a6b95a7abe5">z_phys_nd_new</a></td></tr>
<tr class="separator:a4ef635c22e72c715f5703a6b95a7abe5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae39bf64c5306b1dd939d82d9df728daa"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ae39bf64c5306b1dd939d82d9df728daa">detJ_cc_new</a></td></tr>
<tr class="separator:ae39bf64c5306b1dd939d82d9df728daa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72a59614c6d5ab840b924c84d5682270"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a72a59614c6d5ab840b924c84d5682270">z_t_rk</a></td></tr>
<tr class="separator:a72a59614c6d5ab840b924c84d5682270"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a18cc3befd0911ccb011f9bb3b2efc2"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a4a18cc3befd0911ccb011f9bb3b2efc2">terrain_blanking</a></td></tr>
<tr class="separator:a4a18cc3befd0911ccb011f9bb3b2efc2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0276b556fdefec8b99be95846a3a35fe"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a0276b556fdefec8b99be95846a3a35fe">walldist</a></td></tr>
<tr class="separator:a0276b556fdefec8b99be95846a3a35fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07e1772db360d39195824a6237bca9aa"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a></td></tr>
<tr class="separator:a07e1772db360d39195824a6237bca9aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0981b0ff70e6d78acbb7769f7a142b7"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Vector&lt; amrex::Real &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ad0981b0ff70e6d78acbb7769f7a142b7">stretched_dz_h</a></td></tr>
<tr class="separator:ad0981b0ff70e6d78acbb7769f7a142b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6600f30f1043a4c5e62b5cdd05f0a99f"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Gpu::DeviceVector&lt; amrex::Real &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a6600f30f1043a4c5e62b5cdd05f0a99f">stretched_dz_d</a></td></tr>
<tr class="separator:a6600f30f1043a4c5e62b5cdd05f0a99f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c1fae5e620fcd64cc9ede73715e3b7c"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::MultiFab &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a></td></tr>
<tr class="separator:a4c1fae5e620fcd64cc9ede73715e3b7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37b2a4257df8ff53d4450de47f16ace1"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::MultiFab &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a37b2a4257df8ff53d4450de47f16ace1">base_state_new</a></td></tr>
<tr class="separator:a37b2a4257df8ff53d4450de47f16ace1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef05cf88e9e9d2b56112336761493977"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aef05cf88e9e9d2b56112336761493977">Hwave</a></td></tr>
<tr class="separator:aef05cf88e9e9d2b56112336761493977"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad67b414a1a8b5bab6edeaf574f922825"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ad67b414a1a8b5bab6edeaf574f922825">Lwave</a></td></tr>
<tr class="separator:ad67b414a1a8b5bab6edeaf574f922825"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11f2d48d9af9b8f4574975cae06838f1"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a11f2d48d9af9b8f4574975cae06838f1">Hwave_onegrid</a></td></tr>
<tr class="separator:a11f2d48d9af9b8f4574975cae06838f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83473e4b18de294a8b97dcdbbf048551"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a83473e4b18de294a8b97dcdbbf048551">Lwave_onegrid</a></td></tr>
<tr class="separator:a83473e4b18de294a8b97dcdbbf048551"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af282e3bdfdad38a0b898ed567ea446ee"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#af282e3bdfdad38a0b898ed567ea446ee">finished_wave</a> = false</td></tr>
<tr class="separator:af282e3bdfdad38a0b898ed567ea446ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86a0bc8e41668411ee0ab5801d4688a7"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::YAFluxRegister * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a86a0bc8e41668411ee0ab5801d4688a7">advflux_reg</a></td></tr>
<tr class="separator:a86a0bc8e41668411ee0ab5801d4688a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a574521986a6e403159f83c8b8123ba90"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::BCRec &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a></td></tr>
<tr class="separator:a574521986a6e403159f83c8b8123ba90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a99e22b1111c803e31b4afd5fcdea60"><td class="memItemLeft" align="right" valign="top">amrex::Gpu::DeviceVector&lt; amrex::BCRec &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a8a99e22b1111c803e31b4afd5fcdea60">domain_bcs_type_d</a></td></tr>
<tr class="separator:a8a99e22b1111c803e31b4afd5fcdea60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5968f1bed602fa87cdd5cb7905b7e5e"><td class="memItemLeft" align="right" valign="top">amrex::Array&lt; std::string, 2 *AMREX_SPACEDIM &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a></td></tr>
<tr class="separator:ae5968f1bed602fa87cdd5cb7905b7e5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27261ba76aa71f1ddbf87bca0ede579f"><td class="memItemLeft" align="right" valign="top">amrex::Array&lt; amrex::Array&lt; amrex::Real, AMREX_SPACEDIM *2 &gt;, AMREX_SPACEDIM+<a class="el" href="ERF__IndexDefines_8H.html#a536619efb901de654431f987753ac67c">NBCVAR_max</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">m_bc_extdir_vals</a></td></tr>
<tr class="separator:a27261ba76aa71f1ddbf87bca0ede579f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af783df8719de2e72e347de5860f71528"><td class="memItemLeft" align="right" valign="top">amrex::Array&lt; amrex::Array&lt; amrex::Real, AMREX_SPACEDIM *2 &gt;, AMREX_SPACEDIM+<a class="el" href="ERF__IndexDefines_8H.html#a536619efb901de654431f987753ac67c">NBCVAR_max</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#af783df8719de2e72e347de5860f71528">m_bc_neumann_vals</a></td></tr>
<tr class="separator:af783df8719de2e72e347de5860f71528"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6df94c25ac21bf6a2e856a9901e3a15"><td class="memItemLeft" align="right" valign="top">amrex::GpuArray&lt; <a class="el" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9">ERF_BC</a>, AMREX_SPACEDIM *2 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a></td></tr>
<tr class="separator:ae6df94c25ac21bf6a2e856a9901e3a15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af044f075df34caa2a530aa13e1801a5b"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::iMultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#af044f075df34caa2a530aa13e1801a5b">xflux_imask</a></td></tr>
<tr class="separator:af044f075df34caa2a530aa13e1801a5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4448d06a3e4fe9740927a636030939d"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::iMultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aa4448d06a3e4fe9740927a636030939d">yflux_imask</a></td></tr>
<tr class="separator:aa4448d06a3e4fe9740927a636030939d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada098767690d194f89717b0deb3adeac"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::iMultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ada098767690d194f89717b0deb3adeac">zflux_imask</a></td></tr>
<tr class="separator:ada098767690d194f89717b0deb3adeac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b9b8d719a87a6940f611c6a30e8ccf5"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a5b9b8d719a87a6940f611c6a30e8ccf5">thin_xforce</a></td></tr>
<tr class="separator:a5b9b8d719a87a6940f611c6a30e8ccf5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18c1142552120bbd22987f34995ee939"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a18c1142552120bbd22987f34995ee939">thin_yforce</a></td></tr>
<tr class="separator:a18c1142552120bbd22987f34995ee939"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56a23d298bc66218bf257d0e793e341f"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a56a23d298bc66218bf257d0e793e341f">thin_zforce</a></td></tr>
<tr class="separator:a56a23d298bc66218bf257d0e793e341f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d54d3f2317d06a8dfcde4f65cfc3e92"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a7d54d3f2317d06a8dfcde4f65cfc3e92">last_plot_file_step_1</a></td></tr>
<tr class="separator:a7d54d3f2317d06a8dfcde4f65cfc3e92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09017292c9943ac2ed20ce7ed5c3c767"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a09017292c9943ac2ed20ce7ed5c3c767">last_plot_file_step_2</a></td></tr>
<tr class="separator:a09017292c9943ac2ed20ce7ed5c3c767"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8536c38a2a5f44a5719cad3c44d0d438"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a8536c38a2a5f44a5719cad3c44d0d438">last_subvol</a></td></tr>
<tr class="separator:a8536c38a2a5f44a5719cad3c44d0d438"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02722d16f3c26efe590702200f1296d7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a02722d16f3c26efe590702200f1296d7">last_check_file_step</a></td></tr>
<tr class="separator:a02722d16f3c26efe590702200f1296d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc00038dfe4c332e5d15f621184c69e8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#adc00038dfe4c332e5d15f621184c69e8">plot_file_on_restart</a> = 1</td></tr>
<tr class="separator:adc00038dfe4c332e5d15f621184c69e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b1cdf332a93c6b0889fd309e43f9a91"><td class="memItemLeft" align="right" valign="top">const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a> = 14</td></tr>
<tr class="separator:a8b1cdf332a93c6b0889fd309e43f9a91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefeb0bde962c9f53aba32e4ab59b4958"><td class="memItemLeft" align="right" valign="top">const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aefeb0bde962c9f53aba32e4ab59b4958">datprecision</a> = 6</td></tr>
<tr class="separator:aefeb0bde962c9f53aba32e4ab59b4958"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2307b817178b00e5cc38c0e163da0a39"><td class="memItemLeft" align="right" valign="top">const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a2307b817178b00e5cc38c0e163da0a39">timeprecision</a> = 13</td></tr>
<tr class="separator:a2307b817178b00e5cc38c0e163da0a39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0634154e8e58379c495c3e7fe7c5e4d6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a0634154e8e58379c495c3e7fe7c5e4d6">max_step</a> = std::numeric_limits&lt;int&gt;::max()</td></tr>
<tr class="separator:a0634154e8e58379c495c3e7fe7c5e4d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0c07f31b23d977646b8161e5473fab5"><td class="memItemLeft" align="right" valign="top">amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aa0c07f31b23d977646b8161e5473fab5">start_time</a> = 0.0</td></tr>
<tr class="separator:aa0c07f31b23d977646b8161e5473fab5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a405556a52bef334ab68294c1a540e107"><td class="memItemLeft" align="right" valign="top">amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a405556a52bef334ab68294c1a540e107">stop_time</a> = std::numeric_limits&lt;amrex::Real&gt;::max()</td></tr>
<tr class="separator:a405556a52bef334ab68294c1a540e107"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90e3592862d7330b39a11399d34a3539"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a90e3592862d7330b39a11399d34a3539">use_datetime</a> = false</td></tr>
<tr class="separator:a90e3592862d7330b39a11399d34a3539"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85bb96a0b6593ee192a04ceef62abdf6"><td class="memItemLeft" align="right" valign="top">const std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a85bb96a0b6593ee192a04ceef62abdf6">datetime_format</a> = &quot;%Y-%m-%d %H:%M:%S&quot;</td></tr>
<tr class="separator:a85bb96a0b6593ee192a04ceef62abdf6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e758060d3dede9694fbfcabddc17169"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a> = &quot;&quot;</td></tr>
<tr class="separator:a8e758060d3dede9694fbfcabddc17169"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a393b540493795b8c6ee0f64634b8b815"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a393b540493795b8c6ee0f64634b8b815">fixed_dt</a></td></tr>
<tr class="separator:a393b540493795b8c6ee0f64634b8b815"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f3f43c6304a0a3ae78c42d54c05ee26"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a4f3f43c6304a0a3ae78c42d54c05ee26">fixed_fast_dt</a></td></tr>
<tr class="separator:a4f3f43c6304a0a3ae78c42d54c05ee26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3937527f96c81674fa38dc34ed24f3f5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a3937527f96c81674fa38dc34ed24f3f5">regrid_int</a> = -1</td></tr>
<tr class="separator:a3937527f96c81674fa38dc34ed24f3f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a833c301baf4bb3ee3c944faad7bf6ee7"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a833c301baf4bb3ee3c944faad7bf6ee7">regrid_level_0_on_restart</a> = false</td></tr>
<tr class="separator:a833c301baf4bb3ee3c944faad7bf6ee7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa54aaa938a18d34caa4d86e977647899"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aa54aaa938a18d34caa4d86e977647899">plot_file_1</a> {&quot;plt_1_&quot;}</td></tr>
<tr class="separator:aa54aaa938a18d34caa4d86e977647899"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18fa84b06132715757d97ec38678aa2c"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a18fa84b06132715757d97ec38678aa2c">plot_file_2</a> {&quot;plt_2_&quot;}</td></tr>
<tr class="separator:a18fa84b06132715757d97ec38678aa2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9183a64262ae944d9b3968c57de9652f"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a9183a64262ae944d9b3968c57de9652f">subvol_file</a> {&quot;subvol&quot;}</td></tr>
<tr class="separator:a9183a64262ae944d9b3968c57de9652f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb272adf862040a2f1a6226c57c35627"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#adb272adf862040a2f1a6226c57c35627">m_expand_plotvars_to_unif_rr</a> = false</td></tr>
<tr class="separator:adb272adf862040a2f1a6226c57c35627"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57cfb4bfead8525174646964992c7e69"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a57cfb4bfead8525174646964992c7e69">m_plot_int_1</a> = -1</td></tr>
<tr class="separator:a57cfb4bfead8525174646964992c7e69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3311c9ceacd17f34bdb5e03cefa33b3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ad3311c9ceacd17f34bdb5e03cefa33b3">m_plot_int_2</a> = -1</td></tr>
<tr class="separator:ad3311c9ceacd17f34bdb5e03cefa33b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2420086cf8dc54d9507c40358930f521"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a2420086cf8dc54d9507c40358930f521">m_subvol_int</a> = -1</td></tr>
<tr class="separator:a2420086cf8dc54d9507c40358930f521"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3167adc9518cce649a90ab82e9f9c85d"><td class="memItemLeft" align="right" valign="top">amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a3167adc9518cce649a90ab82e9f9c85d">m_plot_per_1</a> = -1.0</td></tr>
<tr class="separator:a3167adc9518cce649a90ab82e9f9c85d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff879a9c686293a10a3a03027b765c51"><td class="memItemLeft" align="right" valign="top">amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aff879a9c686293a10a3a03027b765c51">m_plot_per_2</a> = -1.0</td></tr>
<tr class="separator:aff879a9c686293a10a3a03027b765c51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a595273f0f44d0e481a2da65263e5c2ae"><td class="memItemLeft" align="right" valign="top">amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a595273f0f44d0e481a2da65263e5c2ae">m_subvol_per</a> = -1.0</td></tr>
<tr class="separator:a595273f0f44d0e481a2da65263e5c2ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a367a3daba5d844efbed84c52e647cea6"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a367a3daba5d844efbed84c52e647cea6">m_plot_face_vels</a> = false</td></tr>
<tr class="separator:a367a3daba5d844efbed84c52e647cea6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc653b103aa26c56acafed85cdd95f52"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#afc653b103aa26c56acafed85cdd95f52">plot_lsm</a> = false</td></tr>
<tr class="separator:afc653b103aa26c56acafed85cdd95f52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a633cd0b44d2e38f02c23e953aecd69eb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a633cd0b44d2e38f02c23e953aecd69eb">profile_int</a> = -1</td></tr>
<tr class="separator:a633cd0b44d2e38f02c23e953aecd69eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65f19c55c8d3669445866a1c3bbb628d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a65f19c55c8d3669445866a1c3bbb628d">destag_profiles</a> = true</td></tr>
<tr class="separator:a65f19c55c8d3669445866a1c3bbb628d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae701564fbe3da5bbd88587e5a08eca4e"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ae701564fbe3da5bbd88587e5a08eca4e">check_file</a> {&quot;chk&quot;}</td></tr>
<tr class="separator:ae701564fbe3da5bbd88587e5a08eca4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69a3f925e95ec4244b0257f9de16d65a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a69a3f925e95ec4244b0257f9de16d65a">m_check_int</a> = -1</td></tr>
<tr class="separator:a69a3f925e95ec4244b0257f9de16d65a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fbf17cfc8d9e5b994783e05ec3594b2"><td class="memItemLeft" align="right" valign="top">amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a5fbf17cfc8d9e5b994783e05ec3594b2">m_check_per</a> = -1.0</td></tr>
<tr class="separator:a5fbf17cfc8d9e5b994783e05ec3594b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6865cf87abbb5aab0db00ff3b1ce94ac"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a6865cf87abbb5aab0db00ff3b1ce94ac">plot_var_names_1</a></td></tr>
<tr class="separator:a6865cf87abbb5aab0db00ff3b1ce94ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79705c02d6f25fbdcec14ca2432e5da1"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a79705c02d6f25fbdcec14ca2432e5da1">plot_var_names_2</a></td></tr>
<tr class="separator:a79705c02d6f25fbdcec14ca2432e5da1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd8cd5a477754776135befa668fdd0c9"><td class="memItemLeft" align="right" valign="top">const amrex::Vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#afd8cd5a477754776135befa668fdd0c9">cons_names</a></td></tr>
<tr class="separator:afd8cd5a477754776135befa668fdd0c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fc0f6e6ca35036d2e3a36dd42e66435"><td class="memItemLeft" align="right" valign="top">const amrex::Vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a></td></tr>
<tr class="separator:a9fc0f6e6ca35036d2e3a36dd42e66435"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1b9cce4a3c1736c4af78f6b0e2143ce"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structTurbulentPerturbation.html">TurbulentPerturbation</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ac1b9cce4a3c1736c4af78f6b0e2143ce">turbPert</a></td></tr>
<tr class="separator:ac1b9cce4a3c1736c4af78f6b0e2143ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb15119348ad5399947bc8883084b230"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#abb15119348ad5399947bc8883084b230">real_width</a> {0}</td></tr>
<tr class="separator:abb15119348ad5399947bc8883084b230"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acab120bb9324e7298534d765c447d703"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#acab120bb9324e7298534d765c447d703">real_set_width</a> {0}</td></tr>
<tr class="separator:acab120bb9324e7298534d765c447d703"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64c81ad5cd1b7d21c2e597b92596f113"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a64c81ad5cd1b7d21c2e597b92596f113">metgrid_debug_quiescent</a> {false}</td></tr>
<tr class="separator:a64c81ad5cd1b7d21c2e597b92596f113"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab08081c75e6d926825071630f2adddab"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ab08081c75e6d926825071630f2adddab">metgrid_debug_isothermal</a> {false}</td></tr>
<tr class="separator:ab08081c75e6d926825071630f2adddab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaaa067c46e79ca3635d138750642b78d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aaaa067c46e79ca3635d138750642b78d">metgrid_debug_dry</a> {false}</td></tr>
<tr class="separator:aaaa067c46e79ca3635d138750642b78d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad256f0610d54caef208e2b2569a5aa82"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ad256f0610d54caef208e2b2569a5aa82">metgrid_debug_psfc</a> {false}</td></tr>
<tr class="separator:ad256f0610d54caef208e2b2569a5aa82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a079811bdd498e155326a851e0c12f850"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a079811bdd498e155326a851e0c12f850">metgrid_debug_msf</a> {false}</td></tr>
<tr class="separator:a079811bdd498e155326a851e0c12f850"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7eac012575590fe374a8d4b5d9061546"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a7eac012575590fe374a8d4b5d9061546">metgrid_interp_theta</a> {false}</td></tr>
<tr class="separator:a7eac012575590fe374a8d4b5d9061546"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04831a5a6bf49d8386d362379db84358"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a04831a5a6bf49d8386d362379db84358">metgrid_basic_linear</a> {false}</td></tr>
<tr class="separator:a04831a5a6bf49d8386d362379db84358"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8eb60483e48302db4706d3b90c0ae8e4"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a8eb60483e48302db4706d3b90c0ae8e4">metgrid_use_below_sfc</a> {true}</td></tr>
<tr class="separator:a8eb60483e48302db4706d3b90c0ae8e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d2fe657db8c3614db3e797566a49d68"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a5d2fe657db8c3614db3e797566a49d68">metgrid_use_sfc</a> {true}</td></tr>
<tr class="separator:a5d2fe657db8c3614db3e797566a49d68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51e327479a5c37c694bbf14eb8bce94f"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a51e327479a5c37c694bbf14eb8bce94f">metgrid_retain_sfc</a> {false}</td></tr>
<tr class="separator:a51e327479a5c37c694bbf14eb8bce94f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95182a17e10556dde659d4dd891a4ed3"><td class="memItemLeft" align="right" valign="top">amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a95182a17e10556dde659d4dd891a4ed3">metgrid_proximity</a> {500.0}</td></tr>
<tr class="separator:a95182a17e10556dde659d4dd891a4ed3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af27fd93c086c23ab8c754e63e1a0c425"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#af27fd93c086c23ab8c754e63e1a0c425">metgrid_order</a> {2}</td></tr>
<tr class="separator:af27fd93c086c23ab8c754e63e1a0c425"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8767bdb5ac5b0a796dc478dc417e1606"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a8767bdb5ac5b0a796dc478dc417e1606">metgrid_force_sfc_k</a> {6}</td></tr>
<tr class="separator:a8767bdb5ac5b0a796dc478dc417e1606"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c051cb96bfa9ff26929441978aa2a96"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::BoxArray &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a8c051cb96bfa9ff26929441978aa2a96">ba1d</a></td></tr>
<tr class="separator:a8c051cb96bfa9ff26929441978aa2a96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a268a79187ae9a115e601957f8b06cd42"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::BoxArray &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a268a79187ae9a115e601957f8b06cd42">ba2d</a></td></tr>
<tr class="separator:a268a79187ae9a115e601957f8b06cd42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8839af37a73c4c2e76bf978a05275ca9"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a8839af37a73c4c2e76bf978a05275ca9">mf_C1H</a></td></tr>
<tr class="separator:a8839af37a73c4c2e76bf978a05275ca9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad473e8e616ea3f7bf7bf922a0fe16208"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ad473e8e616ea3f7bf7bf922a0fe16208">mf_C2H</a></td></tr>
<tr class="separator:ad473e8e616ea3f7bf7bf922a0fe16208"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed4ae5792dd32adf56d3c052ce79437f"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aed4ae5792dd32adf56d3c052ce79437f">mf_MUB</a></td></tr>
<tr class="separator:aed4ae5792dd32adf56d3c052ce79437f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87aad7caaf3b575734994b47628a2faf"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Vector&lt; amrex::Real &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a87aad7caaf3b575734994b47628a2faf">h_rhotheta_src</a></td></tr>
<tr class="separator:a87aad7caaf3b575734994b47628a2faf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c1fdcfbc9cbd6cb13e41d1170b161f8"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Gpu::DeviceVector&lt; amrex::Real &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a0c1fdcfbc9cbd6cb13e41d1170b161f8">d_rhotheta_src</a></td></tr>
<tr class="separator:a0c1fdcfbc9cbd6cb13e41d1170b161f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c5eca26a28dda3a981b3581abadfca0"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Vector&lt; amrex::Real &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a3c5eca26a28dda3a981b3581abadfca0">h_rhoqt_src</a></td></tr>
<tr class="separator:a3c5eca26a28dda3a981b3581abadfca0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a838687881ef3626f932d0e95ceff0e53"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Gpu::DeviceVector&lt; amrex::Real &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a838687881ef3626f932d0e95ceff0e53">d_rhoqt_src</a></td></tr>
<tr class="separator:a838687881ef3626f932d0e95ceff0e53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a5d0d0b4e8c196f56dfab98f245aff5"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Vector&lt; amrex::Real &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a1a5d0d0b4e8c196f56dfab98f245aff5">h_w_subsid</a></td></tr>
<tr class="separator:a1a5d0d0b4e8c196f56dfab98f245aff5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac94ddee2f501dbcea2a516284b7119b5"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Gpu::DeviceVector&lt; amrex::Real &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ac94ddee2f501dbcea2a516284b7119b5">d_w_subsid</a></td></tr>
<tr class="separator:ac94ddee2f501dbcea2a516284b7119b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a911c70f76cf62f205a1ce152ec4cdb54"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Vector&lt; amrex::Real &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a911c70f76cf62f205a1ce152ec4cdb54">h_u_geos</a></td></tr>
<tr class="separator:a911c70f76cf62f205a1ce152ec4cdb54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac020980af9dbf46be43dd9f7127c06da"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Gpu::DeviceVector&lt; amrex::Real &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ac020980af9dbf46be43dd9f7127c06da">d_u_geos</a></td></tr>
<tr class="separator:ac020980af9dbf46be43dd9f7127c06da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a825daede57fae86805edffd85d5d9dab"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Vector&lt; amrex::Real &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a825daede57fae86805edffd85d5d9dab">h_v_geos</a></td></tr>
<tr class="separator:a825daede57fae86805edffd85d5d9dab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d245afb7b3236b5967902f50bf9000b"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Gpu::DeviceVector&lt; amrex::Real &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a7d245afb7b3236b5967902f50bf9000b">d_v_geos</a></td></tr>
<tr class="separator:a7d245afb7b3236b5967902f50bf9000b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9939824ea7b7d06ab252fed28d5a911"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Vector&lt; amrex::Vector&lt; amrex::Real &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ad9939824ea7b7d06ab252fed28d5a911">h_rayleigh_ptrs</a></td></tr>
<tr class="separator:ad9939824ea7b7d06ab252fed28d5a911"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20a0f0d26791321eb4bbba6baee9f159"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Vector&lt; amrex::Vector&lt; amrex::Real &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a20a0f0d26791321eb4bbba6baee9f159">h_sponge_ptrs</a></td></tr>
<tr class="separator:a20a0f0d26791321eb4bbba6baee9f159"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad598bde8e728479faaa7c2820096b47a"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Vector&lt; amrex::Gpu::DeviceVector&lt; amrex::Real &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ad598bde8e728479faaa7c2820096b47a">d_rayleigh_ptrs</a></td></tr>
<tr class="separator:ad598bde8e728479faaa7c2820096b47a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b9bcb54c278dfec6027e9727cc01bc5"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Vector&lt; amrex::Gpu::DeviceVector&lt; amrex::Real &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a3b9bcb54c278dfec6027e9727cc01bc5">d_sponge_ptrs</a></td></tr>
<tr class="separator:a3b9bcb54c278dfec6027e9727cc01bc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4dd7c603e65d230105a4f1e0afb4cf8a"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a4dd7c603e65d230105a4f1e0afb4cf8a">h_havg_density</a></td></tr>
<tr class="separator:a4dd7c603e65d230105a4f1e0afb4cf8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9683c7b07c287e57856ee5a9c99917a1"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a9683c7b07c287e57856ee5a9c99917a1">h_havg_temperature</a></td></tr>
<tr class="separator:a9683c7b07c287e57856ee5a9c99917a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a413293737b0021c97b50c62756561446"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a413293737b0021c97b50c62756561446">h_havg_pressure</a></td></tr>
<tr class="separator:a413293737b0021c97b50c62756561446"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8de26569516b41e5dc3cbb3419e891c"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ae8de26569516b41e5dc3cbb3419e891c">h_havg_qv</a></td></tr>
<tr class="separator:ae8de26569516b41e5dc3cbb3419e891c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45233bcc95ac50c112b7146595164a8d"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a45233bcc95ac50c112b7146595164a8d">h_havg_qc</a></td></tr>
<tr class="separator:a45233bcc95ac50c112b7146595164a8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84cf7616e7b3928f08f4bd56112db01e"><td class="memItemLeft" align="right" valign="top">amrex::Gpu::DeviceVector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a84cf7616e7b3928f08f4bd56112db01e">d_havg_density</a></td></tr>
<tr class="separator:a84cf7616e7b3928f08f4bd56112db01e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20350959b7b3e252ee3a802e7998ca8d"><td class="memItemLeft" align="right" valign="top">amrex::Gpu::DeviceVector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a20350959b7b3e252ee3a802e7998ca8d">d_havg_temperature</a></td></tr>
<tr class="separator:a20350959b7b3e252ee3a802e7998ca8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a4f076c56f31fbb5e68c09706605a05"><td class="memItemLeft" align="right" valign="top">amrex::Gpu::DeviceVector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a9a4f076c56f31fbb5e68c09706605a05">d_havg_pressure</a></td></tr>
<tr class="separator:a9a4f076c56f31fbb5e68c09706605a05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b0085123e02051ac4c2a72e9972e6ee"><td class="memItemLeft" align="right" valign="top">amrex::Gpu::DeviceVector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a2b0085123e02051ac4c2a72e9972e6ee">d_havg_qv</a></td></tr>
<tr class="separator:a2b0085123e02051ac4c2a72e9972e6ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8199cc1ec38b9dfd47262ccc7df6a941"><td class="memItemLeft" align="right" valign="top">amrex::Gpu::DeviceVector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a8199cc1ec38b9dfd47262ccc7df6a941">d_havg_qc</a></td></tr>
<tr class="separator:a8199cc1ec38b9dfd47262ccc7df6a941"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa53035f34ba133b86172e180abda4209"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classWriteBndryPlanes.html">WriteBndryPlanes</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aa53035f34ba133b86172e180abda4209">m_w2d</a> = nullptr</td></tr>
<tr class="separator:aa53035f34ba133b86172e180abda4209"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addf62bfc534515447b94e928ac0b7135"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classReadBndryPlanes.html">ReadBndryPlanes</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a> = nullptr</td></tr>
<tr class="separator:addf62bfc534515447b94e928ac0b7135"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac50bb696daf587e13f9a1e57c687375e"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classSurfaceLayer.html">SurfaceLayer</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ac50bb696daf587e13f9a1e57c687375e">m_SurfaceLayer</a> = nullptr</td></tr>
<tr class="separator:ac50bb696daf587e13f9a1e57c687375e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b181e6ed0bb62d79e4a62555210abc9"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; <a class="el" href="classForestDrag.html">ForestDrag</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a8b181e6ed0bb62d79e4a62555210abc9">m_forest_drag</a></td></tr>
<tr class="separator:a8b181e6ed0bb62d79e4a62555210abc9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83c244120a15f0d9b9bca54e93976428"><td class="memItemLeft" align="right" valign="top">amrex::MultiFab&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a83c244120a15f0d9b9bca54e93976428">fine_mask</a></td></tr>
<tr class="separator:a83c244120a15f0d9b9bca54e93976428"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15db5266359edba700f523f16da303a7"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a15db5266359edba700f523f16da303a7">dz_min</a></td></tr>
<tr class="separator:a15db5266359edba700f523f16da303a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad13532a7eebe8a7473dfe5ed9a828fe8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ad13532a7eebe8a7473dfe5ed9a828fe8">sampler_interval</a> = -1</td></tr>
<tr class="separator:ad13532a7eebe8a7473dfe5ed9a828fe8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bfff875038f8c24055067117e192960"><td class="memItemLeft" align="right" valign="top">amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a8bfff875038f8c24055067117e192960">sampler_per</a> = -1.0</td></tr>
<tr class="separator:a8bfff875038f8c24055067117e192960"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83ad7f8f4cf9920a6798f3b931355a2f"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classSampleData.html">SampleData</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a83ad7f8f4cf9920a6798f3b931355a2f">data_sampler</a> = nullptr</td></tr>
<tr class="separator:a83ad7f8f4cf9920a6798f3b931355a2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cade630b005dbcc0f644987ef3db287"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; std::fstream &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a1cade630b005dbcc0f644987ef3db287">datalog</a></td></tr>
<tr class="separator:a1cade630b005dbcc0f644987ef3db287"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab33e7fff801543a43961ca6d7cac818f"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; std::fstream &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ab33e7fff801543a43961ca6d7cac818f">der_datalog</a></td></tr>
<tr class="separator:ab33e7fff801543a43961ca6d7cac818f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab546bcca3968440c6c24097f59b87f23"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; std::fstream &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ab546bcca3968440c6c24097f59b87f23">tot_e_datalog</a></td></tr>
<tr class="separator:ab546bcca3968440c6c24097f59b87f23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9248a4eb025c2647e003f838cba52a21"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a9248a4eb025c2647e003f838cba52a21">datalogname</a></td></tr>
<tr class="separator:a9248a4eb025c2647e003f838cba52a21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e7650abd3df579a98be0c750aa61ba8"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a9e7650abd3df579a98be0c750aa61ba8">der_datalogname</a></td></tr>
<tr class="separator:a9e7650abd3df579a98be0c750aa61ba8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7bba2a8c0e4d0a0d5a6478301bf6c3fa"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a7bba2a8c0e4d0a0d5a6478301bf6c3fa">tot_e_datalogname</a></td></tr>
<tr class="separator:a7bba2a8c0e4d0a0d5a6478301bf6c3fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9737ddb0de6b9e8a5b17c109d5ad3e08"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; std::fstream &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a9737ddb0de6b9e8a5b17c109d5ad3e08">sampleptlog</a></td></tr>
<tr class="separator:a9737ddb0de6b9e8a5b17c109d5ad3e08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8fbfa8bb47c0a3b53e244081aa1e8ad3"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a8fbfa8bb47c0a3b53e244081aa1e8ad3">sampleptlogname</a></td></tr>
<tr class="separator:a8fbfa8bb47c0a3b53e244081aa1e8ad3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8a57b7fbf5a67c99d04b7d4f43ad100"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::IntVect &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ae8a57b7fbf5a67c99d04b7d4f43ad100">samplepoint</a></td></tr>
<tr class="separator:ae8a57b7fbf5a67c99d04b7d4f43ad100"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4990f1796b65ec8ee602f177a66afc3e"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; std::fstream &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a4990f1796b65ec8ee602f177a66afc3e">samplelinelog</a></td></tr>
<tr class="separator:a4990f1796b65ec8ee602f177a66afc3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0553967f1131860bb8ecb47c0f192eaa"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a0553967f1131860bb8ecb47c0f192eaa">samplelinelogname</a></td></tr>
<tr class="separator:a0553967f1131860bb8ecb47c0f192eaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fa1582bb13357895d2aba91b695624a"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; amrex::IntVect &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a0fa1582bb13357895d2aba91b695624a">sampleline</a></td></tr>
<tr class="separator:a0fa1582bb13357895d2aba91b695624a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32317cbd11fb55fe60a00c0925189859"><td class="memItemLeft" align="right" valign="top">amrex::Vector&lt; std::unique_ptr&lt; <a class="el" href="classeb__.html">eb_</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a32317cbd11fb55fe60a00c0925189859">eb</a></td></tr>
<tr class="separator:a32317cbd11fb55fe60a00c0925189859"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-attribs"></a>
Static Private Attributes</h2></td></tr>
<tr class="memitem:a89f605d1a1eae06a7c79f9b6b65c637f"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a89f605d1a1eae06a7c79f9b6b65c637f">cfl</a> = 0.8</td></tr>
<tr class="separator:a89f605d1a1eae06a7c79f9b6b65c637f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addc2ee5eba2264ae2b2475970b0b8c2d"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#addc2ee5eba2264ae2b2475970b0b8c2d">sub_cfl</a> = 1.0</td></tr>
<tr class="separator:addc2ee5eba2264ae2b2475970b0b8c2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad353aa9e275612ff2110c5a1405c1176"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ad353aa9e275612ff2110c5a1405c1176">init_shrink</a> = 1.0</td></tr>
<tr class="separator:ad353aa9e275612ff2110c5a1405c1176"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae16d413b172bb3b3400af6d5cb236fd4"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ae16d413b172bb3b3400af6d5cb236fd4">change_max</a> = 1.1</td></tr>
<tr class="separator:ae16d413b172bb3b3400af6d5cb236fd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4b3bb9d744fb5dde65a21951b86e132"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ad4b3bb9d744fb5dde65a21951b86e132">dt_max_initial</a> = 2.0e100</td></tr>
<tr class="separator:ad4b3bb9d744fb5dde65a21951b86e132"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ec36cbd96abc7ac706fee7007ae9aeb"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a3ec36cbd96abc7ac706fee7007ae9aeb">dt_max</a> = 1e9</td></tr>
<tr class="separator:a3ec36cbd96abc7ac706fee7007ae9aeb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2e1a979c0ad68e87eaee349beb7e9fd"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ad2e1a979c0ad68e87eaee349beb7e9fd">fixed_mri_dt_ratio</a> = 0</td></tr>
<tr class="separator:ad2e1a979c0ad68e87eaee349beb7e9fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32dd48049e8acbe95decdd4b01b782c4"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="structSolverChoice.html">SolverChoice</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a></td></tr>
<tr class="separator:a32dd48049e8acbe95decdd4b01b782c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43d0b17f6e155691a1e9474526df3af5"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a43d0b17f6e155691a1e9474526df3af5">verbose</a> = 0</td></tr>
<tr class="separator:a43d0b17f6e155691a1e9474526df3af5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c4e27d6b7928c7081f17e63d0834200"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a2c4e27d6b7928c7081f17e63d0834200">mg_verbose</a> = 0</td></tr>
<tr class="separator:a2c4e27d6b7928c7081f17e63d0834200"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35e6065478296fac62affbf8f53b8c23"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a35e6065478296fac62affbf8f53b8c23">use_fft</a> = false</td></tr>
<tr class="separator:a35e6065478296fac62affbf8f53b8c23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5232e98479611a24fe97994640c61faa"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a5232e98479611a24fe97994640c61faa">sum_interval</a> = -1</td></tr>
<tr class="separator:a5232e98479611a24fe97994640c61faa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52761522e295887435c10853d8c7dc37"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a52761522e295887435c10853d8c7dc37">pert_interval</a> = -1</td></tr>
<tr class="separator:a52761522e295887435c10853d8c7dc37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cf2ba396f4404724824516da4c4a084"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a1cf2ba396f4404724824516da4c4a084">sum_per</a> = -1.0</td></tr>
<tr class="separator:a1cf2ba396f4404724824516da4c4a084"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a184511b7b9b7d4beef453f5d5d679c54"><td class="memItemLeft" align="right" valign="top">static PlotFileType&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a184511b7b9b7d4beef453f5d5d679c54">plotfile_type_1</a> = PlotFileType::None</td></tr>
<tr class="separator:a184511b7b9b7d4beef453f5d5d679c54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a980e94505df2ee0925612b004126df77"><td class="memItemLeft" align="right" valign="top">static PlotFileType&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a980e94505df2ee0925612b004126df77">plotfile_type_2</a> = PlotFileType::None</td></tr>
<tr class="separator:a980e94505df2ee0925612b004126df77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a812912653fe0d8ab1342bfef4793dd0e"><td class="memItemLeft" align="right" valign="top">static StateInterpType&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a812912653fe0d8ab1342bfef4793dd0e">interpolation_type</a></td></tr>
<tr class="separator:a812912653fe0d8ab1342bfef4793dd0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c570cbcb63ba3b0b09557537310ea46"><td class="memItemLeft" align="right" valign="top">static std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a6c570cbcb63ba3b0b09557537310ea46">sponge_type</a></td></tr>
<tr class="separator:a6c570cbcb63ba3b0b09557537310ea46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ef14f6028b577eba70aef46b508be19"><td class="memItemLeft" align="right" valign="top">static amrex::Vector&lt; amrex::Vector&lt; std::string &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a7ef14f6028b577eba70aef46b508be19">nc_init_file</a> = {{&quot;&quot;}}</td></tr>
<tr class="separator:a7ef14f6028b577eba70aef46b508be19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e9040f32464f1a6dee6e0384393451d"><td class="memItemLeft" align="right" valign="top">static std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a7e9040f32464f1a6dee6e0384393451d">nc_bdy_file</a></td></tr>
<tr class="separator:a7e9040f32464f1a6dee6e0384393451d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4c8a68d25ec78f9944bf3123fafd93e"><td class="memItemLeft" align="right" valign="top">static std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ad4c8a68d25ec78f9944bf3123fafd93e">nc_low_file</a></td></tr>
<tr class="separator:ad4c8a68d25ec78f9944bf3123fafd93e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2eb81c590271b429f132103c9af25830"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a2eb81c590271b429f132103c9af25830">init_sounding_ideal</a> = false</td></tr>
<tr class="separator:a2eb81c590271b429f132103c9af25830"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad17ff2753e754ff3eb1330612b820b5f"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ad17ff2753e754ff3eb1330612b820b5f">output_1d_column</a> = 0</td></tr>
<tr class="separator:ad17ff2753e754ff3eb1330612b820b5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa0bef6d3146788302b81c0d4f4802d1"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#afa0bef6d3146788302b81c0d4f4802d1">column_interval</a> = -1</td></tr>
<tr class="separator:afa0bef6d3146788302b81c0d4f4802d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b0175190c6fcf829c7f2841f729b12a"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a7b0175190c6fcf829c7f2841f729b12a">column_per</a> = -1.0</td></tr>
<tr class="separator:a7b0175190c6fcf829c7f2841f729b12a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a930b7d48218b3fc41d8719b50b3f6086"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a930b7d48218b3fc41d8719b50b3f6086">column_loc_x</a> = 0.0</td></tr>
<tr class="separator:a930b7d48218b3fc41d8719b50b3f6086"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b911f3a5a324813b1ff4462df6044a6"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a2b911f3a5a324813b1ff4462df6044a6">column_loc_y</a> = 0.0</td></tr>
<tr class="separator:a2b911f3a5a324813b1ff4462df6044a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48bba6b1c1b39940b09aefbe56311e2f"><td class="memItemLeft" align="right" valign="top">static std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a48bba6b1c1b39940b09aefbe56311e2f">column_file_name</a> = &quot;column_data.nc&quot;</td></tr>
<tr class="separator:a48bba6b1c1b39940b09aefbe56311e2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c448670f7a5cadd6fe56f7e615c9eb6"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a7c448670f7a5cadd6fe56f7e615c9eb6">output_bndry_planes</a> = 0</td></tr>
<tr class="separator:a7c448670f7a5cadd6fe56f7e615c9eb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab4575d8fb57595a2f1aaf088c60447a"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#aab4575d8fb57595a2f1aaf088c60447a">bndry_output_planes_interval</a> = -1</td></tr>
<tr class="separator:aab4575d8fb57595a2f1aaf088c60447a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f99e949c83d86507e003ae556cf7c22"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a5f99e949c83d86507e003ae556cf7c22">bndry_output_planes_per</a> = -1.0</td></tr>
<tr class="separator:a5f99e949c83d86507e003ae556cf7c22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87e58f16f44a6cb35d6983ed3fe7d3c1"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a87e58f16f44a6cb35d6983ed3fe7d3c1">bndry_output_planes_start_time</a> = 0.0</td></tr>
<tr class="separator:a87e58f16f44a6cb35d6983ed3fe7d3c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80ad08512968ec45635df68abe66b1fc"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a80ad08512968ec45635df68abe66b1fc">input_bndry_planes</a> = 0</td></tr>
<tr class="separator:a80ad08512968ec45635df68abe66b1fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addf0fb2aae0efaa649c69685a4dcca83"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#addf0fb2aae0efaa649c69685a4dcca83">ng_dens_hse</a></td></tr>
<tr class="separator:addf0fb2aae0efaa649c69685a4dcca83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87dc6c0720462bfd088c909289cdca0b"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a87dc6c0720462bfd088c909289cdca0b">ng_pres_hse</a></td></tr>
<tr class="separator:a87dc6c0720462bfd088c909289cdca0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac81b3dfd7c6f21ba8479834e2ff1e652"><td class="memItemLeft" align="right" valign="top">static amrex::Vector&lt; amrex::AMRErrorTag &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#ac81b3dfd7c6f21ba8479834e2ff1e652">ref_tags</a></td></tr>
<tr class="separator:ac81b3dfd7c6f21ba8479834e2ff1e652"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d00e1cb76bfbcbada173e092b6accf3"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a6d00e1cb76bfbcbada173e092b6accf3">startCPUTime</a> = 0.0</td></tr>
<tr class="separator:a6d00e1cb76bfbcbada173e092b6accf3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f412097e565c23acb4c17c67db10e22"><td class="memItemLeft" align="right" valign="top">static amrex::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classERF.html#a1f412097e565c23acb4c17c67db10e22">previousCPUTimeUsed</a> = 0.0</td></tr>
<tr class="separator:a1f412097e565c23acb4c17c67db10e22"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Main class in <a class="el" href="classERF.html">ERF</a> code, instantiated from <a class="el" href="main_8cpp.html">main.cpp</a> </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a30129012dd367825e5e4fd1406694f58"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30129012dd367825e5e4fd1406694f58">&#9670;&nbsp;</a></span>ERF() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ERF::ERF </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;{</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordtype">int</span> fix_random_seed = 0;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    ParmParse <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>(<span class="stringliteral">&quot;erf&quot;</span>); <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;fix_random_seed&quot;</span>, fix_random_seed);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="comment">// Note that the value of 1024UL is not significant -- the point here is just to set the</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="comment">// same seed for all MPI processes for the purpose of regression testing</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordflow">if</span> (fix_random_seed) {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        Print() &lt;&lt; <span class="stringliteral">&quot;Fixing the random seed&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        InitRandom(1024UL);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    }</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <a class="code" href="classERF.html#aab5871c91a4d8888c110865e9d35e8b2">ERF_shared</a>();</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;}</div>
<div class="ttc" id="aERF__MicrophysicsUtils_8H_html_ac54f1d17d8842acb42b2312cd353e469"><div class="ttname"><a href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a></div><div class="ttdeci">AMREX_GPU_HOST_DEVICE AMREX_FORCE_INLINE amrex::Real pp(amrex::Real y)</div><div class="ttdef"><b>Definition:</b> ERF_MicrophysicsUtils.H:225</div></div>
<div class="ttc" id="aclassERF_html_aab5871c91a4d8888c110865e9d35e8b2"><div class="ttname"><a href="classERF.html#aab5871c91a4d8888c110865e9d35e8b2">ERF::ERF_shared</a></div><div class="ttdeci">void ERF_shared()</div><div class="ttdef"><b>Definition:</b> ERF.cpp:107</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a30129012dd367825e5e4fd1406694f58_cgraph.png" border="0" usemap="#aclassERF_a30129012dd367825e5e4fd1406694f58_cgraph" alt=""/></div>
<map name="aclassERF_a30129012dd367825e5e4fd1406694f58_cgraph" id="aclassERF_a30129012dd367825e5e4fd1406694f58_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,84,32"/>
<area shape="rect" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469" title=" " alt="" coords="132,5,171,32"/>
</map>
</div>

</div>
</div>
<a id="a30901583bd41e7bf4dddb3c1ea329dfe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30901583bd41e7bf4dddb3c1ea329dfe">&#9670;&nbsp;</a></span>~ERF()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ERF::~ERF </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">default</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a13fc8f3a00573ee7735c3228316164a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13fc8f3a00573ee7735c3228316164a9">&#9670;&nbsp;</a></span>ERF() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ERF::ERF </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classERF.html">ERF</a> &amp;&amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="af4f5db4e6643e9ebc8ffeebcbca3978a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4f5db4e6643e9ebc8ffeebcbca3978a">&#9670;&nbsp;</a></span>ERF() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ERF::ERF </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classERF.html">ERF</a> &amp;&#160;</td>
          <td class="paramname"><em>other</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a47413fe5588f7dd71a1d5087a9e804f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47413fe5588f7dd71a1d5087a9e804f9">&#9670;&nbsp;</a></span>Advance()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::Advance </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>dt_lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iteration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ncycle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;{</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    BL_PROFILE(<span class="stringliteral">&quot;ERF::Advance()&quot;</span>);</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="comment">// We must swap the pointers so the previous step&#39;s &quot;new&quot; is now this step&#39;s &quot;old&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    std::swap(<a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev]);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    MultiFab&amp; S_old = <a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>];</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    MultiFab&amp; S_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>];</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    MultiFab&amp; U_old = <a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>];</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    MultiFab&amp; V_old = <a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>];</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    MultiFab&amp; W_old = <a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>];</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    MultiFab&amp; U_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>];</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    MultiFab&amp; V_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>];</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    MultiFab&amp; W_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>];</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="comment">// We need to set these because otherwise in the first call to erf_advance we may</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="comment">//    read uninitialized data on ghost values in setting the bc&#39;s on the velocities</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    U_new.setVal(1.e34,U_new.nGrowVect());</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    V_new.setVal(1.e34,V_new.nGrowVect());</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    W_new.setVal(1.e34,W_new.nGrowVect());</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="comment">// Do error checking for negative (rho theta) here</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa7be0d60ce3de3441d44082cc1b725ec">anelastic</a>[lev] != 1) {</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <a class="code" href="ERF__Advance_8cpp.html#a9e781a79c3bc849e4b6876e91c7cdf34">check_for_negative_theta</a>(S_old);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    }</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="comment">// NOTE: the momenta here are not fillpatched (they are only used as scratch space)</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="comment">// If lev == 0 we have already FillPatched this in ERF::TimeStep</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordflow">if</span> (lev &gt; 0) {</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <a class="code" href="classERF.html#afded764725240c356faffa97dddbe03d">FillPatch</a>(lev, time, {&amp;S_old, &amp;U_old, &amp;V_old, &amp;W_old},</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                             {&amp;S_old, &amp;<a class="code" href="classERF.html#a6eecc44323f77917c95869928284f61d">rU_old</a>[lev], &amp;<a class="code" href="classERF.html#aeb64e3b4def989ce68d873aefeed5e0e">rV_old</a>[lev], &amp;<a class="code" href="classERF.html#ac1fa56ec90f44e3cdf487af46804163f">rW_old</a>[lev]},</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                             <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev], <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev]);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    }</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="comment">// So we must convert the fillpatched to momenta, including the ghost values</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <a class="code" href="ERF__Utils_8H.html#a5e2e36af19c0192915a2ca721c0cded4">VelocityToMomentum</a>(U_old, <a class="code" href="classERF.html#a6eecc44323f77917c95869928284f61d">rU_old</a>[lev].nGrowVect(),</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                       V_old, <a class="code" href="classERF.html#aeb64e3b4def989ce68d873aefeed5e0e">rV_old</a>[lev].nGrowVect(),</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                       W_old, <a class="code" href="classERF.html#ac1fa56ec90f44e3cdf487af46804163f">rW_old</a>[lev].nGrowVect(),</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                       S_old, <a class="code" href="classERF.html#a6eecc44323f77917c95869928284f61d">rU_old</a>[lev], <a class="code" href="classERF.html#aeb64e3b4def989ce68d873aefeed5e0e">rV_old</a>[lev], <a class="code" href="classERF.html#ac1fa56ec90f44e3cdf487af46804163f">rW_old</a>[lev],</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                       Geom(lev).Domain(),</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                       <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="comment">// Update the inflow perturbation update time and amplitude</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#abfd94767b3721755632c45a5ef290544">pert_type</a> == PerturbationType::Source ||</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#abfd94767b3721755632c45a5ef290544">pert_type</a> == PerturbationType::Direct ||</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#abfd94767b3721755632c45a5ef290544">pert_type</a> == PerturbationType::CPM)</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <a class="code" href="classERF.html#ac1b9cce4a3c1736c4af78f6b0e2143ce">turbPert</a>.<a class="code" href="structTurbulentPerturbation.html#a5e6200f8b6bea3c4944dccc6c7285102">calc_tpi_update</a>(lev, dt_lev, U_old, V_old, S_old);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="comment">// If PerturbationType::Direct or CPM is selected, directly add the computed perturbation</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="comment">// on the conserved field</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#abfd94767b3721755632c45a5ef290544">pert_type</a> == PerturbationType::Direct ||</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#abfd94767b3721755632c45a5ef290544">pert_type</a> == PerturbationType::CPM)</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <span class="keyword">auto</span> m_ixtype = S_old.boxArray().ixType(); <span class="comment">// Conserved term</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <span class="keywordflow">for</span> (MFIter mfi(S_old,<a class="code" href="ERF__TileNoZ_8H.html#a8da113f1d5603f7297fe1d03e5013f00">TileNoZ</a>()); mfi.isValid(); ++mfi) {</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            Box bx  = mfi.tilebox();</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            <span class="keyword">const</span> Array4&lt;Real&gt; &amp;cell_data  = S_old.array(mfi);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            <span class="keyword">const</span> Array4&lt;const Real&gt; &amp;pert_cell = <a class="code" href="classERF.html#ac1b9cce4a3c1736c4af78f6b0e2143ce">turbPert</a>.<a class="code" href="structTurbulentPerturbation.html#a0bc940e3c9b5cd1ebcf866aaa344cfed">pb_cell</a>[lev].array(mfi);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            <a class="code" href="classERF.html#ac1b9cce4a3c1736c4af78f6b0e2143ce">turbPert</a>.<a class="code" href="structTurbulentPerturbation.html#adcb414231654ad9f5232a1a3377c30f2">apply_tpi</a>(lev, bx, <a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>, m_ixtype, cell_data, pert_cell);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        }</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    }</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="comment">// configure SurfaceLayer params if needed</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[Orientation(Direction::z,Orientation::low)] == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9af69483cb4bb9623dc65e76ce5bd0a3d5">ERF_BC::surface_layer</a>) {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ac50bb696daf587e13f9a1e57c687375e">m_SurfaceLayer</a>) {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            IntVect <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a> = <a class="code" href="classERF.html#a71629ae2fda396472198691b75d83b2e">Theta_prim</a>[lev]-&gt;nGrowVect();</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            MultiFab::Copy(  *<a class="code" href="classERF.html#a71629ae2fda396472198691b75d83b2e">Theta_prim</a>[lev], S_old, <a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>, 0, 1, <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            MultiFab::Divide(*<a class="code" href="classERF.html#a71629ae2fda396472198691b75d83b2e">Theta_prim</a>[lev], S_old, <a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>     , 0, 1, <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> != MoistureType::None) {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a> = <a class="code" href="classERF.html#a521d1faf157e3bccc86c0f26ee923576">Qv_prim</a>[lev]-&gt;nGrowVect();</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                MultiFab::Copy(  *<a class="code" href="classERF.html#a521d1faf157e3bccc86c0f26ee923576">Qv_prim</a>[lev], S_old, <a class="code" href="ERF__IndexDefines_8H.html#aa965e9988f14d5d2a5aef4a942168a15">RhoQ1_comp</a>, 0, 1, <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                MultiFab::Divide(*<a class="code" href="classERF.html#a521d1faf157e3bccc86c0f26ee923576">Qv_prim</a>[lev], S_old, <a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>  , 0, 1, <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a1d9237205fd632dcde1599511f203131">RhoQr_comp</a> &gt; -1) {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                    MultiFab::Copy(  *<a class="code" href="classERF.html#a57d8432920785f8e58cf11a3232d76b5">Qr_prim</a>[lev], S_old, <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a1d9237205fd632dcde1599511f203131">RhoQr_comp</a>, 0, 1, <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                    MultiFab::Divide(*<a class="code" href="classERF.html#a57d8432920785f8e58cf11a3232d76b5">Qr_prim</a>[lev], S_old, <a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>  , 0, 1, <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                    <a class="code" href="classERF.html#a57d8432920785f8e58cf11a3232d76b5">Qr_prim</a>[lev]-&gt;setVal(0.0);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                }</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            }</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            <span class="comment">// NOTE: std::swap above causes the field ptrs to be out of date.</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            <span class="comment">//       Reassign the field ptrs for MAC avg computation.</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            <a class="code" href="classERF.html#ac50bb696daf587e13f9a1e57c687375e">m_SurfaceLayer</a>-&gt;update_mac_ptrs(lev, <a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>, <a class="code" href="classERF.html#a71629ae2fda396472198691b75d83b2e">Theta_prim</a>, <a class="code" href="classERF.html#a521d1faf157e3bccc86c0f26ee923576">Qv_prim</a>, <a class="code" href="classERF.html#a57d8432920785f8e58cf11a3232d76b5">Qr_prim</a>);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            <a class="code" href="classERF.html#ac50bb696daf587e13f9a1e57c687375e">m_SurfaceLayer</a>-&gt;update_pblh(lev, <a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>, <a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[lev].get(),</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                                        <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a9ac649bbebc73403e291d2af180d4061">RhoQv_comp</a>,</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                                        <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a5dc385a342ac6c50e0f9a638a0e31f9f">RhoQc_comp</a>,</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                                        <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a1d9237205fd632dcde1599511f203131">RhoQr_comp</a>);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            <a class="code" href="classERF.html#ac50bb696daf587e13f9a1e57c687375e">m_SurfaceLayer</a>-&gt;update_fluxes(lev, time);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        }</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="preprocessor">#if defined(ERF_USE_WINDFARM)</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac0a723e8797cdc0fe06b3fc781fca645">windfarm_type</a> != WindFarmType::None) {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        advance_windfarm(Geom(lev), dt_lev, S_old,</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                         U_old, V_old, W_old, vars_windfarm[lev],</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                         Nturb[lev], SMark[lev], time);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    }</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keyword">const</span> BoxArray&amp;            ba = S_old.boxArray();</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keyword">const</span> DistributionMapping&amp; dm = S_old.DistributionMap();</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="ERF__DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a7c3c83d6fcec1f134956c3160adf6e39">nvars</a> = S_old.nComp();</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="comment">// Source array for conserved cell-centered quantities -- this will be filled</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="comment">//     in the call to make_sources in ERF_TI_slow_rhs_pre.H</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    MultiFab cc_source(ba,dm,<a class="code" href="ERF__DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a7c3c83d6fcec1f134956c3160adf6e39">nvars</a>,1); cc_source.setVal(0.0);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="comment">// Source arrays for momenta -- these will be filled</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="comment">//     in the call to make_mom_sources in ERF_TI_slow_rhs_pre.H</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    BoxArray ba_x(ba); ba_x.surroundingNodes(0);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    MultiFab xmom_source(ba_x,dm,1,1); xmom_source.setVal(0.0);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    BoxArray ba_y(ba); ba_y.surroundingNodes(1);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    MultiFab ymom_source(ba_y,dm,1,1); ymom_source.setVal(0.0);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160; </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    BoxArray ba_z(ba); ba_z.surroundingNodes(2);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    MultiFab zmom_source(ba_z,dm,1,1); zmom_source.setVal(0.0);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    MultiFab    buoyancy(ba_z,dm,1,1); buoyancy.setVal(0.0);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    amrex::Vector&lt;MultiFab&gt; state_old;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    amrex::Vector&lt;MultiFab&gt; state_new;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="comment">// **************************************************************************************</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="comment">// Here we define state_old and state_new which are to be advanced</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="comment">// **************************************************************************************</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="comment">// Initial solution</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="comment">// Note that &quot;old&quot; and &quot;new&quot; here are relative to each RK stage.</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    state_old.push_back(MultiFab(S_old      , amrex::make_alias, 0, <a class="code" href="ERF__DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a7c3c83d6fcec1f134956c3160adf6e39">nvars</a>)); <span class="comment">// cons</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    state_old.push_back(MultiFab(<a class="code" href="classERF.html#a6eecc44323f77917c95869928284f61d">rU_old</a>[lev], amrex::make_alias, 0,     1)); <span class="comment">// xmom</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    state_old.push_back(MultiFab(<a class="code" href="classERF.html#aeb64e3b4def989ce68d873aefeed5e0e">rV_old</a>[lev], amrex::make_alias, 0,     1)); <span class="comment">// ymom</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    state_old.push_back(MultiFab(<a class="code" href="classERF.html#ac1fa56ec90f44e3cdf487af46804163f">rW_old</a>[lev], amrex::make_alias, 0,     1)); <span class="comment">// zmom</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="comment">// Final solution</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="comment">// state_new at the end of the last RK stage holds the t^{n+1} data</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    state_new.push_back(MultiFab(S_new      , amrex::make_alias, 0, <a class="code" href="ERF__DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a7c3c83d6fcec1f134956c3160adf6e39">nvars</a>)); <span class="comment">// cons</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    state_new.push_back(MultiFab(<a class="code" href="classERF.html#a01f3db32272f53dc68025f0a98195e57">rU_new</a>[lev], amrex::make_alias, 0,     1)); <span class="comment">// xmom</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    state_new.push_back(MultiFab(<a class="code" href="classERF.html#a54e37988486ef96e55e84bd8e91bb688">rV_new</a>[lev], amrex::make_alias, 0,     1)); <span class="comment">// ymom</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    state_new.push_back(MultiFab(<a class="code" href="classERF.html#aa46c0b0d20525aed10f447923e54dde7">rW_new</a>[lev], amrex::make_alias, 0,     1)); <span class="comment">// zmom</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="comment">// **************************************************************************************</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="comment">// Update the dycore</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="comment">// **************************************************************************************</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <a class="code" href="classERF.html#a96a272defae485c5b83fbc123a631f9f">advance_dycore</a>(lev, state_old, state_new,</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                   U_old, V_old, W_old,</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                   U_new, V_new, W_new,</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                   cc_source, xmom_source, ymom_source, zmom_source, buoyancy,</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                   Geom(lev), dt_lev, time);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="comment">// **************************************************************************************</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="comment">// Update the microphysics (moisture)</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="comment">// **************************************************************************************</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <a class="code" href="classERF.html#ad64b5fe566102dc053b35ad337971a3e">advance_microphysics</a>(lev, S_new, dt_lev, iteration, time);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="comment">// **************************************************************************************</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="comment">// Update the land surface model</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="comment">// **************************************************************************************</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <a class="code" href="classERF.html#ab463dd8a88f21f3a5ff33b583a883c28">advance_lsm</a>(lev, S_new, U_new, V_new, dt_lev);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="comment">// **************************************************************************************</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="comment">// Update the radiation</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="comment">// **************************************************************************************</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <a class="code" href="classERF.html#ad3ef30449c979e90c40b0c6f79864e8f">advance_radiation</a>(lev, S_new, dt_lev);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="preprocessor">#ifdef ERF_USE_PARTICLES</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="comment">// **************************************************************************************</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="comment">// Update the particle positions</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="comment">// **************************************************************************************</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;   evolveTracers( lev, dt_lev, <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>, <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a> );</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="comment">// ***********************************************************************************************</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="comment">// Impose domain boundary conditions here so that in FillPatching the fine data we won&#39;t</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="comment">// need to re-fill these</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="comment">// ***********************************************************************************************</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keywordflow">if</span> (lev &lt; finest_level) {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;         IntVect ngvect_vels = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].nGrowVect();</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;         (*<a class="code" href="classERF.html#a2e9b04043853d25f2d76edbc0bed2e72">physbcs_cons</a>[lev])(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                              0,<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nComp(),</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                              <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nGrowVect(),time,<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>,<span class="keyword">true</span>);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            (*<a class="code" href="classERF.html#a64e55e5ae9df06433146db657eb9e72e">physbcs_u</a>[lev])(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                              ngvect_vels,time,<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>,<span class="keyword">true</span>);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            (*<a class="code" href="classERF.html#a79231b5cfd4576a742e46ae0082b5121">physbcs_v</a>[lev])(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                              ngvect_vels,time,<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a>,<span class="keyword">true</span>);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            (*<a class="code" href="classERF.html#a45c8ecd777f47732993777a0afb8e140">physbcs_w</a>[lev])(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                              ngvect_vels,time,<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa03b35ec9e83f34bb1349a86965d34e34">BCVars::zvel_bc</a>,<span class="keyword">true</span>);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    }</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="comment">// **************************************************************************************</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="comment">// Register old and new coarse data if we are at a level less than the finest level</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="comment">// **************************************************************************************</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keywordflow">if</span> (lev &lt; finest_level)</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    {</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ad9084179f7384e10a519989ffd51fd34">cf_width</a> &gt; 0) {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            <span class="comment">// We must fill the ghost cells of these so that the parallel copy works correctly</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            state_old[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269a2e7100afbf5e7a39371f1cb29f6f570a">IntVars::cons</a>].FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            state_new[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269a2e7100afbf5e7a39371f1cb29f6f570a">IntVars::cons</a>].FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            <a class="code" href="classERF.html#a34160ca20fb400ee285664117cb80512">FPr_c</a>[lev].RegisterCoarseData({&amp;state_old[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269a2e7100afbf5e7a39371f1cb29f6f570a">IntVars::cons</a>], &amp;state_new[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269a2e7100afbf5e7a39371f1cb29f6f570a">IntVars::cons</a>]},</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                                          {time, time + dt_lev});</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ad9084179f7384e10a519989ffd51fd34">cf_width</a> &gt;= 0) {</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            <span class="comment">// We must fill the ghost cells of these so that the parallel copy works correctly</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            state_old[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269af661293a5a71ca532c214929b98c0bad">IntVars::xmom</a>].FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            state_new[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269af661293a5a71ca532c214929b98c0bad">IntVars::xmom</a>].FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            <a class="code" href="classERF.html#a0ef3455d5b4fc9a178e023b233d389a4">FPr_u</a>[lev].RegisterCoarseData({&amp;state_old[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269af661293a5a71ca532c214929b98c0bad">IntVars::xmom</a>], &amp;state_new[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269af661293a5a71ca532c214929b98c0bad">IntVars::xmom</a>]},</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                                          {time, time + dt_lev});</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            state_old[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269a2e60798bc45154a8f905b1aa228a24e5">IntVars::ymom</a>].FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            state_new[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269a2e60798bc45154a8f905b1aa228a24e5">IntVars::ymom</a>].FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            <a class="code" href="classERF.html#a1dc7086aec533a042e6033706845b0c3">FPr_v</a>[lev].RegisterCoarseData({&amp;state_old[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269a2e60798bc45154a8f905b1aa228a24e5">IntVars::ymom</a>], &amp;state_new[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269a2e60798bc45154a8f905b1aa228a24e5">IntVars::ymom</a>]},</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                                          {time, time + dt_lev});</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            state_old[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269aaab25f707cae69bfadac2abcd17a2188">IntVars::zmom</a>].FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            state_new[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269aaab25f707cae69bfadac2abcd17a2188">IntVars::zmom</a>].FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            <a class="code" href="classERF.html#ac9a11403c2238d0d1e7b65b2d100dbaf">FPr_w</a>[lev].RegisterCoarseData({&amp;state_old[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269aaab25f707cae69bfadac2abcd17a2188">IntVars::zmom</a>], &amp;state_new[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269aaab25f707cae69bfadac2abcd17a2188">IntVars::zmom</a>]},</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                                          {time, time + dt_lev});</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        }</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160; </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            <span class="comment">// Now create a MultiFab that holds (S_new - S_old) / dt from the coarse level interpolated</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            <span class="comment">//     on to the coarse/fine boundary at the fine resolution</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            Interpolater* mapper_f = &amp;face_cons_linear_interp;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            <span class="comment">// PhysBCFunctNoOp null_bc;</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;            <span class="comment">// MultiFab tempx(vars_new[lev+1][Vars::xvel].boxArray(),vars_new[lev+1][Vars::xvel].DistributionMap(),1,0);</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            <span class="comment">// tempx.setVal(0.0);</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            <span class="comment">// xmom_crse_rhs[lev+1].setVal(0.0);</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            <span class="comment">// FPr_u[lev].FillSet(tempx               , time       , null_bc, domain_bcs_type);</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            <span class="comment">// FPr_u[lev].FillSet(xmom_crse_rhs[lev+1], time+dt_lev, null_bc, domain_bcs_type);</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            <span class="comment">// MultiFab::Subtract(xmom_crse_rhs[lev+1],tempx,0,0,1,IntVect{0});</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            <span class="comment">// xmom_crse_rhs[lev+1].mult(1.0/dt_lev,0,1,0);</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            <span class="comment">// MultiFab tempy(vars_new[lev+1][Vars::yvel].boxArray(),vars_new[lev+1][Vars::yvel].DistributionMap(),1,0);</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            <span class="comment">// tempy.setVal(0.0);</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            <span class="comment">// ymom_crse_rhs[lev+1].setVal(0.0);</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            <span class="comment">// FPr_v[lev].FillSet(tempy               , time       , null_bc, domain_bcs_type);</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            <span class="comment">// FPr_v[lev].FillSet(ymom_crse_rhs[lev+1], time+dt_lev, null_bc, domain_bcs_type);</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            <span class="comment">// MultiFab::Subtract(ymom_crse_rhs[lev+1],tempy,0,0,1,IntVect{0});</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            <span class="comment">// ymom_crse_rhs[lev+1].mult(1.0/dt_lev,0,1,0);</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            MultiFab temp_state(<a class="code" href="classERF.html#aaf7e8e28172eebdfe2224e4ee823310d">zmom_crse_rhs</a>[lev+1].boxArray(),<a class="code" href="classERF.html#aaf7e8e28172eebdfe2224e4ee823310d">zmom_crse_rhs</a>[lev+1].DistributionMap(),1,0);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            InterpFromCoarseLevel(temp_state,            IntVect{0}, IntVect{0}, state_old[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269aaab25f707cae69bfadac2abcd17a2188">IntVars::zmom</a>], 0, 0, 1,</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                                  geom[lev], geom[lev+1], refRatio(lev), mapper_f, <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>, <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa03b35ec9e83f34bb1349a86965d34e34">BCVars::zvel_bc</a>);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            InterpFromCoarseLevel(<a class="code" href="classERF.html#aaf7e8e28172eebdfe2224e4ee823310d">zmom_crse_rhs</a>[lev+1],  IntVect{0}, IntVect{0}, state_new[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269aaab25f707cae69bfadac2abcd17a2188">IntVars::zmom</a>], 0, 0, 1,</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                                  geom[lev], geom[lev+1], refRatio(lev), mapper_f, <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>, <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa03b35ec9e83f34bb1349a86965d34e34">BCVars::zvel_bc</a>);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            MultiFab::Subtract(<a class="code" href="classERF.html#aaf7e8e28172eebdfe2224e4ee823310d">zmom_crse_rhs</a>[lev+1],temp_state,0,0,1,IntVect{0});</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            <a class="code" href="classERF.html#aaf7e8e28172eebdfe2224e4ee823310d">zmom_crse_rhs</a>[lev+1].mult(1.0/dt_lev,0,1,0);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    }</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160; </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="comment">// ***********************************************************************************************</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="comment">// Update the time averaged velocities if they are requested</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="comment">// ***********************************************************************************************</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#af3119a4089367206db9fc3a17664e874">time_avg_vel</a>) {</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <a class="code" href="ERF__TimeAvgVel_8cpp.html#a2241063c19e843eaaa749c3b51b6b0fe">Time_Avg_Vel_atCC</a>(<a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[lev], <a class="code" href="classERF.html#a6837423e9248e923fcaa1987b59d8160">t_avg_cnt</a>[lev], <a class="code" href="classERF.html#a3e146164ca6929ec6d4984b6a3f43c81">vel_t_avg</a>[lev].get(), U_new, V_new, W_new);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    }</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;}</div>
<div class="ttc" id="aERF__Advance_8cpp_html_a9e781a79c3bc849e4b6876e91c7cdf34"><div class="ttname"><a href="ERF__Advance_8cpp.html#a9e781a79c3bc849e4b6876e91c7cdf34">check_for_negative_theta</a></div><div class="ttdeci">void check_for_negative_theta(amrex::MultiFab &amp;S_old)</div><div class="ttdef"><b>Definition:</b> ERF_Advance.cpp:294</div></div>
<div class="ttc" id="aERF__DataStruct_8H_html_a3856c8a2f055327ada182186bfd70239a7c3c83d6fcec1f134956c3160adf6e39"><div class="ttname"><a href="ERF__DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a7c3c83d6fcec1f134956c3160adf6e39">nvars</a></div><div class="ttdeci">@ nvars</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:87</div></div>
<div class="ttc" id="aERF__IndexDefines_8H_html_a27dcc910aeb002a0fd44727954dc0e49"><div class="ttname"><a href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a></div><div class="ttdeci">#define Rho_comp</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:36</div></div>
<div class="ttc" id="aERF__IndexDefines_8H_html_a28f96fd04e1ff08fa7a8f53ccde0f877"><div class="ttname"><a href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a></div><div class="ttdeci">#define RhoTheta_comp</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:37</div></div>
<div class="ttc" id="aERF__IndexDefines_8H_html_aa965e9988f14d5d2a5aef4a942168a15"><div class="ttname"><a href="ERF__IndexDefines_8H.html#aa965e9988f14d5d2a5aef4a942168a15">RhoQ1_comp</a></div><div class="ttdeci">#define RhoQ1_comp</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:42</div></div>
<div class="ttc" id="aERF__IndexDefines_8H_html_adf340bf1893bad34b2bf452d987d86c9af69483cb4bb9623dc65e76ce5bd0a3d5"><div class="ttname"><a href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9af69483cb4bb9623dc65e76ce5bd0a3d5">ERF_BC::surface_layer</a></div><div class="ttdeci">@ surface_layer</div></div>
<div class="ttc" id="aERF__TileNoZ_8H_html_a8da113f1d5603f7297fe1d03e5013f00"><div class="ttname"><a href="ERF__TileNoZ_8H.html#a8da113f1d5603f7297fe1d03e5013f00">TileNoZ</a></div><div class="ttdeci">AMREX_FORCE_INLINE amrex::IntVect TileNoZ()</div><div class="ttdef"><b>Definition:</b> ERF_TileNoZ.H:11</div></div>
<div class="ttc" id="aERF__TimeAvgVel_8cpp_html_a2241063c19e843eaaa749c3b51b6b0fe"><div class="ttname"><a href="ERF__TimeAvgVel_8cpp.html#a2241063c19e843eaaa749c3b51b6b0fe">Time_Avg_Vel_atCC</a></div><div class="ttdeci">void Time_Avg_Vel_atCC(const Real &amp;dt, Real &amp;t_avg_cnt, MultiFab *vel_t_avg, MultiFab &amp;xvel, MultiFab &amp;yvel, MultiFab &amp;zvel)</div><div class="ttdef"><b>Definition:</b> ERF_TimeAvgVel.cpp:9</div></div>
<div class="ttc" id="aERF__Utils_8H_html_a5e2e36af19c0192915a2ca721c0cded4"><div class="ttname"><a href="ERF__Utils_8H.html#a5e2e36af19c0192915a2ca721c0cded4">VelocityToMomentum</a></div><div class="ttdeci">void VelocityToMomentum(const amrex::MultiFab &amp;xvel_in, const amrex::IntVect &amp;xvel_ngrow, const amrex::MultiFab &amp;yvel_in, const amrex::IntVect &amp;yvel_ngrow, const amrex::MultiFab &amp;zvel_in, const amrex::IntVect &amp;zvel_ngrow, const amrex::MultiFab &amp;cons_in, amrex::MultiFab &amp;xmom_out, amrex::MultiFab &amp;ymom_out, amrex::MultiFab &amp;zmom_out, const amrex::Box &amp;domain, const amrex::Vector&lt; amrex::BCRec &gt; &amp;domain_bcs_type_h)</div></div>
<div class="ttc" id="aclassERF_html_a01f3db32272f53dc68025f0a98195e57"><div class="ttname"><a href="classERF.html#a01f3db32272f53dc68025f0a98195e57">ERF::rU_new</a></div><div class="ttdeci">amrex::Vector&lt; amrex::MultiFab &gt; rU_new</div><div class="ttdef"><b>Definition:</b> ERF.H:735</div></div>
<div class="ttc" id="aclassERF_html_a0ef3455d5b4fc9a178e023b233d389a4"><div class="ttname"><a href="classERF.html#a0ef3455d5b4fc9a178e023b233d389a4">ERF::FPr_u</a></div><div class="ttdeci">amrex::Vector&lt; ERFFillPatcher &gt; FPr_u</div><div class="ttdef"><b>Definition:</b> ERF.H:779</div></div>
<div class="ttc" id="aclassERF_html_a1204ca4dc5d79f5da191ffbe09dfab9b"><div class="ttname"><a href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">ERF::vars_new</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; amrex::MultiFab &gt; &gt; vars_new</div><div class="ttdef"><b>Definition:</b> ERF.H:707</div></div>
<div class="ttc" id="aclassERF_html_a1dc7086aec533a042e6033706845b0c3"><div class="ttname"><a href="classERF.html#a1dc7086aec533a042e6033706845b0c3">ERF::FPr_v</a></div><div class="ttdeci">amrex::Vector&lt; ERFFillPatcher &gt; FPr_v</div><div class="ttdef"><b>Definition:</b> ERF.H:780</div></div>
<div class="ttc" id="aclassERF_html_a2e9b04043853d25f2d76edbc0bed2e72"><div class="ttname"><a href="classERF.html#a2e9b04043853d25f2d76edbc0bed2e72">ERF::physbcs_cons</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; ERFPhysBCFunct_cons &gt; &gt; physbcs_cons</div><div class="ttdef"><b>Definition:</b> ERF.H:722</div></div>
<div class="ttc" id="aclassERF_html_a31be0f1ae705c52c8ccc520369013284"><div class="ttname"><a href="classERF.html#a31be0f1ae705c52c8ccc520369013284">ERF::z_phys_cc</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; z_phys_cc</div><div class="ttdef"><b>Definition:</b> ERF.H:804</div></div>
<div class="ttc" id="aclassERF_html_a32dd48049e8acbe95decdd4b01b782c4"><div class="ttname"><a href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">ERF::solverChoice</a></div><div class="ttdeci">static SolverChoice solverChoice</div><div class="ttdef"><b>Definition:</b> ERF.H:992</div></div>
<div class="ttc" id="aclassERF_html_a34160ca20fb400ee285664117cb80512"><div class="ttname"><a href="classERF.html#a34160ca20fb400ee285664117cb80512">ERF::FPr_c</a></div><div class="ttdeci">amrex::Vector&lt; ERFFillPatcher &gt; FPr_c</div><div class="ttdef"><b>Definition:</b> ERF.H:778</div></div>
<div class="ttc" id="aclassERF_html_a3e146164ca6929ec6d4984b6a3f43c81"><div class="ttname"><a href="classERF.html#a3e146164ca6929ec6d4984b6a3f43c81">ERF::vel_t_avg</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; vel_t_avg</div><div class="ttdef"><b>Definition:</b> ERF.H:714</div></div>
<div class="ttc" id="aclassERF_html_a45c8ecd777f47732993777a0afb8e140"><div class="ttname"><a href="classERF.html#a45c8ecd777f47732993777a0afb8e140">ERF::physbcs_w</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; ERFPhysBCFunct_w &gt; &gt; physbcs_w</div><div class="ttdef"><b>Definition:</b> ERF.H:725</div></div>
<div class="ttc" id="aclassERF_html_a4c1fae5e620fcd64cc9ede73715e3b7c"><div class="ttname"><a href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">ERF::base_state</a></div><div class="ttdeci">amrex::Vector&lt; amrex::MultiFab &gt; base_state</div><div class="ttdef"><b>Definition:</b> ERF.H:835</div></div>
<div class="ttc" id="aclassERF_html_a521d1faf157e3bccc86c0f26ee923576"><div class="ttname"><a href="classERF.html#a521d1faf157e3bccc86c0f26ee923576">ERF::Qv_prim</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; Qv_prim</div><div class="ttdef"><b>Definition:</b> ERF.H:730</div></div>
<div class="ttc" id="aclassERF_html_a54e37988486ef96e55e84bd8e91bb688"><div class="ttname"><a href="classERF.html#a54e37988486ef96e55e84bd8e91bb688">ERF::rV_new</a></div><div class="ttdeci">amrex::Vector&lt; amrex::MultiFab &gt; rV_new</div><div class="ttdef"><b>Definition:</b> ERF.H:737</div></div>
<div class="ttc" id="aclassERF_html_a574521986a6e403159f83c8b8123ba90"><div class="ttname"><a href="classERF.html#a574521986a6e403159f83c8b8123ba90">ERF::domain_bcs_type</a></div><div class="ttdeci">amrex::Vector&lt; amrex::BCRec &gt; domain_bcs_type</div><div class="ttdef"><b>Definition:</b> ERF.H:851</div></div>
<div class="ttc" id="aclassERF_html_a57d8432920785f8e58cf11a3232d76b5"><div class="ttname"><a href="classERF.html#a57d8432920785f8e58cf11a3232d76b5">ERF::Qr_prim</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; Qr_prim</div><div class="ttdef"><b>Definition:</b> ERF.H:731</div></div>
<div class="ttc" id="aclassERF_html_a64e55e5ae9df06433146db657eb9e72e"><div class="ttname"><a href="classERF.html#a64e55e5ae9df06433146db657eb9e72e">ERF::physbcs_u</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; ERFPhysBCFunct_u &gt; &gt; physbcs_u</div><div class="ttdef"><b>Definition:</b> ERF.H:723</div></div>
<div class="ttc" id="aclassERF_html_a6837423e9248e923fcaa1987b59d8160"><div class="ttname"><a href="classERF.html#a6837423e9248e923fcaa1987b59d8160">ERF::t_avg_cnt</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Real &gt; t_avg_cnt</div><div class="ttdef"><b>Definition:</b> ERF.H:715</div></div>
<div class="ttc" id="aclassERF_html_a6eecc44323f77917c95869928284f61d"><div class="ttname"><a href="classERF.html#a6eecc44323f77917c95869928284f61d">ERF::rU_old</a></div><div class="ttdeci">amrex::Vector&lt; amrex::MultiFab &gt; rU_old</div><div class="ttdef"><b>Definition:</b> ERF.H:734</div></div>
<div class="ttc" id="aclassERF_html_a71629ae2fda396472198691b75d83b2e"><div class="ttname"><a href="classERF.html#a71629ae2fda396472198691b75d83b2e">ERF::Theta_prim</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; Theta_prim</div><div class="ttdef"><b>Definition:</b> ERF.H:729</div></div>
<div class="ttc" id="aclassERF_html_a79231b5cfd4576a742e46ae0082b5121"><div class="ttname"><a href="classERF.html#a79231b5cfd4576a742e46ae0082b5121">ERF::physbcs_v</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; ERFPhysBCFunct_v &gt; &gt; physbcs_v</div><div class="ttdef"><b>Definition:</b> ERF.H:724</div></div>
<div class="ttc" id="aclassERF_html_a93e63e5af35efa564fd4195e8703f84c"><div class="ttname"><a href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">ERF::z_phys_nd</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; z_phys_nd</div><div class="ttdef"><b>Definition:</b> ERF.H:803</div></div>
<div class="ttc" id="aclassERF_html_a96a272defae485c5b83fbc123a631f9f"><div class="ttname"><a href="classERF.html#a96a272defae485c5b83fbc123a631f9f">ERF::advance_dycore</a></div><div class="ttdeci">void advance_dycore(int level, amrex::Vector&lt; amrex::MultiFab &gt; &amp;state_old, amrex::Vector&lt; amrex::MultiFab &gt; &amp;state_new, amrex::MultiFab &amp;xvel_old, amrex::MultiFab &amp;yvel_old, amrex::MultiFab &amp;zvel_old, amrex::MultiFab &amp;xvel_new, amrex::MultiFab &amp;yvel_new, amrex::MultiFab &amp;zvel_new, amrex::MultiFab &amp;source, amrex::MultiFab &amp;xmom_src, amrex::MultiFab &amp;ymom_src, amrex::MultiFab &amp;zmom_src, amrex::MultiFab &amp;buoyancy, amrex::Geometry fine_geom, amrex::Real dt, amrex::Real time)</div><div class="ttdef"><b>Definition:</b> ERF_AdvanceDycore.cpp:38</div></div>
<div class="ttc" id="aclassERF_html_aa46c0b0d20525aed10f447923e54dde7"><div class="ttname"><a href="classERF.html#aa46c0b0d20525aed10f447923e54dde7">ERF::rW_new</a></div><div class="ttdeci">amrex::Vector&lt; amrex::MultiFab &gt; rW_new</div><div class="ttdef"><b>Definition:</b> ERF.H:739</div></div>
<div class="ttc" id="aclassERF_html_aaf7e8e28172eebdfe2224e4ee823310d"><div class="ttname"><a href="classERF.html#aaf7e8e28172eebdfe2224e4ee823310d">ERF::zmom_crse_rhs</a></div><div class="ttdeci">amrex::Vector&lt; amrex::MultiFab &gt; zmom_crse_rhs</div><div class="ttdef"><b>Definition:</b> ERF.H:743</div></div>
<div class="ttc" id="aclassERF_html_ab463dd8a88f21f3a5ff33b583a883c28"><div class="ttname"><a href="classERF.html#ab463dd8a88f21f3a5ff33b583a883c28">ERF::advance_lsm</a></div><div class="ttdeci">void advance_lsm(int lev, amrex::MultiFab &amp;cons_in, amrex::MultiFab &amp;xvel_in, amrex::MultiFab &amp;yvel_in, const amrex::Real &amp;dt_advance)</div><div class="ttdef"><b>Definition:</b> ERF_AdvanceLSM.cpp:5</div></div>
<div class="ttc" id="aclassERF_html_ac1b9cce4a3c1736c4af78f6b0e2143ce"><div class="ttname"><a href="classERF.html#ac1b9cce4a3c1736c4af78f6b0e2143ce">ERF::turbPert</a></div><div class="ttdeci">TurbulentPerturbation turbPert</div><div class="ttdef"><b>Definition:</b> ERF.H:995</div></div>
<div class="ttc" id="aclassERF_html_ac1fa56ec90f44e3cdf487af46804163f"><div class="ttname"><a href="classERF.html#ac1fa56ec90f44e3cdf487af46804163f">ERF::rW_old</a></div><div class="ttdeci">amrex::Vector&lt; amrex::MultiFab &gt; rW_old</div><div class="ttdef"><b>Definition:</b> ERF.H:738</div></div>
<div class="ttc" id="aclassERF_html_ac50bb696daf587e13f9a1e57c687375e"><div class="ttname"><a href="classERF.html#ac50bb696daf587e13f9a1e57c687375e">ERF::m_SurfaceLayer</a></div><div class="ttdeci">std::unique_ptr&lt; SurfaceLayer &gt; m_SurfaceLayer</div><div class="ttdef"><b>Definition:</b> ERF.H:1154</div></div>
<div class="ttc" id="aclassERF_html_ac9a11403c2238d0d1e7b65b2d100dbaf"><div class="ttname"><a href="classERF.html#ac9a11403c2238d0d1e7b65b2d100dbaf">ERF::FPr_w</a></div><div class="ttdeci">amrex::Vector&lt; ERFFillPatcher &gt; FPr_w</div><div class="ttdef"><b>Definition:</b> ERF.H:781</div></div>
<div class="ttc" id="aclassERF_html_ad34bae243fdb6c3029f5abe4fb4bca2d"><div class="ttname"><a href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">ERF::dt</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Real &gt; dt</div><div class="ttdef"><b>Definition:</b> ERF.H:701</div></div>
<div class="ttc" id="aclassERF_html_ad3ef30449c979e90c40b0c6f79864e8f"><div class="ttname"><a href="classERF.html#ad3ef30449c979e90c40b0c6f79864e8f">ERF::advance_radiation</a></div><div class="ttdeci">void advance_radiation(int lev, amrex::MultiFab &amp;cons_in, const amrex::Real &amp;dt_advance)</div><div class="ttdef"><b>Definition:</b> ERF_AdvanceRadiation.cpp:5</div></div>
<div class="ttc" id="aclassERF_html_ad64b5fe566102dc053b35ad337971a3e"><div class="ttname"><a href="classERF.html#ad64b5fe566102dc053b35ad337971a3e">ERF::advance_microphysics</a></div><div class="ttdeci">void advance_microphysics(int lev, amrex::MultiFab &amp;cons_in, const amrex::Real &amp;dt_advance, const int &amp;iteration, const amrex::Real &amp;time)</div><div class="ttdef"><b>Definition:</b> ERF_AdvanceMicrophysics.cpp:5</div></div>
<div class="ttc" id="aclassERF_html_ad9084179f7384e10a519989ffd51fd34"><div class="ttname"><a href="classERF.html#ad9084179f7384e10a519989ffd51fd34">ERF::cf_width</a></div><div class="ttdeci">int cf_width</div><div class="ttdef"><b>Definition:</b> ERF.H:776</div></div>
<div class="ttc" id="aclassERF_html_ae6df94c25ac21bf6a2e856a9901e3a15"><div class="ttname"><a href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">ERF::phys_bc_type</a></div><div class="ttdeci">amrex::GpuArray&lt; ERF_BC, AMREX_SPACEDIM *2 &gt; phys_bc_type</div><div class="ttdef"><b>Definition:</b> ERF.H:864</div></div>
<div class="ttc" id="aclassERF_html_aeb64e3b4def989ce68d873aefeed5e0e"><div class="ttname"><a href="classERF.html#aeb64e3b4def989ce68d873aefeed5e0e">ERF::rV_old</a></div><div class="ttdeci">amrex::Vector&lt; amrex::MultiFab &gt; rV_old</div><div class="ttdef"><b>Definition:</b> ERF.H:736</div></div>
<div class="ttc" id="aclassERF_html_af31e928baa970a1507dfb0233b352542"><div class="ttname"><a href="classERF.html#af31e928baa970a1507dfb0233b352542">ERF::vars_old</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; amrex::MultiFab &gt; &gt; vars_old</div><div class="ttdef"><b>Definition:</b> ERF.H:708</div></div>
<div class="ttc" id="aclassERF_html_afded764725240c356faffa97dddbe03d"><div class="ttname"><a href="classERF.html#afded764725240c356faffa97dddbe03d">ERF::FillPatch</a></div><div class="ttdeci">void FillPatch(int lev, amrex::Real time, const amrex::Vector&lt; amrex::MultiFab * &gt; &amp;mfs_vel, bool cons_only=false)</div></div>
<div class="ttc" id="anamespaceBCVars_html_a00367571247ba920989360b94c156f4aa03b35ec9e83f34bb1349a86965d34e34"><div class="ttname"><a href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa03b35ec9e83f34bb1349a86965d34e34">BCVars::zvel_bc</a></div><div class="ttdeci">@ zvel_bc</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:89</div></div>
<div class="ttc" id="anamespaceBCVars_html_a00367571247ba920989360b94c156f4aa98ad22810fdfe9e585bc6481fc12454e"><div class="ttname"><a href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a></div><div class="ttdeci">@ yvel_bc</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:88</div></div>
<div class="ttc" id="anamespaceBCVars_html_a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec"><div class="ttname"><a href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a></div><div class="ttdeci">@ cons_bc</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:76</div></div>
<div class="ttc" id="anamespaceBCVars_html_a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4"><div class="ttname"><a href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a></div><div class="ttdeci">@ xvel_bc</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:87</div></div>
<div class="ttc" id="anamespaceIntVars_html_a52282f730c54deb760c414b54a12a269a2e60798bc45154a8f905b1aa228a24e5"><div class="ttname"><a href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269a2e60798bc45154a8f905b1aa228a24e5">IntVars::ymom</a></div><div class="ttdeci">@ ymom</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:160</div></div>
<div class="ttc" id="anamespaceIntVars_html_a52282f730c54deb760c414b54a12a269a2e7100afbf5e7a39371f1cb29f6f570a"><div class="ttname"><a href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269a2e7100afbf5e7a39371f1cb29f6f570a">IntVars::cons</a></div><div class="ttdeci">@ cons</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:158</div></div>
<div class="ttc" id="anamespaceIntVars_html_a52282f730c54deb760c414b54a12a269aaab25f707cae69bfadac2abcd17a2188"><div class="ttname"><a href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269aaab25f707cae69bfadac2abcd17a2188">IntVars::zmom</a></div><div class="ttdeci">@ zmom</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:161</div></div>
<div class="ttc" id="anamespaceIntVars_html_a52282f730c54deb760c414b54a12a269af661293a5a71ca532c214929b98c0bad"><div class="ttname"><a href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269af661293a5a71ca532c214929b98c0bad">IntVars::xmom</a></div><div class="ttdeci">@ xmom</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:159</div></div>
<div class="ttc" id="anamespaceMicVar__Morr_html_ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821"><div class="ttname"><a href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">MicVar_Morr::ng</a></div><div class="ttdeci">@ ng</div><div class="ttdef"><b>Definition:</b> ERF_Morrison.H:48</div></div>
<div class="ttc" id="anamespaceVars_html_a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c"><div class="ttname"><a href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a></div><div class="ttdeci">@ xvel</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:141</div></div>
<div class="ttc" id="anamespaceVars_html_a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b"><div class="ttname"><a href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a></div><div class="ttdeci">@ cons</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:140</div></div>
<div class="ttc" id="anamespaceVars_html_a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b"><div class="ttname"><a href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a></div><div class="ttdeci">@ zvel</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:143</div></div>
<div class="ttc" id="anamespaceVars_html_a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6"><div class="ttname"><a href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a></div><div class="ttdeci">@ yvel</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:142</div></div>
<div class="ttc" id="astructSolverChoice_html_a1d9237205fd632dcde1599511f203131"><div class="ttname"><a href="structSolverChoice.html#a1d9237205fd632dcde1599511f203131">SolverChoice::RhoQr_comp</a></div><div class="ttdeci">int RhoQr_comp</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:830</div></div>
<div class="ttc" id="astructSolverChoice_html_a5dc385a342ac6c50e0f9a638a0e31f9f"><div class="ttname"><a href="structSolverChoice.html#a5dc385a342ac6c50e0f9a638a0e31f9f">SolverChoice::RhoQc_comp</a></div><div class="ttdeci">int RhoQc_comp</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:824</div></div>
<div class="ttc" id="astructSolverChoice_html_a9ac649bbebc73403e291d2af180d4061"><div class="ttname"><a href="structSolverChoice.html#a9ac649bbebc73403e291d2af180d4061">SolverChoice::RhoQv_comp</a></div><div class="ttdeci">int RhoQv_comp</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:823</div></div>
<div class="ttc" id="astructSolverChoice_html_aa7be0d60ce3de3441d44082cc1b725ec"><div class="ttname"><a href="structSolverChoice.html#aa7be0d60ce3de3441d44082cc1b725ec">SolverChoice::anelastic</a></div><div class="ttdeci">amrex::Vector&lt; int &gt; anelastic</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:724</div></div>
<div class="ttc" id="astructSolverChoice_html_aacbfbe6f4a3040db3efdc6dbf8fa291b"><div class="ttname"><a href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">SolverChoice::moisture_type</a></div><div class="ttdeci">MoistureType moisture_type</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:804</div></div>
<div class="ttc" id="astructSolverChoice_html_abfd94767b3721755632c45a5ef290544"><div class="ttname"><a href="structSolverChoice.html#abfd94767b3721755632c45a5ef290544">SolverChoice::pert_type</a></div><div class="ttdeci">PerturbationType pert_type</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:791</div></div>
<div class="ttc" id="astructSolverChoice_html_ac0a723e8797cdc0fe06b3fc781fca645"><div class="ttname"><a href="structSolverChoice.html#ac0a723e8797cdc0fe06b3fc781fca645">SolverChoice::windfarm_type</a></div><div class="ttdeci">WindFarmType windfarm_type</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:805</div></div>
<div class="ttc" id="astructSolverChoice_html_af3119a4089367206db9fc3a17664e874"><div class="ttname"><a href="structSolverChoice.html#af3119a4089367206db9fc3a17664e874">SolverChoice::time_avg_vel</a></div><div class="ttdeci">bool time_avg_vel</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:788</div></div>
<div class="ttc" id="astructTurbulentPerturbation_html_a0bc940e3c9b5cd1ebcf866aaa344cfed"><div class="ttname"><a href="structTurbulentPerturbation.html#a0bc940e3c9b5cd1ebcf866aaa344cfed">TurbulentPerturbation::pb_cell</a></div><div class="ttdeci">amrex::Vector&lt; amrex::MultiFab &gt; pb_cell</div><div class="ttdef"><b>Definition:</b> ERF_TurbPertStruct.H:647</div></div>
<div class="ttc" id="astructTurbulentPerturbation_html_a5e6200f8b6bea3c4944dccc6c7285102"><div class="ttname"><a href="structTurbulentPerturbation.html#a5e6200f8b6bea3c4944dccc6c7285102">TurbulentPerturbation::calc_tpi_update</a></div><div class="ttdeci">void calc_tpi_update(const int lev, const amrex::Real dt, amrex::MultiFab &amp;mf_xvel, amrex::MultiFab &amp;mf_yvel, amrex::MultiFab &amp;mf_cons)</div><div class="ttdef"><b>Definition:</b> ERF_TurbPertStruct.H:223</div></div>
<div class="ttc" id="astructTurbulentPerturbation_html_adcb414231654ad9f5232a1a3377c30f2"><div class="ttname"><a href="structTurbulentPerturbation.html#adcb414231654ad9f5232a1a3377c30f2">TurbulentPerturbation::apply_tpi</a></div><div class="ttdeci">void apply_tpi(const int &amp;lev, const amrex::Box &amp;vbx, const int &amp;comp, const amrex::IndexType &amp;m_ixtype, const amrex::Array4&lt; amrex::Real &gt; &amp;src_arr, const amrex::Array4&lt; amrex::Real const &gt; &amp;pert_cell)</div><div class="ttdef"><b>Definition:</b> ERF_TurbPertStruct.H:324</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a47413fe5588f7dd71a1d5087a9e804f9_cgraph.png" border="0" usemap="#aclassERF_a47413fe5588f7dd71a1d5087a9e804f9_cgraph" alt=""/></div>
<map name="aclassERF_a47413fe5588f7dd71a1d5087a9e804f9_cgraph" id="aclassERF_a47413fe5588f7dd71a1d5087a9e804f9_cgraph">
<area shape="rect" title=" " alt="" coords="5,97,116,123"/>
<area shape="rect" href="ERF__Advance_8cpp.html#a9e781a79c3bc849e4b6876e91c7cdf34" title=" " alt="" coords="171,5,320,47"/>
<area shape="rect" href="ERF__TileNoZ_8H.html#a8da113f1d5603f7297fe1d03e5013f00" title=" " alt="" coords="209,71,282,98"/>
<area shape="rect" href="ERF__TimeAvgVel_8cpp.html#a2241063c19e843eaaa749c3b51b6b0fe" title=" " alt="" coords="170,122,321,149"/>
<area shape="rect" href="ERF__Utils_8H.html#a5e2e36af19c0192915a2ca721c0cded4" title=" " alt="" coords="164,173,327,199"/>
</map>
</div>

</div>
</div>
<a id="a96a272defae485c5b83fbc123a631f9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96a272defae485c5b83fbc123a631f9f">&#9670;&nbsp;</a></span>advance_dycore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::advance_dycore </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>level</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Vector&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>state_old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Vector&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>state_new</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>xvel_old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>yvel_old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>zvel_old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>xvel_new</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>yvel_new</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>zvel_new</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>xmom_src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>ymom_src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>zmom_src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>buoyancy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Geometry&#160;</td>
          <td class="paramname"><em>fine_geom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function that advances the solution at one level for a single time step &ndash; this sets up the multirate time integrator and calls the integrator's advance function</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">level</td><td>level of refinement (coarsest level is 0) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">state_old</td><td>old-time conserved variables </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">state_new</td><td>new-time conserved variables </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xvel_old</td><td>old-time x-component of velocity </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yvel_old</td><td>old-time y-component of velocity </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zvel_old</td><td>old-time z-component of velocity </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xvel_new</td><td>new-time x-component of velocity </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yvel_new</td><td>new-time y-component of velocity </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zvel_new</td><td>new-time z-component of velocity </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cc_src</td><td>source term for conserved variables </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xmom_src</td><td>source term for x-momenta </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ymom_src</td><td>source term for y-momenta </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zmom_src</td><td>source term for z-momenta </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fine_geom</td><td>container for geometry information at current level </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dt_advance</td><td>time step for this time advance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">old_time</td><td>old time for this time advance </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;{</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    BL_PROFILE_VAR(<span class="stringliteral">&quot;erf_advance_dycore()&quot;</span>,erf_advance_dycore);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keyword">const</span> Box&amp; domain = fine_geom.Domain();</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <a class="code" href="structDiffChoice.html">DiffChoice</a> dc    = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a396122e87a3d15c4ec8666d7dd18c095">diffChoice</a>;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <a class="code" href="structTurbChoice.html">TurbChoice</a> tc    = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa53b017d79e0067923180a0aa59367b4">turbChoice</a>[level];</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <a class="code" href="structSpongeChoice.html">SpongeChoice</a> sc  = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac066852f06a6409e1638f59868b7c57d">spongeChoice</a>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    MultiFab r_hse (<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[level], make_alias, <a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91abc888a343d4fcc4fc4ffb79c6ac7cb93">BaseState::r0_comp</a> , 1);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    MultiFab p_hse (<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[level], make_alias, <a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91aa8253dc5484f2621e0bf8d51d98d635e">BaseState::p0_comp</a> , 1);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    MultiFab pi_hse(<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[level], make_alias, <a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91a3d99e10d828f251e465bc2c66062badf">BaseState::pi0_comp</a>, 1);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="comment">// These pointers are used in the MRI utility functions</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    MultiFab* r0  = &amp;r_hse;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    MultiFab* <a class="code" href="namespacemodule__model__constants.html#a2dcccd992b668c86eecdd9a825970d4a">p0</a>  = &amp;p_hse;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    MultiFab* pi0 = &amp;pi_hse;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    Real* dptr_rhotheta_src = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a4e81a09c9f454c680568b7776a3ed90e">custom_rhotheta_forcing</a> ? <a class="code" href="classERF.html#a0c1fdcfbc9cbd6cb13e41d1170b161f8">d_rhotheta_src</a>[level].data() : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    Real* dptr_rhoqt_src    = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa2e312b4e6d08797fc3c1b6d67313d48">custom_moisture_forcing</a> ? <a class="code" href="classERF.html#a838687881ef3626f932d0e95ceff0e53">d_rhoqt_src</a>[level].data()    : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    Real* dptr_wbar_sub     = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a596f061b796ada0389c81a6125150b6e">custom_w_subsidence</a>     ? <a class="code" href="classERF.html#ac94ddee2f501dbcea2a516284b7119b5">d_w_subsid</a>[level].data()     : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="comment">// Turbulent Perturbation Pointer</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="comment">//Real* dptr_rhotheta_src = solverChoice.pert_type ? d_rhotheta_src[level].data() : nullptr;</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    Vector&lt;Real*&gt; d_rayleigh_ptrs_at_lev;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    d_rayleigh_ptrs_at_lev.resize(<a class="code" href="ERF__DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a7c3c83d6fcec1f134956c3160adf6e39">Rayleigh::nvars</a>);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    d_rayleigh_ptrs_at_lev[<a class="code" href="ERF__DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a3d2cdf8cea6cb933d4ce759c1ff1b948">Rayleigh::ubar</a>]     = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a5aed4016dd7d17a2d2904c60af59ae9d">rayleigh_damp_U</a>   ? <a class="code" href="classERF.html#ad598bde8e728479faaa7c2820096b47a">d_rayleigh_ptrs</a>[level][<a class="code" href="ERF__DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a3d2cdf8cea6cb933d4ce759c1ff1b948">Rayleigh::ubar</a>].data() : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    d_rayleigh_ptrs_at_lev[<a class="code" href="ERF__DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239acb08c6a1b8bca5e9e4ef6162aef2cfa4">Rayleigh::vbar</a>]     = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a1bae456f7b26e8ed50d78ce1af1b5ef0">rayleigh_damp_V</a>   ? <a class="code" href="classERF.html#ad598bde8e728479faaa7c2820096b47a">d_rayleigh_ptrs</a>[level][<a class="code" href="ERF__DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239acb08c6a1b8bca5e9e4ef6162aef2cfa4">Rayleigh::vbar</a>].data() : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    d_rayleigh_ptrs_at_lev[<a class="code" href="ERF__DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a3d8bd6001a2421b06c3ec4e9f2dcdffd">Rayleigh::wbar</a>]     = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#abf35af2e52f5c1197264d895396ca59c">rayleigh_damp_W</a>   ? <a class="code" href="classERF.html#ad598bde8e728479faaa7c2820096b47a">d_rayleigh_ptrs</a>[level][<a class="code" href="ERF__DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a3d8bd6001a2421b06c3ec4e9f2dcdffd">Rayleigh::wbar</a>].data() : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    d_rayleigh_ptrs_at_lev[<a class="code" href="ERF__DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239ae41e9f65f26ee3b04db07f2db7f28bdb">Rayleigh::thetabar</a>] = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a06a0dd1c8f7c1ed73a4f8d24b6b31cdf">rayleigh_damp_T</a>   ? <a class="code" href="classERF.html#ad598bde8e728479faaa7c2820096b47a">d_rayleigh_ptrs</a>[level][<a class="code" href="ERF__DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239ae41e9f65f26ee3b04db07f2db7f28bdb">Rayleigh::thetabar</a>].data() : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    Vector&lt;Real*&gt; d_sponge_ptrs_at_lev;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordflow">if</span>(sc.<a class="code" href="structSpongeChoice.html#a1a41f754595d713df32583f0b0fa606e">sponge_type</a>==<span class="stringliteral">&quot;input_sponge&quot;</span>)</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    {</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        d_sponge_ptrs_at_lev.resize(<a class="code" href="ERF__DataStruct_8H.html#a5bebd9ff4e2455172deca3b399214fcba7f0566bdfe36c67d532a7e2aca33d9a4">Sponge::nvars_sponge</a>);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        d_sponge_ptrs_at_lev[<a class="code" href="ERF__DataStruct_8H.html#a5bebd9ff4e2455172deca3b399214fcbac159d9fae0d25be7ce907e1feb87cdaa">Sponge::ubar_sponge</a>]  =  <a class="code" href="classERF.html#a3b9bcb54c278dfec6027e9727cc01bc5">d_sponge_ptrs</a>[level][<a class="code" href="ERF__DataStruct_8H.html#a5bebd9ff4e2455172deca3b399214fcbac159d9fae0d25be7ce907e1feb87cdaa">Sponge::ubar_sponge</a>].data();</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        d_sponge_ptrs_at_lev[<a class="code" href="ERF__DataStruct_8H.html#a5bebd9ff4e2455172deca3b399214fcbaad1bdec1c0213a18483e81bcb4926964">Sponge::vbar_sponge</a>]  =  <a class="code" href="classERF.html#a3b9bcb54c278dfec6027e9727cc01bc5">d_sponge_ptrs</a>[level][<a class="code" href="ERF__DataStruct_8H.html#a5bebd9ff4e2455172deca3b399214fcbaad1bdec1c0213a18483e81bcb4926964">Sponge::vbar_sponge</a>].data();</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    }</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordtype">bool</span> l_use_terrain_fitted_coords = (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a1952672901901b0b3a628f2298dc72c2">mesh_type</a> != MeshType::ConstantDz);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keywordtype">bool</span> l_use_kturb   = tc.<a class="code" href="structTurbChoice.html#ae413138f8a3097389177d3fd96ec43fe">use_kturb</a>;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordtype">bool</span> l_use_diff    = ( (dc.<a class="code" href="structDiffChoice.html#aed5c75ec58e358a735d97869147b2baf">molec_diff_type</a> != <a class="code" href="ERF__DiffStruct_8H.html#a84e6bfbbb8e490790c506939b364f735a6adf97f83acf6453d4a6a4b1070f3754">MolecDiffType::None</a>) ||</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                           l_use_kturb );</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordtype">bool</span> l_use_moisture = ( <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> != MoistureType::None );</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordtype">bool</span> l_implicit_substepping = ( <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a7c414e2fb7c53479a2d21bb3a2d4099e">substepping_type</a>[level] == SubsteppingType::Implicit );</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> use_SurfLayer = (<a class="code" href="classERF.html#ac50bb696daf587e13f9a1e57c687375e">m_SurfaceLayer</a> != <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keyword">const</span> FArrayBox* z_0     = (use_SurfLayer) ? <a class="code" href="classERF.html#ac50bb696daf587e13f9a1e57c687375e">m_SurfaceLayer</a>-&gt;get_z0(level) : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keyword">const</span> BoxArray&amp; ba            = state_old[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269a2e7100afbf5e7a39371f1cb29f6f570a">IntVars::cons</a>].boxArray();</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keyword">const</span> BoxArray&amp; ba_z          = zvel_old.boxArray();</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keyword">const</span> DistributionMapping&amp; dm = state_old[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269a2e7100afbf5e7a39371f1cb29f6f570a">IntVars::cons</a>].DistributionMap();</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordtype">int</span> num_prim = state_old[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269a2e7100afbf5e7a39371f1cb29f6f570a">IntVars::cons</a>].nComp() - 1;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    MultiFab    S_prim  (ba  , dm, num_prim,          state_old[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269a2e7100afbf5e7a39371f1cb29f6f570a">IntVars::cons</a>].nGrowVect());</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    MultiFab  pi_stage  (ba  , dm,        1,          state_old[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269a2e7100afbf5e7a39371f1cb29f6f570a">IntVars::cons</a>].nGrowVect());</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    MultiFab fast_coeffs(ba_z, dm,        5,          0);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    MultiFab* eddyDiffs = <a class="code" href="classERF.html#a327d704704abd516be19339cb2d226f9">eddyDiffs_lev</a>[level].get();</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    MultiFab* SmnSmn    = <a class="code" href="classERF.html#a9faaa96a7c270d2b2b062d9f30f19711">SmnSmn_lev</a>[level].get();</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="comment">// **************************************************************************************</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="comment">// Compute strain for use in slow RHS and Smagorinsky model</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="comment">// **************************************************************************************</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    BL_PROFILE(<span class="stringliteral">&quot;erf_advance_strain&quot;</span>);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordflow">if</span> (l_use_diff) {</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <span class="keyword">const</span> BCRec* bc_ptr_h = <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>.data();</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="keyword">const</span> GpuArray&lt;Real, AMREX_SPACEDIM&gt; dxInv = fine_geom.InvCellSizeArray();</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="preprocessor">#pragma omp parallel if (Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <span class="keywordflow">for</span> ( MFIter mfi(state_new[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269a2e7100afbf5e7a39371f1cb29f6f570a">IntVars::cons</a>],<a class="code" href="ERF__TileNoZ_8H.html#a8da113f1d5603f7297fe1d03e5013f00">TileNoZ</a>()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            Box bxcc  = mfi.growntilebox(IntVect(1,1,0));</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            Box tbxxy = mfi.tilebox(IntVect(1,1,0),IntVect(1,1,0));</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            Box tbxxz = mfi.tilebox(IntVect(1,0,1),IntVect(1,1,0));</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            Box tbxyz = mfi.tilebox(IntVect(0,1,1),IntVect(1,1,0));</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            <span class="keywordflow">if</span> (bxcc.smallEnd(2) != domain.smallEnd(2)) {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                 bxcc.growLo(2,1);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                tbxxy.growLo(2,1);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                tbxxz.growLo(2,1);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                tbxyz.growLo(2,1);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            }</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            <span class="keywordflow">if</span> (bxcc.bigEnd(2) != domain.bigEnd(2)) {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                 bxcc.growHi(2,1);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                tbxxy.growHi(2,1);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                tbxxz.growHi(2,1);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                tbxyz.growHi(2,1);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            }</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            <span class="keyword">const</span> Array4&lt;const Real&gt; &amp; u = xvel_old.array(mfi);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            <span class="keyword">const</span> Array4&lt;const Real&gt; &amp; v = yvel_old.array(mfi);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            <span class="keyword">const</span> Array4&lt;const Real&gt; &amp; w = zvel_old.array(mfi);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            Array4&lt;Real&gt; <a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248baab4c45b861caaf89b0842306117db7bc">tau11</a> = <a class="code" href="classERF.html#a3d4a3ed54fb357c02e6494461f182aa1">Tau</a>[level][<a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248baab4c45b861caaf89b0842306117db7bc">TauType::tau11</a>].get()-&gt;array(mfi);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            Array4&lt;Real&gt; <a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248ba822e4f59780df9310afede8535eac286">tau22</a> = <a class="code" href="classERF.html#a3d4a3ed54fb357c02e6494461f182aa1">Tau</a>[level][<a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248ba822e4f59780df9310afede8535eac286">TauType::tau22</a>].get()-&gt;array(mfi);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            Array4&lt;Real&gt; <a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248ba1edaba247488baa9858b879f19ea09b7">tau33</a> = <a class="code" href="classERF.html#a3d4a3ed54fb357c02e6494461f182aa1">Tau</a>[level][<a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248ba1edaba247488baa9858b879f19ea09b7">TauType::tau33</a>].get()-&gt;array(mfi);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            Array4&lt;Real&gt; <a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248ba0a0d169ca6b3a0da988c65f1c284ba99">tau12</a> = <a class="code" href="classERF.html#a3d4a3ed54fb357c02e6494461f182aa1">Tau</a>[level][<a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248ba0a0d169ca6b3a0da988c65f1c284ba99">TauType::tau12</a>].get()-&gt;array(mfi);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            Array4&lt;Real&gt; <a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248baf5fa13cfd781cde0d363f337d7e76d7e">tau13</a> = <a class="code" href="classERF.html#a3d4a3ed54fb357c02e6494461f182aa1">Tau</a>[level][<a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248baf5fa13cfd781cde0d363f337d7e76d7e">TauType::tau13</a>].get()-&gt;array(mfi);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            Array4&lt;Real&gt; <a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248ba181b302bd0f99081c3c22fa38e1f8b73">tau23</a> = <a class="code" href="classERF.html#a3d4a3ed54fb357c02e6494461f182aa1">Tau</a>[level][<a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248ba181b302bd0f99081c3c22fa38e1f8b73">TauType::tau23</a>].get()-&gt;array(mfi);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            Array4&lt;Real&gt; <a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248bad6968d5de54faf0f6a42e5629f76f391">tau21</a>  = l_use_terrain_fitted_coords ? <a class="code" href="classERF.html#a3d4a3ed54fb357c02e6494461f182aa1">Tau</a>[level][<a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248bad6968d5de54faf0f6a42e5629f76f391">TauType::tau21</a>].get()-&gt;array(mfi) : Array4&lt;Real&gt;{};</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            Array4&lt;Real&gt; <a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248bacec8728fd270452c9985e46f971d6935">tau31</a>  = l_use_terrain_fitted_coords ? <a class="code" href="classERF.html#a3d4a3ed54fb357c02e6494461f182aa1">Tau</a>[level][<a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248bacec8728fd270452c9985e46f971d6935">TauType::tau31</a>].get()-&gt;array(mfi) : Array4&lt;Real&gt;{};</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            Array4&lt;Real&gt; <a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248babcbe024a60f6921af0060fd096ac8307">tau32</a>  = l_use_terrain_fitted_coords ? <a class="code" href="classERF.html#a3d4a3ed54fb357c02e6494461f182aa1">Tau</a>[level][<a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248babcbe024a60f6921af0060fd096ac8307">TauType::tau32</a>].get()-&gt;array(mfi) : Array4&lt;Real&gt;{};</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            <span class="keyword">const</span> Array4&lt;const Real&gt;&amp; z_nd = <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[level]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            <span class="keyword">const</span> Array4&lt;const Real&gt; mf_mx = <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[level][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85bac2a428daaf1a1b398630fa8cec7f115b">MapFacType::m_x</a>]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            <span class="keyword">const</span> Array4&lt;const Real&gt; mf_ux = <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[level][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85baa4b935f173fee2d487101e302a5cfe18">MapFacType::u_x</a>]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            <span class="keyword">const</span> Array4&lt;const Real&gt; mf_vx = <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[level][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85ba21e22c79b875be81696b36a623690388">MapFacType::v_x</a>]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            <span class="keyword">const</span> Array4&lt;const Real&gt; mf_my = <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[level][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85ba9612b6816e2fb7dc3ad56d6bc1fb7df8">MapFacType::m_y</a>]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            <span class="keyword">const</span> Array4&lt;const Real&gt; mf_uy = <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[level][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85ba784971ba75d56c0d71c4bc08c5ddc1f3">MapFacType::u_y</a>]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            <span class="keyword">const</span> Array4&lt;const Real&gt; mf_vy = <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[level][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85ba90990e92021688dbfd1cec52b03fd182">MapFacType::v_y</a>]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a1952672901901b0b3a628f2298dc72c2">mesh_type</a> == MeshType::StretchedDz) {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                <a class="code" href="ERF__ComputeStrain__S_8cpp.html#af92bd984eab8acd841b6f208f407b868">ComputeStrain_S</a>(bxcc, tbxxy, tbxxz, tbxyz, domain,</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                                u, v, w,</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                                <a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248baab4c45b861caaf89b0842306117db7bc">tau11</a>, <a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248ba822e4f59780df9310afede8535eac286">tau22</a>, <a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248ba1edaba247488baa9858b879f19ea09b7">tau33</a>,</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                                <a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248ba0a0d169ca6b3a0da988c65f1c284ba99">tau12</a>, <a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248bad6968d5de54faf0f6a42e5629f76f391">tau21</a>,</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                                <a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248baf5fa13cfd781cde0d363f337d7e76d7e">tau13</a>, <a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248bacec8728fd270452c9985e46f971d6935">tau31</a>,</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                                <a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248ba181b302bd0f99081c3c22fa38e1f8b73">tau23</a>, <a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248babcbe024a60f6921af0060fd096ac8307">tau32</a>,</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                                <a class="code" href="classERF.html#a6600f30f1043a4c5e62b5cdd05f0a99f">stretched_dz_d</a>[level], dxInv,</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                                mf_mx, mf_ux, mf_vx, mf_my, mf_uy, mf_vy, bc_ptr_h);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (l_use_terrain_fitted_coords) {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                <a class="code" href="ERF__ComputeStrain__T_8cpp.html#aa22ef692a7c5635bd53fb91a3237a662">ComputeStrain_T</a>(bxcc, tbxxy, tbxxz, tbxyz, domain,</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                                u, v, w,</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                                <a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248baab4c45b861caaf89b0842306117db7bc">tau11</a>, <a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248ba822e4f59780df9310afede8535eac286">tau22</a>, <a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248ba1edaba247488baa9858b879f19ea09b7">tau33</a>,</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                                <a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248ba0a0d169ca6b3a0da988c65f1c284ba99">tau12</a>, <a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248bad6968d5de54faf0f6a42e5629f76f391">tau21</a>,</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                                <a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248baf5fa13cfd781cde0d363f337d7e76d7e">tau13</a>, <a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248bacec8728fd270452c9985e46f971d6935">tau31</a>,</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                                <a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248ba181b302bd0f99081c3c22fa38e1f8b73">tau23</a>, <a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248babcbe024a60f6921af0060fd096ac8307">tau32</a>,</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                                z_nd, <a class="code" href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">detJ_cc</a>[level]-&gt;const_array(mfi), dxInv,</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                                mf_mx, mf_ux, mf_vx, mf_my, mf_uy, mf_vy, bc_ptr_h);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                <a class="code" href="ERF__ComputeStrain__N_8cpp.html#a24dce7d35c8c38140861b8bd691e5407">ComputeStrain_N</a>(bxcc, tbxxy, tbxxz, tbxyz, domain,</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                                u, v, w,</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                                <a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248baab4c45b861caaf89b0842306117db7bc">tau11</a>, <a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248ba822e4f59780df9310afede8535eac286">tau22</a>, <a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248ba1edaba247488baa9858b879f19ea09b7">tau33</a>,</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                                <a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248ba0a0d169ca6b3a0da988c65f1c284ba99">tau12</a>, <a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248baf5fa13cfd781cde0d363f337d7e76d7e">tau13</a>, <a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248ba181b302bd0f99081c3c22fa38e1f8b73">tau23</a>,</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                                dxInv,</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                                mf_mx, mf_ux, mf_vx, mf_my, mf_uy, mf_vy, bc_ptr_h);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            }</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        } <span class="comment">// mfi</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    } <span class="comment">// l_use_diff</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    } <span class="comment">// profile</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ERF__TI__utils_8H.html">ERF_TI_utils.H</a>&quot;</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="comment">// Additional SFS quantities, calculated once per timestep</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    MultiFab* Hfx1  = <a class="code" href="classERF.html#a25174b4ae6cfcac8f7d183ce5c9fe67b">SFS_hfx1_lev</a>[level].get();</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    MultiFab* Hfx2  = <a class="code" href="classERF.html#acb607b2e675b45fdcabc09b640ce5ae2">SFS_hfx2_lev</a>[level].get();</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    MultiFab* Hfx3  = <a class="code" href="classERF.html#a1a2e3faf5dd90ad2f9ded28b486f3b46">SFS_hfx3_lev</a>[level].get();</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    MultiFab* Q1fx1 = <a class="code" href="classERF.html#ae0316d5ae567a2da8439d204bace12ce">SFS_q1fx1_lev</a>[level].get();</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    MultiFab* Q1fx2 = <a class="code" href="classERF.html#a53fab1172ec3f01356355f8cda0919fe">SFS_q1fx2_lev</a>[level].get();</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    MultiFab* Q1fx3 = <a class="code" href="classERF.html#a101ceb89b1a249efeea3f4e8052bc8c0">SFS_q1fx3_lev</a>[level].get();</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    MultiFab* Q2fx3 = <a class="code" href="classERF.html#a3ea10ef7383e594b6ee5e7a9ad67607b">SFS_q2fx3_lev</a>[level].get();</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    MultiFab* Diss  = <a class="code" href="classERF.html#a6e1ad417e3bd062468d74830b65911fb">SFS_diss_lev</a>[level].get();</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="comment">// *************************************************************************</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="comment">// Calculate cell-centered eddy viscosity &amp; diffusivities</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="comment">// Notes -- we fill all the data in ghost cells before calling this so</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="comment">//    that we can fill the eddy viscosity in the ghost regions and</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="comment">//    not have to call a boundary filler on this data itself</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="comment">// LES - updates both horizontal and vertical eddy viscosity components</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="comment">// PBL - only updates vertical eddy viscosity components so horizontal</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="comment">//       components come from the LES model or are left as zero.</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="comment">// *************************************************************************</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keywordflow">if</span> (l_use_kturb)</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <span class="comment">// NOTE: state_new transfers to state_old for PBL (due to ptr swap in advance)</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <span class="keyword">const</span> BCRec* bc_ptr_h = <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>.data();</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <a class="code" href="ERF__ComputeTurbulentViscosity_8cpp.html#ae12ec663c91831742bfdc87d17498a5f">ComputeTurbulentViscosity</a>(xvel_old, yvel_old,<a class="code" href="classERF.html#a3d4a3ed54fb357c02e6494461f182aa1">Tau</a>[level],</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                                  state_old[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269a2e7100afbf5e7a39371f1cb29f6f570a">IntVars::cons</a>],</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                                  *<a class="code" href="classERF.html#a0276b556fdefec8b99be95846a3a35fe">walldist</a>[level].get(),</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                                  *eddyDiffs, *Hfx1, *Hfx2, *Hfx3, *Diss, <span class="comment">// to be updated</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                                  fine_geom, <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[level],</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                                  <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[level], <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>,</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                                  <a class="code" href="classERF.html#ac50bb696daf587e13f9a1e57c687375e">m_SurfaceLayer</a>, z_0, l_use_terrain_fitted_coords,</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                                  l_use_moisture, level, bc_ptr_h);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    }</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="comment">// ***********************************************************************************************</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="comment">// Update user-defined source terms -- these are defined once per time step (not per RK stage)</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="comment">// ***********************************************************************************************</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a4e81a09c9f454c680568b7776a3ed90e">custom_rhotheta_forcing</a>) {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <a class="code" href="classERF.html#a60e8cb933f237903e3fbcd6376c26db0">prob</a>-&gt;update_rhotheta_sources(old_time,</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                                      <a class="code" href="classERF.html#a87aad7caaf3b575734994b47628a2faf">h_rhotheta_src</a>[level], <a class="code" href="classERF.html#a0c1fdcfbc9cbd6cb13e41d1170b161f8">d_rhotheta_src</a>[level],</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                                      fine_geom, <a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[level]);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    }</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa2e312b4e6d08797fc3c1b6d67313d48">custom_moisture_forcing</a>) {</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <a class="code" href="classERF.html#a60e8cb933f237903e3fbcd6376c26db0">prob</a>-&gt;update_rhoqt_sources(old_time,</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                                   <a class="code" href="classERF.html#a3c5eca26a28dda3a981b3581abadfca0">h_rhoqt_src</a>[level], <a class="code" href="classERF.html#a838687881ef3626f932d0e95ceff0e53">d_rhoqt_src</a>[level],</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                                   fine_geom, <a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[level]);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    }</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a5e8754b29072596a584633734a9f64ef">custom_geostrophic_profile</a>) {</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        <a class="code" href="classERF.html#a60e8cb933f237903e3fbcd6376c26db0">prob</a>-&gt;update_geostrophic_profile(old_time,</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                                   <a class="code" href="classERF.html#a911c70f76cf62f205a1ce152ec4cdb54">h_u_geos</a>[level], <a class="code" href="classERF.html#ac020980af9dbf46be43dd9f7127c06da">d_u_geos</a>[level],</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                                   <a class="code" href="classERF.html#a825daede57fae86805edffd85d5d9dab">h_v_geos</a>[level], <a class="code" href="classERF.html#a7d245afb7b3236b5967902f50bf9000b">d_v_geos</a>[level],</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                                   fine_geom, <a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[level]);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    }</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a596f061b796ada0389c81a6125150b6e">custom_w_subsidence</a>) {</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <a class="code" href="classERF.html#a60e8cb933f237903e3fbcd6376c26db0">prob</a>-&gt;update_w_subsidence(old_time,</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                                  <a class="code" href="classERF.html#a1a5d0d0b4e8c196f56dfab98f245aff5">h_w_subsid</a>[level], <a class="code" href="classERF.html#ac94ddee2f501dbcea2a516284b7119b5">d_w_subsid</a>[level],</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                                  fine_geom, <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[level]);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    }</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="comment">// ***********************************************************************************************</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="comment">// Convert old velocity available on faces to old momentum on faces to be used in time integration</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="comment">// ***********************************************************************************************</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    MultiFab density(state_old[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269a2e7100afbf5e7a39371f1cb29f6f570a">IntVars::cons</a>], make_alias, <a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>, 1);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="comment">// This is an optimization since we won&#39;t need more than one ghost</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="comment">// cell of momentum in the integrator if not using numerical diffusion</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    IntVect ngu = (!<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a8d039800497a1e5084afeef94d367932">use_num_diff</a>) ? IntVect(1,1,1) : xvel_old.nGrowVect();</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    IntVect ngv = (!<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a8d039800497a1e5084afeef94d367932">use_num_diff</a>) ? IntVect(1,1,1) : yvel_old.nGrowVect();</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    IntVect ngw = (!<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a8d039800497a1e5084afeef94d367932">use_num_diff</a>) ? IntVect(1,1,0) : zvel_old.nGrowVect();</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <a class="code" href="ERF__Utils_8H.html#a5e2e36af19c0192915a2ca721c0cded4">VelocityToMomentum</a>(xvel_old, ngu, yvel_old, ngv, zvel_old, ngw, density,</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                       state_old[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269af661293a5a71ca532c214929b98c0bad">IntVars::xmom</a>],</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                       state_old[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269a2e60798bc45154a8f905b1aa228a24e5">IntVars::ymom</a>],</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                       state_old[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269aaab25f707cae69bfadac2abcd17a2188">IntVars::zmom</a>],</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                       domain, <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    MultiFab::Copy(xvel_new,xvel_old,0,0,1,xvel_old.nGrowVect());</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    MultiFab::Copy(yvel_new,yvel_old,0,0,1,yvel_old.nGrowVect());</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    MultiFab::Copy(zvel_new,zvel_old,0,0,1,zvel_old.nGrowVect());</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160; </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordtype">bool</span> fast_only = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keywordtype">bool</span> vel_and_mom_synced = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <a class="code" href="ERF__TI__utils_8H.html#a5e7934b18ef63bc8c4c16db42277c52f">apply_bcs</a>(state_old, old_time,</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;              state_old[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269a2e7100afbf5e7a39371f1cb29f6f570a">IntVars::cons</a>].nGrow(), state_old[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269af661293a5a71ca532c214929b98c0bad">IntVars::xmom</a>].nGrow(),</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;              fast_only, vel_and_mom_synced);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <a class="code" href="ERF__TI__utils_8H.html#a76b27b6105fe279f9a43296072c843b3">cons_to_prim</a>(state_old[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269a2e7100afbf5e7a39371f1cb29f6f570a">IntVars::cons</a>], state_old[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269a2e7100afbf5e7a39371f1cb29f6f570a">IntVars::cons</a>].nGrow());</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="comment">// ***********************************************************************************************</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="comment">// Define a new MultiFab that holds q_total and fill it by summing the moisture components --</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="comment">//      to be used in buoyancy calculation and as part of the inertial weighting in the</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="comment">// ***********************************************************************************************</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    MultiFab <a class="code" href="namespaceMicVar__Kess.html#ad5e2303f8f4cbf19829306f4a72d61a7a9f81c8a38dd25b5ae5821d48e8878b03">qt</a>(grids[level], dmap[level], 1, 1);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <a class="code" href="namespaceMicVar__Kess.html#ad5e2303f8f4cbf19829306f4a72d61a7a9f81c8a38dd25b5ae5821d48e8878b03">qt</a>.setVal(0.0);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ERF__TI__no__substep__fun_8H.html">ERF_TI_no_substep_fun.H</a>&quot;</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ERF__TI__substep__fun_8H.html">ERF_TI_substep_fun.H</a>&quot;</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ERF__TI__slow__rhs__pre_8H.html">ERF_TI_slow_rhs_pre.H</a>&quot;</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ERF__TI__slow__rhs__post_8H.html">ERF_TI_slow_rhs_post.H</a>&quot;</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="comment">// ***************************************************************************************</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="comment">// Setup the integrator and integrate for a single timestep</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="comment">// **************************************************************************************</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <a class="code" href="classMRISplitIntegrator.html">MRISplitIntegrator&lt;Vector&lt;MultiFab&gt;</a> &gt;&amp; mri_integrator = *<a class="code" href="classERF.html#a09d0fb2bd609c898a665d9530a744585">mri_integrator_mem</a>[level];</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="comment">// Define rhs and &#39;post update&#39; utility function that is called after calculating</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="comment">// any state data (e.g. at RK stages or at the end of a timestep)</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    mri_integrator.<a class="code" href="classMRISplitIntegrator.html#a137a1ceb1e8051b5a97aaab40492c0e1">set_slow_rhs_pre</a>(<a class="code" href="ERF__TI__slow__rhs__pre_8H.html#a963142d364408ee1775dbef20383b244">slow_rhs_fun_pre</a>);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    mri_integrator.<a class="code" href="classMRISplitIntegrator.html#af086d3c68787442d07f0a9d530618cc1">set_slow_rhs_post</a>(<a class="code" href="ERF__TI__slow__rhs__post_8H.html#af460c930508105e92f60fd868d23ebcf">slow_rhs_fun_post</a>);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    mri_integrator.<a class="code" href="classMRISplitIntegrator.html#aafed3f1d61d477bd1f01bdeb71a9ab11">set_fast_rhs</a>(<a class="code" href="ERF__TI__substep__fun_8H.html#ac6afbd55bf5b7264098d44d9b8928f57">fast_rhs_fun</a>);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    mri_integrator.<a class="code" href="classMRISplitIntegrator.html#ad31fb2cda1fc2dce80820ed7c4a3c052">set_slow_fast_timestep_ratio</a>(<a class="code" href="classERF.html#ad2e1a979c0ad68e87eaee349beb7e9fd">fixed_mri_dt_ratio</a> &gt; 0 ? <a class="code" href="classERF.html#ad2e1a979c0ad68e87eaee349beb7e9fd">fixed_mri_dt_ratio</a> : <a class="code" href="classERF.html#a3cf7cb2e51eb7b69cb4079ffc6722459">dt_mri_ratio</a>[level]);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    mri_integrator.<a class="code" href="classMRISplitIntegrator.html#a216903aa134536df210f489acdfd2b8b">set_no_substep</a>(<a class="code" href="ERF__TI__no__substep__fun_8H.html#a4cad8180e91d2eabd5638651fc24bcc7">no_substep_fun</a>);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160; </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    mri_integrator.<a class="code" href="classMRISplitIntegrator.html#ad78b5d1908a131c3597232a041ca267b">advance</a>(state_old, state_new, old_time, dt_advance);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a43d0b17f6e155691a1e9474526df3af5">verbose</a>) Print() &lt;&lt; <span class="stringliteral">&quot;Done with advance_dycore at level &quot;</span> &lt;&lt; level &lt;&lt; std::endl;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;}</div>
<div class="ttc" id="aERF__ComputeStrain__N_8cpp_html_a24dce7d35c8c38140861b8bd691e5407"><div class="ttname"><a href="ERF__ComputeStrain__N_8cpp.html#a24dce7d35c8c38140861b8bd691e5407">ComputeStrain_N</a></div><div class="ttdeci">void ComputeStrain_N(Box bxcc, Box tbxxy, Box tbxxz, Box tbxyz, Box domain, const Array4&lt; const Real &gt; &amp;u, const Array4&lt; const Real &gt; &amp;v, const Array4&lt; const Real &gt; &amp;w, Array4&lt; Real &gt; &amp;tau11, Array4&lt; Real &gt; &amp;tau22, Array4&lt; Real &gt; &amp;tau33, Array4&lt; Real &gt; &amp;tau12, Array4&lt; Real &gt; &amp;tau13, Array4&lt; Real &gt; &amp;tau23, const GpuArray&lt; Real, AMREX_SPACEDIM &gt; &amp;dxInv, const Array4&lt; const Real &gt; &amp;mf_mx, const Array4&lt; const Real &gt; &amp;mf_ux, const Array4&lt; const Real &gt; &amp;mf_vx, const Array4&lt; const Real &gt; &amp;mf_my, const Array4&lt; const Real &gt; &amp;mf_uy, const Array4&lt; const Real &gt; &amp;mf_vy, const BCRec *bc_ptr)</div><div class="ttdef"><b>Definition:</b> ERF_ComputeStrain_N.cpp:28</div></div>
<div class="ttc" id="aERF__ComputeStrain__S_8cpp_html_af92bd984eab8acd841b6f208f407b868"><div class="ttname"><a href="ERF__ComputeStrain__S_8cpp.html#af92bd984eab8acd841b6f208f407b868">ComputeStrain_S</a></div><div class="ttdeci">void ComputeStrain_S(Box bxcc, Box tbxxy, Box tbxxz, Box tbxyz, Box domain, const Array4&lt; const Real &gt; &amp;u, const Array4&lt; const Real &gt; &amp;v, const Array4&lt; const Real &gt; &amp;w, Array4&lt; Real &gt; &amp;tau11, Array4&lt; Real &gt; &amp;tau22, Array4&lt; Real &gt; &amp;tau33, Array4&lt; Real &gt; &amp;tau12, Array4&lt; Real &gt; &amp;tau21, Array4&lt; Real &gt; &amp;tau13, Array4&lt; Real &gt; &amp;tau31, Array4&lt; Real &gt; &amp;tau23, Array4&lt; Real &gt; &amp;tau32, const Gpu::DeviceVector&lt; Real &gt; &amp;stretched_dz_d, const GpuArray&lt; Real, AMREX_SPACEDIM &gt; &amp;dxInv, const Array4&lt; const Real &gt; &amp;mf_mx, const Array4&lt; const Real &gt; &amp;mf_ux, const Array4&lt; const Real &gt; &amp;mf_vx, const Array4&lt; const Real &gt; &amp;mf_my, const Array4&lt; const Real &gt; &amp;mf_uy, const Array4&lt; const Real &gt; &amp;mf_vy, const BCRec *bc_ptr)</div><div class="ttdef"><b>Definition:</b> ERF_ComputeStrain_S.cpp:36</div></div>
<div class="ttc" id="aERF__ComputeStrain__T_8cpp_html_aa22ef692a7c5635bd53fb91a3237a662"><div class="ttname"><a href="ERF__ComputeStrain__T_8cpp.html#aa22ef692a7c5635bd53fb91a3237a662">ComputeStrain_T</a></div><div class="ttdeci">void ComputeStrain_T(Box bxcc, Box tbxxy, Box tbxxz, Box tbxyz, Box domain, const Array4&lt; const Real &gt; &amp;u, const Array4&lt; const Real &gt; &amp;v, const Array4&lt; const Real &gt; &amp;w, Array4&lt; Real &gt; &amp;tau11, Array4&lt; Real &gt; &amp;tau22, Array4&lt; Real &gt; &amp;tau33, Array4&lt; Real &gt; &amp;tau12, Array4&lt; Real &gt; &amp;tau21, Array4&lt; Real &gt; &amp;tau13, Array4&lt; Real &gt; &amp;tau31, Array4&lt; Real &gt; &amp;tau23, Array4&lt; Real &gt; &amp;tau32, const Array4&lt; const Real &gt; &amp;z_nd, const Array4&lt; const Real &gt; &amp;detJ, const GpuArray&lt; Real, AMREX_SPACEDIM &gt; &amp;dxInv, const Array4&lt; const Real &gt; &amp;mf_mx, const Array4&lt; const Real &gt; &amp;mf_ux, const Array4&lt; const Real &gt; &amp;mf_vx, const Array4&lt; const Real &gt; &amp;mf_my, const Array4&lt; const Real &gt; &amp;mf_uy, const Array4&lt; const Real &gt; &amp;mf_vy, const BCRec *bc_ptr)</div><div class="ttdef"><b>Definition:</b> ERF_ComputeStrain_T.cpp:36</div></div>
<div class="ttc" id="aERF__ComputeTurbulentViscosity_8cpp_html_ae12ec663c91831742bfdc87d17498a5f"><div class="ttname"><a href="ERF__ComputeTurbulentViscosity_8cpp.html#ae12ec663c91831742bfdc87d17498a5f">ComputeTurbulentViscosity</a></div><div class="ttdeci">void ComputeTurbulentViscosity(const MultiFab &amp;xvel, const MultiFab &amp;yvel, Vector&lt; std::unique_ptr&lt; MultiFab &gt;&gt; &amp;Tau_lev, const MultiFab &amp;cons_in, const MultiFab &amp;wdist, MultiFab &amp;eddyViscosity, MultiFab &amp;Hfx1, MultiFab &amp;Hfx2, MultiFab &amp;Hfx3, MultiFab &amp;Diss, const Geometry &amp;geom, Vector&lt; std::unique_ptr&lt; MultiFab &gt;&gt; &amp;mapfac, const std::unique_ptr&lt; MultiFab &gt; &amp;z_phys_nd, const SolverChoice &amp;solverChoice, std::unique_ptr&lt; SurfaceLayer &gt; &amp;SurfLayer, const FArrayBox *z_0, const bool &amp;use_terrain_fitted_coords, const bool &amp;use_moisture, int level, const BCRec *bc_ptr, bool vert_only)</div><div class="ttdef"><b>Definition:</b> ERF_ComputeTurbulentViscosity.cpp:516</div></div>
<div class="ttc" id="aERF__DataStruct_8H_html_a09df0fe8e0778d7f1052a97aa214248ba0a0d169ca6b3a0da988c65f1c284ba99"><div class="ttname"><a href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248ba0a0d169ca6b3a0da988c65f1c284ba99">tau12</a></div><div class="ttdeci">@ tau12</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:30</div></div>
<div class="ttc" id="aERF__DataStruct_8H_html_a09df0fe8e0778d7f1052a97aa214248ba181b302bd0f99081c3c22fa38e1f8b73"><div class="ttname"><a href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248ba181b302bd0f99081c3c22fa38e1f8b73">tau23</a></div><div class="ttdeci">@ tau23</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:30</div></div>
<div class="ttc" id="aERF__DataStruct_8H_html_a09df0fe8e0778d7f1052a97aa214248ba1edaba247488baa9858b879f19ea09b7"><div class="ttname"><a href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248ba1edaba247488baa9858b879f19ea09b7">tau33</a></div><div class="ttdeci">@ tau33</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:30</div></div>
<div class="ttc" id="aERF__DataStruct_8H_html_a09df0fe8e0778d7f1052a97aa214248ba822e4f59780df9310afede8535eac286"><div class="ttname"><a href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248ba822e4f59780df9310afede8535eac286">tau22</a></div><div class="ttdeci">@ tau22</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:30</div></div>
<div class="ttc" id="aERF__DataStruct_8H_html_a09df0fe8e0778d7f1052a97aa214248baab4c45b861caaf89b0842306117db7bc"><div class="ttname"><a href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248baab4c45b861caaf89b0842306117db7bc">tau11</a></div><div class="ttdeci">@ tau11</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:30</div></div>
<div class="ttc" id="aERF__DataStruct_8H_html_a09df0fe8e0778d7f1052a97aa214248babcbe024a60f6921af0060fd096ac8307"><div class="ttname"><a href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248babcbe024a60f6921af0060fd096ac8307">tau32</a></div><div class="ttdeci">@ tau32</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:30</div></div>
<div class="ttc" id="aERF__DataStruct_8H_html_a09df0fe8e0778d7f1052a97aa214248bacec8728fd270452c9985e46f971d6935"><div class="ttname"><a href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248bacec8728fd270452c9985e46f971d6935">tau31</a></div><div class="ttdeci">@ tau31</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:30</div></div>
<div class="ttc" id="aERF__DataStruct_8H_html_a09df0fe8e0778d7f1052a97aa214248bad6968d5de54faf0f6a42e5629f76f391"><div class="ttname"><a href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248bad6968d5de54faf0f6a42e5629f76f391">tau21</a></div><div class="ttdeci">@ tau21</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:30</div></div>
<div class="ttc" id="aERF__DataStruct_8H_html_a09df0fe8e0778d7f1052a97aa214248baf5fa13cfd781cde0d363f337d7e76d7e"><div class="ttname"><a href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248baf5fa13cfd781cde0d363f337d7e76d7e">tau13</a></div><div class="ttdeci">@ tau13</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:30</div></div>
<div class="ttc" id="aERF__DataStruct_8H_html_a3856c8a2f055327ada182186bfd70239a3d2cdf8cea6cb933d4ce759c1ff1b948"><div class="ttname"><a href="ERF__DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a3d2cdf8cea6cb933d4ce759c1ff1b948">ubar</a></div><div class="ttdeci">@ ubar</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:87</div></div>
<div class="ttc" id="aERF__DataStruct_8H_html_a3856c8a2f055327ada182186bfd70239a3d8bd6001a2421b06c3ec4e9f2dcdffd"><div class="ttname"><a href="ERF__DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a3d8bd6001a2421b06c3ec4e9f2dcdffd">wbar</a></div><div class="ttdeci">@ wbar</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:87</div></div>
<div class="ttc" id="aERF__DataStruct_8H_html_a3856c8a2f055327ada182186bfd70239acb08c6a1b8bca5e9e4ef6162aef2cfa4"><div class="ttname"><a href="ERF__DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239acb08c6a1b8bca5e9e4ef6162aef2cfa4">vbar</a></div><div class="ttdeci">@ vbar</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:87</div></div>
<div class="ttc" id="aERF__DataStruct_8H_html_a3856c8a2f055327ada182186bfd70239ae41e9f65f26ee3b04db07f2db7f28bdb"><div class="ttname"><a href="ERF__DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239ae41e9f65f26ee3b04db07f2db7f28bdb">thetabar</a></div><div class="ttdeci">@ thetabar</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:87</div></div>
<div class="ttc" id="aERF__DataStruct_8H_html_a5bebd9ff4e2455172deca3b399214fcba7f0566bdfe36c67d532a7e2aca33d9a4"><div class="ttname"><a href="ERF__DataStruct_8H.html#a5bebd9ff4e2455172deca3b399214fcba7f0566bdfe36c67d532a7e2aca33d9a4">nvars_sponge</a></div><div class="ttdeci">@ nvars_sponge</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:92</div></div>
<div class="ttc" id="aERF__DataStruct_8H_html_a5bebd9ff4e2455172deca3b399214fcbaad1bdec1c0213a18483e81bcb4926964"><div class="ttname"><a href="ERF__DataStruct_8H.html#a5bebd9ff4e2455172deca3b399214fcbaad1bdec1c0213a18483e81bcb4926964">vbar_sponge</a></div><div class="ttdeci">@ vbar_sponge</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:92</div></div>
<div class="ttc" id="aERF__DataStruct_8H_html_a5bebd9ff4e2455172deca3b399214fcbac159d9fae0d25be7ce907e1feb87cdaa"><div class="ttname"><a href="ERF__DataStruct_8H.html#a5bebd9ff4e2455172deca3b399214fcbac159d9fae0d25be7ce907e1feb87cdaa">ubar_sponge</a></div><div class="ttdeci">@ ubar_sponge</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:92</div></div>
<div class="ttc" id="aERF__DataStruct_8H_html_a61bff79effb7ee8f045654684246b85ba21e22c79b875be81696b36a623690388"><div class="ttname"><a href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85ba21e22c79b875be81696b36a623690388">v_x</a></div><div class="ttdeci">@ v_x</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:22</div></div>
<div class="ttc" id="aERF__DataStruct_8H_html_a61bff79effb7ee8f045654684246b85ba784971ba75d56c0d71c4bc08c5ddc1f3"><div class="ttname"><a href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85ba784971ba75d56c0d71c4bc08c5ddc1f3">u_y</a></div><div class="ttdeci">@ u_y</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:23</div></div>
<div class="ttc" id="aERF__DataStruct_8H_html_a61bff79effb7ee8f045654684246b85ba90990e92021688dbfd1cec52b03fd182"><div class="ttname"><a href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85ba90990e92021688dbfd1cec52b03fd182">v_y</a></div><div class="ttdeci">@ v_y</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:23</div></div>
<div class="ttc" id="aERF__DataStruct_8H_html_a61bff79effb7ee8f045654684246b85ba9612b6816e2fb7dc3ad56d6bc1fb7df8"><div class="ttname"><a href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85ba9612b6816e2fb7dc3ad56d6bc1fb7df8">m_y</a></div><div class="ttdeci">@ m_y</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:23</div></div>
<div class="ttc" id="aERF__DataStruct_8H_html_a61bff79effb7ee8f045654684246b85baa4b935f173fee2d487101e302a5cfe18"><div class="ttname"><a href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85baa4b935f173fee2d487101e302a5cfe18">u_x</a></div><div class="ttdeci">@ u_x</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:22</div></div>
<div class="ttc" id="aERF__DataStruct_8H_html_a61bff79effb7ee8f045654684246b85bac2a428daaf1a1b398630fa8cec7f115b"><div class="ttname"><a href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85bac2a428daaf1a1b398630fa8cec7f115b">m_x</a></div><div class="ttdeci">@ m_x</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:22</div></div>
<div class="ttc" id="aERF__DiffStruct_8H_html_a84e6bfbbb8e490790c506939b364f735a6adf97f83acf6453d4a6a4b1070f3754"><div class="ttname"><a href="ERF__DiffStruct_8H.html#a84e6bfbbb8e490790c506939b364f735a6adf97f83acf6453d4a6a4b1070f3754">MolecDiffType::None</a></div><div class="ttdeci">@ None</div></div>
<div class="ttc" id="aERF__TI__no__substep__fun_8H_html"><div class="ttname"><a href="ERF__TI__no__substep__fun_8H.html">ERF_TI_no_substep_fun.H</a></div></div>
<div class="ttc" id="aERF__TI__no__substep__fun_8H_html_a4cad8180e91d2eabd5638651fc24bcc7"><div class="ttname"><a href="ERF__TI__no__substep__fun_8H.html#a4cad8180e91d2eabd5638651fc24bcc7">no_substep_fun</a></div><div class="ttdeci">auto no_substep_fun</div><div class="ttdef"><b>Definition:</b> ERF_TI_no_substep_fun.H:4</div></div>
<div class="ttc" id="aERF__TI__slow__rhs__post_8H_html"><div class="ttname"><a href="ERF__TI__slow__rhs__post_8H.html">ERF_TI_slow_rhs_post.H</a></div></div>
<div class="ttc" id="aERF__TI__slow__rhs__post_8H_html_af460c930508105e92f60fd868d23ebcf"><div class="ttname"><a href="ERF__TI__slow__rhs__post_8H.html#af460c930508105e92f60fd868d23ebcf">slow_rhs_fun_post</a></div><div class="ttdeci">auto slow_rhs_fun_post</div><div class="ttdef"><b>Definition:</b> ERF_TI_slow_rhs_post.H:3</div></div>
<div class="ttc" id="aERF__TI__slow__rhs__pre_8H_html"><div class="ttname"><a href="ERF__TI__slow__rhs__pre_8H.html">ERF_TI_slow_rhs_pre.H</a></div></div>
<div class="ttc" id="aERF__TI__slow__rhs__pre_8H_html_a963142d364408ee1775dbef20383b244"><div class="ttname"><a href="ERF__TI__slow__rhs__pre_8H.html#a963142d364408ee1775dbef20383b244">slow_rhs_fun_pre</a></div><div class="ttdeci">auto slow_rhs_fun_pre</div><div class="ttdef"><b>Definition:</b> ERF_TI_slow_rhs_pre.H:6</div></div>
<div class="ttc" id="aERF__TI__substep__fun_8H_html"><div class="ttname"><a href="ERF__TI__substep__fun_8H.html">ERF_TI_substep_fun.H</a></div></div>
<div class="ttc" id="aERF__TI__substep__fun_8H_html_ac6afbd55bf5b7264098d44d9b8928f57"><div class="ttname"><a href="ERF__TI__substep__fun_8H.html#ac6afbd55bf5b7264098d44d9b8928f57">fast_rhs_fun</a></div><div class="ttdeci">auto fast_rhs_fun</div><div class="ttdef"><b>Definition:</b> ERF_TI_substep_fun.H:6</div></div>
<div class="ttc" id="aERF__TI__utils_8H_html"><div class="ttname"><a href="ERF__TI__utils_8H.html">ERF_TI_utils.H</a></div></div>
<div class="ttc" id="aERF__TI__utils_8H_html_a5e7934b18ef63bc8c4c16db42277c52f"><div class="ttname"><a href="ERF__TI__utils_8H.html#a5e7934b18ef63bc8c4c16db42277c52f">apply_bcs</a></div><div class="ttdeci">auto apply_bcs</div><div class="ttdef"><b>Definition:</b> ERF_TI_utils.H:71</div></div>
<div class="ttc" id="aERF__TI__utils_8H_html_a76b27b6105fe279f9a43296072c843b3"><div class="ttname"><a href="ERF__TI__utils_8H.html#a76b27b6105fe279f9a43296072c843b3">cons_to_prim</a></div><div class="ttdeci">auto cons_to_prim</div><div class="ttdef"><b>Definition:</b> ERF_TI_utils.H:4</div></div>
<div class="ttc" id="aclassERF_html_a0276b556fdefec8b99be95846a3a35fe"><div class="ttname"><a href="classERF.html#a0276b556fdefec8b99be95846a3a35fe">ERF::walldist</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; walldist</div><div class="ttdef"><b>Definition:</b> ERF.H:827</div></div>
<div class="ttc" id="aclassERF_html_a07e1772db360d39195824a6237bca9aa"><div class="ttname"><a href="classERF.html#a07e1772db360d39195824a6237bca9aa">ERF::mapfac</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; &gt; mapfac</div><div class="ttdef"><b>Definition:</b> ERF.H:830</div></div>
<div class="ttc" id="aclassERF_html_a09d0fb2bd609c898a665d9530a744585"><div class="ttname"><a href="classERF.html#a09d0fb2bd609c898a665d9530a744585">ERF::mri_integrator_mem</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; MRISplitIntegrator&lt; amrex::Vector&lt; amrex::MultiFab &gt; &gt; &gt; &gt; mri_integrator_mem</div><div class="ttdef"><b>Definition:</b> ERF.H:717</div></div>
<div class="ttc" id="aclassERF_html_a0c1fdcfbc9cbd6cb13e41d1170b161f8"><div class="ttname"><a href="classERF.html#a0c1fdcfbc9cbd6cb13e41d1170b161f8">ERF::d_rhotheta_src</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Gpu::DeviceVector&lt; amrex::Real &gt; &gt; d_rhotheta_src</div><div class="ttdef"><b>Definition:</b> ERF.H:1103</div></div>
<div class="ttc" id="aclassERF_html_a101ceb89b1a249efeea3f4e8052bc8c0"><div class="ttname"><a href="classERF.html#a101ceb89b1a249efeea3f4e8052bc8c0">ERF::SFS_q1fx3_lev</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; SFS_q1fx3_lev</div><div class="ttdef"><b>Definition:</b> ERF.H:796</div></div>
<div class="ttc" id="aclassERF_html_a1a2e3faf5dd90ad2f9ded28b486f3b46"><div class="ttname"><a href="classERF.html#a1a2e3faf5dd90ad2f9ded28b486f3b46">ERF::SFS_hfx3_lev</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; SFS_hfx3_lev</div><div class="ttdef"><b>Definition:</b> ERF.H:794</div></div>
<div class="ttc" id="aclassERF_html_a1a5d0d0b4e8c196f56dfab98f245aff5"><div class="ttname"><a href="classERF.html#a1a5d0d0b4e8c196f56dfab98f245aff5">ERF::h_w_subsid</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; amrex::Real &gt; &gt; h_w_subsid</div><div class="ttdef"><b>Definition:</b> ERF.H:1108</div></div>
<div class="ttc" id="aclassERF_html_a25174b4ae6cfcac8f7d183ce5c9fe67b"><div class="ttname"><a href="classERF.html#a25174b4ae6cfcac8f7d183ce5c9fe67b">ERF::SFS_hfx1_lev</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; SFS_hfx1_lev</div><div class="ttdef"><b>Definition:</b> ERF.H:794</div></div>
<div class="ttc" id="aclassERF_html_a30f8b851ed29d38695d44cff257f14e6"><div class="ttname"><a href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">ERF::detJ_cc</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; detJ_cc</div><div class="ttdef"><b>Definition:</b> ERF.H:806</div></div>
<div class="ttc" id="aclassERF_html_a327d704704abd516be19339cb2d226f9"><div class="ttname"><a href="classERF.html#a327d704704abd516be19339cb2d226f9">ERF::eddyDiffs_lev</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; eddyDiffs_lev</div><div class="ttdef"><b>Definition:</b> ERF.H:785</div></div>
<div class="ttc" id="aclassERF_html_a3b9bcb54c278dfec6027e9727cc01bc5"><div class="ttname"><a href="classERF.html#a3b9bcb54c278dfec6027e9727cc01bc5">ERF::d_sponge_ptrs</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; amrex::Gpu::DeviceVector&lt; amrex::Real &gt; &gt; &gt; d_sponge_ptrs</div><div class="ttdef"><b>Definition:</b> ERF.H:1136</div></div>
<div class="ttc" id="aclassERF_html_a3c5eca26a28dda3a981b3581abadfca0"><div class="ttname"><a href="classERF.html#a3c5eca26a28dda3a981b3581abadfca0">ERF::h_rhoqt_src</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; amrex::Real &gt; &gt; h_rhoqt_src</div><div class="ttdef"><b>Definition:</b> ERF.H:1105</div></div>
<div class="ttc" id="aclassERF_html_a3cf7cb2e51eb7b69cb4079ffc6722459"><div class="ttname"><a href="classERF.html#a3cf7cb2e51eb7b69cb4079ffc6722459">ERF::dt_mri_ratio</a></div><div class="ttdeci">amrex::Vector&lt; long &gt; dt_mri_ratio</div><div class="ttdef"><b>Definition:</b> ERF.H:702</div></div>
<div class="ttc" id="aclassERF_html_a3d4a3ed54fb357c02e6494461f182aa1"><div class="ttname"><a href="classERF.html#a3d4a3ed54fb357c02e6494461f182aa1">ERF::Tau</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; &gt; Tau</div><div class="ttdef"><b>Definition:</b> ERF.H:784</div></div>
<div class="ttc" id="aclassERF_html_a3ea10ef7383e594b6ee5e7a9ad67607b"><div class="ttname"><a href="classERF.html#a3ea10ef7383e594b6ee5e7a9ad67607b">ERF::SFS_q2fx3_lev</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; SFS_q2fx3_lev</div><div class="ttdef"><b>Definition:</b> ERF.H:797</div></div>
<div class="ttc" id="aclassERF_html_a43d0b17f6e155691a1e9474526df3af5"><div class="ttname"><a href="classERF.html#a43d0b17f6e155691a1e9474526df3af5">ERF::verbose</a></div><div class="ttdeci">static int verbose</div><div class="ttdef"><b>Definition:</b> ERF.H:1027</div></div>
<div class="ttc" id="aclassERF_html_a53fab1172ec3f01356355f8cda0919fe"><div class="ttname"><a href="classERF.html#a53fab1172ec3f01356355f8cda0919fe">ERF::SFS_q1fx2_lev</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; SFS_q1fx2_lev</div><div class="ttdef"><b>Definition:</b> ERF.H:796</div></div>
<div class="ttc" id="aclassERF_html_a60e8cb933f237903e3fbcd6376c26db0"><div class="ttname"><a href="classERF.html#a60e8cb933f237903e3fbcd6376c26db0">ERF::prob</a></div><div class="ttdeci">std::unique_ptr&lt; ProblemBase &gt; prob</div><div class="ttdef"><b>Definition:</b> ERF.H:689</div></div>
<div class="ttc" id="aclassERF_html_a6600f30f1043a4c5e62b5cdd05f0a99f"><div class="ttname"><a href="classERF.html#a6600f30f1043a4c5e62b5cdd05f0a99f">ERF::stretched_dz_d</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Gpu::DeviceVector&lt; amrex::Real &gt; &gt; stretched_dz_d</div><div class="ttdef"><b>Definition:</b> ERF.H:833</div></div>
<div class="ttc" id="aclassERF_html_a6e1ad417e3bd062468d74830b65911fb"><div class="ttname"><a href="classERF.html#a6e1ad417e3bd062468d74830b65911fb">ERF::SFS_diss_lev</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; SFS_diss_lev</div><div class="ttdef"><b>Definition:</b> ERF.H:795</div></div>
<div class="ttc" id="aclassERF_html_a7d245afb7b3236b5967902f50bf9000b"><div class="ttname"><a href="classERF.html#a7d245afb7b3236b5967902f50bf9000b">ERF::d_v_geos</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Gpu::DeviceVector&lt; amrex::Real &gt; &gt; d_v_geos</div><div class="ttdef"><b>Definition:</b> ERF.H:1115</div></div>
<div class="ttc" id="aclassERF_html_a825daede57fae86805edffd85d5d9dab"><div class="ttname"><a href="classERF.html#a825daede57fae86805edffd85d5d9dab">ERF::h_v_geos</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; amrex::Real &gt; &gt; h_v_geos</div><div class="ttdef"><b>Definition:</b> ERF.H:1114</div></div>
<div class="ttc" id="aclassERF_html_a838687881ef3626f932d0e95ceff0e53"><div class="ttname"><a href="classERF.html#a838687881ef3626f932d0e95ceff0e53">ERF::d_rhoqt_src</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Gpu::DeviceVector&lt; amrex::Real &gt; &gt; d_rhoqt_src</div><div class="ttdef"><b>Definition:</b> ERF.H:1106</div></div>
<div class="ttc" id="aclassERF_html_a87aad7caaf3b575734994b47628a2faf"><div class="ttname"><a href="classERF.html#a87aad7caaf3b575734994b47628a2faf">ERF::h_rhotheta_src</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; amrex::Real &gt; &gt; h_rhotheta_src</div><div class="ttdef"><b>Definition:</b> ERF.H:1102</div></div>
<div class="ttc" id="aclassERF_html_a911c70f76cf62f205a1ce152ec4cdb54"><div class="ttname"><a href="classERF.html#a911c70f76cf62f205a1ce152ec4cdb54">ERF::h_u_geos</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; amrex::Real &gt; &gt; h_u_geos</div><div class="ttdef"><b>Definition:</b> ERF.H:1111</div></div>
<div class="ttc" id="aclassERF_html_a9faaa96a7c270d2b2b062d9f30f19711"><div class="ttname"><a href="classERF.html#a9faaa96a7c270d2b2b062d9f30f19711">ERF::SmnSmn_lev</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; SmnSmn_lev</div><div class="ttdef"><b>Definition:</b> ERF.H:786</div></div>
<div class="ttc" id="aclassERF_html_ac020980af9dbf46be43dd9f7127c06da"><div class="ttname"><a href="classERF.html#ac020980af9dbf46be43dd9f7127c06da">ERF::d_u_geos</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Gpu::DeviceVector&lt; amrex::Real &gt; &gt; d_u_geos</div><div class="ttdef"><b>Definition:</b> ERF.H:1112</div></div>
<div class="ttc" id="aclassERF_html_ac94ddee2f501dbcea2a516284b7119b5"><div class="ttname"><a href="classERF.html#ac94ddee2f501dbcea2a516284b7119b5">ERF::d_w_subsid</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Gpu::DeviceVector&lt; amrex::Real &gt; &gt; d_w_subsid</div><div class="ttdef"><b>Definition:</b> ERF.H:1109</div></div>
<div class="ttc" id="aclassERF_html_acb607b2e675b45fdcabc09b640ce5ae2"><div class="ttname"><a href="classERF.html#acb607b2e675b45fdcabc09b640ce5ae2">ERF::SFS_hfx2_lev</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; SFS_hfx2_lev</div><div class="ttdef"><b>Definition:</b> ERF.H:794</div></div>
<div class="ttc" id="aclassERF_html_ad2e1a979c0ad68e87eaee349beb7e9fd"><div class="ttname"><a href="classERF.html#ad2e1a979c0ad68e87eaee349beb7e9fd">ERF::fixed_mri_dt_ratio</a></div><div class="ttdeci">static int fixed_mri_dt_ratio</div><div class="ttdef"><b>Definition:</b> ERF.H:915</div></div>
<div class="ttc" id="aclassERF_html_ad598bde8e728479faaa7c2820096b47a"><div class="ttname"><a href="classERF.html#ad598bde8e728479faaa7c2820096b47a">ERF::d_rayleigh_ptrs</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; amrex::Gpu::DeviceVector&lt; amrex::Real &gt; &gt; &gt; d_rayleigh_ptrs</div><div class="ttdef"><b>Definition:</b> ERF.H:1133</div></div>
<div class="ttc" id="aclassERF_html_ae0316d5ae567a2da8439d204bace12ce"><div class="ttname"><a href="classERF.html#ae0316d5ae567a2da8439d204bace12ce">ERF::SFS_q1fx1_lev</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; SFS_q1fx1_lev</div><div class="ttdef"><b>Definition:</b> ERF.H:796</div></div>
<div class="ttc" id="aclassMRISplitIntegrator_html"><div class="ttname"><a href="classMRISplitIntegrator.html">MRISplitIntegrator</a></div><div class="ttdef"><b>Definition:</b> ERF_MRI.H:16</div></div>
<div class="ttc" id="aclassMRISplitIntegrator_html_a137a1ceb1e8051b5a97aaab40492c0e1"><div class="ttname"><a href="classMRISplitIntegrator.html#a137a1ceb1e8051b5a97aaab40492c0e1">MRISplitIntegrator::set_slow_rhs_pre</a></div><div class="ttdeci">void set_slow_rhs_pre(std::function&lt; void(T &amp;, T &amp;, T &amp;, T &amp;, const amrex::Real, const amrex::Real, const amrex::Real, const int)&gt; F)</div><div class="ttdef"><b>Definition:</b> ERF_MRI.H:133</div></div>
<div class="ttc" id="aclassMRISplitIntegrator_html_a216903aa134536df210f489acdfd2b8b"><div class="ttname"><a href="classMRISplitIntegrator.html#a216903aa134536df210f489acdfd2b8b">MRISplitIntegrator::set_no_substep</a></div><div class="ttdeci">void set_no_substep(std::function&lt; void(T &amp;, T &amp;, T &amp;, amrex::Real, amrex::Real, int)&gt; F)</div><div class="ttdef"><b>Definition:</b> ERF_MRI.H:159</div></div>
<div class="ttc" id="aclassMRISplitIntegrator_html_aafed3f1d61d477bd1f01bdeb71a9ab11"><div class="ttname"><a href="classMRISplitIntegrator.html#aafed3f1d61d477bd1f01bdeb71a9ab11">MRISplitIntegrator::set_fast_rhs</a></div><div class="ttdeci">void set_fast_rhs(std::function&lt; void(int, int, int, T &amp;, const T &amp;, T &amp;, T &amp;, T &amp;, const amrex::Real, const amrex::Real, const amrex::Real, const amrex::Real)&gt; F)</div><div class="ttdef"><b>Definition:</b> ERF_MRI.H:142</div></div>
<div class="ttc" id="aclassMRISplitIntegrator_html_ad31fb2cda1fc2dce80820ed7c4a3c052"><div class="ttname"><a href="classMRISplitIntegrator.html#ad31fb2cda1fc2dce80820ed7c4a3c052">MRISplitIntegrator::set_slow_fast_timestep_ratio</a></div><div class="ttdeci">void set_slow_fast_timestep_ratio(const int timestep_ratio=1)</div><div class="ttdef"><b>Definition:</b> ERF_MRI.H:149</div></div>
<div class="ttc" id="aclassMRISplitIntegrator_html_ad78b5d1908a131c3597232a041ca267b"><div class="ttname"><a href="classMRISplitIntegrator.html#ad78b5d1908a131c3597232a041ca267b">MRISplitIntegrator::advance</a></div><div class="ttdeci">amrex::Real advance(T &amp;S_old, T &amp;S_new, amrex::Real time, const amrex::Real time_step)</div><div class="ttdef"><b>Definition:</b> ERF_MRI.H:169</div></div>
<div class="ttc" id="aclassMRISplitIntegrator_html_af086d3c68787442d07f0a9d530618cc1"><div class="ttname"><a href="classMRISplitIntegrator.html#af086d3c68787442d07f0a9d530618cc1">MRISplitIntegrator::set_slow_rhs_post</a></div><div class="ttdeci">void set_slow_rhs_post(std::function&lt; void(T &amp;, T &amp;, T &amp;, T &amp;, T &amp;, const amrex::Real, const amrex::Real, const amrex::Real, const int)&gt; F)</div><div class="ttdef"><b>Definition:</b> ERF_MRI.H:137</div></div>
<div class="ttc" id="anamespaceBaseState_html_a6f8dc3597225ea7941dad615e7f22e91a3d99e10d828f251e465bc2c66062badf"><div class="ttname"><a href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91a3d99e10d828f251e465bc2c66062badf">BaseState::pi0_comp</a></div><div class="ttdeci">@ pi0_comp</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:65</div></div>
<div class="ttc" id="anamespaceBaseState_html_a6f8dc3597225ea7941dad615e7f22e91aa8253dc5484f2621e0bf8d51d98d635e"><div class="ttname"><a href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91aa8253dc5484f2621e0bf8d51d98d635e">BaseState::p0_comp</a></div><div class="ttdeci">@ p0_comp</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:64</div></div>
<div class="ttc" id="anamespaceBaseState_html_a6f8dc3597225ea7941dad615e7f22e91abc888a343d4fcc4fc4ffb79c6ac7cb93"><div class="ttname"><a href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91abc888a343d4fcc4fc4ffb79c6ac7cb93">BaseState::r0_comp</a></div><div class="ttdeci">@ r0_comp</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:63</div></div>
<div class="ttc" id="anamespaceMicVar__Kess_html_ad5e2303f8f4cbf19829306f4a72d61a7a9f81c8a38dd25b5ae5821d48e8878b03"><div class="ttname"><a href="namespaceMicVar__Kess.html#ad5e2303f8f4cbf19829306f4a72d61a7a9f81c8a38dd25b5ae5821d48e8878b03">MicVar_Kess::qt</a></div><div class="ttdeci">@ qt</div><div class="ttdef"><b>Definition:</b> ERF_Kessler.H:27</div></div>
<div class="ttc" id="anamespacemodule__model__constants_html_a2dcccd992b668c86eecdd9a825970d4a"><div class="ttname"><a href="namespacemodule__model__constants.html#a2dcccd992b668c86eecdd9a825970d4a">module_model_constants::p0</a></div><div class="ttdeci">real(c_double), parameter p0</div><div class="ttdef"><b>Definition:</b> ERF_module_model_constants.F90:40</div></div>
<div class="ttc" id="astructDiffChoice_html"><div class="ttname"><a href="structDiffChoice.html">DiffChoice</a></div><div class="ttdef"><b>Definition:</b> ERF_DiffStruct.H:19</div></div>
<div class="ttc" id="astructDiffChoice_html_aed5c75ec58e358a735d97869147b2baf"><div class="ttname"><a href="structDiffChoice.html#aed5c75ec58e358a735d97869147b2baf">DiffChoice::molec_diff_type</a></div><div class="ttdeci">MolecDiffType molec_diff_type</div><div class="ttdef"><b>Definition:</b> ERF_DiffStruct.H:81</div></div>
<div class="ttc" id="astructSolverChoice_html_a06a0dd1c8f7c1ed73a4f8d24b6b31cdf"><div class="ttname"><a href="structSolverChoice.html#a06a0dd1c8f7c1ed73a4f8d24b6b31cdf">SolverChoice::rayleigh_damp_T</a></div><div class="ttdeci">bool rayleigh_damp_T</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:743</div></div>
<div class="ttc" id="astructSolverChoice_html_a1952672901901b0b3a628f2298dc72c2"><div class="ttname"><a href="structSolverChoice.html#a1952672901901b0b3a628f2298dc72c2">SolverChoice::mesh_type</a></div><div class="ttdeci">static MeshType mesh_type</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:708</div></div>
<div class="ttc" id="astructSolverChoice_html_a1bae456f7b26e8ed50d78ce1af1b5ef0"><div class="ttname"><a href="structSolverChoice.html#a1bae456f7b26e8ed50d78ce1af1b5ef0">SolverChoice::rayleigh_damp_V</a></div><div class="ttdeci">bool rayleigh_damp_V</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:741</div></div>
<div class="ttc" id="astructSolverChoice_html_a396122e87a3d15c4ec8666d7dd18c095"><div class="ttname"><a href="structSolverChoice.html#a396122e87a3d15c4ec8666d7dd18c095">SolverChoice::diffChoice</a></div><div class="ttdeci">DiffChoice diffChoice</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:717</div></div>
<div class="ttc" id="astructSolverChoice_html_a4e81a09c9f454c680568b7776a3ed90e"><div class="ttname"><a href="structSolverChoice.html#a4e81a09c9f454c680568b7776a3ed90e">SolverChoice::custom_rhotheta_forcing</a></div><div class="ttdeci">bool custom_rhotheta_forcing</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:774</div></div>
<div class="ttc" id="astructSolverChoice_html_a596f061b796ada0389c81a6125150b6e"><div class="ttname"><a href="structSolverChoice.html#a596f061b796ada0389c81a6125150b6e">SolverChoice::custom_w_subsidence</a></div><div class="ttdeci">bool custom_w_subsidence</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:776</div></div>
<div class="ttc" id="astructSolverChoice_html_a5aed4016dd7d17a2d2904c60af59ae9d"><div class="ttname"><a href="structSolverChoice.html#a5aed4016dd7d17a2d2904c60af59ae9d">SolverChoice::rayleigh_damp_U</a></div><div class="ttdeci">bool rayleigh_damp_U</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:740</div></div>
<div class="ttc" id="astructSolverChoice_html_a5e8754b29072596a584633734a9f64ef"><div class="ttname"><a href="structSolverChoice.html#a5e8754b29072596a584633734a9f64ef">SolverChoice::custom_geostrophic_profile</a></div><div class="ttdeci">bool custom_geostrophic_profile</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:777</div></div>
<div class="ttc" id="astructSolverChoice_html_a7c414e2fb7c53479a2d21bb3a2d4099e"><div class="ttname"><a href="structSolverChoice.html#a7c414e2fb7c53479a2d21bb3a2d4099e">SolverChoice::substepping_type</a></div><div class="ttdeci">amrex::Vector&lt; SubsteppingType &gt; substepping_type</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:723</div></div>
<div class="ttc" id="astructSolverChoice_html_a8d039800497a1e5084afeef94d367932"><div class="ttname"><a href="structSolverChoice.html#a8d039800497a1e5084afeef94d367932">SolverChoice::use_num_diff</a></div><div class="ttdeci">bool use_num_diff</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:794</div></div>
<div class="ttc" id="astructSolverChoice_html_aa2e312b4e6d08797fc3c1b6d67313d48"><div class="ttname"><a href="structSolverChoice.html#aa2e312b4e6d08797fc3c1b6d67313d48">SolverChoice::custom_moisture_forcing</a></div><div class="ttdeci">bool custom_moisture_forcing</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:775</div></div>
<div class="ttc" id="astructSolverChoice_html_aa53b017d79e0067923180a0aa59367b4"><div class="ttname"><a href="structSolverChoice.html#aa53b017d79e0067923180a0aa59367b4">SolverChoice::turbChoice</a></div><div class="ttdeci">amrex::Vector&lt; TurbChoice &gt; turbChoice</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:719</div></div>
<div class="ttc" id="astructSolverChoice_html_abf35af2e52f5c1197264d895396ca59c"><div class="ttname"><a href="structSolverChoice.html#abf35af2e52f5c1197264d895396ca59c">SolverChoice::rayleigh_damp_W</a></div><div class="ttdeci">bool rayleigh_damp_W</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:742</div></div>
<div class="ttc" id="astructSolverChoice_html_ac066852f06a6409e1638f59868b7c57d"><div class="ttname"><a href="structSolverChoice.html#ac066852f06a6409e1638f59868b7c57d">SolverChoice::spongeChoice</a></div><div class="ttdeci">SpongeChoice spongeChoice</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:718</div></div>
<div class="ttc" id="astructSpongeChoice_html"><div class="ttname"><a href="structSpongeChoice.html">SpongeChoice</a></div><div class="ttdef"><b>Definition:</b> ERF_SpongeStruct.H:15</div></div>
<div class="ttc" id="astructSpongeChoice_html_a1a41f754595d713df32583f0b0fa606e"><div class="ttname"><a href="structSpongeChoice.html#a1a41f754595d713df32583f0b0fa606e">SpongeChoice::sponge_type</a></div><div class="ttdeci">std::string sponge_type</div><div class="ttdef"><b>Definition:</b> ERF_SpongeStruct.H:58</div></div>
<div class="ttc" id="astructTurbChoice_html"><div class="ttname"><a href="structTurbChoice.html">TurbChoice</a></div><div class="ttdef"><b>Definition:</b> ERF_TurbStruct.H:39</div></div>
<div class="ttc" id="astructTurbChoice_html_ae413138f8a3097389177d3fd96ec43fe"><div class="ttname"><a href="structTurbChoice.html#ae413138f8a3097389177d3fd96ec43fe">TurbChoice::use_kturb</a></div><div class="ttdeci">bool use_kturb</div><div class="ttdef"><b>Definition:</b> ERF_TurbStruct.H:360</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a96a272defae485c5b83fbc123a631f9f_cgraph.png" border="0" usemap="#aclassERF_a96a272defae485c5b83fbc123a631f9f_cgraph" alt=""/></div>
<map name="aclassERF_a96a272defae485c5b83fbc123a631f9f_cgraph" id="aclassERF_a96a272defae485c5b83fbc123a631f9f_cgraph">
<area shape="rect" title=" " alt="" coords="5,683,165,710"/>
<area shape="rect" href="classMRISplitIntegrator.html#ad78b5d1908a131c3597232a041ca267b" title=" " alt="" coords="254,81,394,123"/>
<area shape="rect" href="ERF__ComputeStrain__N_8cpp.html#a24dce7d35c8c38140861b8bd691e5407" title=" " alt="" coords="256,223,392,250"/>
<area shape="rect" href="ERF__ComputeStrain__S_8cpp.html#af92bd984eab8acd841b6f208f407b868" title=" " alt="" coords="257,274,391,301"/>
<area shape="rect" href="ERF__ComputeStrain__T_8cpp.html#aa22ef692a7c5635bd53fb91a3237a662" title=" " alt="" coords="257,325,391,351"/>
<area shape="rect" href="ERF__ComputeTurbulentViscosity_8cpp.html#ae12ec663c91831742bfdc87d17498a5f" title=" " alt="" coords="224,603,424,630"/>
<area shape="rect" href="ERF__TileNoZ_8H.html#a8da113f1d5603f7297fe1d03e5013f00" title=" " alt="" coords="845,755,918,782"/>
<area shape="rect" href="classMRISplitIntegrator.html#aafed3f1d61d477bd1f01bdeb71a9ab11" title=" " alt="" coords="254,705,394,747"/>
<area shape="rect" href="classMRISplitIntegrator.html#a216903aa134536df210f489acdfd2b8b" title=" " alt="" coords="254,771,394,812"/>
<area shape="rect" href="classMRISplitIntegrator.html#ad31fb2cda1fc2dce80820ed7c4a3c052" title=" " alt="" coords="213,836,435,877"/>
<area shape="rect" href="classMRISplitIntegrator.html#af086d3c68787442d07f0a9d530618cc1" title=" " alt="" coords="249,901,399,943"/>
<area shape="rect" href="classMRISplitIntegrator.html#a137a1ceb1e8051b5a97aaab40492c0e1" title=" " alt="" coords="253,967,395,1008"/>
<area shape="rect" href="ERF__Utils_8H.html#a5e2e36af19c0192915a2ca721c0cded4" title=" " alt="" coords="243,1033,405,1059"/>
<area shape="rect" href="classMRISplitIntegrator.html#aba63019a6ac3ea9135772dcd91f49c86" title=" " alt="" coords="489,5,712,47"/>
<area shape="rect" href="ERF__TerrainMetrics_8H.html#a43b431cbd97421014ff80245883e06d2" title=" " alt="" coords="494,71,707,98"/>
<area shape="rect" href="ERF__TerrainMetrics_8H.html#aed973861215c4eb0697f7a83b37016a9" title=" " alt="" coords="489,122,713,149"/>
<area shape="rect" href="ERF__TerrainMetrics_8H.html#ac1434a53d9966d992133433473bc629a" title=" " alt="" coords="486,173,715,199"/>
<area shape="rect" href="ERF__TerrainMetrics_8H.html#ada44020dc4ec27c5bebf8fd82d336cee" title=" " alt="" coords="499,223,703,250"/>
<area shape="rect" href="ERF__TerrainMetrics_8H.html#a1582797e6ac6cf0c1e0b94a619bc13b8" title=" " alt="" coords="493,274,708,301"/>
<area shape="rect" href="ERF__TerrainMetrics_8H.html#a07e83bf0f142a953679c9edfa42b398d" title=" " alt="" coords="491,325,711,351"/>
<area shape="rect" href="ERF__TerrainMetrics_8H.html#a3e3ceccddeb3cca9d9e4573af2311a5e" title=" " alt="" coords="485,375,716,402"/>
<area shape="rect" href="ERF__TerrainMetrics_8H.html#a21aac76e0b284b33e302526e1f292c76" title=" " alt="" coords="485,426,716,453"/>
<area shape="rect" href="ERF__ComputeDiffusivityMRF_8cpp.html#adbd1371088057033925253b49b96be81" title=" " alt="" coords="512,730,689,757"/>
<area shape="rect" href="ERF__ComputeDiffusivityMYNN25_8cpp.html#a81a69a594e563b0bb99931d2338aa2ef" title=" " alt="" coords="499,679,703,706"/>
<area shape="rect" href="ERF__ComputeDiffusivityMYNNEDMF_8cpp.html#abbaa6f8655f81f03c1010933ecbb7f3c" title=" " alt="" coords="487,578,714,605"/>
<area shape="rect" href="ERF__ComputeDiffusivityYSU_8cpp.html#ab3c10d1ab614646b689f68d7efcf03fb" title=" " alt="" coords="513,629,688,655"/>
<area shape="rect" href="ERF__ComputeTurbulentViscosity_8cpp.html#abdcec52bb194e0ea814dbdb302127091" title=" " alt="" coords="489,477,712,503"/>
<area shape="rect" href="ERF__ComputeTurbulentViscosity_8cpp.html#afb98f24b064613be5cce58906d14f0ff" title=" " alt="" coords="483,527,719,554"/>
<area shape="rect" href="ERF__TerrainMetrics_8H.html#a32eeeb066c70da970aa6a60918515987" title=" " alt="" coords="771,578,991,605"/>
<area shape="rect" href="ERF__TerrainMetrics_8H.html#a41f9b3a5604791daf44935b10a55a565" title=" " alt="" coords="780,679,983,706"/>
<area shape="rect" href="ERF__PBLModels_8H.html#af84ec6ece6fad0da9e21461e60f58b2c" title=" " alt="" coords="767,629,996,655"/>
<area shape="rect" href="ERF__Thetav_8H.html#a560eb559ee1d5b8dceaae23f4f4581d5" title=" " alt="" coords="1044,629,1111,655"/>
<area shape="rect" href="ERF__EddyViscosity_8H.html#ad1e6d314bfc2e508c86ee0e07cfbd8f8" title=" " alt="" coords="812,426,951,453"/>
<area shape="rect" href="ERF__EddyViscosity_8H.html#a1a8e03c9d0a2b9decd215a2b2b2425e1" title=" " alt="" coords="803,477,960,503"/>
<area shape="rect" href="ERF__ReadBndryPlanes_8cpp.html#a63d3125f6fd361f61d697799f46da817" title=" " alt="" coords="852,527,911,554"/>
</map>
</div>

</div>
</div>
<a id="ab463dd8a88f21f3a5ff33b583a883c28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab463dd8a88f21f3a5ff33b583a883c28">&#9670;&nbsp;</a></span>advance_lsm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::advance_lsm </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>cons_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>xvel_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>yvel_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real &amp;&#160;</td>
          <td class="paramname"><em>dt_advance</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;{</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a43c1741535574c7e6f4fe6bf90552f31">lsm_type</a> != LandSurfaceType::None) {</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a43c1741535574c7e6f4fe6bf90552f31">lsm_type</a> == LandSurfaceType::NOAH) {</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;            <a class="code" href="classERF.html#ae0e9a78f120ba632d78cbf23c97b851c">lsm</a>.<a class="code" href="classLandSurface.html#a1167c7d5604c92e612099313f1afe8e4">Advance</a>(lev, cons_in, xvel_in, yvel_in, <a class="code" href="classERF.html#a1a2e3faf5dd90ad2f9ded28b486f3b46">SFS_hfx3_lev</a>[lev].get(), <a class="code" href="classERF.html#a101ceb89b1a249efeea3f4e8052bc8c0">SFS_q1fx3_lev</a>[lev].get(), dt_advance, <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[lev]);</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;            <a class="code" href="classERF.html#ae0e9a78f120ba632d78cbf23c97b851c">lsm</a>.<a class="code" href="classLandSurface.html#a1167c7d5604c92e612099313f1afe8e4">Advance</a>(lev, dt_advance);</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;        }</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    }</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_ae0e9a78f120ba632d78cbf23c97b851c"><div class="ttname"><a href="classERF.html#ae0e9a78f120ba632d78cbf23c97b851c">ERF::lsm</a></div><div class="ttdeci">LandSurface lsm</div><div class="ttdef"><b>Definition:</b> ERF.H:761</div></div>
<div class="ttc" id="aclassERF_html_aefa640a036c25b7b770e88a5f838eb2a"><div class="ttname"><a href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">ERF::istep</a></div><div class="ttdeci">amrex::Vector&lt; int &gt; istep</div><div class="ttdef"><b>Definition:</b> ERF.H:695</div></div>
<div class="ttc" id="aclassLandSurface_html_a1167c7d5604c92e612099313f1afe8e4"><div class="ttname"><a href="classLandSurface.html#a1167c7d5604c92e612099313f1afe8e4">LandSurface::Advance</a></div><div class="ttdeci">void Advance(const int &amp;lev, amrex::MultiFab &amp;cons_in, amrex::MultiFab &amp;xvel_in, amrex::MultiFab &amp;yvel_in, amrex::MultiFab *hfx3_out, amrex::MultiFab *qfx3_out, const amrex::Real &amp;dt_advance, const int &amp;nstep)</div><div class="ttdef"><b>Definition:</b> ERF_LandSurface.H:52</div></div>
<div class="ttc" id="astructSolverChoice_html_a43c1741535574c7e6f4fe6bf90552f31"><div class="ttname"><a href="structSolverChoice.html#a43c1741535574c7e6f4fe6bf90552f31">SolverChoice::lsm_type</a></div><div class="ttdeci">LandSurfaceType lsm_type</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:807</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad64b5fe566102dc053b35ad337971a3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad64b5fe566102dc053b35ad337971a3e">&#9670;&nbsp;</a></span>advance_microphysics()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::advance_microphysics </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>cons_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real &amp;&#160;</td>
          <td class="paramname"><em>dt_advance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int &amp;&#160;</td>
          <td class="paramname"><em>iteration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real &amp;&#160;</td>
          <td class="paramname"><em>time</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;{</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> != MoistureType::None) {</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;        <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;Update_Micro_Vars_Lev(lev, <a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">cons</a>);</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;        <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;Advance(lev, dt_advance, iteration, time, <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>, <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>, <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>, <a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>);</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;        <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;Update_State_Vars_Lev(lev, <a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">cons</a>);</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    }</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_a4b7277d54649219f31fe286eee9d415a"><div class="ttname"><a href="classERF.html#a4b7277d54649219f31fe286eee9d415a">ERF::micro</a></div><div class="ttdeci">std::unique_ptr&lt; Microphysics &gt; micro</div><div class="ttdef"><b>Definition:</b> ERF.H:745</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad3ef30449c979e90c40b0c6f79864e8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3ef30449c979e90c40b0c6f79864e8f">&#9670;&nbsp;</a></span>advance_radiation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::advance_radiation </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>cons_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real &amp;&#160;</td>
          <td class="paramname"><em>dt_advance</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;{</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a31c93846e0129221632347d2378e881d">rad_type</a> != RadiationType::None) {</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;        <span class="comment">// TODO: Address issue with lev&gt;0 not spanning all z?</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;        <span class="keywordflow">if</span> (lev == 0) {</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#ifdef ERF_USE_NETCDF</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;            MultiFab *lat_ptr = lat_m[lev].get();</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;            MultiFab *lon_ptr = lon_m[lev].get();</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;            MultiFab *lat_ptr = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;            MultiFab *lon_ptr = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;            <a class="code" href="classERF.html#a609b41a1de9c6b28f23dcdc6843f9ef5">rad</a>[lev]-&gt;Run(lev, <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[lev], <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev], dt_advance,</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;                          <a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">cons</a>.boxArray(), geom[lev], &amp;(<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">cons</a>),</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;                          <a class="code" href="classERF.html#a1a3799aabf8337159aa290946fef8404">sw_lw_fluxes</a>[lev].get()  , <a class="code" href="classERF.html#a69e6a357fd92f2c2ad9f6e0843372b16">solar_zenith</a>[lev].get(),</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;                          <a class="code" href="classERF.html#afa4c3753628a106460dbb708277de511">qheating_rates</a>[lev].get(), <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev].get()   ,</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;                          lat_ptr, lon_ptr);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;            <span class="comment">/*</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">            // TODO: fix this - can&#39;t use set_lsm_inputs with IRadiation::Run()</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">            if (solverChoice.lsm_type == LandSurfaceType::SLM) {</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">                rad[lev]-&gt;set_lsm_inputs(lsm.get_model_lev&lt;SLM&gt;(lev));</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">            }</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">            */</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        }</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    }</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_a1a3799aabf8337159aa290946fef8404"><div class="ttname"><a href="classERF.html#a1a3799aabf8337159aa290946fef8404">ERF::sw_lw_fluxes</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; sw_lw_fluxes</div><div class="ttdef"><b>Definition:</b> ERF.H:769</div></div>
<div class="ttc" id="aclassERF_html_a609b41a1de9c6b28f23dcdc6843f9ef5"><div class="ttname"><a href="classERF.html#a609b41a1de9c6b28f23dcdc6843f9ef5">ERF::rad</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; IRadiation &gt; &gt; rad</div><div class="ttdef"><b>Definition:</b> ERF.H:765</div></div>
<div class="ttc" id="aclassERF_html_a65741b6379d273c19a25cf48bb947614"><div class="ttname"><a href="classERF.html#a65741b6379d273c19a25cf48bb947614">ERF::t_new</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Real &gt; t_new</div><div class="ttdef"><b>Definition:</b> ERF.H:699</div></div>
<div class="ttc" id="aclassERF_html_a69e6a357fd92f2c2ad9f6e0843372b16"><div class="ttname"><a href="classERF.html#a69e6a357fd92f2c2ad9f6e0843372b16">ERF::solar_zenith</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; solar_zenith</div><div class="ttdef"><b>Definition:</b> ERF.H:770</div></div>
<div class="ttc" id="aclassERF_html_afa4c3753628a106460dbb708277de511"><div class="ttname"><a href="classERF.html#afa4c3753628a106460dbb708277de511">ERF::qheating_rates</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; qheating_rates</div><div class="ttdef"><b>Definition:</b> ERF.H:766</div></div>
<div class="ttc" id="astructSolverChoice_html_a31c93846e0129221632347d2378e881d"><div class="ttname"><a href="structSolverChoice.html#a31c93846e0129221632347d2378e881d">SolverChoice::rad_type</a></div><div class="ttdeci">RadiationType rad_type</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:808</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7758f75dc7c9029eddc4c58ac0567654"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7758f75dc7c9029eddc4c58ac0567654">&#9670;&nbsp;</a></span>appendPlotVariables()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::appendPlotVariables </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>pp_plot_var_names</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>plot_var_names</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;{</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    ParmParse <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>(<a class="code" href="classERF.html#a59df30e7a5537c8543bb00772bd98b58">pp_prefix</a>);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    Vector&lt;std::string&gt; plot_var_names(0);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.contains(pp_plot_var_names.c_str())) {</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        std::string nm;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <span class="keywordtype">int</span> nPltVars = <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.countval(pp_plot_var_names.c_str());</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nPltVars; i++) {</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.get(pp_plot_var_names.c_str(), nm, i);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            <span class="comment">// Add the named variable to our list of plot variables</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            <span class="comment">// if it is not already in the list</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, nm)) {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                plot_var_names.push_back(nm);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            }</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        }</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    }</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    Vector&lt;std::string&gt; tmp_plot_names(0);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="preprocessor">#ifdef ERF_USE_PARTICLES</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    Vector&lt;std::string&gt; particle_mesh_plot_names;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    particleData.GetMeshPlotVarNames( particle_mesh_plot_names );</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; particle_mesh_plot_names.size(); i++) {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        std::string tmp(particle_mesh_plot_names[i]);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, tmp) ) {</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            tmp_plot_names.push_back(tmp);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        }</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    }</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    {</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        Vector&lt;std::string&gt; microphysics_plot_names;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;GetPlotVarNames(microphysics_plot_names);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <span class="keywordflow">if</span> (microphysics_plot_names.size() &gt; 0) {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            <span class="keyword">static</span> <span class="keywordtype">bool</span> first_call = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            <span class="keywordflow">if</span> (first_call) {</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                Print() &lt;&lt; getEnumNameString(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a>)</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot;: the following additional variables are available to plot:\n&quot;</span>;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; microphysics_plot_names.size(); i++) {</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                    Print() &lt;&lt; <span class="stringliteral">&quot;    &quot;</span> &lt;&lt; microphysics_plot_names[i] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                }</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                first_call = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            }</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; plot_name : microphysics_plot_names) {</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, plot_name)) {</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                    tmp_plot_names.push_back(plot_name);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                }</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            }</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        }</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    }</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; tmp_plot_names.size(); i++) {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        a_plot_var_names.push_back( tmp_plot_names[i] );</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    }</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="comment">// Finally, check to see if we found all the requested variables</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; plot_name : plot_var_names) {</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(a_plot_var_names, plot_name)) {</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;             <span class="keywordflow">if</span> (amrex::ParallelDescriptor::IOProcessor()) {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                 Warning(<span class="stringliteral">&quot;\nWARNING: Requested to plot variable &#39;&quot;</span> + plot_name + <span class="stringliteral">&quot;&#39; but it is not available&quot;</span>);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;             }</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    }</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;}</div>
<div class="ttc" id="aERF__Container_8H_html_a1f8554e7b211b0acfc202e8a600e7d67"><div class="ttname"><a href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a></div><div class="ttdeci">bool containerHasElement(const V &amp;iterable, const T &amp;query)</div><div class="ttdef"><b>Definition:</b> ERF_Container.H:5</div></div>
<div class="ttc" id="aclassERF_html_a59df30e7a5537c8543bb00772bd98b58"><div class="ttname"><a href="classERF.html#a59df30e7a5537c8543bb00772bd98b58">ERF::pp_prefix</a></div><div class="ttdeci">std::string pp_prefix</div><div class="ttdef"><b>Definition:</b> ERF.H:443</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a7758f75dc7c9029eddc4c58ac0567654_cgraph.png" border="0" usemap="#aclassERF_a7758f75dc7c9029eddc4c58ac0567654_cgraph" alt=""/></div>
<map name="aclassERF_a7758f75dc7c9029eddc4c58ac0567654_cgraph" id="aclassERF_a7758f75dc7c9029eddc4c58ac0567654_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,192,57"/>
<area shape="rect" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67" title=" " alt="" coords="240,5,403,32"/>
<area shape="rect" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469" title=" " alt="" coords="302,56,341,83"/>
</map>
</div>

</div>
</div>
<a id="a8202de1f8f372e3e6fdc483447c6a55f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8202de1f8f372e3e6fdc483447c6a55f">&#9670;&nbsp;</a></span>AverageDown()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::AverageDown </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;{</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    AMREX_ALWAYS_ASSERT(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#af976afa61859c07e6249963edc367c2d">coupling_type</a> == CouplingType::TwoWay);</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160; </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <span class="keywordtype">int</span> src_comp, num_comp;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = finest_level-1; lev &gt;= 0; --lev)</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    {</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;        <span class="comment">// If anelastic we don&#39;t average down rho because rho == rho0.</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa7be0d60ce3de3441d44082cc1b725ec">anelastic</a>[lev]) {</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;            src_comp = 1;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;            src_comp = 0;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        }</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        num_comp = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[0][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nComp() - src_comp;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        <a class="code" href="classERF.html#ae17524f168760cf435685a08d97480e7">AverageDownTo</a>(lev,src_comp,num_comp);</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    }</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_ae17524f168760cf435685a08d97480e7"><div class="ttname"><a href="classERF.html#ae17524f168760cf435685a08d97480e7">ERF::AverageDownTo</a></div><div class="ttdeci">void AverageDownTo(int crse_lev, int scomp, int ncomp)</div><div class="ttdef"><b>Definition:</b> ERF_AverageDown.cpp:36</div></div>
<div class="ttc" id="astructSolverChoice_html_af976afa61859c07e6249963edc367c2d"><div class="ttname"><a href="structSolverChoice.html#af976afa61859c07e6249963edc367c2d">SolverChoice::coupling_type</a></div><div class="ttdeci">CouplingType coupling_type</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:803</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae17524f168760cf435685a08d97480e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae17524f168760cf435685a08d97480e7">&#9670;&nbsp;</a></span>AverageDownTo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::AverageDownTo </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>crse_lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>scomp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ncomp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;{</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa7be0d60ce3de3441d44082cc1b725ec">anelastic</a>[crse_lev]) {</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        AMREX_ALWAYS_ASSERT(scomp == 1);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        AMREX_ALWAYS_ASSERT(scomp == 0);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    }</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    AMREX_ALWAYS_ASSERT(ncomp == <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[crse_lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nComp() - scomp);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    AMREX_ALWAYS_ASSERT(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#af976afa61859c07e6249963edc367c2d">coupling_type</a> == CouplingType::TwoWay);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="comment">// ******************************************************************************************</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="comment">// First do cell-centered quantities</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="comment">// The quantity that is conserved is not (rho S), but rather (rho S / m^2) where</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="comment">// m is the map scale factor at cell centers</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="comment">// Here we pre-divide (rho S) by m^2 before average down</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="comment">// ******************************************************************************************</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = crse_lev; lev &lt;= crse_lev+1; lev++) {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      <span class="keywordflow">for</span> (MFIter mfi(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], TilingIfNotGPU()); mfi.isValid(); ++mfi) {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <span class="keyword">const</span> Array4&lt;      Real&gt;   cons_arr = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].array(mfi);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <span class="keyword">const</span> Array4&lt;const Real&gt; mfx_arr = <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85bac2a428daaf1a1b398630fa8cec7f115b">MapFacType::m_x</a>]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <span class="keyword">const</span> Array4&lt;const Real&gt; mfy_arr = <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85ba9612b6816e2fb7dc3ad56d6bc1fb7df8">MapFacType::m_y</a>]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structSolverChoice.html#a1952672901901b0b3a628f2298dc72c2">SolverChoice::mesh_type</a> != MeshType::ConstantDz) {</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;            <span class="keyword">const</span> Array4&lt;const Real&gt;   detJ_arr = <a class="code" href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">detJ_cc</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;            ParallelFor(bx, ncomp, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k, <span class="keywordtype">int</span> n) noexcept</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;            {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                cons_arr(i,j,k,scomp+n) *= detJ_arr(i,j,k) / (mfx_arr(i,j,0)*mfy_arr(i,j,0));</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            });</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;            ParallelFor(bx, ncomp, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k, <span class="keywordtype">int</span> n) noexcept</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;            {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                cons_arr(i,j,k,scomp+n) /= (mfx_arr(i,j,0)*mfy_arr(i,j,0));</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;            });</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        }</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      } <span class="comment">// mfi</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    } <span class="comment">// lev</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordtype">int</span> fine_lev = crse_lev+1;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a812912653fe0d8ab1342bfef4793dd0e">interpolation_type</a> == StateInterpType::Perturbational) {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <span class="comment">// Make the fine rho and (rho theta) be perturbational</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        MultiFab::Divide(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[fine_lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[fine_lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                         <a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>,<a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>,1,IntVect{0});</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        MultiFab::Subtract(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[fine_lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[fine_lev],</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                           <a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91abc888a343d4fcc4fc4ffb79c6ac7cb93">BaseState::r0_comp</a>,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>,1,IntVect{0});</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        MultiFab::Subtract(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[fine_lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[fine_lev],</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                           <a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91aaf394bbf6aa8da56fc479f2ed5a2a372">BaseState::th0_comp</a>,<a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>,1,IntVect{0});</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <span class="comment">// Make the crse rho and (rho theta) be perturbational</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        MultiFab::Divide(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[crse_lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[crse_lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                         <a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>,<a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>,1,IntVect{0});</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        MultiFab::Subtract(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[crse_lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[crse_lev],</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                           <a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91abc888a343d4fcc4fc4ffb79c6ac7cb93">BaseState::r0_comp</a>,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>,1,IntVect{0});</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        MultiFab::Subtract(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[crse_lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[crse_lev],</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                           <a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91aaf394bbf6aa8da56fc479f2ed5a2a372">BaseState::th0_comp</a>,<a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>,1,IntVect{0});</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    }</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    average_down(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[crse_lev+1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[crse_lev  ][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                 scomp, ncomp, refRatio(crse_lev));</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a812912653fe0d8ab1342bfef4793dd0e">interpolation_type</a> == StateInterpType::Perturbational) {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="comment">// Restore the fine data to what it was</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        MultiFab::Add(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[fine_lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[fine_lev],</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                      <a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91abc888a343d4fcc4fc4ffb79c6ac7cb93">BaseState::r0_comp</a>,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>,1,IntVect{0});</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        MultiFab::Add(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[fine_lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[fine_lev],</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                      <a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91aaf394bbf6aa8da56fc479f2ed5a2a372">BaseState::th0_comp</a>,<a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>,1,IntVect{0});</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        MultiFab::Multiply(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[fine_lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[fine_lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                           <a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>,<a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>,1,IntVect{0});</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="comment">// Make the crse data be full values not perturbational</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        MultiFab::Add(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[crse_lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[crse_lev],</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                      <a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91abc888a343d4fcc4fc4ffb79c6ac7cb93">BaseState::r0_comp</a>,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>,1,IntVect{0});</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        MultiFab::Add(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[crse_lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[crse_lev],</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                      <a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91aaf394bbf6aa8da56fc479f2ed5a2a372">BaseState::th0_comp</a>,<a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>,1,IntVect{0});</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        MultiFab::Multiply(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[crse_lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[crse_lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                           <a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>,<a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>,1,IntVect{0});</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    }</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[crse_lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].FillBoundary(geom[crse_lev].periodicity());</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="comment">// Here we multiply (rho S) by m^2 after average down</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = crse_lev; lev &lt;= crse_lev+1; lev++) {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      <span class="keywordflow">for</span> (MFIter mfi(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], TilingIfNotGPU()); mfi.isValid(); ++mfi) {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="keyword">const</span> Array4&lt;      Real&gt;   cons_arr = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].array(mfi);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="keyword">const</span> Array4&lt;const Real&gt; mfx_arr = <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85bac2a428daaf1a1b398630fa8cec7f115b">MapFacType::m_x</a>]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <span class="keyword">const</span> Array4&lt;const Real&gt; mfy_arr = <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85ba9612b6816e2fb7dc3ad56d6bc1fb7df8">MapFacType::m_y</a>]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structSolverChoice.html#a1952672901901b0b3a628f2298dc72c2">SolverChoice::mesh_type</a> != MeshType::ConstantDz) {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            <span class="keyword">const</span> Array4&lt;const Real&gt;   detJ_arr = <a class="code" href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">detJ_cc</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            ParallelFor(bx, ncomp, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k, <span class="keywordtype">int</span> n) noexcept</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                cons_arr(i,j,k,scomp+n) *= detJ_arr(i,j,k) / (mfx_arr(i,j,0)*mfy_arr(i,j,0));</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            });</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            ParallelFor(bx, ncomp, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k, <span class="keywordtype">int</span> n) noexcept</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                cons_arr(i,j,k,scomp+n) /= (mfx_arr(i,j,0)*mfy_arr(i,j,0));</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            });</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        }</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      } <span class="comment">// mfi</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    } <span class="comment">// lev</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="comment">// ******************************************************************************************</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="comment">// Now average down momenta.</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="comment">// Note that vars_new holds velocities not momenta, but we want to do conservative</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="comment">//    averaging so we first convert to momentum, then average down, then convert</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="comment">//    back to velocities -- only on the valid region</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="comment">// ******************************************************************************************</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = crse_lev; lev &lt;= crse_lev+1; lev++)</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="comment">// FillBoundary for density so we can go back and forth between velocity and momentum</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160; </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <a class="code" href="ERF__Utils_8H.html#a5e2e36af19c0192915a2ca721c0cded4">VelocityToMomentum</a>(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>], IntVect(0,0,0),</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                           <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>], IntVect(0,0,0),</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                           <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>], IntVect(0,0,0),</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                           <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                             <a class="code" href="classERF.html#a01f3db32272f53dc68025f0a98195e57">rU_new</a>[lev],</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                             <a class="code" href="classERF.html#a54e37988486ef96e55e84bd8e91bb688">rV_new</a>[lev],</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                             <a class="code" href="classERF.html#aa46c0b0d20525aed10f447923e54dde7">rW_new</a>[lev],</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                           Geom(lev).Domain(),</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                           <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    average_down_faces(<a class="code" href="classERF.html#a01f3db32272f53dc68025f0a98195e57">rU_new</a>[crse_lev+1], <a class="code" href="classERF.html#a01f3db32272f53dc68025f0a98195e57">rU_new</a>[crse_lev], refRatio(crse_lev), geom[crse_lev]);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    average_down_faces(<a class="code" href="classERF.html#a54e37988486ef96e55e84bd8e91bb688">rV_new</a>[crse_lev+1], <a class="code" href="classERF.html#a54e37988486ef96e55e84bd8e91bb688">rV_new</a>[crse_lev], refRatio(crse_lev), geom[crse_lev]);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    average_down_faces(<a class="code" href="classERF.html#aa46c0b0d20525aed10f447923e54dde7">rW_new</a>[crse_lev+1], <a class="code" href="classERF.html#aa46c0b0d20525aed10f447923e54dde7">rW_new</a>[crse_lev], refRatio(crse_lev), geom[crse_lev]);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = crse_lev; lev &lt;= crse_lev+1; lev++) {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <a class="code" href="ERF__MomentumToVelocity_8cpp.html#a4909cdce4c261c6dae5564fb714881ea">MomentumToVelocity</a>(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                           <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                           <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>],</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                           <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                             <a class="code" href="classERF.html#a01f3db32272f53dc68025f0a98195e57">rU_new</a>[lev],</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                             <a class="code" href="classERF.html#a54e37988486ef96e55e84bd8e91bb688">rV_new</a>[lev],</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                             <a class="code" href="classERF.html#aa46c0b0d20525aed10f447923e54dde7">rW_new</a>[lev],</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                           Geom(lev).Domain(),</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                           <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    }</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;}</div>
<div class="ttc" id="aERF__MomentumToVelocity_8cpp_html_a4909cdce4c261c6dae5564fb714881ea"><div class="ttname"><a href="ERF__MomentumToVelocity_8cpp.html#a4909cdce4c261c6dae5564fb714881ea">MomentumToVelocity</a></div><div class="ttdeci">void MomentumToVelocity(MultiFab &amp;xvel, MultiFab &amp;yvel, MultiFab &amp;zvel, const MultiFab &amp;density, const MultiFab &amp;xmom_in, const MultiFab &amp;ymom_in, const MultiFab &amp;zmom_in, const Box &amp;domain, const Vector&lt; BCRec &gt; &amp;domain_bcs_type_h)</div><div class="ttdef"><b>Definition:</b> ERF_MomentumToVelocity.cpp:25</div></div>
<div class="ttc" id="aclassERF_html_a812912653fe0d8ab1342bfef4793dd0e"><div class="ttname"><a href="classERF.html#a812912653fe0d8ab1342bfef4793dd0e">ERF::interpolation_type</a></div><div class="ttdeci">static StateInterpType interpolation_type</div><div class="ttdef"><b>Definition:</b> ERF.H:1040</div></div>
<div class="ttc" id="anamespaceBaseState_html_a6f8dc3597225ea7941dad615e7f22e91aaf394bbf6aa8da56fc479f2ed5a2a372"><div class="ttname"><a href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91aaf394bbf6aa8da56fc479f2ed5a2a372">BaseState::th0_comp</a></div><div class="ttdeci">@ th0_comp</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:66</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_ae17524f168760cf435685a08d97480e7_cgraph.png" border="0" usemap="#aclassERF_ae17524f168760cf435685a08d97480e7_cgraph" alt=""/></div>
<map name="aclassERF_ae17524f168760cf435685a08d97480e7_cgraph" id="aclassERF_ae17524f168760cf435685a08d97480e7_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,164,57"/>
<area shape="rect" href="ERF__MomentumToVelocity_8cpp.html#a4909cdce4c261c6dae5564fb714881ea" title=" " alt="" coords="212,5,375,32"/>
<area shape="rect" href="ERF__Utils_8H.html#a5e2e36af19c0192915a2ca721c0cded4" title=" " alt="" coords="212,56,375,83"/>
</map>
</div>

</div>
</div>
<a id="af46289079e053a6d74ddef0bf1a5d8a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af46289079e053a6d74ddef0bf1a5d8a3">&#9670;&nbsp;</a></span>build_fine_mask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MultiFab &amp; ERF::build_fine_mask </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>level</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Helper function for constructing a fine mask, that is, a MultiFab masking coarser data at a lower level by zeroing out covered cells in the fine mask MultiFab we compute.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">level</td><td>Fine level index which masks underlying coarser data </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;{</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    <span class="comment">// Mask for zeroing covered cells</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    AMREX_ASSERT(level &gt; 0);</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160; </div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <span class="keyword">const</span> BoxArray&amp; cba = grids[level-1];</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    <span class="keyword">const</span> DistributionMapping&amp; cdm = dmap[level-1];</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160; </div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <span class="comment">// TODO -- we should make a vector of these a member of ERF class</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <a class="code" href="classERF.html#a83c244120a15f0d9b9bca54e93976428">fine_mask</a>.define(cba, cdm, 1, 0, MFInfo());</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <a class="code" href="classERF.html#a83c244120a15f0d9b9bca54e93976428">fine_mask</a>.setVal(1.0);</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160; </div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    BoxArray fba = grids[level];</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    iMultiFab ifine_mask = makeFineMask(cba, cdm, fba, ref_ratio[level-1], 1, 0);</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160; </div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>  fma =  <a class="code" href="classERF.html#a83c244120a15f0d9b9bca54e93976428">fine_mask</a>.arrays();</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> ifma = ifine_mask.arrays();</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    ParallelFor(<a class="code" href="classERF.html#a83c244120a15f0d9b9bca54e93976428">fine_mask</a>, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> bno, <span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    {</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;       fma[bno](i,j,k) = ifma[bno](i,j,k);</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    });</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160; </div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classERF.html#a83c244120a15f0d9b9bca54e93976428">fine_mask</a>;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_a83c244120a15f0d9b9bca54e93976428"><div class="ttname"><a href="classERF.html#a83c244120a15f0d9b9bca54e93976428">ERF::fine_mask</a></div><div class="ttdeci">amrex::MultiFab fine_mask</div><div class="ttdef"><b>Definition:</b> ERF.H:1166</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac44e400a7ce68e18fa44e9416cb1344e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac44e400a7ce68e18fa44e9416cb1344e">&#9670;&nbsp;</a></span>ClearLevel()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::ClearLevel </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;{</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> var_idx = 0; var_idx &lt; <a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a5deccaa24d5e74279425d7749f7d1494">Vars::NumTypes</a>; ++var_idx) {</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][var_idx].clear();</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        <a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev][var_idx].clear();</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    }</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160; </div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].clear();</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160; </div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <a class="code" href="classERF.html#a01f3db32272f53dc68025f0a98195e57">rU_new</a>[lev].clear();</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <a class="code" href="classERF.html#a6eecc44323f77917c95869928284f61d">rU_old</a>[lev].clear();</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    <a class="code" href="classERF.html#a54e37988486ef96e55e84bd8e91bb688">rV_new</a>[lev].clear();</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <a class="code" href="classERF.html#aeb64e3b4def989ce68d873aefeed5e0e">rV_old</a>[lev].clear();</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    <a class="code" href="classERF.html#aa46c0b0d20525aed10f447923e54dde7">rW_new</a>[lev].clear();</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <a class="code" href="classERF.html#ac1fa56ec90f44e3cdf487af46804163f">rW_old</a>[lev].clear();</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160; </div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <span class="keywordflow">if</span> (lev &gt; 0) {</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        <a class="code" href="classERF.html#aaf7e8e28172eebdfe2224e4ee823310d">zmom_crse_rhs</a>[lev].clear();</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    }</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160; </div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa7be0d60ce3de3441d44082cc1b725ec">anelastic</a>[lev] == 1 || <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa7bb7f3c8b475b0e446c271d8aa5497f">project_initial_velocity</a>) {</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        <a class="code" href="classERF.html#a0c5206542d4193bb687f5271be6fe5e5">pp_inc</a>[lev].clear();</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    }</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160; </div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <span class="comment">// Clears the integrator memory</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <a class="code" href="classERF.html#a09d0fb2bd609c898a665d9530a744585">mri_integrator_mem</a>[lev].reset();</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160; </div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="comment">// Clears the physical boundary condition routines</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <a class="code" href="classERF.html#a2e9b04043853d25f2d76edbc0bed2e72">physbcs_cons</a>[lev].reset();</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <a class="code" href="classERF.html#a64e55e5ae9df06433146db657eb9e72e">physbcs_u</a>[lev].reset();</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <a class="code" href="classERF.html#a79231b5cfd4576a742e46ae0082b5121">physbcs_v</a>[lev].reset();</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <a class="code" href="classERF.html#a45c8ecd777f47732993777a0afb8e140">physbcs_w</a>[lev].reset();</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <a class="code" href="classERF.html#af4e7dc93dae16aa2cc94bbb20b699a6f">physbcs_base</a>[lev].reset();</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160; </div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <span class="comment">// Clears the flux register array</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <a class="code" href="classERF.html#a86a0bc8e41668411ee0ab5801d4688a7">advflux_reg</a>[lev]-&gt;reset();</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_a0c5206542d4193bb687f5271be6fe5e5"><div class="ttname"><a href="classERF.html#a0c5206542d4193bb687f5271be6fe5e5">ERF::pp_inc</a></div><div class="ttdeci">amrex::Vector&lt; amrex::MultiFab &gt; pp_inc</div><div class="ttdef"><b>Definition:</b> ERF.H:719</div></div>
<div class="ttc" id="aclassERF_html_a86a0bc8e41668411ee0ab5801d4688a7"><div class="ttname"><a href="classERF.html#a86a0bc8e41668411ee0ab5801d4688a7">ERF::advflux_reg</a></div><div class="ttdeci">amrex::Vector&lt; amrex::YAFluxRegister * &gt; advflux_reg</div><div class="ttdef"><b>Definition:</b> ERF.H:846</div></div>
<div class="ttc" id="aclassERF_html_af4e7dc93dae16aa2cc94bbb20b699a6f"><div class="ttname"><a href="classERF.html#af4e7dc93dae16aa2cc94bbb20b699a6f">ERF::physbcs_base</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; ERFPhysBCFunct_base &gt; &gt; physbcs_base</div><div class="ttdef"><b>Definition:</b> ERF.H:726</div></div>
<div class="ttc" id="anamespaceVars_html_a3e5e550795a0b745a4e43177e81f8c57a5deccaa24d5e74279425d7749f7d1494"><div class="ttname"><a href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a5deccaa24d5e74279425d7749f7d1494">Vars::NumTypes</a></div><div class="ttdeci">@ NumTypes</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:144</div></div>
<div class="ttc" id="astructSolverChoice_html_aa7bb7f3c8b475b0e446c271d8aa5497f"><div class="ttname"><a href="structSolverChoice.html#aa7bb7f3c8b475b0e446c271d8aa5497f">SolverChoice::project_initial_velocity</a></div><div class="ttdeci">bool project_initial_velocity</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:766</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0f6effb7eeed11385b20e4bbf516b459"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f6effb7eeed11385b20e4bbf516b459">&#9670;&nbsp;</a></span>cloud_fraction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Real ERF::cloud_fraction </td>
          <td>(</td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;{</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    BL_PROFILE(<span class="stringliteral">&quot;ERF::cloud_fraction()&quot;</span>);</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160; </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="keywordtype">int</span> lev = 0;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="comment">// This holds all of qc</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    MultiFab <a class="code" href="namespaceMicVar__SatAdj.html#ac2be1e5fc951d23f27b621bed9836c16aea3777efcbbb3712ce373924287c2cb3">qc</a>(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],make_alias,<a class="code" href="ERF__IndexDefines_8H.html#a3bf0a4783e82ba30db2b7c0a332c2f16">RhoQ2_comp</a>,1);</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160; </div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="keywordtype">int</span> direction = 2; <span class="comment">// z-direction</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    Box <span class="keyword">const</span>&amp; domain = geom[lev].Domain();</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160; </div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span>&amp; qc_arr = <a class="code" href="namespaceMicVar__SatAdj.html#ac2be1e5fc951d23f27b621bed9836c16aea3777efcbbb3712ce373924287c2cb3">qc</a>.const_arrays();</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160; </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="comment">// qc_2d is an BaseFab&lt;int&gt; holding the max value over the column</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="keyword">auto</span> qc_2d = ReduceToPlane&lt;ReduceOpMax,int&gt;(direction, domain, <a class="code" href="namespaceMicVar__SatAdj.html#ac2be1e5fc951d23f27b621bed9836c16aea3777efcbbb3712ce373924287c2cb3">qc</a>,</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;         [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> box_no, <span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) -&gt; <span class="keywordtype">int</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;         {</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;             <span class="keywordflow">if</span> (qc_arr[box_no](i,j,k) &gt; 0) {</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                 <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;             } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                 <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;             }</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;         });</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160; </div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="keyword">auto</span>* p = qc_2d.dataPtr();</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160; </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    Long numpts = qc_2d.numPts();</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160; </div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    AMREX_ASSERT(numpts &lt; Long(std::numeric_limits&lt;int&gt;::max));</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160; </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="preprocessor">#if 1</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="keywordflow">if</span> (ParallelDescriptor::UseGpuAwareMpi()) {</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        ParallelDescriptor::ReduceIntMax(p,<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(numpts));</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        Gpu::PinnedVector&lt;int&gt; hv(numpts);</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        Gpu::copyAsync(Gpu::deviceToHost, p, p+numpts, hv.data());</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        Gpu::streamSynchronize();</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        ParallelDescriptor::ReduceIntMax(hv.data(),<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(numpts));</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        Gpu::copyAsync(Gpu::hostToDevice, hv.data(), hv.data()+numpts, p);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    }</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160; </div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="comment">// Sum over component 0</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    Long num_cloudy = qc_2d.template sum&lt;RunOn::Device&gt;(0);</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160; </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="comment">// We need this if we allow domain decomposition in the vertical</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="comment">//    but for now we leave it commented out</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    Long num_cloudy = Reduce::Sum&lt;Long&gt;(numpts,</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;         [=] AMREX_GPU_DEVICE (Long i) -&gt; Long {</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;             <span class="keywordflow">if</span> (p[i] == 1) {</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                 <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;             } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                 <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;             }</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;         });</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    ParallelDescriptor::ReduceLongSum(num_cloudy);</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160; </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    Real num_total = qc_2d.box().d_numPts();</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160; </div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    Real cloud_frac = num_cloudy / num_total;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160; </div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="keywordflow">return</span> cloud_frac;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;}</div>
<div class="ttc" id="aERF__IndexDefines_8H_html_a3bf0a4783e82ba30db2b7c0a332c2f16"><div class="ttname"><a href="ERF__IndexDefines_8H.html#a3bf0a4783e82ba30db2b7c0a332c2f16">RhoQ2_comp</a></div><div class="ttdeci">#define RhoQ2_comp</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:43</div></div>
<div class="ttc" id="anamespaceMicVar__SatAdj_html_ac2be1e5fc951d23f27b621bed9836c16aea3777efcbbb3712ce373924287c2cb3"><div class="ttname"><a href="namespaceMicVar__SatAdj.html#ac2be1e5fc951d23f27b621bed9836c16aea3777efcbbb3712ce373924287c2cb3">MicVar_SatAdj::qc</a></div><div class="ttdeci">@ qc</div><div class="ttdef"><b>Definition:</b> ERF_SatAdj.H:36</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a757e8303ce8ed936c05f559349f10aa5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a757e8303ce8ed936c05f559349f10aa5">&#9670;&nbsp;</a></span>compute_divergence()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::compute_divergence </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Array&lt; amrex::MultiFab const *, AMREX_SPACEDIM &gt;&#160;</td>
          <td class="paramname"><em>rho0_u_const</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Geometry const &amp;&#160;</td>
          <td class="paramname"><em>geom_at_lev</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Project the single-level velocity field to enforce incompressibility Note that the level may or may not be level 0. </p>
<div class="fragment"><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;{</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    BL_PROFILE(<span class="stringliteral">&quot;ERF::compute_divergence()&quot;</span>);</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    <span class="keyword">auto</span> dxInv = geom_at_lev.InvCellSizeArray();</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160; </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <span class="comment">// Compute divergence which will form RHS</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <span class="comment">// Note that we replace &quot;rho0w&quot; with the contravariant momentum, Omega</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> == TerrainType::EB)</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    {</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;        <span class="keywordtype">bool</span> already_on_centroids = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;        EB_computeDivergence(rhs, rho0_u_const, geom_at_lev, already_on_centroids);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    }</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="structSolverChoice.html#a1952672901901b0b3a628f2298dc72c2">SolverChoice::mesh_type</a> == MeshType::ConstantDz)</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    {</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        computeDivergence(rhs, rho0_u_const, geom_at_lev);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    }</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    {</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        <span class="keywordflow">for</span> ( MFIter mfi(rhs,TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        {</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;            Box bx = mfi.tilebox();</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;            <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; rho0u_arr = rho0_u_const[0]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;            <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; rho0v_arr = rho0_u_const[1]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;            <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; rho0w_arr = rho0_u_const[2]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;            <span class="keyword">const</span> Array4&lt;Real      &gt;&amp;   rhs_arr = rhs.array(mfi);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;            <span class="keyword">const</span> Array4&lt;Real const&gt;&amp;      mf_mx = <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85bac2a428daaf1a1b398630fa8cec7f115b">MapFacType::m_x</a>]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;            <span class="keyword">const</span> Array4&lt;Real const&gt;&amp;      mf_my = <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85ba9612b6816e2fb7dc3ad56d6bc1fb7df8">MapFacType::m_y</a>]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="structSolverChoice.html#a1952672901901b0b3a628f2298dc72c2">SolverChoice::mesh_type</a> == MeshType::StretchedDz) {</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;                Real* stretched_dz_d_ptr = <a class="code" href="classERF.html#a6600f30f1043a4c5e62b5cdd05f0a99f">stretched_dz_d</a>[lev].data();</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;                ParallelFor(bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept {</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;                    Real dz   = stretched_dz_d_ptr[k];</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;                    Real mfsq = mf_mx(i,j,0) * mf_my(i,j,0);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                    rhs_arr(i,j,k) = mfsq * ( (rho0u_arr(i+1,j  ,k  ) - rho0u_arr(i,j,k)) * dxInv[0]</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;                                             +(rho0v_arr(i  ,j+1,k  ) - rho0v_arr(i,j,k)) * dxInv[1]</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;                                             +(rho0w_arr(i  ,j  ,k+1) - rho0w_arr(i,j,k)) / dz );</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;                });</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                <span class="comment">// Note we compute the divergence using &quot;rho0w&quot; == Omega</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; ax_arr = <a class="code" href="classERF.html#a93bc9185c89cbeaceffaf40b8cf4a75c">ax</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; ay_arr = <a class="code" href="classERF.html#ade870f983d113c64406bdcb8a9194044">ay</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; dJ_arr = <a class="code" href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">detJ_cc</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                <span class="comment">// az == 1 for terrain-fitted coordinates</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                ParallelFor(bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                    Real mfsq = mf_mx(i,j,0) * mf_my(i,j,0);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                    rhs_arr(i,j,k) = mfsq * ( (ax_arr(i+1,j,k)*rho0u_arr(i+1,j,k) - ax_arr(i,j,k)*rho0u_arr(i,j,k)) * dxInv[0]</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                                             +(ay_arr(i,j+1,k)*rho0v_arr(i,j+1,k) - ay_arr(i,j,k)*rho0v_arr(i,j,k)) * dxInv[1]</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                                             +(                rho0w_arr(i,j,k+1) -               rho0w_arr(i,j,k)) * dxInv[2] ) / dJ_arr(i,j,k);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                });</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;            }</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        } <span class="comment">// mfi</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    }</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_a93bc9185c89cbeaceffaf40b8cf4a75c"><div class="ttname"><a href="classERF.html#a93bc9185c89cbeaceffaf40b8cf4a75c">ERF::ax</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; ax</div><div class="ttdef"><b>Definition:</b> ERF.H:807</div></div>
<div class="ttc" id="aclassERF_html_ade870f983d113c64406bdcb8a9194044"><div class="ttname"><a href="classERF.html#ade870f983d113c64406bdcb8a9194044">ERF::ay</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; ay</div><div class="ttdef"><b>Definition:</b> ERF.H:808</div></div>
<div class="ttc" id="astructSolverChoice_html_ab734eb0a5147b93dc6590038b6decc60"><div class="ttname"><a href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">SolverChoice::terrain_type</a></div><div class="ttdeci">static TerrainType terrain_type</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:702</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa38639155e79bab8a0c283aa6e7afa81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa38639155e79bab8a0c283aa6e7afa81">&#9670;&nbsp;</a></span>ComputeDt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::ComputeDt </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>step</em> = <code>-1</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Function that calls estTimeStep for each level </p>
<div class="fragment"><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;{</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    Vector&lt;Real&gt; dt_tmp(finest_level+1);</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev)</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    {</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;        dt_tmp[lev] = <a class="code" href="classERF.html#a6b1d727e63de2e49aa4f8e00b0dda1d5">estTimeStep</a>(lev, <a class="code" href="classERF.html#a3cf7cb2e51eb7b69cb4079ffc6722459">dt_mri_ratio</a>[lev]);</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    }</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160; </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    ParallelDescriptor::ReduceRealMin(&amp;dt_tmp[0], dt_tmp.size());</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    Real dt_0 = dt_tmp[0];</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="keywordtype">int</span> n_factor = 1;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;        dt_tmp[lev] = amrex::min(dt_tmp[lev], <a class="code" href="classERF.html#ae16d413b172bb3b3400af6d5cb236fd4">change_max</a>*<a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[lev]);</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;        n_factor *= <a class="code" href="classERF.html#aa3db2dd1b65310c66c4038650c22aaee">nsubsteps</a>[lev];</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        dt_0 = amrex::min(dt_0, n_factor*dt_tmp[lev]);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        <span class="keywordflow">if</span> (step == 0){</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;            dt_0 *= <a class="code" href="classERF.html#ad353aa9e275612ff2110c5a1405c1176">init_shrink</a>;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a43d0b17f6e155691a1e9474526df3af5">verbose</a> &amp;&amp; <a class="code" href="classERF.html#ad353aa9e275612ff2110c5a1405c1176">init_shrink</a> != 1.0) {</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;                Print() &lt;&lt; <span class="stringliteral">&quot;Timestep 0: shrink initial dt at level &quot;</span> &lt;&lt; lev &lt;&lt; <span class="stringliteral">&quot; by &quot;</span> &lt;&lt; <a class="code" href="classERF.html#ad353aa9e275612ff2110c5a1405c1176">init_shrink</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;            }</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        }</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    }</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="comment">// Limit dt&#39;s by the value of stop_time.</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keyword">const</span> Real eps = 1.e-3*dt_0;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0] + dt_0 &gt; <a class="code" href="classERF.html#a405556a52bef334ab68294c1a540e107">stop_time</a> - eps) {</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        dt_0 = <a class="code" href="classERF.html#a405556a52bef334ab68294c1a540e107">stop_time</a> - <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0];</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    }</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[0] = dt_0;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 1; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[lev] = <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[lev-1] / <a class="code" href="classERF.html#aa3db2dd1b65310c66c4038650c22aaee">nsubsteps</a>[lev];</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    }</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_a405556a52bef334ab68294c1a540e107"><div class="ttname"><a href="classERF.html#a405556a52bef334ab68294c1a540e107">ERF::stop_time</a></div><div class="ttdeci">amrex::Real stop_time</div><div class="ttdef"><b>Definition:</b> ERF.H:896</div></div>
<div class="ttc" id="aclassERF_html_a6b1d727e63de2e49aa4f8e00b0dda1d5"><div class="ttname"><a href="classERF.html#a6b1d727e63de2e49aa4f8e00b0dda1d5">ERF::estTimeStep</a></div><div class="ttdeci">amrex::Real estTimeStep(int lev, long &amp;dt_fast_ratio) const</div><div class="ttdef"><b>Definition:</b> ERF_ComputeTimestep.cpp:54</div></div>
<div class="ttc" id="aclassERF_html_aa3db2dd1b65310c66c4038650c22aaee"><div class="ttname"><a href="classERF.html#aa3db2dd1b65310c66c4038650c22aaee">ERF::nsubsteps</a></div><div class="ttdeci">amrex::Vector&lt; int &gt; nsubsteps</div><div class="ttdef"><b>Definition:</b> ERF.H:696</div></div>
<div class="ttc" id="aclassERF_html_ad353aa9e275612ff2110c5a1405c1176"><div class="ttname"><a href="classERF.html#ad353aa9e275612ff2110c5a1405c1176">ERF::init_shrink</a></div><div class="ttdeci">static amrex::Real init_shrink</div><div class="ttdef"><b>Definition:</b> ERF.H:907</div></div>
<div class="ttc" id="aclassERF_html_ae16d413b172bb3b3400af6d5cb236fd4"><div class="ttname"><a href="classERF.html#ae16d413b172bb3b3400af6d5cb236fd4">ERF::change_max</a></div><div class="ttdeci">static amrex::Real change_max</div><div class="ttdef"><b>Definition:</b> ERF.H:908</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aaad87d9eb7e20af21deb83d72f94801c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaad87d9eb7e20af21deb83d72f94801c">&#9670;&nbsp;</a></span>ComputeGhostCells()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static AMREX_FORCE_INLINE int ERF::ComputeGhostCells </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structSolverChoice.html">SolverChoice</a> &amp;&#160;</td>
          <td class="paramname"><em>sc</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    {</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;        <span class="keywordtype">int</span> ngrow = 0;</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160; </div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;        <span class="keywordflow">if</span> (sc.<a class="code" href="structSolverChoice.html#a8d039800497a1e5084afeef94d367932">use_num_diff</a>)</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;        {</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;            ngrow = 3;</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;            <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;                 (sc.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a81152997920406ea2aa97cbb5af2d9b6">dycore_horiz_adv_type</a>    == <a class="code" href="ERF__IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a8c9475eb6bfde28e5bcb5230ac2e22a9">AdvType::Centered_6th</a>)</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;              || (sc.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a2dd44749e2d4f224ae1da4f9e53e257a">dycore_vert_adv_type</a>     == <a class="code" href="ERF__IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a8c9475eb6bfde28e5bcb5230ac2e22a9">AdvType::Centered_6th</a>)</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;              || (sc.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a22f84c60e56d4b3bde6b7f9548c87af3">moistscal_horiz_adv_type</a> == <a class="code" href="ERF__IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a8c9475eb6bfde28e5bcb5230ac2e22a9">AdvType::Centered_6th</a>)</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;              || (sc.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a22f84c60e56d4b3bde6b7f9548c87af3">moistscal_horiz_adv_type</a> == <a class="code" href="ERF__IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a8c9475eb6bfde28e5bcb5230ac2e22a9">AdvType::Centered_6th</a>)</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;              || (sc.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a74a383e01c24980b72b920054ee5c1ab">dryscal_horiz_adv_type</a>   == <a class="code" href="ERF__IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a8c9475eb6bfde28e5bcb5230ac2e22a9">AdvType::Centered_6th</a>)</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;              || (sc.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#add9ddd5d61fc695bd2df0e3818767b78">dryscal_vert_adv_type</a>    == <a class="code" href="ERF__IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a8c9475eb6bfde28e5bcb5230ac2e22a9">AdvType::Centered_6th</a>) )</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;            { ngrow = 3; }</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;                 (sc.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a81152997920406ea2aa97cbb5af2d9b6">dycore_horiz_adv_type</a>    == <a class="code" href="ERF__IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a83aec89012c35752597047c6ebdd983a">AdvType::Upwind_5th</a>)</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;              || (sc.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a2dd44749e2d4f224ae1da4f9e53e257a">dycore_vert_adv_type</a>     == <a class="code" href="ERF__IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a83aec89012c35752597047c6ebdd983a">AdvType::Upwind_5th</a>)</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;              || (sc.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a22f84c60e56d4b3bde6b7f9548c87af3">moistscal_horiz_adv_type</a> == <a class="code" href="ERF__IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a83aec89012c35752597047c6ebdd983a">AdvType::Upwind_5th</a>)</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;              || (sc.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a22f84c60e56d4b3bde6b7f9548c87af3">moistscal_horiz_adv_type</a> == <a class="code" href="ERF__IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a83aec89012c35752597047c6ebdd983a">AdvType::Upwind_5th</a>)</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;              || (sc.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a74a383e01c24980b72b920054ee5c1ab">dryscal_horiz_adv_type</a>   == <a class="code" href="ERF__IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a83aec89012c35752597047c6ebdd983a">AdvType::Upwind_5th</a>)</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;              || (sc.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#add9ddd5d61fc695bd2df0e3818767b78">dryscal_vert_adv_type</a>    == <a class="code" href="ERF__IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a83aec89012c35752597047c6ebdd983a">AdvType::Upwind_5th</a>) )</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;            { ngrow = 3; }</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;                  (sc.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a74a383e01c24980b72b920054ee5c1ab">dryscal_horiz_adv_type</a>   == <a class="code" href="ERF__IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70af2429e8de544f3ebd7c9668e3dbebaa8">AdvType::Weno_5</a>)</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;               || (sc.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#add9ddd5d61fc695bd2df0e3818767b78">dryscal_vert_adv_type</a>    == <a class="code" href="ERF__IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70af2429e8de544f3ebd7c9668e3dbebaa8">AdvType::Weno_5</a>)</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;               || (sc.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a22f84c60e56d4b3bde6b7f9548c87af3">moistscal_horiz_adv_type</a> == <a class="code" href="ERF__IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70af2429e8de544f3ebd7c9668e3dbebaa8">AdvType::Weno_5</a>)</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;               || (sc.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a2f888dfcb79cdb766ee04f21aada83ec">moistscal_vert_adv_type</a>  == <a class="code" href="ERF__IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70af2429e8de544f3ebd7c9668e3dbebaa8">AdvType::Weno_5</a>)</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;               || (sc.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a22f84c60e56d4b3bde6b7f9548c87af3">moistscal_horiz_adv_type</a> == <a class="code" href="ERF__IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70aeb75f5943c7837da80e2048f2b344efc">AdvType::Weno_5Z</a>)</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;               || (sc.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a2f888dfcb79cdb766ee04f21aada83ec">moistscal_vert_adv_type</a>  == <a class="code" href="ERF__IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70aeb75f5943c7837da80e2048f2b344efc">AdvType::Weno_5Z</a>)</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;               || (sc.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a74a383e01c24980b72b920054ee5c1ab">dryscal_horiz_adv_type</a>   == <a class="code" href="ERF__IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70aeb75f5943c7837da80e2048f2b344efc">AdvType::Weno_5Z</a>)</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;               || (sc.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#add9ddd5d61fc695bd2df0e3818767b78">dryscal_vert_adv_type</a>    == <a class="code" href="ERF__IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70aeb75f5943c7837da80e2048f2b344efc">AdvType::Weno_5Z</a>) )</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;            { ngrow = 3; }</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;                  (sc.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a74a383e01c24980b72b920054ee5c1ab">dryscal_horiz_adv_type</a>   == <a class="code" href="ERF__IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a3095d588151e351b421893f62411d15e">AdvType::Weno_7</a>)</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;               || (sc.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#add9ddd5d61fc695bd2df0e3818767b78">dryscal_vert_adv_type</a>    == <a class="code" href="ERF__IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a3095d588151e351b421893f62411d15e">AdvType::Weno_7</a>)</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;               || (sc.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a22f84c60e56d4b3bde6b7f9548c87af3">moistscal_horiz_adv_type</a> == <a class="code" href="ERF__IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a3095d588151e351b421893f62411d15e">AdvType::Weno_7</a>)</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;               || (sc.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a2f888dfcb79cdb766ee04f21aada83ec">moistscal_vert_adv_type</a>  == <a class="code" href="ERF__IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a3095d588151e351b421893f62411d15e">AdvType::Weno_7</a>)</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;               || (sc.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a22f84c60e56d4b3bde6b7f9548c87af3">moistscal_horiz_adv_type</a> == <a class="code" href="ERF__IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a6edd20e2cefe2061bec0e1ebbf5c8573">AdvType::Weno_7Z</a>)</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;               || (sc.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a2f888dfcb79cdb766ee04f21aada83ec">moistscal_vert_adv_type</a>  == <a class="code" href="ERF__IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a6edd20e2cefe2061bec0e1ebbf5c8573">AdvType::Weno_7Z</a>)</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;               || (sc.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a74a383e01c24980b72b920054ee5c1ab">dryscal_horiz_adv_type</a>   == <a class="code" href="ERF__IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a6edd20e2cefe2061bec0e1ebbf5c8573">AdvType::Weno_7Z</a>)</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;               || (sc.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#add9ddd5d61fc695bd2df0e3818767b78">dryscal_vert_adv_type</a>    == <a class="code" href="ERF__IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a6edd20e2cefe2061bec0e1ebbf5c8573">AdvType::Weno_7Z</a>) )</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;            { ngrow = 4; }</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;            {</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;                <span class="keywordflow">if</span> (sc.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> == TerrainType::EB){</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;                    ngrow = 3;</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;                    ngrow = 2;</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;                }</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;            }</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;        }</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160; </div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;        <span class="keywordflow">return</span> ngrow;</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    }</div>
<div class="ttc" id="aERF__IndexDefines_8H_html_ada2d84e0dbbfb8d748defbf018748a70a3095d588151e351b421893f62411d15e"><div class="ttname"><a href="ERF__IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a3095d588151e351b421893f62411d15e">AdvType::Weno_7</a></div><div class="ttdeci">@ Weno_7</div></div>
<div class="ttc" id="aERF__IndexDefines_8H_html_ada2d84e0dbbfb8d748defbf018748a70a6edd20e2cefe2061bec0e1ebbf5c8573"><div class="ttname"><a href="ERF__IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a6edd20e2cefe2061bec0e1ebbf5c8573">AdvType::Weno_7Z</a></div><div class="ttdeci">@ Weno_7Z</div></div>
<div class="ttc" id="aERF__IndexDefines_8H_html_ada2d84e0dbbfb8d748defbf018748a70a83aec89012c35752597047c6ebdd983a"><div class="ttname"><a href="ERF__IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a83aec89012c35752597047c6ebdd983a">AdvType::Upwind_5th</a></div><div class="ttdeci">@ Upwind_5th</div></div>
<div class="ttc" id="aERF__IndexDefines_8H_html_ada2d84e0dbbfb8d748defbf018748a70a8c9475eb6bfde28e5bcb5230ac2e22a9"><div class="ttname"><a href="ERF__IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70a8c9475eb6bfde28e5bcb5230ac2e22a9">AdvType::Centered_6th</a></div><div class="ttdeci">@ Centered_6th</div></div>
<div class="ttc" id="aERF__IndexDefines_8H_html_ada2d84e0dbbfb8d748defbf018748a70aeb75f5943c7837da80e2048f2b344efc"><div class="ttname"><a href="ERF__IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70aeb75f5943c7837da80e2048f2b344efc">AdvType::Weno_5Z</a></div><div class="ttdeci">@ Weno_5Z</div></div>
<div class="ttc" id="aERF__IndexDefines_8H_html_ada2d84e0dbbfb8d748defbf018748a70af2429e8de544f3ebd7c9668e3dbebaa8"><div class="ttname"><a href="ERF__IndexDefines_8H.html#ada2d84e0dbbfb8d748defbf018748a70af2429e8de544f3ebd7c9668e3dbebaa8">AdvType::Weno_5</a></div><div class="ttdeci">@ Weno_5</div></div>
<div class="ttc" id="astructAdvChoice_html_a22f84c60e56d4b3bde6b7f9548c87af3"><div class="ttname"><a href="structAdvChoice.html#a22f84c60e56d4b3bde6b7f9548c87af3">AdvChoice::moistscal_horiz_adv_type</a></div><div class="ttdeci">AdvType moistscal_horiz_adv_type</div><div class="ttdef"><b>Definition:</b> ERF_AdvStruct.H:343</div></div>
<div class="ttc" id="astructAdvChoice_html_a2dd44749e2d4f224ae1da4f9e53e257a"><div class="ttname"><a href="structAdvChoice.html#a2dd44749e2d4f224ae1da4f9e53e257a">AdvChoice::dycore_vert_adv_type</a></div><div class="ttdeci">AdvType dycore_vert_adv_type</div><div class="ttdef"><b>Definition:</b> ERF_AdvStruct.H:340</div></div>
<div class="ttc" id="astructAdvChoice_html_a2f888dfcb79cdb766ee04f21aada83ec"><div class="ttname"><a href="structAdvChoice.html#a2f888dfcb79cdb766ee04f21aada83ec">AdvChoice::moistscal_vert_adv_type</a></div><div class="ttdeci">AdvType moistscal_vert_adv_type</div><div class="ttdef"><b>Definition:</b> ERF_AdvStruct.H:344</div></div>
<div class="ttc" id="astructAdvChoice_html_a74a383e01c24980b72b920054ee5c1ab"><div class="ttname"><a href="structAdvChoice.html#a74a383e01c24980b72b920054ee5c1ab">AdvChoice::dryscal_horiz_adv_type</a></div><div class="ttdeci">AdvType dryscal_horiz_adv_type</div><div class="ttdef"><b>Definition:</b> ERF_AdvStruct.H:341</div></div>
<div class="ttc" id="astructAdvChoice_html_a81152997920406ea2aa97cbb5af2d9b6"><div class="ttname"><a href="structAdvChoice.html#a81152997920406ea2aa97cbb5af2d9b6">AdvChoice::dycore_horiz_adv_type</a></div><div class="ttdeci">AdvType dycore_horiz_adv_type</div><div class="ttdef"><b>Definition:</b> ERF_AdvStruct.H:339</div></div>
<div class="ttc" id="astructAdvChoice_html_add9ddd5d61fc695bd2df0e3818767b78"><div class="ttname"><a href="structAdvChoice.html#add9ddd5d61fc695bd2df0e3818767b78">AdvChoice::dryscal_vert_adv_type</a></div><div class="ttdeci">AdvType dryscal_vert_adv_type</div><div class="ttdef"><b>Definition:</b> ERF_AdvStruct.H:342</div></div>
<div class="ttc" id="astructSolverChoice_html_aaadbd092e9e176b7f088c7992c866c6e"><div class="ttname"><a href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">SolverChoice::advChoice</a></div><div class="ttdeci">AdvChoice advChoice</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:716</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adc284f421c5fd9dd15c0e5cbe4ff5fc8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc284f421c5fd9dd15c0e5cbe4ff5fc8">&#9670;&nbsp;</a></span>Construct_ERFFillPatchers()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::Construct_ERFFillPatchers </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;{</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;    <span class="keyword">auto</span>&amp; fine_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev];</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;    <span class="keyword">auto</span>&amp; crse_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev-1];</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;    <span class="keyword">auto</span>&amp; ba_fine  = fine_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].boxArray();</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;    <span class="keyword">auto</span>&amp; ba_crse  = crse_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].boxArray();</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;    <span class="keyword">auto</span>&amp; dm_fine  = fine_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].DistributionMap();</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;    <span class="keyword">auto</span>&amp; dm_crse  = crse_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].DistributionMap();</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160; </div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;    <span class="keywordtype">int</span> ncomp = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nComp();</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160; </div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;    <a class="code" href="classERF.html#a34160ca20fb400ee285664117cb80512">FPr_c</a>.emplace_back(ba_fine, dm_fine, geom[lev]  ,</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;                       ba_crse, dm_crse, geom[lev-1],</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;                       -<a class="code" href="classERF.html#ad9084179f7384e10a519989ffd51fd34">cf_width</a>, -<a class="code" href="classERF.html#a1e3e2855b6e811596226c167573ad62d">cf_set_width</a>, ncomp, &amp;cell_cons_interp);</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;    <a class="code" href="classERF.html#a0ef3455d5b4fc9a178e023b233d389a4">FPr_u</a>.emplace_back(convert(ba_fine, IntVect(1,0,0)), dm_fine, geom[lev]  ,</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;                       convert(ba_crse, IntVect(1,0,0)), dm_crse, geom[lev-1],</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;                       -<a class="code" href="classERF.html#ad9084179f7384e10a519989ffd51fd34">cf_width</a>, -<a class="code" href="classERF.html#a1e3e2855b6e811596226c167573ad62d">cf_set_width</a>, 1, &amp;face_cons_linear_interp);</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;    <a class="code" href="classERF.html#a1dc7086aec533a042e6033706845b0c3">FPr_v</a>.emplace_back(convert(ba_fine, IntVect(0,1,0)), dm_fine, geom[lev]  ,</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;                       convert(ba_crse, IntVect(0,1,0)), dm_crse, geom[lev-1],</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;                       -<a class="code" href="classERF.html#ad9084179f7384e10a519989ffd51fd34">cf_width</a>, -<a class="code" href="classERF.html#a1e3e2855b6e811596226c167573ad62d">cf_set_width</a>, 1, &amp;face_cons_linear_interp);</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;    <a class="code" href="classERF.html#ac9a11403c2238d0d1e7b65b2d100dbaf">FPr_w</a>.emplace_back(convert(ba_fine, IntVect(0,0,1)), dm_fine, geom[lev]  ,</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;                       convert(ba_crse, IntVect(0,0,1)), dm_crse, geom[lev-1],</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;                       -<a class="code" href="classERF.html#ad9084179f7384e10a519989ffd51fd34">cf_width</a>, -<a class="code" href="classERF.html#a1e3e2855b6e811596226c167573ad62d">cf_set_width</a>, 1, &amp;face_cons_linear_interp);</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_a1e3e2855b6e811596226c167573ad62d"><div class="ttname"><a href="classERF.html#a1e3e2855b6e811596226c167573ad62d">ERF::cf_set_width</a></div><div class="ttdeci">int cf_set_width</div><div class="ttdef"><b>Definition:</b> ERF.H:777</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa2c3ee1910008b828b9da79ccdfe3871"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2c3ee1910008b828b9da79ccdfe3871">&#9670;&nbsp;</a></span>DataLog()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">AMREX_FORCE_INLINE std::ostream&amp; ERF::DataLog </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    {</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;        <span class="keywordflow">return</span> *<a class="code" href="classERF.html#a1cade630b005dbcc0f644987ef3db287">datalog</a>[i];</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    }</div>
<div class="ttc" id="aclassERF_html_a1cade630b005dbcc0f644987ef3db287"><div class="ttname"><a href="classERF.html#a1cade630b005dbcc0f644987ef3db287">ERF::datalog</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; std::fstream &gt; &gt; datalog</div><div class="ttdef"><b>Definition:</b> ERF.H:1414</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a16e1f6b8bbb05ae738daf2abe626c159"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16e1f6b8bbb05ae738daf2abe626c159">&#9670;&nbsp;</a></span>DataLogName()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ERF::DataLogName </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The filename of the ith datalog file. </p>
<div class="fragment"><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classERF.html#a9248a4eb025c2647e003f838cba52a21">datalogname</a>[i]; }</div>
<div class="ttc" id="aclassERF_html_a9248a4eb025c2647e003f838cba52a21"><div class="ttname"><a href="classERF.html#a9248a4eb025c2647e003f838cba52a21">ERF::datalogname</a></div><div class="ttdeci">amrex::Vector&lt; std::string &gt; datalogname</div><div class="ttdef"><b>Definition:</b> ERF.H:1417</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac0951404aa6802aad7a3be6b7375dfa2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0951404aa6802aad7a3be6b7375dfa2">&#9670;&nbsp;</a></span>Define_ERFFillPatchers()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::Define_ERFFillPatchers </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;{</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;    <span class="keyword">auto</span>&amp; fine_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev];</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;    <span class="keyword">auto</span>&amp; crse_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev-1];</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;    <span class="keyword">auto</span>&amp; ba_fine  = fine_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].boxArray();</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;    <span class="keyword">auto</span>&amp; ba_crse  = crse_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].boxArray();</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;    <span class="keyword">auto</span>&amp; dm_fine  = fine_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].DistributionMap();</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;    <span class="keyword">auto</span>&amp; dm_crse  = crse_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].DistributionMap();</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160; </div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;    <span class="keywordtype">int</span> ncomp = fine_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nComp();</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160; </div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;    <a class="code" href="classERF.html#a34160ca20fb400ee285664117cb80512">FPr_c</a>[lev-1].Define(ba_fine, dm_fine, geom[lev]  ,</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;                        ba_crse, dm_crse, geom[lev-1],</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;                        -<a class="code" href="classERF.html#ad9084179f7384e10a519989ffd51fd34">cf_width</a>, -<a class="code" href="classERF.html#a1e3e2855b6e811596226c167573ad62d">cf_set_width</a>, ncomp, &amp;cell_cons_interp);</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;    <a class="code" href="classERF.html#a0ef3455d5b4fc9a178e023b233d389a4">FPr_u</a>[lev-1].Define(convert(ba_fine, IntVect(1,0,0)), dm_fine, geom[lev]  ,</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;                        convert(ba_crse, IntVect(1,0,0)), dm_crse, geom[lev-1],</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;                        -<a class="code" href="classERF.html#ad9084179f7384e10a519989ffd51fd34">cf_width</a>, -<a class="code" href="classERF.html#a1e3e2855b6e811596226c167573ad62d">cf_set_width</a>, 1, &amp;face_cons_linear_interp);</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;    <a class="code" href="classERF.html#a1dc7086aec533a042e6033706845b0c3">FPr_v</a>[lev-1].Define(convert(ba_fine, IntVect(0,1,0)), dm_fine, geom[lev]  ,</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;                        convert(ba_crse, IntVect(0,1,0)), dm_crse, geom[lev-1],</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;                        -<a class="code" href="classERF.html#ad9084179f7384e10a519989ffd51fd34">cf_width</a>, -<a class="code" href="classERF.html#a1e3e2855b6e811596226c167573ad62d">cf_set_width</a>, 1, &amp;face_cons_linear_interp);</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;    <a class="code" href="classERF.html#ac9a11403c2238d0d1e7b65b2d100dbaf">FPr_w</a>[lev-1].Define(convert(ba_fine, IntVect(0,0,1)), dm_fine, geom[lev]  ,</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;                        convert(ba_crse, IntVect(0,0,1)), dm_crse, geom[lev-1],</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;                        -<a class="code" href="classERF.html#ad9084179f7384e10a519989ffd51fd34">cf_width</a>, -<a class="code" href="classERF.html#a1e3e2855b6e811596226c167573ad62d">cf_set_width</a>, 1, &amp;face_cons_linear_interp);</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a07b6ef88ba692152c19381858e2a639e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07b6ef88ba692152c19381858e2a639e">&#9670;&nbsp;</a></span>DerDataLog()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">AMREX_FORCE_INLINE std::ostream&amp; ERF::DerDataLog </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    {</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;        <span class="keywordflow">return</span> *<a class="code" href="classERF.html#ab33e7fff801543a43961ca6d7cac818f">der_datalog</a>[i];</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    }</div>
<div class="ttc" id="aclassERF_html_ab33e7fff801543a43961ca6d7cac818f"><div class="ttname"><a href="classERF.html#ab33e7fff801543a43961ca6d7cac818f">ERF::der_datalog</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; std::fstream &gt; &gt; der_datalog</div><div class="ttdef"><b>Definition:</b> ERF.H:1415</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a686848a6c86017d484dc204cee7d979f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a686848a6c86017d484dc204cee7d979f">&#9670;&nbsp;</a></span>DerDataLogName()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ERF::DerDataLogName </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classERF.html#a9e7650abd3df579a98be0c750aa61ba8">der_datalogname</a>[i]; }</div>
<div class="ttc" id="aclassERF_html_a9e7650abd3df579a98be0c750aa61ba8"><div class="ttname"><a href="classERF.html#a9e7650abd3df579a98be0c750aa61ba8">ERF::der_datalogname</a></div><div class="ttdeci">amrex::Vector&lt; std::string &gt; der_datalogname</div><div class="ttdef"><b>Definition:</b> ERF.H:1418</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab5b66549344d8b04b126fa0ef16c7ca2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5b66549344d8b04b126fa0ef16c7ca2">&#9670;&nbsp;</a></span>derive_diag_profiles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::derive_diag_profiles </td>
          <td>(</td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_rho</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_th</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_ksgs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_Kmv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_Khv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_qv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_qc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_qr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_wqv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_wqc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_wqr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_qi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_qs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_qg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_uu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_uv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_uw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_vv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_vw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_ww</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_uth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_vth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_wth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_thth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_ku</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_kv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_kw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_pu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_pv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_pw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_wthv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Computes the profiles for diagnostic quantities.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">h_avg_u</td><td>Profile for x-velocity on Host </td></tr>
    <tr><td class="paramname">h_avg_v</td><td>Profile for y-velocity on Host </td></tr>
    <tr><td class="paramname">h_avg_w</td><td>Profile for z-velocity on Host </td></tr>
    <tr><td class="paramname">h_avg_rho</td><td>Profile for density on Host </td></tr>
    <tr><td class="paramname">h_avg_th</td><td>Profile for potential temperature on Host </td></tr>
    <tr><td class="paramname">h_avg_ksgs</td><td>Profile for Kinetic Energy on Host </td></tr>
    <tr><td class="paramname">h_avg_uu</td><td>Profile for x-velocity squared on Host </td></tr>
    <tr><td class="paramname">h_avg_uv</td><td>Profile for x-velocity * y-velocity on Host </td></tr>
    <tr><td class="paramname">h_avg_uw</td><td>Profile for x-velocity * z-velocity on Host </td></tr>
    <tr><td class="paramname">h_avg_vv</td><td>Profile for y-velocity squared on Host </td></tr>
    <tr><td class="paramname">h_avg_vw</td><td>Profile for y-velocity * z-velocity on Host </td></tr>
    <tr><td class="paramname">h_avg_ww</td><td>Profile for z-velocity squared on Host </td></tr>
    <tr><td class="paramname">h_avg_uth</td><td>Profile for x-velocity * potential temperature on Host </td></tr>
    <tr><td class="paramname">h_avg_uiuiu</td><td>Profile for u_i*u_i*u triple product on Host </td></tr>
    <tr><td class="paramname">h_avg_uiuiv</td><td>Profile for u_i*u_i*v triple product on Host </td></tr>
    <tr><td class="paramname">h_avg_uiuiw</td><td>Profile for u_i*u_i*w triple product on Host </td></tr>
    <tr><td class="paramname">h_avg_p</td><td>Profile for pressure perturbation on Host </td></tr>
    <tr><td class="paramname">h_avg_pu</td><td>Profile for pressure perturbation * x-velocity on Host </td></tr>
    <tr><td class="paramname">h_avg_pv</td><td>Profile for pressure perturbation * y-velocity on Host </td></tr>
    <tr><td class="paramname">h_avg_pw</td><td>Profile for pressure perturbation * z-velocity on Host </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;{</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="comment">// We assume that this is always called at level 0</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordtype">int</span> lev = 0;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keywordtype">bool</span> l_use_kturb = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa53b017d79e0067923180a0aa59367b4">turbChoice</a>[lev].use_kturb;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keywordtype">bool</span> l_use_KE    = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa53b017d79e0067923180a0aa59367b4">turbChoice</a>[lev].use_tke;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="comment">// This will hold rho, theta, ksgs, Kmh, Kmv, uu, uv, uw, vv, vw, ww, uth, vth, wth,</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="comment">//                  0      1     2    3    4   5   6   7   8   9  10   11   12   13</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="comment">//                thth, uiuiu, uiuiv, uiuiw, p, pu, pv, pw, qv, qc, qr, wqv, wqc, wqr,</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="comment">//                  14     15     16     17 18  19  20  21  22  23  24   25   26   27</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="comment">//                  qi, qs, qg, wthv</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="comment">//                  28  29  30    31</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    MultiFab mf_out(grids[lev], dmap[lev], 32, 0);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    MultiFab mf_vels(grids[lev], dmap[lev], AMREX_SPACEDIM, 0);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    MultiFab  u_cc(mf_vels, make_alias, 0, 1); <span class="comment">// u at cell centers</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    MultiFab  v_cc(mf_vels, make_alias, 1, 1); <span class="comment">// v at cell centers</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    MultiFab  w_cc(mf_vels, make_alias, 2, 1); <span class="comment">// w at cell centers</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    average_face_to_cellcenter(mf_vels,0,</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        Array&lt;const MultiFab*,3&gt;{&amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],&amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],&amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>]});</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keywordtype">int</span> zdir = 2;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keyword">auto</span> domain = geom[0].Domain();</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="comment">// Sum in the horizontal plane</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    h_avg_u  = sumToLine(mf_vels ,0,1,domain,zdir);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    h_avg_v  = sumToLine(mf_vels ,1,1,domain,zdir);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    h_avg_w  = sumToLine(mf_vels ,2,1,domain,zdir);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordtype">int</span> hu_size =  h_avg_u.size();</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="comment">// Divide by the total number of cells we are averaging over</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    Real area_z = <span class="keyword">static_cast&lt;</span>Real<span class="keyword">&gt;</span>(domain.length(0)*domain.length(1));</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; hu_size; ++k) {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        h_avg_u[k] /= area_z; h_avg_v[k] /= area_z; h_avg_w[k] /= area_z;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    }</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160; </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    Gpu::DeviceVector&lt;Real&gt; d_avg_u(hu_size, Real(0.0));</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    Gpu::DeviceVector&lt;Real&gt; d_avg_v(hu_size, Real(0.0));</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    Gpu::DeviceVector&lt;Real&gt; d_avg_w(hu_size, Real(0.0));</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="preprocessor">#if 0</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keyword">auto</span>* avg_u_ptr = d_avg_u.data();</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keyword">auto</span>* avg_v_ptr = d_avg_v.data();</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keyword">auto</span>* avg_w_ptr = d_avg_w.data();</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    Gpu::copy(Gpu::hostToDevice, h_avg_u.begin(), h_avg_u.end(), d_avg_u.begin());</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    Gpu::copy(Gpu::hostToDevice, h_avg_v.begin(), h_avg_v.end(), d_avg_v.begin());</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    Gpu::copy(Gpu::hostToDevice, h_avg_w.begin(), h_avg_w.end(), d_avg_w.begin());</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="ERF__DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a7c3c83d6fcec1f134956c3160adf6e39">nvars</a> = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nComp();</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    MultiFab mf_cons(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], make_alias, 0, <a class="code" href="ERF__DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a7c3c83d6fcec1f134956c3160adf6e39">nvars</a>);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    MultiFab p_hse (<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev], make_alias, <a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91aa8253dc5484f2621e0bf8d51d98d635e">BaseState::p0_comp</a>, 1);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160; </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordtype">bool</span> use_moisture = (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> != MoistureType::None);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160; </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keywordflow">for</span> ( MFIter mfi(mf_cons,TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    {</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        <span class="keyword">const</span> Array4&lt;Real&gt;&amp; fab_arr = mf_out.array(mfi);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="keyword">const</span> Array4&lt;Real&gt;&amp; u_cc_arr =  u_cc.array(mfi);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="keyword">const</span> Array4&lt;Real&gt;&amp; v_cc_arr =  v_cc.array(mfi);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <span class="keyword">const</span> Array4&lt;Real&gt;&amp; w_cc_arr =  w_cc.array(mfi);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="keyword">const</span> Array4&lt;Real&gt;&amp; cons_arr = mf_cons.array(mfi);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="keyword">const</span> Array4&lt;Real&gt;&amp;   p0_arr = p_hse.array(mfi);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <span class="keyword">const</span> Array4&lt;const Real&gt;&amp; eta_arr = (l_use_kturb) ? <a class="code" href="classERF.html#a327d704704abd516be19339cb2d226f9">eddyDiffs_lev</a>[lev]-&gt;const_array(mfi) :</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                                                            Array4&lt;const Real&gt;{};</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            Real <a class="code" href="namespaceLsmVar__MM5.html#afa778fa40619fb72857b168906e39080af198df5800148ff3680d005b5fb09c68">theta</a> = cons_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>) / cons_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            fab_arr(i, j, k, 0) = cons_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            fab_arr(i, j, k, 1) = <a class="code" href="namespaceLsmVar__MM5.html#afa778fa40619fb72857b168906e39080af198df5800148ff3680d005b5fb09c68">theta</a>;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            Real ksgs = 0.0;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            <span class="keywordflow">if</span> (l_use_KE) {</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                ksgs = cons_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#ae15721db2cb4c2ab4732afe226bbba64">RhoKE_comp</a>) / cons_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            }</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            fab_arr(i, j, k, 2) = ksgs;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="preprocessor">#if 1</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;            <span class="keywordflow">if</span> (l_use_kturb) {</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                fab_arr(i, j, k, 3) = eta_arr(i,j,k,<a class="code" href="namespaceEddyDiff.html#a3f912b3dbcd18dd6f4f0a85815a3ce47a61ed124b350a1b26da1bd26aebfa5f82">EddyDiff::Mom_v</a>); <span class="comment">// Kmv</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                fab_arr(i, j, k, 4) = eta_arr(i,j,k,<a class="code" href="namespaceEddyDiff.html#a3f912b3dbcd18dd6f4f0a85815a3ce47a0af64d676c5c6f4312eb892f9a7a46cd">EddyDiff::Theta_v</a>); <span class="comment">// Khv</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                fab_arr(i, j, k, 3) = 0.0;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                fab_arr(i, j, k, 4) = 0.0;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            }</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            <span class="comment">// Here we hijack the &quot;Kturb&quot; variable name to print out the resolved kinetic energy</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            Real upert = u_cc_arr(i,j,k) - avg_u_ptr[k];</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            Real vpert = v_cc_arr(i,j,k) - avg_v_ptr[k];</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            Real wpert = w_cc_arr(i,j,k) - avg_w_ptr[k];</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            fab_arr(i, j, k, 3) = 0.5 * (upert*upert + vpert*vpert + wpert*wpert);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            fab_arr(i, j, k, 5) = u_cc_arr(i,j,k) * u_cc_arr(i,j,k);   <span class="comment">// u*u</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            fab_arr(i, j, k, 6) = u_cc_arr(i,j,k) * v_cc_arr(i,j,k);   <span class="comment">// u*v</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            fab_arr(i, j, k, 7) = u_cc_arr(i,j,k) * w_cc_arr(i,j,k);   <span class="comment">// u*w</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;            fab_arr(i, j, k, 8) = v_cc_arr(i,j,k) * v_cc_arr(i,j,k);   <span class="comment">// v*v</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            fab_arr(i, j, k, 9) = v_cc_arr(i,j,k) * w_cc_arr(i,j,k);   <span class="comment">// v*w</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            fab_arr(i, j, k,10) = w_cc_arr(i,j,k) * w_cc_arr(i,j,k);   <span class="comment">// w*w</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            fab_arr(i, j, k,11) = u_cc_arr(i,j,k) * <a class="code" href="namespaceLsmVar__MM5.html#afa778fa40619fb72857b168906e39080af198df5800148ff3680d005b5fb09c68">theta</a>; <span class="comment">// u*th</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            fab_arr(i, j, k,12) = v_cc_arr(i,j,k) * <a class="code" href="namespaceLsmVar__MM5.html#afa778fa40619fb72857b168906e39080af198df5800148ff3680d005b5fb09c68">theta</a>; <span class="comment">// v*th</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            fab_arr(i, j, k,13) = w_cc_arr(i,j,k) * <a class="code" href="namespaceLsmVar__MM5.html#afa778fa40619fb72857b168906e39080af198df5800148ff3680d005b5fb09c68">theta</a>; <span class="comment">// w*th</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;            fab_arr(i, j, k,14) = <a class="code" href="namespaceLsmVar__MM5.html#afa778fa40619fb72857b168906e39080af198df5800148ff3680d005b5fb09c68">theta</a> * <a class="code" href="namespaceLsmVar__MM5.html#afa778fa40619fb72857b168906e39080af198df5800148ff3680d005b5fb09c68">theta</a>;           <span class="comment">// th*th</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            <span class="comment">// if the number of fields is changed above, then be sure to update</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            <span class="comment">// the following def!</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            Real uiui = fab_arr(i,j,k,5) + fab_arr(i,j,k,8) + fab_arr(i,j,k,10);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            fab_arr(i, j, k,15) = uiui * u_cc_arr(i,j,k);   <span class="comment">// (ui*ui)*u</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;            fab_arr(i, j, k,16) = uiui * v_cc_arr(i,j,k);   <span class="comment">// (ui*ui)*v</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            fab_arr(i, j, k,17) = uiui * w_cc_arr(i,j,k);   <span class="comment">// (ui*ui)*w</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160; </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            <span class="keywordflow">if</span> (!use_moisture) {</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                Real p = <a class="code" href="ERF__EOS_8H.html#a08354ab110fb9e873bce9250b4f4b46e">getPgivenRTh</a>(cons_arr(i, j, k, <a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>));</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                p -= p0_arr(i,j,k);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                fab_arr(i, j, k,18) = p;                       <span class="comment">// p</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                fab_arr(i, j, k,19) = p * u_cc_arr(i,j,k);     <span class="comment">// p*u</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                fab_arr(i, j, k,20) = p * v_cc_arr(i,j,k);     <span class="comment">// p*v</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                fab_arr(i, j, k,21) = p * w_cc_arr(i,j,k);     <span class="comment">// p*w</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                fab_arr(i, j, k,22) = 0.;  <span class="comment">// qv</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                fab_arr(i, j, k,23) = 0.;  <span class="comment">// qc</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                fab_arr(i, j, k,24) = 0.;  <span class="comment">// qr</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                fab_arr(i, j, k,25) = 0.;  <span class="comment">// w*qv</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                fab_arr(i, j, k,26) = 0.;  <span class="comment">// w*qc</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                fab_arr(i, j, k,27) = 0.;  <span class="comment">// w*qr</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                fab_arr(i, j, k,28) = 0.;  <span class="comment">// qi</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                fab_arr(i, j, k,29) = 0.;  <span class="comment">// qs</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                fab_arr(i, j, k,30) = 0.;  <span class="comment">// qg</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                fab_arr(i, j, k,31) = 0.;  <span class="comment">// w*thv</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            }</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        });</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    } <span class="comment">// mfi</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keywordflow">if</span> (use_moisture)</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    {</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <span class="keywordtype">int</span> n_qstate_moist = <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;Get_Qstate_Moist_Size();</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <span class="keywordflow">for</span> ( MFIter mfi(mf_cons,TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        {</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;            <span class="keyword">const</span> Array4&lt;Real&gt;&amp; fab_arr  = mf_out.array(mfi);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            <span class="keyword">const</span> Array4&lt;Real&gt;&amp; cons_arr = mf_cons.array(mfi);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;            <span class="keyword">const</span> Array4&lt;Real&gt;&amp; u_cc_arr =  u_cc.array(mfi);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;            <span class="keyword">const</span> Array4&lt;Real&gt;&amp; v_cc_arr =  v_cc.array(mfi);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;            <span class="keyword">const</span> Array4&lt;Real&gt;&amp; w_cc_arr =  w_cc.array(mfi);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            <span class="keyword">const</span> Array4&lt;Real&gt;&amp;   p0_arr = p_hse.array(mfi);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160; </div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            <span class="keywordtype">int</span> rhoqr_comp = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a1d9237205fd632dcde1599511f203131">RhoQr_comp</a>;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160; </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            {</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                Real <a class="code" href="namespaceMicVar__Kess.html#ad5e2303f8f4cbf19829306f4a72d61a7af099273d19f4b8cdca199c5177231e35">qv</a> = cons_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#aa965e9988f14d5d2a5aef4a942168a15">RhoQ1_comp</a>) / cons_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                Real <a class="code" href="namespaceMicVar__SatAdj.html#ac2be1e5fc951d23f27b621bed9836c16aea3777efcbbb3712ce373924287c2cb3">qc</a> = cons_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#a3bf0a4783e82ba30db2b7c0a332c2f16">RhoQ2_comp</a>) / cons_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                Real qr = (rhoqr_comp &gt; -1) ?  cons_arr(i,j,k,rhoqr_comp) / cons_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>) :</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                                               Real(0.0);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                Real p  = <a class="code" href="ERF__EOS_8H.html#a08354ab110fb9e873bce9250b4f4b46e">getPgivenRTh</a>(cons_arr(i, j, k, <a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>), <a class="code" href="namespaceMicVar__Kess.html#ad5e2303f8f4cbf19829306f4a72d61a7af099273d19f4b8cdca199c5177231e35">qv</a>);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                p -= p0_arr(i,j,k);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                fab_arr(i, j, k,18) = p;                       <span class="comment">// p</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                fab_arr(i, j, k,19) = p * u_cc_arr(i,j,k);     <span class="comment">// p*u</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                fab_arr(i, j, k,20) = p * v_cc_arr(i,j,k);     <span class="comment">// p*v</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                fab_arr(i, j, k,21) = p * w_cc_arr(i,j,k);     <span class="comment">// p*w</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                fab_arr(i, j, k,22) = <a class="code" href="namespaceMicVar__Kess.html#ad5e2303f8f4cbf19829306f4a72d61a7af099273d19f4b8cdca199c5177231e35">qv</a>;  <span class="comment">// qv</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                fab_arr(i, j, k,23) = <a class="code" href="namespaceMicVar__SatAdj.html#ac2be1e5fc951d23f27b621bed9836c16aea3777efcbbb3712ce373924287c2cb3">qc</a>;  <span class="comment">// qc</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                fab_arr(i, j, k,24) = qr;  <span class="comment">// qr</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                fab_arr(i, j, k,25) = w_cc_arr(i,j,k) * <a class="code" href="namespaceMicVar__Kess.html#ad5e2303f8f4cbf19829306f4a72d61a7af099273d19f4b8cdca199c5177231e35">qv</a>;  <span class="comment">// w*qv</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                fab_arr(i, j, k,26) = w_cc_arr(i,j,k) * <a class="code" href="namespaceMicVar__SatAdj.html#ac2be1e5fc951d23f27b621bed9836c16aea3777efcbbb3712ce373924287c2cb3">qc</a>;  <span class="comment">// w*qc</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                fab_arr(i, j, k,27) = w_cc_arr(i,j,k) * qr;  <span class="comment">// w*qr</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                <span class="keywordflow">if</span> (n_qstate_moist &gt; 3) {</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                    fab_arr(i, j, k,28) = cons_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#a49fe20d81f4d923a4a6ec4eb1652072b">RhoQ3_comp</a>) / cons_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>);  <span class="comment">// qi</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                    fab_arr(i, j, k,29) = cons_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#ac46d015fd5b1ee0060bbaf22e79113e7">RhoQ5_comp</a>) / cons_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>);  <span class="comment">// qs</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                    fab_arr(i, j, k,30) = cons_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#aae057dae5f599b944184a0ecf7801064">RhoQ6_comp</a>) / cons_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>);  <span class="comment">// qg</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                    fab_arr(i, j, k,28) = 0.0;  <span class="comment">// qi</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                    fab_arr(i, j, k,29) = 0.0;  <span class="comment">// qs</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                    fab_arr(i, j, k,30) = 0.0;  <span class="comment">// qg</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                }</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                Real ql    = <a class="code" href="namespaceMicVar__SatAdj.html#ac2be1e5fc951d23f27b621bed9836c16aea3777efcbbb3712ce373924287c2cb3">qc</a> + qr;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                Real <a class="code" href="namespaceLsmVar__MM5.html#afa778fa40619fb72857b168906e39080af198df5800148ff3680d005b5fb09c68">theta</a> = cons_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>) / cons_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                Real thv   = <a class="code" href="namespaceLsmVar__MM5.html#afa778fa40619fb72857b168906e39080af198df5800148ff3680d005b5fb09c68">theta</a> * (1 + 0.61*<a class="code" href="namespaceMicVar__Kess.html#ad5e2303f8f4cbf19829306f4a72d61a7af099273d19f4b8cdca199c5177231e35">qv</a> - ql);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                fab_arr(i, j, k,31) = w_cc_arr(i,j,k) * thv; <span class="comment">// w*thv</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;            });</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        } <span class="comment">// mfi</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    } <span class="comment">// use_moisture</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160; </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    h_avg_rho   = sumToLine(mf_out, 0,1,domain,zdir);</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    h_avg_th    = sumToLine(mf_out, 1,1,domain,zdir);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    h_avg_ksgs  = sumToLine(mf_out, 2,1,domain,zdir);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    h_avg_Kmv   = sumToLine(mf_out, 3,1,domain,zdir);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    h_avg_Khv   = sumToLine(mf_out, 4,1,domain,zdir);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    h_avg_uu    = sumToLine(mf_out, 5,1,domain,zdir);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    h_avg_uv    = sumToLine(mf_out, 6,1,domain,zdir);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    h_avg_uw    = sumToLine(mf_out, 7,1,domain,zdir);</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    h_avg_vv    = sumToLine(mf_out, 8,1,domain,zdir);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    h_avg_vw    = sumToLine(mf_out, 9,1,domain,zdir);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    h_avg_ww    = sumToLine(mf_out,10,1,domain,zdir);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    h_avg_uth   = sumToLine(mf_out,11,1,domain,zdir);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    h_avg_vth   = sumToLine(mf_out,12,1,domain,zdir);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    h_avg_wth   = sumToLine(mf_out,13,1,domain,zdir);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    h_avg_thth  = sumToLine(mf_out,14,1,domain,zdir);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    h_avg_uiuiu = sumToLine(mf_out,15,1,domain,zdir);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    h_avg_uiuiv = sumToLine(mf_out,16,1,domain,zdir);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    h_avg_uiuiw = sumToLine(mf_out,17,1,domain,zdir);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    h_avg_p     = sumToLine(mf_out,18,1,domain,zdir);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    h_avg_pu    = sumToLine(mf_out,19,1,domain,zdir);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    h_avg_pv    = sumToLine(mf_out,20,1,domain,zdir);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    h_avg_pw    = sumToLine(mf_out,21,1,domain,zdir);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    h_avg_qv    = sumToLine(mf_out,22,1,domain,zdir);</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    h_avg_qc    = sumToLine(mf_out,23,1,domain,zdir);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    h_avg_qr    = sumToLine(mf_out,24,1,domain,zdir);</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    h_avg_wqv   = sumToLine(mf_out,25,1,domain,zdir);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    h_avg_wqc   = sumToLine(mf_out,26,1,domain,zdir);</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    h_avg_wqr   = sumToLine(mf_out,27,1,domain,zdir);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    h_avg_qi    = sumToLine(mf_out,28,1,domain,zdir);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    h_avg_qs    = sumToLine(mf_out,29,1,domain,zdir);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    h_avg_qg    = sumToLine(mf_out,30,1,domain,zdir);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    h_avg_wthv  = sumToLine(mf_out,31,1,domain,zdir);</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160; </div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="comment">// Divide by the total number of cells we are averaging over</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="keywordtype">int</span> h_avg_u_size = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(h_avg_u.size());</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; h_avg_u_size; ++k) {</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        h_avg_rho[k] /= area_z;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        h_avg_ksgs[k]  /= area_z;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        h_avg_Kmv[k]   /= area_z;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        h_avg_Khv[k]   /= area_z;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        h_avg_th[k]    /= area_z;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        h_avg_thth[k]  /= area_z;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        h_avg_uu[k]    /= area_z;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        h_avg_uv[k]    /= area_z;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        h_avg_uw[k]    /= area_z;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        h_avg_vv[k]    /= area_z;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        h_avg_vw[k]    /= area_z;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        h_avg_ww[k]    /= area_z;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        h_avg_uth[k]   /= area_z;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        h_avg_vth[k]   /= area_z;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        h_avg_wth[k]   /= area_z;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        h_avg_uiuiu[k] /= area_z;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        h_avg_uiuiv[k] /= area_z;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        h_avg_uiuiw[k] /= area_z;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        h_avg_p[k]     /= area_z;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        h_avg_pu[k]    /= area_z;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        h_avg_pv[k]    /= area_z;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        h_avg_pw[k]    /= area_z;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        h_avg_qv[k]    /= area_z;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        h_avg_qc[k]    /= area_z;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        h_avg_qr[k]    /= area_z;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        h_avg_wqv[k]   /= area_z;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        h_avg_wqc[k]   /= area_z;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        h_avg_wqr[k]   /= area_z;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        h_avg_qi[k]    /= area_z;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        h_avg_qs[k]    /= area_z;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        h_avg_qg[k]    /= area_z;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        h_avg_wthv[k]  /= area_z;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    }</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160; </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="preprocessor">#if 0</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="comment">// Here we print the integrated total kinetic energy as computed in the 1D profile above</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    Real sum = 0.;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    Real dz = geom[0].ProbHi(2) / <span class="keyword">static_cast&lt;</span>Real<span class="keyword">&gt;</span>(h_avg_u_size);</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; h_avg_u_size; ++k) {</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        sum += h_avg_kturb[k] * h_avg_rho[k] * dz;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    }</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    amrex::Print() &lt;&lt; <span class="stringliteral">&quot;ITKE &quot;</span> &lt;&lt; time &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; sum &lt;&lt; <span class="stringliteral">&quot; using &quot;</span> &lt;&lt; h_avg_u_size &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; dz &lt;&lt; std::endl;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;}</div>
<div class="ttc" id="aERF__EOS_8H_html_a08354ab110fb9e873bce9250b4f4b46e"><div class="ttname"><a href="ERF__EOS_8H.html#a08354ab110fb9e873bce9250b4f4b46e">getPgivenRTh</a></div><div class="ttdeci">AMREX_GPU_HOST_DEVICE AMREX_FORCE_INLINE amrex::Real getPgivenRTh(const amrex::Real rhotheta, const amrex::Real qv=0.)</div><div class="ttdef"><b>Definition:</b> ERF_EOS.H:84</div></div>
<div class="ttc" id="aERF__IndexDefines_8H_html_a49fe20d81f4d923a4a6ec4eb1652072b"><div class="ttname"><a href="ERF__IndexDefines_8H.html#a49fe20d81f4d923a4a6ec4eb1652072b">RhoQ3_comp</a></div><div class="ttdeci">#define RhoQ3_comp</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:44</div></div>
<div class="ttc" id="aERF__IndexDefines_8H_html_aae057dae5f599b944184a0ecf7801064"><div class="ttname"><a href="ERF__IndexDefines_8H.html#aae057dae5f599b944184a0ecf7801064">RhoQ6_comp</a></div><div class="ttdeci">#define RhoQ6_comp</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:47</div></div>
<div class="ttc" id="aERF__IndexDefines_8H_html_ac46d015fd5b1ee0060bbaf22e79113e7"><div class="ttname"><a href="ERF__IndexDefines_8H.html#ac46d015fd5b1ee0060bbaf22e79113e7">RhoQ5_comp</a></div><div class="ttdeci">#define RhoQ5_comp</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:46</div></div>
<div class="ttc" id="aERF__IndexDefines_8H_html_ae15721db2cb4c2ab4732afe226bbba64"><div class="ttname"><a href="ERF__IndexDefines_8H.html#ae15721db2cb4c2ab4732afe226bbba64">RhoKE_comp</a></div><div class="ttdeci">#define RhoKE_comp</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:38</div></div>
<div class="ttc" id="anamespaceEddyDiff_html_a3f912b3dbcd18dd6f4f0a85815a3ce47a0af64d676c5c6f4312eb892f9a7a46cd"><div class="ttname"><a href="namespaceEddyDiff.html#a3f912b3dbcd18dd6f4f0a85815a3ce47a0af64d676c5c6f4312eb892f9a7a46cd">EddyDiff::Theta_v</a></div><div class="ttdeci">@ Theta_v</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:176</div></div>
<div class="ttc" id="anamespaceEddyDiff_html_a3f912b3dbcd18dd6f4f0a85815a3ce47a61ed124b350a1b26da1bd26aebfa5f82"><div class="ttname"><a href="namespaceEddyDiff.html#a3f912b3dbcd18dd6f4f0a85815a3ce47a61ed124b350a1b26da1bd26aebfa5f82">EddyDiff::Mom_v</a></div><div class="ttdeci">@ Mom_v</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:175</div></div>
<div class="ttc" id="anamespaceLsmVar__MM5_html_afa778fa40619fb72857b168906e39080af198df5800148ff3680d005b5fb09c68"><div class="ttname"><a href="namespaceLsmVar__MM5.html#afa778fa40619fb72857b168906e39080af198df5800148ff3680d005b5fb09c68">LsmVar_MM5::theta</a></div><div class="ttdeci">@ theta</div><div class="ttdef"><b>Definition:</b> ERF_MM5.H:20</div></div>
<div class="ttc" id="anamespaceMicVar__Kess_html_ad5e2303f8f4cbf19829306f4a72d61a7af099273d19f4b8cdca199c5177231e35"><div class="ttname"><a href="namespaceMicVar__Kess.html#ad5e2303f8f4cbf19829306f4a72d61a7af099273d19f4b8cdca199c5177231e35">MicVar_Kess::qv</a></div><div class="ttdeci">@ qv</div><div class="ttdef"><b>Definition:</b> ERF_Kessler.H:28</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_ab5b66549344d8b04b126fa0ef16c7ca2_cgraph.png" border="0" usemap="#aclassERF_ab5b66549344d8b04b126fa0ef16c7ca2_cgraph" alt=""/></div>
<map name="aclassERF_ab5b66549344d8b04b126fa0ef16c7ca2_cgraph" id="aclassERF_ab5b66549344d8b04b126fa0ef16c7ca2_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,191,32"/>
<area shape="rect" href="ERF__EOS_8H.html#a08354ab110fb9e873bce9250b4f4b46e" title=" " alt="" coords="239,5,349,32"/>
</map>
</div>

</div>
</div>
<a id="a8b93b715895b00e86e7db653d2a7284a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b93b715895b00e86e7db653d2a7284a">&#9670;&nbsp;</a></span>derive_diag_profiles_stag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::derive_diag_profiles_stag </td>
          <td>(</td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_rho</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_th</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_ksgs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_Kmv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_Khv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_qv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_qc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_qr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_wqv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_wqc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_wqr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_qi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_qs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_qg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_uu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_uv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_uw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_vv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_vw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_ww</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_uth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_vth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_wth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_thth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_ku</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_kv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_kw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_pu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_pv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_pw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_wthv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Computes the profiles for diagnostic quantities at <em>staggered</em> heights.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">h_avg_u</td><td>Profile for x-velocity on Host </td></tr>
    <tr><td class="paramname">h_avg_v</td><td>Profile for y-velocity on Host </td></tr>
    <tr><td class="paramname">h_avg_w</td><td>Profile for z-velocity on Host </td></tr>
    <tr><td class="paramname">h_avg_rho</td><td>Profile for density on Host </td></tr>
    <tr><td class="paramname">h_avg_th</td><td>Profile for potential temperature on Host </td></tr>
    <tr><td class="paramname">h_avg_ksgs</td><td>Profile for Kinetic Energy on Host </td></tr>
    <tr><td class="paramname">h_avg_uu</td><td>Profile for x-velocity squared on Host </td></tr>
    <tr><td class="paramname">h_avg_uv</td><td>Profile for x-velocity * y-velocity on Host </td></tr>
    <tr><td class="paramname">h_avg_uw</td><td>Profile for x-velocity * z-velocity on Host </td></tr>
    <tr><td class="paramname">h_avg_vv</td><td>Profile for y-velocity squared on Host </td></tr>
    <tr><td class="paramname">h_avg_vw</td><td>Profile for y-velocity * z-velocity on Host </td></tr>
    <tr><td class="paramname">h_avg_ww</td><td>Profile for z-velocity squared on Host </td></tr>
    <tr><td class="paramname">h_avg_uth</td><td>Profile for x-velocity * potential temperature on Host </td></tr>
    <tr><td class="paramname">h_avg_uiuiu</td><td>Profile for u_i*u_i*u triple product on Host </td></tr>
    <tr><td class="paramname">h_avg_uiuiv</td><td>Profile for u_i*u_i*v triple product on Host </td></tr>
    <tr><td class="paramname">h_avg_uiuiw</td><td>Profile for u_i*u_i*w triple product on Host </td></tr>
    <tr><td class="paramname">h_avg_p</td><td>Profile for pressure perturbation on Host </td></tr>
    <tr><td class="paramname">h_avg_pu</td><td>Profile for pressure perturbation * x-velocity on Host </td></tr>
    <tr><td class="paramname">h_avg_pv</td><td>Profile for pressure perturbation * y-velocity on Host </td></tr>
    <tr><td class="paramname">h_avg_pw</td><td>Profile for pressure perturbation * z-velocity on Host </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;{</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="comment">// We assume that this is always called at level 0</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keywordtype">int</span> lev = 0;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="keywordtype">bool</span> l_use_kturb = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa53b017d79e0067923180a0aa59367b4">turbChoice</a>[lev].use_kturb;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="keywordtype">bool</span> l_use_KE    = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa53b017d79e0067923180a0aa59367b4">turbChoice</a>[lev].use_tke;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="comment">// Note: &quot;uiui&quot; == u_i*u_i = u*u + v*v + w*w</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="comment">// This will hold rho, theta, ksgs, Kmh, Kmv, uu, uv, vv, uth, vth,</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="comment">//       indices:   0      1     2    3    4   5   6   7    8    9</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="comment">//                thth, uiuiu, uiuiv, p, pu, pv, qv, qc, qr, qi, qs, qg</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="comment">//                  10     11     12 13  14  15  16  17  18  19  20  21</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    MultiFab mf_out(grids[lev], dmap[lev], 22, 0);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160; </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="comment">// This will hold uw, vw, ww, wth, uiuiw, pw, wqv, wqc, wqr, wthv</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="comment">//       indices:  0   1   2    3      4   5    6    7    8     9</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    MultiFab mf_out_stag(convert(grids[lev], IntVect(0,0,1)), dmap[lev], 10, 0);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="comment">// This is only used to average u and v; w is not averaged to cell centers</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    MultiFab mf_vels(grids[lev], dmap[lev], 2, 0);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    MultiFab  u_cc(mf_vels, make_alias, 0, 1); <span class="comment">// u at cell centers</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    MultiFab  v_cc(mf_vels, make_alias, 1, 1); <span class="comment">// v at cell centers</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    MultiFab  w_fc(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>], make_alias, 0, 1); <span class="comment">// w at face centers (staggered)</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160; </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keywordtype">int</span> zdir = 2;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keyword">auto</span> domain = geom[0].Domain();</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    Box stag_domain = domain;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    stag_domain.convert(IntVect(0,0,1));</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160; </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="ERF__DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a7c3c83d6fcec1f134956c3160adf6e39">nvars</a> = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nComp();</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    MultiFab mf_cons(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], make_alias, 0, <a class="code" href="ERF__DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a7c3c83d6fcec1f134956c3160adf6e39">nvars</a>);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160; </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    MultiFab p_hse (<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev], make_alias, <a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91aa8253dc5484f2621e0bf8d51d98d635e">BaseState::p0_comp</a>, 1);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="keywordtype">bool</span> use_moisture = (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> != MoistureType::None);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160; </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="keywordflow">for</span> ( MFIter mfi(mf_cons,TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    {</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <span class="keyword">const</span> Array4&lt;Real&gt;&amp; fab_arr = mf_out.array(mfi);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <span class="keyword">const</span> Array4&lt;Real&gt;&amp; fab_arr_stag = mf_out_stag.array(mfi);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        <span class="keyword">const</span> Array4&lt;Real&gt;&amp; u_arr = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].array(mfi);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        <span class="keyword">const</span> Array4&lt;Real&gt;&amp; v_arr = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].array(mfi);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <span class="keyword">const</span> Array4&lt;Real&gt;&amp; u_cc_arr =  u_cc.array(mfi);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <span class="keyword">const</span> Array4&lt;Real&gt;&amp; v_cc_arr =  v_cc.array(mfi);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        <span class="keyword">const</span> Array4&lt;Real&gt;&amp; w_fc_arr =  w_fc.array(mfi);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        <span class="keyword">const</span> Array4&lt;Real&gt;&amp; cons_arr = mf_cons.array(mfi);</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        <span class="keyword">const</span> Array4&lt;Real&gt;&amp;   p0_arr = p_hse.array(mfi);</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <span class="keyword">const</span> Array4&lt;const Real&gt;&amp; eta_arr = (l_use_kturb) ? <a class="code" href="classERF.html#a327d704704abd516be19339cb2d226f9">eddyDiffs_lev</a>[lev]-&gt;const_array(mfi) :</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                                                            Array4&lt;const Real&gt;{};</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160; </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        {</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;            u_cc_arr(i,j,k) = 0.5 * (u_arr(i,j,k) + u_arr(i+1,j  ,k));</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            v_cc_arr(i,j,k) = 0.5 * (v_arr(i,j,k) + v_arr(i  ,j+1,k));</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160; </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            Real <a class="code" href="namespaceLsmVar__MM5.html#afa778fa40619fb72857b168906e39080af198df5800148ff3680d005b5fb09c68">theta</a> = cons_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>) / cons_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            fab_arr(i, j, k, 0) = cons_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            fab_arr(i, j, k, 1) = <a class="code" href="namespaceLsmVar__MM5.html#afa778fa40619fb72857b168906e39080af198df5800148ff3680d005b5fb09c68">theta</a>;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            Real ksgs = 0.0;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;            <span class="keywordflow">if</span> (l_use_KE) {</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                ksgs = cons_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#ae15721db2cb4c2ab4732afe226bbba64">RhoKE_comp</a>) / cons_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;            }</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;            fab_arr(i, j, k, 2) = ksgs;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;            <span class="keywordflow">if</span> (l_use_kturb) {</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                fab_arr(i, j, k, 3) = eta_arr(i,j,k,<a class="code" href="namespaceEddyDiff.html#a3f912b3dbcd18dd6f4f0a85815a3ce47a61ed124b350a1b26da1bd26aebfa5f82">EddyDiff::Mom_v</a>); <span class="comment">// Kmv</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                fab_arr(i, j, k, 4) = eta_arr(i,j,k,<a class="code" href="namespaceEddyDiff.html#a3f912b3dbcd18dd6f4f0a85815a3ce47a0af64d676c5c6f4312eb892f9a7a46cd">EddyDiff::Theta_v</a>); <span class="comment">// Khv</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                fab_arr(i, j, k, 3) = 0.0;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                fab_arr(i, j, k, 4) = 0.0;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            }</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            fab_arr(i, j, k, 5) = u_cc_arr(i,j,k) * u_cc_arr(i,j,k);   <span class="comment">// u*u</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            fab_arr(i, j, k, 6) = u_cc_arr(i,j,k) * v_cc_arr(i,j,k);   <span class="comment">// u*v</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            fab_arr(i, j, k, 7) = v_cc_arr(i,j,k) * v_cc_arr(i,j,k);   <span class="comment">// v*v</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;            fab_arr(i, j, k, 8) = u_cc_arr(i,j,k) * <a class="code" href="namespaceLsmVar__MM5.html#afa778fa40619fb72857b168906e39080af198df5800148ff3680d005b5fb09c68">theta</a>;             <span class="comment">// u*th</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            fab_arr(i, j, k, 9) = v_cc_arr(i,j,k) * <a class="code" href="namespaceLsmVar__MM5.html#afa778fa40619fb72857b168906e39080af198df5800148ff3680d005b5fb09c68">theta</a>;             <span class="comment">// v*th</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;            fab_arr(i, j, k,10) = <a class="code" href="namespaceLsmVar__MM5.html#afa778fa40619fb72857b168906e39080af198df5800148ff3680d005b5fb09c68">theta</a> * <a class="code" href="namespaceLsmVar__MM5.html#afa778fa40619fb72857b168906e39080af198df5800148ff3680d005b5fb09c68">theta</a>;                       <span class="comment">// th*th</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160; </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;            Real wcc = 0.5 * (w_fc_arr(i,j,k) + w_fc_arr(i,j,k+1));</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160; </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            <span class="comment">// if the number of fields is changed above, then be sure to update</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            <span class="comment">// the following def!</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;            Real uiui = fab_arr(i,j,k,5) + fab_arr(i,j,k,7) + wcc*wcc;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            fab_arr(i, j, k,11) = uiui * u_cc_arr(i,j,k);           <span class="comment">// (ui*ui)*u</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            fab_arr(i, j, k,12) = uiui * v_cc_arr(i,j,k);           <span class="comment">// (ui*ui)*v</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160; </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            <span class="keywordflow">if</span> (!use_moisture) {</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                Real p = <a class="code" href="ERF__EOS_8H.html#a08354ab110fb9e873bce9250b4f4b46e">getPgivenRTh</a>(cons_arr(i, j, k, <a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>));</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                p -= p0_arr(i,j,k);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                fab_arr(i, j, k,13) = p;                       <span class="comment">// p</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                fab_arr(i, j, k,14) = p * u_cc_arr(i,j,k);     <span class="comment">// p*u</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                fab_arr(i, j, k,15) = p * v_cc_arr(i,j,k);     <span class="comment">// p*v</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                fab_arr(i, j, k,16) = 0.;  <span class="comment">// qv</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                fab_arr(i, j, k,17) = 0.;  <span class="comment">// qc</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                fab_arr(i, j, k,18) = 0.;  <span class="comment">// qr</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                fab_arr(i, j, k,19) = 0.;  <span class="comment">// qi</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                fab_arr(i, j, k,20) = 0.;  <span class="comment">// qs</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                fab_arr(i, j, k,21) = 0.;  <span class="comment">// qg</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            }</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        });</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160; </div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        <span class="keyword">const</span> Box&amp; <a class="code" href="ERF__DiffSetup_8H.html#a4c74ed1b76138a2f5baa925afe40f9a8">zbx</a> = mfi.tilebox(IntVect(0,0,1));</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        ParallelFor(<a class="code" href="ERF__DiffSetup_8H.html#a4c74ed1b76138a2f5baa925afe40f9a8">zbx</a>, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        {</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;            <span class="comment">// average to z faces (first to cell centers, then in z)</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;            Real uface = 0.25 * ( u_arr(i  ,j,k) + u_arr(i  ,j,k-1)</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                                + u_arr(i+1,j,k) + u_arr(i+1,j,k-1));</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;            Real vface = 0.25 * ( v_arr(i,j  ,k) + v_arr(i,j  ,k-1)</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                                + v_arr(i,j+1,k) + v_arr(i,j+1,k-1));</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            Real theta0 = cons_arr(i,j,k  ,<a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>) / cons_arr(i,j,k  ,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            Real theta1 = cons_arr(i,j,k-1,<a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>) / cons_arr(i,j,k-1,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;            Real thface = 0.5*(theta0 + theta1);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;            fab_arr_stag(i,j,k,0) =           uface * w_fc_arr(i,j,k); <span class="comment">// u*w</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;            fab_arr_stag(i,j,k,1) =           vface * w_fc_arr(i,j,k); <span class="comment">// v*w</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;            fab_arr_stag(i,j,k,2) = w_fc_arr(i,j,k) * w_fc_arr(i,j,k); <span class="comment">// w*w</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;            fab_arr_stag(i,j,k,3) =          thface * w_fc_arr(i,j,k); <span class="comment">// th*w</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            Real uiui = uface*uface + vface*vface + fab_arr_stag(i,j,k,2);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;            fab_arr_stag(i,j,k,4) = uiui * w_fc_arr(i,j,k); <span class="comment">// (ui*ui)*w</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;            <span class="keywordflow">if</span> (!use_moisture) {</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                Real <a class="code" href="namespacemodule__model__constants.html#a2dcccd992b668c86eecdd9a825970d4a">p0</a> = <a class="code" href="ERF__EOS_8H.html#a08354ab110fb9e873bce9250b4f4b46e">getPgivenRTh</a>(cons_arr(i, j, k  , <a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>)) - p0_arr(i,j,k  );</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                Real p1 = <a class="code" href="ERF__EOS_8H.html#a08354ab110fb9e873bce9250b4f4b46e">getPgivenRTh</a>(cons_arr(i, j, k-1, <a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>)) - p0_arr(i,j,k-1);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                Real pface = 0.5 * (<a class="code" href="namespacemodule__model__constants.html#a2dcccd992b668c86eecdd9a825970d4a">p0</a> + p1);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                fab_arr_stag(i,j,k,5) = pface * w_fc_arr(i,j,k);       <span class="comment">// p*w</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                fab_arr_stag(i,j,k,6) = 0.;  <span class="comment">// w*qv</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                fab_arr_stag(i,j,k,7) = 0.;  <span class="comment">// w*qc</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                fab_arr_stag(i,j,k,8) = 0.;  <span class="comment">// w*qr</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                fab_arr_stag(i,j,k,9) = 0.;  <span class="comment">// w*thv</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;            }</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        });</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160; </div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    } <span class="comment">// mfi</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160; </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keywordflow">if</span> (use_moisture)</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    {</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        <span class="keywordtype">int</span> n_qstate_moist = <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;Get_Qstate_Moist_Size();</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160; </div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        <span class="keywordflow">for</span> ( MFIter mfi(mf_cons,TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        {</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;            <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;            <span class="keyword">const</span> Array4&lt;Real&gt;&amp; fab_arr  = mf_out.array(mfi);</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;            <span class="keyword">const</span> Array4&lt;Real&gt;&amp; fab_arr_stag  = mf_out_stag.array(mfi);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;            <span class="keyword">const</span> Array4&lt;Real&gt;&amp; cons_arr = mf_cons.array(mfi);</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;            <span class="keyword">const</span> Array4&lt;Real&gt;&amp; u_cc_arr =  u_cc.array(mfi);</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;            <span class="keyword">const</span> Array4&lt;Real&gt;&amp; v_cc_arr =  v_cc.array(mfi);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            <span class="keyword">const</span> Array4&lt;Real&gt;&amp; w_fc_arr =  w_fc.array(mfi);</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;            <span class="keyword">const</span> Array4&lt;Real&gt;&amp;   p0_arr = p_hse.array(mfi);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160; </div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;            <span class="keywordtype">int</span> rhoqr_comp = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a1d9237205fd632dcde1599511f203131">RhoQr_comp</a>;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160; </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;            {</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                Real <a class="code" href="namespaceMicVar__Kess.html#ad5e2303f8f4cbf19829306f4a72d61a7af099273d19f4b8cdca199c5177231e35">qv</a> = cons_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#aa965e9988f14d5d2a5aef4a942168a15">RhoQ1_comp</a>) / cons_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>);</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                Real <a class="code" href="namespaceMicVar__SatAdj.html#ac2be1e5fc951d23f27b621bed9836c16aea3777efcbbb3712ce373924287c2cb3">qc</a> = cons_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#a3bf0a4783e82ba30db2b7c0a332c2f16">RhoQ2_comp</a>) / cons_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>);</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                Real qr = (rhoqr_comp &gt; -1) ?  cons_arr(i,j,k,rhoqr_comp) / cons_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>) :</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                                               Real(0.0);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                Real p = <a class="code" href="ERF__EOS_8H.html#a08354ab110fb9e873bce9250b4f4b46e">getPgivenRTh</a>(cons_arr(i, j, k, <a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>), <a class="code" href="namespaceMicVar__Kess.html#ad5e2303f8f4cbf19829306f4a72d61a7af099273d19f4b8cdca199c5177231e35">qv</a>);</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160; </div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                p -= p0_arr(i,j,k);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                fab_arr(i, j, k,13) = p;                       <span class="comment">// p</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                fab_arr(i, j, k,14) = p * u_cc_arr(i,j,k);     <span class="comment">// p*u</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                fab_arr(i, j, k,15) = p * v_cc_arr(i,j,k);     <span class="comment">// p*v</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                fab_arr(i, j, k,16) = <a class="code" href="namespaceMicVar__Kess.html#ad5e2303f8f4cbf19829306f4a72d61a7af099273d19f4b8cdca199c5177231e35">qv</a>;  <span class="comment">// qv</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                fab_arr(i, j, k,17) = <a class="code" href="namespaceMicVar__SatAdj.html#ac2be1e5fc951d23f27b621bed9836c16aea3777efcbbb3712ce373924287c2cb3">qc</a>;  <span class="comment">// qc</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                fab_arr(i, j, k,18) = qr;  <span class="comment">// qr</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                <span class="keywordflow">if</span> (n_qstate_moist &gt; 3) { <span class="comment">// SAM model</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                    fab_arr(i, j, k,19) = cons_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#a49fe20d81f4d923a4a6ec4eb1652072b">RhoQ3_comp</a>) / cons_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>);  <span class="comment">// qi</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                    fab_arr(i, j, k,20) = cons_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#ac46d015fd5b1ee0060bbaf22e79113e7">RhoQ5_comp</a>) / cons_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>);  <span class="comment">// qs</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                    fab_arr(i, j, k,21) = cons_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#aae057dae5f599b944184a0ecf7801064">RhoQ6_comp</a>) / cons_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>);  <span class="comment">// qg</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                    fab_arr(i, j, k,19) = 0.0;  <span class="comment">// qi</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                    fab_arr(i, j, k,20) = 0.0;  <span class="comment">// qs</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                    fab_arr(i, j, k,21) = 0.0;  <span class="comment">// qg</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                }</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;            });</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160; </div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;            <span class="keyword">const</span> Box&amp; <a class="code" href="ERF__DiffSetup_8H.html#a4c74ed1b76138a2f5baa925afe40f9a8">zbx</a> = mfi.tilebox(IntVect(0,0,1));</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;            ParallelFor(<a class="code" href="ERF__DiffSetup_8H.html#a4c74ed1b76138a2f5baa925afe40f9a8">zbx</a>, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;            {</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                Real qv0 = cons_arr(i,j,k  ,<a class="code" href="ERF__IndexDefines_8H.html#aa965e9988f14d5d2a5aef4a942168a15">RhoQ1_comp</a>) / cons_arr(i,j,k  ,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                Real qv1 = cons_arr(i,j,k-1,<a class="code" href="ERF__IndexDefines_8H.html#aa965e9988f14d5d2a5aef4a942168a15">RhoQ1_comp</a>) / cons_arr(i,j,k-1,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                Real qc0 = cons_arr(i,j,k  ,<a class="code" href="ERF__IndexDefines_8H.html#a3bf0a4783e82ba30db2b7c0a332c2f16">RhoQ2_comp</a>) / cons_arr(i,j,k  ,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                Real qc1 = cons_arr(i,j,k-1,<a class="code" href="ERF__IndexDefines_8H.html#a3bf0a4783e82ba30db2b7c0a332c2f16">RhoQ2_comp</a>) / cons_arr(i,j,k-1,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                Real qr0 = (rhoqr_comp &gt; -1) ? cons_arr(i,j,k  ,<a class="code" href="ERF__IndexDefines_8H.html#a49fe20d81f4d923a4a6ec4eb1652072b">RhoQ3_comp</a>) / cons_arr(i,j,k  ,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>) :</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                                               Real(0.0);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                Real qr1 = (rhoqr_comp &gt; -1) ? cons_arr(i,j,k-1,<a class="code" href="ERF__IndexDefines_8H.html#a49fe20d81f4d923a4a6ec4eb1652072b">RhoQ3_comp</a>) / cons_arr(i,j,k-1,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>) :</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                                               Real(0.0);</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                Real qvface = 0.5 * (qv0 + qv1);</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                Real qcface = 0.5 * (qc0 + qc1);</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                Real qrface = 0.5 * (qr0 + qr1);</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160; </div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                Real <a class="code" href="namespacemodule__model__constants.html#a2dcccd992b668c86eecdd9a825970d4a">p0</a> = <a class="code" href="ERF__EOS_8H.html#a08354ab110fb9e873bce9250b4f4b46e">getPgivenRTh</a>(cons_arr(i, j, k  , <a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>), qv0) - p0_arr(i,j,k  );</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                Real p1 = <a class="code" href="ERF__EOS_8H.html#a08354ab110fb9e873bce9250b4f4b46e">getPgivenRTh</a>(cons_arr(i, j, k-1, <a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>), qv1) - p0_arr(i,j,k-1);</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                Real pface = 0.5 * (<a class="code" href="namespacemodule__model__constants.html#a2dcccd992b668c86eecdd9a825970d4a">p0</a> + p1);</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160; </div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                Real theta0 = cons_arr(i,j,k  ,<a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>) / cons_arr(i,j,k  ,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>);</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                Real theta1 = cons_arr(i,j,k-1,<a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>) / cons_arr(i,j,k-1,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                Real thface = 0.5*(theta0 + theta1);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                Real ql = qcface + qrface;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                Real thv = thface * (1 + 0.61*qvface - ql);</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160; </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                fab_arr_stag(i,j,k,5) = pface  * w_fc_arr(i,j,k); <span class="comment">// p*w</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                fab_arr_stag(i,j,k,6) = qvface * w_fc_arr(i,j,k); <span class="comment">// w*qv</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                fab_arr_stag(i,j,k,7) = qcface * w_fc_arr(i,j,k); <span class="comment">// w*qc</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                fab_arr_stag(i,j,k,8) = qrface * w_fc_arr(i,j,k); <span class="comment">// w*qr</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                fab_arr_stag(i,j,k,9) = thv    * w_fc_arr(i,j,k); <span class="comment">// w*thv</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;            });</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        } <span class="comment">// mfi</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    } <span class="comment">// use_moisture</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160; </div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="comment">// Sum in the horizontal plane</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    h_avg_u = sumToLine(u_cc,0,1,     domain,zdir);</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    h_avg_v = sumToLine(v_cc,0,1,     domain,zdir);</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    h_avg_w = sumToLine(w_fc,0,1,stag_domain,zdir);</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160; </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    h_avg_rho   = sumToLine(mf_out, 0,1,domain,zdir);</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    h_avg_th    = sumToLine(mf_out, 1,1,domain,zdir);</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    h_avg_ksgs  = sumToLine(mf_out, 2,1,domain,zdir);</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    h_avg_Kmv   = sumToLine(mf_out, 3,1,domain,zdir);</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    h_avg_Khv   = sumToLine(mf_out, 4,1,domain,zdir);</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    h_avg_uu    = sumToLine(mf_out, 5,1,domain,zdir);</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    h_avg_uv    = sumToLine(mf_out, 6,1,domain,zdir);</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    h_avg_vv    = sumToLine(mf_out, 7,1,domain,zdir);</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    h_avg_uth   = sumToLine(mf_out, 8,1,domain,zdir);</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    h_avg_vth   = sumToLine(mf_out, 9,1,domain,zdir);</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    h_avg_thth  = sumToLine(mf_out,10,1,domain,zdir);</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    h_avg_uiuiu = sumToLine(mf_out,11,1,domain,zdir);</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    h_avg_uiuiv = sumToLine(mf_out,12,1,domain,zdir);</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    h_avg_p     = sumToLine(mf_out,13,1,domain,zdir);</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    h_avg_pu    = sumToLine(mf_out,14,1,domain,zdir);</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    h_avg_pv    = sumToLine(mf_out,15,1,domain,zdir);</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    h_avg_qv    = sumToLine(mf_out,16,1,domain,zdir);</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    h_avg_qc    = sumToLine(mf_out,17,1,domain,zdir);</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    h_avg_qr    = sumToLine(mf_out,18,1,domain,zdir);</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    h_avg_qi    = sumToLine(mf_out,19,1,domain,zdir);</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    h_avg_qs    = sumToLine(mf_out,20,1,domain,zdir);</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    h_avg_qg    = sumToLine(mf_out,21,1,domain,zdir);</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160; </div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    h_avg_uw    = sumToLine(mf_out_stag,0,1,stag_domain,zdir);</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    h_avg_vw    = sumToLine(mf_out_stag,1,1,stag_domain,zdir);</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    h_avg_ww    = sumToLine(mf_out_stag,2,1,stag_domain,zdir);</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    h_avg_wth   = sumToLine(mf_out_stag,3,1,stag_domain,zdir);</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    h_avg_uiuiw = sumToLine(mf_out_stag,4,1,stag_domain,zdir);</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    h_avg_pw    = sumToLine(mf_out_stag,5,1,stag_domain,zdir);</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    h_avg_wqv   = sumToLine(mf_out_stag,6,1,stag_domain,zdir);</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    h_avg_wqc   = sumToLine(mf_out_stag,7,1,stag_domain,zdir);</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    h_avg_wqr   = sumToLine(mf_out_stag,8,1,stag_domain,zdir);</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    h_avg_wthv  = sumToLine(mf_out_stag,9,1,stag_domain,zdir);</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160; </div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="comment">// Divide by the total number of cells we are averaging over</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    Real area_z = <span class="keyword">static_cast&lt;</span>Real<span class="keyword">&gt;</span>(domain.length(0)*domain.length(1));</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="keywordtype">int</span> unstag_size = h_avg_w.size() - 1; <span class="comment">// _un_staggered heights</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; unstag_size; ++k) {</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        h_avg_u[k]     /= area_z;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        h_avg_v[k]     /= area_z;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        h_avg_rho[k]   /= area_z;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        h_avg_ksgs[k]  /= area_z;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        h_avg_Kmv[k]   /= area_z;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        h_avg_Khv[k]   /= area_z;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        h_avg_th[k]    /= area_z;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        h_avg_thth[k]  /= area_z;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        h_avg_uu[k]    /= area_z;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        h_avg_uv[k]    /= area_z;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        h_avg_vv[k]    /= area_z;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        h_avg_uth[k]   /= area_z;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        h_avg_vth[k]   /= area_z;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        h_avg_uiuiu[k] /= area_z;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        h_avg_uiuiv[k] /= area_z;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        h_avg_p[k]     /= area_z;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        h_avg_pu[k]    /= area_z;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        h_avg_pv[k]    /= area_z;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        h_avg_qv[k]    /= area_z;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        h_avg_qc[k]    /= area_z;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        h_avg_qr[k]    /= area_z;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        h_avg_qi[k]    /= area_z;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        h_avg_qs[k]    /= area_z;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        h_avg_qg[k]    /= area_z;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    }</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160; </div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; unstag_size+1; ++k) { <span class="comment">// staggered heights</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        h_avg_w[k]     /= area_z;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        h_avg_uw[k]    /= area_z;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        h_avg_vw[k]    /= area_z;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        h_avg_ww[k]    /= area_z;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        h_avg_wth[k]   /= area_z;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        h_avg_uiuiw[k] /= area_z;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        h_avg_pw[k]    /= area_z;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        h_avg_wqv[k]   /= area_z;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        h_avg_wqc[k]   /= area_z;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        h_avg_wqr[k]   /= area_z;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        h_avg_wthv[k]  /= area_z;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    }</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;}</div>
<div class="ttc" id="aERF__DiffSetup_8H_html_a4c74ed1b76138a2f5baa925afe40f9a8"><div class="ttname"><a href="ERF__DiffSetup_8H.html#a4c74ed1b76138a2f5baa925afe40f9a8">zbx</a></div><div class="ttdeci">const Box zbx</div><div class="ttdef"><b>Definition:</b> ERF_DiffSetup.H:23</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a8b93b715895b00e86e7db653d2a7284a_cgraph.png" border="0" usemap="#aclassERF_a8b93b715895b00e86e7db653d2a7284a_cgraph" alt=""/></div>
<map name="aclassERF_a8b93b715895b00e86e7db653d2a7284a_cgraph" id="aclassERF_a8b93b715895b00e86e7db653d2a7284a_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,225,32"/>
<area shape="rect" href="ERF__EOS_8H.html#a08354ab110fb9e873bce9250b4f4b46e" title=" " alt="" coords="273,5,384,32"/>
</map>
</div>

</div>
</div>
<a id="ad7886dcab90f37a8fcc91ede0c68b6cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7886dcab90f37a8fcc91ede0c68b6cb">&#9670;&nbsp;</a></span>derive_stress_profiles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::derive_stress_profiles </td>
          <td>(</td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_tau11</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_tau12</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_tau13</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_tau22</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_tau23</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_tau33</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_hfx3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_q1fx3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_q2fx3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_diss</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;{</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="keywordtype">int</span> lev = 0;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160; </div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="comment">// This will hold the stress tensor components</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    MultiFab mf_out(grids[lev], dmap[lev], 10, 0);</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160; </div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    MultiFab mf_rho(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], make_alias, 0, 1);</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160; </div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="keywordtype">bool</span> l_use_moist   = ( <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> != MoistureType::None );</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160; </div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="keywordflow">for</span> ( MFIter mfi(mf_out,TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    {</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        <span class="keyword">const</span> Array4&lt;Real&gt;&amp; fab_arr = mf_out.array(mfi);</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160; </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        <span class="keyword">const</span> Array4&lt;const Real&gt;&amp; rho_arr = mf_rho.const_array(mfi);</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160; </div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        <span class="comment">// NOTE: These are from the last RK stage...</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        <span class="keyword">const</span> Array4&lt;const Real&gt;&amp; tau11_arr = <a class="code" href="classERF.html#a3d4a3ed54fb357c02e6494461f182aa1">Tau</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248baab4c45b861caaf89b0842306117db7bc">TauType::tau11</a>]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        <span class="keyword">const</span> Array4&lt;const Real&gt;&amp; tau12_arr = <a class="code" href="classERF.html#a3d4a3ed54fb357c02e6494461f182aa1">Tau</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248ba0a0d169ca6b3a0da988c65f1c284ba99">TauType::tau12</a>]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        <span class="keyword">const</span> Array4&lt;const Real&gt;&amp; tau13_arr = <a class="code" href="classERF.html#a3d4a3ed54fb357c02e6494461f182aa1">Tau</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248baf5fa13cfd781cde0d363f337d7e76d7e">TauType::tau13</a>]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        <span class="keyword">const</span> Array4&lt;const Real&gt;&amp; tau22_arr = <a class="code" href="classERF.html#a3d4a3ed54fb357c02e6494461f182aa1">Tau</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248ba822e4f59780df9310afede8535eac286">TauType::tau22</a>]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        <span class="keyword">const</span> Array4&lt;const Real&gt;&amp; tau23_arr = <a class="code" href="classERF.html#a3d4a3ed54fb357c02e6494461f182aa1">Tau</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248ba181b302bd0f99081c3c22fa38e1f8b73">TauType::tau23</a>]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        <span class="keyword">const</span> Array4&lt;const Real&gt;&amp; tau33_arr = <a class="code" href="classERF.html#a3d4a3ed54fb357c02e6494461f182aa1">Tau</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248ba1edaba247488baa9858b879f19ea09b7">TauType::tau33</a>]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160; </div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        <span class="comment">// These should be re-calculated during ERF_slow_rhs_post</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        <span class="comment">// -- just vertical SFS kinematic heat flux for now</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        <span class="comment">//const Array4&lt;const Real&gt;&amp; hfx1_arr = SFS_hfx1_lev[lev]-&gt;const_array(mfi);</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        <span class="comment">//const Array4&lt;const Real&gt;&amp; hfx2_arr = SFS_hfx2_lev[lev]-&gt;const_array(mfi);</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        <span class="keyword">const</span> Array4&lt;const Real&gt;&amp; hfx3_arr = <a class="code" href="classERF.html#a1a2e3faf5dd90ad2f9ded28b486f3b46">SFS_hfx3_lev</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        <span class="keyword">const</span> Array4&lt;const Real&gt;&amp; q1fx3_arr = (l_use_moist) ? <a class="code" href="classERF.html#a101ceb89b1a249efeea3f4e8052bc8c0">SFS_q1fx3_lev</a>[lev]-&gt;const_array(mfi) :</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                                                              Array4&lt;const Real&gt;{};</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        <span class="keyword">const</span> Array4&lt;const Real&gt;&amp; q2fx3_arr = (l_use_moist) ? <a class="code" href="classERF.html#a3ea10ef7383e594b6ee5e7a9ad67607b">SFS_q2fx3_lev</a>[lev]-&gt;const_array(mfi) :</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                                                              Array4&lt;const Real&gt;{};</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        <span class="keyword">const</span> Array4&lt;const Real&gt;&amp; diss_arr = <a class="code" href="classERF.html#a6e1ad417e3bd062468d74830b65911fb">SFS_diss_lev</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160; </div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        {</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;            <span class="comment">// rho averaging should follow Diffusion/ERF_ComputeStress_*.cpp</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;            fab_arr(i, j, k, 0) = tau11_arr(i,j,k) / rho_arr(i,j,k);</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;            fab_arr(i, j, k, 1) = ( tau12_arr(i,j  ,k) + tau12_arr(i+1,j  ,k)</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                                  + tau12_arr(i,j+1,k) + tau12_arr(i+1,j+1,k) )</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                                / (   rho_arr(i,j  ,k) +   rho_arr(i+1,j  ,k)</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                                  +   rho_arr(i,j+1,k) +   rho_arr(i+1,j+1,k) );</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;            fab_arr(i, j, k, 2) = ( tau13_arr(i,j,k  ) + tau13_arr(i+1,j,k  )</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                                  + tau13_arr(i,j,k+1) + tau13_arr(i+1,j,k+1) )</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                                / (   rho_arr(i,j,k  ) +   rho_arr(i+1,j,k  )</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                                  +   rho_arr(i,j,k+1) +   rho_arr(i+1,j,k+1) );</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;            fab_arr(i, j, k, 3) = tau22_arr(i,j,k) / rho_arr(i,j,k);</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;            fab_arr(i, j, k, 4) = ( tau23_arr(i,j,k  ) + tau23_arr(i,j+1,k  )</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                                  + tau23_arr(i,j,k+1) + tau23_arr(i,j+1,k+1) )</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                                / (   rho_arr(i,j,k  ) +   rho_arr(i,j+1,k  )</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                                  +   rho_arr(i,j,k+1) +   rho_arr(i,j+1,k+1) );</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;            fab_arr(i, j, k, 5) = tau33_arr(i,j,k) / rho_arr(i,j,k);</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;            fab_arr(i, j, k, 6) = 0.5 * ( hfx3_arr(i,j,k) + hfx3_arr(i,j,k+1) ) / rho_arr(i,j,k);</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;            fab_arr(i, j, k, 7) = (l_use_moist) ? 0.5 * ( q1fx3_arr(i,j,k) + q1fx3_arr(i,j,k+1) ) / rho_arr(i,j,k) : 0.0;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;            fab_arr(i, j, k, 8) = (l_use_moist) ? 0.5 * ( q2fx3_arr(i,j,k) + q2fx3_arr(i,j,k+1) ) / rho_arr(i,j,k) : 0.0;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;            fab_arr(i, j, k, 9) =  diss_arr(i,j,k) / rho_arr(i,j,k);</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        });</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    }</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160; </div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="keywordtype">int</span> zdir = 2;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="keyword">auto</span> domain = geom[0].Domain();</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160; </div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    h_avg_tau11 = sumToLine(mf_out,0,1,domain,zdir);</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    h_avg_tau12 = sumToLine(mf_out,1,1,domain,zdir);</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    h_avg_tau13 = sumToLine(mf_out,2,1,domain,zdir);</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    h_avg_tau22 = sumToLine(mf_out,3,1,domain,zdir);</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    h_avg_tau23 = sumToLine(mf_out,4,1,domain,zdir);</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    h_avg_tau33 = sumToLine(mf_out,5,1,domain,zdir);</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    h_avg_hfx3  = sumToLine(mf_out,6,1,domain,zdir);</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    h_avg_q1fx3 = sumToLine(mf_out,7,1,domain,zdir);</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    h_avg_q2fx3 = sumToLine(mf_out,8,1,domain,zdir);</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    h_avg_diss  = sumToLine(mf_out,9,1,domain,zdir);</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160; </div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="keywordtype">int</span> ht_size =  h_avg_tau11.size();</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160; </div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="comment">// Divide by the total number of cells we are averaging over</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    Real area_z = <span class="keyword">static_cast&lt;</span>Real<span class="keyword">&gt;</span>(domain.length(0)*domain.length(1));</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; ht_size; ++k) {</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        h_avg_tau11[k] /= area_z;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        h_avg_tau12[k] /= area_z;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        h_avg_tau13[k] /= area_z;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        h_avg_tau22[k] /= area_z;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        h_avg_tau23[k] /= area_z;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        h_avg_tau33[k] /= area_z;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        h_avg_hfx3[k] /= area_z;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        h_avg_q1fx3[k] /= area_z;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        h_avg_q2fx3[k] /= area_z;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        h_avg_diss[k] /= area_z;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    }</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae09680325ba108583147eb2e254a266e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae09680325ba108583147eb2e254a266e">&#9670;&nbsp;</a></span>derive_stress_profiles_stag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::derive_stress_profiles_stag </td>
          <td>(</td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_tau11</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_tau12</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_tau13</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_tau22</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_tau23</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_tau33</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_hfx3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_q1fx3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_q2fx3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_avg_diss</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;{</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <span class="keywordtype">int</span> lev = 0;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160; </div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <span class="comment">// This will hold the stress tensor components</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    MultiFab mf_out(grids[lev], dmap[lev], 10, 0);</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160; </div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <span class="comment">// This will hold Tau13 and Tau23</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    MultiFab mf_out_stag(convert(grids[lev], IntVect(0,0,1)), dmap[lev], 5, 0);</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160; </div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    MultiFab mf_rho(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], make_alias, 0, 1);</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160; </div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="keywordtype">bool</span> l_use_moist   = ( <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> != MoistureType::None );</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160; </div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <span class="keywordflow">for</span> ( MFIter mfi(mf_out,TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    {</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        <span class="keyword">const</span> Array4&lt;Real&gt;&amp; fab_arr = mf_out.array(mfi);</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        <span class="keyword">const</span> Array4&lt;Real&gt;&amp; fab_arr_stag = mf_out_stag.array(mfi);</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160; </div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        <span class="keyword">const</span> Array4&lt;const Real&gt;&amp; rho_arr = mf_rho.const_array(mfi);</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160; </div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        <span class="comment">// NOTE: These are from the last RK stage...</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        <span class="keyword">const</span> Array4&lt;const Real&gt;&amp; tau11_arr = <a class="code" href="classERF.html#a3d4a3ed54fb357c02e6494461f182aa1">Tau</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248baab4c45b861caaf89b0842306117db7bc">TauType::tau11</a>]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        <span class="keyword">const</span> Array4&lt;const Real&gt;&amp; tau12_arr = <a class="code" href="classERF.html#a3d4a3ed54fb357c02e6494461f182aa1">Tau</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248ba0a0d169ca6b3a0da988c65f1c284ba99">TauType::tau12</a>]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        <span class="keyword">const</span> Array4&lt;const Real&gt;&amp; tau13_arr = <a class="code" href="classERF.html#a3d4a3ed54fb357c02e6494461f182aa1">Tau</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248baf5fa13cfd781cde0d363f337d7e76d7e">TauType::tau13</a>]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        <span class="keyword">const</span> Array4&lt;const Real&gt;&amp; tau22_arr = <a class="code" href="classERF.html#a3d4a3ed54fb357c02e6494461f182aa1">Tau</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248ba822e4f59780df9310afede8535eac286">TauType::tau22</a>]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        <span class="keyword">const</span> Array4&lt;const Real&gt;&amp; tau23_arr = <a class="code" href="classERF.html#a3d4a3ed54fb357c02e6494461f182aa1">Tau</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248ba181b302bd0f99081c3c22fa38e1f8b73">TauType::tau23</a>]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;        <span class="keyword">const</span> Array4&lt;const Real&gt;&amp; tau33_arr = <a class="code" href="classERF.html#a3d4a3ed54fb357c02e6494461f182aa1">Tau</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248ba1edaba247488baa9858b879f19ea09b7">TauType::tau33</a>]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160; </div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        <span class="comment">// These should be re-calculated during ERF_slow_rhs_post</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        <span class="comment">// -- just vertical SFS kinematic heat flux for now</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        <span class="comment">//const Array4&lt;const Real&gt;&amp; hfx1_arr = SFS_hfx1_lev[lev]-&gt;const_array(mfi);</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        <span class="comment">//const Array4&lt;const Real&gt;&amp; hfx2_arr = SFS_hfx2_lev[lev]-&gt;const_array(mfi);</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        <span class="keyword">const</span> Array4&lt;const Real&gt;&amp; hfx3_arr = <a class="code" href="classERF.html#a1a2e3faf5dd90ad2f9ded28b486f3b46">SFS_hfx3_lev</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        <span class="keyword">const</span> Array4&lt;const Real&gt;&amp; q1fx3_arr = (l_use_moist) ? <a class="code" href="classERF.html#a101ceb89b1a249efeea3f4e8052bc8c0">SFS_q1fx3_lev</a>[lev]-&gt;const_array(mfi) :</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                                                              Array4&lt;const Real&gt;{};</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        <span class="keyword">const</span> Array4&lt;const Real&gt;&amp; q2fx3_arr = (l_use_moist) ? <a class="code" href="classERF.html#a3ea10ef7383e594b6ee5e7a9ad67607b">SFS_q2fx3_lev</a>[lev]-&gt;const_array(mfi) :</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                                                              Array4&lt;const Real&gt;{};</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        <span class="keyword">const</span> Array4&lt;const Real&gt;&amp; diss_arr = <a class="code" href="classERF.html#a6e1ad417e3bd062468d74830b65911fb">SFS_diss_lev</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160; </div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        {</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;            <span class="comment">// rho averaging should follow Diffusion/ERF_ComputeStress_*.cpp</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;            fab_arr(i, j, k, 0) = tau11_arr(i,j,k) / rho_arr(i,j,k);</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;            fab_arr(i, j, k, 1) = ( tau12_arr(i,j  ,k) + tau12_arr(i+1,j  ,k)</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                                  + tau12_arr(i,j+1,k) + tau12_arr(i+1,j+1,k) )</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                                / (   rho_arr(i,j  ,k) +   rho_arr(i+1,j  ,k)</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                                  +   rho_arr(i,j+1,k) +   rho_arr(i+1,j+1,k) );</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;            fab_arr(i, j, k, 3) = tau22_arr(i,j,k) / rho_arr(i,j,k);</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;            fab_arr(i, j, k, 5) = tau33_arr(i,j,k) / rho_arr(i,j,k);</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;            fab_arr(i, j, k, 9) =  diss_arr(i,j,k) / rho_arr(i,j,k);</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        });</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160; </div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        <span class="keyword">const</span> Box&amp; <a class="code" href="ERF__DiffSetup_8H.html#a4c74ed1b76138a2f5baa925afe40f9a8">zbx</a> = mfi.tilebox(IntVect(0,0,1));</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        ParallelFor(<a class="code" href="ERF__DiffSetup_8H.html#a4c74ed1b76138a2f5baa925afe40f9a8">zbx</a>, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        {</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;            Real rho_face = 0.5 * (rho_arr(i,j,k-1) + rho_arr(i,j,k));</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;            <span class="comment">// average from edge to face center</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;            fab_arr_stag(i,j,k,0) = 0.5*(tau13_arr(i,j,k) + tau13_arr(i+1,j  ,k)) / rho_face;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;            fab_arr_stag(i,j,k,1) = 0.5*(tau23_arr(i,j,k) + tau23_arr(i  ,j+1,k)) / rho_face;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160; </div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;            fab_arr_stag(i,j,k,2) = hfx3_arr(i,j,k) / rho_face;</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;            fab_arr_stag(i,j,k,3) = (l_use_moist) ? q1fx3_arr(i,j,k) / rho_face : 0.0;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;            fab_arr_stag(i,j,k,4) = (l_use_moist) ? q2fx3_arr(i,j,k) / rho_face : 0.0;</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        });</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    }</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160; </div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="keywordtype">int</span> zdir = 2;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <span class="keyword">auto</span> domain = geom[0].Domain();</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    Box stag_domain = domain;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    stag_domain.convert(IntVect(0,0,1));</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160; </div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    h_avg_tau11 = sumToLine(mf_out,0,1,domain,zdir);</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    h_avg_tau12 = sumToLine(mf_out,1,1,domain,zdir);</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="comment">//  h_avg_tau13 = sumToLine(mf_out,2,1,domain,zdir);</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    h_avg_tau22 = sumToLine(mf_out,3,1,domain,zdir);</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="comment">//  h_avg_tau23 = sumToLine(mf_out,4,1,domain,zdir);</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    h_avg_tau33 = sumToLine(mf_out,5,1,domain,zdir);</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="comment">//  h_avg_hfx3  = sumToLine(mf_out,6,1,domain,zdir);</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="comment">//  h_avg_q1fx3 = sumToLine(mf_out,7,1,domain,zdir);</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="comment">//  h_avg_q2fx3 = sumToLine(mf_out,8,1,domain,zdir);</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    h_avg_diss  = sumToLine(mf_out,9,1,domain,zdir);</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160; </div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    h_avg_tau13 = sumToLine(mf_out_stag,0,1,stag_domain,zdir);</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    h_avg_tau23 = sumToLine(mf_out_stag,1,1,stag_domain,zdir);</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    h_avg_hfx3  = sumToLine(mf_out_stag,2,1,stag_domain,zdir);</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    h_avg_q1fx3 = sumToLine(mf_out_stag,3,1,stag_domain,zdir);</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    h_avg_q2fx3 = sumToLine(mf_out_stag,4,1,stag_domain,zdir);</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160; </div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <span class="keywordtype">int</span> ht_size =  h_avg_tau11.size(); <span class="comment">// _un_staggered</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160; </div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <span class="comment">// Divide by the total number of cells we are averaging over</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    Real area_z = <span class="keyword">static_cast&lt;</span>Real<span class="keyword">&gt;</span>(domain.length(0)*domain.length(1));</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; ht_size; ++k) {</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        h_avg_tau11[k] /= area_z;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        h_avg_tau12[k] /= area_z;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        h_avg_tau13[k] /= area_z;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        h_avg_tau22[k] /= area_z;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;        h_avg_tau23[k] /= area_z;</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        h_avg_tau33[k] /= area_z;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        h_avg_hfx3[k] /= area_z;</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        h_avg_q1fx3[k] /= area_z;</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        h_avg_q2fx3[k] /= area_z;</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        h_avg_diss[k] /= area_z;</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    }</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="comment">// staggered heights</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    h_avg_tau13[ht_size] /= area_z;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    h_avg_tau23[ht_size] /= area_z;</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    h_avg_hfx3[ht_size]  /= area_z;</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    h_avg_q1fx3[ht_size] /= area_z;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    h_avg_q2fx3[ht_size] /= area_z;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af1981699bedbbfd6785f26ca340a74d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1981699bedbbfd6785f26ca340a74d8">&#9670;&nbsp;</a></span>derive_upwp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::derive_upwp </td>
          <td>(</td>
          <td class="paramtype">amrex::Vector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_havg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad024dd413ab20e5d6f69c1f96e5b78a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad024dd413ab20e5d6f69c1f96e5b78a3">&#9670;&nbsp;</a></span>EBFactory()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::EBFArrayBoxFactory const&amp; ERF::EBFactory </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;                                       {</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;        <span class="keywordflow">return</span> *(<a class="code" href="classERF.html#a32317cbd11fb55fe60a00c0925189859">eb</a>[lev]-&gt;get_const_factory());</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    }</div>
<div class="ttc" id="aclassERF_html_a32317cbd11fb55fe60a00c0925189859"><div class="ttname"><a href="classERF.html#a32317cbd11fb55fe60a00c0925189859">ERF::eb</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; eb_ &gt; &gt; eb</div><div class="ttdef"><b>Definition:</b> ERF.H:1440</div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classERF.html#a31b92a0c6fa4e19ff90feef3611f5f06">WriteMyEBSurface()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_ad024dd413ab20e5d6f69c1f96e5b78a3_icgraph.png" border="0" usemap="#aclassERF_ad024dd413ab20e5d6f69c1f96e5b78a3_icgraph" alt=""/></div>
<map name="aclassERF_ad024dd413ab20e5d6f69c1f96e5b78a3_icgraph" id="aclassERF_ad024dd413ab20e5d6f69c1f96e5b78a3_icgraph">
<area shape="rect" title=" " alt="" coords="228,5,347,32"/>
<area shape="rect" href="classERF.html#a31b92a0c6fa4e19ff90feef3611f5f06" title=" " alt="" coords="5,5,180,32"/>
</map>
</div>

</div>
</div>
<a id="a29929644893f3e44beb5ed9403cbdaac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29929644893f3e44beb5ed9403cbdaac">&#9670;&nbsp;</a></span>erf_enforce_hse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::erf_enforce_hse </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>dens</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>pres</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>pi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>th</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>qv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>z_cc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Enforces hydrostatic equilibrium when using terrain.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">lev</td><td>Integer specifying the current level </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dens</td><td>MultiFab storing base state density </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pres</td><td>MultiFab storing base state pressure </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pi</td><td>MultiFab storing base state Exner function </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">z_cc</td><td>Pointer to MultiFab storing cell centered z-coordinates </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;{</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    Real l_gravity = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a47a54f2e44955202b5b437e4b1b4a61b">gravity</a>;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordtype">bool</span> l_use_terrain = (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a1952672901901b0b3a628f2298dc72c2">mesh_type</a> != MeshType::ConstantDz);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> geomdata = geom[lev].data();</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keyword">const</span> Real dz = geomdata.CellSize(2);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keywordflow">for</span> ( MFIter mfi(dens, <a class="code" href="ERF__TileNoZ_8H.html#a8da113f1d5603f7297fe1d03e5013f00">TileNoZ</a>()); mfi.isValid(); ++mfi )</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    {</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="comment">// Create a flat box with same horizontal extent but only one cell in vertical</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keyword">const</span> Box&amp; tbz = mfi.nodaltilebox(2);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="keywordtype">int</span> klo = tbz.smallEnd(2);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="keywordtype">int</span> khi = tbz.bigEnd(2);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <span class="comment">// Note we only grow by 1 because that is how big z_cc is.</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        Box b2d = tbz; <span class="comment">// Copy constructor</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        b2d.grow(0,1);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        b2d.grow(1,1);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        b2d.setRange(2,0);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="comment">// Intersect this box with the domain</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        Box zdomain = convert(geom[lev].Domain(),tbz.ixType());</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        b2d &amp;= zdomain;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <span class="comment">// We integrate to the first cell (and below) by using rho in this cell</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <span class="comment">// If gravity == 0 this is constant pressure</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <span class="comment">// If gravity != 0, hence this is a wall, this gives gp0 = dens[0] * gravity</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        <span class="comment">// (dens_hse*gravity would also be dens[0]*gravity because we use foextrap for rho at k = -1)</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <span class="comment">// Note ng_pres_hse = 1</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;       <span class="comment">// We start by assuming pressure on the ground is p_0 (in ERF_Constants.H)</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;       <span class="comment">// Note that gravity is positive</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        Array4&lt;Real&gt;  rho_arr = dens.array(mfi);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        Array4&lt;Real&gt; pres_arr = <a class="code" href="namespaceMicVar__Kess.html#ad5e2303f8f4cbf19829306f4a72d61a7a82dd7c202e6cce14520ac01cfaa4f4ad">pres</a>.array(mfi);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        Array4&lt;Real&gt;   pi_arr =   <a class="code" href="namespacemodule__mp__morr__two__moment.html#a0bb82f163dcece1b2d052202bf56bee3">pi</a>.array(mfi);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        Array4&lt;Real&gt;   th_arr = <a class="code" href="namespaceLsmVar__MM5.html#afa778fa40619fb72857b168906e39080af198df5800148ff3680d005b5fb09c68">theta</a>.array(mfi);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        Array4&lt;Real&gt; zcc_arr;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="keywordflow">if</span> (l_use_terrain) {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;           zcc_arr = z_cc-&gt;array(mfi);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        }</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <span class="keyword">const</span> Real rdOcp = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a2e1ef762ee1dc1bd3d4cbd08125c758a">rdOcp</a>;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        ParallelFor(b2d, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>)</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            <span class="comment">// Set value at surface from Newton iteration for rho</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            <span class="keywordflow">if</span> (klo == 0)</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            {</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                <span class="comment">// Physical height of the terrain at cell center</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                Real hz;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                <span class="keywordflow">if</span> (l_use_terrain) {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                    hz = zcc_arr(i,j,klo);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                    hz = 0.5*dz;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                }</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                pres_arr(i,j,klo) = <a class="code" href="ERF__Constants_8H.html#a994fea25f28c33c2e8f1e9c63d5b8b56">p_0</a> - hz * rho_arr(i,j,klo) * l_gravity;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                  pi_arr(i,j,klo) = <a class="code" href="ERF__EOS_8H.html#ab415ab4061cbbea05723267a0bf82c6b">getExnergivenP</a>(pres_arr(i,j,klo), rdOcp);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                  th_arr(i,j,klo) = <a class="code" href="ERF__EOS_8H.html#a3cc0ee7727b26e21a97acfc2ad2e6d4d">getRhoThetagivenP</a>(pres_arr(i,j,klo)) / rho_arr(i,j,klo);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                <span class="comment">// Set ghost cell with dz and rho at boundary</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                <span class="comment">// (We will set the rest of the ghost cells in the boundary condition routine)</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                pres_arr(i,j,klo-1) = <a class="code" href="ERF__Constants_8H.html#a994fea25f28c33c2e8f1e9c63d5b8b56">p_0</a> + hz * rho_arr(i,j,klo) * l_gravity;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                  pi_arr(i,j,klo-1) = <a class="code" href="ERF__EOS_8H.html#ab415ab4061cbbea05723267a0bf82c6b">getExnergivenP</a>(pres_arr(i,j,klo-1), rdOcp);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                  th_arr(i,j,klo-1) = <a class="code" href="ERF__EOS_8H.html#a3cc0ee7727b26e21a97acfc2ad2e6d4d">getRhoThetagivenP</a>(pres_arr(i,j,klo-1)) / rho_arr(i,j,klo-1);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                <span class="comment">// If level &gt; 0 and klo &gt; 0, we need to use the value of pres_arr(i,j,klo-1) which was</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                <span class="comment">//    filled from FillPatch-ing it.</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                Real dz_loc;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                <span class="keywordflow">if</span> (l_use_terrain) {</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                    dz_loc = (zcc_arr(i,j,klo) - zcc_arr(i,j,klo-1));</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                    dz_loc = dz;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                }</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160; </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                Real dens_interp = 0.5*(rho_arr(i,j,klo) + rho_arr(i,j,klo-1));</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                pres_arr(i,j,klo) = pres_arr(i,j,klo-1) - dz_loc * dens_interp * l_gravity;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                pi_arr(i,j,klo  ) = <a class="code" href="ERF__EOS_8H.html#ab415ab4061cbbea05723267a0bf82c6b">getExnergivenP</a>(pres_arr(i,j,klo  ), rdOcp);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                th_arr(i,j,klo  ) = <a class="code" href="ERF__EOS_8H.html#a3cc0ee7727b26e21a97acfc2ad2e6d4d">getRhoThetagivenP</a>(pres_arr(i,j,klo  )) / rho_arr(i,j,klo  );</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                pi_arr(i,j,klo-1) = <a class="code" href="ERF__EOS_8H.html#ab415ab4061cbbea05723267a0bf82c6b">getExnergivenP</a>(pres_arr(i,j,klo-1), rdOcp);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                th_arr(i,j,klo-1) = <a class="code" href="ERF__EOS_8H.html#a3cc0ee7727b26e21a97acfc2ad2e6d4d">getRhoThetagivenP</a>(pres_arr(i,j,klo-1)) / rho_arr(i,j,klo-1);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            }</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            Real dens_interp;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            <span class="keywordflow">if</span> (l_use_terrain) {</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = klo+1; k &lt;= khi; k++) {</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                    Real dz_loc = (zcc_arr(i,j,k) - zcc_arr(i,j,k-1));</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                    dens_interp = 0.5*(rho_arr(i,j,k) + rho_arr(i,j,k-1));</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                    pres_arr(i,j,k) = pres_arr(i,j,k-1) - dz_loc * dens_interp * l_gravity;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                    pi_arr(i,j,k) = <a class="code" href="ERF__EOS_8H.html#ab415ab4061cbbea05723267a0bf82c6b">getExnergivenP</a>(pres_arr(i,j,k), rdOcp);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                    th_arr(i,j,k) = <a class="code" href="ERF__EOS_8H.html#a3cc0ee7727b26e21a97acfc2ad2e6d4d">getRhoThetagivenP</a>(pres_arr(i,j,k)) / rho_arr(i,j,k);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                }</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = klo+1; k &lt;= khi; k++) {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                    dens_interp = 0.5*(rho_arr(i,j,k) + rho_arr(i,j,k-1));</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                    pres_arr(i,j,k) = pres_arr(i,j,k-1) - dz * dens_interp * l_gravity;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                    pi_arr(i,j,k) = <a class="code" href="ERF__EOS_8H.html#ab415ab4061cbbea05723267a0bf82c6b">getExnergivenP</a>(pres_arr(i,j,k), rdOcp);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                    th_arr(i,j,k) = <a class="code" href="ERF__EOS_8H.html#a3cc0ee7727b26e21a97acfc2ad2e6d4d">getRhoThetagivenP</a>(pres_arr(i,j,k)) / rho_arr(i,j,k);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                }</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            }</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        });</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    } <span class="comment">// mfi</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;     dens.FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;     <a class="code" href="namespaceMicVar__Kess.html#ad5e2303f8f4cbf19829306f4a72d61a7a82dd7c202e6cce14520ac01cfaa4f4ad">pres</a>.FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;       <a class="code" href="namespacemodule__mp__morr__two__moment.html#a0bb82f163dcece1b2d052202bf56bee3">pi</a>.FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <a class="code" href="namespaceLsmVar__MM5.html#afa778fa40619fb72857b168906e39080af198df5800148ff3680d005b5fb09c68">theta</a>.FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;       <a class="code" href="namespaceMicVar__Kess.html#ad5e2303f8f4cbf19829306f4a72d61a7af099273d19f4b8cdca199c5177231e35">qv</a>.FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;}</div>
<div class="ttc" id="aERF__Constants_8H_html_a994fea25f28c33c2e8f1e9c63d5b8b56"><div class="ttname"><a href="ERF__Constants_8H.html#a994fea25f28c33c2e8f1e9c63d5b8b56">p_0</a></div><div class="ttdeci">constexpr amrex::Real p_0</div><div class="ttdef"><b>Definition:</b> ERF_Constants.H:18</div></div>
<div class="ttc" id="aERF__EOS_8H_html_a3cc0ee7727b26e21a97acfc2ad2e6d4d"><div class="ttname"><a href="ERF__EOS_8H.html#a3cc0ee7727b26e21a97acfc2ad2e6d4d">getRhoThetagivenP</a></div><div class="ttdeci">AMREX_GPU_HOST_DEVICE AMREX_FORCE_INLINE amrex::Real getRhoThetagivenP(const amrex::Real p, const amrex::Real qv=0.0)</div><div class="ttdef"><b>Definition:</b> ERF_EOS.H:175</div></div>
<div class="ttc" id="aERF__EOS_8H_html_ab415ab4061cbbea05723267a0bf82c6b"><div class="ttname"><a href="ERF__EOS_8H.html#ab415ab4061cbbea05723267a0bf82c6b">getExnergivenP</a></div><div class="ttdeci">AMREX_GPU_HOST_DEVICE AMREX_FORCE_INLINE amrex::Real getExnergivenP(const amrex::Real P, const amrex::Real rdOcp)</div><div class="ttdef"><b>Definition:</b> ERF_EOS.H:144</div></div>
<div class="ttc" id="anamespaceMicVar__Kess_html_ad5e2303f8f4cbf19829306f4a72d61a7a82dd7c202e6cce14520ac01cfaa4f4ad"><div class="ttname"><a href="namespaceMicVar__Kess.html#ad5e2303f8f4cbf19829306f4a72d61a7a82dd7c202e6cce14520ac01cfaa4f4ad">MicVar_Kess::pres</a></div><div class="ttdeci">@ pres</div><div class="ttdef"><b>Definition:</b> ERF_Kessler.H:25</div></div>
<div class="ttc" id="anamespacemodule__mp__morr__two__moment_html_a0bb82f163dcece1b2d052202bf56bee3"><div class="ttname"><a href="namespacemodule__mp__morr__two__moment.html#a0bb82f163dcece1b2d052202bf56bee3">module_mp_morr_two_moment::pi</a></div><div class="ttdeci">real(c_double), parameter, private pi</div><div class="ttdef"><b>Definition:</b> ERF_module_mp_morr_two_moment.F90:100</div></div>
<div class="ttc" id="astructSolverChoice_html_a2e1ef762ee1dc1bd3d4cbd08125c758a"><div class="ttname"><a href="structSolverChoice.html#a2e1ef762ee1dc1bd3d4cbd08125c758a">SolverChoice::rdOcp</a></div><div class="ttdeci">amrex::Real rdOcp</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:759</div></div>
<div class="ttc" id="astructSolverChoice_html_a47a54f2e44955202b5b437e4b1b4a61b"><div class="ttname"><a href="structSolverChoice.html#a47a54f2e44955202b5b437e4b1b4a61b">SolverChoice::gravity</a></div><div class="ttdeci">amrex::Real gravity</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:757</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a29929644893f3e44beb5ed9403cbdaac_cgraph.png" border="0" usemap="#aclassERF_a29929644893f3e44beb5ed9403cbdaac_cgraph" alt=""/></div>
<map name="aclassERF_a29929644893f3e44beb5ed9403cbdaac_cgraph" id="aclassERF_a29929644893f3e44beb5ed9403cbdaac_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,164,83"/>
<area shape="rect" href="ERF__EOS_8H.html#ab415ab4061cbbea05723267a0bf82c6b" title=" " alt="" coords="225,5,349,32"/>
<area shape="rect" href="ERF__EOS_8H.html#a3cc0ee7727b26e21a97acfc2ad2e6d4d" title=" " alt="" coords="212,56,361,83"/>
<area shape="rect" href="ERF__TileNoZ_8H.html#a8da113f1d5603f7297fe1d03e5013f00" title=" " alt="" coords="250,107,323,133"/>
</map>
</div>

</div>
</div>
<a id="aab5871c91a4d8888c110865e9d35e8b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab5871c91a4d8888c110865e9d35e8b2">&#9670;&nbsp;</a></span>ERF_shared()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::ERF_shared </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;{</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordflow">if</span> (ParallelDescriptor::IOProcessor()) {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span>* erf_hash = <a class="code" href="namespaceamrex.html#afa2dbdd17ead719f97272c9a0a2b0f8a">buildInfoGetGitHash</a>(1);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span>* amrex_hash = <a class="code" href="namespaceamrex.html#afa2dbdd17ead719f97272c9a0a2b0f8a">buildInfoGetGitHash</a>(2);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span>* buildgithash = buildInfoGetBuildGitHash();</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span>* buildgitname = buildInfoGetBuildGitName();</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="keywordflow">if</span> (strlen(erf_hash) &gt; 0) {</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;          Print() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                         &lt;&lt; <span class="stringliteral">&quot;ERF git hash: &quot;</span> &lt;&lt; erf_hash &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <span class="keywordflow">if</span> (strlen(amrex_hash) &gt; 0) {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;          Print() &lt;&lt; <span class="stringliteral">&quot;AMReX git hash: &quot;</span> &lt;&lt; amrex_hash &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        }</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="keywordflow">if</span> (strlen(buildgithash) &gt; 0) {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;          Print() &lt;&lt; buildgitname &lt;&lt; <span class="stringliteral">&quot; git hash: &quot;</span> &lt;&lt; buildgithash &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        }</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        Print() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordtype">int</span> nlevs_max = max_level + 1;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="preprocessor">#ifdef ERF_USE_WINDFARM</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    Nturb.resize(nlevs_max);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    vars_windfarm.resize(nlevs_max);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    SMark.resize(nlevs_max);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <a class="code" href="classERF.html#afa4c3753628a106460dbb708277de511">qheating_rates</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <a class="code" href="classERF.html#a1a3799aabf8337159aa290946fef8404">sw_lw_fluxes</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <a class="code" href="classERF.html#a69e6a357fd92f2c2ad9f6e0843372b16">solar_zenith</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="comment">// NOTE: size lsm before readparams (chooses the model at all levels)</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <a class="code" href="classERF.html#ae0e9a78f120ba632d78cbf23c97b851c">lsm</a>.<a class="code" href="classLandSurface.html#a58bc8a6e1b1369cd863f8b4f424a6270">ReSize</a>(nlevs_max);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <a class="code" href="classERF.html#ad03da3399e893728741fac33100ce476">lsm_data</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <a class="code" href="classERF.html#aa5f6a6ceae0087393f386649d8bbbc31">lsm_flux</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="comment">// NOTE: size canopy model before readparams (if file exists, we construct)</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <a class="code" href="classERF.html#a8b181e6ed0bb62d79e4a62555210abc9">m_forest_drag</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= max_level; ++lev) { <a class="code" href="classERF.html#a8b181e6ed0bb62d79e4a62555210abc9">m_forest_drag</a>[lev] = <span class="keyword">nullptr</span>;}</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160; </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <a class="code" href="classERF.html#a2d39cd3bdc3d90609ad3b14e266d190a">ReadParameters</a>();</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <a class="code" href="classERF.html#afc2898daad269536c1a15443abf3fa75">initializeMicrophysics</a>(nlevs_max);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="preprocessor">#ifdef ERF_USE_WINDFARM</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    initializeWindFarm(nlevs_max);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <a class="code" href="classERF.html#a609b41a1de9c6b28f23dcdc6843f9ef5">rad</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= max_level; ++lev) {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a31c93846e0129221632347d2378e881d">rad_type</a> == RadiationType::RRTMGP) {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="preprocessor">#ifdef ERF_USE_RRTMGP</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            <a class="code" href="classERF.html#a609b41a1de9c6b28f23dcdc6843f9ef5">rad</a>[lev] = std::make_unique&lt;Radiation&gt;(lev, <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            <span class="comment">// pass radiation datalog frequency to model - RRTMGP needs to know when to save data for profiles</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            <a class="code" href="classERF.html#a609b41a1de9c6b28f23dcdc6843f9ef5">rad</a>[lev]-&gt;setDataLogFrequency(<a class="code" href="classERF.html#a9194db6f65f3cfa366010648eaa4affd">rad_datalog_int</a>);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a31c93846e0129221632347d2378e881d">rad_type</a> != RadiationType::None) {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            Abort(<span class="stringliteral">&quot;Don&#39;t know this radiation model!&quot;</span>);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        }</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    }</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keyword">const</span> std::string&amp; pv1 = <span class="stringliteral">&quot;plot_vars_1&quot;</span>; <a class="code" href="classERF.html#a1fcb440c67da60c86372aec1fe871cb7">setPlotVariables</a>(pv1,<a class="code" href="classERF.html#a6865cf87abbb5aab0db00ff3b1ce94ac">plot_var_names_1</a>);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keyword">const</span> std::string&amp; pv2 = <span class="stringliteral">&quot;plot_vars_2&quot;</span>; <a class="code" href="classERF.html#a1fcb440c67da60c86372aec1fe871cb7">setPlotVariables</a>(pv2,<a class="code" href="classERF.html#a79705c02d6f25fbdcec14ca2432e5da1">plot_var_names_2</a>);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="comment">// This is only used when we have mesh_type == MeshType::StretchedDz</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <a class="code" href="classERF.html#ad0981b0ff70e6d78acbb7769f7a142b7">stretched_dz_h</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <a class="code" href="classERF.html#a6600f30f1043a4c5e62b5cdd05f0a99f">stretched_dz_d</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="comment">// Initialize staggered vertical levels for grid stretching or terrain, and</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="comment">// to simplify Rayleigh damping layer calculations.</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>.resize(max_level+1);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <a class="code" href="ERF__InitZLevels_8cpp.html#a6a0ddf4ef447c8f0129b403c8fd889fd">init_zlevels</a>(<a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>,</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                 <a class="code" href="classERF.html#ad0981b0ff70e6d78acbb7769f7a142b7">stretched_dz_h</a>,</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                 <a class="code" href="classERF.html#a6600f30f1043a4c5e62b5cdd05f0a99f">stretched_dz_d</a>,</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                 geom,</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                 refRatio(),</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                 <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a63b6fffe930de9eb25f92c2bafb00c00">grid_stretching_ratio</a>,</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                 <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa4659e9babdc5d7327266f967d9a80ff">zsurf</a>,</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                 <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a0a4f1c55ea1e3a7d50f926ee0d20a21c">dz0</a>);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structSolverChoice.html#a1952672901901b0b3a628f2298dc72c2">SolverChoice::mesh_type</a> == MeshType::StretchedDz ||</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <a class="code" href="structSolverChoice.html#a1952672901901b0b3a628f2298dc72c2">SolverChoice::mesh_type</a> == MeshType::VariableDz) {</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        <span class="keywordtype">int</span> nz = geom[0].Domain().length(2) + 1; <span class="comment">// staggered</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <span class="keywordflow">if</span> (std::fabs(<a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[0][nz-1]-geom[0].ProbHi(2)) &gt; 1.0e-4) {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            Print() &lt;&lt; <span class="stringliteral">&quot;Note: prob_hi[2]=&quot;</span> &lt;&lt; geom[0].ProbHi(2)</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; does not match highest requested z level &quot;</span> &lt;&lt; <a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[0][nz-1]</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                &lt;&lt; std::endl;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        }</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="keywordflow">if</span> (std::fabs(<a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[0][0]-geom[0].ProbLo(2)) &gt; 1.0e-4) {</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            Print() &lt;&lt; <span class="stringliteral">&quot;Note: prob_lo[2]=&quot;</span> &lt;&lt; geom[0].ProbLo(2)</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; does not match lowest requested level &quot;</span> &lt;&lt; <a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[0][0]</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                &lt;&lt; std::endl;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        }</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <span class="comment">// Redefine the problem domain here?</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    }</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="comment">// Get lo/hi indices for massflux calc</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a68e4ef883dc13cca7db5a58589f76f25">const_massflux_u</a> != 0) || (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a39ced5a090f246f82bdec3f5d288fcbc">const_massflux_v</a> != 0)) {</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a1952672901901b0b3a628f2298dc72c2">mesh_type</a> == MeshType::ConstantDz) {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            <span class="keyword">const</span> Real massflux_zlo = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a0d32092156d308308f91b209d3c0ee12">const_massflux_layer_lo</a> - geom[0].ProbLo(2);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            <span class="keyword">const</span> Real massflux_zhi = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac7c666d84cca54459c809aaeab849aa1">const_massflux_layer_hi</a> - geom[0].ProbLo(2);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            <span class="keyword">const</span> Real dz = geom[0].CellSize(2);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            <span class="keywordflow">if</span> (massflux_zlo == -1e34) {</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a56b3643c43d3b6f0fa0f24adeee57f33">massflux_klo</a> = geom[0].Domain().smallEnd(2);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a56b3643c43d3b6f0fa0f24adeee57f33">massflux_klo</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(std::ceil(massflux_zlo / dz - 0.5));</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            }</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            <span class="keywordflow">if</span> (massflux_zhi ==  1e34) {</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#af2ce02ea291687a31fdd716e2732acfa">massflux_khi</a> = geom[0].Domain().bigEnd(2);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#af2ce02ea291687a31fdd716e2732acfa">massflux_khi</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(std::floor(massflux_zhi / dz - 0.5));</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            }</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a1952672901901b0b3a628f2298dc72c2">mesh_type</a> == MeshType::StretchedDz) {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            <span class="keyword">const</span> Real massflux_zlo = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a0d32092156d308308f91b209d3c0ee12">const_massflux_layer_lo</a>;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            <span class="keyword">const</span> Real massflux_zhi = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac7c666d84cca54459c809aaeab849aa1">const_massflux_layer_hi</a>;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a56b3643c43d3b6f0fa0f24adeee57f33">massflux_klo</a> = geom[0].Domain().smallEnd(2);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#af2ce02ea291687a31fdd716e2732acfa">massflux_khi</a> = geom[0].Domain().bigEnd(2) + 1;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k &lt;= geom[0].Domain().bigEnd(2)+1; ++k) {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[0][k] &lt;= massflux_zlo) <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a56b3643c43d3b6f0fa0f24adeee57f33">massflux_klo</a> = k;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[0][k] &lt;= massflux_zhi) <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#af2ce02ea291687a31fdd716e2732acfa">massflux_khi</a> = k;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            }</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        } <span class="keywordflow">else</span> { <span class="comment">// solverChoice.mesh_type == MeshType::VariableDz</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            Error(<span class="stringliteral">&quot;Const massflux with variable dz not supported -- planar averages are on k rather than constant-z planes&quot;</span>);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        Print() &lt;&lt; <span class="stringliteral">&quot;Constant mass flux based on k in [&quot;</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            &lt;&lt; <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a56b3643c43d3b6f0fa0f24adeee57f33">massflux_klo</a> &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#af2ce02ea291687a31fdd716e2732acfa">massflux_khi</a> &lt;&lt; <span class="stringliteral">&quot;]&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    }</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <a class="code" href="classERF.html#a60e8cb933f237903e3fbcd6376c26db0">prob</a> = <a class="code" href="ERF__ProbCommon_8H.html#af9d998a7ea02a8866bcbbf8d3d1f8882">amrex_probinit</a>(geom[0].ProbLo(),geom[0].ProbHi());</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="comment">// Geometry on all levels has been defined already.</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="comment">// No valid BoxArray and DistributionMapping have been defined.</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="comment">// But the arrays for them have been resized.</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160; </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>.resize(nlevs_max, 0);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <a class="code" href="classERF.html#aa3db2dd1b65310c66c4038650c22aaee">nsubsteps</a>.resize(nlevs_max, 1);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 1; lev &lt;= max_level; ++lev) {</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <a class="code" href="classERF.html#aa3db2dd1b65310c66c4038650c22aaee">nsubsteps</a>[lev] = MaxRefRatio(lev-1);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    }</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>.resize(nlevs_max, 0.0);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <a class="code" href="classERF.html#a7085d7d5fc94a0f84efc06957267d58e">t_old</a>.resize(nlevs_max, -1.e100);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>.resize(nlevs_max, std::min(1.e100,<a class="code" href="classERF.html#ad4b3bb9d744fb5dde65a21951b86e132">dt_max_initial</a>));</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <a class="code" href="classERF.html#a3cf7cb2e51eb7b69cb4079ffc6722459">dt_mri_ratio</a>.resize(nlevs_max, 1);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <a class="code" href="classERF.html#a29ce17220e488eb840abc53966c34d46">gradp</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="comment">// We resize this regardless in order to pass it without error</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <a class="code" href="classERF.html#a0c5206542d4193bb687f5271be6fe5e5">pp_inc</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <a class="code" href="classERF.html#a01f3db32272f53dc68025f0a98195e57">rU_new</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <a class="code" href="classERF.html#a54e37988486ef96e55e84bd8e91bb688">rV_new</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <a class="code" href="classERF.html#aa46c0b0d20525aed10f447923e54dde7">rW_new</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <a class="code" href="classERF.html#a6eecc44323f77917c95869928284f61d">rU_old</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <a class="code" href="classERF.html#aeb64e3b4def989ce68d873aefeed5e0e">rV_old</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <a class="code" href="classERF.html#ac1fa56ec90f44e3cdf487af46804163f">rW_old</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="comment">// xmom_crse_rhs.resize(nlevs_max);</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="comment">// ymom_crse_rhs.resize(nlevs_max);</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <a class="code" href="classERF.html#aaf7e8e28172eebdfe2224e4ee823310d">zmom_crse_rhs</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt; nlevs_max; ++lev) {</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev].resize(<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a5deccaa24d5e74279425d7749f7d1494">Vars::NumTypes</a>);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev].resize(<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a5deccaa24d5e74279425d7749f7d1494">Vars::NumTypes</a>);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <a class="code" href="classERF.html#a29ce17220e488eb840abc53966c34d46">gradp</a>[lev].resize(AMREX_SPACEDIM);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="comment">// Time integrator</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <a class="code" href="classERF.html#a09d0fb2bd609c898a665d9530a744585">mri_integrator_mem</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160; </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="comment">// Physical boundary conditions</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <a class="code" href="classERF.html#a2e9b04043853d25f2d76edbc0bed2e72">physbcs_cons</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <a class="code" href="classERF.html#a64e55e5ae9df06433146db657eb9e72e">physbcs_u</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <a class="code" href="classERF.html#a79231b5cfd4576a742e46ae0082b5121">physbcs_v</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <a class="code" href="classERF.html#a45c8ecd777f47732993777a0afb8e140">physbcs_w</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <a class="code" href="classERF.html#af4e7dc93dae16aa2cc94bbb20b699a6f">physbcs_base</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160; </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="comment">// Planes to hold Dirichlet values at boundaries</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <a class="code" href="classERF.html#a902f60d94be5eaf86361d1d5ad942105">xvel_bc_data</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <a class="code" href="classERF.html#ae5e40fcd6dd76c80d0b5b09be5baef97">yvel_bc_data</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <a class="code" href="classERF.html#ae08c25dcf643c6ef39f27d7dd0cb7423">zvel_bc_data</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <a class="code" href="classERF.html#a67c86c65b27f8ceee58b5ca989116e14">th_bc_data</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160; </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <a class="code" href="classERF.html#a86a0bc8e41668411ee0ab5801d4688a7">advflux_reg</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="comment">// Stresses</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <a class="code" href="classERF.html#a3d4a3ed54fb357c02e6494461f182aa1">Tau</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <a class="code" href="classERF.html#a25174b4ae6cfcac8f7d183ce5c9fe67b">SFS_hfx1_lev</a>.resize(nlevs_max); <a class="code" href="classERF.html#acb607b2e675b45fdcabc09b640ce5ae2">SFS_hfx2_lev</a>.resize(nlevs_max); <a class="code" href="classERF.html#a1a2e3faf5dd90ad2f9ded28b486f3b46">SFS_hfx3_lev</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <a class="code" href="classERF.html#a6e1ad417e3bd062468d74830b65911fb">SFS_diss_lev</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <a class="code" href="classERF.html#ae0316d5ae567a2da8439d204bace12ce">SFS_q1fx1_lev</a>.resize(nlevs_max); <a class="code" href="classERF.html#a53fab1172ec3f01356355f8cda0919fe">SFS_q1fx2_lev</a>.resize(nlevs_max); <a class="code" href="classERF.html#a101ceb89b1a249efeea3f4e8052bc8c0">SFS_q1fx3_lev</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <a class="code" href="classERF.html#a3ea10ef7383e594b6ee5e7a9ad67607b">SFS_q2fx3_lev</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <a class="code" href="classERF.html#a327d704704abd516be19339cb2d226f9">eddyDiffs_lev</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <a class="code" href="classERF.html#a9faaa96a7c270d2b2b062d9f30f19711">SmnSmn_lev</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="comment">// Sea surface temps</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <a class="code" href="classERF.html#a5a5395054a212d8f3fc577562c14b66e">sst_lev</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <a class="code" href="classERF.html#af89fb8b555dde334c978cdfd3fcd9d07">tsk_lev</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <a class="code" href="classERF.html#a3f3e29874221e43e13e2a431e77e0e4e">lmask_lev</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="comment">// Metric terms</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <a class="code" href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">detJ_cc</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <a class="code" href="classERF.html#a93bc9185c89cbeaceffaf40b8cf4a75c">ax</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <a class="code" href="classERF.html#ade870f983d113c64406bdcb8a9194044">ay</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <a class="code" href="classERF.html#a391914523e66645f7e947cefcd19c011">az</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160; </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <a class="code" href="classERF.html#a4ef635c22e72c715f5703a6b95a7abe5">z_phys_nd_new</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <a class="code" href="classERF.html#ae39bf64c5306b1dd939d82d9df728daa">detJ_cc_new</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <a class="code" href="classERF.html#a30dcf40e8f104fb6b6132805d2eff47c">z_phys_nd_src</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <a class="code" href="classERF.html#abfa333375bd02a72cc80ba1e7552aba5">z_phys_cc_src</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <a class="code" href="classERF.html#a9a411e0ea9d9bdbfab957c8081229091">detJ_cc_src</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <a class="code" href="classERF.html#abe77a4434d27561109ffc666546511dc">ax_src</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <a class="code" href="classERF.html#aa20bd15dbe2c801bda2d3bfdb5b81eab">ay_src</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <a class="code" href="classERF.html#ad2d8e37fbdac323eda857e0b8c151852">az_src</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160; </div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <a class="code" href="classERF.html#a72a59614c6d5ab840b924c84d5682270">z_t_rk</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <a class="code" href="classERF.html#a4a18cc3befd0911ccb011f9bb3b2efc2">terrain_blanking</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160; </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="comment">// Wall distance</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <a class="code" href="classERF.html#a0276b556fdefec8b99be95846a3a35fe">walldist</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160; </div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="comment">// BoxArrays to make MultiFabs needed to convert WRFBdy data</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <a class="code" href="classERF.html#a8c051cb96bfa9ff26929441978aa2a96">ba1d</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <a class="code" href="classERF.html#a268a79187ae9a115e601957f8b06cd42">ba2d</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160; </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="comment">// MultiFabs needed to convert WRFBdy data</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <a class="code" href="classERF.html#a8839af37a73c4c2e76bf978a05275ca9">mf_C1H</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <a class="code" href="classERF.html#ad473e8e616ea3f7bf7bf922a0fe16208">mf_C2H</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <a class="code" href="classERF.html#aed4ae5792dd32adf56d3c052ce79437f">mf_MUB</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160; </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="comment">// Map factors</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160; </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="comment">// Thin immersed body</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <a class="code" href="classERF.html#af044f075df34caa2a530aa13e1801a5b">xflux_imask</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <a class="code" href="classERF.html#aa4448d06a3e4fe9740927a636030939d">yflux_imask</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <a class="code" href="classERF.html#ada098767690d194f89717b0deb3adeac">zflux_imask</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="comment">//overset_imask.resize(nlevs_max);</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <a class="code" href="classERF.html#a5b9b8d719a87a6940f611c6a30e8ccf5">thin_xforce</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <a class="code" href="classERF.html#a18c1142552120bbd22987f34995ee939">thin_yforce</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <a class="code" href="classERF.html#a56a23d298bc66218bf257d0e793e341f">thin_zforce</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160; </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="comment">// Base state</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <a class="code" href="classERF.html#a37b2a4257df8ff53d4450de47f16ace1">base_state_new</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160; </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="comment">// Wave coupling data</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <a class="code" href="classERF.html#aef05cf88e9e9d2b56112336761493977">Hwave</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <a class="code" href="classERF.html#ad67b414a1a8b5bab6edeaf574f922825">Lwave</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt; max_level; ++lev)</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    {</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <a class="code" href="classERF.html#aef05cf88e9e9d2b56112336761493977">Hwave</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        <a class="code" href="classERF.html#ad67b414a1a8b5bab6edeaf574f922825">Lwave</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    }</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <a class="code" href="classERF.html#a11f2d48d9af9b8f4574975cae06838f1">Hwave_onegrid</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <a class="code" href="classERF.html#a83473e4b18de294a8b97dcdbbf048551">Lwave_onegrid</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt; max_level; ++lev)</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    {</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        <a class="code" href="classERF.html#a11f2d48d9af9b8f4574975cae06838f1">Hwave_onegrid</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        <a class="code" href="classERF.html#a83473e4b18de294a8b97dcdbbf048551">Lwave_onegrid</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    }</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160; </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="comment">// Theta prim for MOST</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <a class="code" href="classERF.html#a71629ae2fda396472198691b75d83b2e">Theta_prim</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160; </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="comment">// Qv prim for MOST</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <a class="code" href="classERF.html#a521d1faf157e3bccc86c0f26ee923576">Qv_prim</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160; </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="comment">// Qr prim for MOST</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <a class="code" href="classERF.html#a57d8432920785f8e58cf11a3232d76b5">Qr_prim</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160; </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="comment">// Time averaged velocity field</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <a class="code" href="classERF.html#a3e146164ca6929ec6d4984b6a3f43c81">vel_t_avg</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <a class="code" href="classERF.html#a6837423e9248e923fcaa1987b59d8160">t_avg_cnt</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160; </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="preprocessor">#ifdef ERF_USE_NETCDF</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="comment">// Size lat long arrays if using netcdf</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    lat_m.resize(nlevs_max);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    lon_m.resize(nlevs_max);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt; max_level; ++lev) {</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        lat_m[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        lon_m[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    }</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160; </div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="comment">// Variable coriolis</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <a class="code" href="classERF.html#ab54f3fc49bad059469da4e34c82296a6">sinPhi_m</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <a class="code" href="classERF.html#ad6a92272a5ad07f176892de07353f268">cosPhi_m</a>.resize(nlevs_max);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt; max_level; ++lev) {</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        <a class="code" href="classERF.html#ab54f3fc49bad059469da4e34c82296a6">sinPhi_m</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        <a class="code" href="classERF.html#ad6a92272a5ad07f176892de07353f268">cosPhi_m</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    }</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160; </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="comment">// Initialize tagging criteria for mesh refinement</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <a class="code" href="classERF.html#aa90c9756f684404f8b69b8a23568b535">refinement_criteria_setup</a>();</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160; </div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt; max_level; ++lev)</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    {</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;       Print() &lt;&lt; <span class="stringliteral">&quot;Refinement ratio at level &quot;</span> &lt;&lt; lev+1 &lt;&lt; <span class="stringliteral">&quot; set to be &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;          ref_ratio[lev][0]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; ref_ratio[lev][1]  &lt;&lt;  <span class="stringliteral">&quot; &quot;</span> &lt;&lt; ref_ratio[lev][2] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    }</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160; </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="comment">// We will create each of these in MakeNewLevelFromScratch</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <a class="code" href="classERF.html#a32317cbd11fb55fe60a00c0925189859">eb</a>.resize(max_level+1);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt; max_level + 1; lev++){</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        <a class="code" href="classERF.html#a32317cbd11fb55fe60a00c0925189859">eb</a>[lev] = std::make_unique&lt;eb_&gt;();</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    }</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160; </div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="comment">// Construct the EB data structures and store in a separate class</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="comment">// This is needed before initializing level MultiFabs</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> == TerrainType::EB ||</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;         <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> == TerrainType::ImmersedForcing)</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    {</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        Box terrain_bx(surroundingNodes(geom[max_level].Domain())); terrain_bx.grow(3);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        FArrayBox terrain_fab(makeSlab(terrain_bx,2,0),1);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        Real dummy_time = 0.0;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        <a class="code" href="classERF.html#a60e8cb933f237903e3fbcd6376c26db0">prob</a>-&gt;init_terrain_surface(geom[max_level], terrain_fab, dummy_time);</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        <a class="code" href="classTerrainIF.html">TerrainIF</a> ebterrain(terrain_fab, geom[max_level], <a class="code" href="classERF.html#a6600f30f1043a4c5e62b5cdd05f0a99f">stretched_dz_d</a>[max_level]);</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        <span class="keyword">auto</span> gshop = EB2::makeShop(ebterrain);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        <span class="keywordtype">bool</span> build_coarse_level_by_coarsening(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        <span class="comment">// Note this just needs to be an integer &gt; number of V-cycles one might use</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        <span class="keywordtype">int</span> max_coarsening_level = ( <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> == TerrainType::EB &amp;&amp;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                                    (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa7bb7f3c8b475b0e446c271d8aa5497f">project_initial_velocity</a> ||</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                                     <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa7be0d60ce3de3441d44082cc1b725ec">anelastic</a>[0] == 1) ) ? 100 : 0;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        amrex::EB2::Build(gshop, geom[max_level], max_level, max_coarsening_level, build_coarse_level_by_coarsening);</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    }</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;}</div>
<div class="ttc" id="aERF__InitZLevels_8cpp_html_a6a0ddf4ef447c8f0129b403c8fd889fd"><div class="ttname"><a href="ERF__InitZLevels_8cpp.html#a6a0ddf4ef447c8f0129b403c8fd889fd">init_zlevels</a></div><div class="ttdeci">void init_zlevels(Vector&lt; Vector&lt; Real &gt;&gt; &amp;zlevels_stag, Vector&lt; Vector&lt; Real &gt;&gt; &amp;stretched_dz_h, Vector&lt; Gpu::DeviceVector&lt; Real &gt;&gt; &amp;stretched_dz_d, Vector&lt; Geometry &gt; const &amp;geom, Vector&lt; IntVect &gt; const &amp;ref_ratio, const Real grid_stretching_ratio, const Real zsurf, const Real dz0)</div><div class="ttdef"><b>Definition:</b> ERF_InitZLevels.cpp:11</div></div>
<div class="ttc" id="aERF__ProbCommon_8H_html_af9d998a7ea02a8866bcbbf8d3d1f8882"><div class="ttname"><a href="ERF__ProbCommon_8H.html#af9d998a7ea02a8866bcbbf8d3d1f8882">amrex_probinit</a></div><div class="ttdeci">std::unique_ptr&lt; ProblemBase &gt; amrex_probinit(const amrex_real *problo, const amrex_real *probhi) AMREX_ATTRIBUTE_WEAK</div></div>
<div class="ttc" id="aclassERF_html_a11f2d48d9af9b8f4574975cae06838f1"><div class="ttname"><a href="classERF.html#a11f2d48d9af9b8f4574975cae06838f1">ERF::Hwave_onegrid</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; Hwave_onegrid</div><div class="ttdef"><b>Definition:</b> ERF.H:841</div></div>
<div class="ttc" id="aclassERF_html_a18c1142552120bbd22987f34995ee939"><div class="ttname"><a href="classERF.html#a18c1142552120bbd22987f34995ee939">ERF::thin_yforce</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; thin_yforce</div><div class="ttdef"><b>Definition:</b> ERF.H:874</div></div>
<div class="ttc" id="aclassERF_html_a1fcb440c67da60c86372aec1fe871cb7"><div class="ttname"><a href="classERF.html#a1fcb440c67da60c86372aec1fe871cb7">ERF::setPlotVariables</a></div><div class="ttdeci">void setPlotVariables(const std::string &amp;pp_plot_var_names, amrex::Vector&lt; std::string &gt; &amp;plot_var_names)</div><div class="ttdef"><b>Definition:</b> ERF_Plotfile.cpp:22</div></div>
<div class="ttc" id="aclassERF_html_a268a79187ae9a115e601957f8b06cd42"><div class="ttname"><a href="classERF.html#a268a79187ae9a115e601957f8b06cd42">ERF::ba2d</a></div><div class="ttdeci">amrex::Vector&lt; amrex::BoxArray &gt; ba2d</div><div class="ttdef"><b>Definition:</b> ERF.H:1076</div></div>
<div class="ttc" id="aclassERF_html_a29ce17220e488eb840abc53966c34d46"><div class="ttname"><a href="classERF.html#a29ce17220e488eb840abc53966c34d46">ERF::gradp</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; amrex::MultiFab &gt; &gt; gradp</div><div class="ttdef"><b>Definition:</b> ERF.H:711</div></div>
<div class="ttc" id="aclassERF_html_a2d39cd3bdc3d90609ad3b14e266d190a"><div class="ttname"><a href="classERF.html#a2d39cd3bdc3d90609ad3b14e266d190a">ERF::ReadParameters</a></div><div class="ttdeci">void ReadParameters()</div><div class="ttdef"><b>Definition:</b> ERF.cpp:1654</div></div>
<div class="ttc" id="aclassERF_html_a30dcf40e8f104fb6b6132805d2eff47c"><div class="ttname"><a href="classERF.html#a30dcf40e8f104fb6b6132805d2eff47c">ERF::z_phys_nd_src</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; z_phys_nd_src</div><div class="ttdef"><b>Definition:</b> ERF.H:811</div></div>
<div class="ttc" id="aclassERF_html_a37b2a4257df8ff53d4450de47f16ace1"><div class="ttname"><a href="classERF.html#a37b2a4257df8ff53d4450de47f16ace1">ERF::base_state_new</a></div><div class="ttdeci">amrex::Vector&lt; amrex::MultiFab &gt; base_state_new</div><div class="ttdef"><b>Definition:</b> ERF.H:836</div></div>
<div class="ttc" id="aclassERF_html_a391914523e66645f7e947cefcd19c011"><div class="ttname"><a href="classERF.html#a391914523e66645f7e947cefcd19c011">ERF::az</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; az</div><div class="ttdef"><b>Definition:</b> ERF.H:809</div></div>
<div class="ttc" id="aclassERF_html_a3f3e29874221e43e13e2a431e77e0e4e"><div class="ttname"><a href="classERF.html#a3f3e29874221e43e13e2a431e77e0e4e">ERF::lmask_lev</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; std::unique_ptr&lt; amrex::iMultiFab &gt; &gt; &gt; lmask_lev</div><div class="ttdef"><b>Definition:</b> ERF.H:791</div></div>
<div class="ttc" id="aclassERF_html_a4a18cc3befd0911ccb011f9bb3b2efc2"><div class="ttname"><a href="classERF.html#a4a18cc3befd0911ccb011f9bb3b2efc2">ERF::terrain_blanking</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; terrain_blanking</div><div class="ttdef"><b>Definition:</b> ERF.H:824</div></div>
<div class="ttc" id="aclassERF_html_a4ef635c22e72c715f5703a6b95a7abe5"><div class="ttname"><a href="classERF.html#a4ef635c22e72c715f5703a6b95a7abe5">ERF::z_phys_nd_new</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; z_phys_nd_new</div><div class="ttdef"><b>Definition:</b> ERF.H:818</div></div>
<div class="ttc" id="aclassERF_html_a56a23d298bc66218bf257d0e793e341f"><div class="ttname"><a href="classERF.html#a56a23d298bc66218bf257d0e793e341f">ERF::thin_zforce</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; thin_zforce</div><div class="ttdef"><b>Definition:</b> ERF.H:875</div></div>
<div class="ttc" id="aclassERF_html_a5a5395054a212d8f3fc577562c14b66e"><div class="ttname"><a href="classERF.html#a5a5395054a212d8f3fc577562c14b66e">ERF::sst_lev</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; &gt; sst_lev</div><div class="ttdef"><b>Definition:</b> ERF.H:789</div></div>
<div class="ttc" id="aclassERF_html_a5b9b8d719a87a6940f611c6a30e8ccf5"><div class="ttname"><a href="classERF.html#a5b9b8d719a87a6940f611c6a30e8ccf5">ERF::thin_xforce</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; thin_xforce</div><div class="ttdef"><b>Definition:</b> ERF.H:873</div></div>
<div class="ttc" id="aclassERF_html_a67c86c65b27f8ceee58b5ca989116e14"><div class="ttname"><a href="classERF.html#a67c86c65b27f8ceee58b5ca989116e14">ERF::th_bc_data</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Gpu::DeviceVector&lt; amrex::Real &gt; &gt; th_bc_data</div><div class="ttdef"><b>Definition:</b> ERF.H:666</div></div>
<div class="ttc" id="aclassERF_html_a6865cf87abbb5aab0db00ff3b1ce94ac"><div class="ttname"><a href="classERF.html#a6865cf87abbb5aab0db00ff3b1ce94ac">ERF::plot_var_names_1</a></div><div class="ttdeci">amrex::Vector&lt; std::string &gt; plot_var_names_1</div><div class="ttdef"><b>Definition:</b> ERF.H:949</div></div>
<div class="ttc" id="aclassERF_html_a7085d7d5fc94a0f84efc06957267d58e"><div class="ttname"><a href="classERF.html#a7085d7d5fc94a0f84efc06957267d58e">ERF::t_old</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Real &gt; t_old</div><div class="ttdef"><b>Definition:</b> ERF.H:700</div></div>
<div class="ttc" id="aclassERF_html_a72a59614c6d5ab840b924c84d5682270"><div class="ttname"><a href="classERF.html#a72a59614c6d5ab840b924c84d5682270">ERF::z_t_rk</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; z_t_rk</div><div class="ttdef"><b>Definition:</b> ERF.H:821</div></div>
<div class="ttc" id="aclassERF_html_a79705c02d6f25fbdcec14ca2432e5da1"><div class="ttname"><a href="classERF.html#a79705c02d6f25fbdcec14ca2432e5da1">ERF::plot_var_names_2</a></div><div class="ttdeci">amrex::Vector&lt; std::string &gt; plot_var_names_2</div><div class="ttdef"><b>Definition:</b> ERF.H:950</div></div>
<div class="ttc" id="aclassERF_html_a83473e4b18de294a8b97dcdbbf048551"><div class="ttname"><a href="classERF.html#a83473e4b18de294a8b97dcdbbf048551">ERF::Lwave_onegrid</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; Lwave_onegrid</div><div class="ttdef"><b>Definition:</b> ERF.H:842</div></div>
<div class="ttc" id="aclassERF_html_a8839af37a73c4c2e76bf978a05275ca9"><div class="ttname"><a href="classERF.html#a8839af37a73c4c2e76bf978a05275ca9">ERF::mf_C1H</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; mf_C1H</div><div class="ttdef"><b>Definition:</b> ERF.H:1077</div></div>
<div class="ttc" id="aclassERF_html_a8b181e6ed0bb62d79e4a62555210abc9"><div class="ttname"><a href="classERF.html#a8b181e6ed0bb62d79e4a62555210abc9">ERF::m_forest_drag</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; ForestDrag &gt; &gt; m_forest_drag</div><div class="ttdef"><b>Definition:</b> ERF.H:1155</div></div>
<div class="ttc" id="aclassERF_html_a8c051cb96bfa9ff26929441978aa2a96"><div class="ttname"><a href="classERF.html#a8c051cb96bfa9ff26929441978aa2a96">ERF::ba1d</a></div><div class="ttdeci">amrex::Vector&lt; amrex::BoxArray &gt; ba1d</div><div class="ttdef"><b>Definition:</b> ERF.H:1075</div></div>
<div class="ttc" id="aclassERF_html_a902f60d94be5eaf86361d1d5ad942105"><div class="ttname"><a href="classERF.html#a902f60d94be5eaf86361d1d5ad942105">ERF::xvel_bc_data</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Gpu::DeviceVector&lt; amrex::Real &gt; &gt; xvel_bc_data</div><div class="ttdef"><b>Definition:</b> ERF.H:663</div></div>
<div class="ttc" id="aclassERF_html_a9194db6f65f3cfa366010648eaa4affd"><div class="ttname"><a href="classERF.html#a9194db6f65f3cfa366010648eaa4affd">ERF::rad_datalog_int</a></div><div class="ttdeci">int rad_datalog_int</div><div class="ttdef"><b>Definition:</b> ERF.H:773</div></div>
<div class="ttc" id="aclassERF_html_a9a411e0ea9d9bdbfab957c8081229091"><div class="ttname"><a href="classERF.html#a9a411e0ea9d9bdbfab957c8081229091">ERF::detJ_cc_src</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; detJ_cc_src</div><div class="ttdef"><b>Definition:</b> ERF.H:813</div></div>
<div class="ttc" id="aclassERF_html_aa20bd15dbe2c801bda2d3bfdb5b81eab"><div class="ttname"><a href="classERF.html#aa20bd15dbe2c801bda2d3bfdb5b81eab">ERF::ay_src</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; ay_src</div><div class="ttdef"><b>Definition:</b> ERF.H:815</div></div>
<div class="ttc" id="aclassERF_html_aa4448d06a3e4fe9740927a636030939d"><div class="ttname"><a href="classERF.html#aa4448d06a3e4fe9740927a636030939d">ERF::yflux_imask</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::iMultiFab &gt; &gt; yflux_imask</div><div class="ttdef"><b>Definition:</b> ERF.H:868</div></div>
<div class="ttc" id="aclassERF_html_aa5f6a6ceae0087393f386649d8bbbc31"><div class="ttname"><a href="classERF.html#aa5f6a6ceae0087393f386649d8bbbc31">ERF::lsm_flux</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; amrex::MultiFab * &gt; &gt; lsm_flux</div><div class="ttdef"><b>Definition:</b> ERF.H:763</div></div>
<div class="ttc" id="aclassERF_html_aa90c9756f684404f8b69b8a23568b535"><div class="ttname"><a href="classERF.html#aa90c9756f684404f8b69b8a23568b535">ERF::refinement_criteria_setup</a></div><div class="ttdeci">void refinement_criteria_setup()</div><div class="ttdef"><b>Definition:</b> ERF_Tagging.cpp:165</div></div>
<div class="ttc" id="aclassERF_html_ab54f3fc49bad059469da4e34c82296a6"><div class="ttname"><a href="classERF.html#ab54f3fc49bad059469da4e34c82296a6">ERF::sinPhi_m</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; sinPhi_m</div><div class="ttdef"><b>Definition:</b> ERF.H:654</div></div>
<div class="ttc" id="aclassERF_html_abe77a4434d27561109ffc666546511dc"><div class="ttname"><a href="classERF.html#abe77a4434d27561109ffc666546511dc">ERF::ax_src</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; ax_src</div><div class="ttdef"><b>Definition:</b> ERF.H:814</div></div>
<div class="ttc" id="aclassERF_html_abfa333375bd02a72cc80ba1e7552aba5"><div class="ttname"><a href="classERF.html#abfa333375bd02a72cc80ba1e7552aba5">ERF::z_phys_cc_src</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; z_phys_cc_src</div><div class="ttdef"><b>Definition:</b> ERF.H:812</div></div>
<div class="ttc" id="aclassERF_html_ace4f0c79f84075dd7a43bd2b0ede1a9b"><div class="ttname"><a href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">ERF::zlevels_stag</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; amrex::Real &gt; &gt; zlevels_stag</div><div class="ttdef"><b>Definition:</b> ERF.H:800</div></div>
<div class="ttc" id="aclassERF_html_ad03da3399e893728741fac33100ce476"><div class="ttname"><a href="classERF.html#ad03da3399e893728741fac33100ce476">ERF::lsm_data</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; amrex::MultiFab * &gt; &gt; lsm_data</div><div class="ttdef"><b>Definition:</b> ERF.H:762</div></div>
<div class="ttc" id="aclassERF_html_ad0981b0ff70e6d78acbb7769f7a142b7"><div class="ttname"><a href="classERF.html#ad0981b0ff70e6d78acbb7769f7a142b7">ERF::stretched_dz_h</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; amrex::Real &gt; &gt; stretched_dz_h</div><div class="ttdef"><b>Definition:</b> ERF.H:832</div></div>
<div class="ttc" id="aclassERF_html_ad2d8e37fbdac323eda857e0b8c151852"><div class="ttname"><a href="classERF.html#ad2d8e37fbdac323eda857e0b8c151852">ERF::az_src</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; az_src</div><div class="ttdef"><b>Definition:</b> ERF.H:816</div></div>
<div class="ttc" id="aclassERF_html_ad473e8e616ea3f7bf7bf922a0fe16208"><div class="ttname"><a href="classERF.html#ad473e8e616ea3f7bf7bf922a0fe16208">ERF::mf_C2H</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; mf_C2H</div><div class="ttdef"><b>Definition:</b> ERF.H:1078</div></div>
<div class="ttc" id="aclassERF_html_ad4b3bb9d744fb5dde65a21951b86e132"><div class="ttname"><a href="classERF.html#ad4b3bb9d744fb5dde65a21951b86e132">ERF::dt_max_initial</a></div><div class="ttdeci">static amrex::Real dt_max_initial</div><div class="ttdef"><b>Definition:</b> ERF.H:909</div></div>
<div class="ttc" id="aclassERF_html_ad67b414a1a8b5bab6edeaf574f922825"><div class="ttname"><a href="classERF.html#ad67b414a1a8b5bab6edeaf574f922825">ERF::Lwave</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; Lwave</div><div class="ttdef"><b>Definition:</b> ERF.H:840</div></div>
<div class="ttc" id="aclassERF_html_ad6a92272a5ad07f176892de07353f268"><div class="ttname"><a href="classERF.html#ad6a92272a5ad07f176892de07353f268">ERF::cosPhi_m</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; cosPhi_m</div><div class="ttdef"><b>Definition:</b> ERF.H:654</div></div>
<div class="ttc" id="aclassERF_html_ada098767690d194f89717b0deb3adeac"><div class="ttname"><a href="classERF.html#ada098767690d194f89717b0deb3adeac">ERF::zflux_imask</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::iMultiFab &gt; &gt; zflux_imask</div><div class="ttdef"><b>Definition:</b> ERF.H:869</div></div>
<div class="ttc" id="aclassERF_html_ae08c25dcf643c6ef39f27d7dd0cb7423"><div class="ttname"><a href="classERF.html#ae08c25dcf643c6ef39f27d7dd0cb7423">ERF::zvel_bc_data</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Gpu::DeviceVector&lt; amrex::Real &gt; &gt; zvel_bc_data</div><div class="ttdef"><b>Definition:</b> ERF.H:665</div></div>
<div class="ttc" id="aclassERF_html_ae39bf64c5306b1dd939d82d9df728daa"><div class="ttname"><a href="classERF.html#ae39bf64c5306b1dd939d82d9df728daa">ERF::detJ_cc_new</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; detJ_cc_new</div><div class="ttdef"><b>Definition:</b> ERF.H:819</div></div>
<div class="ttc" id="aclassERF_html_ae5e40fcd6dd76c80d0b5b09be5baef97"><div class="ttname"><a href="classERF.html#ae5e40fcd6dd76c80d0b5b09be5baef97">ERF::yvel_bc_data</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Gpu::DeviceVector&lt; amrex::Real &gt; &gt; yvel_bc_data</div><div class="ttdef"><b>Definition:</b> ERF.H:664</div></div>
<div class="ttc" id="aclassERF_html_aed4ae5792dd32adf56d3c052ce79437f"><div class="ttname"><a href="classERF.html#aed4ae5792dd32adf56d3c052ce79437f">ERF::mf_MUB</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; mf_MUB</div><div class="ttdef"><b>Definition:</b> ERF.H:1079</div></div>
<div class="ttc" id="aclassERF_html_aef05cf88e9e9d2b56112336761493977"><div class="ttname"><a href="classERF.html#aef05cf88e9e9d2b56112336761493977">ERF::Hwave</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; Hwave</div><div class="ttdef"><b>Definition:</b> ERF.H:839</div></div>
<div class="ttc" id="aclassERF_html_af044f075df34caa2a530aa13e1801a5b"><div class="ttname"><a href="classERF.html#af044f075df34caa2a530aa13e1801a5b">ERF::xflux_imask</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; amrex::iMultiFab &gt; &gt; xflux_imask</div><div class="ttdef"><b>Definition:</b> ERF.H:867</div></div>
<div class="ttc" id="aclassERF_html_af89fb8b555dde334c978cdfd3fcd9d07"><div class="ttname"><a href="classERF.html#af89fb8b555dde334c978cdfd3fcd9d07">ERF::tsk_lev</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; std::unique_ptr&lt; amrex::MultiFab &gt; &gt; &gt; tsk_lev</div><div class="ttdef"><b>Definition:</b> ERF.H:790</div></div>
<div class="ttc" id="aclassERF_html_afc2898daad269536c1a15443abf3fa75"><div class="ttname"><a href="classERF.html#afc2898daad269536c1a15443abf3fa75">ERF::initializeMicrophysics</a></div><div class="ttdeci">void initializeMicrophysics(const int &amp;)</div><div class="ttdef"><b>Definition:</b> ERF.cpp:1456</div></div>
<div class="ttc" id="aclassLandSurface_html_a58bc8a6e1b1369cd863f8b4f424a6270"><div class="ttname"><a href="classLandSurface.html#a58bc8a6e1b1369cd863f8b4f424a6270">LandSurface::ReSize</a></div><div class="ttdeci">void ReSize(const int &amp;nlev)</div><div class="ttdef"><b>Definition:</b> ERF_LandSurface.H:24</div></div>
<div class="ttc" id="aclassTerrainIF_html"><div class="ttname"><a href="classTerrainIF.html">TerrainIF</a></div><div class="ttdef"><b>Definition:</b> ERF_EBIFTerrain.H:14</div></div>
<div class="ttc" id="anamespaceamrex_html_afa2dbdd17ead719f97272c9a0a2b0f8a"><div class="ttname"><a href="namespaceamrex.html#afa2dbdd17ead719f97272c9a0a2b0f8a">amrex::buildInfoGetGitHash</a></div><div class="ttdeci">const char * buildInfoGetGitHash(int i)</div></div>
<div class="ttc" id="astructSolverChoice_html_a0a4f1c55ea1e3a7d50f926ee0d20a21c"><div class="ttname"><a href="structSolverChoice.html#a0a4f1c55ea1e3a7d50f926ee0d20a21c">SolverChoice::dz0</a></div><div class="ttdeci">amrex::Real dz0</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:764</div></div>
<div class="ttc" id="astructSolverChoice_html_a0d32092156d308308f91b209d3c0ee12"><div class="ttname"><a href="structSolverChoice.html#a0d32092156d308308f91b209d3c0ee12">SolverChoice::const_massflux_layer_lo</a></div><div class="ttdeci">amrex::Real const_massflux_layer_lo</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:846</div></div>
<div class="ttc" id="astructSolverChoice_html_a39ced5a090f246f82bdec3f5d288fcbc"><div class="ttname"><a href="structSolverChoice.html#a39ced5a090f246f82bdec3f5d288fcbc">SolverChoice::const_massflux_v</a></div><div class="ttdeci">amrex::Real const_massflux_v</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:844</div></div>
<div class="ttc" id="astructSolverChoice_html_a56b3643c43d3b6f0fa0f24adeee57f33"><div class="ttname"><a href="structSolverChoice.html#a56b3643c43d3b6f0fa0f24adeee57f33">SolverChoice::massflux_klo</a></div><div class="ttdeci">int massflux_klo</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:848</div></div>
<div class="ttc" id="astructSolverChoice_html_a63b6fffe930de9eb25f92c2bafb00c00"><div class="ttname"><a href="structSolverChoice.html#a63b6fffe930de9eb25f92c2bafb00c00">SolverChoice::grid_stretching_ratio</a></div><div class="ttdeci">amrex::Real grid_stretching_ratio</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:762</div></div>
<div class="ttc" id="astructSolverChoice_html_a68e4ef883dc13cca7db5a58589f76f25"><div class="ttname"><a href="structSolverChoice.html#a68e4ef883dc13cca7db5a58589f76f25">SolverChoice::const_massflux_u</a></div><div class="ttdeci">amrex::Real const_massflux_u</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:843</div></div>
<div class="ttc" id="astructSolverChoice_html_aa4659e9babdc5d7327266f967d9a80ff"><div class="ttname"><a href="structSolverChoice.html#aa4659e9babdc5d7327266f967d9a80ff">SolverChoice::zsurf</a></div><div class="ttdeci">amrex::Real zsurf</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:763</div></div>
<div class="ttc" id="astructSolverChoice_html_ac7c666d84cca54459c809aaeab849aa1"><div class="ttname"><a href="structSolverChoice.html#ac7c666d84cca54459c809aaeab849aa1">SolverChoice::const_massflux_layer_hi</a></div><div class="ttdeci">amrex::Real const_massflux_layer_hi</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:847</div></div>
<div class="ttc" id="astructSolverChoice_html_af2ce02ea291687a31fdd716e2732acfa"><div class="ttname"><a href="structSolverChoice.html#af2ce02ea291687a31fdd716e2732acfa">SolverChoice::massflux_khi</a></div><div class="ttdeci">int massflux_khi</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:849</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_aab5871c91a4d8888c110865e9d35e8b2_cgraph.png" border="0" usemap="#aclassERF_aab5871c91a4d8888c110865e9d35e8b2_cgraph" alt=""/></div>
<map name="aclassERF_aab5871c91a4d8888c110865e9d35e8b2_cgraph" id="aclassERF_aab5871c91a4d8888c110865e9d35e8b2_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,136,83"/>
<area shape="rect" href="ERF__ProbCommon_8H.html#af9d998a7ea02a8866bcbbf8d3d1f8882" title=" " alt="" coords="225,5,347,32"/>
<area shape="rect" href="namespaceamrex.html#afa2dbdd17ead719f97272c9a0a2b0f8a" title=" " alt="" coords="184,56,388,83"/>
<area shape="rect" href="ERF__InitZLevels_8cpp.html#a6a0ddf4ef447c8f0129b403c8fd889fd" title=" " alt="" coords="238,107,334,133"/>
<area shape="rect" href="ERF__Interpolation__1D_8H.html#af71b362e58803c8c29aa5127adcf645f" title=" " alt="" coords="436,81,639,108"/>
<area shape="rect" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469" title=" " alt="" coords="518,132,557,159"/>
</map>
</div>

</div>
</div>
<a id="a18e6dbbf968b4492e78aa427791620f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18e6dbbf968b4492e78aa427791620f4">&#9670;&nbsp;</a></span>ErrorEst()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::ErrorEst </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::TagBoxArray &amp;&#160;</td>
          <td class="paramname"><em>tags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ngrow</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Function to tag cells for refinement &ndash; this overrides the pure virtual function in AmrCore</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">levc</td><td>level of refinement at which we tag cells (0 is coarsest level) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tags</td><td>array of tagged cells </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">time</td><td>current time </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;{</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> clearval = TagBox::CLEAR;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span>   tagval = TagBox::SET;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160; </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="comment">// Make sure the ghost cells of the level we are tagging at are filled</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <span class="comment">//    in case we take differences that require them</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="comment">// NOTE: We are Fillpatching only the cell-centered variables here</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    MultiFab&amp; S_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[levc][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>];</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    MultiFab&amp; U_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[levc][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>];</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    MultiFab&amp; V_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[levc][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>];</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    MultiFab&amp; W_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[levc][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>];</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="keywordflow">if</span> (levc == 0) {</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        <a class="code" href="classERF.html#afded764725240c356faffa97dddbe03d">FillPatch</a>(levc, time, {&amp;S_new, &amp;U_new, &amp;V_new, &amp;W_new});</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        <a class="code" href="classERF.html#afded764725240c356faffa97dddbe03d">FillPatch</a>(levc, time, {&amp;S_new, &amp;U_new, &amp;V_new, &amp;W_new},</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;                              {&amp;S_new, &amp;<a class="code" href="classERF.html#a01f3db32272f53dc68025f0a98195e57">rU_new</a>[levc], &amp;<a class="code" href="classERF.html#a54e37988486ef96e55e84bd8e91bb688">rV_new</a>[levc], &amp;<a class="code" href="classERF.html#aa46c0b0d20525aed10f447923e54dde7">rW_new</a>[levc]},</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;                              <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[levc], <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[levc],</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;                              <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    }</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt; <a class="code" href="classERF.html#ac81b3dfd7c6f21ba8479834e2ff1e652">ref_tags</a>.size(); ++j)</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        <span class="comment">// This mf must have ghost cells because we may take differences between adjacent values</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        std::unique_ptr&lt;MultiFab&gt; mf = std::make_unique&lt;MultiFab&gt;(grids[levc], dmap[levc], 1, 1);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        <span class="comment">// This allows dynamic refinement based on the value of the density</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ac81b3dfd7c6f21ba8479834e2ff1e652">ref_tags</a>[j].Field() == <span class="stringliteral">&quot;density&quot;</span>)</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        {</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;            MultiFab::Copy(*mf,<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[levc][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>,0,1,1);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <span class="comment">// This allows dynamic refinement based on the value of qv</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="classERF.html#ac81b3dfd7c6f21ba8479834e2ff1e652">ref_tags</a>[j].Field() == <span class="stringliteral">&quot;qv&quot;</span> ) {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;            MultiFab::Copy(  *mf, <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[levc][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], <a class="code" href="ERF__IndexDefines_8H.html#aa965e9988f14d5d2a5aef4a942168a15">RhoQ1_comp</a>, 0, 1, 1);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;            MultiFab::Divide(*mf, <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[levc][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],   <a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>, 0, 1, 1);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <span class="comment">// This allows dynamic refinement based on the value of qc</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ac81b3dfd7c6f21ba8479834e2ff1e652">ref_tags</a>[j].Field() == <span class="stringliteral">&quot;qc&quot;</span> ) {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;            MultiFab::Copy(  *mf, <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[levc][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], <a class="code" href="ERF__IndexDefines_8H.html#a3bf0a4783e82ba30db2b7c0a332c2f16">RhoQ2_comp</a>, 0, 1, 1);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;            MultiFab::Divide(*mf, <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[levc][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],   <a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>, 0, 1, 1);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <span class="comment">// This allows dynamic refinement based on the value of the z-component of vorticity</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ac81b3dfd7c6f21ba8479834e2ff1e652">ref_tags</a>[j].Field() == <span class="stringliteral">&quot;vorticity&quot;</span> ) {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            Vector&lt;MultiFab&gt; mf_cc_vel(1);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;            mf_cc_vel[0].define(grids[levc], dmap[levc], AMREX_SPACEDIM, IntVect(1,1,1));</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;            average_face_to_cellcenter(mf_cc_vel[0],0,Array&lt;const MultiFab*,3&gt;{&amp;U_new, &amp;V_new, &amp;W_new});</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;            <span class="comment">// Impose bc&#39;s at domain boundaries at all levels</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;            <a class="code" href="classERF.html#a0857fa7f21e3077bb8bd7808023a6d09">FillBdyCCVels</a>(mf_cc_vel,levc);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            mf-&gt;setVal(0.);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            <span class="keywordflow">for</span> (MFIter mfi(*mf, TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                <span class="keyword">auto</span>&amp; dfab = (*mf)[mfi];</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                <span class="keyword">auto</span>&amp; sfab = mf_cc_vel[0][mfi];</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                <a class="code" href="namespacederived.html#a8bc196f7dfb365c426b0b7e720e479e2">derived::erf_dervortz</a>(bx, dfab, 0, 1, sfab, Geom(levc), time, <span class="keyword">nullptr</span>, levc);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            }</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="comment">// This allows dynamic refinement based on the value of the scalar/theta</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( (<a class="code" href="classERF.html#ac81b3dfd7c6f21ba8479834e2ff1e652">ref_tags</a>[j].Field() == <span class="stringliteral">&quot;scalar&quot;</span>  ) ||</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                    (<a class="code" href="classERF.html#ac81b3dfd7c6f21ba8479834e2ff1e652">ref_tags</a>[j].Field() == <span class="stringliteral">&quot;theta&quot;</span>   ) )</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            <span class="keywordflow">for</span> (MFIter mfi(*mf, TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;            {</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.growntilebox();</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                <span class="keyword">auto</span>&amp; dfab = (*mf)[mfi];</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                <span class="keyword">auto</span>&amp; sfab = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[levc][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>][mfi];</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ac81b3dfd7c6f21ba8479834e2ff1e652">ref_tags</a>[j].Field() == <span class="stringliteral">&quot;scalar&quot;</span>) {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                    <a class="code" href="namespacederived.html#a37560f4d3e2c7c10f64d41db2ce76a06">derived::erf_derscalar</a>(bx, dfab, 0, 1, sfab, Geom(levc), time, <span class="keyword">nullptr</span>, levc);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ac81b3dfd7c6f21ba8479834e2ff1e652">ref_tags</a>[j].Field() == <span class="stringliteral">&quot;theta&quot;</span>) {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                    <a class="code" href="namespacederived.html#adc3c787125484205e4fc7cd85c25ab6c">derived::erf_dertheta</a>(bx, dfab, 0, 1, sfab, Geom(levc), time, <span class="keyword">nullptr</span>, levc);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                }</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            } <span class="comment">// mfi</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="comment">// This allows dynamic refinement based on the value of the density</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( (<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">SolverChoice::terrain_type</a> == TerrainType::ImmersedForcing) &amp;&amp;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                    (<a class="code" href="classERF.html#ac81b3dfd7c6f21ba8479834e2ff1e652">ref_tags</a>[j].Field() == <span class="stringliteral">&quot;terrain_blanking&quot;</span>) )</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        {</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            MultiFab::Copy(*mf,*<a class="code" href="classERF.html#a4a18cc3befd0911ccb011f9bb3b2efc2">terrain_blanking</a>[levc],0,0,1,1);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ac81b3dfd7c6f21ba8479834e2ff1e652">ref_tags</a>[j].Field() == <span class="stringliteral">&quot;velmag&quot;</span>) {</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;            mf-&gt;setVal(0.0);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;            ParmParse <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>(<a class="code" href="classERF.html#a59df30e7a5537c8543bb00772bd98b58">pp_prefix</a>);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            Vector&lt;std::string&gt; refinement_indicators;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.queryarr(<span class="stringliteral">&quot;refinement_indicators&quot;</span>,refinement_indicators,0,<a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.countval(<span class="stringliteral">&quot;refinement_indicators&quot;</span>));</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;            Real velmag_threshold = 1e10;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;refinement_indicators.size(); ++i)</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;            {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                <span class="keywordflow">if</span>(refinement_indicators[i]==<span class="stringliteral">&quot;hurricane_tracker&quot;</span>){</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                    std::string ref_prefix = <a class="code" href="classERF.html#a59df30e7a5537c8543bb00772bd98b58">pp_prefix</a> + <span class="stringliteral">&quot;.&quot;</span> + refinement_indicators[i];</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                    ParmParse ppr(ref_prefix);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                    ppr.get(<span class="stringliteral">&quot;value_greater&quot;</span>,velmag_threshold);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                }</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            }</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            <a class="code" href="classERF.html#a2710f0ac329fa022dd2df41679998b3b">HurricaneTracker</a>(levc, U_new, V_new, W_new, velmag_threshold, <span class="keyword">false</span>, &amp;tags);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="preprocessor">#ifdef ERF_USE_PARTICLES</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            <span class="comment">// This allows dynamic refinement based on the number of particles per cell</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            <span class="comment">// Note that we must count all the particles in levels both at and above the current,</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            <span class="comment">//      since otherwise, e.g., if the particles are all at level 1, counting particles at</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            <span class="comment">//      level 0 will not trigger refinement when regridding so level 1 will disappear,</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            <span class="comment">//      then come back at the next regridding</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            <span class="keyword">const</span> <span class="keyword">auto</span>&amp; particles_namelist( particleData.getNames() );</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            mf-&gt;setVal(0.0);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            <span class="keywordflow">for</span> (ParticlesNamesVector::size_type i = 0; i &lt; particles_namelist.size(); i++)</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                std::string tmp_string(particles_namelist[i]+<span class="stringliteral">&quot;_count&quot;</span>);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                IntVect <a class="code" href="namespacemodule__mp__morr__two__moment.html#a649e184a5c5c6d2eef72a390c18eb4e4">rr</a> = IntVect::TheUnitVector();</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ac81b3dfd7c6f21ba8479834e2ff1e652">ref_tags</a>[j].Field() == tmp_string) {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = levc; lev &lt;= finest_level; lev++)</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                    {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                        MultiFab temp_dat(grids[lev], dmap[lev], 1, 0); temp_dat.setVal(0);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                        particleData[particles_namelist[i]]-&gt;IncrementWithTotal(temp_dat, lev);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                        MultiFab temp_dat_crse(grids[levc], dmap[levc], 1, 0); temp_dat_crse.setVal(0);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                        <span class="keywordflow">if</span> (lev == levc) {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                            MultiFab::Copy(*mf, temp_dat, 0, 0, 1, 0);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; AMREX_SPACEDIM; d++) {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                                <a class="code" href="namespacemodule__mp__morr__two__moment.html#a649e184a5c5c6d2eef72a390c18eb4e4">rr</a>[d] *= ref_ratio[levc][d];</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                            }</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                            average_down(temp_dat, temp_dat_crse, 0, 1, <a class="code" href="namespacemodule__mp__morr__two__moment.html#a649e184a5c5c6d2eef72a390c18eb4e4">rr</a>);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                            MultiFab::Add(*mf, temp_dat_crse, 0, 0, 1, 0);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                        }</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                    }</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                }</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            }</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        }</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <a class="code" href="classERF.html#ac81b3dfd7c6f21ba8479834e2ff1e652">ref_tags</a>[j](tags,mf.get(),clearval,tagval,time,levc,geom[levc]);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    } <span class="comment">// loop over j</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_a0857fa7f21e3077bb8bd7808023a6d09"><div class="ttname"><a href="classERF.html#a0857fa7f21e3077bb8bd7808023a6d09">ERF::FillBdyCCVels</a></div><div class="ttdeci">void FillBdyCCVels(amrex::Vector&lt; amrex::MultiFab &gt; &amp;mf_cc_vel, int levc=0)</div><div class="ttdef"><b>Definition:</b> ERF_FillBdyCCVels.cpp:11</div></div>
<div class="ttc" id="aclassERF_html_a2710f0ac329fa022dd2df41679998b3b"><div class="ttname"><a href="classERF.html#a2710f0ac329fa022dd2df41679998b3b">ERF::HurricaneTracker</a></div><div class="ttdeci">void HurricaneTracker(int lev, const amrex::MultiFab &amp;U_new, const amrex::MultiFab &amp;V_new, const amrex::MultiFab &amp;W_new, const amrex::Real velmag_threshold, const bool is_track_io, amrex::TagBoxArray *tags=nullptr)</div><div class="ttdef"><b>Definition:</b> ERF_Tagging.cpp:391</div></div>
<div class="ttc" id="aclassERF_html_ac81b3dfd7c6f21ba8479834e2ff1e652"><div class="ttname"><a href="classERF.html#ac81b3dfd7c6f21ba8479834e2ff1e652">ERF::ref_tags</a></div><div class="ttdeci">static amrex::Vector&lt; amrex::AMRErrorTag &gt; ref_tags</div><div class="ttdef"><b>Definition:</b> ERF.H:1160</div></div>
<div class="ttc" id="anamespacederived_html_a37560f4d3e2c7c10f64d41db2ce76a06"><div class="ttname"><a href="namespacederived.html#a37560f4d3e2c7c10f64d41db2ce76a06">derived::erf_derscalar</a></div><div class="ttdeci">void erf_derscalar(const Box &amp;bx, FArrayBox &amp;derfab, int, int, const FArrayBox &amp;datfab, const Geometry &amp;, Real, const int *, const int)</div><div class="ttdef"><b>Definition:</b> ERF_Derive.cpp:165</div></div>
<div class="ttc" id="anamespacederived_html_a8bc196f7dfb365c426b0b7e720e479e2"><div class="ttname"><a href="namespacederived.html#a8bc196f7dfb365c426b0b7e720e479e2">derived::erf_dervortz</a></div><div class="ttdeci">void erf_dervortz(const amrex::Box &amp;bx, amrex::FArrayBox &amp;derfab, int dcomp, int ncomp, const amrex::FArrayBox &amp;datfab, const amrex::Geometry &amp;geomdata, amrex::Real, const int *, const int)</div><div class="ttdef"><b>Definition:</b> ERF_Derive.cpp:256</div></div>
<div class="ttc" id="anamespacederived_html_adc3c787125484205e4fc7cd85c25ab6c"><div class="ttname"><a href="namespacederived.html#adc3c787125484205e4fc7cd85c25ab6c">derived::erf_dertheta</a></div><div class="ttdeci">void erf_dertheta(const Box &amp;bx, FArrayBox &amp;derfab, int, int, const FArrayBox &amp;datfab, const Geometry &amp;, Real, const int *, const int)</div><div class="ttdef"><b>Definition:</b> ERF_Derive.cpp:144</div></div>
<div class="ttc" id="anamespacemodule__mp__morr__two__moment_html_a649e184a5c5c6d2eef72a390c18eb4e4"><div class="ttname"><a href="namespacemodule__mp__morr__two__moment.html#a649e184a5c5c6d2eef72a390c18eb4e4">module_mp_morr_two_moment::rr</a></div><div class="ttdeci">real(c_double), private rr</div><div class="ttdef"><b>Definition:</b> ERF_module_mp_morr_two_moment.F90:223</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a18e6dbbf968b4492e78aa427791620f4_cgraph.png" border="0" usemap="#aclassERF_a18e6dbbf968b4492e78aa427791620f4_cgraph" alt=""/></div>
<map name="aclassERF_a18e6dbbf968b4492e78aa427791620f4_cgraph" id="aclassERF_a18e6dbbf968b4492e78aa427791620f4_cgraph">
<area shape="rect" title=" " alt="" coords="5,81,111,108"/>
<area shape="rect" href="namespacederived.html#a37560f4d3e2c7c10f64d41db2ce76a06" title=" " alt="" coords="159,5,323,32"/>
<area shape="rect" href="namespacederived.html#adc3c787125484205e4fc7cd85c25ab6c" title=" " alt="" coords="161,56,320,83"/>
<area shape="rect" href="namespacederived.html#a8bc196f7dfb365c426b0b7e720e479e2" title=" " alt="" coords="161,107,320,133"/>
<area shape="rect" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469" title=" " alt="" coords="221,157,260,184"/>
<area shape="rect" href="namespacederived.html#a3786c6a8399bc2508bc129337c446af1" title=" " alt="" coords="371,31,557,57"/>
</map>
</div>

</div>
</div>
<a id="a6b1d727e63de2e49aa4f8e00b0dda1d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b1d727e63de2e49aa4f8e00b0dda1d5">&#9670;&nbsp;</a></span>estTimeStep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Real ERF::estTimeStep </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>level</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long &amp;&#160;</td>
          <td class="paramname"><em>dt_fast_ratio</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function that calls estTimeStep for each level</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">level</td><td>level of refinement (coarsest level i 0) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dt_fast_ratio</td><td>ratio of slow to fast time step </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;{</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    BL_PROFILE(<span class="stringliteral">&quot;ERF::estTimeStep()&quot;</span>);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    Real estdt_comp = 1.e20;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    Real estdt_lowM = 1.e20;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="comment">// We intentionally use the level 0 domain to compute whether to use this direction in the dt calculation</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> nxc = geom[0].Domain().length(0);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> nyc = geom[0].Domain().length(1);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span> dxinv = geom[level].InvCellSizeArray();</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span> dzinv = 1.0 / <a class="code" href="classERF.html#a15db5266359edba700f523f16da303a7">dz_min</a>[level];</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    MultiFab <span class="keyword">const</span>&amp; S_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[level][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>];</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    MultiFab ccvel(grids[level],dmap[level],3,0);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    average_face_to_cellcenter(ccvel,0,</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                               Array&lt;const MultiFab*,3&gt;{&amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[level][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                                                        &amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[level][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                                                        &amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[level][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>]});</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordtype">int</span> l_implicit_substepping = (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a7c414e2fb7c53479a2d21bb3a2d4099e">substepping_type</a>[level] == SubsteppingType::Implicit);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordtype">int</span> l_anelastic      = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa7be0d60ce3de3441d44082cc1b725ec">anelastic</a>[level];</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    Real estdt_comp_inv;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> == TerrainType::EB)</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    {</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <span class="keyword">const</span> <a class="code" href="classeb__.html">eb_</a>&amp; eb_lev = <a class="code" href="classERF.html#a2ae1074c3047ab0eb8286f73f5d4be0e">get_eb</a>(level);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <span class="keyword">const</span> MultiFab&amp; detJ = (eb_lev.<a class="code" href="classeb__.html#a74b48b1a80f3292f6002592f1d1d2bcd">get_const_factory</a>())-&gt;getVolFrac();</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        estdt_comp_inv = ReduceMax(S_new, ccvel, detJ, 0,</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        [=] AMREX_GPU_HOST_DEVICE (Box <span class="keyword">const</span>&amp; b,</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                                   Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; s,</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                                   Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; u,</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                                   Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; vf) -&gt; Real</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;           Real new_comp_dt = -1.e100;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;           amrex::Loop(b, [=,&amp;new_comp_dt] (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;           {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;               <span class="keywordflow">if</span> (vf(i,j,k) &gt; 0.)</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;               {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                   <span class="keyword">const</span> Real <a class="code" href="namespaceMicVar__Kess.html#ad5e2303f8f4cbf19829306f4a72d61a7a89de8c3bfc941080efb960e5119fbd61">rho</a>      = s(i, j, k, <a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                   <span class="keyword">const</span> Real rhotheta = s(i, j, k, <a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                   <span class="comment">// NOTE: even when moisture is present,</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                   <span class="comment">//       we only use the partial pressure of the dry air</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                   <span class="comment">//       to compute the soundspeed</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                   Real pressure = <a class="code" href="ERF__EOS_8H.html#a08354ab110fb9e873bce9250b4f4b46e">getPgivenRTh</a>(rhotheta);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                   Real c = std::sqrt(<a class="code" href="ERF__Constants_8H.html#afbb622bf3b404a3e7c77f3103b4d1231">Gamma</a> * pressure / <a class="code" href="namespaceMicVar__Kess.html#ad5e2303f8f4cbf19829306f4a72d61a7a89de8c3bfc941080efb960e5119fbd61">rho</a>);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                   <span class="comment">// If we are doing implicit acoustic substepping, then the z-direction does not contribute</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                   <span class="comment">//    to the computation of the time step</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                   <span class="keywordflow">if</span> (l_implicit_substepping) {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                       <span class="keywordflow">if</span> ((nxc &gt; 1) &amp;&amp; (nyc==1)) {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                           <span class="comment">// 2-D in x-z</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                           new_comp_dt = amrex::max(((amrex::Math::abs(u(i,j,k,0))+c)*dxinv[0]), new_comp_dt);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((nyc &gt; 1) &amp;&amp; (nxc==1)) {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                           <span class="comment">// 2-D in y-z</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                           new_comp_dt = amrex::max(((amrex::Math::abs(u(i,j,k,1))+c)*dxinv[1]), new_comp_dt);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                       } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                           <span class="comment">// 3-D or SCM</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                           new_comp_dt = amrex::max(((amrex::Math::abs(u(i,j,k,0))+c)*dxinv[0]),</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                                                    ((amrex::Math::abs(u(i,j,k,1))+c)*dxinv[1]), new_comp_dt);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                       }</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                   <span class="comment">// If we are not doing implicit acoustic substepping, then the z-direction contributes</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                   <span class="comment">//    to the computation of the time step</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                   } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                       <span class="keywordflow">if</span> (nxc &gt; 1 &amp;&amp; nyc &gt; 1) {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                           new_comp_dt = amrex::max(((amrex::Math::abs(u(i,j,k,0))+c)*dxinv[0]),</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                                                    ((amrex::Math::abs(u(i,j,k,1))+c)*dxinv[1]),</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                                                    ((amrex::Math::abs(u(i,j,k,2))+c)*dzinv   ), new_comp_dt);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nxc &gt; 1) {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                           new_comp_dt = amrex::max(((amrex::Math::abs(u(i,j,k,0))+c)*dxinv[0]),</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                                                    ((amrex::Math::abs(u(i,j,k,2))+c)*dzinv   ), new_comp_dt);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nyc &gt; 1) {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                           new_comp_dt = amrex::max(((amrex::Math::abs(u(i,j,k,1))+c)*dxinv[1]),</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                                                    ((amrex::Math::abs(u(i,j,k,2))+c)*dzinv   ), new_comp_dt);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                       } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                           new_comp_dt = amrex::max(((amrex::Math::abs(u(i,j,k,2))+c)*dzinv   ), new_comp_dt);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                       }</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                   }</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;               }</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;           });</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;           <span class="keywordflow">return</span> new_comp_dt;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;       });</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;       estdt_comp_inv = ReduceMax(S_new, ccvel, 0,</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;       [=] AMREX_GPU_HOST_DEVICE (Box <span class="keyword">const</span>&amp; b,</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                                  Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; s,</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                                  Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; u) -&gt; Real</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;       {</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;           Real new_comp_dt = -1.e100;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;           amrex::Loop(b, [=,&amp;new_comp_dt] (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;           {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;               {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                   <span class="keyword">const</span> Real <a class="code" href="namespaceMicVar__Kess.html#ad5e2303f8f4cbf19829306f4a72d61a7a89de8c3bfc941080efb960e5119fbd61">rho</a>      = s(i, j, k, <a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                   <span class="keyword">const</span> Real rhotheta = s(i, j, k, <a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                   <span class="comment">// NOTE: even when moisture is present,</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                   <span class="comment">//       we only use the partial pressure of the dry air</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                   <span class="comment">//       to compute the soundspeed</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                   Real pressure = <a class="code" href="ERF__EOS_8H.html#a08354ab110fb9e873bce9250b4f4b46e">getPgivenRTh</a>(rhotheta);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                   Real c = std::sqrt(<a class="code" href="ERF__Constants_8H.html#afbb622bf3b404a3e7c77f3103b4d1231">Gamma</a> * pressure / <a class="code" href="namespaceMicVar__Kess.html#ad5e2303f8f4cbf19829306f4a72d61a7a89de8c3bfc941080efb960e5119fbd61">rho</a>);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                   <span class="comment">// If we are doing implicit acoustic substepping, then the z-direction does not contribute</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                   <span class="comment">//    to the computation of the time step</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                   <span class="keywordflow">if</span> (l_implicit_substepping) {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                       <span class="keywordflow">if</span> ((nxc &gt; 1) &amp;&amp; (nyc==1)) {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                           <span class="comment">// 2-D in x-z</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                           new_comp_dt = amrex::max(((amrex::Math::abs(u(i,j,k,0))+c)*dxinv[0]), new_comp_dt);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((nyc &gt; 1) &amp;&amp; (nxc==1)) {</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                           <span class="comment">// 2-D in y-z</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                           new_comp_dt = amrex::max(((amrex::Math::abs(u(i,j,k,1))+c)*dxinv[1]), new_comp_dt);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                       } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                           <span class="comment">// 3-D or SCM</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                           new_comp_dt = amrex::max(((amrex::Math::abs(u(i,j,k,0))+c)*dxinv[0]),</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                                                    ((amrex::Math::abs(u(i,j,k,1))+c)*dxinv[1]), new_comp_dt);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                       }</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                   <span class="comment">// If we are not doing implicit acoustic substepping, then the z-direction contributes</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                   <span class="comment">//    to the computation of the time step</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                   } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                       <span class="keywordflow">if</span> (nxc &gt; 1 &amp;&amp; nyc &gt; 1) {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                           new_comp_dt = amrex::max(((amrex::Math::abs(u(i,j,k,0))+c)*dxinv[0]),</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                                                    ((amrex::Math::abs(u(i,j,k,1))+c)*dxinv[1]),</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                                                    ((amrex::Math::abs(u(i,j,k,2))+c)*dzinv   ), new_comp_dt);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nxc &gt; 1) {</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                           new_comp_dt = amrex::max(((amrex::Math::abs(u(i,j,k,0))+c)*dxinv[0]),</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                                                    ((amrex::Math::abs(u(i,j,k,2))+c)*dzinv   ), new_comp_dt);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nyc &gt; 1) {</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                           new_comp_dt = amrex::max(((amrex::Math::abs(u(i,j,k,1))+c)*dxinv[1]),</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                                                    ((amrex::Math::abs(u(i,j,k,2))+c)*dzinv   ), new_comp_dt);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                       } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                           new_comp_dt = amrex::max(((amrex::Math::abs(u(i,j,k,2))+c)*dzinv   ), new_comp_dt);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                       }</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                   }</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;               }</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;           });</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;           <span class="keywordflow">return</span> new_comp_dt;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;       });</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    } <span class="comment">// not EB</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    ParallelDescriptor::ReduceRealMax(estdt_comp_inv);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    estdt_comp = <a class="code" href="classERF.html#a89f605d1a1eae06a7c79f9b6b65c637f">cfl</a> / estdt_comp_inv;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;     Real estdt_lowM_inv = ReduceMax(ccvel, 0,</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;       [=] AMREX_GPU_HOST_DEVICE (Box <span class="keyword">const</span>&amp; b,</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                                  Array4&lt;Real const&gt; <span class="keyword">const</span>&amp; u) -&gt; Real</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;       {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;           Real new_lm_dt = -1.e100;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;           Loop(b, [=,&amp;new_lm_dt] (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;           {</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;               new_lm_dt = amrex::max(((amrex::Math::abs(u(i,j,k,0)))*dxinv[0]),</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                                      ((amrex::Math::abs(u(i,j,k,1)))*dxinv[1]),</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                                      ((amrex::Math::abs(u(i,j,k,2)))*dxinv[2]), new_lm_dt);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;           });</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;           <span class="keywordflow">return</span> new_lm_dt;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;       });</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;     ParallelDescriptor::ReduceRealMax(estdt_lowM_inv);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;     <span class="keywordflow">if</span> (estdt_lowM_inv &gt; 0.0_rt)</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;         estdt_lowM = <a class="code" href="classERF.html#a89f605d1a1eae06a7c79f9b6b65c637f">cfl</a> / estdt_lowM_inv;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;     <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a43d0b17f6e155691a1e9474526df3af5">verbose</a>) {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a393b540493795b8c6ee0f64634b8b815">fixed_dt</a>[level] &lt;= 0.0) {</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;             Print() &lt;&lt; <span class="stringliteral">&quot;Using cfl = &quot;</span> &lt;&lt; <a class="code" href="classERF.html#a89f605d1a1eae06a7c79f9b6b65c637f">cfl</a> &lt;&lt; <span class="stringliteral">&quot; and dx/dy/dz_min = &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;               1.0/dxinv[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; 1.0/dxinv[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="classERF.html#a15db5266359edba700f523f16da303a7">dz_min</a>[level] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;             Print() &lt;&lt; <span class="stringliteral">&quot;Compressible dt at level &quot;</span> &lt;&lt; level &lt;&lt; <span class="stringliteral">&quot;:  &quot;</span> &lt;&lt; estdt_comp &lt;&lt; std::endl;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;             <span class="keywordflow">if</span> (estdt_lowM_inv &gt; 0.0_rt) {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                 Print() &lt;&lt; <span class="stringliteral">&quot;Anelastic dt at level &quot;</span> &lt;&lt; level &lt;&lt; <span class="stringliteral">&quot;:  &quot;</span> &lt;&lt; estdt_lowM &lt;&lt; std::endl;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;             } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                 Print() &lt;&lt; <span class="stringliteral">&quot;Anelastic dt at level &quot;</span> &lt;&lt; level &lt;&lt; <span class="stringliteral">&quot;: undefined &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;             }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;         }</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a393b540493795b8c6ee0f64634b8b815">fixed_dt</a>[level] &gt; 0.0) {</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;             Print() &lt;&lt; <span class="stringliteral">&quot;Based on cfl of 1.0 &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;             Print() &lt;&lt; <span class="stringliteral">&quot;Compressible dt at level &quot;</span> &lt;&lt; level &lt;&lt; <span class="stringliteral">&quot; would be:  &quot;</span> &lt;&lt; estdt_comp/<a class="code" href="classERF.html#a89f605d1a1eae06a7c79f9b6b65c637f">cfl</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;             <span class="keywordflow">if</span> (estdt_lowM_inv &gt; 0.0_rt) {</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                 Print() &lt;&lt; <span class="stringliteral">&quot;Anelastic dt at level &quot;</span> &lt;&lt; level &lt;&lt; <span class="stringliteral">&quot; would be:  &quot;</span> &lt;&lt; estdt_lowM/<a class="code" href="classERF.html#a89f605d1a1eae06a7c79f9b6b65c637f">cfl</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;             } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                 Print() &lt;&lt; <span class="stringliteral">&quot;Anelastic dt at level &quot;</span> &lt;&lt; level &lt;&lt; <span class="stringliteral">&quot; would be undefined &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;             }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;             Print() &lt;&lt; <span class="stringliteral">&quot;Fixed dt at level &quot;</span> &lt;&lt; level &lt;&lt; <span class="stringliteral">&quot;       is:  &quot;</span> &lt;&lt; <a class="code" href="classERF.html#a393b540493795b8c6ee0f64634b8b815">fixed_dt</a>[level] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;             <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a4f3f43c6304a0a3ae78c42d54c05ee26">fixed_fast_dt</a>[level] &gt; 0.0) {</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                 Print() &lt;&lt; <span class="stringliteral">&quot;Fixed fast dt at level &quot;</span> &lt;&lt; level &lt;&lt; <span class="stringliteral">&quot;       is:  &quot;</span> &lt;&lt; <a class="code" href="classERF.html#a4f3f43c6304a0a3ae78c42d54c05ee26">fixed_fast_dt</a>[level] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;             }</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;         }</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;     }</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;     <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a7c414e2fb7c53479a2d21bb3a2d4099e">substepping_type</a>[level] != SubsteppingType::None) {</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a393b540493795b8c6ee0f64634b8b815">fixed_dt</a>[level] &gt; 0. &amp;&amp; <a class="code" href="classERF.html#a4f3f43c6304a0a3ae78c42d54c05ee26">fixed_fast_dt</a>[level] &gt; 0.) {</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;             dt_fast_ratio = <span class="keyword">static_cast&lt;</span><span class="keywordtype">long</span><span class="keyword">&gt;</span>( <a class="code" href="classERF.html#a393b540493795b8c6ee0f64634b8b815">fixed_dt</a>[level] / <a class="code" href="classERF.html#a4f3f43c6304a0a3ae78c42d54c05ee26">fixed_fast_dt</a>[level] );</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a393b540493795b8c6ee0f64634b8b815">fixed_dt</a>[level] &gt; 0.) {</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;             <span class="comment">// Max CFL_c = 1.0 for substeps by default, but we enforce a min of 4 substeps</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;             <span class="keyword">auto</span> dt_sub_max = (estdt_comp/<a class="code" href="classERF.html#a89f605d1a1eae06a7c79f9b6b65c637f">cfl</a> * <a class="code" href="classERF.html#addc2ee5eba2264ae2b2475970b0b8c2d">sub_cfl</a>);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;             dt_fast_ratio = <span class="keyword">static_cast&lt;</span><span class="keywordtype">long</span><span class="keyword">&gt;</span>( std::max(<a class="code" href="classERF.html#a393b540493795b8c6ee0f64634b8b815">fixed_dt</a>[level]/dt_sub_max,4.) );</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;         } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;             <span class="comment">// auto dt_sub_max = (estdt_comp/cfl * sub_cfl);</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;             <span class="comment">// dt_fast_ratio = static_cast&lt;long&gt;( std::max(estdt_comp/dt_sub_max,4.) );</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;             dt_fast_ratio = <span class="keyword">static_cast&lt;</span><span class="keywordtype">long</span><span class="keyword">&gt;</span>( std::max(<a class="code" href="classERF.html#a89f605d1a1eae06a7c79f9b6b65c637f">cfl</a> / <a class="code" href="classERF.html#addc2ee5eba2264ae2b2475970b0b8c2d">sub_cfl</a>, 4.) );</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;         }</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;         <span class="comment">// Force time step ratio to be an even value</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a3f8ae511632557066f6662eec79591e1">force_stage1_single_substep</a>) {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;             <span class="keywordflow">if</span> ( dt_fast_ratio%2 != 0) dt_fast_ratio += 1;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;         } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;             <span class="keywordflow">if</span> ( dt_fast_ratio%6 != 0) {</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                 Print() &lt;&lt; <span class="stringliteral">&quot;mri_dt_ratio = &quot;</span> &lt;&lt; dt_fast_ratio</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                         &lt;&lt; <span class="stringliteral">&quot; not divisible by 6 for N/3 substeps in stage 1&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                 dt_fast_ratio = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(std::ceil(dt_fast_ratio/6.0) * 6);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;             }</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;         }</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a43d0b17f6e155691a1e9474526df3af5">verbose</a>) {</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;             Print() &lt;&lt; <span class="stringliteral">&quot;smallest even ratio is: &quot;</span> &lt;&lt; dt_fast_ratio &lt;&lt; std::endl;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;         }</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;     } <span class="comment">// if substepping, either explicit or implicit</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;     <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a393b540493795b8c6ee0f64634b8b815">fixed_dt</a>[level] &gt; 0.0) {</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="classERF.html#a393b540493795b8c6ee0f64634b8b815">fixed_dt</a>[level];</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;     } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;         <span class="comment">// Anelastic (substepping is not allowed)</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;         <span class="keywordflow">if</span> (l_anelastic) {</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            <span class="comment">// Make sure that timestep is less than the dt_max</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            estdt_lowM = amrex::min(estdt_lowM, <a class="code" href="classERF.html#a3ec36cbd96abc7ac706fee7007ae9aeb">dt_max</a>);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            <span class="comment">// On the first timestep enforce dt_max_initial</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[level] == 0){</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                <span class="keywordflow">return</span> amrex::min(<a class="code" href="classERF.html#ad4b3bb9d744fb5dde65a21951b86e132">dt_max_initial</a>, estdt_lowM);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;             }</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;             <span class="keywordflow">return</span> estdt_lowM;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;            }</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160; </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;         <span class="comment">// Compressible with or without substepping</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;         } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;             <span class="keywordflow">return</span> estdt_comp;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;         }</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;     }</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;}</div>
<div class="ttc" id="aERF__Constants_8H_html_afbb622bf3b404a3e7c77f3103b4d1231"><div class="ttname"><a href="ERF__Constants_8H.html#afbb622bf3b404a3e7c77f3103b4d1231">Gamma</a></div><div class="ttdeci">constexpr amrex::Real Gamma</div><div class="ttdef"><b>Definition:</b> ERF_Constants.H:19</div></div>
<div class="ttc" id="aclassERF_html_a15db5266359edba700f523f16da303a7"><div class="ttname"><a href="classERF.html#a15db5266359edba700f523f16da303a7">ERF::dz_min</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Real &gt; dz_min</div><div class="ttdef"><b>Definition:</b> ERF.H:1168</div></div>
<div class="ttc" id="aclassERF_html_a2ae1074c3047ab0eb8286f73f5d4be0e"><div class="ttname"><a href="classERF.html#a2ae1074c3047ab0eb8286f73f5d4be0e">ERF::get_eb</a></div><div class="ttdeci">eb_ const  &amp; get_eb(int lev) const noexcept</div><div class="ttdef"><b>Definition:</b> ERF.H:1442</div></div>
<div class="ttc" id="aclassERF_html_a393b540493795b8c6ee0f64634b8b815"><div class="ttname"><a href="classERF.html#a393b540493795b8c6ee0f64634b8b815">ERF::fixed_dt</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Real &gt; fixed_dt</div><div class="ttdef"><b>Definition:</b> ERF.H:913</div></div>
<div class="ttc" id="aclassERF_html_a3ec36cbd96abc7ac706fee7007ae9aeb"><div class="ttname"><a href="classERF.html#a3ec36cbd96abc7ac706fee7007ae9aeb">ERF::dt_max</a></div><div class="ttdeci">static amrex::Real dt_max</div><div class="ttdef"><b>Definition:</b> ERF.H:910</div></div>
<div class="ttc" id="aclassERF_html_a4f3f43c6304a0a3ae78c42d54c05ee26"><div class="ttname"><a href="classERF.html#a4f3f43c6304a0a3ae78c42d54c05ee26">ERF::fixed_fast_dt</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Real &gt; fixed_fast_dt</div><div class="ttdef"><b>Definition:</b> ERF.H:914</div></div>
<div class="ttc" id="aclassERF_html_a89f605d1a1eae06a7c79f9b6b65c637f"><div class="ttname"><a href="classERF.html#a89f605d1a1eae06a7c79f9b6b65c637f">ERF::cfl</a></div><div class="ttdeci">static amrex::Real cfl</div><div class="ttdef"><b>Definition:</b> ERF.H:905</div></div>
<div class="ttc" id="aclassERF_html_addc2ee5eba2264ae2b2475970b0b8c2d"><div class="ttname"><a href="classERF.html#addc2ee5eba2264ae2b2475970b0b8c2d">ERF::sub_cfl</a></div><div class="ttdeci">static amrex::Real sub_cfl</div><div class="ttdef"><b>Definition:</b> ERF.H:906</div></div>
<div class="ttc" id="aclasseb___html"><div class="ttname"><a href="classeb__.html">eb_</a></div><div class="ttdef"><b>Definition:</b> ERF_EB.H:13</div></div>
<div class="ttc" id="aclasseb___html_a74b48b1a80f3292f6002592f1d1d2bcd"><div class="ttname"><a href="classeb__.html#a74b48b1a80f3292f6002592f1d1d2bcd">eb_::get_const_factory</a></div><div class="ttdeci">const std::unique_ptr&lt; amrex::EBFArrayBoxFactory &gt; &amp; get_const_factory() const noexcept</div><div class="ttdef"><b>Definition:</b> ERF_EB.H:46</div></div>
<div class="ttc" id="anamespaceMicVar__Kess_html_ad5e2303f8f4cbf19829306f4a72d61a7a89de8c3bfc941080efb960e5119fbd61"><div class="ttname"><a href="namespaceMicVar__Kess.html#ad5e2303f8f4cbf19829306f4a72d61a7a89de8c3bfc941080efb960e5119fbd61">MicVar_Kess::rho</a></div><div class="ttdeci">@ rho</div><div class="ttdef"><b>Definition:</b> ERF_Kessler.H:22</div></div>
<div class="ttc" id="astructSolverChoice_html_a3f8ae511632557066f6662eec79591e1"><div class="ttname"><a href="structSolverChoice.html#a3f8ae511632557066f6662eec79591e1">SolverChoice::force_stage1_single_substep</a></div><div class="ttdeci">int force_stage1_single_substep</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:721</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a6b1d727e63de2e49aa4f8e00b0dda1d5_cgraph.png" border="0" usemap="#aclassERF_a6b1d727e63de2e49aa4f8e00b0dda1d5_cgraph" alt=""/></div>
<map name="aclassERF_a6b1d727e63de2e49aa4f8e00b0dda1d5_cgraph" id="aclassERF_a6b1d727e63de2e49aa4f8e00b0dda1d5_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,141,57"/>
<area shape="rect" href="classeb__.html#a74b48b1a80f3292f6002592f1d1d2bcd" title=" " alt="" coords="189,5,359,32"/>
<area shape="rect" href="ERF__EOS_8H.html#a08354ab110fb9e873bce9250b4f4b46e" title=" " alt="" coords="219,56,329,83"/>
</map>
</div>

</div>
</div>
<a id="a0be12798b46f52fa4b5a995f147c3f96"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0be12798b46f52fa4b5a995f147c3f96">&#9670;&nbsp;</a></span>Evolve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::Evolve </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;{</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    BL_PROFILE_VAR(<span class="stringliteral">&quot;ERF::Evolve()&quot;</span>, evolve);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160; </div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    Real cur_time = <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0];</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160; </div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="comment">// Take one coarse timestep by calling timeStep -- which recursively calls timeStep</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="comment">//      for finer levels (with or without subcycling)</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> step = <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[0]; step &lt; <a class="code" href="classERF.html#a0634154e8e58379c495c3e7fe7c5e4d6">max_step</a> &amp;&amp; cur_time &lt; <a class="code" href="classERF.html#a405556a52bef334ab68294c1a540e107">stop_time</a>; ++step)</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    {</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a90e3592862d7330b39a11399d34a3539">use_datetime</a>) {</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;            Print() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span> &lt;&lt; <a class="code" href="ERF__EpochTime_8H.html#aacf5892cc74a8dbd2ae4af27af5b4e6e">getTimestamp</a>(cur_time, <a class="code" href="classERF.html#a85bb96a0b6593ee192a04ceef62abdf6">datetime_format</a>)</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; cur_time-<a class="code" href="classERF.html#aa0c07f31b23d977646b8161e5473fab5">start_time</a> &lt;&lt; <span class="stringliteral">&quot; s elapsed)&quot;</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                    &lt;&lt; std::endl;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        }</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        Print() &lt;&lt; <span class="stringliteral">&quot;\nCoarse STEP &quot;</span> &lt;&lt; step+1 &lt;&lt; <span class="stringliteral">&quot; starts ...&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160; </div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        <a class="code" href="classERF.html#aa38639155e79bab8a0c283aa6e7afa81">ComputeDt</a>(step);</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160; </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <span class="comment">// Make sure we have read enough of the boundary plane data to make it through this timestep</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a80ad08512968ec45635df68abe66b1fc">input_bndry_planes</a>)</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        {</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;read_input_files(cur_time,<a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[0],<a class="code" href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">m_bc_extdir_vals</a>);</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        }</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160; </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        <span class="keywordtype">int</span> lev = 0;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        <span class="keywordtype">int</span> iteration = 1;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        <a class="code" href="classERF.html#aff397ccf7eb99c51d7c705a35e85ec5f">timeStep</a>(lev, cur_time, iteration);</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160; </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        cur_time  += <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[0];</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160; </div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        Print() &lt;&lt; <span class="stringliteral">&quot;Coarse STEP &quot;</span> &lt;&lt; step+1 &lt;&lt; <span class="stringliteral">&quot; ends.&quot;</span> &lt;&lt; <span class="stringliteral">&quot; TIME = &quot;</span> &lt;&lt; cur_time</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; DT = &quot;</span> &lt;&lt; <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[0]  &lt;&lt; std::endl;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160; </div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        <a class="code" href="classERF.html#a58f6683aff0fbe6949bfe8b49275a8b3">post_timestep</a>(step, cur_time, <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[0]);</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160; </div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#af2e4de4eaa0f93149c1aefd58dc7068a">writeNow</a>(cur_time, <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[0], step+1, <a class="code" href="classERF.html#a57cfb4bfead8525174646964992c7e69">m_plot_int_1</a>, <a class="code" href="classERF.html#a3167adc9518cce649a90ab82e9f9c85d">m_plot_per_1</a>)) {</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;            <a class="code" href="classERF.html#a7d54d3f2317d06a8dfcde4f65cfc3e92">last_plot_file_step_1</a> = step+1;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;            <a class="code" href="classERF.html#a98cccb83ca76c44d6ae583d051e76faf">WritePlotFile</a>(1,<a class="code" href="classERF.html#a184511b7b9b7d4beef453f5d5d679c54">plotfile_type_1</a>,<a class="code" href="classERF.html#a6865cf87abbb5aab0db00ff3b1ce94ac">plot_var_names_1</a>);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        }</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#af2e4de4eaa0f93149c1aefd58dc7068a">writeNow</a>(cur_time, <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[0], step+1, <a class="code" href="classERF.html#ad3311c9ceacd17f34bdb5e03cefa33b3">m_plot_int_2</a>, <a class="code" href="classERF.html#aff879a9c686293a10a3a03027b765c51">m_plot_per_2</a>)) {</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;            <a class="code" href="classERF.html#a09017292c9943ac2ed20ce7ed5c3c767">last_plot_file_step_2</a> = step+1;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;            <a class="code" href="classERF.html#a98cccb83ca76c44d6ae583d051e76faf">WritePlotFile</a>(2,<a class="code" href="classERF.html#a980e94505df2ee0925612b004126df77">plotfile_type_2</a>,<a class="code" href="classERF.html#a79705c02d6f25fbdcec14ca2432e5da1">plot_var_names_2</a>);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        }</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#af2e4de4eaa0f93149c1aefd58dc7068a">writeNow</a>(cur_time, <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[0], step+1, <a class="code" href="classERF.html#a2420086cf8dc54d9507c40358930f521">m_subvol_int</a>, <a class="code" href="classERF.html#a595273f0f44d0e481a2da65263e5c2ae">m_subvol_per</a>)) {</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;            <a class="code" href="classERF.html#a8536c38a2a5f44a5719cad3c44d0d438">last_subvol</a> = step+1;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;            <a class="code" href="classERF.html#a3849ef0f90b5798c571259313a3d501a">WriteSubvolume</a>();</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        }</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160; </div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#af2e4de4eaa0f93149c1aefd58dc7068a">writeNow</a>(cur_time, <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[0], step+1, <a class="code" href="classERF.html#a69a3f925e95ec4244b0257f9de16d65a">m_check_int</a>, <a class="code" href="classERF.html#a5fbf17cfc8d9e5b994783e05ec3594b2">m_check_per</a>)) {</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;            <a class="code" href="classERF.html#a02722d16f3c26efe590702200f1296d7">last_check_file_step</a> = step+1;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;            <a class="code" href="classERF.html#ad101fd46096db2d6b21544bfede6551f">WriteCheckpointFile</a>();</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        }</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160; </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="preprocessor">#ifdef AMREX_MEM_PROFILING</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        {</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;            std::ostringstream ss;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;            ss &lt;&lt; <span class="stringliteral">&quot;[STEP &quot;</span> &lt;&lt; step+1 &lt;&lt; <span class="stringliteral">&quot;]&quot;</span>;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;            MemProfiler::report(ss.str());</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        }</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160; </div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        <span class="keywordflow">if</span> (cur_time &gt;= <a class="code" href="classERF.html#a405556a52bef334ab68294c1a540e107">stop_time</a> - 1.e-6*<a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[0]) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    }</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160; </div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="comment">// Write plotfiles at final time</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="keywordflow">if</span> ( (<a class="code" href="classERF.html#a57cfb4bfead8525174646964992c7e69">m_plot_int_1</a> &gt; 0 || <a class="code" href="classERF.html#a3167adc9518cce649a90ab82e9f9c85d">m_plot_per_1</a> &gt; 0.) &amp;&amp; <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[0] &gt; <a class="code" href="classERF.html#a7d54d3f2317d06a8dfcde4f65cfc3e92">last_plot_file_step_1</a> ) {</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        <a class="code" href="classERF.html#a98cccb83ca76c44d6ae583d051e76faf">WritePlotFile</a>(1,<a class="code" href="classERF.html#a184511b7b9b7d4beef453f5d5d679c54">plotfile_type_1</a>,<a class="code" href="classERF.html#a6865cf87abbb5aab0db00ff3b1ce94ac">plot_var_names_1</a>);</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    }</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <span class="keywordflow">if</span> ( (<a class="code" href="classERF.html#ad3311c9ceacd17f34bdb5e03cefa33b3">m_plot_int_2</a> &gt; 0 || <a class="code" href="classERF.html#aff879a9c686293a10a3a03027b765c51">m_plot_per_2</a> &gt; 0.) &amp;&amp; <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[0] &gt; <a class="code" href="classERF.html#a09017292c9943ac2ed20ce7ed5c3c767">last_plot_file_step_2</a>) {</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        <a class="code" href="classERF.html#a98cccb83ca76c44d6ae583d051e76faf">WritePlotFile</a>(2,<a class="code" href="classERF.html#a184511b7b9b7d4beef453f5d5d679c54">plotfile_type_1</a>,<a class="code" href="classERF.html#a79705c02d6f25fbdcec14ca2432e5da1">plot_var_names_2</a>);</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    }</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <span class="keywordflow">if</span> ( (<a class="code" href="classERF.html#a2420086cf8dc54d9507c40358930f521">m_subvol_int</a> &gt; 0 || <a class="code" href="classERF.html#a595273f0f44d0e481a2da65263e5c2ae">m_subvol_per</a> &gt; 0.) &amp;&amp; <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[0] &gt; <a class="code" href="classERF.html#a8536c38a2a5f44a5719cad3c44d0d438">last_subvol</a>) {</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        <a class="code" href="classERF.html#a3849ef0f90b5798c571259313a3d501a">WriteSubvolume</a>();</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    }</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160; </div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="keywordflow">if</span> ( (<a class="code" href="classERF.html#a69a3f925e95ec4244b0257f9de16d65a">m_check_int</a> &gt; 0 || <a class="code" href="classERF.html#a5fbf17cfc8d9e5b994783e05ec3594b2">m_check_per</a> &gt; 0.) &amp;&amp; <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[0] &gt; <a class="code" href="classERF.html#a02722d16f3c26efe590702200f1296d7">last_check_file_step</a>) {</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        <a class="code" href="classERF.html#ad101fd46096db2d6b21544bfede6551f">WriteCheckpointFile</a>();</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    }</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160; </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    BL_PROFILE_VAR_STOP(evolve);</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;}</div>
<div class="ttc" id="aERF__EpochTime_8H_html_aacf5892cc74a8dbd2ae4af27af5b4e6e"><div class="ttname"><a href="ERF__EpochTime_8H.html#aacf5892cc74a8dbd2ae4af27af5b4e6e">getTimestamp</a></div><div class="ttdeci">AMREX_FORCE_INLINE std::string getTimestamp(const amrex::Real epoch_real, const std::string &amp;datetime_format)</div><div class="ttdef"><b>Definition:</b> ERF_EpochTime.H:35</div></div>
<div class="ttc" id="aclassERF_html_a02722d16f3c26efe590702200f1296d7"><div class="ttname"><a href="classERF.html#a02722d16f3c26efe590702200f1296d7">ERF::last_check_file_step</a></div><div class="ttdeci">int last_check_file_step</div><div class="ttdef"><b>Definition:</b> ERF.H:881</div></div>
<div class="ttc" id="aclassERF_html_a0634154e8e58379c495c3e7fe7c5e4d6"><div class="ttname"><a href="classERF.html#a0634154e8e58379c495c3e7fe7c5e4d6">ERF::max_step</a></div><div class="ttdeci">int max_step</div><div class="ttdef"><b>Definition:</b> ERF.H:894</div></div>
<div class="ttc" id="aclassERF_html_a09017292c9943ac2ed20ce7ed5c3c767"><div class="ttname"><a href="classERF.html#a09017292c9943ac2ed20ce7ed5c3c767">ERF::last_plot_file_step_2</a></div><div class="ttdeci">int last_plot_file_step_2</div><div class="ttdef"><b>Definition:</b> ERF.H:878</div></div>
<div class="ttc" id="aclassERF_html_a184511b7b9b7d4beef453f5d5d679c54"><div class="ttname"><a href="classERF.html#a184511b7b9b7d4beef453f5d5d679c54">ERF::plotfile_type_1</a></div><div class="ttdeci">static PlotFileType plotfile_type_1</div><div class="ttdef"><b>Definition:</b> ERF.H:1037</div></div>
<div class="ttc" id="aclassERF_html_a2420086cf8dc54d9507c40358930f521"><div class="ttname"><a href="classERF.html#a2420086cf8dc54d9507c40358930f521">ERF::m_subvol_int</a></div><div class="ttdeci">int m_subvol_int</div><div class="ttdef"><b>Definition:</b> ERF.H:932</div></div>
<div class="ttc" id="aclassERF_html_a27261ba76aa71f1ddbf87bca0ede579f"><div class="ttname"><a href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">ERF::m_bc_extdir_vals</a></div><div class="ttdeci">amrex::Array&lt; amrex::Array&lt; amrex::Real, AMREX_SPACEDIM *2 &gt;, AMREX_SPACEDIM+NBCVAR_max &gt; m_bc_extdir_vals</div><div class="ttdef"><b>Definition:</b> ERF.H:858</div></div>
<div class="ttc" id="aclassERF_html_a3167adc9518cce649a90ab82e9f9c85d"><div class="ttname"><a href="classERF.html#a3167adc9518cce649a90ab82e9f9c85d">ERF::m_plot_per_1</a></div><div class="ttdeci">amrex::Real m_plot_per_1</div><div class="ttdef"><b>Definition:</b> ERF.H:933</div></div>
<div class="ttc" id="aclassERF_html_a3849ef0f90b5798c571259313a3d501a"><div class="ttname"><a href="classERF.html#a3849ef0f90b5798c571259313a3d501a">ERF::WriteSubvolume</a></div><div class="ttdeci">void WriteSubvolume()</div><div class="ttdef"><b>Definition:</b> ERF_WriteSubvolume.cpp:9</div></div>
<div class="ttc" id="aclassERF_html_a57cfb4bfead8525174646964992c7e69"><div class="ttname"><a href="classERF.html#a57cfb4bfead8525174646964992c7e69">ERF::m_plot_int_1</a></div><div class="ttdeci">int m_plot_int_1</div><div class="ttdef"><b>Definition:</b> ERF.H:930</div></div>
<div class="ttc" id="aclassERF_html_a58f6683aff0fbe6949bfe8b49275a8b3"><div class="ttname"><a href="classERF.html#a58f6683aff0fbe6949bfe8b49275a8b3">ERF::post_timestep</a></div><div class="ttdeci">void post_timestep(int nstep, amrex::Real time, amrex::Real dt_lev)</div><div class="ttdef"><b>Definition:</b> ERF.cpp:537</div></div>
<div class="ttc" id="aclassERF_html_a595273f0f44d0e481a2da65263e5c2ae"><div class="ttname"><a href="classERF.html#a595273f0f44d0e481a2da65263e5c2ae">ERF::m_subvol_per</a></div><div class="ttdeci">amrex::Real m_subvol_per</div><div class="ttdef"><b>Definition:</b> ERF.H:935</div></div>
<div class="ttc" id="aclassERF_html_a5fbf17cfc8d9e5b994783e05ec3594b2"><div class="ttname"><a href="classERF.html#a5fbf17cfc8d9e5b994783e05ec3594b2">ERF::m_check_per</a></div><div class="ttdeci">amrex::Real m_check_per</div><div class="ttdef"><b>Definition:</b> ERF.H:947</div></div>
<div class="ttc" id="aclassERF_html_a69a3f925e95ec4244b0257f9de16d65a"><div class="ttname"><a href="classERF.html#a69a3f925e95ec4244b0257f9de16d65a">ERF::m_check_int</a></div><div class="ttdeci">int m_check_int</div><div class="ttdef"><b>Definition:</b> ERF.H:946</div></div>
<div class="ttc" id="aclassERF_html_a7d54d3f2317d06a8dfcde4f65cfc3e92"><div class="ttname"><a href="classERF.html#a7d54d3f2317d06a8dfcde4f65cfc3e92">ERF::last_plot_file_step_1</a></div><div class="ttdeci">int last_plot_file_step_1</div><div class="ttdef"><b>Definition:</b> ERF.H:877</div></div>
<div class="ttc" id="aclassERF_html_a80ad08512968ec45635df68abe66b1fc"><div class="ttname"><a href="classERF.html#a80ad08512968ec45635df68abe66b1fc">ERF::input_bndry_planes</a></div><div class="ttdeci">static int input_bndry_planes</div><div class="ttdef"><b>Definition:</b> ERF.H:1096</div></div>
<div class="ttc" id="aclassERF_html_a8536c38a2a5f44a5719cad3c44d0d438"><div class="ttname"><a href="classERF.html#a8536c38a2a5f44a5719cad3c44d0d438">ERF::last_subvol</a></div><div class="ttdeci">int last_subvol</div><div class="ttdef"><b>Definition:</b> ERF.H:879</div></div>
<div class="ttc" id="aclassERF_html_a85bb96a0b6593ee192a04ceef62abdf6"><div class="ttname"><a href="classERF.html#a85bb96a0b6593ee192a04ceef62abdf6">ERF::datetime_format</a></div><div class="ttdeci">const std::string datetime_format</div><div class="ttdef"><b>Definition:</b> ERF.H:899</div></div>
<div class="ttc" id="aclassERF_html_a90e3592862d7330b39a11399d34a3539"><div class="ttname"><a href="classERF.html#a90e3592862d7330b39a11399d34a3539">ERF::use_datetime</a></div><div class="ttdeci">bool use_datetime</div><div class="ttdef"><b>Definition:</b> ERF.H:898</div></div>
<div class="ttc" id="aclassERF_html_a980e94505df2ee0925612b004126df77"><div class="ttname"><a href="classERF.html#a980e94505df2ee0925612b004126df77">ERF::plotfile_type_2</a></div><div class="ttdeci">static PlotFileType plotfile_type_2</div><div class="ttdef"><b>Definition:</b> ERF.H:1038</div></div>
<div class="ttc" id="aclassERF_html_a98cccb83ca76c44d6ae583d051e76faf"><div class="ttname"><a href="classERF.html#a98cccb83ca76c44d6ae583d051e76faf">ERF::WritePlotFile</a></div><div class="ttdeci">void WritePlotFile(int which, PlotFileType plotfile_type, amrex::Vector&lt; std::string &gt; plot_var_names)</div><div class="ttdef"><b>Definition:</b> ERF_Plotfile.cpp:261</div></div>
<div class="ttc" id="aclassERF_html_aa0c07f31b23d977646b8161e5473fab5"><div class="ttname"><a href="classERF.html#aa0c07f31b23d977646b8161e5473fab5">ERF::start_time</a></div><div class="ttdeci">amrex::Real start_time</div><div class="ttdef"><b>Definition:</b> ERF.H:895</div></div>
<div class="ttc" id="aclassERF_html_aa38639155e79bab8a0c283aa6e7afa81"><div class="ttname"><a href="classERF.html#aa38639155e79bab8a0c283aa6e7afa81">ERF::ComputeDt</a></div><div class="ttdeci">void ComputeDt(int step=-1)</div><div class="ttdef"><b>Definition:</b> ERF_ComputeTimestep.cpp:11</div></div>
<div class="ttc" id="aclassERF_html_ad101fd46096db2d6b21544bfede6551f"><div class="ttname"><a href="classERF.html#ad101fd46096db2d6b21544bfede6551f">ERF::WriteCheckpointFile</a></div><div class="ttdeci">void WriteCheckpointFile() const</div><div class="ttdef"><b>Definition:</b> ERF_Checkpoint.cpp:26</div></div>
<div class="ttc" id="aclassERF_html_ad3311c9ceacd17f34bdb5e03cefa33b3"><div class="ttname"><a href="classERF.html#ad3311c9ceacd17f34bdb5e03cefa33b3">ERF::m_plot_int_2</a></div><div class="ttdeci">int m_plot_int_2</div><div class="ttdef"><b>Definition:</b> ERF.H:931</div></div>
<div class="ttc" id="aclassERF_html_addf62bfc534515447b94e928ac0b7135"><div class="ttname"><a href="classERF.html#addf62bfc534515447b94e928ac0b7135">ERF::m_r2d</a></div><div class="ttdeci">std::unique_ptr&lt; ReadBndryPlanes &gt; m_r2d</div><div class="ttdef"><b>Definition:</b> ERF.H:1153</div></div>
<div class="ttc" id="aclassERF_html_af2e4de4eaa0f93149c1aefd58dc7068a"><div class="ttname"><a href="classERF.html#af2e4de4eaa0f93149c1aefd58dc7068a">ERF::writeNow</a></div><div class="ttdeci">bool writeNow(const amrex::Real cur_time, const amrex::Real dt, const int nstep, const int plot_int, const amrex::Real plot_per)</div><div class="ttdef"><b>Definition:</b> ERF.cpp:2258</div></div>
<div class="ttc" id="aclassERF_html_aff397ccf7eb99c51d7c705a35e85ec5f"><div class="ttname"><a href="classERF.html#aff397ccf7eb99c51d7c705a35e85ec5f">ERF::timeStep</a></div><div class="ttdeci">void timeStep(int lev, amrex::Real time, int iteration)</div><div class="ttdef"><b>Definition:</b> ERF_TimeStep.cpp:17</div></div>
<div class="ttc" id="aclassERF_html_aff879a9c686293a10a3a03027b765c51"><div class="ttname"><a href="classERF.html#aff879a9c686293a10a3a03027b765c51">ERF::m_plot_per_2</a></div><div class="ttdeci">amrex::Real m_plot_per_2</div><div class="ttdef"><b>Definition:</b> ERF.H:934</div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a0be12798b46f52fa4b5a995f147c3f96_cgraph.png" border="0" usemap="#aclassERF_a0be12798b46f52fa4b5a995f147c3f96_cgraph" alt=""/></div>
<map name="aclassERF_a0be12798b46f52fa4b5a995f147c3f96_cgraph" id="aclassERF_a0be12798b46f52fa4b5a995f147c3f96_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,104,32"/>
<area shape="rect" href="ERF__EpochTime_8H.html#aacf5892cc74a8dbd2ae4af27af5b4e6e" title=" " alt="" coords="152,5,269,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a0be12798b46f52fa4b5a995f147c3f96_icgraph.png" border="0" usemap="#aclassERF_a0be12798b46f52fa4b5a995f147c3f96_icgraph" alt=""/></div>
<map name="aclassERF_a0be12798b46f52fa4b5a995f147c3f96_icgraph" id="aclassERF_a0be12798b46f52fa4b5a995f147c3f96_icgraph">
<area shape="rect" title=" " alt="" coords="108,5,207,32"/>
<area shape="rect" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,60,32"/>
</map>
</div>

</div>
</div>
<a id="a2135641de33dea5057799569c74cac42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2135641de33dea5057799569c74cac42">&#9670;&nbsp;</a></span>fill_from_bndryregs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::fill_from_bndryregs </td>
          <td>(</td>
          <td class="paramtype">const amrex::Vector&lt; amrex::MultiFab * &gt; &amp;&#160;</td>
          <td class="paramname"><em>mfs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;{</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <span class="comment">// We now assume that if we read in on one face, we read in on all faces</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    AMREX_ALWAYS_ASSERT(<a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>);</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160; </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <span class="keywordtype">int</span> lev = 0;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="keyword">const</span> Box&amp; domain = geom[lev].Domain();</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code" href="ERF__DiffSetup_8H.html#a2987796b2d40db9890dd3497cc7e20ca">dom_lo</a> = lbound(domain);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code" href="ERF__DiffSetup_8H.html#a0f2c81fa9e8171e1116919f8b1ae0b28">dom_hi</a> = ubound(domain);</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    Vector&lt;std::unique_ptr&lt;PlaneVector&gt;&gt;&amp; bndry_data = <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;interp_in_time(time);</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keyword">const</span> BCRec* bc_ptr = <a class="code" href="classERF.html#a8a99e22b1111c803e31b4afd5fcdea60">domain_bcs_type_d</a>.data();</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="comment">// xlo: ori = 0</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="comment">// ylo: ori = 1</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="comment">// zlo: ori = 2</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="comment">// xhi: ori = 3</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="comment">// yhi: ori = 4</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="comment">// zhi: ori = 5</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; bdatxlo = (*bndry_data[0])[lev].const_array();</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; bdatylo = (*bndry_data[1])[lev].const_array();</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; bdatxhi = (*bndry_data[3])[lev].const_array();</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; bdatyhi = (*bndry_data[4])[lev].const_array();</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keywordtype">int</span> bccomp;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> var_idx = 0; var_idx &lt; <a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a5deccaa24d5e74279425d7749f7d1494">Vars::NumTypes</a>; ++var_idx)</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    {</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        MultiFab&amp; mf = *mfs[var_idx];</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> icomp = 0;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> ncomp = mf.nComp();</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <span class="keywordflow">if</span> (var_idx == <a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>) {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;           bccomp = <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (var_idx == <a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>) {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;           bccomp = <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a>;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (var_idx == <a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>) {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;           bccomp = <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa03b35ec9e83f34bb1349a86965d34e34">BCVars::zvel_bc</a>;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        } <span class="keywordflow">else</span>  <span class="keywordflow">if</span> (var_idx == <a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>) {</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;           bccomp = <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        }</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#ifdef AMREX_USE_OMP</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#pragma omp parallel if (Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <span class="keywordflow">for</span> (MFIter mfi(mf); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            <span class="keyword">const</span> Array4&lt;Real&gt;&amp; dest_arr = mf.array(mfi);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;            Box bx = mfi.growntilebox();</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;            <span class="comment">// x-faces</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;            {</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;            Box bx_xlo(bx); bx_xlo.setBig(0,<a class="code" href="ERF__DiffSetup_8H.html#a2987796b2d40db9890dd3497cc7e20ca">dom_lo</a>.x-1);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;            <span class="keywordflow">if</span> (var_idx == <a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>) bx_xlo.setBig(0,<a class="code" href="ERF__DiffSetup_8H.html#a2987796b2d40db9890dd3497cc7e20ca">dom_lo</a>.x);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            Box bx_xhi(bx); bx_xhi.setSmall(0,<a class="code" href="ERF__DiffSetup_8H.html#a0f2c81fa9e8171e1116919f8b1ae0b28">dom_hi</a>.x+1);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            <span class="keywordflow">if</span> (var_idx == <a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>) bx_xhi.setSmall(0,<a class="code" href="ERF__DiffSetup_8H.html#a0f2c81fa9e8171e1116919f8b1ae0b28">dom_hi</a>.x);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;            ParallelFor(</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                bx_xlo, ncomp, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k, <span class="keywordtype">int</span> n) {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                    <span class="keywordtype">int</span> bc_comp = (icomp+n &gt;= <a class="code" href="ERF__IndexDefines_8H.html#a0296f21cd48e5d8236c62ae4ce319b2f">RhoScalar_comp</a> &amp;&amp; icomp+n &lt; <a class="code" href="ERF__IndexDefines_8H.html#a0296f21cd48e5d8236c62ae4ce319b2f">RhoScalar_comp</a>+<a class="code" href="ERF__IndexDefines_8H.html#a6773f201eef9644a5d5b7252f6d95ce9">NSCALARS</a>) ?</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                                   <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa029ef491930290dea3a984ebdb6d6ae4">BCVars::RhoScalar_bc_comp</a> : icomp+n;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                    <span class="keywordflow">if</span> (bc_ptr[bc_comp].lo(0) == <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca138e8c6c2427dcd78959f3e0e84b3462">ERFBCType::ext_dir_ingested</a>) {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                        <span class="keywordtype">int</span> jb = std::min(std::max(j,<a class="code" href="ERF__DiffSetup_8H.html#a2987796b2d40db9890dd3497cc7e20ca">dom_lo</a>.y),<a class="code" href="ERF__DiffSetup_8H.html#a0f2c81fa9e8171e1116919f8b1ae0b28">dom_hi</a>.y);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                        <span class="keywordtype">int</span> kb = std::min(std::max(k,<a class="code" href="ERF__DiffSetup_8H.html#a2987796b2d40db9890dd3497cc7e20ca">dom_lo</a>.z),<a class="code" href="ERF__DiffSetup_8H.html#a0f2c81fa9e8171e1116919f8b1ae0b28">dom_hi</a>.z);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                        dest_arr(i,j,k,icomp+n) = bdatxlo(<a class="code" href="ERF__DiffSetup_8H.html#a2987796b2d40db9890dd3497cc7e20ca">dom_lo</a>.x-1,jb,kb,bccomp+n);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                    }</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                },</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                bx_xhi, ncomp, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k, <span class="keywordtype">int</span> n) {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                    <span class="keywordtype">int</span> bc_comp = (icomp+n &gt;= <a class="code" href="ERF__IndexDefines_8H.html#a0296f21cd48e5d8236c62ae4ce319b2f">RhoScalar_comp</a> &amp;&amp; icomp+n &lt; <a class="code" href="ERF__IndexDefines_8H.html#a0296f21cd48e5d8236c62ae4ce319b2f">RhoScalar_comp</a>+<a class="code" href="ERF__IndexDefines_8H.html#a6773f201eef9644a5d5b7252f6d95ce9">NSCALARS</a>) ?</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                                   <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa029ef491930290dea3a984ebdb6d6ae4">BCVars::RhoScalar_bc_comp</a> : icomp+n;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                    <span class="keywordflow">if</span> (bc_ptr[bc_comp].hi(0) == <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca138e8c6c2427dcd78959f3e0e84b3462">ERFBCType::ext_dir_ingested</a>) {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                        <span class="keywordtype">int</span> jb = std::min(std::max(j,<a class="code" href="ERF__DiffSetup_8H.html#a2987796b2d40db9890dd3497cc7e20ca">dom_lo</a>.y),<a class="code" href="ERF__DiffSetup_8H.html#a0f2c81fa9e8171e1116919f8b1ae0b28">dom_hi</a>.y);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                        <span class="keywordtype">int</span> kb = std::min(std::max(k,<a class="code" href="ERF__DiffSetup_8H.html#a2987796b2d40db9890dd3497cc7e20ca">dom_lo</a>.z),<a class="code" href="ERF__DiffSetup_8H.html#a0f2c81fa9e8171e1116919f8b1ae0b28">dom_hi</a>.z);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                        dest_arr(i,j,k,icomp+n) = bdatxhi(<a class="code" href="ERF__DiffSetup_8H.html#a0f2c81fa9e8171e1116919f8b1ae0b28">dom_hi</a>.x+1,jb,kb,bccomp+n);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                    }</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            );</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            } <span class="comment">// x-faces</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            <span class="comment">// y-faces</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            Box bx_ylo(bx); bx_ylo.setBig  (1,<a class="code" href="ERF__DiffSetup_8H.html#a2987796b2d40db9890dd3497cc7e20ca">dom_lo</a>.y-1);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            <span class="keywordflow">if</span> (var_idx == <a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>) bx_ylo.setBig(1,<a class="code" href="ERF__DiffSetup_8H.html#a2987796b2d40db9890dd3497cc7e20ca">dom_lo</a>.y);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;            Box bx_yhi(bx); bx_yhi.setSmall(1,<a class="code" href="ERF__DiffSetup_8H.html#a0f2c81fa9e8171e1116919f8b1ae0b28">dom_hi</a>.y+1);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;            <span class="keywordflow">if</span> (var_idx == <a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>) bx_yhi.setSmall(1,<a class="code" href="ERF__DiffSetup_8H.html#a0f2c81fa9e8171e1116919f8b1ae0b28">dom_hi</a>.y);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            ParallelFor(</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;               bx_ylo, ncomp, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k, <span class="keywordtype">int</span> n) {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                    <span class="keywordtype">int</span> bc_comp = (icomp+n &gt;= <a class="code" href="ERF__IndexDefines_8H.html#a0296f21cd48e5d8236c62ae4ce319b2f">RhoScalar_comp</a> &amp;&amp; icomp+n &lt; <a class="code" href="ERF__IndexDefines_8H.html#a0296f21cd48e5d8236c62ae4ce319b2f">RhoScalar_comp</a>+<a class="code" href="ERF__IndexDefines_8H.html#a6773f201eef9644a5d5b7252f6d95ce9">NSCALARS</a>) ?</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                                   <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa029ef491930290dea3a984ebdb6d6ae4">BCVars::RhoScalar_bc_comp</a> : icomp+n;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                    <span class="keywordflow">if</span> (bc_ptr[bc_comp].lo(1) == <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca138e8c6c2427dcd78959f3e0e84b3462">ERFBCType::ext_dir_ingested</a>) {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                        <span class="keywordtype">int</span> ib = std::min(std::max(i,<a class="code" href="ERF__DiffSetup_8H.html#a2987796b2d40db9890dd3497cc7e20ca">dom_lo</a>.x),<a class="code" href="ERF__DiffSetup_8H.html#a0f2c81fa9e8171e1116919f8b1ae0b28">dom_hi</a>.x);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                        <span class="keywordtype">int</span> kb = std::min(std::max(k,<a class="code" href="ERF__DiffSetup_8H.html#a2987796b2d40db9890dd3497cc7e20ca">dom_lo</a>.z),<a class="code" href="ERF__DiffSetup_8H.html#a0f2c81fa9e8171e1116919f8b1ae0b28">dom_hi</a>.z);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                        dest_arr(i,j,k,icomp+n) = bdatylo(ib,<a class="code" href="ERF__DiffSetup_8H.html#a2987796b2d40db9890dd3497cc7e20ca">dom_lo</a>.y-1,kb,bccomp+n);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                    }</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                },</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                bx_yhi, ncomp, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k, <span class="keywordtype">int</span> n) {</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                    <span class="keywordtype">int</span> bc_comp = (icomp+n &gt;= <a class="code" href="ERF__IndexDefines_8H.html#a0296f21cd48e5d8236c62ae4ce319b2f">RhoScalar_comp</a> &amp;&amp; icomp+n &lt; <a class="code" href="ERF__IndexDefines_8H.html#a0296f21cd48e5d8236c62ae4ce319b2f">RhoScalar_comp</a>+<a class="code" href="ERF__IndexDefines_8H.html#a6773f201eef9644a5d5b7252f6d95ce9">NSCALARS</a>) ?</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                                   <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa029ef491930290dea3a984ebdb6d6ae4">BCVars::RhoScalar_bc_comp</a> : icomp+n;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                    <span class="keywordflow">if</span> (bc_ptr[bc_comp].hi(1) == <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca138e8c6c2427dcd78959f3e0e84b3462">ERFBCType::ext_dir_ingested</a>) {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                        <span class="keywordtype">int</span> ib = std::min(std::max(i,<a class="code" href="ERF__DiffSetup_8H.html#a2987796b2d40db9890dd3497cc7e20ca">dom_lo</a>.x),<a class="code" href="ERF__DiffSetup_8H.html#a0f2c81fa9e8171e1116919f8b1ae0b28">dom_hi</a>.x);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                        <span class="keywordtype">int</span> kb = std::min(std::max(k,<a class="code" href="ERF__DiffSetup_8H.html#a2987796b2d40db9890dd3497cc7e20ca">dom_lo</a>.z),<a class="code" href="ERF__DiffSetup_8H.html#a0f2c81fa9e8171e1116919f8b1ae0b28">dom_hi</a>.z);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                        dest_arr(i,j,k,icomp+n) = bdatyhi(ib,<a class="code" href="ERF__DiffSetup_8H.html#a0f2c81fa9e8171e1116919f8b1ae0b28">dom_hi</a>.y+1,kb,bccomp+n);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                    }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                }</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            );</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            } <span class="comment">// y-faces</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        } <span class="comment">// mf</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    } <span class="comment">// var_idx</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;}</div>
<div class="ttc" id="aERF__DiffSetup_8H_html_a0f2c81fa9e8171e1116919f8b1ae0b28"><div class="ttname"><a href="ERF__DiffSetup_8H.html#a0f2c81fa9e8171e1116919f8b1ae0b28">dom_hi</a></div><div class="ttdeci">const auto &amp; dom_hi</div><div class="ttdef"><b>Definition:</b> ERF_DiffSetup.H:10</div></div>
<div class="ttc" id="aERF__DiffSetup_8H_html_a2987796b2d40db9890dd3497cc7e20ca"><div class="ttname"><a href="ERF__DiffSetup_8H.html#a2987796b2d40db9890dd3497cc7e20ca">dom_lo</a></div><div class="ttdeci">const auto &amp; dom_lo</div><div class="ttdef"><b>Definition:</b> ERF_DiffSetup.H:9</div></div>
<div class="ttc" id="aERF__IndexDefines_8H_html_a0296f21cd48e5d8236c62ae4ce319b2f"><div class="ttname"><a href="ERF__IndexDefines_8H.html#a0296f21cd48e5d8236c62ae4ce319b2f">RhoScalar_comp</a></div><div class="ttdeci">#define RhoScalar_comp</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:40</div></div>
<div class="ttc" id="aERF__IndexDefines_8H_html_a6773f201eef9644a5d5b7252f6d95ce9"><div class="ttname"><a href="ERF__IndexDefines_8H.html#a6773f201eef9644a5d5b7252f6d95ce9">NSCALARS</a></div><div class="ttdeci">#define NSCALARS</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:16</div></div>
<div class="ttc" id="aclassERF_html_a8a99e22b1111c803e31b4afd5fcdea60"><div class="ttname"><a href="classERF.html#a8a99e22b1111c803e31b4afd5fcdea60">ERF::domain_bcs_type_d</a></div><div class="ttdeci">amrex::Gpu::DeviceVector&lt; amrex::BCRec &gt; domain_bcs_type_d</div><div class="ttdef"><b>Definition:</b> ERF.H:852</div></div>
<div class="ttc" id="anamespaceBCVars_html_a00367571247ba920989360b94c156f4aa029ef491930290dea3a984ebdb6d6ae4"><div class="ttname"><a href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa029ef491930290dea3a984ebdb6d6ae4">BCVars::RhoScalar_bc_comp</a></div><div class="ttdeci">@ RhoScalar_bc_comp</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:80</div></div>
<div class="ttc" id="anamespaceERFBCType_html_a40fbdd5a379a92debb4bcaaccac6e01ca138e8c6c2427dcd78959f3e0e84b3462"><div class="ttname"><a href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca138e8c6c2427dcd78959f3e0e84b3462">ERFBCType::ext_dir_ingested</a></div><div class="ttdeci">@ ext_dir_ingested</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:212</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a76600d7a4a0451c9727d2cc57dae4220"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76600d7a4a0451c9727d2cc57dae4220">&#9670;&nbsp;</a></span>fill_rhs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::fill_rhs </td>
          <td>(</td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>rhs_mf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>state_mf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Geometry &amp;&#160;</td>
          <td class="paramname"><em>geom</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a0857fa7f21e3077bb8bd7808023a6d09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0857fa7f21e3077bb8bd7808023a6d09">&#9670;&nbsp;</a></span>FillBdyCCVels()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::FillBdyCCVels </td>
          <td>(</td>
          <td class="paramtype">amrex::Vector&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_cc_vel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>levc</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;{</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    <span class="comment">// Impose bc&#39;s at domain boundaries</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ilev(0); ilev &lt; mf_cc_vel.size(); ++ilev)</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    {</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;        <span class="keywordtype">int</span> lev = ilev + levc;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;        Box domain(Geom(lev).Domain());</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;        <span class="keywordtype">int</span> ihi = domain.bigEnd(0);</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;        <span class="keywordtype">int</span> jhi = domain.bigEnd(1);</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;        <span class="keywordtype">int</span> khi = domain.bigEnd(2);</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;        <span class="comment">// Impose periodicity first</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;        mf_cc_vel[lev].FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;        <span class="keywordtype">int</span> jper = (Geom(lev).isPeriodic(1));</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        <span class="keywordtype">int</span> kper = (Geom(lev).isPeriodic(2));</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        <span class="keywordflow">for</span> (MFIter mfi(mf_cc_vel[lev], TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        {</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;            <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;            <span class="keyword">const</span> Array4&lt;Real&gt;&amp; vel_arr = mf_cc_vel[lev].array(mfi);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;            <span class="keywordflow">if</span> (!Geom(lev).isPeriodic(0)) {</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;                <span class="comment">// Low-x side</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;                <span class="keywordflow">if</span> (bx.smallEnd(0) &lt;= domain.smallEnd(0)) {</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;                    Real multn = ( (<a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[0] == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a03ee6de9fd100444c5c0567ea01bd538">ERF_BC::slip_wall</a>   ) ||</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;                                   (<a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[0] == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9acb8c716b8d9b499d9bc323d8f8a410d3">ERF_BC::no_slip_wall</a>) ||</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;                                   (<a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[0] == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a40e712f30d56083318ab20a2402921d2">ERF_BC::symmetry</a>    ) ) ? -1. : 1.;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                    Real multt = (<a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[0] == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9acb8c716b8d9b499d9bc323d8f8a410d3">ERF_BC::no_slip_wall</a>) ? -1. : 1.;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;                    Box gbx(bx); gbx.grow(1,jper); gbx.grow(2,kper);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;                    ParallelFor(makeSlab(gbx,0,0), [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> , <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;                    {</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;                        vel_arr(-1,j,k,0) = multn*vel_arr(0,j,k,0); <span class="comment">// u</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;                        vel_arr(-1,j,k,1) = multt*vel_arr(0,j,k,1); <span class="comment">// v</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;                        vel_arr(-1,j,k,2) = multt*vel_arr(0,j,k,2); <span class="comment">// w</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                    });</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;                }</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;                <span class="comment">// High-x side</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                <span class="keywordflow">if</span> (bx.bigEnd(0) &gt;= domain.bigEnd(0)) {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                    Real multn = ( (<a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[3] == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a03ee6de9fd100444c5c0567ea01bd538">ERF_BC::slip_wall</a>   ) ||</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                                   (<a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[3] == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9acb8c716b8d9b499d9bc323d8f8a410d3">ERF_BC::no_slip_wall</a>) ||</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                                   (<a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[3] == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a40e712f30d56083318ab20a2402921d2">ERF_BC::symmetry</a>    ) ) ? -1. : 1.;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                    Real multt = (<a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[3] == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9acb8c716b8d9b499d9bc323d8f8a410d3">ERF_BC::no_slip_wall</a>) ? -1. : 1.;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                    Box gbx(bx); gbx.grow(1,jper); gbx.grow(2,kper);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                    ParallelFor(makeSlab(gbx,0,0), [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> , <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                    {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                        vel_arr(ihi+1,j,k,0) = multn*vel_arr(ihi,j,k,0); <span class="comment">// u</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                        vel_arr(ihi+1,j,k,1) = multt*vel_arr(ihi,j,k,1); <span class="comment">// v</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                        vel_arr(ihi+1,j,k,2) = multt*vel_arr(ihi,j,k,2); <span class="comment">// w</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                    });</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                }</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            } <span class="comment">// !periodic</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;            <span class="keywordflow">if</span> (!Geom(lev).isPeriodic(1)) {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                <span class="comment">// Low-y side</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                <span class="keywordflow">if</span> (bx.smallEnd(1) &lt;= domain.smallEnd(1)) {</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                    Real multn = ( (<a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[1] == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a03ee6de9fd100444c5c0567ea01bd538">ERF_BC::slip_wall</a>   ) ||</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                                   (<a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[1] == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9acb8c716b8d9b499d9bc323d8f8a410d3">ERF_BC::no_slip_wall</a>) ||</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                                   (<a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[1] == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a40e712f30d56083318ab20a2402921d2">ERF_BC::symmetry</a>    ) ) ? -1. : 1.;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                    Real multt = (<a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[1] == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9acb8c716b8d9b499d9bc323d8f8a410d3">ERF_BC::no_slip_wall</a>) ? -1. : 1.;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                    Box gbx(bx); gbx.grow(0,1); gbx.grow(2,kper);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                    ParallelFor(makeSlab(gbx,1,0), [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span>  , <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                    {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                        vel_arr(i,-1,k,0) = multt*vel_arr(i,0,k,0); <span class="comment">// u</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                        vel_arr(i,-1,k,1) = multn*vel_arr(i,0,k,1); <span class="comment">// u</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                        vel_arr(i,-1,k,2) = multt*vel_arr(i,0,k,2); <span class="comment">// w</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                    });</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                }</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                <span class="comment">// High-y side</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                <span class="keywordflow">if</span> (bx.bigEnd(1) &gt;= domain.bigEnd(1)) {</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                    Real multn = ( (<a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[4] == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a03ee6de9fd100444c5c0567ea01bd538">ERF_BC::slip_wall</a>   ) ||</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                                   (<a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[4] == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9acb8c716b8d9b499d9bc323d8f8a410d3">ERF_BC::no_slip_wall</a>) ||</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                                   (<a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[4] == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a40e712f30d56083318ab20a2402921d2">ERF_BC::symmetry</a>    ) ) ? -1. : 1.;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                    Real multt = (<a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[4] == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9acb8c716b8d9b499d9bc323d8f8a410d3">ERF_BC::no_slip_wall</a>) ? -1. : 1.;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                    Box gbx(bx); gbx.grow(0,1); gbx.grow(2,kper);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                    ParallelFor(makeSlab(gbx,1,0), [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> , <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                    {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                        vel_arr(i,jhi+1,k,0) = multt*vel_arr(i,jhi,k,0); <span class="comment">// u</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                        vel_arr(i,jhi+1,k,1) = multn*vel_arr(i,jhi,k,1); <span class="comment">// v</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                        vel_arr(i,jhi+1,k,2) = multt*vel_arr(i,jhi,k,2); <span class="comment">// w</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                    });</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                }</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            } <span class="comment">// !periodic</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            <span class="keywordflow">if</span> (!Geom(lev).isPeriodic(2)) {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                <span class="comment">// Low-z side</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                <span class="keywordflow">if</span> (bx.smallEnd(2) &lt;= domain.smallEnd(2)) {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                    Real multn = ( (<a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[2] == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a03ee6de9fd100444c5c0567ea01bd538">ERF_BC::slip_wall</a>   ) ||</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                                   (<a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[2] == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9acb8c716b8d9b499d9bc323d8f8a410d3">ERF_BC::no_slip_wall</a>) ||</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                                   (<a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[2] == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a40e712f30d56083318ab20a2402921d2">ERF_BC::symmetry</a>    ) ) ? -1. : 1.;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                    Real multt = (<a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[2] == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9acb8c716b8d9b499d9bc323d8f8a410d3">ERF_BC::no_slip_wall</a>) ? -1. : 1.;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                    Box gbx(bx); gbx.grow(0,1); gbx.grow(1,1);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                    ParallelFor(makeSlab(gbx,2,0), [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>) noexcept</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                    {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                        vel_arr(i,j,-1,0) = multt*vel_arr(i,j,0,0); <span class="comment">// u</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                        vel_arr(i,j,-1,1) = multt*vel_arr(i,j,0,1); <span class="comment">// v</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                        vel_arr(i,j,-1,2) = multn*vel_arr(i,j,0,2); <span class="comment">// w</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                    });</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                }</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                <span class="comment">// High-z side</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                <span class="keywordflow">if</span> (bx.bigEnd(2) &gt;= domain.bigEnd(2)) {</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                    Real multn = ( (<a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[5] == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a03ee6de9fd100444c5c0567ea01bd538">ERF_BC::slip_wall</a>   ) ||</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                                   (<a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[5] == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9acb8c716b8d9b499d9bc323d8f8a410d3">ERF_BC::no_slip_wall</a>) ||</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                                   (<a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[5] == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a40e712f30d56083318ab20a2402921d2">ERF_BC::symmetry</a>    ) ) ? -1. : 1.;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                    Real multt = (<a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[5] == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9acb8c716b8d9b499d9bc323d8f8a410d3">ERF_BC::no_slip_wall</a>) ? -1. : 1.;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                    Box gbx(bx); gbx.grow(0,1); gbx.grow(1,1);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                    ParallelFor(makeSlab(gbx,2,0), [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span>) noexcept</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                    {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                        vel_arr(i,j,khi+1,0) = multt*vel_arr(i,j,khi,0); <span class="comment">// u</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                        vel_arr(i,j,khi+1,1) = multt*vel_arr(i,j,khi,1); <span class="comment">// v</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                        vel_arr(i,j,khi+1,2) = multn*vel_arr(i,j,khi,2); <span class="comment">// w</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                    });</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            } <span class="comment">// !periodic</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        } <span class="comment">// MFIter</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <span class="comment">// Impose periodicity again</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        mf_cc_vel[lev].FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    } <span class="comment">// lev</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;}</div>
<div class="ttc" id="aERF__IndexDefines_8H_html_adf340bf1893bad34b2bf452d987d86c9a03ee6de9fd100444c5c0567ea01bd538"><div class="ttname"><a href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a03ee6de9fd100444c5c0567ea01bd538">ERF_BC::slip_wall</a></div><div class="ttdeci">@ slip_wall</div></div>
<div class="ttc" id="aERF__IndexDefines_8H_html_adf340bf1893bad34b2bf452d987d86c9a40e712f30d56083318ab20a2402921d2"><div class="ttname"><a href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a40e712f30d56083318ab20a2402921d2">ERF_BC::symmetry</a></div><div class="ttdeci">@ symmetry</div></div>
<div class="ttc" id="aERF__IndexDefines_8H_html_adf340bf1893bad34b2bf452d987d86c9acb8c716b8d9b499d9bc323d8f8a410d3"><div class="ttname"><a href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9acb8c716b8d9b499d9bc323d8f8a410d3">ERF_BC::no_slip_wall</a></div><div class="ttdeci">@ no_slip_wall</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac4497025ab94461899960ee067c2c72a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4497025ab94461899960ee067c2c72a">&#9670;&nbsp;</a></span>FillCoarsePatch()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::FillCoarsePatch </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;{</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    BL_PROFILE_VAR(<span class="stringliteral">&quot;FillCoarsePatch()&quot;</span>,<a class="code" href="classERF.html#ac4497025ab94461899960ee067c2c72a">FillCoarsePatch</a>);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    AMREX_ASSERT(lev &gt; 0);</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="comment">//****************************************************************************************************************</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="comment">// First fill velocities and density at the COARSE level so we can convert velocity to momenta at the COARSE level</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="comment">//****************************************************************************************************************</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="keywordtype">bool</span> cons_only = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="keywordflow">if</span> (lev == 1) {</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        <a class="code" href="classERF.html#afded764725240c356faffa97dddbe03d">FillPatch</a>(lev-1, time, {&amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], &amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;                                &amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>], &amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>]},</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;                                cons_only);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        <a class="code" href="classERF.html#afded764725240c356faffa97dddbe03d">FillPatch</a>(lev-1, time, {&amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], &amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;                                &amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>], &amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>]},</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;                               {&amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                                &amp;<a class="code" href="classERF.html#a01f3db32272f53dc68025f0a98195e57">rU_new</a>[lev-1], &amp;<a class="code" href="classERF.html#a54e37988486ef96e55e84bd8e91bb688">rV_new</a>[lev-1], &amp;<a class="code" href="classERF.html#aa46c0b0d20525aed10f447923e54dde7">rW_new</a>[lev-1]},</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;                                <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev-1], <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev-1],</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;                                <span class="keyword">false</span>, cons_only);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    }</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="comment">// ************************************************</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="comment">// Convert velocity to momentum at the COARSE level</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="comment">// ************************************************</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <a class="code" href="ERF__Utils_8H.html#a5e2e36af19c0192915a2ca721c0cded4">VelocityToMomentum</a>(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>], IntVect{0},</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                       <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>], IntVect{0},</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                       <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>], IntVect{0},</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                       <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                         <a class="code" href="classERF.html#a01f3db32272f53dc68025f0a98195e57">rU_new</a>[lev-1],</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                         <a class="code" href="classERF.html#a54e37988486ef96e55e84bd8e91bb688">rV_new</a>[lev-1],</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                         <a class="code" href="classERF.html#aa46c0b0d20525aed10f447923e54dde7">rW_new</a>[lev-1],</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                       Geom(lev).Domain(),</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                       <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="comment">// *****************************************************************</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="comment">// Interpolate all cell-centered variables from coarse to fine level</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="comment">// *****************************************************************</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    Interpolater* mapper_c = &amp;cell_cons_interp;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    Interpolater* mapper_f = &amp;face_cons_linear_interp;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="comment">//************************************************************************************************</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="comment">// Interpolate cell-centered data from coarse to fine level</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="comment">// with InterpFromCoarseLevel which ASSUMES that all ghost cells have already been filled</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="comment">// ************************************************************************************************</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    IntVect ngvect_cons = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nGrowVect();</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordtype">int</span>      ncomp_cons = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nComp();</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    InterpFromCoarseLevel(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev  ][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], ngvect_cons, IntVect(0,0,0),</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                          <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], 0, 0, ncomp_cons,</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                          geom[lev-1], geom[lev],</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                          refRatio(lev-1), mapper_c, <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>, <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="comment">// Physical bc&#39;s for cell centered variables at domain boundary</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    (*<a class="code" href="classERF.html#a2e9b04043853d25f2d76edbc0bed2e72">physbcs_cons</a>[lev])(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                         0,ncomp_cons,ngvect_cons,time,<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>,<span class="keyword">true</span>);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="comment">//************************************************************************************************</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="comment">// Interpolate x-momentum from coarse to fine level</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="comment">// with InterpFromCoarseLevel which ASSUMES that all ghost cells have already been filled</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="comment">// ************************************************************************************************</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    InterpFromCoarseLevel(<a class="code" href="classERF.html#a01f3db32272f53dc68025f0a98195e57">rU_new</a>[lev], IntVect{0}, IntVect{0}, <a class="code" href="classERF.html#a01f3db32272f53dc68025f0a98195e57">rU_new</a>[lev-1], 0, 0, 1,</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                          geom[lev-1], geom[lev],</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                          refRatio(lev-1), mapper_f, <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>, <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="comment">//************************************************************************************************</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="comment">// Interpolate y-momentum from coarse to fine level</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="comment">// with InterpFromCoarseLevel which ASSUMES that all ghost cells have already been filled</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="comment">// ************************************************************************************************</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    InterpFromCoarseLevel(<a class="code" href="classERF.html#a54e37988486ef96e55e84bd8e91bb688">rV_new</a>[lev], IntVect{0}, IntVect{0}, <a class="code" href="classERF.html#a54e37988486ef96e55e84bd8e91bb688">rV_new</a>[lev-1], 0, 0, 1,</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                          geom[lev-1], geom[lev],</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                          refRatio(lev-1), mapper_f, <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>, <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a>);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="comment">//************************************************************************************************</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="comment">// Interpolate z-momentum from coarse to fine level</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="comment">// with InterpFromCoarseLevel which ASSUMES that all ghost cells have already been filled</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="comment">// ************************************************************************************************</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    InterpFromCoarseLevel(<a class="code" href="classERF.html#aa46c0b0d20525aed10f447923e54dde7">rW_new</a>[lev],  IntVect{0}, IntVect{0}, <a class="code" href="classERF.html#aa46c0b0d20525aed10f447923e54dde7">rW_new</a>[lev-1], 0, 0, 1,</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                          geom[lev-1], geom[lev],</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                          refRatio(lev-1), mapper_f, <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>, <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa03b35ec9e83f34bb1349a86965d34e34">BCVars::zvel_bc</a>);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="comment">// *********************************************************</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="comment">// After interpolation of momentum, convert back to velocity</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="comment">// *********************************************************</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> which_lev = lev-1; which_lev &lt;= lev; which_lev++)</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <a class="code" href="ERF__MomentumToVelocity_8cpp.html#a4909cdce4c261c6dae5564fb714881ea">MomentumToVelocity</a>(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[which_lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                           <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[which_lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                           <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[which_lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>],</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                           <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[which_lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                             <a class="code" href="classERF.html#a01f3db32272f53dc68025f0a98195e57">rU_new</a>[which_lev],</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                             <a class="code" href="classERF.html#a54e37988486ef96e55e84bd8e91bb688">rV_new</a>[which_lev],</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                             <a class="code" href="classERF.html#aa46c0b0d20525aed10f447923e54dde7">rW_new</a>[which_lev],</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                           Geom(lev).Domain(),</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                           <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    }</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="comment">// Physical bc&#39;s at domain boundary</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    IntVect ngvect_vels = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].nGrowVect();</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    (*<a class="code" href="classERF.html#a64e55e5ae9df06433146db657eb9e72e">physbcs_u</a>[lev])(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                      ngvect_vels,time,<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>,<span class="keyword">true</span>);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    (*<a class="code" href="classERF.html#a79231b5cfd4576a742e46ae0082b5121">physbcs_v</a>[lev])(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                      ngvect_vels,time,<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a>,<span class="keyword">true</span>);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    (*<a class="code" href="classERF.html#a45c8ecd777f47732993777a0afb8e140">physbcs_w</a>[lev])(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>],<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                      ngvect_vels,time,<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa03b35ec9e83f34bb1349a86965d34e34">BCVars::zvel_bc</a>,<span class="keyword">true</span>);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="comment">// Since lev &gt; 0 here we don&#39;t worry about m_r2d or wrfbdy data</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_ac4497025ab94461899960ee067c2c72a"><div class="ttname"><a href="classERF.html#ac4497025ab94461899960ee067c2c72a">ERF::FillCoarsePatch</a></div><div class="ttdeci">void FillCoarsePatch(int lev, amrex::Real time)</div><div class="ttdef"><b>Definition:</b> ERF_FillCoarsePatch.cpp:21</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_ac4497025ab94461899960ee067c2c72a_cgraph.png" border="0" usemap="#aclassERF_ac4497025ab94461899960ee067c2c72a_cgraph" alt=""/></div>
<map name="aclassERF_ac4497025ab94461899960ee067c2c72a_cgraph" id="aclassERF_ac4497025ab94461899960ee067c2c72a_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,159,57"/>
<area shape="rect" href="ERF__MomentumToVelocity_8cpp.html#a4909cdce4c261c6dae5564fb714881ea" title=" " alt="" coords="207,5,369,32"/>
<area shape="rect" href="ERF__Utils_8H.html#a5e2e36af19c0192915a2ca721c0cded4" title=" " alt="" coords="207,56,369,83"/>
</map>
</div>

</div>
</div>
<a id="a6f5c620a402f7b1be46e05c0cbe48743"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f5c620a402f7b1be46e05c0cbe48743">&#9670;&nbsp;</a></span>FillIntermediatePatch()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::FillIntermediatePatch </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Vector&lt; amrex::MultiFab * &gt; &amp;&#160;</td>
          <td class="paramname"><em>mfs_vel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Vector&lt; amrex::MultiFab * &gt; &amp;&#160;</td>
          <td class="paramname"><em>mfs_mom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ng_cons</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ng_vel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>cons_only</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>icomp_cons</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ncomp_cons</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;{</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    BL_PROFILE_VAR(<span class="stringliteral">&quot;FillIntermediatePatch()&quot;</span>,<a class="code" href="classERF.html#a6f5c620a402f7b1be46e05c0cbe48743">FillIntermediatePatch</a>);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    Interpolater* mapper;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    PhysBCFunctNoOp null_bc;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="comment">// The first thing we do is interpolate the momenta on the &quot;valid&quot; faces of</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="comment">// the fine grids (where the interface is coarse/fine not fine/fine) -- this</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="comment">// will not be over-written by interpolation below because the FillPatch</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="comment">// operators see these as valid faces.  But we must have these interpolated</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="comment">// values in the fine data before we call FillPatchTwoLevels.</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="comment">// Also -- note that we might be filling values by interpolation at physical boundaries</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="comment">//         here but that&#39;s ok because we will overwrite those values when we impose</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="comment">//         the physical bc&#39;s below</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordflow">if</span> (lev&gt;0) {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a1e3e2855b6e811596226c167573ad62d">cf_set_width</a> &gt; 0) {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;            <span class="comment">// We note that mfs_vel[Vars::cons] and mfs_mom[Vars::cons] are in fact the same pointer</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;            <a class="code" href="classERF.html#a34160ca20fb400ee285664117cb80512">FPr_c</a>[lev-1].FillSet(*mfs_vel[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], time, null_bc, <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        }</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <span class="keywordflow">if</span> ( !cons_only &amp;&amp; (<a class="code" href="classERF.html#a1e3e2855b6e811596226c167573ad62d">cf_set_width</a> &gt;= 0) ) {</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;            <a class="code" href="classERF.html#a0ef3455d5b4fc9a178e023b233d389a4">FPr_u</a>[lev-1].FillSet(*mfs_mom[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269af661293a5a71ca532c214929b98c0bad">IntVars::xmom</a>], time, null_bc, <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;            <a class="code" href="classERF.html#a1dc7086aec533a042e6033706845b0c3">FPr_v</a>[lev-1].FillSet(*mfs_mom[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269a2e60798bc45154a8f905b1aa228a24e5">IntVars::ymom</a>], time, null_bc, <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;            <a class="code" href="classERF.html#ac9a11403c2238d0d1e7b65b2d100dbaf">FPr_w</a>[lev-1].FillSet(*mfs_mom[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269aaab25f707cae69bfadac2abcd17a2188">IntVars::zmom</a>], time, null_bc, <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        }</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    }</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="comment">// amrex::Print() &lt;&lt; &quot;LEVEL &quot; &lt;&lt; lev &lt;&lt; &quot; CONS ONLY   &quot; &lt;&lt; cons_only &lt;&lt;</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="comment">//                   &quot; ICOMP NCOMP &quot; &lt;&lt; icomp_cons &lt;&lt; &quot; &quot; &lt;&lt; ncomp_cons &lt;&lt; &quot; NGHOST &quot; &lt;&lt; ng_cons &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordflow">if</span> (!cons_only) {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        AMREX_ALWAYS_ASSERT(mfs_mom.size() == <a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269a0468f4146b966163a1fe9f4f32a038c8">IntVars::NumTypes</a>);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        AMREX_ALWAYS_ASSERT(mfs_vel.size() == <a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a5deccaa24d5e74279425d7749f7d1494">Vars::NumTypes</a>);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    }</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="comment">// Enforce no penetration for thin immersed body</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keywordflow">if</span> (!cons_only) {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <span class="comment">// Enforce no penetration for thin immersed body</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#af044f075df34caa2a530aa13e1801a5b">xflux_imask</a>[lev]) {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;            <a class="code" href="ERF__Utils_8H.html#acebead6f3a33cb7737a1fea98341c3ae">ApplyMask</a>(*mfs_mom[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269af661293a5a71ca532c214929b98c0bad">IntVars::xmom</a>], *<a class="code" href="classERF.html#af044f075df34caa2a530aa13e1801a5b">xflux_imask</a>[lev]);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#aa4448d06a3e4fe9740927a636030939d">yflux_imask</a>[lev]) {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            <a class="code" href="ERF__Utils_8H.html#acebead6f3a33cb7737a1fea98341c3ae">ApplyMask</a>(*mfs_mom[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269a2e60798bc45154a8f905b1aa228a24e5">IntVars::ymom</a>], *<a class="code" href="classERF.html#aa4448d06a3e4fe9740927a636030939d">yflux_imask</a>[lev]);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        }</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ada098767690d194f89717b0deb3adeac">zflux_imask</a>[lev]) {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            <a class="code" href="ERF__Utils_8H.html#acebead6f3a33cb7737a1fea98341c3ae">ApplyMask</a>(*mfs_mom[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269aaab25f707cae69bfadac2abcd17a2188">IntVars::zmom</a>], *<a class="code" href="classERF.html#ada098767690d194f89717b0deb3adeac">zflux_imask</a>[lev]);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        }</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    }</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">// We now start working on conserved quantities + VELOCITY</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordflow">if</span> (lev == 0)</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="comment">// We don&#39;t do anything here because we will call the physbcs routines below,</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <span class="comment">// which calls FillBoundary and fills other domain boundary conditions</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="comment">// Physical boundaries will be filled below</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="keywordflow">if</span> (!cons_only)</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            <span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            <span class="comment">// We always come in to this call with updated momenta but we need to create updated velocity</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            <span class="comment">//    in order to impose the rest of the bc&#39;s</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            <span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            <span class="comment">// This only fills VALID region of velocity</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            <a class="code" href="ERF__MomentumToVelocity_8cpp.html#a4909cdce4c261c6dae5564fb714881ea">MomentumToVelocity</a>(*mfs_vel[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>], *mfs_vel[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>], *mfs_vel[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>],</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                               *mfs_vel[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                               *mfs_mom[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269af661293a5a71ca532c214929b98c0bad">IntVars::xmom</a>], *mfs_mom[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269a2e60798bc45154a8f905b1aa228a24e5">IntVars::ymom</a>], *mfs_mom[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269aaab25f707cae69bfadac2abcd17a2188">IntVars::zmom</a>],</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                                Geom(lev).Domain(), <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        }</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    }</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="comment">// We must fill a temporary then copy it back so we don&#39;t double add/subtract</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        MultiFab mf(mfs_vel[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>]-&gt;boxArray(),mfs_vel[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>]-&gt;DistributionMap(),</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                    mfs_vel[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>]-&gt;nComp()   ,mfs_vel[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>]-&gt;nGrowVect());</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="comment">// Set all components to 1.789e19, then copy just the density from *mfs_vel[Vars::cons]</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        mf.setVal(1.789e19);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        MultiFab::Copy(mf,*mfs_vel[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>,1,mf.nGrowVect());</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        Vector&lt;MultiFab*&gt; fmf = {mfs_vel[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],mfs_vel[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>]};</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        Vector&lt;MultiFab*&gt; cmf = {&amp;<a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], &amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>]};</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        Vector&lt;Real&gt; ctime    = {<a class="code" href="classERF.html#a7085d7d5fc94a0f84efc06957267d58e">t_old</a>[lev-1], <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev-1]};</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        Vector&lt;Real&gt; ftime    = {time,time};</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <span class="comment">// Impose physical bc&#39;s on fine data (note time and 0 are not used)</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <span class="keywordtype">bool</span> do_fb = <span class="keyword">true</span>; <span class="keywordtype">bool</span> do_terrain_adjustment = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        (*<a class="code" href="classERF.html#a2e9b04043853d25f2d76edbc0bed2e72">physbcs_cons</a>[lev])(*mfs_vel[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],*mfs_vel[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],*mfs_vel[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                             icomp_cons,ncomp_cons,IntVect{ng_cons},time,<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>,</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                             do_fb, do_terrain_adjustment);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <span class="keywordflow">if</span> ( (icomp_cons+ncomp_cons &gt; 1) &amp;&amp; (<a class="code" href="classERF.html#a812912653fe0d8ab1342bfef4793dd0e">interpolation_type</a> == StateInterpType::Perturbational) )</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            <span class="comment">// Divide (rho theta) by rho to get theta</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            MultiFab::Divide(*mfs_vel[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],*mfs_vel[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>,<a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>,1,IntVect{0});</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            <span class="comment">// Subtract theta_0 from theta</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            MultiFab::Subtract(*mfs_vel[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev],<a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91aaf394bbf6aa8da56fc479f2ed5a2a372">BaseState::th0_comp</a>,<a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>,1,IntVect{0});</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            <span class="keywordflow">if</span> (!amrex::almostEqual(time,ctime[1])) {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                MultiFab::Divide(<a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], <a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                                 <a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>,<a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>,1,<a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nGrowVect());</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                MultiFab::Subtract(<a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev-1],</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                                   <a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91aaf394bbf6aa8da56fc479f2ed5a2a372">BaseState::th0_comp</a>,<a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>,1,<a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nGrowVect());</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            }</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            <span class="keywordflow">if</span> (!amrex::almostEqual(time,ctime[0])) {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                MultiFab::Divide(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                                 <a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>,<a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>,1,<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nGrowVect());</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                MultiFab::Subtract(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev-1],</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                                   <a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91aaf394bbf6aa8da56fc479f2ed5a2a372">BaseState::th0_comp</a>,<a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>,1,<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nGrowVect());</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            }</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        }</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <span class="comment">// Subtract rho_0 from rho before we interpolate -- note we only subtract</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="comment">//    on valid region of mf since the ghost cells will be filled below</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="keywordflow">if</span> (icomp_cons == 0 &amp;&amp; (<a class="code" href="classERF.html#a812912653fe0d8ab1342bfef4793dd0e">interpolation_type</a> == StateInterpType::Perturbational))</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            MultiFab::Subtract(*mfs_vel[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev],<a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91abc888a343d4fcc4fc4ffb79c6ac7cb93">BaseState::r0_comp</a>,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>,1,IntVect{0});</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            <span class="keywordflow">if</span> (!amrex::almostEqual(time,ctime[1])) {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                MultiFab::Subtract(<a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev-1],</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                                   <a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91abc888a343d4fcc4fc4ffb79c6ac7cb93">BaseState::r0_comp</a>,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>,1,<a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nGrowVect());</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            }</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            <span class="keywordflow">if</span> (!amrex::almostEqual(time,ctime[0])) {</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                MultiFab::Subtract(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev-1],</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                                   <a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91abc888a343d4fcc4fc4ffb79c6ac7cb93">BaseState::r0_comp</a>,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>,1,<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nGrowVect());</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            }</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        }</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="comment">// Call FillPatchTwoLevels which ASSUMES that all ghost cells have already been filled</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        mapper = &amp;cell_cons_interp;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        FillPatchTwoLevels(mf, IntVect{ng_cons}, IntVect(0,0,0),</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                           time, cmf, ctime, fmf, ftime,</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                           icomp_cons, icomp_cons, ncomp_cons, geom[lev-1], geom[lev],</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                           refRatio(lev-1), mapper, <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>,</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                           icomp_cons);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="keywordflow">if</span> (icomp_cons == 0 &amp;&amp; (<a class="code" href="classERF.html#a812912653fe0d8ab1342bfef4793dd0e">interpolation_type</a> == StateInterpType::Perturbational))</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            <span class="comment">// Restore the coarse values to what they were</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            <span class="keywordflow">if</span> (!amrex::almostEqual(time,ctime[1])) {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                MultiFab::Add(<a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev-1],</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                              <a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91abc888a343d4fcc4fc4ffb79c6ac7cb93">BaseState::r0_comp</a>,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>,1,<a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nGrowVect());</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            }</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            <span class="keywordflow">if</span> (!amrex::almostEqual(time,ctime[0])) {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                MultiFab::Add(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev-1],</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                              <a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91abc888a343d4fcc4fc4ffb79c6ac7cb93">BaseState::r0_comp</a>,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>,1,<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nGrowVect());</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            <span class="comment">// Set values in the cells outside the domain boundary so that we can do the Add</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            <span class="comment">//     without worrying about uninitialized values outside the domain -- these</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            <span class="comment">//     will be filled in the physbcs call</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            mf.setDomainBndry(1.234e20,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>,1,geom[lev]);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            <span class="comment">// Add rho_0 back to rho after we interpolate -- on all the valid + ghost region</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            MultiFab::Add(mf, <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev],<a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91abc888a343d4fcc4fc4ffb79c6ac7cb93">BaseState::r0_comp</a>,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>,1,IntVect{ng_cons});</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        }</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <span class="keywordflow">if</span> ( (icomp_cons+ncomp_cons &gt; 1) &amp;&amp; (<a class="code" href="classERF.html#a812912653fe0d8ab1342bfef4793dd0e">interpolation_type</a> == StateInterpType::Perturbational) )</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        {</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            <span class="comment">// Add theta_0 to theta</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            <span class="keywordflow">if</span> (!amrex::almostEqual(time,ctime[1])) {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                MultiFab::Add(<a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev-1],</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                              <a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91aaf394bbf6aa8da56fc479f2ed5a2a372">BaseState::th0_comp</a>,<a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>,1,<a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nGrowVect());</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                MultiFab::Multiply(<a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], <a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                                   <a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>,<a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>,1,<a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nGrowVect());</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            }</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            <span class="keywordflow">if</span> (!amrex::almostEqual(time,ctime[0])) {</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                MultiFab::Add(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev-1],</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                              <a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91aaf394bbf6aa8da56fc479f2ed5a2a372">BaseState::th0_comp</a>,<a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>,1,<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nGrowVect());</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                MultiFab::Multiply(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                                   <a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>,<a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>,1,<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nGrowVect());</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            }</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160; </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            <span class="comment">// Multiply theta by rho to get (rho theta)</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            MultiFab::Multiply(*mfs_vel[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],*mfs_vel[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>,<a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>,1,IntVect{0});</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            <span class="comment">// Add theta_0 to theta</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            MultiFab::Add(*mfs_vel[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev],<a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91aaf394bbf6aa8da56fc479f2ed5a2a372">BaseState::th0_comp</a>,<a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>,1,IntVect{0});</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            <span class="comment">// Add theta_0 back to theta</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            MultiFab::Add(mf,<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev],<a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91aaf394bbf6aa8da56fc479f2ed5a2a372">BaseState::th0_comp</a>,<a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>,1,IntVect{ng_cons});</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            <span class="comment">// Multiply (theta) by rho to get (rho theta)</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            MultiFab::Multiply(mf,mf,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>,<a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>,1,IntVect{ng_cons});</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        }</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <span class="comment">// Make sure to only copy back the components we worked on</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        MultiFab::Copy(*mfs_vel[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],mf,icomp_cons,icomp_cons,ncomp_cons,IntVect{ng_cons});</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="comment">// *****************************************************************************************</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <span class="keywordflow">if</span> (!cons_only)</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            <span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            <span class="comment">// We always come in to this call with updated momenta but we need to create updated velocity</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            <span class="comment">//    in order to impose the rest of the bc&#39;s</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            <span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            <span class="comment">// This only fills VALID region of velocity</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            <a class="code" href="ERF__MomentumToVelocity_8cpp.html#a4909cdce4c261c6dae5564fb714881ea">MomentumToVelocity</a>(*mfs_vel[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>], *mfs_vel[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>], *mfs_vel[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>],</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                               *mfs_vel[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                               *mfs_mom[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269af661293a5a71ca532c214929b98c0bad">IntVars::xmom</a>], *mfs_mom[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269a2e60798bc45154a8f905b1aa228a24e5">IntVars::ymom</a>], *mfs_mom[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269aaab25f707cae69bfadac2abcd17a2188">IntVars::zmom</a>],</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                                Geom(lev).Domain(), <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160; </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            mapper = &amp;face_cons_linear_interp;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160; </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            <span class="comment">// NOTE: All interpolation here happens on velocities not momenta;</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            <span class="comment">//       note we only do the interpolation and FillBoundary here,</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            <span class="comment">//       physical bc&#39;s are imposed later</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            <span class="comment">// NOTE: This will only fill velocity from coarse grid *outside* the fine grids</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            <span class="comment">//       unlike the FillSet calls above which filled momenta on the coarse/fine bdy</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            MultiFab&amp; mfu = *mfs_vel[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>];</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            fmf = {&amp;mfu,&amp;mfu};</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            cmf = {&amp;<a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>], &amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>]};</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;            <span class="comment">// Call FillPatchTwoLevels which ASSUMES that all ghost cells have already been filled</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            FillPatchTwoLevels(mfu, IntVect{ng_vel}, IntVect(0,0,0),</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                               time, cmf, ctime, fmf, ftime,</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                               0, 0, 1, geom[lev-1], geom[lev],</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                               refRatio(lev-1), mapper, <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>,</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                               <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            <span class="comment">// *****************************************************************************************</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            MultiFab&amp; mfv = *mfs_vel[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>];</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            fmf = {&amp;mfv,&amp;mfv};</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            cmf = {&amp;<a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>], &amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>]};</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            <span class="comment">// Call FillPatchTwoLevels which ASSUMES that all ghost cells have already been filled</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            FillPatchTwoLevels(mfv, IntVect{ng_vel}, IntVect(0,0,0),</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                               time, cmf, ctime, fmf, ftime,</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                               0, 0, 1, geom[lev-1], geom[lev],</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                               refRatio(lev-1), mapper, <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>,</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                               <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a>);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            <span class="comment">// *****************************************************************************************</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            MultiFab&amp; mfw = *mfs_vel[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>];</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160; </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            fmf = {&amp;mfw,&amp;mfw};</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            cmf = {&amp;<a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>], &amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>]};</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;            <span class="comment">// Call FillPatchTwoLevels which ASSUMES that all ghost cells have already been filled</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            FillPatchTwoLevels(mfw, IntVect{ng_vel}, IntVect(0,0,0),</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                               time, cmf, ctime, fmf, ftime,</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                               0, 0, 1, geom[lev-1], geom[lev],</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                               refRatio(lev-1), mapper, <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>,</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                               <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa03b35ec9e83f34bb1349a86965d34e34">BCVars::zvel_bc</a>);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        } <span class="comment">// !cons_only</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    } <span class="comment">// lev &gt; 0</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="comment">// Physical bc&#39;s at domain boundary</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    IntVect ngvect_cons = IntVect(ng_cons,ng_cons,ng_cons);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    IntVect ngvect_vels = IntVect(ng_vel ,ng_vel ,ng_vel);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160; </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keywordtype">bool</span> do_fb = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="preprocessor">#ifdef ERF_USE_NETCDF</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="comment">// We call this here because it is an ERF routine</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ad57b63939b19e90b87dd61d3f293b0d7">use_real_bcs</a> &amp;&amp; (lev==0)) {</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        fill_from_realbdy(mfs_vel,time,cons_only,icomp_cons,ncomp_cons,ngvect_cons,ngvect_vels);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        do_fb = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>) <a class="code" href="classERF.html#a2135641de33dea5057799569c74cac42">fill_from_bndryregs</a>(mfs_vel,time);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="comment">// We call this even if use_real_bcs is true because these will fill the vertical bcs</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    (*<a class="code" href="classERF.html#a2e9b04043853d25f2d76edbc0bed2e72">physbcs_cons</a>[lev])(*mfs_vel[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],*mfs_vel[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],*mfs_vel[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                         icomp_cons,ncomp_cons,ngvect_cons,time,<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>, do_fb);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="keywordflow">if</span> (!cons_only) {</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        (*<a class="code" href="classERF.html#a64e55e5ae9df06433146db657eb9e72e">physbcs_u</a>[lev])(*mfs_vel[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],*mfs_vel[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],*mfs_vel[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                          ngvect_vels,time,<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>, do_fb);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        (*<a class="code" href="classERF.html#a79231b5cfd4576a742e46ae0082b5121">physbcs_v</a>[lev])(*mfs_vel[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],*mfs_vel[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],*mfs_vel[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                          ngvect_vels,time,<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a>, do_fb);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        (*<a class="code" href="classERF.html#a45c8ecd777f47732993777a0afb8e140">physbcs_w</a>[lev])(*mfs_vel[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>],*mfs_vel[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],*mfs_vel[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                          ngvect_vels,time,<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa03b35ec9e83f34bb1349a86965d34e34">BCVars::zvel_bc</a>, do_fb);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    }</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="comment">// We always come in to this call with momenta so we need to leave with momenta!</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="comment">// We need to make sure we convert back on all ghost cells/faces because this is</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="comment">// how velocity from fine-fine copies (as well as physical and interpolated bcs) will be filled</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordflow">if</span> (!cons_only)</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    {</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        IntVect ngu = (!<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a8d039800497a1e5084afeef94d367932">use_num_diff</a>) ? IntVect(1,1,1) : mfs_vel[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>]-&gt;nGrowVect();</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        IntVect ngv = (!<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a8d039800497a1e5084afeef94d367932">use_num_diff</a>) ? IntVect(1,1,1) : mfs_vel[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>]-&gt;nGrowVect();</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        IntVect ngw = (!<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a8d039800497a1e5084afeef94d367932">use_num_diff</a>) ? IntVect(1,1,0) : mfs_vel[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>]-&gt;nGrowVect();</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <a class="code" href="ERF__Utils_8H.html#a5e2e36af19c0192915a2ca721c0cded4">VelocityToMomentum</a>(*mfs_vel[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>], ngu,</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                           *mfs_vel[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>], ngv,</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                           *mfs_vel[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>], ngw,</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                           *mfs_vel[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                           *mfs_mom[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269af661293a5a71ca532c214929b98c0bad">IntVars::xmom</a>], *mfs_mom[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269a2e60798bc45154a8f905b1aa228a24e5">IntVars::ymom</a>], *mfs_mom[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269aaab25f707cae69bfadac2abcd17a2188">IntVars::zmom</a>],</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                           Geom(lev).Domain(),</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                           <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    }</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160; </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="comment">// NOTE: There are not FillBoundary calls here for the following reasons:</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="comment">// Removal of the FillBoundary (FB) calls has bee completed for the following reasons:</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="comment">// 1. physbc_cons is called before VelocityToMomentum and a FB is completed in that functor.</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="comment">//    Therefore, the conserved CC vars have their inter-rank ghost cells filled and then their</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="comment">//    domain ghost cells filled from the BC operations. We should not call FB on this MF again.</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="comment">// 2. physbc_u/v/w is also called before VelocityToMomentum and a FB is completed those functors.</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="comment">//    Furthermore, VelocityToMomentum operates on a growntilebox so we exit that routine with momentum</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="comment">//    filled everywhere---i.e., physbc_u/v/w fills velocity ghost cells (inter-rank and domain)</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="comment">//    and then V2M does the conversion to momenta everywhere; so there is again no need to do a FB on momenta.</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;}</div>
<div class="ttc" id="aERF__Utils_8H_html_acebead6f3a33cb7737a1fea98341c3ae"><div class="ttname"><a href="ERF__Utils_8H.html#acebead6f3a33cb7737a1fea98341c3ae">ApplyMask</a></div><div class="ttdeci">AMREX_GPU_HOST AMREX_FORCE_INLINE void ApplyMask(amrex::MultiFab &amp;dst, const amrex::iMultiFab &amp;imask, const int nghost=0)</div><div class="ttdef"><b>Definition:</b> ERF_Utils.H:387</div></div>
<div class="ttc" id="aclassERF_html_a2135641de33dea5057799569c74cac42"><div class="ttname"><a href="classERF.html#a2135641de33dea5057799569c74cac42">ERF::fill_from_bndryregs</a></div><div class="ttdeci">void fill_from_bndryregs(const amrex::Vector&lt; amrex::MultiFab * &gt; &amp;mfs, amrex::Real time)</div><div class="ttdef"><b>Definition:</b> ERF_BoundaryConditionsBndryReg.cpp:13</div></div>
<div class="ttc" id="aclassERF_html_a6f5c620a402f7b1be46e05c0cbe48743"><div class="ttname"><a href="classERF.html#a6f5c620a402f7b1be46e05c0cbe48743">ERF::FillIntermediatePatch</a></div><div class="ttdeci">void FillIntermediatePatch(int lev, amrex::Real time, const amrex::Vector&lt; amrex::MultiFab * &gt; &amp;mfs_vel, const amrex::Vector&lt; amrex::MultiFab * &gt; &amp;mfs_mom, int ng_cons, int ng_vel, bool cons_only, int icomp_cons, int ncomp_cons)</div><div class="ttdef"><b>Definition:</b> ERF_FillIntermediatePatch.cpp:28</div></div>
<div class="ttc" id="anamespaceIntVars_html_a52282f730c54deb760c414b54a12a269a0468f4146b966163a1fe9f4f32a038c8"><div class="ttname"><a href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269a0468f4146b966163a1fe9f4f32a038c8">IntVars::NumTypes</a></div><div class="ttdeci">@ NumTypes</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:162</div></div>
<div class="ttc" id="astructSolverChoice_html_ad57b63939b19e90b87dd61d3f293b0d7"><div class="ttname"><a href="structSolverChoice.html#ad57b63939b19e90b87dd61d3f293b0d7">SolverChoice::use_real_bcs</a></div><div class="ttdeci">static bool use_real_bcs</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:705</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a6f5c620a402f7b1be46e05c0cbe48743_cgraph.png" border="0" usemap="#aclassERF_a6f5c620a402f7b1be46e05c0cbe48743_cgraph" alt=""/></div>
<map name="aclassERF_a6f5c620a402f7b1be46e05c0cbe48743_cgraph" id="aclassERF_a6f5c620a402f7b1be46e05c0cbe48743_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,197,83"/>
<area shape="rect" href="ERF__Utils_8H.html#acebead6f3a33cb7737a1fea98341c3ae" title=" " alt="" coords="279,5,374,32"/>
<area shape="rect" href="ERF__MomentumToVelocity_8cpp.html#a4909cdce4c261c6dae5564fb714881ea" title=" " alt="" coords="245,56,408,83"/>
<area shape="rect" href="ERF__Utils_8H.html#a5e2e36af19c0192915a2ca721c0cded4" title=" " alt="" coords="245,107,408,133"/>
</map>
</div>

</div>
</div>
<a id="afded764725240c356faffa97dddbe03d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afded764725240c356faffa97dddbe03d">&#9670;&nbsp;</a></span>FillPatch() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::FillPatch </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Vector&lt; amrex::MultiFab * &gt; &amp;&#160;</td>
          <td class="paramname"><em>mfs_vel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>cons_only</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="acb10e650516e54568f879e48f81d6187"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb10e650516e54568f879e48f81d6187">&#9670;&nbsp;</a></span>FillPatch() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::FillPatch </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Vector&lt; amrex::MultiFab * &gt; &amp;&#160;</td>
          <td class="paramname"><em>mfs_vel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Vector&lt; amrex::MultiFab * &gt; &amp;&#160;</td>
          <td class="paramname"><em>mfs_mom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>old_base_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>new_base_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>fillset</em> = <code>true</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>cons_only</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a2ae1074c3047ab0eb8286f73f5d4be0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ae1074c3047ab0eb8286f73f5d4be0e">&#9670;&nbsp;</a></span>get_eb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classeb__.html">eb_</a> const&amp; ERF::get_eb </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;                                                             {</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;        AMREX_ASSERT(lev &gt;= 0 &amp;&amp; lev &lt; <a class="code" href="classERF.html#a32317cbd11fb55fe60a00c0925189859">eb</a>.size() &amp;&amp; <a class="code" href="classERF.html#a32317cbd11fb55fe60a00c0925189859">eb</a>[lev] != <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;        <span class="keywordflow">return</span> *<a class="code" href="classERF.html#a32317cbd11fb55fe60a00c0925189859">eb</a>[lev];</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a57580311d47c9fd5e27ba156d287c169"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57580311d47c9fd5e27ba156d287c169">&#9670;&nbsp;</a></span>get_projection_bc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Array&lt; LinOpBCType, AMREX_SPACEDIM &gt; ERF::get_projection_bc </td>
          <td>(</td>
          <td class="paramtype">amrex::Orientation::Side&#160;</td>
          <td class="paramname"><em>side</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;{</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    amrex::Array&lt;amrex::LinOpBCType,AMREX_SPACEDIM&gt; r;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dir = 0; dir &lt; AMREX_SPACEDIM; ++dir) {</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;        <span class="keywordflow">if</span> (geom[0].isPeriodic(dir)) {</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;            r[dir] = LinOpBCType::Periodic;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;            <span class="keyword">auto</span> bc_type = <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[Orientation(dir,side)];</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;            <span class="keywordflow">if</span> (bc_type == <span class="stringliteral">&quot;Outflow&quot;</span>) {</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;                r[dir] = LinOpBCType::Dirichlet;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;            } <span class="keywordflow">else</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;            {</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;                r[dir] = LinOpBCType::Neumann;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;            }</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        }</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    }</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keywordflow">return</span> r;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_ae5968f1bed602fa87cdd5cb7905b7e5e"><div class="ttname"><a href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">ERF::domain_bc_type</a></div><div class="ttdeci">amrex::Array&lt; std::string, 2 *AMREX_SPACEDIM &gt; domain_bc_type</div><div class="ttdef"><b>Definition:</b> ERF.H:855</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4d6d990d8111c170692b1e9cc0e918b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d6d990d8111c170692b1e9cc0e918b8">&#9670;&nbsp;</a></span>getAdvFluxReg()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">AMREX_FORCE_INLINE amrex::YAFluxRegister* ERF::getAdvFluxReg </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    {</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classERF.html#a86a0bc8e41668411ee0ab5801d4688a7">advflux_reg</a>[lev];</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae0597da6edf955cd138e52fd00380ff2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0597da6edf955cd138e52fd00380ff2">&#9670;&nbsp;</a></span>getCPUTime()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static amrex::Real ERF::getCPUTime </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    {</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;      <span class="keywordtype">int</span> numCores = amrex::ParallelDescriptor::NProcs();</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;      numCores = numCores * omp_get_max_threads();</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160; </div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;      amrex::Real <a class="code" href="namespaceRealBdyVars.html#a2827de2ca16290ba8c0d89dee276eccca8ecd2dbb16824e5c68db7daf2254fc79">T</a> =</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;        numCores * (amrex::ParallelDescriptor::second() - <a class="code" href="classERF.html#a6d00e1cb76bfbcbada173e092b6accf3">startCPUTime</a>) +</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;        <a class="code" href="classERF.html#a1f412097e565c23acb4c17c67db10e22">previousCPUTimeUsed</a>;</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160; </div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespaceRealBdyVars.html#a2827de2ca16290ba8c0d89dee276eccca8ecd2dbb16824e5c68db7daf2254fc79">T</a>;</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    }</div>
<div class="ttc" id="aclassERF_html_a1f412097e565c23acb4c17c67db10e22"><div class="ttname"><a href="classERF.html#a1f412097e565c23acb4c17c67db10e22">ERF::previousCPUTimeUsed</a></div><div class="ttdeci">static amrex::Real previousCPUTimeUsed</div><div class="ttdef"><b>Definition:</b> ERF.H:1319</div></div>
<div class="ttc" id="aclassERF_html_a6d00e1cb76bfbcbada173e092b6accf3"><div class="ttname"><a href="classERF.html#a6d00e1cb76bfbcbada173e092b6accf3">ERF::startCPUTime</a></div><div class="ttdeci">static amrex::Real startCPUTime</div><div class="ttdef"><b>Definition:</b> ERF.H:1318</div></div>
<div class="ttc" id="anamespaceRealBdyVars_html_a2827de2ca16290ba8c0d89dee276eccca8ecd2dbb16824e5c68db7daf2254fc79"><div class="ttname"><a href="namespaceRealBdyVars.html#a2827de2ca16290ba8c0d89dee276eccca8ecd2dbb16824e5c68db7daf2254fc79">RealBdyVars::T</a></div><div class="ttdeci">@ T</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:110</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aaee255b031e63bd9b5807f6612739dbd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaee255b031e63bd9b5807f6612739dbd">&#9670;&nbsp;</a></span>GotoNextLine()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::GotoNextLine </td>
          <td>(</td>
          <td class="paramtype">std::istream &amp;&#160;</td>
          <td class="paramname"><em>is</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Utility to skip to next line in Header file input stream. </p>
<div class="fragment"><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;{</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    constexpr std::streamsize bl_ignore_max { 100000 };</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    is.ignore(bl_ignore_max, <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2710f0ac329fa022dd2df41679998b3b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2710f0ac329fa022dd2df41679998b3b">&#9670;&nbsp;</a></span>HurricaneTracker()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::HurricaneTracker </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>U_new</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>V_new</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>W_new</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real&#160;</td>
          <td class="paramname"><em>velmag_threshold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>is_track_io</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::TagBoxArray *&#160;</td>
          <td class="paramname"><em>tags</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;{</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> dx = geom[levc].CellSizeArray();</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> prob_lo = geom[levc].ProbLoArray();</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160; </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> ncomp = AMREX_SPACEDIM; <span class="comment">// Number of components (3 for 3D)</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160; </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    Gpu::DeviceVector&lt;Real&gt; d_coords(3, 0.0); <span class="comment">// Initialize to -1</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    Real* d_coords_ptr = d_coords.data(); <span class="comment">// Get pointer to device vector</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    Gpu::DeviceVector&lt;int&gt; d_found(1,0);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="keywordtype">int</span>* d_found_ptr = d_found.data();</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160; </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    MultiFab mf_cc_vel(grids[levc], dmap[levc], AMREX_SPACEDIM, IntVect(0,0,0));</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    average_face_to_cellcenter(mf_cc_vel,0,{AMREX_D_DECL(&amp;U_new,&amp;V_new,&amp;W_new)},0);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160; </div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="comment">// Loop through MultiFab using MFIter</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keywordflow">for</span> (MFIter mfi(mf_cc_vel); mfi.isValid(); ++mfi) {</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        <span class="keyword">const</span> Box&amp; box = mfi.validbox(); <span class="comment">// Get the valid box for the current MFIter</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        <span class="keyword">const</span> Array4&lt;const Real&gt;&amp; vel_arr = mf_cc_vel.const_array(mfi); <span class="comment">// Get the array for this MFIter</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160; </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        <span class="comment">// ParallelFor loop to check velocity magnitudes on the GPU</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        amrex::ParallelFor(box, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) {</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;            <span class="comment">// Access velocity components using ncomp</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            Real magnitude = 0.0; <span class="comment">// Initialize magnitude</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160; </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> comp = 0; comp &lt; ncomp; ++comp) {</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                Real vel = vel_arr(i, j, k, comp); <span class="comment">// Access the component for each (i, j, k)</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                magnitude += vel * vel; <span class="comment">// Sum the square of the components</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;            }</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160; </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            magnitude = std::sqrt(magnitude)*3.6; <span class="comment">// Calculate magnitude</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;            Real <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01a9dd4e461268c8034f5c8564e155c67a6">x</a> = prob_lo[0] + (i + 0.5) * dx[0];</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;            Real <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01a415290769594460e2e485922904f345d">y</a> = prob_lo[1] + (j + 0.5) * dx[1];</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            Real <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> = prob_lo[2] + (k + 0.5) * dx[2];</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160; </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;            <span class="comment">// Check if magnitude exceeds threshold</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;            <span class="keywordflow">if</span> (z &lt; 2.0e3 &amp;&amp; magnitude &gt; velmag_threshold) {</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                <span class="comment">// Use atomic operations to set found flag and store coordinates</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                Gpu::Atomic::Add(&amp;d_found_ptr[0], 1); <span class="comment">// Mark as found</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160; </div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                <span class="comment">// Store coordinates</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                Gpu::Atomic::Add(&amp;d_coords_ptr[0],<a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01a9dd4e461268c8034f5c8564e155c67a6">x</a>); <span class="comment">// Store x index</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                Gpu::Atomic::Add(&amp;d_coords_ptr[1],<a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01a415290769594460e2e485922904f345d">y</a>); <span class="comment">// Store x index</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                Gpu::Atomic::Add(&amp;d_coords_ptr[2],<a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a>); <span class="comment">// Store x index</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;            }</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        });</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    }</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160; </div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="comment">// Synchronize to ensure all threads complete their execution</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    amrex::Gpu::streamSynchronize(); <span class="comment">// Wait for all GPU threads to finish</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160; </div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    Vector&lt;int&gt; h_found(1,0);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    Gpu::copy(Gpu::deviceToHost, d_found.begin(), d_found.end(), h_found.begin());</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    ParallelAllReduce::Sum(h_found.data(),</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                           h_found.size(),</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                           ParallelContext::CommunicatorAll());</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160; </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    Real eye_x, eye_y;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="comment">// Broadcast coordinates if found</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="keywordflow">if</span> (h_found[0] &gt; 0) {</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        Vector&lt;Real&gt; h_coords(3,-1e10);</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        Gpu::copy(Gpu::deviceToHost, d_coords.begin(), d_coords.end(), h_coords.begin());</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160; </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        ParallelAllReduce::Sum(h_coords.data(),</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                               h_coords.size(),</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                               ParallelContext::CommunicatorAll());</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160; </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        eye_x = h_coords[0]/h_found[0];</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        eye_y = h_coords[1]/h_found[0];</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160; </div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        <span class="comment">// Data structure to hold the hurricane track for I/O</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        <span class="keywordflow">if</span> (amrex::ParallelDescriptor::IOProcessor() and is_track_io) {</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;            <a class="code" href="classERF.html#a90e949ea154768582dd0aff3d691b0db">hurricane_track_xy</a>.push_back({eye_x, eye_y});</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        }</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160; </div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        <span class="keywordflow">if</span>(is_track_io) {</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        }</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160; </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        Real rad_tag = 3e5*std::pow(2, max_level-1-levc);</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160; </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        <span class="keywordflow">for</span> (MFIter mfi(*tags); mfi.isValid(); ++mfi) {</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;            TagBox&amp; tag = (*tags)[mfi];</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;            <span class="keyword">auto</span> tag_arr = tag.array();  <span class="comment">// Get device-accessible array</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160; </div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;            <span class="keyword">const</span> Box&amp; tile_box = mfi.tilebox(); <span class="comment">// The box for this tile</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160; </div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;            ParallelFor(tile_box, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) {</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                <span class="comment">// Compute cell center coordinates</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                Real <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01a9dd4e461268c8034f5c8564e155c67a6">x</a> = prob_lo[0] + (i + 0.5) * dx[0];</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                Real <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01a415290769594460e2e485922904f345d">y</a> = prob_lo[1] + (j + 0.5) * dx[1];</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160; </div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                Real dist = std::sqrt((<a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01a9dd4e461268c8034f5c8564e155c67a6">x</a> - eye_x)*(<a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01a9dd4e461268c8034f5c8564e155c67a6">x</a> - eye_x) + (<a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01a415290769594460e2e485922904f345d">y</a> - eye_y)*(<a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01a415290769594460e2e485922904f345d">y</a> - eye_y));</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160; </div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                <span class="keywordflow">if</span> (dist &lt; rad_tag) {</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                    tag_arr(i,j,k) = TagBox::SET;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                }</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;            });</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        }</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    }</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;}</div>
<div class="ttc" id="aERF__DataStruct_8H_html_a627f1f843904477f763577ad1460de01a415290769594460e2e485922904f345d"><div class="ttname"><a href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01a415290769594460e2e485922904f345d">Coord::y</a></div><div class="ttdeci">@ y</div></div>
<div class="ttc" id="aERF__DataStruct_8H_html_a627f1f843904477f763577ad1460de01a9dd4e461268c8034f5c8564e155c67a6"><div class="ttname"><a href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01a9dd4e461268c8034f5c8564e155c67a6">Coord::x</a></div><div class="ttdeci">@ x</div></div>
<div class="ttc" id="aERF__DataStruct_8H_html_a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7"><div class="ttname"><a href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">Coord::z</a></div><div class="ttdeci">@ z</div></div>
<div class="ttc" id="aclassERF_html_a90e949ea154768582dd0aff3d691b0db"><div class="ttname"><a href="classERF.html#a90e949ea154768582dd0aff3d691b0db">ERF::hurricane_track_xy</a></div><div class="ttdeci">amrex::Vector&lt; std::array&lt; amrex::Real, 2 &gt; &gt; hurricane_track_xy</div><div class="ttdef"><b>Definition:</b> ERF.H:144</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4bc2457e48cf3347af7c600a07982006"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4bc2457e48cf3347af7c600a07982006">&#9670;&nbsp;</a></span>ImposeBCsOnPhi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::ImposeBCsOnPhi </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>phi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Impose bc's on the pressure that comes out of the solve </p>
<div class="fragment"><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;{</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    BL_PROFILE(<span class="stringliteral">&quot;ERF::ImposeBCsOnPhi()&quot;</span>);</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160; </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span> <a class="code" href="ERF__DiffSetup_8H.html#a2987796b2d40db9890dd3497cc7e20ca">dom_lo</a> = lbound(geom[lev].Domain());</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span> <a class="code" href="ERF__DiffSetup_8H.html#a0f2c81fa9e8171e1116919f8b1ae0b28">dom_hi</a> = ubound(geom[lev].Domain());</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    phi.FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <span class="comment">// Impose bc&#39;s on pprime</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#pragma omp parallel if (Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="keywordflow">for</span> (MFIter mfi(phi,TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    {</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        Array4&lt;Real&gt; <span class="keyword">const</span>&amp; pp_arr  = phi.array(mfi);</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        Box <span class="keyword">const</span>&amp; bx    = mfi.tilebox();</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        <span class="keyword">auto</span> <span class="keyword">const</span> bx_lo = lbound(bx);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        <span class="keyword">auto</span> <span class="keyword">const</span> bx_hi = ubound(bx);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        <span class="keywordflow">if</span> (bx_lo.x == <a class="code" href="ERF__DiffSetup_8H.html#a2987796b2d40db9890dd3497cc7e20ca">dom_lo</a>.x) {</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;            <span class="keyword">auto</span> bc_type = <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[Orientation(0,Orientation::low)];</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;            <span class="keywordflow">if</span> (bc_type == <span class="stringliteral">&quot;Outflow&quot;</span> || bc_type == <span class="stringliteral">&quot;Open&quot;</span>) {</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;                ParallelFor(makeSlab(bx,0,<a class="code" href="ERF__DiffSetup_8H.html#a2987796b2d40db9890dd3497cc7e20ca">dom_lo</a>.x), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;                {</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;                    pp_arr(i-1,j,k) = -pp_arr(i,j,k);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                });</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;                ParallelFor(makeSlab(bx,0,<a class="code" href="ERF__DiffSetup_8H.html#a2987796b2d40db9890dd3497cc7e20ca">dom_lo</a>.x), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;                {</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;                    pp_arr(i-1,j,k) = pp_arr(i,j,k);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;                });</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;            }</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        }</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        <span class="keywordflow">if</span> (bx_hi.x == <a class="code" href="ERF__DiffSetup_8H.html#a0f2c81fa9e8171e1116919f8b1ae0b28">dom_hi</a>.x) {</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;            <span class="keyword">auto</span> bc_type = <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[Orientation(0,Orientation::high)];</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;            <span class="keywordflow">if</span> (bc_type == <span class="stringliteral">&quot;Outflow&quot;</span> || bc_type == <span class="stringliteral">&quot;Open&quot;</span>) {</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                ParallelFor(makeSlab(bx,0,<a class="code" href="ERF__DiffSetup_8H.html#a0f2c81fa9e8171e1116919f8b1ae0b28">dom_hi</a>.x), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                    pp_arr(i+1,j,k) = -pp_arr(i,j,k);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                });</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                ParallelFor(makeSlab(bx,0,<a class="code" href="ERF__DiffSetup_8H.html#a0f2c81fa9e8171e1116919f8b1ae0b28">dom_hi</a>.x), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                    pp_arr(i+1,j,k) = pp_arr(i,j,k);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                });</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;            }</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        }</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <span class="keywordflow">if</span> (bx_lo.y == <a class="code" href="ERF__DiffSetup_8H.html#a2987796b2d40db9890dd3497cc7e20ca">dom_lo</a>.y) {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            <span class="keyword">auto</span> bc_type = <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[Orientation(1,Orientation::low)];</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;            Box <a class="code" href="ERF__DiffSetup_8H.html#ae3d636c41f5271630a5816a4b8b668b2">ybx</a>(bx); <a class="code" href="ERF__DiffSetup_8H.html#ae3d636c41f5271630a5816a4b8b668b2">ybx</a>.grow(0,1); <span class="comment">// Grow in x-dir because we have filled that above</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;            <span class="keywordflow">if</span> (bc_type == <span class="stringliteral">&quot;Outflow&quot;</span> || bc_type == <span class="stringliteral">&quot;Open&quot;</span>) {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                ParallelFor(makeSlab(<a class="code" href="ERF__DiffSetup_8H.html#ae3d636c41f5271630a5816a4b8b668b2">ybx</a>,1,<a class="code" href="ERF__DiffSetup_8H.html#a2987796b2d40db9890dd3497cc7e20ca">dom_lo</a>.y), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                {</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                    pp_arr(i,j-1,k) = -pp_arr(i,j,k);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                });</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                ParallelFor(makeSlab(<a class="code" href="ERF__DiffSetup_8H.html#ae3d636c41f5271630a5816a4b8b668b2">ybx</a>,1,<a class="code" href="ERF__DiffSetup_8H.html#a2987796b2d40db9890dd3497cc7e20ca">dom_lo</a>.y), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                    pp_arr(i,j-1,k) = pp_arr(i,j,k);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                });</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        }</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <span class="keywordflow">if</span> (bx_hi.y == <a class="code" href="ERF__DiffSetup_8H.html#a0f2c81fa9e8171e1116919f8b1ae0b28">dom_hi</a>.y) {</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            <span class="keyword">auto</span> bc_type = <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[Orientation(1,Orientation::high)];</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            Box <a class="code" href="ERF__DiffSetup_8H.html#ae3d636c41f5271630a5816a4b8b668b2">ybx</a>(bx); <a class="code" href="ERF__DiffSetup_8H.html#ae3d636c41f5271630a5816a4b8b668b2">ybx</a>.grow(0,1); <span class="comment">// Grow in x-dir because we have filled that above</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            <span class="keywordflow">if</span> (bc_type == <span class="stringliteral">&quot;Outflow&quot;</span> || bc_type == <span class="stringliteral">&quot;Open&quot;</span>) {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                ParallelFor(makeSlab(<a class="code" href="ERF__DiffSetup_8H.html#ae3d636c41f5271630a5816a4b8b668b2">ybx</a>,1,<a class="code" href="ERF__DiffSetup_8H.html#a0f2c81fa9e8171e1116919f8b1ae0b28">dom_hi</a>.y), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                {</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                    pp_arr(i,j+1,k) = -pp_arr(i,j,k);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                });</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                ParallelFor(makeSlab(<a class="code" href="ERF__DiffSetup_8H.html#ae3d636c41f5271630a5816a4b8b668b2">ybx</a>,1,<a class="code" href="ERF__DiffSetup_8H.html#a0f2c81fa9e8171e1116919f8b1ae0b28">dom_hi</a>.y), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                    pp_arr(i,j+1,k) = pp_arr(i,j,k);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                });</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;            }</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        }</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        Box <a class="code" href="ERF__DiffSetup_8H.html#a4c74ed1b76138a2f5baa925afe40f9a8">zbx</a>(bx); <a class="code" href="ERF__DiffSetup_8H.html#a4c74ed1b76138a2f5baa925afe40f9a8">zbx</a>.grow(0,1); <a class="code" href="ERF__DiffSetup_8H.html#a4c74ed1b76138a2f5baa925afe40f9a8">zbx</a>.grow(1,1); <span class="comment">// Grow in x-dir and y-dir because we have filled that above</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <span class="keywordflow">if</span> (bx_lo.z == <a class="code" href="ERF__DiffSetup_8H.html#a2987796b2d40db9890dd3497cc7e20ca">dom_lo</a>.z) {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            ParallelFor(makeSlab(<a class="code" href="ERF__DiffSetup_8H.html#a4c74ed1b76138a2f5baa925afe40f9a8">zbx</a>,2,<a class="code" href="ERF__DiffSetup_8H.html#a2987796b2d40db9890dd3497cc7e20ca">dom_lo</a>.z), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                pp_arr(i,j,k-1) = pp_arr(i,j,k);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            });</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        }</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <span class="keywordflow">if</span> (bx_hi.z == <a class="code" href="ERF__DiffSetup_8H.html#a0f2c81fa9e8171e1116919f8b1ae0b28">dom_hi</a>.z) {</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;            ParallelFor(makeSlab(<a class="code" href="ERF__DiffSetup_8H.html#a4c74ed1b76138a2f5baa925afe40f9a8">zbx</a>,2,<a class="code" href="ERF__DiffSetup_8H.html#a0f2c81fa9e8171e1116919f8b1ae0b28">dom_hi</a>.z), [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;            {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                pp_arr(i,j,k+1) = pp_arr(i,j,k);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            });</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        }</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    } <span class="comment">// mfi</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="comment">// Now overwrite with periodic fill outside domain and fine-fine fill inside</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    phi.FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;}</div>
<div class="ttc" id="aERF__DiffSetup_8H_html_ae3d636c41f5271630a5816a4b8b668b2"><div class="ttname"><a href="ERF__DiffSetup_8H.html#ae3d636c41f5271630a5816a4b8b668b2">ybx</a></div><div class="ttdeci">const Box ybx</div><div class="ttdef"><b>Definition:</b> ERF_DiffSetup.H:22</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7261c4eb7722af0dfe6cdfb8e2e9e4db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7261c4eb7722af0dfe6cdfb8e2e9e4db">&#9670;&nbsp;</a></span>init1DArrays()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::init1DArrays </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a618e8fdff3239cc79d4145d02b1ecaa2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a618e8fdff3239cc79d4145d02b1ecaa2">&#9670;&nbsp;</a></span>init_bcs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::init_bcs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Initializes data structures in the <a class="el" href="classERF.html">ERF</a> class that specify which boundary conditions we are implementing on each face of the domain.</p>
<p>This function also maps the selected boundary condition types (e.g. Outflow, Inflow, InflowOutflow, Periodic, Dirichlet, ...) to the specific implementation needed for each variable.</p>
<p>Stores this information in both host and device vectors so it is available for GPU kernels. </p>
<div class="fragment"><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;{</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <span class="keywordtype">bool</span> rho_read = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="keywordtype">bool</span> read_prim_theta = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    Vector&lt;Real&gt; cons_dir_init(<a class="code" href="ERF__IndexDefines_8H.html#a536619efb901de654431f987753ac67c">NBCVAR_max</a>,0.0);</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    cons_dir_init[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa559799ff291d4e692283c4056bac8db1">BCVars::Rho_bc_comp</a>] = 1.0;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    cons_dir_init[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>] = -1.0;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="keyword">auto</span> f = [<span class="keyword">this</span>,&amp;rho_read,&amp;read_prim_theta] (std::string <span class="keyword">const</span>&amp; bcid, Orientation ori)</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    {</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        <span class="comment">// These are simply defaults for Dirichlet faces -- they should be over-written below</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        <a class="code" href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa559799ff291d4e692283c4056bac8db1">BCVars::Rho_bc_comp</a>][ori]       =  1.0;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        <a class="code" href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>][ori]  = -1.0; <span class="comment">// It is important to set this negative</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;                                                                 <span class="comment">// because the sign is tested on below</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa1556c0a3817c6fab60fbb6952cf0124f">BCVars::RhoKE_bc_comp</a>; n &lt; <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>; n++) {</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;            <a class="code" href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">m_bc_extdir_vals</a>[n][ori]                     = 0.0;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        }</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        <a class="code" href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>][ori] = 0.0; <span class="comment">// default</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        <a class="code" href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a>][ori] = 0.0;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        <a class="code" href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa03b35ec9e83f34bb1349a86965d34e34">BCVars::zvel_bc</a>][ori] = 0.0;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        <span class="comment">// These are simply defaults for Neumann gradients -- they should be over-written below</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        <a class="code" href="classERF.html#af783df8719de2e72e347de5860f71528">m_bc_neumann_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa559799ff291d4e692283c4056bac8db1">BCVars::Rho_bc_comp</a>][ori]       = 0.0;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        <a class="code" href="classERF.html#af783df8719de2e72e347de5860f71528">m_bc_neumann_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>][ori]  = 0.0;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <a class="code" href="classERF.html#af783df8719de2e72e347de5860f71528">m_bc_neumann_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa1556c0a3817c6fab60fbb6952cf0124f">BCVars::RhoKE_bc_comp</a>][ori]     = 0.0;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        <a class="code" href="classERF.html#af783df8719de2e72e347de5860f71528">m_bc_neumann_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa029ef491930290dea3a984ebdb6d6ae4">BCVars::RhoScalar_bc_comp</a>][ori] = 0.0;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        <a class="code" href="classERF.html#af783df8719de2e72e347de5860f71528">m_bc_neumann_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa0473174d8328f2bf7f74b84e9047e684">BCVars::RhoQ1_bc_comp</a>][ori]     = 0.0;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        <a class="code" href="classERF.html#af783df8719de2e72e347de5860f71528">m_bc_neumann_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa502372fe4399d381375f39c17301030c">BCVars::RhoQ2_bc_comp</a>][ori]     = 0.0;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <a class="code" href="classERF.html#af783df8719de2e72e347de5860f71528">m_bc_neumann_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa399697f16f566e3542ea07706b31883a">BCVars::RhoQ3_bc_comp</a>][ori]     = 0.0;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <a class="code" href="classERF.html#af783df8719de2e72e347de5860f71528">m_bc_neumann_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa13dd5e908f2388d3e0b6851a1c740d6f">BCVars::RhoQ4_bc_comp</a>][ori]     = 0.0;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <a class="code" href="classERF.html#af783df8719de2e72e347de5860f71528">m_bc_neumann_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aafb78d904a8ca650972e4228605d79f47">BCVars::RhoQ5_bc_comp</a>][ori]     = 0.0;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <a class="code" href="classERF.html#af783df8719de2e72e347de5860f71528">m_bc_neumann_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa00707393b2277520e45780bfdb471a4b">BCVars::RhoQ6_bc_comp</a>][ori]     = 0.0;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <a class="code" href="classERF.html#af783df8719de2e72e347de5860f71528">m_bc_neumann_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>][ori] = 0.0;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <a class="code" href="classERF.html#af783df8719de2e72e347de5860f71528">m_bc_neumann_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a>][ori] = 0.0;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <a class="code" href="classERF.html#af783df8719de2e72e347de5860f71528">m_bc_neumann_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa03b35ec9e83f34bb1349a86965d34e34">BCVars::zvel_bc</a>][ori] = 0.0;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        std::string pp_text = <a class="code" href="classERF.html#a59df30e7a5537c8543bb00772bd98b58">pp_prefix</a> + <span class="stringliteral">&quot;.&quot;</span> + bcid;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        ParmParse <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>(pp_text);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        std::string bc_type_in;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;type&quot;</span>, bc_type_in) &lt;= 0)</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            pp_text = bcid;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;            <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a> = ParmParse(pp_text);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;            <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;type&quot;</span>, bc_type_in);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        }</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        std::string bc_type = amrex::toLower(bc_type_in);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <span class="keywordflow">if</span> (bc_type == <span class="stringliteral">&quot;symmetry&quot;</span>)</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            <span class="comment">// Print() &lt;&lt; bcid &lt;&lt; &quot; set to symmetry.\n&quot;;</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;              <a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[ori] = <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a40e712f30d56083318ab20a2402921d2">ERF_BC::symmetry</a>;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;            <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[ori] = <span class="stringliteral">&quot;Symmetry&quot;</span>;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bc_type == <span class="stringliteral">&quot;outflow&quot;</span>)</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        {</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            <span class="comment">// Print() &lt;&lt; bcid &lt;&lt; &quot; set to outflow.\n&quot;;</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;              <a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[ori] = <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9acac0c32caf84a889ec9b2b4cb2d56972">ERF_BC::outflow</a>;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[ori] = <span class="stringliteral">&quot;Outflow&quot;</span>;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        }</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bc_type == <span class="stringliteral">&quot;open&quot;</span>)</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            <span class="comment">// Print() &lt;&lt; bcid &lt;&lt; &quot; set to open.\n&quot;;</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;            AMREX_ASSERT_WITH_MESSAGE((ori.coordDir() != 2), <span class="stringliteral">&quot;Open boundary not valid on zlo or zhi!&quot;</span>);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;              <a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[ori] = <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a7cef8a734855777c2a9d0caf42666e69">ERF_BC::open</a>;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[ori] = <span class="stringliteral">&quot;Open&quot;</span>;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        }</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bc_type == <span class="stringliteral">&quot;ho_outflow&quot;</span>)</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;            <a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[ori] = <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a7a78e4cea7eaa21ad14a6fa92fbdc549">ERF_BC::ho_outflow</a>;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[ori] = <span class="stringliteral">&quot;HO_Outflow&quot;</span>;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        }</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bc_type == <span class="stringliteral">&quot;inflow&quot;</span> || bc_type == <span class="stringliteral">&quot;inflow_outflow&quot;</span>)</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            <span class="keywordflow">if</span> (bc_type == <span class="stringliteral">&quot;inflow&quot;</span>) {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                <span class="comment">// Print() &lt;&lt; bcid &lt;&lt; &quot; set to inflow.\n&quot;;</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                  <a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[ori] = <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9ad37e67db17cfd059f2852e2673b9e8ef">ERF_BC::inflow</a>;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[ori] = <span class="stringliteral">&quot;Inflow&quot;</span>;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                <span class="comment">// Print() &lt;&lt; bcid &lt;&lt; &quot; set to inflow_outflow.\n&quot;;</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                  <a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[ori] = <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9aa9725058404b592f304cb28626db99ab">ERF_BC::inflow_outflow</a>;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[ori] = <span class="stringliteral">&quot;InflowOutflow&quot;</span>;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;            }</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;            std::vector&lt;Real&gt; v;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a80ad08512968ec45635df68abe66b1fc">input_bndry_planes</a> &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_velocity()) {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                <a class="code" href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>][ori] = 0.;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                <a class="code" href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a>][ori] = 0.;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                <a class="code" href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa03b35ec9e83f34bb1349a86965d34e34">BCVars::zvel_bc</a>][ori] = 0.;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                <span class="comment">// Test for input data file if at xlo face</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                std::string dirichlet_file;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                <span class="keyword">auto</span> file_exists = <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;dirichlet_file&quot;</span>, dirichlet_file);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                <span class="keywordflow">if</span> (file_exists) {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                    <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;read_prim_theta&quot;</span>, read_prim_theta);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                    <a class="code" href="classERF.html#a3079a30cce7e1a01d5c9705f393b5a63">init_Dirichlet_bc_data</a>(dirichlet_file);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                    <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.getarr(<span class="stringliteral">&quot;velocity&quot;</span>, v, 0, AMREX_SPACEDIM);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                    <a class="code" href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>][ori] = v[0];</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                    <a class="code" href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a>][ori] = v[1];</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                    <a class="code" href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa03b35ec9e83f34bb1349a86965d34e34">BCVars::zvel_bc</a>][ori] = v[2];</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            Real rho_in = 0.;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a80ad08512968ec45635df68abe66b1fc">input_bndry_planes</a> &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_density()) {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                <a class="code" href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa559799ff291d4e692283c4056bac8db1">BCVars::Rho_bc_comp</a>][ori] = 0.;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;density&quot;</span>, rho_in)) {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                    amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Using interior values to set conserved vars&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                }</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                <a class="code" href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa559799ff291d4e692283c4056bac8db1">BCVars::Rho_bc_comp</a>][ori] = rho_in;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            }</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            <span class="keywordtype">bool</span> th_read  = (<a class="code" href="classERF.html#a67c86c65b27f8ceee58b5ca989116e14">th_bc_data</a>[0].data()!=<span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            Real theta_in = 0.;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a80ad08512968ec45635df68abe66b1fc">input_bndry_planes</a> &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_theta()) {</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                <a class="code" href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>][ori] = 0.;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!th_read) {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                <span class="keywordflow">if</span> (rho_in &gt; 0) {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                    <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.get(<span class="stringliteral">&quot;theta&quot;</span>, theta_in);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                }</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                <a class="code" href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>][ori] = rho_in*theta_in;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            }</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            Real scalar_in = 0.;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a80ad08512968ec45635df68abe66b1fc">input_bndry_planes</a> &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_scalar()) {</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                <a class="code" href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa029ef491930290dea3a984ebdb6d6ae4">BCVars::RhoScalar_bc_comp</a>][ori] = 0.;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;scalar&quot;</span>, scalar_in))</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                <a class="code" href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa029ef491930290dea3a984ebdb6d6ae4">BCVars::RhoScalar_bc_comp</a>][ori] = rho_in*scalar_in;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            }</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> != MoistureType::None) {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                Real qv_in = 0.;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a80ad08512968ec45635df68abe66b1fc">input_bndry_planes</a> &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_q1()) {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                    <a class="code" href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa0473174d8328f2bf7f74b84e9047e684">BCVars::RhoQ1_bc_comp</a>][ori] = 0.;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;qv&quot;</span>, qv_in))</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                    <a class="code" href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa0473174d8328f2bf7f74b84e9047e684">BCVars::RhoQ1_bc_comp</a>][ori] = rho_in*qv_in;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                }</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                Real qc_in = 0.;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a80ad08512968ec45635df68abe66b1fc">input_bndry_planes</a> &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_q2()) {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                    <a class="code" href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa502372fe4399d381375f39c17301030c">BCVars::RhoQ2_bc_comp</a>][ori] = 0.;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;qc&quot;</span>, qc_in))</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                    <a class="code" href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa502372fe4399d381375f39c17301030c">BCVars::RhoQ2_bc_comp</a>][ori] = rho_in*qc_in;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                }</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            Real KE_in = 0.;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a80ad08512968ec45635df68abe66b1fc">input_bndry_planes</a> &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_KE()) {</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                <a class="code" href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa1556c0a3817c6fab60fbb6952cf0124f">BCVars::RhoKE_bc_comp</a>][ori] = 0.;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;KE&quot;</span>, KE_in))</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                <a class="code" href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa1556c0a3817c6fab60fbb6952cf0124f">BCVars::RhoKE_bc_comp</a>][ori] = rho_in*KE_in;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            }</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        }</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bc_type == <span class="stringliteral">&quot;noslipwall&quot;</span>)</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            <span class="comment">// Print() &lt;&lt; bcid &lt;&lt;&quot; set to no-slip wall.\n&quot;;</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;              <a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[ori] = <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9acb8c716b8d9b499d9bc323d8f8a410d3">ERF_BC::no_slip_wall</a>;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[ori] = <span class="stringliteral">&quot;NoSlipWall&quot;</span>;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            std::vector&lt;Real&gt; v;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            <span class="comment">// The values of m_bc_extdir_vals default to 0.</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            <span class="comment">// But if we find &quot;velocity&quot; in the inputs file, use those values instead.</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.queryarr(<span class="stringliteral">&quot;velocity&quot;</span>, v, 0, AMREX_SPACEDIM))</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            {</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                v[ori.coordDir()] = 0.0;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                <a class="code" href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>][ori] = v[0];</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                <a class="code" href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a>][ori] = v[1];</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                <a class="code" href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa03b35ec9e83f34bb1349a86965d34e34">BCVars::zvel_bc</a>][ori] = v[2];</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            }</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            Real rho_in;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            rho_read = <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;density&quot;</span>, rho_in);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            <span class="keywordflow">if</span> (rho_read)</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            {</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                <a class="code" href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa559799ff291d4e692283c4056bac8db1">BCVars::Rho_bc_comp</a>][ori] = rho_in;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;            }</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            Real theta_in;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;theta&quot;</span>, theta_in))</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;               <a class="code" href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>][ori] = theta_in*<a class="code" href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa559799ff291d4e692283c4056bac8db1">BCVars::Rho_bc_comp</a>][ori];</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            }</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            Real theta_grad_in;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;theta_grad&quot;</span>, theta_grad_in))</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                <a class="code" href="classERF.html#af783df8719de2e72e347de5860f71528">m_bc_neumann_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>][ori] = theta_grad_in;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            }</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            Real qv_in;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;qv&quot;</span>, qv_in))</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                <a class="code" href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa0473174d8328f2bf7f74b84e9047e684">BCVars::RhoQ1_bc_comp</a>][ori] = qv_in*<a class="code" href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa559799ff291d4e692283c4056bac8db1">BCVars::Rho_bc_comp</a>][ori];</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            }</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        }</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bc_type == <span class="stringliteral">&quot;slipwall&quot;</span>)</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        {</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            <span class="comment">// Print() &lt;&lt; bcid &lt;&lt;&quot; set to slip wall.\n&quot;;</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;              <a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[ori] = <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a03ee6de9fd100444c5c0567ea01bd538">ERF_BC::slip_wall</a>;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[ori] = <span class="stringliteral">&quot;SlipWall&quot;</span>;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            Real rho_in;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            rho_read = <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;density&quot;</span>, rho_in);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            <span class="keywordflow">if</span> (rho_read)</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            {</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                <a class="code" href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa559799ff291d4e692283c4056bac8db1">BCVars::Rho_bc_comp</a>][ori] = rho_in;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            }</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            Real theta_in;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;theta&quot;</span>, theta_in))</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;               <a class="code" href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>][ori] = theta_in*<a class="code" href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa559799ff291d4e692283c4056bac8db1">BCVars::Rho_bc_comp</a>][ori];</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            Real rho_grad_in;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;density_grad&quot;</span>, rho_grad_in))</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            {</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;               <a class="code" href="classERF.html#af783df8719de2e72e347de5860f71528">m_bc_neumann_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa559799ff291d4e692283c4056bac8db1">BCVars::Rho_bc_comp</a>][ori] = rho_grad_in;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            }</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            Real theta_grad_in;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;theta_grad&quot;</span>, theta_grad_in))</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            {</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;               <a class="code" href="classERF.html#af783df8719de2e72e347de5860f71528">m_bc_neumann_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>][ori] = theta_grad_in;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            }</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        }</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bc_type == <span class="stringliteral">&quot;surface_layer&quot;</span>)</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;              <a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[ori] = <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9af69483cb4bb9623dc65e76ce5bd0a3d5">ERF_BC::surface_layer</a>;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;            <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[ori] = <span class="stringliteral">&quot;surface_layer&quot;</span>;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        }</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            <a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[ori] = <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a5e543256c480ac577d30f76f9120eb74">ERF_BC::undefined</a>;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        }</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <span class="keywordflow">if</span> (geom[0].isPeriodic(ori.coordDir())) {</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[ori] = <span class="stringliteral">&quot;Periodic&quot;</span>;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[ori] == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a5e543256c480ac577d30f76f9120eb74">ERF_BC::undefined</a>)</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            {</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                <a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[ori] = <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9ae6ffdec5e14fce371eb7ae99edebbbee">ERF_BC::periodic</a>;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                Abort(<span class="stringliteral">&quot;Wrong BC type for periodic boundary&quot;</span>);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            }</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        }</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[ori] == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a5e543256c480ac577d30f76f9120eb74">ERF_BC::undefined</a>)</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;             Print() &lt;&lt; <span class="stringliteral">&quot;BC Type specified for face &quot;</span> &lt;&lt; bcid &lt;&lt; <span class="stringliteral">&quot; is &quot;</span> &lt;&lt; bc_type_in &lt;&lt; std::endl;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;             Abort(<span class="stringliteral">&quot;This BC type is unknown&quot;</span>);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        }</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    };</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160; </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    f(<span class="stringliteral">&quot;xlo&quot;</span>, Orientation(Direction::x,Orientation::low));</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    f(<span class="stringliteral">&quot;xhi&quot;</span>, Orientation(Direction::x,Orientation::high));</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    f(<span class="stringliteral">&quot;ylo&quot;</span>, Orientation(Direction::y,Orientation::low));</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    f(<span class="stringliteral">&quot;yhi&quot;</span>, Orientation(Direction::y,Orientation::high));</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    f(<span class="stringliteral">&quot;zlo&quot;</span>, Orientation(Direction::z,Orientation::low));</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    f(<span class="stringliteral">&quot;zhi&quot;</span>, Orientation(Direction::z,Orientation::high));</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="comment">// *****************************************************************************</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="comment">// Here we translate the physical boundary conditions -- one type per face --</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="comment">//     into logical boundary conditions for each velocity component</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="comment">// *****************************************************************************</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    {</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>.resize(AMREX_SPACEDIM+<a class="code" href="ERF__IndexDefines_8H.html#a536619efb901de654431f987753ac67c">NBCVAR_max</a>);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <a class="code" href="classERF.html#a8a99e22b1111c803e31b4afd5fcdea60">domain_bcs_type_d</a>.resize(AMREX_SPACEDIM+<a class="code" href="ERF__IndexDefines_8H.html#a536619efb901de654431f987753ac67c">NBCVAR_max</a>);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="keywordflow">for</span> (OrientationIter oit; oit; ++oit) {</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            Orientation ori = oit();</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            <span class="keywordtype">int</span> dir = ori.coordDir();</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            Orientation::Side side = ori.faceDir();</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;            <span class="keyword">auto</span> <span class="keyword">const</span> bct = <a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[ori];</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            <span class="keywordflow">if</span> ( bct == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a40e712f30d56083318ab20a2402921d2">ERF_BC::symmetry</a> )</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            {</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++) {</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01cabc47f82507730e1734a2f3bc58893cf9">ERFBCType::reflect_even</a>);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                    }</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                    <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+dir].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca41cecdb4487b15207675ae9ee564e705">ERFBCType::reflect_odd</a>);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++) {</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01cabc47f82507730e1734a2f3bc58893cf9">ERFBCType::reflect_even</a>);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                    }</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                    <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+dir].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca41cecdb4487b15207675ae9ee564e705">ERFBCType::reflect_odd</a>);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                }</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            }</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bct == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9acac0c32caf84a889ec9b2b4cb2d56972">ERF_BC::outflow</a> or bct == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a7a78e4cea7eaa21ad14a6fa92fbdc549">ERF_BC::ho_outflow</a> )</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            {</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++) {</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4a8d85af949a1ce567934e55c69c2846">ERFBCType::foextrap</a>);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                    }</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                    <span class="keywordflow">if</span> (!<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa7be0d60ce3de3441d44082cc1b725ec">anelastic</a>[0]) {</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+dir].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01caa8e7f5249fea539bf14e97cfba9074d9">ERFBCType::neumann_int</a>);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                    }</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++) {</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4a8d85af949a1ce567934e55c69c2846">ERFBCType::foextrap</a>);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                    }</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                    <span class="keywordflow">if</span> (!<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa7be0d60ce3de3441d44082cc1b725ec">anelastic</a>[0]) {</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+dir].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01caa8e7f5249fea539bf14e97cfba9074d9">ERFBCType::neumann_int</a>);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                    }</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                }</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            }</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bct == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a7cef8a734855777c2a9d0caf42666e69">ERF_BC::open</a>)</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            {</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++)</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca2b4e1a73027449d9af83a25ed67ae914">ERFBCType::open</a>);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++)</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca2b4e1a73027449d9af83a25ed67ae914">ERFBCType::open</a>);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                }</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            }</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bct == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9ad37e67db17cfd059f2852e2673b9e8ef">ERF_BC::inflow</a>)</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            {</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++) {</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af">ERFBCType::ext_dir</a>);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a80ad08512968ec45635df68abe66b1fc">input_bndry_planes</a> &amp;&amp; dir &lt; 2 &amp;&amp; m_r2d-&gt;ingested_velocity()) {</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                            <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca138e8c6c2427dcd78959f3e0e84b3462">ERFBCType::ext_dir_ingested</a>);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                        }</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                    }</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++) {</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af">ERFBCType::ext_dir</a>);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a80ad08512968ec45635df68abe66b1fc">input_bndry_planes</a> &amp;&amp; dir &lt; 2 &amp;&amp; m_r2d-&gt;ingested_velocity()) {</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                            <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca138e8c6c2427dcd78959f3e0e84b3462">ERFBCType::ext_dir_ingested</a>);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                        }</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                    }</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                }</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            }</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bct == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9aa9725058404b592f304cb28626db99ab">ERF_BC::inflow_outflow</a>)</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            {</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++) {</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca87f4264e223d4c9fba88b023509a1c6d">ERFBCType::ext_dir_upwind</a>);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                    }</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++) {</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca87f4264e223d4c9fba88b023509a1c6d">ERFBCType::ext_dir_upwind</a>);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                    }</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                }</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;            }</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bct == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9acb8c716b8d9b499d9bc323d8f8a410d3">ERF_BC::no_slip_wall</a>)</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;            {</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++) {</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af">ERFBCType::ext_dir</a>);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                    }</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++) {</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af">ERFBCType::ext_dir</a>);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                    }</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                }</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;            }</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bct == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a03ee6de9fd100444c5c0567ea01bd538">ERF_BC::slip_wall</a>)</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            {</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++) {</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4a8d85af949a1ce567934e55c69c2846">ERFBCType::foextrap</a>);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                    }</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                    <span class="comment">// Only normal direction has ext_dir</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                    <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+dir].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af">ERFBCType::ext_dir</a>);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160; </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++) {</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4a8d85af949a1ce567934e55c69c2846">ERFBCType::foextrap</a>);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                    }</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                    <span class="comment">// Only normal direction has ext_dir</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                    <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+dir].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af">ERFBCType::ext_dir</a>);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                }</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;            }</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bct == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9ae6ffdec5e14fce371eb7ae99edebbbee">ERF_BC::periodic</a>)</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;            {</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++) {</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca9f18284526a1054d4e7a4783852ead30">ERFBCType::int_dir</a>);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                    }</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; i++) {</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca9f18284526a1054d4e7a4783852ead30">ERFBCType::int_dir</a>);</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                    }</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                }</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;            }</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( bct == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9af69483cb4bb9623dc65e76ce5bd0a3d5">ERF_BC::surface_layer</a> )</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            {</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                AMREX_ALWAYS_ASSERT(dir == 2 &amp;&amp; side == Orientation::low);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+0].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca42f56b8b6a6f3b72ff598d9df25651c5">ERFBCType::hoextrap</a>);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+1].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca42f56b8b6a6f3b72ff598d9df25651c5">ERFBCType::hoextrap</a>);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>+2].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af">ERFBCType::ext_dir</a>);</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;            }</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        }</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    }</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160; </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="comment">// *****************************************************************************</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="comment">// Here we translate the physical boundary conditions -- one type per face --</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="comment">//     into logical boundary conditions for each cell-centered variable</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="comment">//     (including the base state variables)</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="comment">// NOTE: all &quot;scalars&quot; share the same type of boundary condition</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="comment">// *****************************************************************************</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    {</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        <span class="keywordflow">for</span> (OrientationIter oit; oit; ++oit) {</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            Orientation ori = oit();</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;            <span class="keywordtype">int</span> dir = ori.coordDir();</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;            Orientation::Side side = ori.faceDir();</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;            <span class="keyword">auto</span> <span class="keyword">const</span> bct = <a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[ori];</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;            <span class="keywordflow">if</span> ( bct == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a40e712f30d56083318ab20a2402921d2">ERF_BC::symmetry</a> )</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;            {</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="ERF__IndexDefines_8H.html#a536619efb901de654431f987753ac67c">NBCVAR_max</a>; i++) {</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01cabc47f82507730e1734a2f3bc58893cf9">ERFBCType::reflect_even</a>);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                    }</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="ERF__IndexDefines_8H.html#a536619efb901de654431f987753ac67c">NBCVAR_max</a>; i++) {</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01cabc47f82507730e1734a2f3bc58893cf9">ERFBCType::reflect_even</a>);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                    }</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                }</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;            }</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( bct == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9acac0c32caf84a889ec9b2b4cb2d56972">ERF_BC::outflow</a> )</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;            {</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="ERF__IndexDefines_8H.html#a536619efb901de654431f987753ac67c">NBCVAR_max</a>; i++) {</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4a8d85af949a1ce567934e55c69c2846">ERFBCType::foextrap</a>);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                    }</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="ERF__IndexDefines_8H.html#a536619efb901de654431f987753ac67c">NBCVAR_max</a>; i++) {</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4a8d85af949a1ce567934e55c69c2846">ERFBCType::foextrap</a>);</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                    }</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                }</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;            }</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( bct == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a7a78e4cea7eaa21ad14a6fa92fbdc549">ERF_BC::ho_outflow</a> )</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;            {</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="ERF__IndexDefines_8H.html#a536619efb901de654431f987753ac67c">NBCVAR_max</a>; i++) {</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca42f56b8b6a6f3b72ff598d9df25651c5">ERFBCType::hoextrap</a>);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                    }</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="ERF__IndexDefines_8H.html#a536619efb901de654431f987753ac67c">NBCVAR_max</a>; i++) {</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca42f56b8b6a6f3b72ff598d9df25651c5">ERFBCType::hoextrap</a>);</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                    }</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                }</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;            }</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( bct == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a7cef8a734855777c2a9d0caf42666e69">ERF_BC::open</a> )</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;            {</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="ERF__IndexDefines_8H.html#a536619efb901de654431f987753ac67c">NBCVAR_max</a>; i++)</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca2b4e1a73027449d9af83a25ed67ae914">ERFBCType::open</a>);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="ERF__IndexDefines_8H.html#a536619efb901de654431f987753ac67c">NBCVAR_max</a>; i++)</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca2b4e1a73027449d9af83a25ed67ae914">ERFBCType::open</a>);</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                }</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;            }</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( bct == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9acb8c716b8d9b499d9bc323d8f8a410d3">ERF_BC::no_slip_wall</a> )</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;            {</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="ERF__IndexDefines_8H.html#a536619efb901de654431f987753ac67c">NBCVAR_max</a>; i++) {</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4a8d85af949a1ce567934e55c69c2846">ERFBCType::foextrap</a>);</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i][ori] != cons_dir_init[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i]) {</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                            <span class="keywordflow">if</span> (rho_read) {</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                                <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af">ERFBCType::ext_dir</a>);</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                                <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca52a76d5c6aeb74655f726be3ae8a1eab">ERFBCType::ext_dir_prim</a>);</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                            }</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                        }</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                    }</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                    <span class="keywordflow">if</span> (std::abs(<a class="code" href="classERF.html#af783df8719de2e72e347de5860f71528">m_bc_neumann_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>][ori]) &gt; 0.) {</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca0b217c3380adcde8f3cd9b58d949db60">ERFBCType::neumann</a>);</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                    }</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="ERF__IndexDefines_8H.html#a536619efb901de654431f987753ac67c">NBCVAR_max</a>; i++) {</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4a8d85af949a1ce567934e55c69c2846">ERFBCType::foextrap</a>);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i][ori] != cons_dir_init[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i]) {</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                            <span class="keywordflow">if</span> (rho_read) {</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                                <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af">ERFBCType::ext_dir</a>);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                                <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca52a76d5c6aeb74655f726be3ae8a1eab">ERFBCType::ext_dir_prim</a>);</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                            }</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                        }</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                    }</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                    <span class="keywordflow">if</span> (std::abs(<a class="code" href="classERF.html#af783df8719de2e72e347de5860f71528">m_bc_neumann_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>][ori]) &gt; 0.) {</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca0b217c3380adcde8f3cd9b58d949db60">ERFBCType::neumann</a>);</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                    }</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                }</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;            }</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bct == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a03ee6de9fd100444c5c0567ea01bd538">ERF_BC::slip_wall</a>)</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;            {</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="ERF__IndexDefines_8H.html#a536619efb901de654431f987753ac67c">NBCVAR_max</a>; i++) {</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4a8d85af949a1ce567934e55c69c2846">ERFBCType::foextrap</a>);</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i][ori] != cons_dir_init[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i]) {</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                            <span class="keywordflow">if</span> (rho_read) {</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                                <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af">ERFBCType::ext_dir</a>);</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                                <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca52a76d5c6aeb74655f726be3ae8a1eab">ERFBCType::ext_dir_prim</a>);</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                            }</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                        }</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                    }</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                    <span class="keywordflow">if</span> (std::abs(<a class="code" href="classERF.html#af783df8719de2e72e347de5860f71528">m_bc_neumann_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>][ori]) &gt; 0.) {</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca0b217c3380adcde8f3cd9b58d949db60">ERFBCType::neumann</a>);</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                    }</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                    <span class="keywordflow">if</span> (std::abs(<a class="code" href="classERF.html#af783df8719de2e72e347de5860f71528">m_bc_neumann_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa559799ff291d4e692283c4056bac8db1">BCVars::Rho_bc_comp</a>][ori]) &gt; 0.) {</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa559799ff291d4e692283c4056bac8db1">BCVars::Rho_bc_comp</a>].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca0b217c3380adcde8f3cd9b58d949db60">ERFBCType::neumann</a>);</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                    }</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="ERF__IndexDefines_8H.html#a536619efb901de654431f987753ac67c">NBCVAR_max</a>; i++) {</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4a8d85af949a1ce567934e55c69c2846">ERFBCType::foextrap</a>);</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i][ori] != cons_dir_init[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i]) {</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                            <span class="keywordflow">if</span> (rho_read) {</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                                <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af">ERFBCType::ext_dir</a>);</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                                <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca52a76d5c6aeb74655f726be3ae8a1eab">ERFBCType::ext_dir_prim</a>);</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                            }</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                        }</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                    }</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                    <span class="keywordflow">if</span> (std::abs(<a class="code" href="classERF.html#af783df8719de2e72e347de5860f71528">m_bc_neumann_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>][ori]) &gt; 0.) {</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca0b217c3380adcde8f3cd9b58d949db60">ERFBCType::neumann</a>);</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                    }</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                    <span class="keywordflow">if</span> (std::abs(<a class="code" href="classERF.html#af783df8719de2e72e347de5860f71528">m_bc_neumann_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa559799ff291d4e692283c4056bac8db1">BCVars::Rho_bc_comp</a>][ori]) &gt; 0.) {</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa559799ff291d4e692283c4056bac8db1">BCVars::Rho_bc_comp</a>].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca0b217c3380adcde8f3cd9b58d949db60">ERFBCType::neumann</a>);</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                    }</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                }</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;            }</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bct == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9ad37e67db17cfd059f2852e2673b9e8ef">ERF_BC::inflow</a>)</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;            {</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="ERF__IndexDefines_8H.html#a536619efb901de654431f987753ac67c">NBCVAR_max</a>; i++) {</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af">ERFBCType::ext_dir</a>);</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                        <span class="keywordflow">if</span> ((<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i == <a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>) &amp;&amp;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                            (<a class="code" href="classERF.html#a67c86c65b27f8ceee58b5ca989116e14">th_bc_data</a>[0].data() != <span class="keyword">nullptr</span>))</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                        {</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                            <span class="keywordflow">if</span> (read_prim_theta) <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca52a76d5c6aeb74655f726be3ae8a1eab">ERFBCType::ext_dir_prim</a>);</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                        }</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a80ad08512968ec45635df68abe66b1fc">input_bndry_planes</a> &amp;&amp; dir &lt; 2 &amp;&amp; (</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                           ( (<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i == <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa559799ff291d4e692283c4056bac8db1">BCVars::Rho_bc_comp</a>)       &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_density()) ||</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                           ( (<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i == <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>)  &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_theta()  ) ||</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                           ( (<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i == <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa1556c0a3817c6fab60fbb6952cf0124f">BCVars::RhoKE_bc_comp</a>)     &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_KE()     ) ||</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                           ( (<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i == <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa029ef491930290dea3a984ebdb6d6ae4">BCVars::RhoScalar_bc_comp</a>) &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_scalar() ) ||</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                           ( (<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i == <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa0473174d8328f2bf7f74b84e9047e684">BCVars::RhoQ1_bc_comp</a>)     &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_q1()     ) ||</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                           ( (<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i == <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa502372fe4399d381375f39c17301030c">BCVars::RhoQ2_bc_comp</a>)     &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_q2()     )) )</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                        {</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                            <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca138e8c6c2427dcd78959f3e0e84b3462">ERFBCType::ext_dir_ingested</a>);</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                        }</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa559799ff291d4e692283c4056bac8db1">BCVars::Rho_bc_comp</a>][ori] == 0) {</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                            <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4a8d85af949a1ce567934e55c69c2846">ERFBCType::foextrap</a>);</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                        }</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                    }</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="ERF__IndexDefines_8H.html#a536619efb901de654431f987753ac67c">NBCVAR_max</a>; i++) {</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af">ERFBCType::ext_dir</a>);</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                        <span class="keywordflow">if</span> ((<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i == <a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>) &amp;&amp;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                            (<a class="code" href="classERF.html#a67c86c65b27f8ceee58b5ca989116e14">th_bc_data</a>[0].data() != <span class="keyword">nullptr</span>))</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                        {</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                            <span class="keywordflow">if</span> (read_prim_theta) <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca52a76d5c6aeb74655f726be3ae8a1eab">ERFBCType::ext_dir_prim</a>);</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;                        }</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a80ad08512968ec45635df68abe66b1fc">input_bndry_planes</a> &amp;&amp; dir &lt; 2 &amp;&amp; (</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                           ( (<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i == <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa559799ff291d4e692283c4056bac8db1">BCVars::Rho_bc_comp</a>)       &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_density()) ||</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                           ( (<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i == <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a>)  &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_theta()  ) ||</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                           ( (<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i == <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa1556c0a3817c6fab60fbb6952cf0124f">BCVars::RhoKE_bc_comp</a>)     &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_KE()     ) ||</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                           ( (<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i == <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa029ef491930290dea3a984ebdb6d6ae4">BCVars::RhoScalar_bc_comp</a>) &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_scalar() ) ||</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                           ( (<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i == <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa0473174d8328f2bf7f74b84e9047e684">BCVars::RhoQ1_bc_comp</a>)     &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_q1()     ) ||</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                           ( (<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i == <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa502372fe4399d381375f39c17301030c">BCVars::RhoQ2_bc_comp</a>)     &amp;&amp; <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;ingested_q2()     )</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                           ) )</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                        {</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                            <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca138e8c6c2427dcd78959f3e0e84b3462">ERFBCType::ext_dir_ingested</a>);</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                        }</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa559799ff291d4e692283c4056bac8db1">BCVars::Rho_bc_comp</a>][ori] == 0) {</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                            <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4a8d85af949a1ce567934e55c69c2846">ERFBCType::foextrap</a>);</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                        }</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                    }</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                }</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;            }</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bct == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9aa9725058404b592f304cb28626db99ab">ERF_BC::inflow_outflow</a> )</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;            {</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="ERF__IndexDefines_8H.html#a536619efb901de654431f987753ac67c">NBCVAR_max</a>; i++) {</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca87f4264e223d4c9fba88b023509a1c6d">ERFBCType::ext_dir_upwind</a>);</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa559799ff291d4e692283c4056bac8db1">BCVars::Rho_bc_comp</a>][ori] == 0) {</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                            <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4a8d85af949a1ce567934e55c69c2846">ERFBCType::foextrap</a>);</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                        }</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                    }</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="ERF__IndexDefines_8H.html#a536619efb901de654431f987753ac67c">NBCVAR_max</a>; i++) {</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca87f4264e223d4c9fba88b023509a1c6d">ERFBCType::ext_dir_upwind</a>);</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">m_bc_extdir_vals</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa559799ff291d4e692283c4056bac8db1">BCVars::Rho_bc_comp</a>][ori] == 0) {</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                            <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4a8d85af949a1ce567934e55c69c2846">ERFBCType::foextrap</a>);</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                        }</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                    }</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                }</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;            }</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bct == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9ae6ffdec5e14fce371eb7ae99edebbbee">ERF_BC::periodic</a>)</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;            {</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                <span class="keywordflow">if</span> (side == Orientation::low) {</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="ERF__IndexDefines_8H.html#a536619efb901de654431f987753ac67c">NBCVAR_max</a>; i++) {</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                        <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca9f18284526a1054d4e7a4783852ead30">ERFBCType::int_dir</a>);</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                    }</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="ERF__IndexDefines_8H.html#a536619efb901de654431f987753ac67c">NBCVAR_max</a>; i++) {</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                       <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setHi(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca9f18284526a1054d4e7a4783852ead30">ERFBCType::int_dir</a>);</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                    }</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                }</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;            }</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( bct == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9af69483cb4bb9623dc65e76ce5bd0a3d5">ERF_BC::surface_layer</a> )</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;            {</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                AMREX_ALWAYS_ASSERT(dir == 2 &amp;&amp; side == Orientation::low);</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="ERF__IndexDefines_8H.html#a536619efb901de654431f987753ac67c">NBCVAR_max</a>; i++) {</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                    <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>[<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>+i].setLo(dir, <a class="code" href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca42f56b8b6a6f3b72ff598d9df25651c5">ERFBCType::hoextrap</a>);</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                }</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;            }</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        }</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    }</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160; </div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <span class="comment">// NOTE: Gpu:copy is a wrapper to htod_memcpy (GPU) or memcpy (CPU) and is a blocking comm</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    Gpu::copy(Gpu::hostToDevice, <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>.begin(), <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>.end(), <a class="code" href="classERF.html#a8a99e22b1111c803e31b4afd5fcdea60">domain_bcs_type_d</a>.begin());</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;}</div>
<div class="ttc" id="aERF__IndexDefines_8H_html_a536619efb901de654431f987753ac67c"><div class="ttname"><a href="ERF__IndexDefines_8H.html#a536619efb901de654431f987753ac67c">NBCVAR_max</a></div><div class="ttdeci">#define NBCVAR_max</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:29</div></div>
<div class="ttc" id="aERF__IndexDefines_8H_html_adf340bf1893bad34b2bf452d987d86c9a5e543256c480ac577d30f76f9120eb74"><div class="ttname"><a href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a5e543256c480ac577d30f76f9120eb74">ERF_BC::undefined</a></div><div class="ttdeci">@ undefined</div></div>
<div class="ttc" id="aERF__IndexDefines_8H_html_adf340bf1893bad34b2bf452d987d86c9a7a78e4cea7eaa21ad14a6fa92fbdc549"><div class="ttname"><a href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a7a78e4cea7eaa21ad14a6fa92fbdc549">ERF_BC::ho_outflow</a></div><div class="ttdeci">@ ho_outflow</div></div>
<div class="ttc" id="aERF__IndexDefines_8H_html_adf340bf1893bad34b2bf452d987d86c9a7cef8a734855777c2a9d0caf42666e69"><div class="ttname"><a href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a7cef8a734855777c2a9d0caf42666e69">ERF_BC::open</a></div><div class="ttdeci">@ open</div></div>
<div class="ttc" id="aERF__IndexDefines_8H_html_adf340bf1893bad34b2bf452d987d86c9aa9725058404b592f304cb28626db99ab"><div class="ttname"><a href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9aa9725058404b592f304cb28626db99ab">ERF_BC::inflow_outflow</a></div><div class="ttdeci">@ inflow_outflow</div></div>
<div class="ttc" id="aERF__IndexDefines_8H_html_adf340bf1893bad34b2bf452d987d86c9acac0c32caf84a889ec9b2b4cb2d56972"><div class="ttname"><a href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9acac0c32caf84a889ec9b2b4cb2d56972">ERF_BC::outflow</a></div><div class="ttdeci">@ outflow</div></div>
<div class="ttc" id="aERF__IndexDefines_8H_html_adf340bf1893bad34b2bf452d987d86c9ad37e67db17cfd059f2852e2673b9e8ef"><div class="ttname"><a href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9ad37e67db17cfd059f2852e2673b9e8ef">ERF_BC::inflow</a></div><div class="ttdeci">@ inflow</div></div>
<div class="ttc" id="aERF__IndexDefines_8H_html_adf340bf1893bad34b2bf452d987d86c9ae6ffdec5e14fce371eb7ae99edebbbee"><div class="ttname"><a href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9ae6ffdec5e14fce371eb7ae99edebbbee">ERF_BC::periodic</a></div><div class="ttdeci">@ periodic</div></div>
<div class="ttc" id="aclassERF_html_a3079a30cce7e1a01d5c9705f393b5a63"><div class="ttname"><a href="classERF.html#a3079a30cce7e1a01d5c9705f393b5a63">ERF::init_Dirichlet_bc_data</a></div><div class="ttdeci">void init_Dirichlet_bc_data(const std::string input_file)</div><div class="ttdef"><b>Definition:</b> ERF_InitBCs.cpp:652</div></div>
<div class="ttc" id="aclassERF_html_af783df8719de2e72e347de5860f71528"><div class="ttname"><a href="classERF.html#af783df8719de2e72e347de5860f71528">ERF::m_bc_neumann_vals</a></div><div class="ttdeci">amrex::Array&lt; amrex::Array&lt; amrex::Real, AMREX_SPACEDIM *2 &gt;, AMREX_SPACEDIM+NBCVAR_max &gt; m_bc_neumann_vals</div><div class="ttdef"><b>Definition:</b> ERF.H:861</div></div>
<div class="ttc" id="anamespaceBCVars_html_a00367571247ba920989360b94c156f4aa00707393b2277520e45780bfdb471a4b"><div class="ttname"><a href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa00707393b2277520e45780bfdb471a4b">BCVars::RhoQ6_bc_comp</a></div><div class="ttdeci">@ RhoQ6_bc_comp</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:86</div></div>
<div class="ttc" id="anamespaceBCVars_html_a00367571247ba920989360b94c156f4aa0473174d8328f2bf7f74b84e9047e684"><div class="ttname"><a href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa0473174d8328f2bf7f74b84e9047e684">BCVars::RhoQ1_bc_comp</a></div><div class="ttdeci">@ RhoQ1_bc_comp</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:81</div></div>
<div class="ttc" id="anamespaceBCVars_html_a00367571247ba920989360b94c156f4aa13dd5e908f2388d3e0b6851a1c740d6f"><div class="ttname"><a href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa13dd5e908f2388d3e0b6851a1c740d6f">BCVars::RhoQ4_bc_comp</a></div><div class="ttdeci">@ RhoQ4_bc_comp</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:84</div></div>
<div class="ttc" id="anamespaceBCVars_html_a00367571247ba920989360b94c156f4aa1556c0a3817c6fab60fbb6952cf0124f"><div class="ttname"><a href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa1556c0a3817c6fab60fbb6952cf0124f">BCVars::RhoKE_bc_comp</a></div><div class="ttdeci">@ RhoKE_bc_comp</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:79</div></div>
<div class="ttc" id="anamespaceBCVars_html_a00367571247ba920989360b94c156f4aa399697f16f566e3542ea07706b31883a"><div class="ttname"><a href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa399697f16f566e3542ea07706b31883a">BCVars::RhoQ3_bc_comp</a></div><div class="ttdeci">@ RhoQ3_bc_comp</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:83</div></div>
<div class="ttc" id="anamespaceBCVars_html_a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1"><div class="ttname"><a href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa417d2de099d125a0f6b3e32cde3733d1">BCVars::RhoTheta_bc_comp</a></div><div class="ttdeci">@ RhoTheta_bc_comp</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:78</div></div>
<div class="ttc" id="anamespaceBCVars_html_a00367571247ba920989360b94c156f4aa502372fe4399d381375f39c17301030c"><div class="ttname"><a href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa502372fe4399d381375f39c17301030c">BCVars::RhoQ2_bc_comp</a></div><div class="ttdeci">@ RhoQ2_bc_comp</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:82</div></div>
<div class="ttc" id="anamespaceBCVars_html_a00367571247ba920989360b94c156f4aa559799ff291d4e692283c4056bac8db1"><div class="ttname"><a href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa559799ff291d4e692283c4056bac8db1">BCVars::Rho_bc_comp</a></div><div class="ttdeci">@ Rho_bc_comp</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:77</div></div>
<div class="ttc" id="anamespaceBCVars_html_a00367571247ba920989360b94c156f4aafb78d904a8ca650972e4228605d79f47"><div class="ttname"><a href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aafb78d904a8ca650972e4228605d79f47">BCVars::RhoQ5_bc_comp</a></div><div class="ttdeci">@ RhoQ5_bc_comp</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:85</div></div>
<div class="ttc" id="anamespaceERFBCType_html_a40fbdd5a379a92debb4bcaaccac6e01ca0b217c3380adcde8f3cd9b58d949db60"><div class="ttname"><a href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca0b217c3380adcde8f3cd9b58d949db60">ERFBCType::neumann</a></div><div class="ttdeci">@ neumann</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:213</div></div>
<div class="ttc" id="anamespaceERFBCType_html_a40fbdd5a379a92debb4bcaaccac6e01ca2b4e1a73027449d9af83a25ed67ae914"><div class="ttname"><a href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca2b4e1a73027449d9af83a25ed67ae914">ERFBCType::open</a></div><div class="ttdeci">@ open</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:215</div></div>
<div class="ttc" id="anamespaceERFBCType_html_a40fbdd5a379a92debb4bcaaccac6e01ca41cecdb4487b15207675ae9ee564e705"><div class="ttname"><a href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca41cecdb4487b15207675ae9ee564e705">ERFBCType::reflect_odd</a></div><div class="ttdeci">@ reflect_odd</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:205</div></div>
<div class="ttc" id="anamespaceERFBCType_html_a40fbdd5a379a92debb4bcaaccac6e01ca42f56b8b6a6f3b72ff598d9df25651c5"><div class="ttname"><a href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca42f56b8b6a6f3b72ff598d9df25651c5">ERFBCType::hoextrap</a></div><div class="ttdeci">@ hoextrap</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:216</div></div>
<div class="ttc" id="anamespaceERFBCType_html_a40fbdd5a379a92debb4bcaaccac6e01ca4a8d85af949a1ce567934e55c69c2846"><div class="ttname"><a href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4a8d85af949a1ce567934e55c69c2846">ERFBCType::foextrap</a></div><div class="ttdeci">@ foextrap</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:208</div></div>
<div class="ttc" id="anamespaceERFBCType_html_a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af"><div class="ttname"><a href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca4b16988b22c277c9f812ddb5fb1539af">ERFBCType::ext_dir</a></div><div class="ttdeci">@ ext_dir</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:209</div></div>
<div class="ttc" id="anamespaceERFBCType_html_a40fbdd5a379a92debb4bcaaccac6e01ca52a76d5c6aeb74655f726be3ae8a1eab"><div class="ttname"><a href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca52a76d5c6aeb74655f726be3ae8a1eab">ERFBCType::ext_dir_prim</a></div><div class="ttdeci">@ ext_dir_prim</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:211</div></div>
<div class="ttc" id="anamespaceERFBCType_html_a40fbdd5a379a92debb4bcaaccac6e01ca87f4264e223d4c9fba88b023509a1c6d"><div class="ttname"><a href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca87f4264e223d4c9fba88b023509a1c6d">ERFBCType::ext_dir_upwind</a></div><div class="ttdeci">@ ext_dir_upwind</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:217</div></div>
<div class="ttc" id="anamespaceERFBCType_html_a40fbdd5a379a92debb4bcaaccac6e01ca9f18284526a1054d4e7a4783852ead30"><div class="ttname"><a href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01ca9f18284526a1054d4e7a4783852ead30">ERFBCType::int_dir</a></div><div class="ttdeci">@ int_dir</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:206</div></div>
<div class="ttc" id="anamespaceERFBCType_html_a40fbdd5a379a92debb4bcaaccac6e01caa8e7f5249fea539bf14e97cfba9074d9"><div class="ttname"><a href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01caa8e7f5249fea539bf14e97cfba9074d9">ERFBCType::neumann_int</a></div><div class="ttdeci">@ neumann_int</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:214</div></div>
<div class="ttc" id="anamespaceERFBCType_html_a40fbdd5a379a92debb4bcaaccac6e01cabc47f82507730e1734a2f3bc58893cf9"><div class="ttname"><a href="namespaceERFBCType.html#a40fbdd5a379a92debb4bcaaccac6e01cabc47f82507730e1734a2f3bc58893cf9">ERFBCType::reflect_even</a></div><div class="ttdeci">@ reflect_even</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:207</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a618e8fdff3239cc79d4145d02b1ecaa2_cgraph.png" border="0" usemap="#aclassERF_a618e8fdff3239cc79d4145d02b1ecaa2_cgraph" alt=""/></div>
<map name="aclassERF_a618e8fdff3239cc79d4145d02b1ecaa2_cgraph" id="aclassERF_a618e8fdff3239cc79d4145d02b1ecaa2_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,109,32"/>
<area shape="rect" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469" title=" " alt="" coords="157,5,196,32"/>
</map>
</div>

</div>
</div>
<a id="a604939a8058f7efa36a427adb889739c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a604939a8058f7efa36a427adb889739c">&#9670;&nbsp;</a></span>init_custom()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::init_custom </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Wrapper for custom problem-specific initialization routines that can be defined by the user as they set up a new problem in <a class="el" href="classERF.html">ERF</a>. This wrapper handles all the overhead of defining the perturbation as well as initializing the random seed if needed.</p>
<p>This wrapper calls a user function to customize initialization on a per-Fab level inside an MFIter loop, so all the MultiFab operations are hidden from the user.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lev</td><td>Integer specifying the current level </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;{</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keyword">auto</span>&amp; lev_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev];</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    MultiFab r_hse(<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev], make_alias, <a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91abc888a343d4fcc4fc4ffb79c6ac7cb93">BaseState::r0_comp</a>, 1);</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    MultiFab p_hse(<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev], make_alias, <a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91aa8253dc5484f2621e0bf8d51d98d635e">BaseState::p0_comp</a>, 1);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    MultiFab cons_pert(lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].boxArray(), lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].DistributionMap(),</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;                       lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nComp()   , lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nGrow());</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    MultiFab xvel_pert(lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].boxArray(), lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].DistributionMap(), 1, lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].nGrowVect());</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    MultiFab yvel_pert(lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].boxArray(), lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].DistributionMap(), 1, lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].nGrowVect());</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    MultiFab zvel_pert(lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].boxArray(), lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].DistributionMap(), 1, lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].nGrowVect());</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="comment">// Default all perturbations to zero</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    cons_pert.setVal(0.);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    xvel_pert.setVal(0.);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    yvel_pert.setVal(0.);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    zvel_pert.setVal(0.);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#pragma omp parallel if (amrex::Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordflow">for</span> (MFIter mfi(lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], <a class="code" href="ERF__TileNoZ_8H.html#a8da113f1d5603f7297fe1d03e5013f00">TileNoZ</a>()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <span class="keyword">const</span> Box &amp;bx  = mfi.tilebox();</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <span class="keyword">const</span> Box &amp;<a class="code" href="ERF__DiffSetup_8H.html#a853a144267414a8a59c87f80ca5c958c">xbx</a> = mfi.tilebox(IntVect(1,0,0));</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <span class="keyword">const</span> Box &amp;<a class="code" href="ERF__DiffSetup_8H.html#ae3d636c41f5271630a5816a4b8b668b2">ybx</a> = mfi.tilebox(IntVect(0,1,0));</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <span class="keyword">const</span> Box &amp;<a class="code" href="ERF__DiffSetup_8H.html#a4c74ed1b76138a2f5baa925afe40f9a8">zbx</a> = mfi.tilebox(IntVect(0,0,1));</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> &amp;cons_pert_arr = cons_pert.array(mfi);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> &amp;xvel_pert_arr = xvel_pert.array(mfi);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> &amp;yvel_pert_arr = yvel_pert.array(mfi);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> &amp;zvel_pert_arr = zvel_pert.array(mfi);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        Array4&lt;Real const&gt; cons_arr = lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].const_array(mfi);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        Array4&lt;Real const&gt; z_nd_arr = (<a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev]) ? <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev]-&gt;const_array(mfi) : Array4&lt;Real const&gt;{};</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        Array4&lt;Real const&gt; z_cc_arr = (<a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[lev]) ? <a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[lev]-&gt;const_array(mfi) : Array4&lt;Real const&gt;{};</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <span class="comment">// Here we arbitrarily choose the x-oriented map factor -- this should be generalized</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        Array4&lt;Real const&gt; mf_m     = <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85bac2a428daaf1a1b398630fa8cec7f115b">MapFacType::m_x</a>]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        Array4&lt;Real const&gt; mf_u     = <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85baa4b935f173fee2d487101e302a5cfe18">MapFacType::u_x</a>]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        Array4&lt;Real const&gt; mf_v     = <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85ba90990e92021688dbfd1cec52b03fd182">MapFacType::v_y</a>]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        Array4&lt;Real&gt; r_hse_arr = r_hse.array(mfi);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        Array4&lt;Real&gt; p_hse_arr = p_hse.array(mfi);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <a class="code" href="classERF.html#a60e8cb933f237903e3fbcd6376c26db0">prob</a>-&gt;init_custom_pert(bx, <a class="code" href="ERF__DiffSetup_8H.html#a853a144267414a8a59c87f80ca5c958c">xbx</a>, <a class="code" href="ERF__DiffSetup_8H.html#ae3d636c41f5271630a5816a4b8b668b2">ybx</a>, <a class="code" href="ERF__DiffSetup_8H.html#a4c74ed1b76138a2f5baa925afe40f9a8">zbx</a>, cons_arr, cons_pert_arr,</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                               xvel_pert_arr, yvel_pert_arr, zvel_pert_arr,</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                               r_hse_arr, p_hse_arr, z_nd_arr, z_cc_arr,</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                               geom[lev].data(), mf_m, mf_u, mf_v,</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                               <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    } <span class="comment">//mfi</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="comment">// Add problem-specific perturbation to background flow if not doing anelastic with fixed-in-time density</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa40fbbbb9a91d853a2d8290dbd728b48">fixed_density</a>) {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        MultiFab::Add(lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], cons_pert, <a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>,      <a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>,             1, cons_pert.nGrow());</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    }</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    MultiFab::Add(lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], cons_pert, <a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>, <a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>,        1, cons_pert.nGrow());</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    MultiFab::Add(lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], cons_pert, <a class="code" href="ERF__IndexDefines_8H.html#a0296f21cd48e5d8236c62ae4ce319b2f">RhoScalar_comp</a>,<a class="code" href="ERF__IndexDefines_8H.html#a0296f21cd48e5d8236c62ae4ce319b2f">RhoScalar_comp</a>,<a class="code" href="ERF__IndexDefines_8H.html#a6773f201eef9644a5d5b7252f6d95ce9">NSCALARS</a>, cons_pert.nGrow());</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">// RhoKE is relevant if using Deardorff with LES, k-equation for RANS, or MYNN with PBL</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa53b017d79e0067923180a0aa59367b4">turbChoice</a>[lev].use_tke) {</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        MultiFab::Add(lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], cons_pert, <a class="code" href="ERF__IndexDefines_8H.html#ae15721db2cb4c2ab4732afe226bbba64">RhoKE_comp</a>,    <a class="code" href="ERF__IndexDefines_8H.html#ae15721db2cb4c2ab4732afe226bbba64">RhoKE_comp</a>,    1, cons_pert.nGrow());</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    }</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> != MoistureType::None) {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keywordtype">int</span> qstate_size = <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;Get_Qstate_Size();</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> q_offset(0); q_offset&lt;qstate_size; ++q_offset) {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            <span class="keywordtype">int</span> q_idx = <a class="code" href="ERF__IndexDefines_8H.html#aa965e9988f14d5d2a5aef4a942168a15">RhoQ1_comp</a>+q_offset;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            MultiFab::Add(lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], cons_pert, q_idx, q_idx, 1, cons_pert.nGrow());</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        }</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    }</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    MultiFab::Add(lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>], xvel_pert, 0,             0,             1, xvel_pert.nGrowVect());</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    MultiFab::Add(lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>], yvel_pert, 0,             0,             1, yvel_pert.nGrowVect());</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    MultiFab::Add(lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>], zvel_pert, 0,             0,             1, zvel_pert.nGrowVect());</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;}</div>
<div class="ttc" id="aERF__DiffSetup_8H_html_a853a144267414a8a59c87f80ca5c958c"><div class="ttname"><a href="ERF__DiffSetup_8H.html#a853a144267414a8a59c87f80ca5c958c">xbx</a></div><div class="ttdeci">const Box xbx</div><div class="ttdef"><b>Definition:</b> ERF_DiffSetup.H:21</div></div>
<div class="ttc" id="astructSolverChoice_html_aa40fbbbb9a91d853a2d8290dbd728b48"><div class="ttname"><a href="structSolverChoice.html#aa40fbbbb9a91d853a2d8290dbd728b48">SolverChoice::fixed_density</a></div><div class="ttdeci">bool fixed_density</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:726</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a604939a8058f7efa36a427adb889739c_cgraph.png" border="0" usemap="#aclassERF_a604939a8058f7efa36a427adb889739c_cgraph" alt=""/></div>
<map name="aclassERF_a604939a8058f7efa36a427adb889739c_cgraph" id="aclassERF_a604939a8058f7efa36a427adb889739c_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,136,32"/>
<area shape="rect" href="ERF__TileNoZ_8H.html#a8da113f1d5603f7297fe1d03e5013f00" title=" " alt="" coords="184,5,257,32"/>
</map>
</div>

</div>
</div>
<a id="a3079a30cce7e1a01d5c9705f393b5a63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3079a30cce7e1a01d5c9705f393b5a63">&#9670;&nbsp;</a></span>init_Dirichlet_bc_data()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::init_Dirichlet_bc_data </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>input_file</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;{</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> use_terrain = (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> != TerrainType::None);</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160; </div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="comment">// Read the dirichlet_input file</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    Print() &lt;&lt; <span class="stringliteral">&quot;dirichlet_input file location : &quot;</span> &lt;&lt; input_file &lt;&lt; std::endl;</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    std::ifstream input_reader(input_file);</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    <span class="keywordflow">if</span> (!input_reader.is_open()) {</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        amrex::Abort(<span class="stringliteral">&quot;Error opening the dirichlet_input file.\n&quot;</span>);</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    }</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160; </div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    Print() &lt;&lt; <span class="stringliteral">&quot;Successfully opened the dirichlet_input file. Now reading... &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    std::string line;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160; </div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <span class="comment">// Size of Ninp (number of z points in input file)</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    Vector&lt;Real&gt; z_inp_tmp, u_inp_tmp, v_inp_tmp, w_inp_tmp, th_inp_tmp;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160; </div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <span class="comment">// Top and bot for domain</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span>  klo  = geom[0].Domain().smallEnd()[2];</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span>  khi  = geom[0].Domain().bigEnd()[2];</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <span class="keyword">const</span> Real zbot = (use_terrain) ? <a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[0][klo]   : geom[0].ProbLo(2);</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <span class="keyword">const</span> Real ztop = (use_terrain) ? <a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[0][khi+1] : geom[0].ProbHi(2);</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160; </div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <span class="comment">// Flag if theta input</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    Real th_init = -300.0;</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="keywordtype">bool</span> th_read{<span class="keyword">false</span>};</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160; </div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    <span class="comment">// Add surface</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    z_inp_tmp.push_back(zbot); <span class="comment">// height above sea level [m]</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    u_inp_tmp.push_back(0.);</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    v_inp_tmp.push_back(0.);</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    w_inp_tmp.push_back(0.);</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    th_inp_tmp.push_back(th_init);</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160; </div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="comment">// Read the vertical profile at each given height</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    Real <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a>, u, v, w, th;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="keywordflow">while</span>(std::getline(input_reader, line)) {</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;        std::istringstream iss_z(line);</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160; </div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;        Vector&lt;Real&gt; rval_v;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        Real rval;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        <span class="keywordflow">while</span> (iss_z &gt;&gt; rval) {</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;            rval_v.push_back(rval);</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        }</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> = rval_v[0];</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        u = rval_v[1];</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        v = rval_v[2];</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        w = rval_v[3];</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160; </div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        <span class="comment">// Format without theta</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        <span class="keywordflow">if</span> (rval_v.size() == 4) {</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> == zbot) {</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                u_inp_tmp[0] = u;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                v_inp_tmp[0] = v;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                w_inp_tmp[0] = w;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                AMREX_ALWAYS_ASSERT(<a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> &gt; z_inp_tmp[z_inp_tmp.size()-1]); <span class="comment">// sounding is increasing in height</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                z_inp_tmp.push_back(<a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a>);</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                u_inp_tmp.push_back(u);</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                v_inp_tmp.push_back(v);</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                w_inp_tmp.push_back(w);</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> &gt;= ztop) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;            }</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rval_v.size() == 5) {</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;            th_read = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;            th = rval_v[4];</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> == zbot) {</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                u_inp_tmp[0]  = u;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                v_inp_tmp[0]  = v;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                w_inp_tmp[0]  = w;</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                th_inp_tmp[0] = th;</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                AMREX_ALWAYS_ASSERT(<a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> &gt; z_inp_tmp[z_inp_tmp.size()-1]); <span class="comment">// sounding is increasing in height</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                z_inp_tmp.push_back(<a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a>);</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                u_inp_tmp.push_back(u);</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                v_inp_tmp.push_back(v);</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                w_inp_tmp.push_back(w);</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                th_inp_tmp.push_back(th);</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> &gt;= ztop) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;            }</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;            Abort(<span class="stringliteral">&quot;Unknown inflow file format!&quot;</span>);</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;        }</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    }</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160; </div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    <span class="comment">// Ensure we set a reasonable theta surface</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    <span class="keywordflow">if</span> (th_read) {</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;        <span class="keywordflow">if</span> (th_inp_tmp[0] == th_init) {</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;            Real slope = (th_inp_tmp[2] - th_inp_tmp[1]) / (z_inp_tmp[2] - z_inp_tmp[1]);</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;            Real dz    = z_inp_tmp[0] - z_inp_tmp[1];</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;            th_inp_tmp[0] = slope * dz + th_inp_tmp[1];</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;        }</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    }</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160; </div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Successfully read and interpolated the dirichlet_input file...&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    input_reader.close();</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160; </div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= max_level; lev++) {</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160; </div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> Nz  = geom[lev].Domain().size()[2];</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;        <span class="keyword">const</span> Real dz = geom[lev].CellSize()[2];</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160; </div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;        <span class="comment">// Size of Nz (domain grid)</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;        Vector&lt;Real&gt; zcc_inp(Nz  );</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        Vector&lt;Real&gt; znd_inp(Nz+1);</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        Vector&lt;Real&gt; u_inp(Nz  ); <a class="code" href="classERF.html#a902f60d94be5eaf86361d1d5ad942105">xvel_bc_data</a>[lev].resize(Nz  ,0.0);</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        Vector&lt;Real&gt; v_inp(Nz  ); <a class="code" href="classERF.html#ae5e40fcd6dd76c80d0b5b09be5baef97">yvel_bc_data</a>[lev].resize(Nz  ,0.0);</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        Vector&lt;Real&gt; w_inp(Nz+1); <a class="code" href="classERF.html#ae08c25dcf643c6ef39f27d7dd0cb7423">zvel_bc_data</a>[lev].resize(Nz+1,0.0);</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        Vector&lt;Real&gt; th_inp;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        <span class="keywordflow">if</span> (th_read) {</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;            th_inp.resize(Nz);</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;            <a class="code" href="classERF.html#a67c86c65b27f8ceee58b5ca989116e14">th_bc_data</a>[lev].resize(Nz, 0.0);</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        }</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160; </div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        <span class="comment">// At this point, we have an input from zbot up to</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;        <span class="comment">// z_inp_tmp[N-1] &gt;= ztop. Now, interpolate to grid level 0 heights</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> Ninp = z_inp_tmp.size();</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k(0); k&lt;Nz; ++k) {</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;            zcc_inp[k] = (use_terrain) ? 0.5 * (<a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[lev][k] + <a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[lev][k+1])</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                                         : zbot + (k + 0.5) * dz;</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;            znd_inp[k] = (use_terrain) ? <a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[lev][k+1] : zbot + (k) * dz;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;            u_inp[k]   = <a class="code" href="ERF__Interpolation__1D_8H.html#a803d0d35d4ca4791556cbe02bbf51cbb">interpolate_1d</a>(z_inp_tmp.dataPtr(), u_inp_tmp.dataPtr(), zcc_inp[k], Ninp);</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;            v_inp[k]   = <a class="code" href="ERF__Interpolation__1D_8H.html#a803d0d35d4ca4791556cbe02bbf51cbb">interpolate_1d</a>(z_inp_tmp.dataPtr(), v_inp_tmp.dataPtr(), zcc_inp[k], Ninp);</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;            w_inp[k]   = <a class="code" href="ERF__Interpolation__1D_8H.html#a803d0d35d4ca4791556cbe02bbf51cbb">interpolate_1d</a>(z_inp_tmp.dataPtr(), w_inp_tmp.dataPtr(), znd_inp[k], Ninp);</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;            <span class="keywordflow">if</span> (th_read) {</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                th_inp[k] = <a class="code" href="ERF__Interpolation__1D_8H.html#a803d0d35d4ca4791556cbe02bbf51cbb">interpolate_1d</a>(z_inp_tmp.dataPtr(), th_inp_tmp.dataPtr(), zcc_inp[k], Ninp);</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;            }</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        }</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        znd_inp[Nz] = ztop;</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        w_inp[Nz]   = <a class="code" href="ERF__Interpolation__1D_8H.html#a803d0d35d4ca4791556cbe02bbf51cbb">interpolate_1d</a>(z_inp_tmp.dataPtr(), w_inp_tmp.dataPtr(), ztop, Ninp);</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160; </div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;        <span class="comment">// Copy host data to the device</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        Gpu::copy(Gpu::hostToDevice, u_inp.begin(), u_inp.end(), <a class="code" href="classERF.html#a902f60d94be5eaf86361d1d5ad942105">xvel_bc_data</a>[lev].begin());</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        Gpu::copy(Gpu::hostToDevice, v_inp.begin(), v_inp.end(), <a class="code" href="classERF.html#ae5e40fcd6dd76c80d0b5b09be5baef97">yvel_bc_data</a>[lev].begin());</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        Gpu::copy(Gpu::hostToDevice, w_inp.begin(), w_inp.end(), <a class="code" href="classERF.html#ae08c25dcf643c6ef39f27d7dd0cb7423">zvel_bc_data</a>[lev].begin());</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        <span class="keywordflow">if</span> (th_read) {</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;           Gpu::copy(Gpu::hostToDevice, th_inp.begin(), th_inp.end(), <a class="code" href="classERF.html#a67c86c65b27f8ceee58b5ca989116e14">th_bc_data</a>[lev].begin());</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;        }</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160; </div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;        <span class="comment">// NOTE: These device vectors are passed to the PhysBC constructors when that</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;        <span class="comment">//       class is instantiated in ERF_MakeNewArrays.cpp.</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    } <span class="comment">// lev</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;}</div>
<div class="ttc" id="aERF__Interpolation__1D_8H_html_a803d0d35d4ca4791556cbe02bbf51cbb"><div class="ttname"><a href="ERF__Interpolation__1D_8H.html#a803d0d35d4ca4791556cbe02bbf51cbb">interpolate_1d</a></div><div class="ttdeci">AMREX_GPU_HOST_DEVICE AMREX_FORCE_INLINE amrex::Real interpolate_1d(const amrex::Real *alpha, const amrex::Real *beta, const amrex::Real alpha_interp, const int alpha_size)</div><div class="ttdef"><b>Definition:</b> ERF_Interpolation_1D.H:12</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a3079a30cce7e1a01d5c9705f393b5a63_cgraph.png" border="0" usemap="#aclassERF_a3079a30cce7e1a01d5c9705f393b5a63_cgraph" alt=""/></div>
<map name="aclassERF_a3079a30cce7e1a01d5c9705f393b5a63_cgraph" id="aclassERF_a3079a30cce7e1a01d5c9705f393b5a63_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,143,47"/>
<area shape="rect" href="ERF__Interpolation__1D_8H.html#a803d0d35d4ca4791556cbe02bbf51cbb" title=" " alt="" coords="191,13,307,39"/>
</map>
</div>

</div>
</div>
<a id="a857a8f76768ec4451b995cbf4f4ac176"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a857a8f76768ec4451b995cbf4f4ac176">&#9670;&nbsp;</a></span>init_from_hse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::init_from_hse </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialize the background flow to have the calculated HSE density and rho*theta calculated from the HSE pressure. In general, the hydrostatically balanced density and pressure (r_hse and p_hse from base_state) used here may be calculated through a solver path such as:</p>
<p>ERF::initHSE(lev)</p><ul>
<li>call prob-&gt;erf_init_dens_hse(...)<ul>
<li>call Problem::init_isentropic_hse(...), to simultaneously calculate r_hse and p_hse with Newton iteration &ndash; assuming constant theta</li>
<li>save r_hse</li>
</ul>
</li>
<li>call ERF::enforce_hse(...), calculates p_hse from saved r_hse (redundant, but needed because p_hse is not necessarily calculated by the Problem implementation) and pi_hse and th_hse &ndash; note: this pressure does not exactly match the p_hse from before because what is calculated by init_isentropic_hse comes from the EOS whereas what is calculated here comes from the hydro- static equation</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lev</td><td>Integer specifying the current level </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;{</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="keyword">auto</span>&amp; lev_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev];</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    MultiFab r_hse(<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev], make_alias, <a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91abc888a343d4fcc4fc4ffb79c6ac7cb93">BaseState::r0_comp</a>, 1);</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    MultiFab p_hse(<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev], make_alias, <a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91aa8253dc5484f2621e0bf8d51d98d635e">BaseState::p0_comp</a>, 1);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#pragma omp parallel if (amrex::Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keywordflow">for</span> (MFIter mfi(lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], <a class="code" href="ERF__TileNoZ_8H.html#a8da113f1d5603f7297fe1d03e5013f00">TileNoZ</a>()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    {</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        <span class="keyword">const</span> Box &amp;gbx = mfi.growntilebox(1);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <span class="keyword">const</span> Array4&lt;Real      &gt;&amp; cons_arr  = lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].array(mfi);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; r_hse_arr = r_hse.const_array(mfi);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; p_hse_arr = p_hse.const_array(mfi);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        ParallelFor(gbx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        {</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;            cons_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>)      = r_hse_arr(i,j,k);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;            cons_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>) = <a class="code" href="ERF__EOS_8H.html#a3cc0ee7727b26e21a97acfc2ad2e6d4d">getRhoThetagivenP</a>(p_hse_arr(i,j,k));</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        });</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    } <span class="comment">//mfi</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a857a8f76768ec4451b995cbf4f4ac176_cgraph.png" border="0" usemap="#aclassERF_a857a8f76768ec4451b995cbf4f4ac176_cgraph" alt=""/></div>
<map name="aclassERF_a857a8f76768ec4451b995cbf4f4ac176_cgraph" id="aclassERF_a857a8f76768ec4451b995cbf4f4ac176_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,148,57"/>
<area shape="rect" href="ERF__EOS_8H.html#a3cc0ee7727b26e21a97acfc2ad2e6d4d" title=" " alt="" coords="196,5,345,32"/>
<area shape="rect" href="ERF__TileNoZ_8H.html#a8da113f1d5603f7297fe1d03e5013f00" title=" " alt="" coords="234,56,307,83"/>
</map>
</div>

</div>
</div>
<a id="a2908bcd920ab5e3fef171a37302853ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2908bcd920ab5e3fef171a37302853ec">&#9670;&nbsp;</a></span>init_from_input_sounding()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::init_from_input_sounding </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>High level wrapper for initializing scalar and velocity level data from input sounding data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lev</td><td>Integer specifying the current level </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;{</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="comment">// We only want to read the file once -- here we fill one FArrayBox (per variable) that spans the domain</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keywordflow">if</span> (lev == 0) {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a83572d8dfad51158945b4a5ab06b2f72">input_sounding_data</a>.<a class="code" href="structInputSoundingData.html#a704d3ca6f9b6a480ad2f8c5e4b4e32f1">input_sounding_file</a>.empty()) {</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            Error(<span class="stringliteral">&quot;input_sounding file name must be provided via input&quot;</span>);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        }</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <a class="code" href="classERF.html#a83572d8dfad51158945b4a5ab06b2f72">input_sounding_data</a>.<a class="code" href="structInputSoundingData.html#a42fe67445aa283176274575444cbf7ef">resize_arrays</a>();</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <span class="comment">// this will interpolate the input profiles to the nominal height levels</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <span class="comment">// (ranging from 0 to the domain top)</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; <a class="code" href="classERF.html#a83572d8dfad51158945b4a5ab06b2f72">input_sounding_data</a>.<a class="code" href="structInputSoundingData.html#a5655f2f77d75c1b8a2abd92a0b264813">n_sounding_files</a>; n++) {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            <a class="code" href="classERF.html#a83572d8dfad51158945b4a5ab06b2f72">input_sounding_data</a>.<a class="code" href="structInputSoundingData.html#a6742e8e0e37fd817097963bbd965692c">read_from_file</a>(geom[lev], <a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[lev], n);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        }</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <span class="comment">// this will calculate the hydrostatically balanced density and pressure</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <span class="comment">// profiles following WRF ideal.exe</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a2eb81c590271b429f132103c9af25830">init_sounding_ideal</a>) <a class="code" href="classERF.html#a83572d8dfad51158945b4a5ab06b2f72">input_sounding_data</a>.<a class="code" href="structInputSoundingData.html#a830608de7ca272770d8ddb659d65eb31">calc_rho_p</a>(0);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <span class="comment">// We need to do this interp from coarse level in order to set the values of</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <span class="comment">// the base state inside the domain but outside of the fine region</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev-1].FillBoundary(geom[lev-1].periodicity());</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <span class="comment">// NOTE: this interpolater assumes that ALL ghost cells of the coarse MultiFab</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <span class="comment">//       have been pre-filled - this includes ghost cells both inside and outside</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <span class="comment">//       the domain</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        InterpFromCoarseLevel(<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev], <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].nGrowVect(),</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                              IntVect(0,0,0), <span class="comment">// do not fill ghost cells outside the domain</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                              <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev-1], 0, 0, <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].nComp(),</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                              geom[lev-1], geom[lev],</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                              refRatio(lev-1), &amp;cell_cons_interp,</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                              <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>, <a class="code" href="namespaceBaseBCVars.html#a5dc17426e44fb9fc3f4606bf2a49c39fa130fa0d9896caf6fa4bd2af4e74a5bf6">BaseBCVars::rho0_bc_comp</a>);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;         <span class="comment">// We need to do this here because the interpolation above may leave corners unfilled</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;         <span class="comment">//    when the corners need to be filled by, for example, reflection of the fine ghost</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;         <span class="comment">//    cell outside the fine region but inide the domain.</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;         (*<a class="code" href="classERF.html#af4e7dc93dae16aa2cc94bbb20b699a6f">physbcs_base</a>[lev])(<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev],0,<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].nComp(),<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].nGrowVect());</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keyword">auto</span>&amp; lev_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev];</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="comment">// update if init_sounding_ideal == true</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    MultiFab r_hse (<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev], make_alias, <a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91abc888a343d4fcc4fc4ffb79c6ac7cb93">BaseState::r0_comp</a>, 1);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    MultiFab p_hse (<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev], make_alias, <a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91aa8253dc5484f2621e0bf8d51d98d635e">BaseState::p0_comp</a>, 1);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    MultiFab pi_hse(<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev], make_alias, <a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91a3d99e10d828f251e465bc2c66062badf">BaseState::pi0_comp</a>, 1);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    MultiFab th_hse(<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev], make_alias, <a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91aaf394bbf6aa8da56fc479f2ed5a2a372">BaseState::th0_comp</a>, 1);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    MultiFab qv_hse(<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev], make_alias, <a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91a246ae4776111c528e79c6ad9f2ca9560">BaseState::qv0_comp</a>, 1);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keyword">const</span> Real l_gravity = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a47a54f2e44955202b5b437e4b1b4a61b">gravity</a>;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keyword">const</span> Real l_rdOcp   = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a2e1ef762ee1dc1bd3d4cbd08125c758a">rdOcp</a>;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> l_moist   = (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> != MoistureType::None);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="preprocessor">#pragma omp parallel if (Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordflow">for</span> (MFIter mfi(lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], TilingIfNotGPU()); mfi.isValid(); ++mfi) {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <span class="keyword">const</span> Box &amp;bx = mfi.tilebox();</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> &amp;cons_arr = lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].array(mfi);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> &amp;xvel_arr = lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].array(mfi);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> &amp;yvel_arr = lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].array(mfi);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> &amp;zvel_arr = lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].array(mfi);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        Array4&lt;Real&gt;  r_hse_arr =  r_hse.array(mfi);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        Array4&lt;Real&gt;  p_hse_arr =  p_hse.array(mfi);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        Array4&lt;Real&gt; pi_hse_arr = pi_hse.array(mfi);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        Array4&lt;Real&gt; th_hse_arr = th_hse.array(mfi);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        Array4&lt;Real&gt; qv_hse_arr = qv_hse.array(mfi);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        Array4&lt;Real const&gt; z_cc_arr = (<a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[lev]) ? <a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[lev]-&gt;const_array(mfi) : Array4&lt;Real const&gt;{};</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        Array4&lt;Real const&gt; z_nd_arr = (<a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev]) ? <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev]-&gt;const_array(mfi) : Array4&lt;Real const&gt;{};</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a2eb81c590271b429f132103c9af25830">init_sounding_ideal</a>)</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            <span class="comment">// HSE will be initialized here, interpolated from values previously</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            <span class="comment">// calculated by calc_rho_p()</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            <a class="code" href="ERF__InitFromInputSounding_8cpp.html#a2fa99eca7f2a1ca02c504e6a3a2026b2">init_bx_scalars_from_input_sounding_hse</a>(</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                bx, cons_arr,</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                r_hse_arr, p_hse_arr, pi_hse_arr, th_hse_arr, qv_hse_arr,</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                geom[lev].data(), z_cc_arr,</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                l_gravity, l_rdOcp, l_moist, <a class="code" href="classERF.html#a83572d8dfad51158945b4a5ab06b2f72">input_sounding_data</a>);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        }</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            <span class="comment">// HSE will be calculated later with call to initHSE</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            <a class="code" href="ERF__InitFromInputSounding_8cpp.html#a3591f1ded54f05cbacb8d1ad6246572e">init_bx_scalars_from_input_sounding</a>(</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                bx, cons_arr,</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                geom[lev].data(), z_cc_arr,</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                l_moist, <a class="code" href="classERF.html#a83572d8dfad51158945b4a5ab06b2f72">input_sounding_data</a>);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <a class="code" href="ERF__InitFromInputSounding_8cpp.html#a3e2549542024fc00744ba8077f71f1fb">init_bx_velocities_from_input_sounding</a>(</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            bx, xvel_arr, yvel_arr, zvel_arr,</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            geom[lev].data(), z_nd_arr,</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            <a class="code" href="classERF.html#a83572d8dfad51158945b4a5ab06b2f72">input_sounding_data</a>);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160; </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    } <span class="comment">//mfi</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;}</div>
<div class="ttc" id="aERF__InitFromInputSounding_8cpp_html_a2fa99eca7f2a1ca02c504e6a3a2026b2"><div class="ttname"><a href="ERF__InitFromInputSounding_8cpp.html#a2fa99eca7f2a1ca02c504e6a3a2026b2">init_bx_scalars_from_input_sounding_hse</a></div><div class="ttdeci">void init_bx_scalars_from_input_sounding_hse(const Box &amp;bx, Array4&lt; Real &gt; const &amp;state, Array4&lt; Real &gt; const &amp;r_hse_arr, Array4&lt; Real &gt; const &amp;p_hse_arr, Array4&lt; Real &gt; const &amp;pi_hse_arr, Array4&lt; Real &gt; const &amp;th_hse_arr, Array4&lt; Real &gt; const &amp;qv_hse_arr, GeometryData const &amp;geomdata, Array4&lt; const Real &gt; const &amp;z_cc_arr, const Real &amp;l_gravity, const Real &amp;l_rdOcp, const bool &amp;l_moist, InputSoundingData const &amp;inputSoundingData)</div><div class="ttdef"><b>Definition:</b> ERF_InitFromInputSounding.cpp:225</div></div>
<div class="ttc" id="aERF__InitFromInputSounding_8cpp_html_a3591f1ded54f05cbacb8d1ad6246572e"><div class="ttname"><a href="ERF__InitFromInputSounding_8cpp.html#a3591f1ded54f05cbacb8d1ad6246572e">init_bx_scalars_from_input_sounding</a></div><div class="ttdeci">void init_bx_scalars_from_input_sounding(const Box &amp;bx, Array4&lt; Real &gt; const &amp;state, GeometryData const &amp;geomdata, Array4&lt; const Real &gt; const &amp;z_cc_arr, const bool &amp;l_moist, InputSoundingData const &amp;inputSoundingData)</div><div class="ttdef"><b>Definition:</b> ERF_InitFromInputSounding.cpp:163</div></div>
<div class="ttc" id="aERF__InitFromInputSounding_8cpp_html_a3e2549542024fc00744ba8077f71f1fb"><div class="ttname"><a href="ERF__InitFromInputSounding_8cpp.html#a3e2549542024fc00744ba8077f71f1fb">init_bx_velocities_from_input_sounding</a></div><div class="ttdeci">void init_bx_velocities_from_input_sounding(const Box &amp;bx, Array4&lt; Real &gt; const &amp;x_vel, Array4&lt; Real &gt; const &amp;y_vel, Array4&lt; Real &gt; const &amp;z_vel, GeometryData const &amp;geomdata, Array4&lt; const Real &gt; const &amp;z_nd_arr, InputSoundingData const &amp;inputSoundingData)</div><div class="ttdef"><b>Definition:</b> ERF_InitFromInputSounding.cpp:330</div></div>
<div class="ttc" id="aclassERF_html_a2eb81c590271b429f132103c9af25830"><div class="ttname"><a href="classERF.html#a2eb81c590271b429f132103c9af25830">ERF::init_sounding_ideal</a></div><div class="ttdeci">static bool init_sounding_ideal</div><div class="ttdef"><b>Definition:</b> ERF.H:1058</div></div>
<div class="ttc" id="aclassERF_html_a83572d8dfad51158945b4a5ab06b2f72"><div class="ttname"><a href="classERF.html#a83572d8dfad51158945b4a5ab06b2f72">ERF::input_sounding_data</a></div><div class="ttdeci">InputSoundingData input_sounding_data</div><div class="ttdef"><b>Definition:</b> ERF.H:657</div></div>
<div class="ttc" id="anamespaceBaseBCVars_html_a5dc17426e44fb9fc3f4606bf2a49c39fa130fa0d9896caf6fa4bd2af4e74a5bf6"><div class="ttname"><a href="namespaceBaseBCVars.html#a5dc17426e44fb9fc3f4606bf2a49c39fa130fa0d9896caf6fa4bd2af4e74a5bf6">BaseBCVars::rho0_bc_comp</a></div><div class="ttdeci">@ rho0_bc_comp</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:98</div></div>
<div class="ttc" id="anamespaceBaseState_html_a6f8dc3597225ea7941dad615e7f22e91a246ae4776111c528e79c6ad9f2ca9560"><div class="ttname"><a href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91a246ae4776111c528e79c6ad9f2ca9560">BaseState::qv0_comp</a></div><div class="ttdeci">@ qv0_comp</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:67</div></div>
<div class="ttc" id="astructInputSoundingData_html_a42fe67445aa283176274575444cbf7ef"><div class="ttname"><a href="structInputSoundingData.html#a42fe67445aa283176274575444cbf7ef">InputSoundingData::resize_arrays</a></div><div class="ttdeci">void resize_arrays()</div><div class="ttdef"><b>Definition:</b> ERF_InputSoundingData.H:60</div></div>
<div class="ttc" id="astructInputSoundingData_html_a5655f2f77d75c1b8a2abd92a0b264813"><div class="ttname"><a href="structInputSoundingData.html#a5655f2f77d75c1b8a2abd92a0b264813">InputSoundingData::n_sounding_files</a></div><div class="ttdeci">int n_sounding_files</div><div class="ttdef"><b>Definition:</b> ERF_InputSoundingData.H:316</div></div>
<div class="ttc" id="astructInputSoundingData_html_a6742e8e0e37fd817097963bbd965692c"><div class="ttname"><a href="structInputSoundingData.html#a6742e8e0e37fd817097963bbd965692c">InputSoundingData::read_from_file</a></div><div class="ttdeci">void read_from_file(const amrex::Geometry &amp;geom, const amrex::Vector&lt; amrex::Real &gt; &amp;zlevels_stag, int itime)</div><div class="ttdef"><b>Definition:</b> ERF_InputSoundingData.H:77</div></div>
<div class="ttc" id="astructInputSoundingData_html_a704d3ca6f9b6a480ad2f8c5e4b4e32f1"><div class="ttname"><a href="structInputSoundingData.html#a704d3ca6f9b6a480ad2f8c5e4b4e32f1">InputSoundingData::input_sounding_file</a></div><div class="ttdeci">amrex::Vector&lt; std::string &gt; input_sounding_file</div><div class="ttdef"><b>Definition:</b> ERF_InputSoundingData.H:314</div></div>
<div class="ttc" id="astructInputSoundingData_html_a830608de7ca272770d8ddb659d65eb31"><div class="ttname"><a href="structInputSoundingData.html#a830608de7ca272770d8ddb659d65eb31">InputSoundingData::calc_rho_p</a></div><div class="ttdeci">void calc_rho_p(int itime)</div><div class="ttdef"><b>Definition:</b> ERF_InputSoundingData.H:176</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a2908bcd920ab5e3fef171a37302853ec_cgraph.png" border="0" usemap="#aclassERF_a2908bcd920ab5e3fef171a37302853ec_cgraph" alt=""/></div>
<map name="aclassERF_a2908bcd920ab5e3fef171a37302853ec_cgraph" id="aclassERF_a2908bcd920ab5e3fef171a37302853ec_cgraph">
<area shape="rect" title=" " alt="" coords="5,71,159,112"/>
<area shape="rect" href="ERF__InitFromInputSounding_8cpp.html#a3591f1ded54f05cbacb8d1ad6246572e" title=" " alt="" coords="211,71,369,112"/>
<area shape="rect" href="ERF__InitFromInputSounding_8cpp.html#a2fa99eca7f2a1ca02c504e6a3a2026b2" title=" " alt="" coords="211,136,369,177"/>
<area shape="rect" href="ERF__InitFromInputSounding_8cpp.html#a3e2549542024fc00744ba8077f71f1fb" title=" " alt="" coords="207,5,373,47"/>
<area shape="rect" href="ERF__Interpolation__1D_8H.html#a803d0d35d4ca4791556cbe02bbf51cbb" title=" " alt="" coords="453,78,569,105"/>
<area shape="rect" href="structInputSoundingData.html#ae67ebe7a35af74165a1d2e7ee31a1bbc" title=" " alt="" coords="421,27,601,54"/>
<area shape="rect" href="ERF__EOS_8H.html#a24b76fd72f051dc593840f006d79fd1a" title=" " alt="" coords="441,129,581,155"/>
<area shape="rect" href="ERF__EOS_8H.html#a08354ab110fb9e873bce9250b4f4b46e" title=" " alt="" coords="456,179,567,206"/>
<area shape="rect" href="ERF__EOS_8H.html#a3cc0ee7727b26e21a97acfc2ad2e6d4d" title=" " alt="" coords="437,230,586,257"/>
</map>
</div>

</div>
</div>
<a id="aab564dd3009ef83466b50db6d997b563"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab564dd3009ef83466b50db6d997b563">&#9670;&nbsp;</a></span>init_geo_wind_profile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::init_geo_wind_profile </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>input_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Vector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>u_geos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::DeviceVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>u_geos_d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Vector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>v_geos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Gpu::DeviceVector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>v_geos_d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Geometry &amp;&#160;</td>
          <td class="paramname"><em>lgeom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Vector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>zlev_stag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;{</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> klo = 0;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> khi = lgeom.Domain().bigEnd()[AMREX_SPACEDIM-1];</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <span class="keyword">const</span> amrex::Real dz = lgeom.CellSize()[AMREX_SPACEDIM-1];</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> grid_stretch = (zlev_stag.size() &gt; 0);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="keyword">const</span> Real zbot = (grid_stretch) ? zlev_stag[klo]   : lgeom.ProbLo(AMREX_SPACEDIM-1);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="keyword">const</span> Real ztop = (grid_stretch) ? zlev_stag[khi+1] : lgeom.ProbHi(AMREX_SPACEDIM-1);</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Reading geostrophic wind profile from &quot;</span> &lt;&lt; input_file &lt;&lt; std::endl;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    std::ifstream profile_reader(input_file);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keywordflow">if</span>(!profile_reader.is_open()) {</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        amrex::Error(<span class="stringliteral">&quot;Error opening the abl_geo_wind_table\n&quot;</span>);</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    }</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="comment">// First, read the input data into temp vectors</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    std::string line;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    Vector&lt;Real&gt; z_inp, Ug_inp, Vg_inp;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    Real <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a>, Ug, Vg;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    amrex::Print() &lt;&lt; <span class="stringliteral">&quot;z  Ug  Vg&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keywordflow">while</span>(std::getline(profile_reader, line)) {</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        std::istringstream iss(line);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        iss &gt;&gt; <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> &gt;&gt; Ug &gt;&gt; Vg;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        amrex::Print() &lt;&lt; <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; Ug &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; Vg &lt;&lt; std::endl;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        z_inp.push_back(<a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a>);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        Ug_inp.push_back(Ug);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        Vg_inp.push_back(Vg);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> &gt;= ztop) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    }</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> Ninp = z_inp.size();</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    AMREX_ALWAYS_ASSERT(z_inp[0] &lt;= zbot);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    AMREX_ALWAYS_ASSERT(z_inp[Ninp-1] &gt;= ztop);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="comment">// Now, interpolate vectors to the cell centers</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt;= khi; k++) {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> = (grid_stretch) ? 0.5 * (zlev_stag[k] + zlev_stag[k+1])</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                           : zbot + (k + 0.5) * dz;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        u_geos[k] = <a class="code" href="ERF__Interpolation__1D_8H.html#a803d0d35d4ca4791556cbe02bbf51cbb">interpolate_1d</a>(z_inp.dataPtr(), Ug_inp.dataPtr(), <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a>, Ninp);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        v_geos[k] = <a class="code" href="ERF__Interpolation__1D_8H.html#a803d0d35d4ca4791556cbe02bbf51cbb">interpolate_1d</a>(z_inp.dataPtr(), Vg_inp.dataPtr(), <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a>, Ninp);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    }</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="comment">// Copy from host version to device version</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    Gpu::copy(Gpu::hostToDevice, u_geos.begin(), u_geos.end(), u_geos_d.begin());</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    Gpu::copy(Gpu::hostToDevice, v_geos.begin(), v_geos.end(), v_geos_d.begin());</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    profile_reader.close();</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_aab564dd3009ef83466b50db6d997b563_cgraph.png" border="0" usemap="#aclassERF_aab564dd3009ef83466b50db6d997b563_cgraph" alt=""/></div>
<map name="aclassERF_aab564dd3009ef83466b50db6d997b563_cgraph" id="aclassERF_aab564dd3009ef83466b50db6d997b563_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,149,47"/>
<area shape="rect" href="ERF__Interpolation__1D_8H.html#a803d0d35d4ca4791556cbe02bbf51cbb" title=" " alt="" coords="197,13,313,39"/>
</map>
</div>

</div>
</div>
<a id="a80981e20939a6a38ba17478da2253ff1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80981e20939a6a38ba17478da2253ff1">&#9670;&nbsp;</a></span>init_only()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::init_only </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;{</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;    <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev] = time;</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;    <a class="code" href="classERF.html#a7085d7d5fc94a0f84efc06957267d58e">t_old</a>[lev] = time - 1.e200;</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160; </div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;    <span class="keyword">auto</span>&amp; lev_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev];</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;    <span class="keyword">auto</span>&amp; lev_old = <a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev];</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160; </div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;    <span class="comment">// Loop over grids at this level to initialize our grid data</span></div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;    lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].setVal(0.0); lev_old[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].setVal(0.0);</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;    lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].setVal(0.0); lev_old[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].setVal(0.0);</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;    lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].setVal(0.0); lev_old[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].setVal(0.0);</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;    lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].setVal(0.0); lev_old[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].setVal(0.0);</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160; </div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;    <span class="comment">// Initialize background flow (optional)</span></div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac1ddc9c301ac98689bf3b7b7184b24e1">init_type</a> == InitType::Input_Sounding) {</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;        <span class="comment">// The base state is initialized by integrating vertically through the</span></div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;        <span class="comment">// input sounding, if the init_sounding_ideal flag is set; otherwise</span></div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;        <span class="comment">// it is set by initHSE()</span></div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160; </div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;        <span class="comment">// The physbc&#39;s need the terrain but are needed for initHSE</span></div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;        <span class="comment">// We have already made the terrain in the call to init_zphys</span></div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;        <span class="comment">//    in MakeNewLevelFromScratch</span></div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;        <a class="code" href="classERF.html#ac81ec7f74a1be1c4a1e6e15e08385ed5">make_physbcs</a>(lev);</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160; </div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;        <span class="comment">// Now init the base state and the data itself</span></div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;        <a class="code" href="classERF.html#a2908bcd920ab5e3fef171a37302853ec">init_from_input_sounding</a>(lev);</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160; </div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a2eb81c590271b429f132103c9af25830">init_sounding_ideal</a>) {</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;            AMREX_ALWAYS_ASSERT_WITH_MESSAGE(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a3ab48411073a3c1f75435292d7b407e5">use_gravity</a>,</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;                <span class="stringliteral">&quot;Gravity should be on to be consistent with sounding initialization.&quot;</span>);</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;            <a class="code" href="classERF.html#a92c020bfaa43e40fb5ffc449427a0318">initHSE</a>();</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;        }</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160; </div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;<span class="preprocessor">#ifdef ERF_USE_NETCDF</span></div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;    }</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac1ddc9c301ac98689bf3b7b7184b24e1">init_type</a> == InitType::WRFInput)</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;    {</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;        <span class="comment">// The base state is initialized from WRF wrfinput data, output by</span></div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;        <span class="comment">// ideal.exe or real.exe</span></div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;        init_from_wrfinput(lev, *<a class="code" href="classERF.html#a8839af37a73c4c2e76bf978a05275ca9">mf_C1H</a>[lev], *<a class="code" href="classERF.html#ad473e8e616ea3f7bf7bf922a0fe16208">mf_C2H</a>[lev], *<a class="code" href="classERF.html#aed4ae5792dd32adf56d3c052ce79437f">mf_MUB</a>[lev]);</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;        <span class="keywordflow">if</span> (lev==0) {</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;            <span class="keywordflow">if</span> ((<a class="code" href="classERF.html#aa0c07f31b23d977646b8161e5473fab5">start_time</a> &gt; 0) &amp;&amp; (<a class="code" href="classERF.html#aa0c07f31b23d977646b8161e5473fab5">start_time</a> != <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev])) {</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;                Print() &lt;&lt; <span class="stringliteral">&quot;Ignoring specified start_time=&quot;</span></div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;                        &lt;&lt; std::setprecision(<a class="code" href="classERF.html#a2307b817178b00e5cc38c0e163da0a39">timeprecision</a>) &lt;&lt; <a class="code" href="classERF.html#aa0c07f31b23d977646b8161e5473fab5">start_time</a></div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;                        &lt;&lt; std::endl;</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;            }</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;            <a class="code" href="classERF.html#aa0c07f31b23d977646b8161e5473fab5">start_time</a> = <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev];</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;        }</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;        <a class="code" href="classERF.html#a90e3592862d7330b39a11399d34a3539">use_datetime</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160; </div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;        <span class="comment">// The physbc&#39;s need the terrain but are needed for initHSE</span></div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ad57b63939b19e90b87dd61d3f293b0d7">use_real_bcs</a>) {</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;            <a class="code" href="classERF.html#ac81ec7f74a1be1c4a1e6e15e08385ed5">make_physbcs</a>(lev);</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;        }</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;    }</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac1ddc9c301ac98689bf3b7b7184b24e1">init_type</a> == InitType::NCFile)</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;    {</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;        <span class="comment">// The state is initialized by reading from a Netcdf file</span></div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;        init_from_ncfile(lev);</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160; </div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;        <span class="comment">// The physbc&#39;s need the terrain but are needed for initHSE</span></div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;        <a class="code" href="classERF.html#ac81ec7f74a1be1c4a1e6e15e08385ed5">make_physbcs</a>(lev);</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;    }</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac1ddc9c301ac98689bf3b7b7184b24e1">init_type</a> == InitType::Metgrid)</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;    {</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;        <span class="comment">// The base state is initialized from data output by WPS metgrid;</span></div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;        <span class="comment">// we will rebalance after interpolation</span></div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;        init_from_metgrid(lev);</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac1ddc9c301ac98689bf3b7b7184b24e1">init_type</a> == InitType::Uniform) {</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;        <span class="comment">// Initialize a uniform background field and base state based on the</span></div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;        <span class="comment">// problem-specified reference density and temperature</span></div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160; </div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;        <span class="comment">// The physbc&#39;s need the terrain but are needed for initHSE</span></div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;        <a class="code" href="classERF.html#ac81ec7f74a1be1c4a1e6e15e08385ed5">make_physbcs</a>(lev);</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160; </div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;        <a class="code" href="classERF.html#ae618963cf90e247b72fbd71d5b13599d">init_uniform</a>(lev);</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;        <a class="code" href="classERF.html#a92c020bfaa43e40fb5ffc449427a0318">initHSE</a>(lev);</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;        <span class="comment">// No background flow initialization specified, initialize the</span></div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;        <span class="comment">// background field to be equal to the base state, calculated from the</span></div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;        <span class="comment">// problem-specific erf_init_dens_hse</span></div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160; </div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;        <span class="comment">// The bc&#39;s need the terrain but are needed for initHSE</span></div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;        <a class="code" href="classERF.html#ac81ec7f74a1be1c4a1e6e15e08385ed5">make_physbcs</a>(lev);</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160; </div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;        <span class="comment">// We will initialize the state from the background state so must set that first</span></div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;        <a class="code" href="classERF.html#a92c020bfaa43e40fb5ffc449427a0318">initHSE</a>(lev);</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;        <a class="code" href="classERF.html#a857a8f76768ec4451b995cbf4f4ac176">init_from_hse</a>(lev);</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;    }</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160; </div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;    <span class="comment">// Add problem-specific flow features</span></div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;    <span class="comment">// Notes:</span></div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;    <span class="comment">// - This calls init_custom_pert that is defined for each problem</span></div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;    <span class="comment">// - This may modify the base state</span></div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;    <span class="comment">// - The fields set by init_custom_pert are **perturbations** to the</span></div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;    <span class="comment">//   background flow set based on init_type</span></div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac1ddc9c301ac98689bf3b7b7184b24e1">init_type</a> != InitType::NCFile) {</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;        <a class="code" href="classERF.html#a604939a8058f7efa36a427adb889739c">init_custom</a>(lev);</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;    }</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160; </div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    <span class="comment">// Ensure that the face-based data are the same on both sides of a periodic domain.</span></div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    <span class="comment">// The data associated with the lower grid ID is considered the correct value.</span></div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;    lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].OverrideSync(geom[lev].periodicity());</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;    lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].OverrideSync(geom[lev].periodicity());</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;    lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].OverrideSync(geom[lev].periodicity());</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160; </div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac066852f06a6409e1638f59868b7c57d">spongeChoice</a>.<a class="code" href="structSpongeChoice.html#a1a41f754595d713df32583f0b0fa606e">sponge_type</a> == <span class="stringliteral">&quot;input_sponge&quot;</span>){</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;        <a class="code" href="classERF.html#abfdc95a7c3cf7e413c1352bac38c93e8">input_sponge</a>(lev);</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;   }</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160; </div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;    <span class="comment">// Initialize turbulent perturbation</span></div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#abfd94767b3721755632c45a5ef290544">pert_type</a> == PerturbationType::Source ||</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;        <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#abfd94767b3721755632c45a5ef290544">pert_type</a> == PerturbationType::Direct ||</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;        <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#abfd94767b3721755632c45a5ef290544">pert_type</a> == PerturbationType::CPM) {</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;        <a class="code" href="classERF.html#aa89efe0abf37918ce3f212fb0e26f1bc">turbPert_update</a>(lev, 0.);</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;        <a class="code" href="classERF.html#afb76c0633e2ba944c543e7a03a5e9424">turbPert_amplitude</a>(lev);</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;    }</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_a2307b817178b00e5cc38c0e163da0a39"><div class="ttname"><a href="classERF.html#a2307b817178b00e5cc38c0e163da0a39">ERF::timeprecision</a></div><div class="ttdeci">const int timeprecision</div><div class="ttdef"><b>Definition:</b> ERF.H:887</div></div>
<div class="ttc" id="aclassERF_html_a2908bcd920ab5e3fef171a37302853ec"><div class="ttname"><a href="classERF.html#a2908bcd920ab5e3fef171a37302853ec">ERF::init_from_input_sounding</a></div><div class="ttdeci">void init_from_input_sounding(int lev)</div><div class="ttdef"><b>Definition:</b> ERF_InitFromInputSounding.cpp:51</div></div>
<div class="ttc" id="aclassERF_html_a604939a8058f7efa36a427adb889739c"><div class="ttname"><a href="classERF.html#a604939a8058f7efa36a427adb889739c">ERF::init_custom</a></div><div class="ttdeci">void init_custom(int lev)</div><div class="ttdef"><b>Definition:</b> ERF_InitCustom.cpp:26</div></div>
<div class="ttc" id="aclassERF_html_a857a8f76768ec4451b995cbf4f4ac176"><div class="ttname"><a href="classERF.html#a857a8f76768ec4451b995cbf4f4ac176">ERF::init_from_hse</a></div><div class="ttdeci">void init_from_hse(int lev)</div><div class="ttdef"><b>Definition:</b> ERF_InitFromHSE.cpp:32</div></div>
<div class="ttc" id="aclassERF_html_a92c020bfaa43e40fb5ffc449427a0318"><div class="ttname"><a href="classERF.html#a92c020bfaa43e40fb5ffc449427a0318">ERF::initHSE</a></div><div class="ttdeci">void initHSE()</div><div class="ttdoc">Initialize HSE.</div><div class="ttdef"><b>Definition:</b> ERF_Init1D.cpp:142</div></div>
<div class="ttc" id="aclassERF_html_aa89efe0abf37918ce3f212fb0e26f1bc"><div class="ttname"><a href="classERF.html#aa89efe0abf37918ce3f212fb0e26f1bc">ERF::turbPert_update</a></div><div class="ttdeci">void turbPert_update(const int lev, const amrex::Real dt)</div><div class="ttdef"><b>Definition:</b> ERF_InitTurbPert.cpp:12</div></div>
<div class="ttc" id="aclassERF_html_abfdc95a7c3cf7e413c1352bac38c93e8"><div class="ttname"><a href="classERF.html#abfdc95a7c3cf7e413c1352bac38c93e8">ERF::input_sponge</a></div><div class="ttdeci">void input_sponge(int lev)</div><div class="ttdef"><b>Definition:</b> ERF_InitSponge.cpp:17</div></div>
<div class="ttc" id="aclassERF_html_ac81ec7f74a1be1c4a1e6e15e08385ed5"><div class="ttname"><a href="classERF.html#ac81ec7f74a1be1c4a1e6e15e08385ed5">ERF::make_physbcs</a></div><div class="ttdeci">void make_physbcs(int lev)</div><div class="ttdef"><b>Definition:</b> ERF_MakeNewArrays.cpp:652</div></div>
<div class="ttc" id="aclassERF_html_ae618963cf90e247b72fbd71d5b13599d"><div class="ttname"><a href="classERF.html#ae618963cf90e247b72fbd71d5b13599d">ERF::init_uniform</a></div><div class="ttdeci">void init_uniform(int lev)</div><div class="ttdef"><b>Definition:</b> ERF_InitUniform.cpp:17</div></div>
<div class="ttc" id="aclassERF_html_afb76c0633e2ba944c543e7a03a5e9424"><div class="ttname"><a href="classERF.html#afb76c0633e2ba944c543e7a03a5e9424">ERF::turbPert_amplitude</a></div><div class="ttdeci">void turbPert_amplitude(const int lev)</div><div class="ttdef"><b>Definition:</b> ERF_InitTurbPert.cpp:32</div></div>
<div class="ttc" id="astructSolverChoice_html_a3ab48411073a3c1f75435292d7b407e5"><div class="ttname"><a href="structSolverChoice.html#a3ab48411073a3c1f75435292d7b407e5">SolverChoice::use_gravity</a></div><div class="ttdeci">bool use_gravity</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:736</div></div>
<div class="ttc" id="astructSolverChoice_html_ac1ddc9c301ac98689bf3b7b7184b24e1"><div class="ttname"><a href="structSolverChoice.html#ac1ddc9c301ac98689bf3b7b7184b24e1">SolverChoice::init_type</a></div><div class="ttdeci">static InitType init_type</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:699</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aaf237fbe118d80f149295c0579608579"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf237fbe118d80f149295c0579608579">&#9670;&nbsp;</a></span>init_stuff()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::init_stuff </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::BoxArray &amp;&#160;</td>
          <td class="paramname"><em>ba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::DistributionMapping &amp;&#160;</td>
          <td class="paramname"><em>dm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Vector&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>lev_new</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Vector&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>lev_old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>tmp_base_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>tmp_zphys_nd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;{</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="comment">// Base state holds r_0, pres_0, pi_0, th_0 (in that order)</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="comment">// Here is where we set 3 ghost cells for the base state!</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    tmp_base_state.define(ba,dm,<a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91a088c1232c30770df1105d3cdf66ee582">BaseState::num_comps</a>,3);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    tmp_base_state.setVal(0.);</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> == TerrainType::MovingFittedMesh) {</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        <a class="code" href="classERF.html#a37b2a4257df8ff53d4450de47f16ace1">base_state_new</a>[lev].define(ba,dm,<a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91a088c1232c30770df1105d3cdf66ee582">BaseState::num_comps</a>,<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].nGrowVect());</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        <a class="code" href="classERF.html#a37b2a4257df8ff53d4450de47f16ace1">base_state_new</a>[lev].setVal(0.);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    }</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="comment">// Allocate terrain arrays</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    BoxArray ba_nd(ba);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    ba_nd.surroundingNodes();</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="comment">// NOTE: this is where we actually allocate z_phys_nd -- but here it&#39;s called &quot;tmp_zphys_nd&quot;</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="comment">// We need this to be one greater than the ghost cells to handle levels &gt; 0</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordtype">int</span> ngrow = <a class="code" href="classERF.html#aaad87d9eb7e20af21deb83d72f94801c">ComputeGhostCells</a>(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>) + 2;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    tmp_zphys_nd = std::make_unique&lt;MultiFab&gt;(ba_nd,dm,1,IntVect(ngrow,ngrow,ngrow));</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[lev] = std::make_unique&lt;MultiFab&gt;(ba,dm,1,1);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <a class="code" href="ERF__TerrainMetrics_8cpp.html#a28a6372799b0be6e2745cae9cb180567">init_default_zphys</a>(lev, geom[lev], *tmp_zphys_nd, *<a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[lev]);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> == TerrainType::MovingFittedMesh)</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    {</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <a class="code" href="classERF.html#ae39bf64c5306b1dd939d82d9df728daa">detJ_cc_new</a>[lev] = std::make_unique&lt;MultiFab&gt;(ba,dm,1,1);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <a class="code" href="classERF.html#a9a411e0ea9d9bdbfab957c8081229091">detJ_cc_src</a>[lev] = std::make_unique&lt;MultiFab&gt;(ba,dm,1,1);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <a class="code" href="classERF.html#abe77a4434d27561109ffc666546511dc">ax_src</a>[lev] = std::make_unique&lt;MultiFab&gt;(convert(ba,IntVect(1,0,0)),dm,1,1);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <a class="code" href="classERF.html#aa20bd15dbe2c801bda2d3bfdb5b81eab">ay_src</a>[lev] = std::make_unique&lt;MultiFab&gt;(convert(ba,IntVect(0,1,0)),dm,1,1);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <a class="code" href="classERF.html#ad2d8e37fbdac323eda857e0b8c151852">az_src</a>[lev] = std::make_unique&lt;MultiFab&gt;(convert(ba,IntVect(0,0,1)),dm,1,1);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <a class="code" href="classERF.html#a72a59614c6d5ab840b924c84d5682270">z_t_rk</a>[lev] = std::make_unique&lt;MultiFab&gt;( convert(ba, IntVect(0,0,1)), dm, 1, 1 );</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <a class="code" href="classERF.html#a4ef635c22e72c715f5703a6b95a7abe5">z_phys_nd_new</a>[lev] = std::make_unique&lt;MultiFab&gt;(ba_nd,dm,1,IntVect(ngrow,ngrow,ngrow));</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <a class="code" href="classERF.html#a30dcf40e8f104fb6b6132805d2eff47c">z_phys_nd_src</a>[lev] = std::make_unique&lt;MultiFab&gt;(ba_nd,dm,1,IntVect(ngrow,ngrow,ngrow));</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <a class="code" href="classERF.html#abfa333375bd02a72cc80ba1e7552aba5">z_phys_cc_src</a>[lev] = std::make_unique&lt;MultiFab&gt;(ba,dm,1,1);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    }</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <a class="code" href="classERF.html#a4ef635c22e72c715f5703a6b95a7abe5">z_phys_nd_new</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;          <a class="code" href="classERF.html#ae39bf64c5306b1dd939d82d9df728daa">detJ_cc_new</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <a class="code" href="classERF.html#a30dcf40e8f104fb6b6132805d2eff47c">z_phys_nd_src</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <a class="code" href="classERF.html#abfa333375bd02a72cc80ba1e7552aba5">z_phys_cc_src</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;          <a class="code" href="classERF.html#a9a411e0ea9d9bdbfab957c8081229091">detJ_cc_src</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;               <a class="code" href="classERF.html#a72a59614c6d5ab840b924c84d5682270">z_t_rk</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    }</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">SolverChoice::terrain_type</a> == TerrainType::ImmersedForcing)</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    {</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <a class="code" href="classERF.html#a4a18cc3befd0911ccb011f9bb3b2efc2">terrain_blanking</a>[lev] = std::make_unique&lt;MultiFab&gt;(ba,dm,1,ngrow);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <a class="code" href="classERF.html#a4a18cc3befd0911ccb011f9bb3b2efc2">terrain_blanking</a>[lev]-&gt;setVal(1.0);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    }</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="comment">// We use these area arrays regardless of terrain, EB or none of the above</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <a class="code" href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">detJ_cc</a>[lev] = std::make_unique&lt;MultiFab&gt;(ba,dm,1,1);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;         <a class="code" href="classERF.html#a93bc9185c89cbeaceffaf40b8cf4a75c">ax</a>[lev] = std::make_unique&lt;MultiFab&gt;(convert(ba,IntVect(1,0,0)),dm,1,1);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;         <a class="code" href="classERF.html#ade870f983d113c64406bdcb8a9194044">ay</a>[lev] = std::make_unique&lt;MultiFab&gt;(convert(ba,IntVect(0,1,0)),dm,1,1);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;         <a class="code" href="classERF.html#a391914523e66645f7e947cefcd19c011">az</a>[lev] = std::make_unique&lt;MultiFab&gt;(convert(ba,IntVect(0,0,1)),dm,1,1);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <a class="code" href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">detJ_cc</a>[lev]-&gt;setVal(1.0);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;         <a class="code" href="classERF.html#a93bc9185c89cbeaceffaf40b8cf4a75c">ax</a>[lev]-&gt;setVal(1.0);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;         <a class="code" href="classERF.html#ade870f983d113c64406bdcb8a9194044">ay</a>[lev]-&gt;setVal(1.0);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;         <a class="code" href="classERF.html#a391914523e66645f7e947cefcd19c011">az</a>[lev]-&gt;setVal(1.0);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="comment">// Create wall distance array for RANS modeling</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa53b017d79e0067923180a0aa59367b4">turbChoice</a>[lev].rans_type != RANSType::None) {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <a class="code" href="classERF.html#a0276b556fdefec8b99be95846a3a35fe">walldist</a>[lev] = std::make_unique&lt;MultiFab&gt;(ba,dm,1,1);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <a class="code" href="classERF.html#a0276b556fdefec8b99be95846a3a35fe">walldist</a>[lev]-&gt;setVal(1e23);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <a class="code" href="classERF.html#a0276b556fdefec8b99be95846a3a35fe">walldist</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    }</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="comment">// These are the persistent containers for the old and new data</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordtype">int</span> ncomp;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keywordflow">if</span> (lev &gt; 0) {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        ncomp = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev-1][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nComp();</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="keywordtype">int</span> n_qstate   = <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;Get_Qstate_Size();</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        ncomp = <a class="code" href="ERF__IndexDefines_8H.html#a38d6fda9ca3d40309838c64d398b54c1">NDRY</a> + <a class="code" href="ERF__IndexDefines_8H.html#a6773f201eef9644a5d5b7252f6d95ce9">NSCALARS</a> + n_qstate;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="comment">// The number of ghost cells for density must be 1 greater than that for velocity</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="comment">//     so that we can go back in forth between velocity and momentum on all faces</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keywordtype">int</span> ngrow_state = <a class="code" href="classERF.html#aaad87d9eb7e20af21deb83d72f94801c">ComputeGhostCells</a>(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>) + 1;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordtype">int</span> ngrow_vels  = <a class="code" href="classERF.html#aaad87d9eb7e20af21deb83d72f94801c">ComputeGhostCells</a>(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="comment">// New solution data containers</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].define(ba, dm, ncomp, ngrow_state);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    lev_old[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].define(ba, dm, ncomp, ngrow_state);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].define(convert(ba, IntVect(1,0,0)), dm, 1, ngrow_vels);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    lev_old[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].define(convert(ba, IntVect(1,0,0)), dm, 1, ngrow_vels);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].define(convert(ba, IntVect(0,1,0)), dm, 1, ngrow_vels);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    lev_old[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].define(convert(ba, IntVect(0,1,0)), dm, 1, ngrow_vels);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <a class="code" href="classERF.html#a29ce17220e488eb840abc53966c34d46">gradp</a>[lev][<a class="code" href="namespaceGpVars.html#ac972418cf9113d552b162715dae54ebdaecfb8189072456062c3c29c137ec2323">GpVars::gpx</a>].define(convert(ba, IntVect(1,0,0)), dm, 1, 1); <a class="code" href="classERF.html#a29ce17220e488eb840abc53966c34d46">gradp</a>[lev][<a class="code" href="namespaceGpVars.html#ac972418cf9113d552b162715dae54ebdaecfb8189072456062c3c29c137ec2323">GpVars::gpx</a>].setVal(0.);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <a class="code" href="classERF.html#a29ce17220e488eb840abc53966c34d46">gradp</a>[lev][<a class="code" href="namespaceGpVars.html#ac972418cf9113d552b162715dae54ebda8b32fb9218fd4f10ccc5736e6a61a72d">GpVars::gpy</a>].define(convert(ba, IntVect(0,1,0)), dm, 1, 1); <a class="code" href="classERF.html#a29ce17220e488eb840abc53966c34d46">gradp</a>[lev][<a class="code" href="namespaceGpVars.html#ac972418cf9113d552b162715dae54ebda8b32fb9218fd4f10ccc5736e6a61a72d">GpVars::gpy</a>].setVal(0.);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <a class="code" href="classERF.html#a29ce17220e488eb840abc53966c34d46">gradp</a>[lev][<a class="code" href="namespaceGpVars.html#ac972418cf9113d552b162715dae54ebda7490c53ed57352abcd4a219cd12bf517">GpVars::gpz</a>].define(convert(ba, IntVect(0,0,1)), dm, 1, 1); <a class="code" href="classERF.html#a29ce17220e488eb840abc53966c34d46">gradp</a>[lev][<a class="code" href="namespaceGpVars.html#ac972418cf9113d552b162715dae54ebda7490c53ed57352abcd4a219cd12bf517">GpVars::gpz</a>].setVal(0.);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="comment">// Note that we need the ghost cells in the z-direction if we are doing any</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="comment">// kind of domain decomposition in the vertical (at level 0 or above)</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].define(convert(ba, IntVect(0,0,1)), dm, 1, ngrow_vels);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    lev_old[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].define(convert(ba, IntVect(0,0,1)), dm, 1, ngrow_vels);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa7be0d60ce3de3441d44082cc1b725ec">anelastic</a>[lev] == 1 || <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa7bb7f3c8b475b0e446c271d8aa5497f">project_initial_velocity</a>) {</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <a class="code" href="classERF.html#a0c5206542d4193bb687f5271be6fe5e5">pp_inc</a>[lev].define(ba, dm, 1, 1);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <a class="code" href="classERF.html#a0c5206542d4193bb687f5271be6fe5e5">pp_inc</a>[lev].setVal(0.0);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    }</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="comment">// These are just used for scratch in the time integrator but we might as well define them here</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <a class="code" href="classERF.html#a6eecc44323f77917c95869928284f61d">rU_old</a>[lev].define(convert(ba, IntVect(1,0,0)), dm, 1, ngrow_vels);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <a class="code" href="classERF.html#a01f3db32272f53dc68025f0a98195e57">rU_new</a>[lev].define(convert(ba, IntVect(1,0,0)), dm, 1, ngrow_vels);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <a class="code" href="classERF.html#aeb64e3b4def989ce68d873aefeed5e0e">rV_old</a>[lev].define(convert(ba, IntVect(0,1,0)), dm, 1, ngrow_vels);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <a class="code" href="classERF.html#a54e37988486ef96e55e84bd8e91bb688">rV_new</a>[lev].define(convert(ba, IntVect(0,1,0)), dm, 1, ngrow_vels);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <a class="code" href="classERF.html#ac1fa56ec90f44e3cdf487af46804163f">rW_old</a>[lev].define(convert(ba, IntVect(0,0,1)), dm, 1, ngrow_vels);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <a class="code" href="classERF.html#aa46c0b0d20525aed10f447923e54dde7">rW_new</a>[lev].define(convert(ba, IntVect(0,0,1)), dm, 1, ngrow_vels);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordflow">if</span> (lev &gt; 0) {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <span class="comment">//xmom_crse_rhs[lev].define(convert(ba, IntVect(1,0,0)), dm, 1, IntVect{0});</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <span class="comment">//ymom_crse_rhs[lev].define(convert(ba, IntVect(0,1,0)), dm, 1, IntVect{0});</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <a class="code" href="classERF.html#aaf7e8e28172eebdfe2224e4ee823310d">zmom_crse_rhs</a>[lev].define(convert(ba, IntVect(0,0,1)), dm, 1, IntVect{0});</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    }</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="comment">// We do this here just so they won&#39;t be undefined in the initial FillPatch</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <a class="code" href="classERF.html#a6eecc44323f77917c95869928284f61d">rU_old</a>[lev].setVal(1.2e21);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <a class="code" href="classERF.html#aeb64e3b4def989ce68d873aefeed5e0e">rV_old</a>[lev].setVal(3.4e22);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <a class="code" href="classERF.html#ac1fa56ec90f44e3cdf487af46804163f">rW_old</a>[lev].setVal(5.6e23);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <a class="code" href="classERF.html#a01f3db32272f53dc68025f0a98195e57">rU_new</a>[lev].setVal(1.2e21);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <a class="code" href="classERF.html#a54e37988486ef96e55e84bd8e91bb688">rV_new</a>[lev].setVal(3.4e22);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <a class="code" href="classERF.html#aa46c0b0d20525aed10f447923e54dde7">rW_new</a>[lev].setVal(5.6e23);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="comment">// These are just time averaged fields for diagnostics</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="comment">// NOTE: We are not completing a fillpach call on the time averaged data;</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="comment">//       which would copy on intersection and interpolate from coarse.</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="comment">//       Therefore, we are restarting the averaging when the ba changes,</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="comment">//       this may give poor statistics for dynamic mesh refinement.</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <a class="code" href="classERF.html#a3e146164ca6929ec6d4984b6a3f43c81">vel_t_avg</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#af3119a4089367206db9fc3a17664e874">time_avg_vel</a>) {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        <a class="code" href="classERF.html#a3e146164ca6929ec6d4984b6a3f43c81">vel_t_avg</a>[lev] = std::make_unique&lt;MultiFab&gt;(ba, dm, 4, 0); <span class="comment">// Each vel comp and the mag</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <a class="code" href="classERF.html#a3e146164ca6929ec6d4984b6a3f43c81">vel_t_avg</a>[lev]-&gt;setVal(0.0);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <a class="code" href="classERF.html#a6837423e9248e923fcaa1987b59d8160">t_avg_cnt</a>[lev] = 0.0;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    }</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="comment">// Initialize flux registers whenever we create/re-create a level</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#af976afa61859c07e6249963edc367c2d">coupling_type</a> == CouplingType::TwoWay) {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="keywordflow">if</span> (lev == 0) {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            <a class="code" href="classERF.html#a86a0bc8e41668411ee0ab5801d4688a7">advflux_reg</a>[0] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;            <span class="keywordtype">int</span> ncomp_reflux = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[0][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nComp();</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            <a class="code" href="classERF.html#a86a0bc8e41668411ee0ab5801d4688a7">advflux_reg</a>[lev] = <span class="keyword">new</span> YAFluxRegister(ba       , grids[lev-1],</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                                                  dm       ,  dmap[lev-1],</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                                                  geom[lev],  geom[lev-1],</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                                                  ref_ratio[lev-1], lev, ncomp_reflux);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        }</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    }</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="comment">// Define Theta_prim storage if using surface_layer BC</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[Orientation(Direction::z,Orientation::low)] == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9af69483cb4bb9623dc65e76ce5bd0a3d5">ERF_BC::surface_layer</a>) {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <a class="code" href="classERF.html#a71629ae2fda396472198691b75d83b2e">Theta_prim</a>[lev] = std::make_unique&lt;MultiFab&gt;(ba,dm,1,IntVect(ngrow_state,ngrow_state,1));</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> != MoistureType::None) {</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            <a class="code" href="classERF.html#a521d1faf157e3bccc86c0f26ee923576">Qv_prim</a>[lev]    = std::make_unique&lt;MultiFab&gt;(ba,dm,1,IntVect(ngrow_state,ngrow_state,1));</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            <a class="code" href="classERF.html#a57d8432920785f8e58cf11a3232d76b5">Qr_prim</a>[lev]    = std::make_unique&lt;MultiFab&gt;(ba,dm,1,IntVect(ngrow_state,ngrow_state,1));</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            <a class="code" href="classERF.html#a521d1faf157e3bccc86c0f26ee923576">Qv_prim</a>[lev]    = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            <a class="code" href="classERF.html#a57d8432920785f8e58cf11a3232d76b5">Qr_prim</a>[lev]    = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        }</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <a class="code" href="classERF.html#a71629ae2fda396472198691b75d83b2e">Theta_prim</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <a class="code" href="classERF.html#a521d1faf157e3bccc86c0f26ee923576">Qv_prim</a>[lev]    = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        <a class="code" href="classERF.html#a57d8432920785f8e58cf11a3232d76b5">Qr_prim</a>[lev]    = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    }</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="comment">// Map factors</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    BoxList bl2d_mf = ba.boxList();</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; b : bl2d_mf) {</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        b.setRange(2,0);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    }</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    BoxArray ba2d_mf(std::move(bl2d_mf));</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev].resize(<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85ba25361924f30bae15bbbc3346daaab6d8">MapFacType::num</a>);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85bac2a428daaf1a1b398630fa8cec7f115b">MapFacType::m_x</a>] = std::make_unique&lt;MultiFab&gt;(ba2d_mf,dm,1,3);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85baa4b935f173fee2d487101e302a5cfe18">MapFacType::u_x</a>] = std::make_unique&lt;MultiFab&gt;(convert(ba2d_mf,IntVect(1,0,0)),dm,1,3);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85ba21e22c79b875be81696b36a623690388">MapFacType::v_x</a>] = std::make_unique&lt;MultiFab&gt;(convert(ba2d_mf,IntVect(0,1,0)),dm,1,3);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="preprocessor">#if 0</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="comment">// For now we comment this out to avoid CI failures but we will need to re-enable</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="comment">//     this if using non-conformal mappings</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85ba9612b6816e2fb7dc3ad56d6bc1fb7df8">MapFacType::m_y</a> != <a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85bac2a428daaf1a1b398630fa8cec7f115b">MapFacType::m_x</a>) {</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85ba9612b6816e2fb7dc3ad56d6bc1fb7df8">MapFacType::m_y</a>] = std::make_unique&lt;MultiFab&gt;(ba2d_mf,dm,1,3);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    }</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85ba784971ba75d56c0d71c4bc08c5ddc1f3">MapFacType::u_y</a> != <a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85baa4b935f173fee2d487101e302a5cfe18">MapFacType::u_x</a>) {</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85ba784971ba75d56c0d71c4bc08c5ddc1f3">MapFacType::u_y</a>] = std::make_unique&lt;MultiFab&gt;(convert(ba2d_mf,IntVect(1,0,0)),dm,1,3);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    }</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85ba90990e92021688dbfd1cec52b03fd182">MapFacType::v_y</a> != <a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85ba21e22c79b875be81696b36a623690388">MapFacType::v_x</a>) {</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85ba90990e92021688dbfd1cec52b03fd182">MapFacType::v_y</a>] = std::make_unique&lt;MultiFab&gt;(convert(ba2d_mf,IntVect(0,1,0)),dm,1,3);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    }</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a9c7942f6ef7cf05115f35702097cf107">test_mapfactor</a>) {</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++) {</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][i]-&gt;setVal(0.5);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        }</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 3; i &lt; <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev].size(); i++) {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][i]-&gt;setVal(0.25);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        }</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev].size(); i++) {</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][i]-&gt;setVal(1.0);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        }</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    }</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="comment">// Build 1D BA and 2D BA</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    BoxList bl1d = ba.boxList();</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; b : bl1d) {</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        b.setRange(0,0);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        b.setRange(1,0);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    }</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <a class="code" href="classERF.html#a8c051cb96bfa9ff26929441978aa2a96">ba1d</a>[lev]  = BoxArray(std::move(bl1d));</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="comment">// Build 2D BA</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    BoxList bl2d = ba.boxList();</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; b : bl2d) {</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        b.setRange(2,0);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    }</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <a class="code" href="classERF.html#a268a79187ae9a115e601957f8b06cd42">ba2d</a>[lev]  = BoxArray(std::move(bl2d));</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    IntVect <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>  = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nGrowVect();</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <a class="code" href="classERF.html#a8839af37a73c4c2e76bf978a05275ca9">mf_C1H</a>[lev] = std::make_unique&lt;MultiFab&gt;(<a class="code" href="classERF.html#a8c051cb96bfa9ff26929441978aa2a96">ba1d</a>[lev],dm,1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <a class="code" href="classERF.html#ad473e8e616ea3f7bf7bf922a0fe16208">mf_C2H</a>[lev] = std::make_unique&lt;MultiFab&gt;(<a class="code" href="classERF.html#a8c051cb96bfa9ff26929441978aa2a96">ba1d</a>[lev],dm,1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <a class="code" href="classERF.html#aed4ae5792dd32adf56d3c052ce79437f">mf_MUB</a>[lev] = std::make_unique&lt;MultiFab&gt;(<a class="code" href="classERF.html#a268a79187ae9a115e601957f8b06cd42">ba2d</a>[lev],dm,1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="comment">//*********************************************************</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="comment">// Variables for Fitch model for windfarm parametrization</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="comment">//*********************************************************</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="preprocessor">#if defined(ERF_USE_WINDFARM)</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac0a723e8797cdc0fe06b3fc781fca645">windfarm_type</a> == WindFarmType::Fitch){</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        vars_windfarm[lev].define(ba, dm, 5, ngrow_state); <span class="comment">// V, dVabsdt, dudt, dvdt, dTKEdt</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    }</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac0a723e8797cdc0fe06b3fc781fca645">windfarm_type</a> == WindFarmType::EWP){</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        vars_windfarm[lev].define(ba, dm, 3, ngrow_state); <span class="comment">// dudt, dvdt, dTKEdt</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    }</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac0a723e8797cdc0fe06b3fc781fca645">windfarm_type</a> == WindFarmType::SimpleAD) {</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        vars_windfarm[lev].define(ba, dm, 2, ngrow_state);<span class="comment">// dudt, dvdt</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    }</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac0a723e8797cdc0fe06b3fc781fca645">windfarm_type</a> == WindFarmType::GeneralAD) {</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        vars_windfarm[lev].define(ba, dm, 3, ngrow_state);<span class="comment">// dudt, dvdt, dwdt</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        Nturb[lev].define(ba, dm, 1, ngrow_state); <span class="comment">// Number of turbines in a cell</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        SMark[lev].define(ba, dm, 2, 1); <span class="comment">// Free stream velocity/source term</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                                                   <span class="comment">// sampling marker in a cell - 2 components</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160; </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160; </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="preprocessor">#ifdef ERF_USE_WW3_COUPLING</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="comment">// create a new BoxArray and DistributionMapping for a MultiFab with 1 box</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    BoxArray ba_onegrid(geom[lev].Domain());</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    BoxList bl2d_onegrid = ba_onegrid.boxList();</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; b : bl2d_onegrid) {</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        b.setRange(2,0);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    }</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    BoxArray ba2d_onegrid(std::move(bl2d_onegrid));</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    Vector&lt;int&gt; pmap;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    pmap.resize(1);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    pmap[0]=0;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    DistributionMapping dm_onegrid(ba2d_onegrid);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    dm_onegrid.define(pmap);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <a class="code" href="classERF.html#a11f2d48d9af9b8f4574975cae06838f1">Hwave_onegrid</a>[lev] = std::make_unique&lt;MultiFab&gt;(ba2d_onegrid,dm_onegrid,1,IntVect(1,1,0));</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <a class="code" href="classERF.html#a83473e4b18de294a8b97dcdbbf048551">Lwave_onegrid</a>[lev] = std::make_unique&lt;MultiFab&gt;(ba2d_onegrid,dm_onegrid,1,IntVect(1,1,0));</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    BoxList bl2d_wave = ba.boxList();</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; b : bl2d_wave) {</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        b.setRange(2,0);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    }</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    BoxArray ba2d_wave(std::move(bl2d_wave));</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160; </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <a class="code" href="classERF.html#aef05cf88e9e9d2b56112336761493977">Hwave</a>[lev] = std::make_unique&lt;MultiFab&gt;(ba2d_wave,dm,1,IntVect(3,3,0));</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <a class="code" href="classERF.html#ad67b414a1a8b5bab6edeaf574f922825">Lwave</a>[lev] = std::make_unique&lt;MultiFab&gt;(ba2d_wave,dm,1,IntVect(3,3,0));</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160; </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    std::cout&lt;&lt;ba_onegrid&lt;&lt;std::endl;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    std::cout&lt;&lt;ba2d_onegrid&lt;&lt;std::endl;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    std::cout&lt;&lt;dm_onegrid&lt;&lt;std::endl;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160; </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160; </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="comment">//*********************************************************</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="comment">// Radiation heating source terms</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="comment">//*********************************************************</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a31c93846e0129221632347d2378e881d">rad_type</a> != RadiationType::None || <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a43c1741535574c7e6f4fe6bf90552f31">lsm_type</a> != LandSurfaceType::None)</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    {</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <a class="code" href="classERF.html#afa4c3753628a106460dbb708277de511">qheating_rates</a>[lev] = std::make_unique&lt;MultiFab&gt;(ba, dm, 2, ngrow_state);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <a class="code" href="classERF.html#afa4c3753628a106460dbb708277de511">qheating_rates</a>[lev]-&gt;setVal(0.);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    }</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160; </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="comment">//*********************************************************</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="comment">// Radiation fluxes for coupling to LSM</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="comment">//*********************************************************</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160; </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="comment">// NOTE: Finer levels do not need to coincide with the bottom domain boundary</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="comment">//       at k=0. We make slabs here with the kmin for a given box. Therefore,</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="comment">//       care must be taken before applying these fluxes to an LSM model. For</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160; </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="comment">// Radiative fluxes for LSM</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a43c1741535574c7e6f4fe6bf90552f31">lsm_type</a> != LandSurfaceType::None &amp;&amp;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a31c93846e0129221632347d2378e881d">rad_type</a> != RadiationType::None)</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    {</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        BoxList m_bl = ba.boxList();</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; b : m_bl) {</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;            <span class="keywordtype">int</span> kmin = b.smallEnd(2);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;            b.setRange(2,kmin);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        }</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        BoxArray m_ba(std::move(m_bl));</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        <a class="code" href="classERF.html#a1a3799aabf8337159aa290946fef8404">sw_lw_fluxes</a>[lev] = std::make_unique&lt;MultiFab&gt;(m_ba, dm, 5, ngrow_state); <span class="comment">// SW direct (2), SW diffuse (2), LW</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <a class="code" href="classERF.html#a69e6a357fd92f2c2ad9f6e0843372b16">solar_zenith</a>[lev] = std::make_unique&lt;MultiFab&gt;(m_ba, dm, 2, ngrow_state);</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160; </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        <a class="code" href="classERF.html#a1a3799aabf8337159aa290946fef8404">sw_lw_fluxes</a>[lev]-&gt;setVal(0.);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        <a class="code" href="classERF.html#a69e6a357fd92f2c2ad9f6e0843372b16">solar_zenith</a>[lev]-&gt;setVal(0.);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    }</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160; </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="comment">//*********************************************************</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="comment">// Turbulent perturbation region initialization</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="comment">//*********************************************************</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#abfd94767b3721755632c45a5ef290544">pert_type</a> == PerturbationType::Source ||</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#abfd94767b3721755632c45a5ef290544">pert_type</a> == PerturbationType::Direct ||</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#abfd94767b3721755632c45a5ef290544">pert_type</a> == PerturbationType::CPM)</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    {</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        amrex::Box bnd_bx = ba.minimalBox();</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <a class="code" href="classERF.html#ac1b9cce4a3c1736c4af78f6b0e2143ce">turbPert</a>.<a class="code" href="structTurbulentPerturbation.html#a94366398d00c059caf03cb7aec880431">init_tpi_type</a>(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#abfd94767b3721755632c45a5ef290544">pert_type</a>);</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        <a class="code" href="classERF.html#ac1b9cce4a3c1736c4af78f6b0e2143ce">turbPert</a>.<a class="code" href="structTurbulentPerturbation.html#ac7df65e193131bbf6014eb04a6efdf7f">init_tpi</a>(lev, bnd_bx.smallEnd(), bnd_bx.bigEnd(), geom[lev].CellSizeArray(),</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                          ba, dm, ngrow_state, <a class="code" href="classERF.html#a59df30e7a5537c8543bb00772bd98b58">pp_prefix</a>, refRatio(), max_level);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    }</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160; </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="comment">// Define the land mask here and set it to all land by default</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="comment">// NOTE: the logic below will BREAK if we have any grids not touching the bottom boundary</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    {</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <a class="code" href="classERF.html#a3f3e29874221e43e13e2a431e77e0e4e">lmask_lev</a>[lev].resize(1);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="keyword">auto</span> ngv = lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nGrowVect(); ngv[2] = 0;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    BoxList bl2d_mask = ba.boxList();</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; b : bl2d_mask) {</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        b.setRange(2,0);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    }</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    BoxArray ba2d_mask(std::move(bl2d_mask));</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <a class="code" href="classERF.html#a3f3e29874221e43e13e2a431e77e0e4e">lmask_lev</a>[lev][0] = std::make_unique&lt;iMultiFab&gt;(ba2d_mask,dm,1,ngv);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <a class="code" href="classERF.html#a3f3e29874221e43e13e2a431e77e0e4e">lmask_lev</a>[lev][0]-&gt;setVal(1);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <a class="code" href="classERF.html#a3f3e29874221e43e13e2a431e77e0e4e">lmask_lev</a>[lev][0]-&gt;FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    }</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160; </div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="comment">// Read in tables needed for windfarm simulations</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="comment">// fill in Nturb multifab - number of turbines in each mesh cell</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="comment">// write out the vtk files for wind turbine location and/or</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="comment">// actuator disks</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="preprocessor">    #ifdef ERF_USE_WINDFARM</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        <span class="comment">//init_windfarm(lev);</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;}</div>
<div class="ttc" id="aERF__DataStruct_8H_html_a61bff79effb7ee8f045654684246b85ba25361924f30bae15bbbc3346daaab6d8"><div class="ttname"><a href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85ba25361924f30bae15bbbc3346daaab6d8">num</a></div><div class="ttdeci">@ num</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:22</div></div>
<div class="ttc" id="aERF__IndexDefines_8H_html_a38d6fda9ca3d40309838c64d398b54c1"><div class="ttname"><a href="ERF__IndexDefines_8H.html#a38d6fda9ca3d40309838c64d398b54c1">NDRY</a></div><div class="ttdeci">#define NDRY</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:13</div></div>
<div class="ttc" id="aERF__TerrainMetrics_8cpp_html_a28a6372799b0be6e2745cae9cb180567"><div class="ttname"><a href="ERF__TerrainMetrics_8cpp.html#a28a6372799b0be6e2745cae9cb180567">init_default_zphys</a></div><div class="ttdeci">void init_default_zphys(int, const Geometry &amp;geom, MultiFab &amp;z_phys_nd, MultiFab &amp;z_phys_cc)</div><div class="ttdef"><b>Definition:</b> ERF_TerrainMetrics.cpp:15</div></div>
<div class="ttc" id="aclassERF_html_aaad87d9eb7e20af21deb83d72f94801c"><div class="ttname"><a href="classERF.html#aaad87d9eb7e20af21deb83d72f94801c">ERF::ComputeGhostCells</a></div><div class="ttdeci">static AMREX_FORCE_INLINE int ComputeGhostCells(const SolverChoice &amp;sc)</div><div class="ttdef"><b>Definition:</b> ERF.H:1172</div></div>
<div class="ttc" id="anamespaceBaseState_html_a6f8dc3597225ea7941dad615e7f22e91a088c1232c30770df1105d3cdf66ee582"><div class="ttname"><a href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91a088c1232c30770df1105d3cdf66ee582">BaseState::num_comps</a></div><div class="ttdeci">@ num_comps</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:68</div></div>
<div class="ttc" id="anamespaceGpVars_html_ac972418cf9113d552b162715dae54ebda7490c53ed57352abcd4a219cd12bf517"><div class="ttname"><a href="namespaceGpVars.html#ac972418cf9113d552b162715dae54ebda7490c53ed57352abcd4a219cd12bf517">GpVars::gpz</a></div><div class="ttdeci">@ gpz</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:152</div></div>
<div class="ttc" id="anamespaceGpVars_html_ac972418cf9113d552b162715dae54ebda8b32fb9218fd4f10ccc5736e6a61a72d"><div class="ttname"><a href="namespaceGpVars.html#ac972418cf9113d552b162715dae54ebda8b32fb9218fd4f10ccc5736e6a61a72d">GpVars::gpy</a></div><div class="ttdeci">@ gpy</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:151</div></div>
<div class="ttc" id="anamespaceGpVars_html_ac972418cf9113d552b162715dae54ebdaecfb8189072456062c3c29c137ec2323"><div class="ttname"><a href="namespaceGpVars.html#ac972418cf9113d552b162715dae54ebdaecfb8189072456062c3c29c137ec2323">GpVars::gpx</a></div><div class="ttdeci">@ gpx</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:150</div></div>
<div class="ttc" id="astructSolverChoice_html_a9c7942f6ef7cf05115f35702097cf107"><div class="ttname"><a href="structSolverChoice.html#a9c7942f6ef7cf05115f35702097cf107">SolverChoice::test_mapfactor</a></div><div class="ttdeci">bool test_mapfactor</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:731</div></div>
<div class="ttc" id="astructTurbulentPerturbation_html_a94366398d00c059caf03cb7aec880431"><div class="ttname"><a href="structTurbulentPerturbation.html#a94366398d00c059caf03cb7aec880431">TurbulentPerturbation::init_tpi_type</a></div><div class="ttdeci">void init_tpi_type(const PerturbationType &amp;pert_type)</div><div class="ttdef"><b>Definition:</b> ERF_TurbPertStruct.H:28</div></div>
<div class="ttc" id="astructTurbulentPerturbation_html_ac7df65e193131bbf6014eb04a6efdf7f"><div class="ttname"><a href="structTurbulentPerturbation.html#ac7df65e193131bbf6014eb04a6efdf7f">TurbulentPerturbation::init_tpi</a></div><div class="ttdeci">void init_tpi(const int lev, const amrex::IntVect &amp;valid_box_lo, const amrex::IntVect &amp;valid_box_hi, const amrex::GpuArray&lt; amrex::Real, 3 &gt; dx, const amrex::BoxArray &amp;ba, const amrex::DistributionMapping &amp;dm, const int ngrow_state, std::string pp_prefix, const amrex::Vector&lt; amrex::IntVect &gt; refRatio, const int max_level)</div><div class="ttdef"><b>Definition:</b> ERF_TurbPertStruct.H:45</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_aaf237fbe118d80f149295c0579608579_cgraph.png" border="0" usemap="#aclassERF_aaf237fbe118d80f149295c0579608579_cgraph" alt=""/></div>
<map name="aclassERF_aaf237fbe118d80f149295c0579608579_cgraph" id="aclassERF_aaf237fbe118d80f149295c0579608579_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,116,32"/>
<area shape="rect" href="ERF__TerrainMetrics_8cpp.html#a28a6372799b0be6e2745cae9cb180567" title=" " alt="" coords="164,5,305,32"/>
</map>
</div>

</div>
</div>
<a id="af4f87fb01d61c18d8eb85ac5ac159785"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4f87fb01d61c18d8eb85ac5ac159785">&#9670;&nbsp;</a></span>init_thin_body()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::init_thin_body </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::BoxArray &amp;&#160;</td>
          <td class="paramname"><em>ba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::DistributionMapping &amp;&#160;</td>
          <td class="paramname"><em>dm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;{</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <span class="comment">//********************************************************************************************</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <span class="comment">// Thin immersed body</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <span class="comment">// *******************************************************************************************</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="preprocessor">#if 0</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a7a086b9e2aabb65d2e5e9053e7bd6018">zero_xflux</a>.size() &gt; 0) ||</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a118575fe302e72fcd231e77be6d117a9">zero_yflux</a>.size() &gt; 0) ||</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a7da4e5242e05aeba4822b71fab596954">zero_zflux</a>.size() &gt; 0))</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    {</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        overset_imask[lev] = std::make_unique&lt;iMultiFab&gt;(ba,dm,1,0);</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        overset_imask[lev]-&gt;setVal(1); <span class="comment">// == value is unknown (to be solved)</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    }</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160; </div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a7a086b9e2aabb65d2e5e9053e7bd6018">zero_xflux</a>.size() &gt; 0) {</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Setting up thin immersed body for &quot;</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;            &lt;&lt; <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a7a086b9e2aabb65d2e5e9053e7bd6018">zero_xflux</a>.size() &lt;&lt; <span class="stringliteral">&quot; xfaces&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        BoxArray ba_xf(ba);</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        ba_xf.surroundingNodes(0);</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        <a class="code" href="classERF.html#a5b9b8d719a87a6940f611c6a30e8ccf5">thin_xforce</a>[lev] = std::make_unique&lt;MultiFab&gt;(ba_xf,dm,1,0);</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        <a class="code" href="classERF.html#a5b9b8d719a87a6940f611c6a30e8ccf5">thin_xforce</a>[lev]-&gt;setVal(0.0);</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        <a class="code" href="classERF.html#af044f075df34caa2a530aa13e1801a5b">xflux_imask</a>[lev] = std::make_unique&lt;iMultiFab&gt;(ba_xf,dm,1,0);</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        <a class="code" href="classERF.html#af044f075df34caa2a530aa13e1801a5b">xflux_imask</a>[lev]-&gt;setVal(1);</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        <span class="keywordflow">for</span> ( MFIter mfi(*<a class="code" href="classERF.html#af044f075df34caa2a530aa13e1801a5b">xflux_imask</a>[lev], TilingIfNotGPU()); mfi.isValid(); ++mfi )</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        {</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;            Array4&lt;int&gt; <span class="keyword">const</span>&amp; imask_arr = <a class="code" href="classERF.html#af044f075df34caa2a530aa13e1801a5b">xflux_imask</a>[lev]-&gt;array(mfi);</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;            <span class="comment">//Array4&lt;int&gt; const&amp; imask_cell_arr = overset_imask[lev]-&gt;array(mfi);</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;            Box <a class="code" href="ERF__DiffSetup_8H.html#a853a144267414a8a59c87f80ca5c958c">xbx</a> = mfi.nodaltilebox(0);</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iv=0; iv &lt; <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a7a086b9e2aabb65d2e5e9053e7bd6018">zero_xflux</a>.size(); ++iv) {</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                <span class="keyword">const</span> <span class="keyword">auto</span>&amp; faceidx = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a7a086b9e2aabb65d2e5e9053e7bd6018">zero_xflux</a>[iv];</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                <span class="keywordflow">if</span> ((faceidx[0] &gt;= <a class="code" href="ERF__DiffSetup_8H.html#a853a144267414a8a59c87f80ca5c958c">xbx</a>.smallEnd(0)) &amp;&amp; (faceidx[0] &lt;= <a class="code" href="ERF__DiffSetup_8H.html#a853a144267414a8a59c87f80ca5c958c">xbx</a>.bigEnd(0)) &amp;&amp;</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                    (faceidx[1] &gt;= <a class="code" href="ERF__DiffSetup_8H.html#a853a144267414a8a59c87f80ca5c958c">xbx</a>.smallEnd(1)) &amp;&amp; (faceidx[1] &lt;= <a class="code" href="ERF__DiffSetup_8H.html#a853a144267414a8a59c87f80ca5c958c">xbx</a>.bigEnd(1)) &amp;&amp;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                    (faceidx[2] &gt;= <a class="code" href="ERF__DiffSetup_8H.html#a853a144267414a8a59c87f80ca5c958c">xbx</a>.smallEnd(2)) &amp;&amp; (faceidx[2] &lt;= <a class="code" href="ERF__DiffSetup_8H.html#a853a144267414a8a59c87f80ca5c958c">xbx</a>.bigEnd(2)))</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                {</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                    imask_arr(faceidx[0],faceidx[1],faceidx[2]) = 0;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                    <span class="comment">//imask_cell_arr(faceidx[0],faceidx[1],faceidx[2]) = 0;</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                    <span class="comment">//imask_cell_arr(faceidx[0]-1,faceidx[1],faceidx[2]) = 0;</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                    amrex::AllPrint() &lt;&lt; <span class="stringliteral">&quot;  mask xface at &quot;</span> &lt;&lt; faceidx &lt;&lt; std::endl;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                }</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;            }</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        }</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        <a class="code" href="classERF.html#a5b9b8d719a87a6940f611c6a30e8ccf5">thin_xforce</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        <a class="code" href="classERF.html#af044f075df34caa2a530aa13e1801a5b">xflux_imask</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    }</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160; </div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a118575fe302e72fcd231e77be6d117a9">zero_yflux</a>.size() &gt; 0) {</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Setting up thin immersed body for &quot;</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;            &lt;&lt; <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a118575fe302e72fcd231e77be6d117a9">zero_yflux</a>.size() &lt;&lt; <span class="stringliteral">&quot; yfaces&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;        BoxArray ba_yf(ba);</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;        ba_yf.surroundingNodes(1);</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        <a class="code" href="classERF.html#a18c1142552120bbd22987f34995ee939">thin_yforce</a>[lev] = std::make_unique&lt;MultiFab&gt;(ba_yf,dm,1,0);</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        <a class="code" href="classERF.html#a18c1142552120bbd22987f34995ee939">thin_yforce</a>[lev]-&gt;setVal(0.0);</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        <a class="code" href="classERF.html#aa4448d06a3e4fe9740927a636030939d">yflux_imask</a>[lev] = std::make_unique&lt;iMultiFab&gt;(ba_yf,dm,1,0);</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        <a class="code" href="classERF.html#aa4448d06a3e4fe9740927a636030939d">yflux_imask</a>[lev]-&gt;setVal(1);</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        <span class="keywordflow">for</span> ( MFIter mfi(*<a class="code" href="classERF.html#aa4448d06a3e4fe9740927a636030939d">yflux_imask</a>[lev], TilingIfNotGPU()); mfi.isValid(); ++mfi )</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        {</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;            Array4&lt;int&gt; <span class="keyword">const</span>&amp; imask_arr = <a class="code" href="classERF.html#aa4448d06a3e4fe9740927a636030939d">yflux_imask</a>[lev]-&gt;array(mfi);</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;            <span class="comment">//Array4&lt;int&gt; const&amp; imask_cell_arr = overset_imask[lev]-&gt;array(mfi);</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;            Box <a class="code" href="ERF__DiffSetup_8H.html#ae3d636c41f5271630a5816a4b8b668b2">ybx</a> = mfi.nodaltilebox(1);</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iv=0; iv &lt; <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a118575fe302e72fcd231e77be6d117a9">zero_yflux</a>.size(); ++iv) {</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                <span class="keyword">const</span> <span class="keyword">auto</span>&amp; faceidx = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a118575fe302e72fcd231e77be6d117a9">zero_yflux</a>[iv];</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                <span class="keywordflow">if</span> ((faceidx[0] &gt;= <a class="code" href="ERF__DiffSetup_8H.html#ae3d636c41f5271630a5816a4b8b668b2">ybx</a>.smallEnd(0)) &amp;&amp; (faceidx[0] &lt;= <a class="code" href="ERF__DiffSetup_8H.html#ae3d636c41f5271630a5816a4b8b668b2">ybx</a>.bigEnd(0)) &amp;&amp;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                    (faceidx[1] &gt;= <a class="code" href="ERF__DiffSetup_8H.html#ae3d636c41f5271630a5816a4b8b668b2">ybx</a>.smallEnd(1)) &amp;&amp; (faceidx[1] &lt;= <a class="code" href="ERF__DiffSetup_8H.html#ae3d636c41f5271630a5816a4b8b668b2">ybx</a>.bigEnd(1)) &amp;&amp;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                    (faceidx[2] &gt;= <a class="code" href="ERF__DiffSetup_8H.html#ae3d636c41f5271630a5816a4b8b668b2">ybx</a>.smallEnd(2)) &amp;&amp; (faceidx[2] &lt;= <a class="code" href="ERF__DiffSetup_8H.html#ae3d636c41f5271630a5816a4b8b668b2">ybx</a>.bigEnd(2)))</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                {</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                    imask_arr(faceidx[0],faceidx[1],faceidx[2]) = 0;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                    <span class="comment">//imask_cell_arr(faceidx[0],faceidx[1],faceidx[2]) = 0;</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                    <span class="comment">//imask_cell_arr(faceidx[0],faceidx[1]-1,faceidx[2]) = 0;</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                    amrex::AllPrint() &lt;&lt; <span class="stringliteral">&quot;  mask yface at &quot;</span> &lt;&lt; faceidx &lt;&lt; std::endl;</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                }</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;            }</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        }</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        <a class="code" href="classERF.html#a18c1142552120bbd22987f34995ee939">thin_yforce</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        <a class="code" href="classERF.html#aa4448d06a3e4fe9740927a636030939d">yflux_imask</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    }</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160; </div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a7da4e5242e05aeba4822b71fab596954">zero_zflux</a>.size() &gt; 0) {</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Setting up thin immersed body for &quot;</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;            &lt;&lt; <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a7da4e5242e05aeba4822b71fab596954">zero_zflux</a>.size() &lt;&lt; <span class="stringliteral">&quot; zfaces&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        BoxArray ba_zf(ba);</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        ba_zf.surroundingNodes(2);</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;        <a class="code" href="classERF.html#a56a23d298bc66218bf257d0e793e341f">thin_zforce</a>[lev] = std::make_unique&lt;MultiFab&gt;(ba_zf,dm,1,0);</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        <a class="code" href="classERF.html#a56a23d298bc66218bf257d0e793e341f">thin_zforce</a>[lev]-&gt;setVal(0.0);</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        <a class="code" href="classERF.html#ada098767690d194f89717b0deb3adeac">zflux_imask</a>[lev] = std::make_unique&lt;iMultiFab&gt;(ba_zf,dm,1,0);</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        <a class="code" href="classERF.html#ada098767690d194f89717b0deb3adeac">zflux_imask</a>[lev]-&gt;setVal(1);</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;        <span class="keywordflow">for</span> ( MFIter mfi(*<a class="code" href="classERF.html#ada098767690d194f89717b0deb3adeac">zflux_imask</a>[lev], TilingIfNotGPU()); mfi.isValid(); ++mfi )</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        {</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;            Array4&lt;int&gt; <span class="keyword">const</span>&amp; imask_arr = <a class="code" href="classERF.html#ada098767690d194f89717b0deb3adeac">zflux_imask</a>[lev]-&gt;array(mfi);</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;            <span class="comment">//Array4&lt;int&gt; const&amp; imask_cell_arr = overset_imask[lev]-&gt;array(mfi);</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;            Box <a class="code" href="ERF__DiffSetup_8H.html#a4c74ed1b76138a2f5baa925afe40f9a8">zbx</a> = mfi.nodaltilebox(2);</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iv=0; iv &lt; <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a7da4e5242e05aeba4822b71fab596954">zero_zflux</a>.size(); ++iv) {</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                <span class="keyword">const</span> <span class="keyword">auto</span>&amp; faceidx = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a7da4e5242e05aeba4822b71fab596954">zero_zflux</a>[iv];</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                <span class="keywordflow">if</span> ((faceidx[0] &gt;= <a class="code" href="ERF__DiffSetup_8H.html#a4c74ed1b76138a2f5baa925afe40f9a8">zbx</a>.smallEnd(0)) &amp;&amp; (faceidx[0] &lt;= <a class="code" href="ERF__DiffSetup_8H.html#a4c74ed1b76138a2f5baa925afe40f9a8">zbx</a>.bigEnd(0)) &amp;&amp;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                    (faceidx[1] &gt;= <a class="code" href="ERF__DiffSetup_8H.html#a4c74ed1b76138a2f5baa925afe40f9a8">zbx</a>.smallEnd(1)) &amp;&amp; (faceidx[1] &lt;= <a class="code" href="ERF__DiffSetup_8H.html#a4c74ed1b76138a2f5baa925afe40f9a8">zbx</a>.bigEnd(1)) &amp;&amp;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                    (faceidx[2] &gt;= <a class="code" href="ERF__DiffSetup_8H.html#a4c74ed1b76138a2f5baa925afe40f9a8">zbx</a>.smallEnd(2)) &amp;&amp; (faceidx[2] &lt;= <a class="code" href="ERF__DiffSetup_8H.html#a4c74ed1b76138a2f5baa925afe40f9a8">zbx</a>.bigEnd(2)))</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                {</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                    imask_arr(faceidx[0],faceidx[1],faceidx[2]) = 0;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                    <span class="comment">//imask_cell_arr(faceidx[0],faceidx[1],faceidx[2]) = 0;</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                    <span class="comment">//imask_cell_arr(faceidx[0],faceidx[1],faceidx[2]-1) = 0;</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                    amrex::AllPrint() &lt;&lt; <span class="stringliteral">&quot;  mask zface at &quot;</span> &lt;&lt; faceidx &lt;&lt; std::endl;</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                }</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;            }</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        }</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        <a class="code" href="classERF.html#a56a23d298bc66218bf257d0e793e341f">thin_zforce</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;        <a class="code" href="classERF.html#ada098767690d194f89717b0deb3adeac">zflux_imask</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    }</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;}</div>
<div class="ttc" id="astructAdvChoice_html_a118575fe302e72fcd231e77be6d117a9"><div class="ttname"><a href="structAdvChoice.html#a118575fe302e72fcd231e77be6d117a9">AdvChoice::zero_yflux</a></div><div class="ttdeci">amrex::Vector&lt; amrex::IntVect &gt; zero_yflux</div><div class="ttdef"><b>Definition:</b> ERF_AdvStruct.H:358</div></div>
<div class="ttc" id="astructAdvChoice_html_a7a086b9e2aabb65d2e5e9053e7bd6018"><div class="ttname"><a href="structAdvChoice.html#a7a086b9e2aabb65d2e5e9053e7bd6018">AdvChoice::zero_xflux</a></div><div class="ttdeci">amrex::Vector&lt; amrex::IntVect &gt; zero_xflux</div><div class="ttdef"><b>Definition:</b> ERF_AdvStruct.H:357</div></div>
<div class="ttc" id="astructAdvChoice_html_a7da4e5242e05aeba4822b71fab596954"><div class="ttname"><a href="structAdvChoice.html#a7da4e5242e05aeba4822b71fab596954">AdvChoice::zero_zflux</a></div><div class="ttdeci">amrex::Vector&lt; amrex::IntVect &gt; zero_zflux</div><div class="ttdef"><b>Definition:</b> ERF_AdvStruct.H:359</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae618963cf90e247b72fbd71d5b13599d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae618963cf90e247b72fbd71d5b13599d">&#9670;&nbsp;</a></span>init_uniform()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::init_uniform </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Use problem-specific reference density and temperature to set the background state to a uniform value.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lev</td><td>Integer specifying the current level </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;{</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <span class="keyword">auto</span>&amp; lev_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev];</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <span class="keywordflow">for</span> (MFIter mfi(lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], TilingIfNotGPU()); mfi.isValid(); ++mfi) {</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;        <span class="keyword">const</span> Box &amp;gbx = mfi.growntilebox(1);</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> &amp;cons_arr = lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].array(mfi);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;        <a class="code" href="classERF.html#a60e8cb933f237903e3fbcd6376c26db0">prob</a>-&gt;init_uniform(gbx, cons_arr);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    }</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8f50cd1ba85fbf9ae0579a56ba06eb1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f50cd1ba85fbf9ae0579a56ba06eb1b">&#9670;&nbsp;</a></span>init_zphys()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::init_zphys </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;{</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac1ddc9c301ac98689bf3b7b7184b24e1">init_type</a> != InitType::WRFInput &amp;&amp; <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac1ddc9c301ac98689bf3b7b7184b24e1">init_type</a> != InitType::Metgrid)</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    {</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        <span class="keywordflow">if</span> (lev &gt; 0) {</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;            <span class="comment">// First interpolate from coarser level if there is one</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;            <span class="comment">// NOTE: this interpolater assumes that ALL ghost cells of the coarse MultiFab</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;            <span class="comment">//       have been pre-filled - this includes ghost cells both inside and outside</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;            <span class="comment">//       the domain</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;            InterpFromCoarseLevel(*<a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev], <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev]-&gt;nGrowVect(),</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                                  IntVect(0,0,0), <span class="comment">// do not fill ghost cells outside the domain</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                                  *<a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev-1], 0, 0, 1,</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                                  geom[lev-1], geom[lev],</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                                  refRatio(lev-1), &amp;node_bilinear_interp,</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                                  <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>, <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>);</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        }</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160; </div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        <span class="keywordtype">int</span> ngrow = <a class="code" href="classERF.html#aaad87d9eb7e20af21deb83d72f94801c">ComputeGhostCells</a>(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>) + 2;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        Box bx(surroundingNodes(Geom(lev).Domain())); bx.grow(ngrow);</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        FArrayBox terrain_fab(makeSlab(bx,2,0),1);</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160; </div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        <span class="comment">// If we are using fitted mesh then we use the surface as defined above</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        <span class="comment">// If we are not using fitted mesh but are using z_levels, we still need z_phys (for now)</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        <span class="comment">//    but we need to use a flat terrain for the mesh itself (the EB data has already been made</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        <span class="comment">//    from the correct terrain)</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> != TerrainType::StaticFittedMesh &amp;&amp;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;            <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> != TerrainType::MovingFittedMesh) {</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                terrain_fab.template setVal&lt;RunOn::Device&gt;(0.0);</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;            <span class="comment">// Fill the values of the terrain height at k=0 only</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;            <a class="code" href="classERF.html#a60e8cb933f237903e3fbcd6376c26db0">prob</a>-&gt;init_terrain_surface(geom[lev],terrain_fab,time);</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        }</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160; </div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        <span class="keywordflow">for</span> (MFIter mfi(*<a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev],TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        {</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;            Box isect = terrain_fab.box() &amp; (*<a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev])[mfi].box();</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;            <span class="keywordflow">if</span> (!isect.isEmpty()) {</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                (*<a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev])[mfi].<span class="keyword">template</span> copy&lt;RunOn::Device&gt;(terrain_fab,isect,0,isect,0,1);</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;            }</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        }</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160; </div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        <a class="code" href="ERF__TerrainMetrics_8cpp.html#a9addf6b6f85760dd0d43acd9a52fe66c">make_terrain_fitted_coords</a>(lev,geom[lev],*<a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev],<a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[lev],<a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>);</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160; </div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev]-&gt;FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160; </div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> == TerrainType::ImmersedForcing) {</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;            <a class="code" href="classERF.html#a4a18cc3befd0911ccb011f9bb3b2efc2">terrain_blanking</a>[lev]-&gt;setVal(1.0);</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;            MultiFab::Subtract(*<a class="code" href="classERF.html#a4a18cc3befd0911ccb011f9bb3b2efc2">terrain_blanking</a>[lev], <a class="code" href="classERF.html#ad024dd413ab20e5d6f69c1f96e5b78a3">EBFactory</a>(lev).getVolFrac(), 0, 0, 1, ngrow);</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;            <a class="code" href="classERF.html#a4a18cc3befd0911ccb011f9bb3b2efc2">terrain_blanking</a>[lev]-&gt;FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        }</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160; </div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        <span class="keywordflow">if</span> (lev == 0) {</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;            Real zmax = <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[0]-&gt;max(0,0,<span class="keyword">false</span>);</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;            Real rel_diff = (zmax - <a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[0][<a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[0].size()-1]) / zmax;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;            <span class="keywordflow">if</span> (rel_diff &lt; 1.e-8) {</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                amrex::Print() &lt;&lt; <span class="stringliteral">&quot;max of zphys_nd &quot;</span> &lt;&lt; zmax &lt;&lt; std::endl;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                amrex::Print() &lt;&lt; <span class="stringliteral">&quot;max of zlevels  &quot;</span> &lt;&lt; <a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[0][<a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[0].size()-1] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                AMREX_ALWAYS_ASSERT_WITH_MESSAGE(rel_diff &lt; 1.e-8, <span class="stringliteral">&quot;Terrain is taller than domain top!&quot;</span>);</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;            }</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        } <span class="comment">// lev == 0</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160; </div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    } <span class="comment">// init_type</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;}</div>
<div class="ttc" id="aERF__TerrainMetrics_8cpp_html_a9addf6b6f85760dd0d43acd9a52fe66c"><div class="ttname"><a href="ERF__TerrainMetrics_8cpp.html#a9addf6b6f85760dd0d43acd9a52fe66c">make_terrain_fitted_coords</a></div><div class="ttdeci">void make_terrain_fitted_coords(int lev, const Geometry &amp;geom, MultiFab &amp;z_phys_nd, Vector&lt; Real &gt; const &amp;z_levels_h, GpuArray&lt; ERF_BC, AMREX_SPACEDIM *2 &gt; &amp;phys_bc_type)</div><div class="ttdef"><b>Definition:</b> ERF_TerrainMetrics.cpp:46</div></div>
<div class="ttc" id="aclassERF_html_ad024dd413ab20e5d6f69c1f96e5b78a3"><div class="ttname"><a href="classERF.html#ad024dd413ab20e5d6f69c1f96e5b78a3">ERF::EBFactory</a></div><div class="ttdeci">amrex::EBFArrayBoxFactory const  &amp; EBFactory(int lev) const noexcept</div><div class="ttdef"><b>Definition:</b> ERF.H:1448</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a8f50cd1ba85fbf9ae0579a56ba06eb1b_cgraph.png" border="0" usemap="#aclassERF_a8f50cd1ba85fbf9ae0579a56ba06eb1b_cgraph" alt=""/></div>
<map name="aclassERF_a8f50cd1ba85fbf9ae0579a56ba06eb1b_cgraph" id="aclassERF_a8f50cd1ba85fbf9ae0579a56ba06eb1b_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,125,57"/>
<area shape="rect" href="ERF__TerrainMetrics_8cpp.html#a9addf6b6f85760dd0d43acd9a52fe66c" title=" " alt="" coords="173,23,323,65"/>
<area shape="rect" href="ERF__ChopGrids_8cpp.html#a6fe49eeaa200ab6ab8ae0a6e048f3ded" title=" " alt="" coords="403,5,509,32"/>
<area shape="rect" href="ERF__TerrainMetrics_8cpp.html#ac59abef116a0b274b84ab3d89771ef22" title=" " alt="" coords="371,56,541,83"/>
<area shape="rect" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469" title=" " alt="" coords="589,56,628,83"/>
</map>
</div>

</div>
</div>
<a id="ad5d585e110291969767013a515719224"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5d585e110291969767013a515719224">&#9670;&nbsp;</a></span>InitData()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::InitData </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;{</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    BL_PROFILE_VAR(<span class="stringliteral">&quot;ERF::InitData()&quot;</span>, <a class="code" href="classERF.html#ad5d585e110291969767013a515719224">InitData</a>);</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    <a class="code" href="classERF.html#a9084860e0049795487636a9e0ccbc89e">InitData_pre</a>();</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <a class="code" href="classERF.html#aa8b243c093bd872b6f7592603ff97792">InitData_post</a>();</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    BL_PROFILE_VAR_STOP(<a class="code" href="classERF.html#ad5d585e110291969767013a515719224">InitData</a>);</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_a9084860e0049795487636a9e0ccbc89e"><div class="ttname"><a href="classERF.html#a9084860e0049795487636a9e0ccbc89e">ERF::InitData_pre</a></div><div class="ttdeci">void InitData_pre()</div><div class="ttdef"><b>Definition:</b> ERF.cpp:731</div></div>
<div class="ttc" id="aclassERF_html_aa8b243c093bd872b6f7592603ff97792"><div class="ttname"><a href="classERF.html#aa8b243c093bd872b6f7592603ff97792">ERF::InitData_post</a></div><div class="ttdeci">void InitData_post()</div><div class="ttdef"><b>Definition:</b> ERF.cpp:802</div></div>
<div class="ttc" id="aclassERF_html_ad5d585e110291969767013a515719224"><div class="ttname"><a href="classERF.html#ad5d585e110291969767013a515719224">ERF::InitData</a></div><div class="ttdeci">void InitData()</div><div class="ttdef"><b>Definition:</b> ERF.cpp:722</div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_ad5d585e110291969767013a515719224_icgraph.png" border="0" usemap="#aclassERF_ad5d585e110291969767013a515719224_icgraph" alt=""/></div>
<map name="aclassERF_ad5d585e110291969767013a515719224_icgraph" id="aclassERF_ad5d585e110291969767013a515719224_icgraph">
<area shape="rect" title=" " alt="" coords="108,5,215,32"/>
<area shape="rect" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,60,32"/>
</map>
</div>

</div>
</div>
<a id="aa8b243c093bd872b6f7592603ff97792"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8b243c093bd872b6f7592603ff97792">&#9670;&nbsp;</a></span>InitData_post()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::InitData_post </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;{</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>.empty()) {</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;        <span class="comment">// Make sure that detJ and z_phys_cc are the average of the data on a finer level if there is one</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structSolverChoice.html#a1952672901901b0b3a628f2298dc72c2">SolverChoice::mesh_type</a> != MeshType::ConstantDz) {</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> crse_lev = finest_level-1; crse_lev &gt;= 0; crse_lev--) {</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                average_down(  *<a class="code" href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">detJ_cc</a>[crse_lev+1],   *<a class="code" href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">detJ_cc</a>[crse_lev], 0, 1, refRatio(crse_lev));</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                average_down(*<a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[crse_lev+1], *<a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[crse_lev], 0, 1, refRatio(crse_lev));</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;            }</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        }</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160; </div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#af976afa61859c07e6249963edc367c2d">coupling_type</a> == CouplingType::TwoWay) {</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;            <a class="code" href="classERF.html#a8202de1f8f372e3e6fdc483447c6a55f">AverageDown</a>();</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        }</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160; </div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a94de4907b3d6742071d5542b60e8f393">have_zero_flux_faces</a>)</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        {</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;            AMREX_ALWAYS_ASSERT_WITH_MESSAGE(finest_level == 0,</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                <span class="stringliteral">&quot;Thin immersed body with refinement not currently supported.&quot;</span>);</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="structSolverChoice.html#a1952672901901b0b3a628f2298dc72c2">SolverChoice::mesh_type</a> != MeshType::ConstantDz) {</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;                amrex::Print() &lt;&lt; <span class="stringliteral">&quot;NOTE: Thin immersed body with non-constant dz has not been tested.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;            }</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;        }</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160; </div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<span class="preprocessor">#ifdef ERF_USE_PARTICLES</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classMicrophysics.html#ac10e6fce2e6cb49373d56ca0e1a5b366">Microphysics::modelType</a>(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a>) == MoistureModelType::Lagrangian) {</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; lev++) {</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                <span class="keyword">dynamic_cast&lt;</span>LagrangianMicrophysics&amp;<span class="keyword">&gt;</span>(*micro).initParticles(<a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev]);</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;            }</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        }</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160; </div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    } <span class="keywordflow">else</span> { <span class="comment">// Restart from a checkpoint</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160; </div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;        <a class="code" href="classERF.html#a530d2ce59e6fd46e9fb00e4d11eaf737">restart</a>();</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160; </div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;        <span class="comment">// Create the physbc objects for {cons, u, v, w, base state}</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;        <span class="comment">// We fill the additional base state ghost cells just in case we have read the old format</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev(0); lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;            <a class="code" href="classERF.html#ac81ec7f74a1be1c4a1e6e15e08385ed5">make_physbcs</a>(lev);</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;            (*<a class="code" href="classERF.html#af4e7dc93dae16aa2cc94bbb20b699a6f">physbcs_base</a>[lev])(<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev],0,<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].nComp(),<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].nGrowVect());</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;        }</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160; </div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aed9118172b234c3a0069a78776d09baa">do_forest_drag</a>) {</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev(0); lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                <a class="code" href="classERF.html#a8b181e6ed0bb62d79e4a62555210abc9">m_forest_drag</a>[lev]-&gt;define_drag_field(grids[lev], dmap[lev], geom[lev],</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                                                      <a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[lev].get(), <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev].get());</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;            }</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        }</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160; </div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="preprocessor">#ifdef ERF_USE_NETCDF</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        <span class="comment">// Create the needed bdy_data_xlo etc ... since we don&#39;t read it in from checkpoint any more</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ad57b63939b19e90b87dd61d3f293b0d7">use_real_bcs</a>) {</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160; </div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;            bdy_time_interval = read_times_from_wrfbdy(<a class="code" href="classERF.html#a7e9040f32464f1a6dee6e0384393451d">nc_bdy_file</a>,</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                                                       bdy_data_xlo,bdy_data_xhi,bdy_data_ylo,bdy_data_yhi,</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                                                       start_bdy_time);</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;            Real dT = bdy_time_interval;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160; </div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;            Real time_since_start_old = <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0] - start_bdy_time;</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;            <span class="keywordtype">int</span> n_time_old = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(time_since_start_old /  dT);</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160; </div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;            <span class="comment">// I don&#39;t think this works if lev &gt; 0 ...?</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;            AMREX_ALWAYS_ASSERT(finest_level == 0);</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;            <span class="keywordtype">int</span> lev = 0;</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;            <span class="keywordtype">bool</span> use_moist = (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> != MoistureType::None);</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> itime = n_time_old; itime &lt; n_time_old+3; itime++)</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;            {</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                read_from_wrfbdy(itime,<a class="code" href="classERF.html#a7e9040f32464f1a6dee6e0384393451d">nc_bdy_file</a>,geom[0].Domain(),</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                                 bdy_data_xlo,bdy_data_xhi,bdy_data_ylo,bdy_data_yhi,</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                                 <a class="code" href="classERF.html#abb15119348ad5399947bc8883084b230">real_width</a>);</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                convert_all_wrfbdy_data(itime, geom[0].Domain(), bdy_data_xlo, bdy_data_xhi, bdy_data_ylo, bdy_data_yhi,</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                                        *<a class="code" href="classERF.html#aed4ae5792dd32adf56d3c052ce79437f">mf_MUB</a>[lev], *<a class="code" href="classERF.html#a8839af37a73c4c2e76bf978a05275ca9">mf_C1H</a>[lev], *<a class="code" href="classERF.html#ad473e8e616ea3f7bf7bf922a0fe16208">mf_C2H</a>[lev],</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                                        <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                                        geom[lev], use_moist);</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;            } <span class="comment">// itime</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        } <span class="comment">// use_real_bcs &amp;&amp; lev == 0</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    } <span class="comment">// end restart</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160; </div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="preprocessor">#ifdef ERF_USE_PARTICLES</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    <span class="comment">/* If using a Lagrangian microphysics model, its particle container has now been</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="comment">       constructed and initialized (calls to micro-&gt;Init). So, add its pointer to</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="comment">       ERF::particleData and remove its name from list of unallocated particle containers. */</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classMicrophysics.html#ac10e6fce2e6cb49373d56ca0e1a5b366">Microphysics::modelType</a>(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a>) == MoistureModelType::Lagrangian) {</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span>&amp; pc_name( <span class="keyword">dynamic_cast&lt;</span>LagrangianMicrophysics&amp;<span class="keyword">&gt;</span>(*micro).getName() );</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span>&amp; pc_ptr( <span class="keyword">dynamic_cast&lt;</span>LagrangianMicrophysics&amp;<span class="keyword">&gt;</span>(*micro).getParticleContainer() );</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        particleData.pushBack(pc_name, pc_ptr);</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        particleData.getNamesUnalloc().remove(pc_name);</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    }</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160; </div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a80ad08512968ec45635df68abe66b1fc">input_bndry_planes</a>) {</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;        <span class="comment">// Read the &quot;time.dat&quot; file to know what data is available</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;read_time_file();</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160; </div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        <span class="comment">// We haven&#39;t populated dt yet, set to 0 to ensure assert doesn&#39;t crash</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;        Real dt_dummy = 0.0;</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;        <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a>-&gt;read_input_files(<a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0],dt_dummy,<a class="code" href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">m_bc_extdir_vals</a>);</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    }</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160; </div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a4e81a09c9f454c680568b7776a3ed90e">custom_rhotheta_forcing</a>)</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    {</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;        <a class="code" href="classERF.html#a87aad7caaf3b575734994b47628a2faf">h_rhotheta_src</a>.resize(max_level+1, Vector&lt;Real&gt;(0));</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        <a class="code" href="classERF.html#a0c1fdcfbc9cbd6cb13e41d1170b161f8">d_rhotheta_src</a>.resize(max_level+1, Gpu::DeviceVector&lt;Real&gt;(0));</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; lev++) {</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> domlen = geom[lev].Domain().length(2);</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;            <a class="code" href="classERF.html#a87aad7caaf3b575734994b47628a2faf">h_rhotheta_src</a>[lev].resize(domlen, 0.0_rt);</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;            <a class="code" href="classERF.html#a0c1fdcfbc9cbd6cb13e41d1170b161f8">d_rhotheta_src</a>[lev].resize(domlen, 0.0_rt);</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;            <a class="code" href="classERF.html#a60e8cb933f237903e3fbcd6376c26db0">prob</a>-&gt;update_rhotheta_sources(<a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0],</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                                          <a class="code" href="classERF.html#a87aad7caaf3b575734994b47628a2faf">h_rhotheta_src</a>[lev], <a class="code" href="classERF.html#a0c1fdcfbc9cbd6cb13e41d1170b161f8">d_rhotheta_src</a>[lev],</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                                          geom[lev], <a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[lev]);</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;        }</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    }</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160; </div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a65faffc1ea490b3934a9df768cfa26f1">have_geo_wind_profile</a>)</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    {</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;        <a class="code" href="classERF.html#a911c70f76cf62f205a1ce152ec4cdb54">h_u_geos</a>.resize(max_level+1, Vector&lt;Real&gt;(0));</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;        <a class="code" href="classERF.html#ac020980af9dbf46be43dd9f7127c06da">d_u_geos</a>.resize(max_level+1, Gpu::DeviceVector&lt;Real&gt;(0));</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        <a class="code" href="classERF.html#a825daede57fae86805edffd85d5d9dab">h_v_geos</a>.resize(max_level+1, Vector&lt;Real&gt;(0));</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;        <a class="code" href="classERF.html#a7d245afb7b3236b5967902f50bf9000b">d_v_geos</a>.resize(max_level+1, Gpu::DeviceVector&lt;Real&gt;(0));</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; lev++) {</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> domlen = geom[lev].Domain().length(2);</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;            <a class="code" href="classERF.html#a911c70f76cf62f205a1ce152ec4cdb54">h_u_geos</a>[lev].resize(domlen, 0.0_rt);</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;            <a class="code" href="classERF.html#ac020980af9dbf46be43dd9f7127c06da">d_u_geos</a>[lev].resize(domlen, 0.0_rt);</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;            <a class="code" href="classERF.html#a825daede57fae86805edffd85d5d9dab">h_v_geos</a>[lev].resize(domlen, 0.0_rt);</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;            <a class="code" href="classERF.html#a7d245afb7b3236b5967902f50bf9000b">d_v_geos</a>[lev].resize(domlen, 0.0_rt);</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a5e8754b29072596a584633734a9f64ef">custom_geostrophic_profile</a>) {</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;                <a class="code" href="classERF.html#a60e8cb933f237903e3fbcd6376c26db0">prob</a>-&gt;update_geostrophic_profile(<a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0],</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                                                 <a class="code" href="classERF.html#a911c70f76cf62f205a1ce152ec4cdb54">h_u_geos</a>[lev], <a class="code" href="classERF.html#ac020980af9dbf46be43dd9f7127c06da">d_u_geos</a>[lev],</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                                                 <a class="code" href="classERF.html#a825daede57fae86805edffd85d5d9dab">h_v_geos</a>[lev], <a class="code" href="classERF.html#a7d245afb7b3236b5967902f50bf9000b">d_v_geos</a>[lev],</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                                                 geom[lev], <a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[lev]);</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="structSolverChoice.html#a1952672901901b0b3a628f2298dc72c2">SolverChoice::mesh_type</a> == MeshType::VariableDz) {</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                    amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Note: 1-D geostrophic wind profile input is not defined for real terrain&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                }</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                <a class="code" href="classERF.html#aab564dd3009ef83466b50db6d997b563">init_geo_wind_profile</a>(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aae719af83409639331018f92be62642b">abl_geo_wind_table</a>,</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;                                      <a class="code" href="classERF.html#a911c70f76cf62f205a1ce152ec4cdb54">h_u_geos</a>[lev], <a class="code" href="classERF.html#ac020980af9dbf46be43dd9f7127c06da">d_u_geos</a>[lev],</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;                                      <a class="code" href="classERF.html#a825daede57fae86805edffd85d5d9dab">h_v_geos</a>[lev], <a class="code" href="classERF.html#a7d245afb7b3236b5967902f50bf9000b">d_v_geos</a>[lev],</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;                                      geom[lev],</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                                      <a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[0]);</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;            }</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;        }</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    }</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160; </div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa2e312b4e6d08797fc3c1b6d67313d48">custom_moisture_forcing</a>)</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    {</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;        <a class="code" href="classERF.html#a3c5eca26a28dda3a981b3581abadfca0">h_rhoqt_src</a>.resize(max_level+1, Vector&lt;Real&gt;(0));</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;        <a class="code" href="classERF.html#a838687881ef3626f932d0e95ceff0e53">d_rhoqt_src</a>.resize(max_level+1, Gpu::DeviceVector&lt;Real&gt;(0));</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; lev++) {</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> domlen = geom[lev].Domain().length(2);</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;            <a class="code" href="classERF.html#a3c5eca26a28dda3a981b3581abadfca0">h_rhoqt_src</a>[lev].resize(domlen, 0.0_rt);</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;            <a class="code" href="classERF.html#a838687881ef3626f932d0e95ceff0e53">d_rhoqt_src</a>[lev].resize(domlen, 0.0_rt);</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;            <a class="code" href="classERF.html#a60e8cb933f237903e3fbcd6376c26db0">prob</a>-&gt;update_rhoqt_sources(<a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0],</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                                       <a class="code" href="classERF.html#a3c5eca26a28dda3a981b3581abadfca0">h_rhoqt_src</a>[lev], <a class="code" href="classERF.html#a838687881ef3626f932d0e95ceff0e53">d_rhoqt_src</a>[lev],</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                                       geom[lev], <a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[lev]);</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;        }</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    }</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160; </div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a596f061b796ada0389c81a6125150b6e">custom_w_subsidence</a>)</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    {</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;        <a class="code" href="classERF.html#a1a5d0d0b4e8c196f56dfab98f245aff5">h_w_subsid</a>.resize(max_level+1, Vector&lt;Real&gt;(0));</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;        <a class="code" href="classERF.html#ac94ddee2f501dbcea2a516284b7119b5">d_w_subsid</a>.resize(max_level+1, Gpu::DeviceVector&lt;Real&gt;(0));</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; lev++) {</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> domlen = geom[lev].Domain().length(2) + 1; <span class="comment">// lives on z-faces</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;            <a class="code" href="classERF.html#a1a5d0d0b4e8c196f56dfab98f245aff5">h_w_subsid</a>[lev].resize(domlen, 0.0_rt);</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;            <a class="code" href="classERF.html#ac94ddee2f501dbcea2a516284b7119b5">d_w_subsid</a>[lev].resize(domlen, 0.0_rt);</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;            <a class="code" href="classERF.html#a60e8cb933f237903e3fbcd6376c26db0">prob</a>-&gt;update_w_subsidence(<a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0],</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                                      <a class="code" href="classERF.html#a1a5d0d0b4e8c196f56dfab98f245aff5">h_w_subsid</a>[lev], <a class="code" href="classERF.html#ac94ddee2f501dbcea2a516284b7119b5">d_w_subsid</a>[lev],</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                                      geom[lev], <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev]);</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;        }</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    }</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160; </div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a5aed4016dd7d17a2d2904c60af59ae9d">rayleigh_damp_U</a> ||<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a1bae456f7b26e8ed50d78ce1af1b5ef0">rayleigh_damp_V</a> ||</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;        <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#abf35af2e52f5c1197264d895396ca59c">rayleigh_damp_W</a> ||<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a06a0dd1c8f7c1ed73a4f8d24b6b31cdf">rayleigh_damp_T</a>)</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    {</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;        <a class="code" href="classERF.html#a039a764a1d942c484e8aea49e87bc046">initRayleigh</a>();</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac1ddc9c301ac98689bf3b7b7184b24e1">init_type</a> == InitType::Input_Sounding)</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;        {</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;            <span class="comment">// Overwrite ubar, vbar, and thetabar with input profiles;</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;            <span class="comment">// wbar is assumed to be 0. Note: the tau coefficient set by</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;            <span class="comment">// prob-&gt;erf_init_rayleigh() is still used</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;            <span class="keywordtype">bool</span> restarting = (!<a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>.empty());</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;            <a class="code" href="classERF.html#a0877d5a0263641c13b92d2d16f47b689">setRayleighRefFromSounding</a>(restarting);</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        }</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    }</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160; </div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <span class="comment">// Read in sponge data from input file</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac066852f06a6409e1638f59868b7c57d">spongeChoice</a>.<a class="code" href="structSpongeChoice.html#a1a41f754595d713df32583f0b0fa606e">sponge_type</a> == <span class="stringliteral">&quot;input_sponge&quot;</span>)</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    {</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;        <a class="code" href="classERF.html#ab26ec4f9c35a519063af2a938c1012e6">initSponge</a>();</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;        <span class="keywordtype">bool</span> restarting = (!<a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>.empty());</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;        <a class="code" href="classERF.html#ae27a45d751287a887769df20dea60633">setSpongeRefFromSounding</a>(restarting);</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    }</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160; </div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#abfd94767b3721755632c45a5ef290544">pert_type</a> == PerturbationType::Source ||</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#abfd94767b3721755632c45a5ef290544">pert_type</a> == PerturbationType::Direct ||</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#abfd94767b3721755632c45a5ef290544">pert_type</a> == PerturbationType::CPM) {</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ad4c61fad53912d1e8d0f774d365bcf0f">is_it_time_for_action</a>(<a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[0], <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0], <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[0], <a class="code" href="classERF.html#a52761522e295887435c10853d8c7dc37">pert_interval</a>, -1.)) {</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;            <a class="code" href="classERF.html#ac1b9cce4a3c1736c4af78f6b0e2143ce">turbPert</a>.<a class="code" href="structTurbulentPerturbation.html#aa7c1ce943bf06d347d762131ec0c24cf">debug</a>(<a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0]);</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;        }</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    }</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160; </div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    <span class="comment">// We only write the file at level 0 for now</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a7c448670f7a5cadd6fe56f7e615c9eb6">output_bndry_planes</a>)</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    {</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;        <span class="comment">// Create the WriteBndryPlanes object so we can handle writing of boundary plane data</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;        <a class="code" href="classERF.html#aa53035f34ba133b86172e180abda4209">m_w2d</a> = std::make_unique&lt;WriteBndryPlanes&gt;(grids,geom);</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160; </div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        Real time = 0.;</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;        <span class="keywordflow">if</span> (time &gt;= <a class="code" href="classERF.html#a87e58f16f44a6cb35d6983ed3fe7d3c1">bndry_output_planes_start_time</a>) {</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;            <span class="keywordtype">bool</span> is_moist = (<a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;Get_Qstate_Moist_Size() &gt; 0);</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;            <a class="code" href="classERF.html#aa53035f34ba133b86172e180abda4209">m_w2d</a>-&gt;write_planes(0, time, <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>, is_moist);</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;        }</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    }</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160; </div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    <span class="comment">// If we are starting from scratch, we have the option to project the initial velocity field</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    <span class="comment">//    regardless of how we initialized.</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    <span class="comment">// pp_inc is used as scratch space here; we zero it out after the projection</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a> == <span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    {</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa7bb7f3c8b475b0e446c271d8aa5497f">project_initial_velocity</a>) {</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;            Real dummy_dt = 1.0;</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a43d0b17f6e155691a1e9474526df3af5">verbose</a> &gt; 0) {</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;                amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Projecting initial velocity field&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;            }</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev)</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;            {</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                <a class="code" href="classERF.html#a8a60eec7b73429ba7bd98341bc4f5a6d">project_velocity</a>(lev, dummy_dt);</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                <a class="code" href="classERF.html#a0c5206542d4193bb687f5271be6fe5e5">pp_inc</a>[lev].setVal(0.);</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                <a class="code" href="classERF.html#a29ce17220e488eb840abc53966c34d46">gradp</a>[lev][<a class="code" href="namespaceGpVars.html#ac972418cf9113d552b162715dae54ebdaecfb8189072456062c3c29c137ec2323">GpVars::gpx</a>].setVal(0.);</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;                <a class="code" href="classERF.html#a29ce17220e488eb840abc53966c34d46">gradp</a>[lev][<a class="code" href="namespaceGpVars.html#ac972418cf9113d552b162715dae54ebda8b32fb9218fd4f10ccc5736e6a61a72d">GpVars::gpy</a>].setVal(0.);</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                <a class="code" href="classERF.html#a29ce17220e488eb840abc53966c34d46">gradp</a>[lev][<a class="code" href="namespaceGpVars.html#ac972418cf9113d552b162715dae54ebda7490c53ed57352abcd4a219cd12bf517">GpVars::gpz</a>].setVal(0.);</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;            }</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;        }</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    }</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160; </div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    <span class="comment">// Copy from new into old just in case</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev)</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    {</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;        <span class="keyword">auto</span>&amp; lev_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev];</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;        <span class="keyword">auto</span>&amp; lev_old = <a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev];</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160; </div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        <span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;        <span class="comment">// Physical bc&#39;s at domain boundary</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;        <span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;        IntVect ngvect_cons = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nGrowVect();</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;        IntVect ngvect_vels = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].nGrowVect();</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160; </div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;        <span class="keywordtype">int</span> ncomp_cons = lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nComp();</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;        <span class="keywordtype">bool</span> do_fb     = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160; </div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;<span class="preprocessor">#ifdef ERF_USE_NETCDF</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;        <span class="comment">// We call this here because it is an ERF routine</span></div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ad57b63939b19e90b87dd61d3f293b0d7">use_real_bcs</a> &amp;&amp; (lev==0)) {</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;            <span class="keywordtype">int</span> icomp_cons = 0;</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;            <span class="keywordtype">bool</span> cons_only = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;            Vector&lt;MultiFab*&gt; mfs_vec = {&amp;lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],&amp;lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;                                         &amp;lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],&amp;lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>]};</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;            fill_from_realbdy(mfs_vec,<a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev],cons_only,icomp_cons,</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;                              ncomp_cons,ngvect_cons,ngvect_vels);</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;            do_fb = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    }</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160; </div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;        (*<a class="code" href="classERF.html#a2e9b04043853d25f2d76edbc0bed2e72">physbcs_cons</a>[lev])(lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],0,ncomp_cons,</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;                             ngvect_cons,<a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev],<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>,do_fb);</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;        (   *<a class="code" href="classERF.html#a64e55e5ae9df06433146db657eb9e72e">physbcs_u</a>[lev])(lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;                             ngvect_vels,<a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev],<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>,do_fb);</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;        (   *<a class="code" href="classERF.html#a79231b5cfd4576a742e46ae0082b5121">physbcs_v</a>[lev])(lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                             ngvect_vels,<a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev],<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a>,do_fb);</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;        (   *<a class="code" href="classERF.html#a45c8ecd777f47732993777a0afb8e140">physbcs_w</a>[lev])(lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>],lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;                             ngvect_vels,<a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev],<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa03b35ec9e83f34bb1349a86965d34e34">BCVars::zvel_bc</a>,do_fb);</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160; </div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;        MultiFab::Copy(lev_old[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],0,0,ncomp_cons,lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nGrowVect());</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;        MultiFab::Copy(lev_old[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],0,0,         1,lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].nGrowVect());</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;        MultiFab::Copy(lev_old[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],0,0,         1,lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].nGrowVect());</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;        MultiFab::Copy(lev_old[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>],lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>],0,0,         1,lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].nGrowVect());</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    }</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160; </div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    <span class="comment">// Compute the minimum dz in the domain at each level (to be used for setting the timestep)</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    <a class="code" href="classERF.html#a15db5266359edba700f523f16da303a7">dz_min</a>.resize(max_level+1);</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev)</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    {</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;        <a class="code" href="classERF.html#a15db5266359edba700f523f16da303a7">dz_min</a>[lev] = geom[lev].CellSize(2);</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="structSolverChoice.html#a1952672901901b0b3a628f2298dc72c2">SolverChoice::mesh_type</a> != MeshType::ConstantDz ) {</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;            <a class="code" href="classERF.html#a15db5266359edba700f523f16da303a7">dz_min</a>[lev] *= (*<a class="code" href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">detJ_cc</a>[lev]).min(0);</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;        }</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    }</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160; </div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;    <a class="code" href="classERF.html#aa38639155e79bab8a0c283aa6e7afa81">ComputeDt</a>();</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160; </div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    <span class="comment">// Check the viscous limit</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    <a class="code" href="structDiffChoice.html">DiffChoice</a> dc = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a396122e87a3d15c4ec8666d7dd18c095">diffChoice</a>;</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    <span class="keywordflow">if</span> (dc.<a class="code" href="structDiffChoice.html#aed5c75ec58e358a735d97869147b2baf">molec_diff_type</a> == <a class="code" href="ERF__DiffStruct_8H.html#a84e6bfbbb8e490790c506939b364f735acb17869fe51048b5a5c4c6106551a255">MolecDiffType::Constant</a> ||</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;        dc.<a class="code" href="structDiffChoice.html#aed5c75ec58e358a735d97869147b2baf">molec_diff_type</a> == <a class="code" href="ERF__DiffStruct_8H.html#a84e6bfbbb8e490790c506939b364f735a6f0229db491c3b01860363456dc57288">MolecDiffType::ConstantAlpha</a>) {</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;        Real delta = std::min({geom[finest_level].CellSize(0),</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;                               geom[finest_level].CellSize(1),</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;                               <a class="code" href="classERF.html#a15db5266359edba700f523f16da303a7">dz_min</a>[finest_level]});</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;        <span class="keywordflow">if</span> (dc.<a class="code" href="structDiffChoice.html#afaba089738f1b77e58dd43bf1c964817">dynamic_viscosity</a> == 0) {</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;            Print() &lt;&lt; <span class="stringliteral">&quot;Note: Molecular diffusion specified but dynamic_viscosity has not been specified&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;            Real nu = dc.<a class="code" href="structDiffChoice.html#afaba089738f1b77e58dd43bf1c964817">dynamic_viscosity</a> / dc.<a class="code" href="structDiffChoice.html#a4df179b6e7d84efc89a22ac5900f98c8">rho0_trans</a>;</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;            Real viscous_limit = 0.5 * delta*delta / nu;</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;            Print() &lt;&lt; <span class="stringliteral">&quot;Viscous CFL is &quot;</span> &lt;&lt; <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[finest_level] / viscous_limit &lt;&lt; std::endl;</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a393b540493795b8c6ee0f64634b8b815">fixed_dt</a>[finest_level] &gt;= viscous_limit) {</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;                Warning(<span class="stringliteral">&quot;Specified fixed_dt is above the viscous limit&quot;</span>);</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[finest_level] &gt;= viscous_limit) {</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;                Warning(<span class="stringliteral">&quot;Adaptive dt based on convective CFL only is above the viscous limit&quot;</span>);</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;            }</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;        }</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    }</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160; </div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    <span class="comment">// Fill ghost cells/faces</span></div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev)</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    {</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;        <span class="keywordflow">if</span> (lev &gt; 0 &amp;&amp; <a class="code" href="classERF.html#ad9084179f7384e10a519989ffd51fd34">cf_width</a> &gt;= 0) {</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;            <a class="code" href="classERF.html#adc284f421c5fd9dd15c0e5cbe4ff5fc8">Construct_ERFFillPatchers</a>(lev);</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;        }</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160; </div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;        <span class="keyword">auto</span>&amp; lev_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev];</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160; </div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;        <span class="comment">// Fill boundary conditions -- not sure why we need this here</span></div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;        <span class="keywordtype">bool</span> fillset = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;        <span class="keywordflow">if</span> (lev == 0) {</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;            <a class="code" href="classERF.html#afded764725240c356faffa97dddbe03d">FillPatch</a>(lev, <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev],</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;                      {&amp;lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],&amp;lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],&amp;lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],&amp;lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>]});</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;            <a class="code" href="classERF.html#afded764725240c356faffa97dddbe03d">FillPatch</a>(lev, <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev],</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;                      {&amp;lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],&amp;lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],&amp;lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],&amp;lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>]},</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;                      {&amp;lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],&amp;<a class="code" href="classERF.html#a01f3db32272f53dc68025f0a98195e57">rU_new</a>[lev],&amp;<a class="code" href="classERF.html#a54e37988486ef96e55e84bd8e91bb688">rV_new</a>[lev],&amp;<a class="code" href="classERF.html#aa46c0b0d20525aed10f447923e54dde7">rW_new</a>[lev]},</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;                      <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev], <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev],</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;                      fillset);</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;        }</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160; </div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;        <span class="comment">// We do this here to make sure level (lev-1) boundary conditions are filled</span></div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;        <span class="comment">// before we interpolate to level (lev) ghost cells</span></div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;        <span class="keywordflow">if</span> (lev &lt; finest_level) {</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;            <span class="keyword">auto</span>&amp; lev_old = <a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev];</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;            MultiFab::Copy(lev_old[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],0,0,lev_old[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nComp(),lev_old[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nGrowVect());</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;            MultiFab::Copy(lev_old[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],0,0,lev_old[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].nComp(),lev_old[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].nGrowVect());</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;            MultiFab::Copy(lev_old[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],0,0,lev_old[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].nComp(),lev_old[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].nGrowVect());</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;            MultiFab::Copy(lev_old[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>],lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>],0,0,lev_old[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].nComp(),lev_old[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].nGrowVect());</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;        }</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160; </div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;        <span class="comment">// We fill the ghost cell values of the base state in case it wasn&#39;t done in the initialization</span></div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;        <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160; </div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;        <span class="comment">// For moving terrain only</span></div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> == TerrainType::MovingFittedMesh) {</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;            MultiFab::Copy(<a class="code" href="classERF.html#a37b2a4257df8ff53d4450de47f16ace1">base_state_new</a>[lev],<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev],0,0,<a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91a088c1232c30770df1105d3cdf66ee582">BaseState::num_comps</a>,<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].nGrowVect());</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;            <a class="code" href="classERF.html#a37b2a4257df8ff53d4450de47f16ace1">base_state_new</a>[lev].FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;        }</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160; </div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    }</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160; </div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    <span class="comment">// Allow idealized cases over water, used to set lmask</span></div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    ParmParse <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>(<span class="stringliteral">&quot;erf&quot;</span>);</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    <span class="keywordtype">int</span> is_land;</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev)</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    {</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;is_land&quot;</span>, is_land, lev)) {</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;            <span class="keywordflow">if</span> (is_land == 1) {</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;                amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Level &quot;</span> &lt;&lt; lev &lt;&lt; <span class="stringliteral">&quot; is land&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (is_land == 0) {</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;                amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Level &quot;</span> &lt;&lt; lev &lt;&lt; <span class="stringliteral">&quot; is water&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;                Error(<span class="stringliteral">&quot;is_land should be 0 or 1&quot;</span>);</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;            }</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;            <a class="code" href="classERF.html#a3f3e29874221e43e13e2a431e77e0e4e">lmask_lev</a>[lev][0]-&gt;setVal(is_land);</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;            <a class="code" href="classERF.html#a3f3e29874221e43e13e2a431e77e0e4e">lmask_lev</a>[lev][0]-&gt;FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;        }</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    }</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160; </div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;<span class="preprocessor">#ifdef ERF_USE_WW3_COUPLING</span></div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    <span class="keywordtype">int</span> my_lev = 0;</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    amrex::Print() &lt;&lt;  <span class="stringliteral">&quot; About to call send_to_ww3 from ERF.cpp&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    send_to_ww3(my_lev);</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    amrex::Print() &lt;&lt;  <span class="stringliteral">&quot; About to call read_waves from ERF.cpp&quot;</span>  &lt;&lt; std::endl;</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    read_waves(my_lev);</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;   <span class="comment">// send_to_ww3(my_lev);</span></div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160; </div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    <span class="comment">// Configure SurfaceLayer params if used</span></div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    <span class="comment">// NOTE: we must set up the MOST routine after calling FillPatch</span></div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    <span class="comment">//       in order to have lateral ghost cells filled (MOST + terrain interp).</span></div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[Orientation(Direction::z,Orientation::low)] == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9af69483cb4bb9623dc65e76ce5bd0a3d5">ERF_BC::surface_layer</a>)</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    {</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;        <span class="keywordtype">bool</span> rotate = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ae6a9fda53f08dbed04adb4c63dc3176e">use_rotate_surface_flux</a>;</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;        <span class="keywordflow">if</span> (rotate) {</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;            Print() &lt;&lt; <span class="stringliteral">&quot;Using surface layer model with stress rotations&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;        }</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160; </div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;        <span class="comment">// This constructor will make the ABLMost object but not allocate the arrays at each level.</span></div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;        <a class="code" href="classERF.html#ac50bb696daf587e13f9a1e57c687375e">m_SurfaceLayer</a> = std::make_unique&lt;SurfaceLayer&gt;(geom, rotate, <a class="code" href="classERF.html#a59df30e7a5537c8543bb00772bd98b58">pp_prefix</a>, <a class="code" href="classERF.html#a521d1faf157e3bccc86c0f26ee923576">Qv_prim</a>,</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;                                                        <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>, <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a></div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;#ifdef ERF_USE_NETCDF</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;                                                        ,start_bdy_time, bdy_time_interval</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;#endif</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;                                                        );</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;        <span class="comment">// This call will allocate the arrays at each level. If we regrid later, either changing</span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;        <span class="comment">// the number of level sor just the grids at each existing level, we will call an update routine</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;        <span class="comment">// to redefine the internal arrays in m_SurfaceLayer.</span></div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;        <span class="keywordtype">int</span> nlevs = geom.size();</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt; nlevs; lev++)</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;        {</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;            Vector&lt;MultiFab*&gt; mfv_old = {&amp;<a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], &amp;<a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;                                         &amp;<a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>], &amp;<a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>]};</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;            <a class="code" href="classERF.html#ac50bb696daf587e13f9a1e57c687375e">m_SurfaceLayer</a>-&gt;make_SurfaceLayer_at_level(lev,nlevs,</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                                                       mfv_old, <a class="code" href="classERF.html#a71629ae2fda396472198691b75d83b2e">Theta_prim</a>[lev], <a class="code" href="classERF.html#a521d1faf157e3bccc86c0f26ee923576">Qv_prim</a>[lev],</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;                                                       <a class="code" href="classERF.html#a57d8432920785f8e58cf11a3232d76b5">Qr_prim</a>[lev], <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev],</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;                                                       <a class="code" href="classERF.html#aef05cf88e9e9d2b56112336761493977">Hwave</a>[lev].get(),<a class="code" href="classERF.html#ad67b414a1a8b5bab6edeaf574f922825">Lwave</a>[lev].get(),<a class="code" href="classERF.html#a327d704704abd516be19339cb2d226f9">eddyDiffs_lev</a>[lev].get(),</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;                                                       <a class="code" href="classERF.html#ad03da3399e893728741fac33100ce476">lsm_data</a>[lev], <a class="code" href="classERF.html#aa5f6a6ceae0087393f386649d8bbbc31">lsm_flux</a>[lev], <a class="code" href="classERF.html#a5a5395054a212d8f3fc577562c14b66e">sst_lev</a>[lev],</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;                                                       <a class="code" href="classERF.html#af89fb8b555dde334c978cdfd3fcd9d07">tsk_lev</a>[lev], <a class="code" href="classERF.html#a3f3e29874221e43e13e2a431e77e0e4e">lmask_lev</a>[lev]);</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;        }</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160; </div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160; </div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a> != <span class="stringliteral">&quot;&quot;</span>) {</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;            <span class="comment">// Update surface fields if needed (and available)</span></div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;            <a class="code" href="classERF.html#afdd04d6a1c2103e654f0cb6eda62436d">ReadCheckpointFileSurfaceLayer</a>();</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;        }</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160; </div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;        <span class="comment">// We now configure ABLMost params here so that we can print the averages at t=0</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;        <span class="comment">// Note we don&#39;t fill ghost cells here because this is just for diagnostics</span></div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev)</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;        {</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;            Real time  = <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev];</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;            IntVect <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a> = <a class="code" href="classERF.html#a71629ae2fda396472198691b75d83b2e">Theta_prim</a>[lev]-&gt;nGrowVect();</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160; </div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;            MultiFab::Copy(  *<a class="code" href="classERF.html#a71629ae2fda396472198691b75d83b2e">Theta_prim</a>[lev], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], <a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>, 0, 1, <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;            MultiFab::Divide(*<a class="code" href="classERF.html#a71629ae2fda396472198691b75d83b2e">Theta_prim</a>[lev], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],      <a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>, 0, 1, <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160; </div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> != MoistureType::None) {</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;                <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a> = <a class="code" href="classERF.html#a521d1faf157e3bccc86c0f26ee923576">Qv_prim</a>[lev]-&gt;nGrowVect();</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160; </div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;                MultiFab::Copy(  *<a class="code" href="classERF.html#a521d1faf157e3bccc86c0f26ee923576">Qv_prim</a>[lev], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], <a class="code" href="ERF__IndexDefines_8H.html#aa965e9988f14d5d2a5aef4a942168a15">RhoQ1_comp</a>, 0, 1, <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;                MultiFab::Divide(*<a class="code" href="classERF.html#a521d1faf157e3bccc86c0f26ee923576">Qv_prim</a>[lev], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],   <a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>, 0, 1, <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160; </div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;                <span class="keywordtype">int</span> rhoqr_comp = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a1d9237205fd632dcde1599511f203131">RhoQr_comp</a>;</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;                <span class="keywordflow">if</span> (rhoqr_comp &gt; -1) {</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;                    MultiFab::Copy(  *<a class="code" href="classERF.html#a57d8432920785f8e58cf11a3232d76b5">Qr_prim</a>[lev], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], rhoqr_comp, 0, 1, <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;                    MultiFab::Divide(*<a class="code" href="classERF.html#a57d8432920785f8e58cf11a3232d76b5">Qr_prim</a>[lev], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],   <a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>, 0, 1, <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;                    <a class="code" href="classERF.html#a57d8432920785f8e58cf11a3232d76b5">Qr_prim</a>[lev]-&gt;setVal(0.0);</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;                }</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;            }</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;            <a class="code" href="classERF.html#ac50bb696daf587e13f9a1e57c687375e">m_SurfaceLayer</a>-&gt;update_mac_ptrs(lev, <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>, <a class="code" href="classERF.html#a71629ae2fda396472198691b75d83b2e">Theta_prim</a>, <a class="code" href="classERF.html#a521d1faf157e3bccc86c0f26ee923576">Qv_prim</a>, <a class="code" href="classERF.html#a57d8432920785f8e58cf11a3232d76b5">Qr_prim</a>);</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160; </div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a> == <span class="stringliteral">&quot;&quot;</span>) {</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;                <span class="comment">// Only do this if starting from scratch; if restarting, then</span></div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;                <span class="comment">// we don&#39;t want to call update_fluxes multiple times because</span></div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;                <span class="comment">// it will change u* and theta* from their previous values</span></div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;                <a class="code" href="classERF.html#ac50bb696daf587e13f9a1e57c687375e">m_SurfaceLayer</a>-&gt;update_pblh(lev, <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>, <a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[lev].get(),</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;                                            <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a9ac649bbebc73403e291d2af180d4061">RhoQv_comp</a>,</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;                                            <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a5dc385a342ac6c50e0f9a638a0e31f9f">RhoQc_comp</a>,</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;                                            <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a1d9237205fd632dcde1599511f203131">RhoQr_comp</a>);</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;                <a class="code" href="classERF.html#ac50bb696daf587e13f9a1e57c687375e">m_SurfaceLayer</a>-&gt;update_fluxes(lev, time);</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;            }</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;        }</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    } <span class="comment">// end if (phys_bc_type[Orientation(Direction::z,Orientation::low)] == ERF_BC::surface_layer)</span></div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160; </div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    <span class="comment">// Update micro vars before first plot file</span></div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> != MoistureType::None) {</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev) <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;Update_Micro_Vars_Lev(lev, <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>]);</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;    }</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160; </div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;    <span class="comment">// Fill time averaged velocities before first plot file</span></div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#af3119a4089367206db9fc3a17664e874">time_avg_vel</a>) {</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;            <a class="code" href="ERF__TimeAvgVel_8cpp.html#a2241063c19e843eaaa749c3b51b6b0fe">Time_Avg_Vel_atCC</a>(<a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[lev], <a class="code" href="classERF.html#a6837423e9248e923fcaa1987b59d8160">t_avg_cnt</a>[lev], <a class="code" href="classERF.html#a3e146164ca6929ec6d4984b6a3f43c81">vel_t_avg</a>[lev].get(),</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;                              <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;                              <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;                              <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>]);</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;        }</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    }</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160; </div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;    <span class="comment">// check for additional plotting variables that are available after particle containers</span></div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    <span class="comment">// are setup.</span></div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    <span class="keyword">const</span> std::string&amp; pv1 = <span class="stringliteral">&quot;plot_vars_1&quot;</span>; <a class="code" href="classERF.html#a7758f75dc7c9029eddc4c58ac0567654">appendPlotVariables</a>(pv1,<a class="code" href="classERF.html#a6865cf87abbb5aab0db00ff3b1ce94ac">plot_var_names_1</a>);</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    <span class="keyword">const</span> std::string&amp; pv2 = <span class="stringliteral">&quot;plot_vars_2&quot;</span>; <a class="code" href="classERF.html#a7758f75dc7c9029eddc4c58ac0567654">appendPlotVariables</a>(pv2,<a class="code" href="classERF.html#a79705c02d6f25fbdcec14ca2432e5da1">plot_var_names_2</a>);</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160; </div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>.empty() &amp;&amp; (<a class="code" href="classERF.html#a69a3f925e95ec4244b0257f9de16d65a">m_check_int</a> &gt; 0 || <a class="code" href="classERF.html#a5fbf17cfc8d9e5b994783e05ec3594b2">m_check_per</a> &gt; 0.) )</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;    {</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;        <a class="code" href="classERF.html#ad101fd46096db2d6b21544bfede6551f">WriteCheckpointFile</a>();</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;        <a class="code" href="classERF.html#a02722d16f3c26efe590702200f1296d7">last_check_file_step</a> = 0;</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    }</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160; </div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;    <span class="keywordflow">if</span> ( (<a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>.empty()) ||</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;         (!<a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>.empty() &amp;&amp; <a class="code" href="classERF.html#adc00038dfe4c332e5d15f621184c69e8">plot_file_on_restart</a>) )</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    {</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a57cfb4bfead8525174646964992c7e69">m_plot_int_1</a> &gt; 0 || <a class="code" href="classERF.html#a3167adc9518cce649a90ab82e9f9c85d">m_plot_per_1</a> &gt; 0.)</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;        {</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;            <a class="code" href="classERF.html#a98cccb83ca76c44d6ae583d051e76faf">WritePlotFile</a>(1,<a class="code" href="classERF.html#a184511b7b9b7d4beef453f5d5d679c54">plotfile_type_1</a>,<a class="code" href="classERF.html#a6865cf87abbb5aab0db00ff3b1ce94ac">plot_var_names_1</a>);</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;            <a class="code" href="classERF.html#a7d54d3f2317d06a8dfcde4f65cfc3e92">last_plot_file_step_1</a> = <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[0];</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;        }</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ad3311c9ceacd17f34bdb5e03cefa33b3">m_plot_int_2</a> &gt; 0 || <a class="code" href="classERF.html#aff879a9c686293a10a3a03027b765c51">m_plot_per_2</a> &gt; 0.)</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;        {</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;            <a class="code" href="classERF.html#a98cccb83ca76c44d6ae583d051e76faf">WritePlotFile</a>(2,<a class="code" href="classERF.html#a980e94505df2ee0925612b004126df77">plotfile_type_2</a>,<a class="code" href="classERF.html#a79705c02d6f25fbdcec14ca2432e5da1">plot_var_names_2</a>);</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;            <a class="code" href="classERF.html#a09017292c9943ac2ed20ce7ed5c3c767">last_plot_file_step_2</a> = <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[0];</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;        }</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a2420086cf8dc54d9507c40358930f521">m_subvol_int</a> &gt; 0 || <a class="code" href="classERF.html#a595273f0f44d0e481a2da65263e5c2ae">m_subvol_per</a> &gt; 0.) {</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;            <a class="code" href="classERF.html#a3849ef0f90b5798c571259313a3d501a">WriteSubvolume</a>();</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;            <a class="code" href="classERF.html#a8536c38a2a5f44a5719cad3c44d0d438">last_subvol</a> = <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[0];</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;        }</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    }</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160; </div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    <span class="comment">// Set these up here because we need to know which MPI rank &quot;cell&quot; is on...</span></div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.contains(<span class="stringliteral">&quot;data_log&quot;</span>))</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    {</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;        <span class="keywordtype">int</span> num_datalogs = <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.countval(<span class="stringliteral">&quot;data_log&quot;</span>);</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;        <a class="code" href="classERF.html#a1cade630b005dbcc0f644987ef3db287">datalog</a>.resize(num_datalogs);</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;        <a class="code" href="classERF.html#a9248a4eb025c2647e003f838cba52a21">datalogname</a>.resize(num_datalogs);</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.queryarr(<span class="stringliteral">&quot;data_log&quot;</span>,<a class="code" href="classERF.html#a9248a4eb025c2647e003f838cba52a21">datalogname</a>,0,num_datalogs);</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num_datalogs; i++) {</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;            <a class="code" href="classERF.html#a2486b49bb0d7917f812318822e42a03c">setRecordDataInfo</a>(i,<a class="code" href="classERF.html#a9248a4eb025c2647e003f838cba52a21">datalogname</a>[i]);</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;        }</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;    }</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160; </div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.contains(<span class="stringliteral">&quot;der_data_log&quot;</span>))</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    {</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;        <span class="keywordtype">int</span> num_der_datalogs = <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.countval(<span class="stringliteral">&quot;der_data_log&quot;</span>);</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;        <a class="code" href="classERF.html#ab33e7fff801543a43961ca6d7cac818f">der_datalog</a>.resize(num_der_datalogs);</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;        <a class="code" href="classERF.html#a9e7650abd3df579a98be0c750aa61ba8">der_datalogname</a>.resize(num_der_datalogs);</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.queryarr(<span class="stringliteral">&quot;der_data_log&quot;</span>,<a class="code" href="classERF.html#a9e7650abd3df579a98be0c750aa61ba8">der_datalogname</a>,0,num_der_datalogs);</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num_der_datalogs; i++) {</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;            <a class="code" href="classERF.html#a967434ca06be557118b7a4a27a0b6f1f">setRecordDerDataInfo</a>(i,<a class="code" href="classERF.html#a9e7650abd3df579a98be0c750aa61ba8">der_datalogname</a>[i]);</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;        }</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;    }</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160; </div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.contains(<span class="stringliteral">&quot;energy_data_log&quot;</span>))</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;    {</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;        <span class="keywordtype">int</span> num_energy_datalogs = <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.countval(<span class="stringliteral">&quot;energy_data_log&quot;</span>);</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;        <a class="code" href="classERF.html#ab546bcca3968440c6c24097f59b87f23">tot_e_datalog</a>.resize(num_energy_datalogs);</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;        <a class="code" href="classERF.html#a7bba2a8c0e4d0a0d5a6478301bf6c3fa">tot_e_datalogname</a>.resize(num_energy_datalogs);</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.queryarr(<span class="stringliteral">&quot;energy_data_log&quot;</span>,<a class="code" href="classERF.html#a7bba2a8c0e4d0a0d5a6478301bf6c3fa">tot_e_datalogname</a>,0,num_energy_datalogs);</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num_energy_datalogs; i++) {</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;            <a class="code" href="classERF.html#ac1a50d2d5abc5bd1d51417583184ac52">setRecordEnergyDataInfo</a>(i,<a class="code" href="classERF.html#a7bba2a8c0e4d0a0d5a6478301bf6c3fa">tot_e_datalogname</a>[i]);</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;        }</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;    }</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160; </div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a31c93846e0129221632347d2378e881d">rad_type</a> != RadiationType::None)</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;    {</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;        <span class="comment">// Create data log for radiation model if requested</span></div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;        <a class="code" href="classERF.html#a609b41a1de9c6b28f23dcdc6843f9ef5">rad</a>[0]-&gt;setupDataLog();</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;    }</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160; </div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160; </div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>.empty() &amp;&amp; <a class="code" href="classERF.html#a633cd0b44d2e38f02c23e953aecd69eb">profile_int</a> &gt; 0) {</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a65f19c55c8d3669445866a1c3bbb628d">destag_profiles</a>) {</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;            <span class="comment">// all variables cell-centered</span></div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;            <a class="code" href="classERF.html#a55eae94c5363e227b571739738bb26b7">write_1D_profiles</a>(<a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0]);</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;            <span class="comment">// some variables staggered</span></div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;            <a class="code" href="classERF.html#a39efa3a0f3ae3deb7a43f4ce110ee49a">write_1D_profiles_stag</a>(<a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0]);</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;        }</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    }</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160; </div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.contains(<span class="stringliteral">&quot;sample_point_log&quot;</span>) &amp;&amp; <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.contains(<span class="stringliteral">&quot;sample_point&quot;</span>))</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;    {</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;        <span class="keywordtype">int</span> lev = 0;</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160; </div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;        <span class="keywordtype">int</span> num_samplepts = <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.countval(<span class="stringliteral">&quot;sample_point&quot;</span>) / AMREX_SPACEDIM;</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;        <span class="keywordflow">if</span> (num_samplepts &gt; 0) {</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;            Vector&lt;int&gt; index; index.resize(num_samplepts*AMREX_SPACEDIM);</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;            <a class="code" href="classERF.html#ae8a57b7fbf5a67c99d04b7d4f43ad100">samplepoint</a>.resize(num_samplepts);</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160; </div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;            <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.queryarr(<span class="stringliteral">&quot;sample_point&quot;</span>,index,0,num_samplepts*AMREX_SPACEDIM);</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num_samplepts; i++) {</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;                IntVect iv(index[AMREX_SPACEDIM*i+0],index[AMREX_SPACEDIM*i+1],index[AMREX_SPACEDIM*i+2]);</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;                <a class="code" href="classERF.html#ae8a57b7fbf5a67c99d04b7d4f43ad100">samplepoint</a>[i] = iv;</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;            }</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;        }</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160; </div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;        <span class="keywordtype">int</span> num_sampleptlogs = <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.countval(<span class="stringliteral">&quot;sample_point_log&quot;</span>);</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;        AMREX_ALWAYS_ASSERT(num_sampleptlogs == num_samplepts);</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;        <span class="keywordflow">if</span> (num_sampleptlogs &gt; 0) {</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;            <a class="code" href="classERF.html#a9737ddb0de6b9e8a5b17c109d5ad3e08">sampleptlog</a>.resize(num_sampleptlogs);</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;            <a class="code" href="classERF.html#a8fbfa8bb47c0a3b53e244081aa1e8ad3">sampleptlogname</a>.resize(num_sampleptlogs);</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;            <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.queryarr(<span class="stringliteral">&quot;sample_point_log&quot;</span>,<a class="code" href="classERF.html#a8fbfa8bb47c0a3b53e244081aa1e8ad3">sampleptlogname</a>,0,num_sampleptlogs);</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160; </div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num_sampleptlogs; i++) {</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;                <a class="code" href="classERF.html#af8d930dce1b926ecc3bdc6787dd47818">setRecordSamplePointInfo</a>(i,lev,<a class="code" href="classERF.html#ae8a57b7fbf5a67c99d04b7d4f43ad100">samplepoint</a>[i],<a class="code" href="classERF.html#a8fbfa8bb47c0a3b53e244081aa1e8ad3">sampleptlogname</a>[i]);</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;            }</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;        }</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160; </div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;    }</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160; </div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.contains(<span class="stringliteral">&quot;sample_line_log&quot;</span>) &amp;&amp; <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.contains(<span class="stringliteral">&quot;sample_line&quot;</span>))</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;    {</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;        <span class="keywordtype">int</span> lev = 0;</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160; </div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;        <span class="keywordtype">int</span> num_samplelines = <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.countval(<span class="stringliteral">&quot;sample_line&quot;</span>) / AMREX_SPACEDIM;</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;        <span class="keywordflow">if</span> (num_samplelines &gt; 0) {</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;            Vector&lt;int&gt; index; index.resize(num_samplelines*AMREX_SPACEDIM);</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;            <a class="code" href="classERF.html#a0fa1582bb13357895d2aba91b695624a">sampleline</a>.resize(num_samplelines);</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160; </div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;            <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.queryarr(<span class="stringliteral">&quot;sample_line&quot;</span>,index,0,num_samplelines*AMREX_SPACEDIM);</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num_samplelines; i++) {</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;                IntVect iv(index[AMREX_SPACEDIM*i+0],index[AMREX_SPACEDIM*i+1],index[AMREX_SPACEDIM*i+2]);</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;                <a class="code" href="classERF.html#a0fa1582bb13357895d2aba91b695624a">sampleline</a>[i] = iv;</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;            }</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;        }</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160; </div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;        <span class="keywordtype">int</span> num_samplelinelogs = <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.countval(<span class="stringliteral">&quot;sample_line_log&quot;</span>);</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;        AMREX_ALWAYS_ASSERT(num_samplelinelogs == num_samplelines);</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;        <span class="keywordflow">if</span> (num_samplelinelogs &gt; 0) {</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;            <a class="code" href="classERF.html#a4990f1796b65ec8ee602f177a66afc3e">samplelinelog</a>.resize(num_samplelinelogs);</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;            <a class="code" href="classERF.html#a0553967f1131860bb8ecb47c0f192eaa">samplelinelogname</a>.resize(num_samplelinelogs);</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;            <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.queryarr(<span class="stringliteral">&quot;sample_line_log&quot;</span>,<a class="code" href="classERF.html#a0553967f1131860bb8ecb47c0f192eaa">samplelinelogname</a>,0,num_samplelinelogs);</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160; </div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num_samplelinelogs; i++) {</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;                <a class="code" href="classERF.html#ae1a8856961aaee53016122facba03dbe">setRecordSampleLineInfo</a>(i,lev,<a class="code" href="classERF.html#a0fa1582bb13357895d2aba91b695624a">sampleline</a>[i],<a class="code" href="classERF.html#a0553967f1131860bb8ecb47c0f192eaa">samplelinelogname</a>[i]);</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;            }</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;        }</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160; </div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;    }</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160; </div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ad4c61fad53912d1e8d0f774d365bcf0f">is_it_time_for_action</a>(<a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[0], <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0], <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[0], <a class="code" href="classERF.html#a5232e98479611a24fe97994640c61faa">sum_interval</a>, <a class="code" href="classERF.html#a1cf2ba396f4404724824516da4c4a084">sum_per</a>)) {</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;        <a class="code" href="classERF.html#a922892a05ee0c5bccd210a3e5a8599e1">sum_integrated_quantities</a>(<a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0]);</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;        <a class="code" href="classERF.html#a91c184ac7e5889fe785aa846112ce2e6">sum_derived_quantities</a>(<a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0]);</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;        <a class="code" href="classERF.html#a3e5b26e9aeb49e5318eb6cb68ed2ee97">sum_energy_quantities</a>(<a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0]);</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    }</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160; </div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;    <span class="comment">// Create object to do line and plane sampling if needed</span></div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;    <span class="keywordtype">bool</span> do_line = <span class="keyword">false</span>; <span class="keywordtype">bool</span> do_plane = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;do_line_sampling&quot;</span>,do_line); <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;do_plane_sampling&quot;</span>,do_plane);</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    <span class="keywordflow">if</span> (do_line || do_plane) { <a class="code" href="classERF.html#a83ad7f8f4cf9920a6798f3b931355a2f">data_sampler</a> = std::make_unique&lt;SampleData&gt;(do_line, do_plane); }</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160; </div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> == TerrainType::EB ||</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;         <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> == TerrainType::ImmersedForcing)</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    {</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;        <span class="keywordtype">bool</span> write_eb_surface = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;write_eb_surface&quot;</span>, write_eb_surface);</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;        <span class="keywordflow">if</span> (write_eb_surface) <a class="code" href="classERF.html#a31b92a0c6fa4e19ff90feef3611f5f06">WriteMyEBSurface</a>();</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    }</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160; </div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;}</div>
<div class="ttc" id="aERF__DiffStruct_8H_html_a84e6bfbbb8e490790c506939b364f735a6f0229db491c3b01860363456dc57288"><div class="ttname"><a href="ERF__DiffStruct_8H.html#a84e6bfbbb8e490790c506939b364f735a6f0229db491c3b01860363456dc57288">MolecDiffType::ConstantAlpha</a></div><div class="ttdeci">@ ConstantAlpha</div></div>
<div class="ttc" id="aERF__DiffStruct_8H_html_a84e6bfbbb8e490790c506939b364f735acb17869fe51048b5a5c4c6106551a255"><div class="ttname"><a href="ERF__DiffStruct_8H.html#a84e6bfbbb8e490790c506939b364f735acb17869fe51048b5a5c4c6106551a255">MolecDiffType::Constant</a></div><div class="ttdeci">@ Constant</div></div>
<div class="ttc" id="aclassERF_html_a039a764a1d942c484e8aea49e87bc046"><div class="ttname"><a href="classERF.html#a039a764a1d942c484e8aea49e87bc046">ERF::initRayleigh</a></div><div class="ttdeci">void initRayleigh()</div><div class="ttdoc">Initialize Rayleigh damping profiles.</div><div class="ttdef"><b>Definition:</b> ERF_InitRayleigh.cpp:14</div></div>
<div class="ttc" id="aclassERF_html_a0553967f1131860bb8ecb47c0f192eaa"><div class="ttname"><a href="classERF.html#a0553967f1131860bb8ecb47c0f192eaa">ERF::samplelinelogname</a></div><div class="ttdeci">amrex::Vector&lt; std::string &gt; samplelinelogname</div><div class="ttdef"><b>Definition:</b> ERF.H:1426</div></div>
<div class="ttc" id="aclassERF_html_a0877d5a0263641c13b92d2d16f47b689"><div class="ttname"><a href="classERF.html#a0877d5a0263641c13b92d2d16f47b689">ERF::setRayleighRefFromSounding</a></div><div class="ttdeci">void setRayleighRefFromSounding(bool restarting)</div><div class="ttdoc">Set Rayleigh mean profiles from input sounding.</div><div class="ttdef"><b>Definition:</b> ERF_InitRayleigh.cpp:55</div></div>
<div class="ttc" id="aclassERF_html_a0fa1582bb13357895d2aba91b695624a"><div class="ttname"><a href="classERF.html#a0fa1582bb13357895d2aba91b695624a">ERF::sampleline</a></div><div class="ttdeci">amrex::Vector&lt; amrex::IntVect &gt; sampleline</div><div class="ttdef"><b>Definition:</b> ERF.H:1427</div></div>
<div class="ttc" id="aclassERF_html_a1cf2ba396f4404724824516da4c4a084"><div class="ttname"><a href="classERF.html#a1cf2ba396f4404724824516da4c4a084">ERF::sum_per</a></div><div class="ttdeci">static amrex::Real sum_per</div><div class="ttdef"><b>Definition:</b> ERF.H:1034</div></div>
<div class="ttc" id="aclassERF_html_a2486b49bb0d7917f812318822e42a03c"><div class="ttname"><a href="classERF.html#a2486b49bb0d7917f812318822e42a03c">ERF::setRecordDataInfo</a></div><div class="ttdeci">void setRecordDataInfo(int i, const std::string &amp;filename)</div><div class="ttdef"><b>Definition:</b> ERF.H:1336</div></div>
<div class="ttc" id="aclassERF_html_a31b92a0c6fa4e19ff90feef3611f5f06"><div class="ttname"><a href="classERF.html#a31b92a0c6fa4e19ff90feef3611f5f06">ERF::WriteMyEBSurface</a></div><div class="ttdeci">void WriteMyEBSurface()</div><div class="ttdef"><b>Definition:</b> ERF_EBWriteSurface.cpp:5</div></div>
<div class="ttc" id="aclassERF_html_a39efa3a0f3ae3deb7a43f4ce110ee49a"><div class="ttname"><a href="classERF.html#a39efa3a0f3ae3deb7a43f4ce110ee49a">ERF::write_1D_profiles_stag</a></div><div class="ttdeci">void write_1D_profiles_stag(amrex::Real time)</div><div class="ttdef"><b>Definition:</b> ERF_Write1DProfiles_stag.cpp:25</div></div>
<div class="ttc" id="aclassERF_html_a3e5b26e9aeb49e5318eb6cb68ed2ee97"><div class="ttname"><a href="classERF.html#a3e5b26e9aeb49e5318eb6cb68ed2ee97">ERF::sum_energy_quantities</a></div><div class="ttdeci">void sum_energy_quantities(amrex::Real time)</div><div class="ttdef"><b>Definition:</b> ERF_WriteScalarProfiles.cpp:318</div></div>
<div class="ttc" id="aclassERF_html_a4990f1796b65ec8ee602f177a66afc3e"><div class="ttname"><a href="classERF.html#a4990f1796b65ec8ee602f177a66afc3e">ERF::samplelinelog</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; std::fstream &gt; &gt; samplelinelog</div><div class="ttdef"><b>Definition:</b> ERF.H:1425</div></div>
<div class="ttc" id="aclassERF_html_a5232e98479611a24fe97994640c61faa"><div class="ttname"><a href="classERF.html#a5232e98479611a24fe97994640c61faa">ERF::sum_interval</a></div><div class="ttdeci">static int sum_interval</div><div class="ttdef"><b>Definition:</b> ERF.H:1032</div></div>
<div class="ttc" id="aclassERF_html_a52761522e295887435c10853d8c7dc37"><div class="ttname"><a href="classERF.html#a52761522e295887435c10853d8c7dc37">ERF::pert_interval</a></div><div class="ttdeci">static int pert_interval</div><div class="ttdef"><b>Definition:</b> ERF.H:1033</div></div>
<div class="ttc" id="aclassERF_html_a530d2ce59e6fd46e9fb00e4d11eaf737"><div class="ttname"><a href="classERF.html#a530d2ce59e6fd46e9fb00e4d11eaf737">ERF::restart</a></div><div class="ttdeci">void restart()</div><div class="ttdef"><b>Definition:</b> ERF.cpp:1491</div></div>
<div class="ttc" id="aclassERF_html_a55eae94c5363e227b571739738bb26b7"><div class="ttname"><a href="classERF.html#a55eae94c5363e227b571739738bb26b7">ERF::write_1D_profiles</a></div><div class="ttdeci">void write_1D_profiles(amrex::Real time)</div><div class="ttdef"><b>Definition:</b> ERF_Write1DProfiles.cpp:17</div></div>
<div class="ttc" id="aclassERF_html_a633cd0b44d2e38f02c23e953aecd69eb"><div class="ttname"><a href="classERF.html#a633cd0b44d2e38f02c23e953aecd69eb">ERF::profile_int</a></div><div class="ttdeci">int profile_int</div><div class="ttdef"><b>Definition:</b> ERF.H:941</div></div>
<div class="ttc" id="aclassERF_html_a65f19c55c8d3669445866a1c3bbb628d"><div class="ttname"><a href="classERF.html#a65f19c55c8d3669445866a1c3bbb628d">ERF::destag_profiles</a></div><div class="ttdeci">bool destag_profiles</div><div class="ttdef"><b>Definition:</b> ERF.H:942</div></div>
<div class="ttc" id="aclassERF_html_a7758f75dc7c9029eddc4c58ac0567654"><div class="ttname"><a href="classERF.html#a7758f75dc7c9029eddc4c58ac0567654">ERF::appendPlotVariables</a></div><div class="ttdeci">void appendPlotVariables(const std::string &amp;pp_plot_var_names, amrex::Vector&lt; std::string &gt; &amp;plot_var_names)</div><div class="ttdef"><b>Definition:</b> ERF_Plotfile.cpp:182</div></div>
<div class="ttc" id="aclassERF_html_a7bba2a8c0e4d0a0d5a6478301bf6c3fa"><div class="ttname"><a href="classERF.html#a7bba2a8c0e4d0a0d5a6478301bf6c3fa">ERF::tot_e_datalogname</a></div><div class="ttdeci">amrex::Vector&lt; std::string &gt; tot_e_datalogname</div><div class="ttdef"><b>Definition:</b> ERF.H:1419</div></div>
<div class="ttc" id="aclassERF_html_a7c448670f7a5cadd6fe56f7e615c9eb6"><div class="ttname"><a href="classERF.html#a7c448670f7a5cadd6fe56f7e615c9eb6">ERF::output_bndry_planes</a></div><div class="ttdeci">static int output_bndry_planes</div><div class="ttdef"><b>Definition:</b> ERF.H:1090</div></div>
<div class="ttc" id="aclassERF_html_a7e9040f32464f1a6dee6e0384393451d"><div class="ttname"><a href="classERF.html#a7e9040f32464f1a6dee6e0384393451d">ERF::nc_bdy_file</a></div><div class="ttdeci">static std::string nc_bdy_file</div><div class="ttdef"><b>Definition:</b> ERF.H:1049</div></div>
<div class="ttc" id="aclassERF_html_a8202de1f8f372e3e6fdc483447c6a55f"><div class="ttname"><a href="classERF.html#a8202de1f8f372e3e6fdc483447c6a55f">ERF::AverageDown</a></div><div class="ttdeci">void AverageDown()</div><div class="ttdef"><b>Definition:</b> ERF_AverageDown.cpp:16</div></div>
<div class="ttc" id="aclassERF_html_a83ad7f8f4cf9920a6798f3b931355a2f"><div class="ttname"><a href="classERF.html#a83ad7f8f4cf9920a6798f3b931355a2f">ERF::data_sampler</a></div><div class="ttdeci">std::unique_ptr&lt; SampleData &gt; data_sampler</div><div class="ttdef"><b>Definition:</b> ERF.H:1412</div></div>
<div class="ttc" id="aclassERF_html_a87e58f16f44a6cb35d6983ed3fe7d3c1"><div class="ttname"><a href="classERF.html#a87e58f16f44a6cb35d6983ed3fe7d3c1">ERF::bndry_output_planes_start_time</a></div><div class="ttdeci">static amrex::Real bndry_output_planes_start_time</div><div class="ttdef"><b>Definition:</b> ERF.H:1093</div></div>
<div class="ttc" id="aclassERF_html_a8a60eec7b73429ba7bd98341bc4f5a6d"><div class="ttname"><a href="classERF.html#a8a60eec7b73429ba7bd98341bc4f5a6d">ERF::project_velocity</a></div><div class="ttdeci">void project_velocity(int lev, amrex::Real dt)</div><div class="ttdef"><b>Definition:</b> ERF_PoissonSolve.cpp:10</div></div>
<div class="ttc" id="aclassERF_html_a8e758060d3dede9694fbfcabddc17169"><div class="ttname"><a href="classERF.html#a8e758060d3dede9694fbfcabddc17169">ERF::restart_chkfile</a></div><div class="ttdeci">std::string restart_chkfile</div><div class="ttdef"><b>Definition:</b> ERF.H:902</div></div>
<div class="ttc" id="aclassERF_html_a8fbfa8bb47c0a3b53e244081aa1e8ad3"><div class="ttname"><a href="classERF.html#a8fbfa8bb47c0a3b53e244081aa1e8ad3">ERF::sampleptlogname</a></div><div class="ttdeci">amrex::Vector&lt; std::string &gt; sampleptlogname</div><div class="ttdef"><b>Definition:</b> ERF.H:1422</div></div>
<div class="ttc" id="aclassERF_html_a91c184ac7e5889fe785aa846112ce2e6"><div class="ttname"><a href="classERF.html#a91c184ac7e5889fe785aa846112ce2e6">ERF::sum_derived_quantities</a></div><div class="ttdeci">void sum_derived_quantities(amrex::Real time)</div><div class="ttdef"><b>Definition:</b> ERF_WriteScalarProfiles.cpp:187</div></div>
<div class="ttc" id="aclassERF_html_a922892a05ee0c5bccd210a3e5a8599e1"><div class="ttname"><a href="classERF.html#a922892a05ee0c5bccd210a3e5a8599e1">ERF::sum_integrated_quantities</a></div><div class="ttdeci">void sum_integrated_quantities(amrex::Real time)</div><div class="ttdef"><b>Definition:</b> ERF_WriteScalarProfiles.cpp:15</div></div>
<div class="ttc" id="aclassERF_html_a967434ca06be557118b7a4a27a0b6f1f"><div class="ttname"><a href="classERF.html#a967434ca06be557118b7a4a27a0b6f1f">ERF::setRecordDerDataInfo</a></div><div class="ttdeci">void setRecordDerDataInfo(int i, const std::string &amp;filename)</div><div class="ttdef"><b>Definition:</b> ERF.H:1349</div></div>
<div class="ttc" id="aclassERF_html_a9737ddb0de6b9e8a5b17c109d5ad3e08"><div class="ttname"><a href="classERF.html#a9737ddb0de6b9e8a5b17c109d5ad3e08">ERF::sampleptlog</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; std::fstream &gt; &gt; sampleptlog</div><div class="ttdef"><b>Definition:</b> ERF.H:1421</div></div>
<div class="ttc" id="aclassERF_html_aa53035f34ba133b86172e180abda4209"><div class="ttname"><a href="classERF.html#aa53035f34ba133b86172e180abda4209">ERF::m_w2d</a></div><div class="ttdeci">std::unique_ptr&lt; WriteBndryPlanes &gt; m_w2d</div><div class="ttdef"><b>Definition:</b> ERF.H:1152</div></div>
<div class="ttc" id="aclassERF_html_aab564dd3009ef83466b50db6d997b563"><div class="ttname"><a href="classERF.html#aab564dd3009ef83466b50db6d997b563">ERF::init_geo_wind_profile</a></div><div class="ttdeci">void init_geo_wind_profile(const std::string input_file, amrex::Vector&lt; amrex::Real &gt; &amp;u_geos, amrex::Gpu::DeviceVector&lt; amrex::Real &gt; &amp;u_geos_d, amrex::Vector&lt; amrex::Real &gt; &amp;v_geos, amrex::Gpu::DeviceVector&lt; amrex::Real &gt; &amp;v_geos_d, const amrex::Geometry &amp;lgeom, const amrex::Vector&lt; amrex::Real &gt; &amp;zlev_stag)</div><div class="ttdef"><b>Definition:</b> ERF_InitGeowind.cpp:10</div></div>
<div class="ttc" id="aclassERF_html_ab26ec4f9c35a519063af2a938c1012e6"><div class="ttname"><a href="classERF.html#ab26ec4f9c35a519063af2a938c1012e6">ERF::initSponge</a></div><div class="ttdeci">void initSponge()</div><div class="ttdoc">Initialize sponge profiles.</div><div class="ttdef"><b>Definition:</b> ERF_InitSponge.cpp:35</div></div>
<div class="ttc" id="aclassERF_html_ab546bcca3968440c6c24097f59b87f23"><div class="ttname"><a href="classERF.html#ab546bcca3968440c6c24097f59b87f23">ERF::tot_e_datalog</a></div><div class="ttdeci">amrex::Vector&lt; std::unique_ptr&lt; std::fstream &gt; &gt; tot_e_datalog</div><div class="ttdef"><b>Definition:</b> ERF.H:1416</div></div>
<div class="ttc" id="aclassERF_html_abb15119348ad5399947bc8883084b230"><div class="ttname"><a href="classERF.html#abb15119348ad5399947bc8883084b230">ERF::real_width</a></div><div class="ttdeci">int real_width</div><div class="ttdef"><b>Definition:</b> ERF.H:1050</div></div>
<div class="ttc" id="aclassERF_html_ac1a50d2d5abc5bd1d51417583184ac52"><div class="ttname"><a href="classERF.html#ac1a50d2d5abc5bd1d51417583184ac52">ERF::setRecordEnergyDataInfo</a></div><div class="ttdeci">void setRecordEnergyDataInfo(int i, const std::string &amp;filename)</div><div class="ttdef"><b>Definition:</b> ERF.H:1362</div></div>
<div class="ttc" id="aclassERF_html_ad4c61fad53912d1e8d0f774d365bcf0f"><div class="ttname"><a href="classERF.html#ad4c61fad53912d1e8d0f774d365bcf0f">ERF::is_it_time_for_action</a></div><div class="ttdeci">static bool is_it_time_for_action(int nstep, amrex::Real time, amrex::Real dt, int action_interval, amrex::Real action_per)</div><div class="ttdef"><b>Definition:</b> ERF_WriteScalarProfiles.cpp:758</div></div>
<div class="ttc" id="aclassERF_html_adc00038dfe4c332e5d15f621184c69e8"><div class="ttname"><a href="classERF.html#adc00038dfe4c332e5d15f621184c69e8">ERF::plot_file_on_restart</a></div><div class="ttdeci">int plot_file_on_restart</div><div class="ttdef"><b>Definition:</b> ERF.H:882</div></div>
<div class="ttc" id="aclassERF_html_adc284f421c5fd9dd15c0e5cbe4ff5fc8"><div class="ttname"><a href="classERF.html#adc284f421c5fd9dd15c0e5cbe4ff5fc8">ERF::Construct_ERFFillPatchers</a></div><div class="ttdeci">void Construct_ERFFillPatchers(int lev)</div><div class="ttdef"><b>Definition:</b> ERF.cpp:2181</div></div>
<div class="ttc" id="aclassERF_html_ae1a8856961aaee53016122facba03dbe"><div class="ttname"><a href="classERF.html#ae1a8856961aaee53016122facba03dbe">ERF::setRecordSampleLineInfo</a></div><div class="ttdeci">void setRecordSampleLineInfo(int i, int lev, amrex::IntVect &amp;cell, const std::string &amp;filename)</div><div class="ttdef"><b>Definition:</b> ERF.H:1392</div></div>
<div class="ttc" id="aclassERF_html_ae27a45d751287a887769df20dea60633"><div class="ttname"><a href="classERF.html#ae27a45d751287a887769df20dea60633">ERF::setSpongeRefFromSounding</a></div><div class="ttdeci">void setSpongeRefFromSounding(bool restarting)</div><div class="ttdoc">Set sponge mean profiles from input sounding.</div><div class="ttdef"><b>Definition:</b> ERF_InitSponge.cpp:65</div></div>
<div class="ttc" id="aclassERF_html_ae8a57b7fbf5a67c99d04b7d4f43ad100"><div class="ttname"><a href="classERF.html#ae8a57b7fbf5a67c99d04b7d4f43ad100">ERF::samplepoint</a></div><div class="ttdeci">amrex::Vector&lt; amrex::IntVect &gt; samplepoint</div><div class="ttdef"><b>Definition:</b> ERF.H:1423</div></div>
<div class="ttc" id="aclassERF_html_af8d930dce1b926ecc3bdc6787dd47818"><div class="ttname"><a href="classERF.html#af8d930dce1b926ecc3bdc6787dd47818">ERF::setRecordSamplePointInfo</a></div><div class="ttdeci">void setRecordSamplePointInfo(int i, int lev, amrex::IntVect &amp;cell, const std::string &amp;filename)</div><div class="ttdef"><b>Definition:</b> ERF.H:1375</div></div>
<div class="ttc" id="aclassERF_html_afdd04d6a1c2103e654f0cb6eda62436d"><div class="ttname"><a href="classERF.html#afdd04d6a1c2103e654f0cb6eda62436d">ERF::ReadCheckpointFileSurfaceLayer</a></div><div class="ttdeci">void ReadCheckpointFileSurfaceLayer()</div><div class="ttdef"><b>Definition:</b> ERF_Checkpoint.cpp:957</div></div>
<div class="ttc" id="aclassMicrophysics_html_ac10e6fce2e6cb49373d56ca0e1a5b366"><div class="ttname"><a href="classMicrophysics.html#ac10e6fce2e6cb49373d56ca0e1a5b366">Microphysics::modelType</a></div><div class="ttdeci">static MoistureModelType modelType(const MoistureType a_moisture_type)</div><div class="ttdoc">query if a specified moisture model is Eulerian or Lagrangian</div><div class="ttdef"><b>Definition:</b> ERF_Microphysics.H:86</div></div>
<div class="ttc" id="astructAdvChoice_html_a94de4907b3d6742071d5542b60e8f393"><div class="ttname"><a href="structAdvChoice.html#a94de4907b3d6742071d5542b60e8f393">AdvChoice::have_zero_flux_faces</a></div><div class="ttdeci">bool have_zero_flux_faces</div><div class="ttdef"><b>Definition:</b> ERF_AdvStruct.H:360</div></div>
<div class="ttc" id="astructDiffChoice_html_a4df179b6e7d84efc89a22ac5900f98c8"><div class="ttname"><a href="structDiffChoice.html#a4df179b6e7d84efc89a22ac5900f98c8">DiffChoice::rho0_trans</a></div><div class="ttdeci">amrex::Real rho0_trans</div><div class="ttdef"><b>Definition:</b> ERF_DiffStruct.H:88</div></div>
<div class="ttc" id="astructDiffChoice_html_afaba089738f1b77e58dd43bf1c964817"><div class="ttname"><a href="structDiffChoice.html#afaba089738f1b77e58dd43bf1c964817">DiffChoice::dynamic_viscosity</a></div><div class="ttdeci">amrex::Real dynamic_viscosity</div><div class="ttdef"><b>Definition:</b> ERF_DiffStruct.H:93</div></div>
<div class="ttc" id="astructSolverChoice_html_a65faffc1ea490b3934a9df768cfa26f1"><div class="ttname"><a href="structSolverChoice.html#a65faffc1ea490b3934a9df768cfa26f1">SolverChoice::have_geo_wind_profile</a></div><div class="ttdeci">bool have_geo_wind_profile</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:814</div></div>
<div class="ttc" id="astructSolverChoice_html_aae719af83409639331018f92be62642b"><div class="ttname"><a href="structSolverChoice.html#aae719af83409639331018f92be62642b">SolverChoice::abl_geo_wind_table</a></div><div class="ttdeci">std::string abl_geo_wind_table</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:813</div></div>
<div class="ttc" id="astructSolverChoice_html_ae6a9fda53f08dbed04adb4c63dc3176e"><div class="ttname"><a href="structSolverChoice.html#ae6a9fda53f08dbed04adb4c63dc3176e">SolverChoice::use_rotate_surface_flux</a></div><div class="ttdeci">bool use_rotate_surface_flux</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:785</div></div>
<div class="ttc" id="astructSolverChoice_html_aed9118172b234c3a0069a78776d09baa"><div class="ttname"><a href="structSolverChoice.html#aed9118172b234c3a0069a78776d09baa">SolverChoice::do_forest_drag</a></div><div class="ttdeci">bool do_forest_drag</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:840</div></div>
<div class="ttc" id="astructTurbulentPerturbation_html_aa7c1ce943bf06d347d762131ec0c24cf"><div class="ttname"><a href="structTurbulentPerturbation.html#aa7c1ce943bf06d347d762131ec0c24cf">TurbulentPerturbation::debug</a></div><div class="ttdeci">void debug(amrex::Real)</div><div class="ttdef"><b>Definition:</b> ERF_TurbPertStruct.H:620</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_aa8b243c093bd872b6f7592603ff97792_cgraph.png" border="0" usemap="#aclassERF_aa8b243c093bd872b6f7592603ff97792_cgraph" alt=""/></div>
<map name="aclassERF_aa8b243c093bd872b6f7592603ff97792_cgraph" id="aclassERF_aa8b243c093bd872b6f7592603ff97792_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,147,83"/>
<area shape="rect" href="classMicrophysics.html#ac10e6fce2e6cb49373d56ca0e1a5b366" title="query if a specified moisture model is Eulerian or Lagrangian" alt="" coords="195,5,381,32"/>
<area shape="rect" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469" title=" " alt="" coords="269,56,307,83"/>
<area shape="rect" href="ERF__TimeAvgVel_8cpp.html#a2241063c19e843eaaa749c3b51b6b0fe" title=" " alt="" coords="213,107,363,133"/>
</map>
</div>

</div>
</div>
<a id="a9084860e0049795487636a9e0ccbc89e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9084860e0049795487636a9e0ccbc89e">&#9670;&nbsp;</a></span>InitData_pre()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::InitData_pre </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;{</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <span class="comment">// Initialize the start time for our CPU-time tracker</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <a class="code" href="classERF.html#a6d00e1cb76bfbcbada173e092b6accf3">startCPUTime</a> = ParallelDescriptor::second();</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160; </div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    <span class="comment">// Create the ReadBndryPlanes object so we can read boundary plane data</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    <span class="comment">// m_r2d is used by init_bcs so we must instantiate this class before</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a80ad08512968ec45635df68abe66b1fc">input_bndry_planes</a>) {</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;        Print() &lt;&lt; <span class="stringliteral">&quot;Defining r2d for the first time &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;        <a class="code" href="classERF.html#addf62bfc534515447b94e928ac0b7135">m_r2d</a> = std::make_unique&lt;ReadBndryPlanes&gt;(geom[0], <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a2e1ef762ee1dc1bd3d4cbd08125c758a">rdOcp</a>);</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    }</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160; </div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <a class="code" href="classERF.html#a7d54d3f2317d06a8dfcde4f65cfc3e92">last_plot_file_step_1</a> = -1;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <a class="code" href="classERF.html#a09017292c9943ac2ed20ce7ed5c3c767">last_plot_file_step_2</a> = -1;</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    <a class="code" href="classERF.html#a02722d16f3c26efe590702200f1296d7">last_check_file_step</a>  = -1;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160; </div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>.empty()) {</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;        <span class="comment">// start simulation from the beginning</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160; </div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;        <span class="keyword">const</span> Real time = <a class="code" href="classERF.html#aa0c07f31b23d977646b8161e5473fab5">start_time</a>;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        InitFromScratch(time);</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        <span class="comment">// For initialization this is done in init_only; it is done here for restart</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;        <a class="code" href="classERF.html#a618e8fdff3239cc79d4145d02b1ecaa2">init_bcs</a>();</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    }</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160; </div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    <span class="comment">// Verify solver choices</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev(0); lev &lt;= max_level; ++lev) {</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        <span class="comment">// BC compatibility</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        <span class="keywordflow">if</span> ( ( (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa53b017d79e0067923180a0aa59367b4">turbChoice</a>[lev].pbl_type == PBLType::MYNN25)   ||</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;               (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa53b017d79e0067923180a0aa59367b4">turbChoice</a>[lev].pbl_type == PBLType::MYNNEDMF) ||</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;               (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa53b017d79e0067923180a0aa59367b4">turbChoice</a>[lev].pbl_type == PBLType::YSU) ||</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;               (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa53b017d79e0067923180a0aa59367b4">turbChoice</a>[lev].pbl_type == PBLType::MRF)</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                   ) &amp;&amp;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;            <a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[Orientation(Direction::z,Orientation::low)] != <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9af69483cb4bb9623dc65e76ce5bd0a3d5">ERF_BC::surface_layer</a> ) {</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;            Abort(<span class="stringliteral">&quot;MYNN2.5/MYNNEDMF/YSU/MRF PBL Model requires MOST at lower boundary&quot;</span>);</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;        }</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;        <span class="keywordflow">if</span> ( (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa53b017d79e0067923180a0aa59367b4">turbChoice</a>[lev].les_type == LESType::Deardorff) &amp;&amp;</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;             (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa53b017d79e0067923180a0aa59367b4">turbChoice</a>[lev].Ce_wall &gt; 0) &amp;&amp;</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;             (<a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[Orientation(Direction::z,Orientation::low)] != <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9af69483cb4bb9623dc65e76ce5bd0a3d5">ERF_BC::surface_layer</a>) &amp;&amp;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;             (<a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[Orientation(Direction::z,Orientation::low)] != <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9a03ee6de9fd100444c5c0567ea01bd538">ERF_BC::slip_wall</a>) &amp;&amp;</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;             (<a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[Orientation(Direction::z,Orientation::low)] != <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9acb8c716b8d9b499d9bc323d8f8a410d3">ERF_BC::no_slip_wall</a>) )</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        {</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;            Warning(<span class="stringliteral">&quot;Deardorff LES assumes wall at zlo when applying Ce_wall&quot;</span>);</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;        }</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160; </div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;        <span class="keywordflow">if</span> ( (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a68e4ef883dc13cca7db5a58589f76f25">const_massflux_u</a> != 0) &amp;&amp;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;             (<a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[Orientation(Direction::x,Orientation::low)] != <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9ae6ffdec5e14fce371eb7ae99edebbbee">ERF_BC::periodic</a> ) )</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        {</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;            Abort(<span class="stringliteral">&quot;Constant mass flux (in x) should be used with periodic boundaries&quot;</span>);</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        }</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;        <span class="keywordflow">if</span> ( (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a39ced5a090f246f82bdec3f5d288fcbc">const_massflux_v</a> != 0) &amp;&amp;</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;             (<a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[Orientation(Direction::y,Orientation::low)] != <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9ae6ffdec5e14fce371eb7ae99edebbbee">ERF_BC::periodic</a> ) )</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        {</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;            Abort(<span class="stringliteral">&quot;Constant mass flux (in y) should be used with periodic boundaries&quot;</span>);</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        }</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160; </div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        <span class="comment">// mesoscale diffusion</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;        <span class="keywordflow">if</span> ((geom[lev].CellSize(0) &gt; 2000.) || (geom[lev].CellSize(1) &gt; 2000.))</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;        {</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;            <span class="keywordflow">if</span> ( (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa53b017d79e0067923180a0aa59367b4">turbChoice</a>[lev].les_type == LESType::Smagorinsky) &amp;&amp;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                 (!<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa53b017d79e0067923180a0aa59367b4">turbChoice</a>[lev].smag2d)) {</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                Warning(<span class="stringliteral">&quot;Should use 2-D Smagorinsky for mesoscale resolution&quot;</span>);</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa53b017d79e0067923180a0aa59367b4">turbChoice</a>[lev].les_type == LESType::Deardorff) {</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                Warning(<span class="stringliteral">&quot;Should not use Deardorff LES for mesoscale resolution&quot;</span>);</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;            }</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        }</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    }</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_a618e8fdff3239cc79d4145d02b1ecaa2"><div class="ttname"><a href="classERF.html#a618e8fdff3239cc79d4145d02b1ecaa2">ERF::init_bcs</a></div><div class="ttdeci">void init_bcs()</div><div class="ttdef"><b>Definition:</b> ERF_InitBCs.cpp:20</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a92c020bfaa43e40fb5ffc449427a0318"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92c020bfaa43e40fb5ffc449427a0318">&#9670;&nbsp;</a></span>initHSE() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::initHSE </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize HSE. </p>
<div class="fragment"><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;{</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    AMREX_ALWAYS_ASSERT(!<a class="code" href="classERF.html#a2eb81c590271b429f132103c9af25830">init_sounding_ideal</a>);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; lev++)</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <a class="code" href="classERF.html#a92c020bfaa43e40fb5ffc449427a0318">initHSE</a>(lev);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    }</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a69c8fce3b0f5b28e98240599c2ee16bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69c8fce3b0f5b28e98240599c2ee16bb">&#9670;&nbsp;</a></span>initHSE() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::initHSE </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Initialize density and pressure base state in hydrostatic equilibrium. </p>
<div class="fragment"><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;{</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <span class="comment">// This integrates up through column to update p_hse, pi_hse, th_hse;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="comment">// r_hse is not const b/c FillBoundary is called at the end for r_hse and p_hse</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    MultiFab r_hse (<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev], make_alias, <a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91abc888a343d4fcc4fc4ffb79c6ac7cb93">BaseState::r0_comp</a>, 1);</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    MultiFab p_hse (<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev], make_alias, <a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91aa8253dc5484f2621e0bf8d51d98d635e">BaseState::p0_comp</a>, 1);</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    MultiFab pi_hse(<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev], make_alias, <a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91a3d99e10d828f251e465bc2c66062badf">BaseState::pi0_comp</a>, 1);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    MultiFab th_hse(<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev], make_alias, <a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91aaf394bbf6aa8da56fc479f2ed5a2a372">BaseState::th0_comp</a>, 1);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    MultiFab qv_hse(<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev], make_alias, <a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91a246ae4776111c528e79c6ad9f2ca9560">BaseState::qv0_comp</a>, 1);</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="keywordtype">bool</span> all_boxes_touch_bottom = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    Box domain(geom[lev].Domain());</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="keywordtype">int</span> icomp = 0; <span class="keywordtype">int</span> ncomp = <a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91a088c1232c30770df1105d3cdf66ee582">BaseState::num_comps</a>;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keywordflow">if</span> (lev == 0) {</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        BoxArray ba(<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].boxArray());</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ba.size(); i++) {</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;            <span class="keywordflow">if</span> (ba[i].smallEnd(2) != domain.smallEnd(2)) {</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                all_boxes_touch_bottom = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;            }</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        }</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    }</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    {</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        <span class="comment">// We need to do this interp from coarse level in order to set the values of</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        <span class="comment">// the base state inside the domain but outside of the fine region</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev-1].FillBoundary(geom[lev-1].periodicity());</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <span class="comment">// NOTE: this interpolater assumes that ALL ghost cells of the coarse MultiFab</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <span class="comment">//       have been pre-filled - this includes ghost cells both inside and outside</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <span class="comment">//       the domain</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        InterpFromCoarseLevel(<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev], <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].nGrowVect(),</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                              IntVect(0,0,0), <span class="comment">// do not fill ghost cells outside the domain</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                              <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev-1], icomp, icomp, ncomp,</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                              geom[lev-1], geom[lev],</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                              refRatio(lev-1), &amp;cell_cons_interp,</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                              <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>, <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;         <span class="comment">// We need to do this here because the interpolation above may leave corners unfilled</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;         <span class="comment">//    when the corners need to be filled by, for example, reflection of the fine ghost</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;         <span class="comment">//    cell outside the fine region but inide the domain.</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;         (*<a class="code" href="classERF.html#af4e7dc93dae16aa2cc94bbb20b699a6f">physbcs_base</a>[lev])(<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev],icomp,ncomp,<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].nGrowVect());</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    }</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keywordflow">if</span> (all_boxes_touch_bottom || lev &gt; 0) {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <span class="comment">// Initial r_hse may or may not be in HSE -- defined in ERF_Prob.cpp</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aab88dd74d39b1ad369ae6324e05d7a35">use_moist_background</a>){</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            <a class="code" href="classERF.html#a60e8cb933f237903e3fbcd6376c26db0">prob</a>-&gt;erf_init_dens_hse_moist(r_hse, <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev], geom[lev]);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;            <a class="code" href="classERF.html#a60e8cb933f237903e3fbcd6376c26db0">prob</a>-&gt;erf_init_dens_hse(r_hse, <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev], <a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[lev], geom[lev]);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <a class="code" href="classERF.html#a29929644893f3e44beb5ed9403cbdaac">erf_enforce_hse</a>(lev, r_hse, p_hse, pi_hse, th_hse, qv_hse, <a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[lev]);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="comment">// Impose physical bc&#39;s on the base state</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        (*<a class="code" href="classERF.html#af4e7dc93dae16aa2cc94bbb20b699a6f">physbcs_base</a>[lev])(<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev],0,<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].nComp(),<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].nGrowVect());</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        BoxArray ba_new(domain);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <a class="code" href="ERF__ChopGrids_8cpp.html#a6fe49eeaa200ab6ab8ae0a6e048f3ded">ChopGrids2D</a>(ba_new, domain, ParallelDescriptor::NProcs());</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        DistributionMapping dm_new(ba_new);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        MultiFab new_base_state(ba_new, dm_new, <a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91a088c1232c30770df1105d3cdf66ee582">BaseState::num_comps</a>, <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].nGrowVect());</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        new_base_state.ParallelCopy(<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev],0,0,<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].nComp(),</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                                    <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].nGrowVect(),<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].nGrowVect());</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        MultiFab new_r_hse (new_base_state, make_alias, <a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91abc888a343d4fcc4fc4ffb79c6ac7cb93">BaseState::r0_comp</a>, 1);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        MultiFab new_p_hse (new_base_state, make_alias, <a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91aa8253dc5484f2621e0bf8d51d98d635e">BaseState::p0_comp</a>, 1);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        MultiFab new_pi_hse(new_base_state, make_alias, <a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91a3d99e10d828f251e465bc2c66062badf">BaseState::pi0_comp</a>, 1);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        MultiFab new_th_hse(new_base_state, make_alias, <a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91aaf394bbf6aa8da56fc479f2ed5a2a372">BaseState::th0_comp</a>, 1);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        MultiFab new_qv_hse(new_base_state, make_alias, <a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91a246ae4776111c528e79c6ad9f2ca9560">BaseState::qv0_comp</a>, 1);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        std::unique_ptr&lt;MultiFab&gt; new_z_phys_cc;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        std::unique_ptr&lt;MultiFab&gt; new_z_phys_nd;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a1952672901901b0b3a628f2298dc72c2">mesh_type</a> != MeshType::ConstantDz) {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;            new_z_phys_cc = std::make_unique&lt;MultiFab&gt;(ba_new,dm_new,1,1);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            new_z_phys_cc-&gt;ParallelCopy(*<a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[lev],0,0,1,1,1);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;            BoxArray ba_new_nd(ba_new);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            ba_new_nd.surroundingNodes();</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            new_z_phys_nd = std::make_unique&lt;MultiFab&gt;(ba_new_nd,dm_new,1,1);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            new_z_phys_nd-&gt;ParallelCopy(*<a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev],0,0,1,1,1);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        }</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="comment">// Initial r_hse may or may not be in HSE -- defined in ERF_Prob.cpp</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aab88dd74d39b1ad369ae6324e05d7a35">use_moist_background</a>){</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            <a class="code" href="classERF.html#a60e8cb933f237903e3fbcd6376c26db0">prob</a>-&gt;erf_init_dens_hse_moist(new_r_hse, new_z_phys_nd, geom[lev]);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            <a class="code" href="classERF.html#a60e8cb933f237903e3fbcd6376c26db0">prob</a>-&gt;erf_init_dens_hse(new_r_hse, new_z_phys_nd, new_z_phys_cc, geom[lev]);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        }</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <a class="code" href="classERF.html#a29929644893f3e44beb5ed9403cbdaac">erf_enforce_hse</a>(lev, new_r_hse, new_p_hse, new_pi_hse, new_th_hse, new_qv_hse, new_z_phys_cc);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <span class="comment">// Impose physical bc&#39;s on the base state</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        (*<a class="code" href="classERF.html#af4e7dc93dae16aa2cc94bbb20b699a6f">physbcs_base</a>[lev])(new_base_state,0,new_base_state.nComp(),new_base_state.nGrowVect());</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <span class="comment">// Now copy back into the original arrays</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].ParallelCopy(new_base_state,0,0,<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].nComp(),</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                                     <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].nGrowVect(),<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].nGrowVect());</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    }</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160; </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="comment">// Impose physical bc&#39;s on the base state -- the values outside the fine region</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="comment">//   but inside the domain have already been filled in the call above to InterpFromCoarseLevel</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    (*<a class="code" href="classERF.html#af4e7dc93dae16aa2cc94bbb20b699a6f">physbcs_base</a>[lev])(<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev],0,<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].nComp(),<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].nGrowVect());</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;}</div>
<div class="ttc" id="aERF__ChopGrids_8cpp_html_a6fe49eeaa200ab6ab8ae0a6e048f3ded"><div class="ttname"><a href="ERF__ChopGrids_8cpp.html#a6fe49eeaa200ab6ab8ae0a6e048f3ded">ChopGrids2D</a></div><div class="ttdeci">void ChopGrids2D(BoxArray &amp;ba, const Box &amp;domain, int target_size)</div><div class="ttdef"><b>Definition:</b> ERF_ChopGrids.cpp:21</div></div>
<div class="ttc" id="aclassERF_html_a29929644893f3e44beb5ed9403cbdaac"><div class="ttname"><a href="classERF.html#a29929644893f3e44beb5ed9403cbdaac">ERF::erf_enforce_hse</a></div><div class="ttdeci">void erf_enforce_hse(int lev, amrex::MultiFab &amp;dens, amrex::MultiFab &amp;pres, amrex::MultiFab &amp;pi, amrex::MultiFab &amp;th, amrex::MultiFab &amp;qv, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;z_cc)</div><div class="ttdef"><b>Definition:</b> ERF_Init1D.cpp:161</div></div>
<div class="ttc" id="astructSolverChoice_html_aab88dd74d39b1ad369ae6324e05d7a35"><div class="ttname"><a href="structSolverChoice.html#aab88dd74d39b1ad369ae6324e05d7a35">SolverChoice::use_moist_background</a></div><div class="ttdeci">bool use_moist_background</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:822</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a69c8fce3b0f5b28e98240599c2ee16bb_cgraph.png" border="0" usemap="#aclassERF_a69c8fce3b0f5b28e98240599c2ee16bb_cgraph" alt=""/></div>
<map name="aclassERF_a69c8fce3b0f5b28e98240599c2ee16bb_cgraph" id="aclassERF_a69c8fce3b0f5b28e98240599c2ee16bb_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,107,32"/>
<area shape="rect" href="ERF__ChopGrids_8cpp.html#a6fe49eeaa200ab6ab8ae0a6e048f3ded" title=" " alt="" coords="155,5,261,32"/>
</map>
</div>

</div>
</div>
<a id="a5600f8ce250d4811012719fdf5e85f00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5600f8ce250d4811012719fdf5e85f00">&#9670;&nbsp;</a></span>initialize_integrator()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::initialize_integrator </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>cons_mf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>vel_mf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;{</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <span class="keyword">const</span> BoxArray&amp; ba(cons_mf.boxArray());</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <span class="keyword">const</span> DistributionMapping&amp; dm(cons_mf.DistributionMap());</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160; </div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <span class="keywordtype">int</span> ncomp_cons = cons_mf.nComp();</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160; </div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <span class="comment">// Initialize the integrator memory</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    Vector&lt;MultiFab&gt; int_state; <span class="comment">// integration state data structure example</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    int_state.push_back(MultiFab(cons_mf, make_alias, 0, ncomp_cons));         <span class="comment">// cons</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    int_state.push_back(MultiFab(convert(ba,IntVect(1,0,0)), dm, 1, vel_mf.nGrow())); <span class="comment">// xmom</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    int_state.push_back(MultiFab(convert(ba,IntVect(0,1,0)), dm, 1, vel_mf.nGrow())); <span class="comment">// ymom</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    int_state.push_back(MultiFab(convert(ba,IntVect(0,0,1)), dm, 1, vel_mf.nGrow())); <span class="comment">// zmom</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160; </div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <a class="code" href="classERF.html#a09d0fb2bd609c898a665d9530a744585">mri_integrator_mem</a>[lev] = std::make_unique&lt;MRISplitIntegrator&lt;Vector&lt;MultiFab&gt; &gt; &gt;(int_state);</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <a class="code" href="classERF.html#a09d0fb2bd609c898a665d9530a744585">mri_integrator_mem</a>[lev]-&gt;setNoSubstepping((<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a7c414e2fb7c53479a2d21bb3a2d4099e">substepping_type</a>[lev] == SubsteppingType::None));</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <a class="code" href="classERF.html#a09d0fb2bd609c898a665d9530a744585">mri_integrator_mem</a>[lev]-&gt;setAnelastic(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa7be0d60ce3de3441d44082cc1b725ec">anelastic</a>[lev]);</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <a class="code" href="classERF.html#a09d0fb2bd609c898a665d9530a744585">mri_integrator_mem</a>[lev]-&gt;setNcompCons(ncomp_cons);</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <a class="code" href="classERF.html#a09d0fb2bd609c898a665d9530a744585">mri_integrator_mem</a>[lev]-&gt;setForceFirstStageSingleSubstep(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a3f8ae511632557066f6662eec79591e1">force_stage1_single_substep</a>);</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2e1874d47d95c7c858c2a2336fd0eee6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e1874d47d95c7c858c2a2336fd0eee6">&#9670;&nbsp;</a></span>InitializeFromFile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::InitializeFromFile </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a914f576acc2d1a54203a220cce10df62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a914f576acc2d1a54203a220cce10df62">&#9670;&nbsp;</a></span>InitializeLevelFromData()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::InitializeLevelFromData </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>initial_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="afc2898daad269536c1a15443abf3fa75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc2898daad269536c1a15443abf3fa75">&#9670;&nbsp;</a></span>initializeMicrophysics()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::initializeMicrophysics </td>
          <td>(</td>
          <td class="paramtype">const int &amp;&#160;</td>
          <td class="paramname"><em>a_nlevsmax</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a_nlevsmax</td><td>number of AMR levels </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;{</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classMicrophysics.html#ac10e6fce2e6cb49373d56ca0e1a5b366">Microphysics::modelType</a>(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a>) == MoistureModelType::Eulerian) {</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160; </div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;        <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a> = std::make_unique&lt;EulerianMicrophysics&gt;(a_nlevsmax, <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a>);</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160; </div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classMicrophysics.html#ac10e6fce2e6cb49373d56ca0e1a5b366">Microphysics::modelType</a>(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a>) == MoistureModelType::Lagrangian) {</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;<span class="preprocessor">#ifdef ERF_USE_PARTICLES</span></div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160; </div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;        <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a> = std::make_unique&lt;LagrangianMicrophysics&gt;(a_nlevsmax, <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a>);</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;        <span class="comment">/* Lagrangian microphysics models will have a particle container; it needs to be added</span></div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;<span class="comment">           to ERF::particleData */</span></div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span>&amp; pc_name( <span class="keyword">dynamic_cast&lt;</span>LagrangianMicrophysics&amp;<span class="keyword">&gt;</span>(*micro).getName() );</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;        <span class="comment">/* The particle container has not yet been constructed and initialized, so just add</span></div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;<span class="comment">           its name here for now (so that functions to set plotting variables can see it). */</span></div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;        particleData.addName( pc_name );</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160; </div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;        Abort(<span class="stringliteral">&quot;Lagrangian microphysics can be used when compiled with ERF_USE_PARTICLES&quot;</span>);</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;    }</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160; </div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;    <a class="code" href="classERF.html#ae00126a9c2738bf6a6cbbe77321c9cfc">qmoist</a>.resize(a_nlevsmax);</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_ae00126a9c2738bf6a6cbbe77321c9cfc"><div class="ttname"><a href="classERF.html#ae00126a9c2738bf6a6cbbe77321c9cfc">ERF::qmoist</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; amrex::MultiFab * &gt; &gt; qmoist</div><div class="ttdef"><b>Definition:</b> ERF.H:746</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_afc2898daad269536c1a15443abf3fa75_cgraph.png" border="0" usemap="#aclassERF_afc2898daad269536c1a15443abf3fa75_cgraph" alt=""/></div>
<map name="aclassERF_afc2898daad269536c1a15443abf3fa75_cgraph" id="aclassERF_afc2898daad269536c1a15443abf3fa75_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,200,32"/>
<area shape="rect" href="classMicrophysics.html#ac10e6fce2e6cb49373d56ca0e1a5b366" title="query if a specified moisture model is Eulerian or Lagrangian" alt="" coords="248,5,435,32"/>
</map>
</div>

</div>
</div>
<a id="a039a764a1d942c484e8aea49e87bc046"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a039a764a1d942c484e8aea49e87bc046">&#9670;&nbsp;</a></span>initRayleigh()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::initRayleigh </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize Rayleigh damping profiles. </p>
<p>Initialization function for host and device vectors used to store averaged quantities when calculating the effects of Rayleigh Damping. </p>
<div class="fragment"><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;{</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> khi = geom[0].Domain().bigEnd(2);</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a5ffe405695bf4304d2ea61be6efaca1c">rayleigh_ztop</a> = (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> == TerrainType::None) ?  geom[0].ProbHi(2) : <a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[0][khi+1];</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <a class="code" href="classERF.html#ad9939824ea7b7d06ab252fed28d5a911">h_rayleigh_ptrs</a>.resize(max_level+1);</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <a class="code" href="classERF.html#ad598bde8e728479faaa7c2820096b47a">d_rayleigh_ptrs</a>.resize(max_level+1);</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; lev++)</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    {</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;        <span class="comment">// These have 4 components: ubar, vbar, wbar, thetabar</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;        <a class="code" href="classERF.html#ad9939824ea7b7d06ab252fed28d5a911">h_rayleigh_ptrs</a>[lev].resize(<a class="code" href="ERF__DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a7c3c83d6fcec1f134956c3160adf6e39">Rayleigh::nvars</a>);</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;        <a class="code" href="classERF.html#ad598bde8e728479faaa7c2820096b47a">d_rayleigh_ptrs</a>[lev].resize(<a class="code" href="ERF__DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a7c3c83d6fcec1f134956c3160adf6e39">Rayleigh::nvars</a>);</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> zlen_rayleigh = geom[lev].Domain().length(2);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        <span class="comment">// Allocate space for these 1D vectors</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; <a class="code" href="ERF__DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a7c3c83d6fcec1f134956c3160adf6e39">Rayleigh::nvars</a>; n++) {</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;            <a class="code" href="classERF.html#ad9939824ea7b7d06ab252fed28d5a911">h_rayleigh_ptrs</a>[lev][n].resize(zlen_rayleigh, 0.0_rt);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;            <a class="code" href="classERF.html#ad598bde8e728479faaa7c2820096b47a">d_rayleigh_ptrs</a>[lev][n].resize(zlen_rayleigh, 0.0_rt);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        }</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        <span class="comment">// Init the host vectors</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        <a class="code" href="classERF.html#a60e8cb933f237903e3fbcd6376c26db0">prob</a>-&gt;erf_init_rayleigh(<a class="code" href="classERF.html#ad9939824ea7b7d06ab252fed28d5a911">h_rayleigh_ptrs</a>[lev], geom[lev], <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev], <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a29517ec608149342f25aa89f18204fac">rayleigh_zdamp</a>);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        <span class="comment">// Copy from host vectors to device vectors</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; <a class="code" href="ERF__DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a7c3c83d6fcec1f134956c3160adf6e39">Rayleigh::nvars</a>; n++) {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;            Gpu::copy(Gpu::hostToDevice, <a class="code" href="classERF.html#ad9939824ea7b7d06ab252fed28d5a911">h_rayleigh_ptrs</a>[lev][n].begin(), <a class="code" href="classERF.html#ad9939824ea7b7d06ab252fed28d5a911">h_rayleigh_ptrs</a>[lev][n].end(),</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;                      <a class="code" href="classERF.html#ad598bde8e728479faaa7c2820096b47a">d_rayleigh_ptrs</a>[lev][n].begin());</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        }</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    }</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_ad9939824ea7b7d06ab252fed28d5a911"><div class="ttname"><a href="classERF.html#ad9939824ea7b7d06ab252fed28d5a911">ERF::h_rayleigh_ptrs</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; amrex::Vector&lt; amrex::Real &gt; &gt; &gt; h_rayleigh_ptrs</div><div class="ttdef"><b>Definition:</b> ERF.H:1127</div></div>
<div class="ttc" id="astructSolverChoice_html_a29517ec608149342f25aa89f18204fac"><div class="ttname"><a href="structSolverChoice.html#a29517ec608149342f25aa89f18204fac">SolverChoice::rayleigh_zdamp</a></div><div class="ttdeci">amrex::Real rayleigh_zdamp</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:745</div></div>
<div class="ttc" id="astructSolverChoice_html_a5ffe405695bf4304d2ea61be6efaca1c"><div class="ttname"><a href="structSolverChoice.html#a5ffe405695bf4304d2ea61be6efaca1c">SolverChoice::rayleigh_ztop</a></div><div class="ttdeci">amrex::Real rayleigh_ztop</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:746</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab26ec4f9c35a519063af2a938c1012e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab26ec4f9c35a519063af2a938c1012e6">&#9670;&nbsp;</a></span>initSponge()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::initSponge </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize sponge profiles. </p>
<p>Initialization function for host and device vectors used to store the effects of sponge Damping. </p>
<div class="fragment"><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;{</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <a class="code" href="classERF.html#a20a0f0d26791321eb4bbba6baee9f159">h_sponge_ptrs</a>.resize(max_level+1);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <a class="code" href="classERF.html#a3b9bcb54c278dfec6027e9727cc01bc5">d_sponge_ptrs</a>.resize(max_level+1);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; lev++)</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    {</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        <span class="comment">// These have 2 components: ubar, vbar</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        <a class="code" href="classERF.html#a20a0f0d26791321eb4bbba6baee9f159">h_sponge_ptrs</a>[lev].resize(<a class="code" href="ERF__DataStruct_8H.html#a5bebd9ff4e2455172deca3b399214fcba7f0566bdfe36c67d532a7e2aca33d9a4">Sponge::nvars_sponge</a>);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        <a class="code" href="classERF.html#a3b9bcb54c278dfec6027e9727cc01bc5">d_sponge_ptrs</a>[lev].resize(<a class="code" href="ERF__DataStruct_8H.html#a5bebd9ff4e2455172deca3b399214fcba7f0566bdfe36c67d532a7e2aca33d9a4">Sponge::nvars_sponge</a>);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> zlen_sponge = geom[lev].Domain().length(2);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        <span class="comment">// Allocate space for these 1D vectors</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; <a class="code" href="ERF__DataStruct_8H.html#a5bebd9ff4e2455172deca3b399214fcba7f0566bdfe36c67d532a7e2aca33d9a4">Sponge::nvars_sponge</a>; n++) {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;            <a class="code" href="classERF.html#a20a0f0d26791321eb4bbba6baee9f159">h_sponge_ptrs</a>[lev][n].resize(zlen_sponge, 0.0_rt);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;            <a class="code" href="classERF.html#a3b9bcb54c278dfec6027e9727cc01bc5">d_sponge_ptrs</a>[lev][n].resize(zlen_sponge, 0.0_rt);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        }</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    }</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_a20a0f0d26791321eb4bbba6baee9f159"><div class="ttname"><a href="classERF.html#a20a0f0d26791321eb4bbba6baee9f159">ERF::h_sponge_ptrs</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; amrex::Vector&lt; amrex::Real &gt; &gt; &gt; h_sponge_ptrs</div><div class="ttdef"><b>Definition:</b> ERF.H:1130</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abfdc95a7c3cf7e413c1352bac38c93e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abfdc95a7c3cf7e413c1352bac38c93e8">&#9670;&nbsp;</a></span>input_sponge()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::input_sponge </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>High level wrapper for sponge x and y velocities level data from input sponge data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lev</td><td>Integer specifying the current level </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;{</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <span class="comment">// We only want to read the file once</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <span class="keywordflow">if</span> (lev == 0) {</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a8cb877a46fd94b5294425299dcb9cbaf">input_sponge_data</a>.<a class="code" href="structInputSpongeData.html#a944b8ce681cef2752c8797d83cae5eae">input_sponge_file</a>.empty())</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;            Error(<span class="stringliteral">&quot;input_sounding file name must be provided via input&quot;</span>);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160; </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;        <span class="comment">// this will interpolate the input profiles to the nominal height levels</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;        <span class="comment">// (ranging from 0 to the domain top)</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;        <a class="code" href="classERF.html#a8cb877a46fd94b5294425299dcb9cbaf">input_sponge_data</a>.<a class="code" href="structInputSpongeData.html#a75a39e770aef38396af5f31cda9879fc">read_from_file</a>(geom[lev], <a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[lev]);</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    }</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_a8cb877a46fd94b5294425299dcb9cbaf"><div class="ttname"><a href="classERF.html#a8cb877a46fd94b5294425299dcb9cbaf">ERF::input_sponge_data</a></div><div class="ttdeci">InputSpongeData input_sponge_data</div><div class="ttdef"><b>Definition:</b> ERF.H:660</div></div>
<div class="ttc" id="astructInputSpongeData_html_a75a39e770aef38396af5f31cda9879fc"><div class="ttname"><a href="structInputSpongeData.html#a75a39e770aef38396af5f31cda9879fc">InputSpongeData::read_from_file</a></div><div class="ttdeci">void read_from_file(const amrex::Geometry &amp;geom, const amrex::Vector&lt; amrex::Real &gt; &amp;zlevels_stag)</div><div class="ttdef"><b>Definition:</b> ERF_InputSpongeData.H:28</div></div>
<div class="ttc" id="astructInputSpongeData_html_a944b8ce681cef2752c8797d83cae5eae"><div class="ttname"><a href="structInputSpongeData.html#a944b8ce681cef2752c8797d83cae5eae">InputSpongeData::input_sponge_file</a></div><div class="ttdeci">std::string input_sponge_file</div><div class="ttdef"><b>Definition:</b> ERF_InputSpongeData.H:111</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad4c61fad53912d1e8d0f774d365bcf0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4c61fad53912d1e8d0f774d365bcf0f">&#9670;&nbsp;</a></span>is_it_time_for_action()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool ERF::is_it_time_for_action </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nstep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>action_interval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>action_per</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Helper function which uses the current step number, time, and timestep to determine whether it is time to take an action specified at every interval of timesteps.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nstep</td><td>Timestep number </td></tr>
    <tr><td class="paramname">time</td><td>Current time </td></tr>
    <tr><td class="paramname">dtlev</td><td>Timestep for the current level </td></tr>
    <tr><td class="paramname">action_interval</td><td>Interval in number of timesteps for taking action </td></tr>
    <tr><td class="paramname">action_per</td><td>Interval in simulation time for taking action </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;{</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;  <span class="keywordtype">bool</span> int_test = (action_interval &gt; 0 &amp;&amp; nstep % action_interval == 0);</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160; </div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;  <span class="keywordtype">bool</span> per_test = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;  <span class="keywordflow">if</span> (action_per &gt; 0.0) {</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> num_per_old = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(amrex::Math::floor((time - dtlev) / action_per));</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> num_per_new = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(amrex::Math::floor((time) / action_per));</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160; </div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    <span class="keywordflow">if</span> (num_per_old != num_per_new) {</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;      per_test = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    }</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  }</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160; </div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  <span class="keywordflow">return</span> int_test || per_test;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0cf9cd65604501647629fd69a0d28bb6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0cf9cd65604501647629fd69a0d28bb6">&#9670;&nbsp;</a></span>make_eb_box()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::make_eb_box </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aeca994ecf1b09d58cdc991920504ec34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeca994ecf1b09d58cdc991920504ec34">&#9670;&nbsp;</a></span>make_eb_regular()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::make_eb_regular </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac81ec7f74a1be1c4a1e6e15e08385ed5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac81ec7f74a1be1c4a1e6e15e08385ed5">&#9670;&nbsp;</a></span>make_physbcs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::make_physbcs </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;{</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structSolverChoice.html#a1952672901901b0b3a628f2298dc72c2">SolverChoice::mesh_type</a> == MeshType::VariableDz) {</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        AMREX_ALWAYS_ASSERT(<a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev] != <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    }</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160; </div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <a class="code" href="classERF.html#a2e9b04043853d25f2d76edbc0bed2e72">physbcs_cons</a>[lev] = std::make_unique&lt;ERFPhysBCFunct_cons&gt; (lev, geom[lev], <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>, <a class="code" href="classERF.html#a8a99e22b1111c803e31b4afd5fcdea60">domain_bcs_type_d</a>,</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                                                               <a class="code" href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">m_bc_extdir_vals</a>, <a class="code" href="classERF.html#af783df8719de2e72e347de5860f71528">m_bc_neumann_vals</a>,</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                                                               <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev], <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ad57b63939b19e90b87dd61d3f293b0d7">use_real_bcs</a>, <a class="code" href="classERF.html#a67c86c65b27f8ceee58b5ca989116e14">th_bc_data</a>[lev].data());</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <a class="code" href="classERF.html#a64e55e5ae9df06433146db657eb9e72e">physbcs_u</a>[lev]    = std::make_unique&lt;ERFPhysBCFunct_u&gt; (lev, geom[lev], <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>, <a class="code" href="classERF.html#a8a99e22b1111c803e31b4afd5fcdea60">domain_bcs_type_d</a>,</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                                                            <a class="code" href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">m_bc_extdir_vals</a>, <a class="code" href="classERF.html#af783df8719de2e72e347de5860f71528">m_bc_neumann_vals</a>,</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                                                            <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev], <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ad57b63939b19e90b87dd61d3f293b0d7">use_real_bcs</a>, <a class="code" href="classERF.html#a902f60d94be5eaf86361d1d5ad942105">xvel_bc_data</a>[lev].data());</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <a class="code" href="classERF.html#a79231b5cfd4576a742e46ae0082b5121">physbcs_v</a>[lev]    = std::make_unique&lt;ERFPhysBCFunct_v&gt; (lev, geom[lev], <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>, <a class="code" href="classERF.html#a8a99e22b1111c803e31b4afd5fcdea60">domain_bcs_type_d</a>,</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                                                            <a class="code" href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">m_bc_extdir_vals</a>, <a class="code" href="classERF.html#af783df8719de2e72e347de5860f71528">m_bc_neumann_vals</a>,</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                                                            <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev], <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ad57b63939b19e90b87dd61d3f293b0d7">use_real_bcs</a>, <a class="code" href="classERF.html#ae5e40fcd6dd76c80d0b5b09be5baef97">yvel_bc_data</a>[lev].data());</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <a class="code" href="classERF.html#a45c8ecd777f47732993777a0afb8e140">physbcs_w</a>[lev]    = std::make_unique&lt;ERFPhysBCFunct_w&gt; (lev, geom[lev], <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>, <a class="code" href="classERF.html#a8a99e22b1111c803e31b4afd5fcdea60">domain_bcs_type_d</a>,</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                                                            <a class="code" href="classERF.html#a27261ba76aa71f1ddbf87bca0ede579f">m_bc_extdir_vals</a>, <a class="code" href="classERF.html#af783df8719de2e72e347de5860f71528">m_bc_neumann_vals</a>,</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                                                            <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a>, <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev], <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev],</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                                                            <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ad57b63939b19e90b87dd61d3f293b0d7">use_real_bcs</a>, <a class="code" href="classERF.html#ae08c25dcf643c6ef39f27d7dd0cb7423">zvel_bc_data</a>[lev].data());</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <a class="code" href="classERF.html#af4e7dc93dae16aa2cc94bbb20b699a6f">physbcs_base</a>[lev] = std::make_unique&lt;ERFPhysBCFunct_base&gt; (lev, geom[lev], <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>, <a class="code" href="classERF.html#a8a99e22b1111c803e31b4afd5fcdea60">domain_bcs_type_d</a>, <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev],</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                                                               (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> == TerrainType::MovingFittedMesh));</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a93ed2dd2c2441da6853d6f48b6467324"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93ed2dd2c2441da6853d6f48b6467324">&#9670;&nbsp;</a></span>MakeDiagnosticAverage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::MakeDiagnosticAverage </td>
          <td>(</td>
          <td class="paramtype">amrex::Vector&lt; amrex::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_havg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>S</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;{</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;    <span class="comment">// Get the number of cells in z at level 0</span></div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;    <span class="keywordtype">int</span> dir_z = AMREX_SPACEDIM-1;</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;    <span class="keyword">auto</span> domain = geom[0].Domain();</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;    <span class="keywordtype">int</span> size_z = domain.length(dir_z);</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;    <span class="keywordtype">int</span> start_z = domain.smallEnd()[dir_z];</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;    Real area_z = <span class="keyword">static_cast&lt;</span>Real<span class="keyword">&gt;</span>(domain.length(0)*domain.length(1));</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160; </div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;    <span class="comment">// resize the level 0 horizontal average vectors</span></div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;    h_havg.resize(size_z, 0.0_rt);</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160; </div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;    <span class="comment">// Get the cell centered data and construct sums</span></div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;<span class="preprocessor">#pragma omp parallel if (Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;    <span class="keywordflow">for</span> (MFIter mfi(S); mfi.isValid(); ++mfi) {</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;        <span class="keyword">const</span> Box&amp; box = mfi.validbox();</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;        <span class="keyword">const</span> IntVect&amp; se = box.smallEnd();</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;        <span class="keyword">const</span> IntVect&amp; be = box.bigEnd();</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160; </div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;        <span class="keyword">auto</span>      fab_arr = S[mfi].array();</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160; </div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;        FArrayBox fab_reduce(box, 1, The_Async_Arena());</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;        <span class="keyword">auto</span> arr_reduce   = fab_reduce.array();</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160; </div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;        ParallelFor(box, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) {</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;            arr_reduce(i, j, k, 0) = fab_arr(i,j,k,n);</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;        });</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160; </div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=se[dir_z]; k &lt;= be[dir_z]; ++k) {</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;            Box kbox(box); kbox.setSmall(dir_z,k); kbox.setBig(dir_z,k);</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;            h_havg[k-start_z] += fab_reduce.sum&lt;RunOn::Device&gt;(kbox,0);</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;        }</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;    }</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160; </div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;    <span class="comment">// combine sums from different MPI ranks</span></div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;    ParallelDescriptor::ReduceRealSum(h_havg.dataPtr(), h_havg.size());</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160; </div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;    <span class="comment">// divide by the total number of cells we are averaging over</span></div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; size_z; ++k) {</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;        h_havg[k]     /= area_z;</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;    }</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0572de619e757aab7ad9a4e0c7967da4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0572de619e757aab7ad9a4e0c7967da4">&#9670;&nbsp;</a></span>MakeEBGeometry()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::MakeEBGeometry </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a01987b2556834788694f2f3741a2afe4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01987b2556834788694f2f3741a2afe4">&#9670;&nbsp;</a></span>MakeHorizontalAverages()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::MakeHorizontalAverages </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;{</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;    <span class="keywordtype">int</span> lev = 0;</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160; </div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;    <span class="comment">// First, average down all levels (if doing two-way coupling)</span></div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#af976afa61859c07e6249963edc367c2d">coupling_type</a> == CouplingType::TwoWay) {</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;        <a class="code" href="classERF.html#a8202de1f8f372e3e6fdc483447c6a55f">AverageDown</a>();</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;    }</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160; </div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;    MultiFab mf(grids[lev], dmap[lev], 5, 0);</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160; </div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;    <span class="keywordtype">int</span> zdir = 2;</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;    <span class="keyword">auto</span> domain = geom[0].Domain();</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160; </div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;    <span class="keywordtype">bool</span> use_moisture = (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> != MoistureType::None);</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;    <span class="keywordtype">bool</span> is_anelastic = (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa7be0d60ce3de3441d44082cc1b725ec">anelastic</a>[lev] == 1);</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160; </div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;    <span class="keywordflow">for</span> (MFIter mfi(mf); mfi.isValid(); ++mfi) {</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;        <span class="keyword">const</span> Box&amp; bx = mfi.validbox();</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;        <span class="keyword">auto</span>  fab_arr = mf.array(mfi);</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;        <span class="keyword">auto</span> <span class="keyword">const</span>  hse_arr = <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].const_array(mfi);</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;        <span class="keyword">auto</span> <span class="keyword">const</span> cons_arr = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].const_array(mfi);</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;        ParallelFor(bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) {</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;            Real dens = cons_arr(i, j, k, <a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>);</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;            fab_arr(i, j, k, 0) = dens;</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;            fab_arr(i, j, k, 1) = cons_arr(i, j, k, <a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>) / dens;</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;            <span class="keywordflow">if</span> (!use_moisture) {</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;                <span class="keywordflow">if</span> (is_anelastic) {</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;                    fab_arr(i,j,k,2) = hse_arr(i,j,k,<a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91aa8253dc5484f2621e0bf8d51d98d635e">BaseState::p0_comp</a>);</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;                    fab_arr(i,j,k,2) = <a class="code" href="ERF__EOS_8H.html#a08354ab110fb9e873bce9250b4f4b46e">getPgivenRTh</a>(cons_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>));</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;                }</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;            }</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;        });</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;    }</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160; </div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;    <span class="keywordflow">if</span> (use_moisture)</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;    {</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;        <span class="keywordflow">for</span> (MFIter mfi(mf); mfi.isValid(); ++mfi) {</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;            <span class="keyword">const</span> Box&amp; bx = mfi.validbox();</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;            <span class="keyword">auto</span>  fab_arr = mf.array(mfi);</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;            <span class="keyword">auto</span> <span class="keyword">const</span>  hse_arr = <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].const_array(mfi);</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;            <span class="keyword">auto</span> <span class="keyword">const</span> cons_arr = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].const_array(mfi);</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;            <span class="keywordtype">int</span> ncomp = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nComp();</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160; </div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;            ParallelFor(bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) {</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;                Real dens = cons_arr(i, j, k, <a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>);</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;                <span class="keywordflow">if</span> (is_anelastic) {</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;                    fab_arr(i,j,k,2) = hse_arr(i,j,k,<a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91aa8253dc5484f2621e0bf8d51d98d635e">BaseState::p0_comp</a>);</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;                    Real <a class="code" href="namespaceMicVar__Kess.html#ad5e2303f8f4cbf19829306f4a72d61a7af099273d19f4b8cdca199c5177231e35">qv</a> = cons_arr(i, j, k, <a class="code" href="ERF__IndexDefines_8H.html#aa965e9988f14d5d2a5aef4a942168a15">RhoQ1_comp</a>) / dens;</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;                    fab_arr(i, j, k, 2) = <a class="code" href="ERF__EOS_8H.html#a08354ab110fb9e873bce9250b4f4b46e">getPgivenRTh</a>(cons_arr(i, j, k, <a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>), <a class="code" href="namespaceMicVar__Kess.html#ad5e2303f8f4cbf19829306f4a72d61a7af099273d19f4b8cdca199c5177231e35">qv</a>);</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;                }</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;                fab_arr(i, j, k, 3) = (ncomp &gt; <a class="code" href="ERF__IndexDefines_8H.html#aa965e9988f14d5d2a5aef4a942168a15">RhoQ1_comp</a> ? cons_arr(i, j, k, <a class="code" href="ERF__IndexDefines_8H.html#aa965e9988f14d5d2a5aef4a942168a15">RhoQ1_comp</a>) / dens : 0.0);</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;                fab_arr(i, j, k, 4) = (ncomp &gt; <a class="code" href="ERF__IndexDefines_8H.html#a3bf0a4783e82ba30db2b7c0a332c2f16">RhoQ2_comp</a> ? cons_arr(i, j, k, <a class="code" href="ERF__IndexDefines_8H.html#a3bf0a4783e82ba30db2b7c0a332c2f16">RhoQ2_comp</a>) / dens : 0.0);</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;            });</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;        }</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160; </div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;        Gpu::HostVector&lt;Real&gt; h_avg_qv          = sumToLine(mf,3,1,domain,zdir);</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;        Gpu::HostVector&lt;Real&gt; h_avg_qc          = sumToLine(mf,4,1,domain,zdir);</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;    }</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160; </div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;    <span class="comment">// Sum in the horizontal plane</span></div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;    Gpu::HostVector&lt;Real&gt; h_avg_density     = sumToLine(mf,0,1,domain,zdir);</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;    Gpu::HostVector&lt;Real&gt; h_avg_temperature = sumToLine(mf,1,1,domain,zdir);</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;    Gpu::HostVector&lt;Real&gt; h_avg_pressure    = sumToLine(mf,2,1,domain,zdir);</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160; </div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;    <span class="comment">// Divide by the total number of cells we are averaging over</span></div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;    <span class="keywordtype">int</span> size_z = domain.length(zdir);</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;    Real area_z = <span class="keyword">static_cast&lt;</span>Real<span class="keyword">&gt;</span>(domain.length(0)*domain.length(1));</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;    <span class="keywordtype">int</span> klen = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(h_avg_density.size());</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160; </div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; klen; ++k) {</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;        <a class="code" href="classERF.html#a4dd7c603e65d230105a4f1e0afb4cf8a">h_havg_density</a>[k]     /= area_z;</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;        <a class="code" href="classERF.html#a9683c7b07c287e57856ee5a9c99917a1">h_havg_temperature</a>[k] /= area_z;</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;        <a class="code" href="classERF.html#a413293737b0021c97b50c62756561446">h_havg_pressure</a>[k]    /= area_z;</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> != MoistureType::None)</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;        {</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;            <a class="code" href="classERF.html#a45233bcc95ac50c112b7146595164a8d">h_havg_qc</a>[k]          /= area_z;</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;            <a class="code" href="classERF.html#ae8de26569516b41e5dc3cbb3419e891c">h_havg_qv</a>[k]          /= area_z;</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;        }</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;    } <span class="comment">// k</span></div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160; </div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;    <span class="comment">// resize device vectors</span></div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;    <a class="code" href="classERF.html#a84cf7616e7b3928f08f4bd56112db01e">d_havg_density</a>.resize(size_z, 0.0_rt);</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;    <a class="code" href="classERF.html#a20350959b7b3e252ee3a802e7998ca8d">d_havg_temperature</a>.resize(size_z, 0.0_rt);</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;    <a class="code" href="classERF.html#a9a4f076c56f31fbb5e68c09706605a05">d_havg_pressure</a>.resize(size_z, 0.0_rt);</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160; </div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;    <span class="comment">// copy host vectors to device vectors</span></div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;    Gpu::copy(Gpu::hostToDevice, <a class="code" href="classERF.html#a4dd7c603e65d230105a4f1e0afb4cf8a">h_havg_density</a>.begin(), <a class="code" href="classERF.html#a4dd7c603e65d230105a4f1e0afb4cf8a">h_havg_density</a>.end(), <a class="code" href="classERF.html#a84cf7616e7b3928f08f4bd56112db01e">d_havg_density</a>.begin());</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;    Gpu::copy(Gpu::hostToDevice, <a class="code" href="classERF.html#a9683c7b07c287e57856ee5a9c99917a1">h_havg_temperature</a>.begin(), <a class="code" href="classERF.html#a9683c7b07c287e57856ee5a9c99917a1">h_havg_temperature</a>.end(), <a class="code" href="classERF.html#a20350959b7b3e252ee3a802e7998ca8d">d_havg_temperature</a>.begin());</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;    Gpu::copy(Gpu::hostToDevice, <a class="code" href="classERF.html#a413293737b0021c97b50c62756561446">h_havg_pressure</a>.begin(), <a class="code" href="classERF.html#a413293737b0021c97b50c62756561446">h_havg_pressure</a>.end(), <a class="code" href="classERF.html#a9a4f076c56f31fbb5e68c09706605a05">d_havg_pressure</a>.begin());</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160; </div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> != MoistureType::None)</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;    {</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;        <a class="code" href="classERF.html#a2b0085123e02051ac4c2a72e9972e6ee">d_havg_qv</a>.resize(size_z, 0.0_rt);</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;        <a class="code" href="classERF.html#a8199cc1ec38b9dfd47262ccc7df6a941">d_havg_qc</a>.resize(size_z, 0.0_rt);</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;        Gpu::copy(Gpu::hostToDevice, <a class="code" href="classERF.html#ae8de26569516b41e5dc3cbb3419e891c">h_havg_qv</a>.begin(), <a class="code" href="classERF.html#ae8de26569516b41e5dc3cbb3419e891c">h_havg_qv</a>.end(), <a class="code" href="classERF.html#a2b0085123e02051ac4c2a72e9972e6ee">d_havg_qv</a>.begin());</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;        Gpu::copy(Gpu::hostToDevice, <a class="code" href="classERF.html#a45233bcc95ac50c112b7146595164a8d">h_havg_qc</a>.begin(), <a class="code" href="classERF.html#a45233bcc95ac50c112b7146595164a8d">h_havg_qc</a>.end(), <a class="code" href="classERF.html#a8199cc1ec38b9dfd47262ccc7df6a941">d_havg_qc</a>.begin());</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;    }</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_a20350959b7b3e252ee3a802e7998ca8d"><div class="ttname"><a href="classERF.html#a20350959b7b3e252ee3a802e7998ca8d">ERF::d_havg_temperature</a></div><div class="ttdeci">amrex::Gpu::DeviceVector&lt; amrex::Real &gt; d_havg_temperature</div><div class="ttdef"><b>Definition:</b> ERF.H:1145</div></div>
<div class="ttc" id="aclassERF_html_a2b0085123e02051ac4c2a72e9972e6ee"><div class="ttname"><a href="classERF.html#a2b0085123e02051ac4c2a72e9972e6ee">ERF::d_havg_qv</a></div><div class="ttdeci">amrex::Gpu::DeviceVector&lt; amrex::Real &gt; d_havg_qv</div><div class="ttdef"><b>Definition:</b> ERF.H:1147</div></div>
<div class="ttc" id="aclassERF_html_a413293737b0021c97b50c62756561446"><div class="ttname"><a href="classERF.html#a413293737b0021c97b50c62756561446">ERF::h_havg_pressure</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Real &gt; h_havg_pressure</div><div class="ttdef"><b>Definition:</b> ERF.H:1140</div></div>
<div class="ttc" id="aclassERF_html_a45233bcc95ac50c112b7146595164a8d"><div class="ttname"><a href="classERF.html#a45233bcc95ac50c112b7146595164a8d">ERF::h_havg_qc</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Real &gt; h_havg_qc</div><div class="ttdef"><b>Definition:</b> ERF.H:1142</div></div>
<div class="ttc" id="aclassERF_html_a4dd7c603e65d230105a4f1e0afb4cf8a"><div class="ttname"><a href="classERF.html#a4dd7c603e65d230105a4f1e0afb4cf8a">ERF::h_havg_density</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Real &gt; h_havg_density</div><div class="ttdef"><b>Definition:</b> ERF.H:1138</div></div>
<div class="ttc" id="aclassERF_html_a8199cc1ec38b9dfd47262ccc7df6a941"><div class="ttname"><a href="classERF.html#a8199cc1ec38b9dfd47262ccc7df6a941">ERF::d_havg_qc</a></div><div class="ttdeci">amrex::Gpu::DeviceVector&lt; amrex::Real &gt; d_havg_qc</div><div class="ttdef"><b>Definition:</b> ERF.H:1148</div></div>
<div class="ttc" id="aclassERF_html_a84cf7616e7b3928f08f4bd56112db01e"><div class="ttname"><a href="classERF.html#a84cf7616e7b3928f08f4bd56112db01e">ERF::d_havg_density</a></div><div class="ttdeci">amrex::Gpu::DeviceVector&lt; amrex::Real &gt; d_havg_density</div><div class="ttdef"><b>Definition:</b> ERF.H:1144</div></div>
<div class="ttc" id="aclassERF_html_a9683c7b07c287e57856ee5a9c99917a1"><div class="ttname"><a href="classERF.html#a9683c7b07c287e57856ee5a9c99917a1">ERF::h_havg_temperature</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Real &gt; h_havg_temperature</div><div class="ttdef"><b>Definition:</b> ERF.H:1139</div></div>
<div class="ttc" id="aclassERF_html_a9a4f076c56f31fbb5e68c09706605a05"><div class="ttname"><a href="classERF.html#a9a4f076c56f31fbb5e68c09706605a05">ERF::d_havg_pressure</a></div><div class="ttdeci">amrex::Gpu::DeviceVector&lt; amrex::Real &gt; d_havg_pressure</div><div class="ttdef"><b>Definition:</b> ERF.H:1146</div></div>
<div class="ttc" id="aclassERF_html_ae8de26569516b41e5dc3cbb3419e891c"><div class="ttname"><a href="classERF.html#ae8de26569516b41e5dc3cbb3419e891c">ERF::h_havg_qv</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Real &gt; h_havg_qv</div><div class="ttdef"><b>Definition:</b> ERF.H:1141</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a01987b2556834788694f2f3741a2afe4_cgraph.png" border="0" usemap="#aclassERF_a01987b2556834788694f2f3741a2afe4_cgraph" alt=""/></div>
<map name="aclassERF_a01987b2556834788694f2f3741a2afe4_cgraph" id="aclassERF_a01987b2556834788694f2f3741a2afe4_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,221,32"/>
<area shape="rect" href="ERF__EOS_8H.html#a08354ab110fb9e873bce9250b4f4b46e" title=" " alt="" coords="269,5,380,32"/>
</map>
</div>

</div>
</div>
<a id="abb6175c28b36d23f5dda2994ca4a85e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb6175c28b36d23f5dda2994ca4a85e7">&#9670;&nbsp;</a></span>MakeNewLevelFromCoarse()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::MakeNewLevelFromCoarse </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::BoxArray &amp;&#160;</td>
          <td class="paramname"><em>ba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::DistributionMapping &amp;&#160;</td>
          <td class="paramname"><em>dm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;{</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    AMREX_ALWAYS_ASSERT(lev &gt; 0);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160; </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a43d0b17f6e155691a1e9474526df3af5">verbose</a>) {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        amrex::Print() &lt;&lt;<span class="stringliteral">&quot; NEW BA FROM COARSE AT LEVEL &quot;</span> &lt;&lt; lev &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; ba &lt;&lt; std::endl;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    }</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="comment">//********************************************************************************************</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="comment">// This allocates all kinds of things, including but not limited to: solution arrays,</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="comment">//      terrain arrays, metric terms and base state.</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="comment">// *******************************************************************************************</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <a class="code" href="classERF.html#aaf237fbe118d80f149295c0579608579">init_stuff</a>(lev, ba, dm, <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev], <a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev], <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev], <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev]);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev] = time;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <a class="code" href="classERF.html#a7085d7d5fc94a0f84efc06957267d58e">t_old</a>[lev] = time - 1.e200;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="comment">// Build the data structures for metric quantities used with terrain-fitted coordinates</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> == TerrainType::EB ||</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;         <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> == TerrainType::ImmersedForcing)</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    {</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <span class="keyword">const</span> amrex::EB2::IndexSpace&amp; ebis = amrex::EB2::IndexSpace::top();</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <span class="keyword">const</span> EB2::Level&amp; eb_level = ebis.getLevel(geom[lev]);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> == TerrainType::EB) {</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            <a class="code" href="classERF.html#a32317cbd11fb55fe60a00c0925189859">eb</a>[lev]-&gt;make_all_factories(lev, geom[lev], ba, dm, eb_level);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> == TerrainType::ImmersedForcing) {</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            <a class="code" href="classERF.html#a32317cbd11fb55fe60a00c0925189859">eb</a>[lev]-&gt;make_cc_factory(lev, geom[lev], ba, dm, eb_level);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        }</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    }</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <a class="code" href="classERF.html#a8f50cd1ba85fbf9ae0579a56ba06eb1b">init_zphys</a>(lev, time);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <a class="code" href="classERF.html#a7dba7f9e6bd3f6898fac9ac2efcec692">update_terrain_arrays</a>(lev);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="comment">// Make sure that detJ and z_phys_cc are the average of the data on a finer level if there is one</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structSolverChoice.html#a1952672901901b0b3a628f2298dc72c2">SolverChoice::mesh_type</a> != MeshType::ConstantDz) {</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> crse_lev = lev-1; crse_lev &gt;= 0; crse_lev--) {</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            average_down(  *<a class="code" href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">detJ_cc</a>[crse_lev+1],   *<a class="code" href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">detJ_cc</a>[crse_lev], 0, 1, refRatio(crse_lev));</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            average_down(*<a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[crse_lev+1], *<a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[crse_lev], 0, 1, refRatio(crse_lev));</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        }</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    }</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160; </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="comment">// Build the data structures for canopy model (depends upon z_phys)</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aed9118172b234c3a0069a78776d09baa">do_forest_drag</a>) {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <a class="code" href="classERF.html#a8b181e6ed0bb62d79e4a62555210abc9">m_forest_drag</a>[lev]-&gt;define_drag_field(ba, dm, geom[lev], <a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[lev].get(), <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev].get());</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    }</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="comment">//********************************************************************************************</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="comment">// Microphysics</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="comment">// *******************************************************************************************</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keywordtype">int</span> q_size  = <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;Get_Qmoist_Size(lev);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <a class="code" href="classERF.html#ae00126a9c2738bf6a6cbbe77321c9cfc">qmoist</a>[lev].resize(q_size);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;Define(lev, <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> != MoistureType::None)</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    {</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;Init(lev, <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                    grids[lev], Geom(lev), 0.0,</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                    <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev], <a class="code" href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">detJ_cc</a>[lev]); <span class="comment">// dummy dt value</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    }</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> mvar(0); mvar&lt;<a class="code" href="classERF.html#ae00126a9c2738bf6a6cbbe77321c9cfc">qmoist</a>[lev].size(); ++mvar) {</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        <a class="code" href="classERF.html#ae00126a9c2738bf6a6cbbe77321c9cfc">qmoist</a>[lev][mvar] = <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;Get_Qmoist_Ptr(lev,mvar);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    }</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="comment">// *****************************************************************************************************</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="comment">// Initialize the boundary conditions (after initializing the terrain but before calling</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="comment">//     initHSE or FillCoarsePatch)</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="comment">// *****************************************************************************************************</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <a class="code" href="classERF.html#ac81ec7f74a1be1c4a1e6e15e08385ed5">make_physbcs</a>(lev);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160; </div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="comment">// Update the base state at this level by interpolation from coarser level</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    InterpFromCoarseLevel(<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev], <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].nGrowVect(),</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                            IntVect(0,0,0), <span class="comment">// do not fill ghost cells outside the domain</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                            <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev-1], 0, 0, <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].nComp(),</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                            geom[lev-1], geom[lev],</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                            refRatio(lev-1), &amp;cell_cons_interp,</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                            <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>, <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160; </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="comment">// Impose bc&#39;s outside the domain</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    (*<a class="code" href="classERF.html#af4e7dc93dae16aa2cc94bbb20b699a6f">physbcs_base</a>[lev])(<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev],0,<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].nComp(),<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].nGrowVect());</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="comment">// Build the data structures for calculating diffusive/turbulent terms</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <a class="code" href="classERF.html#a419510fced05e9afc05c466beeeb66f7">update_diffusive_arrays</a>(lev, ba, dm);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160; </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="comment">// Fill data at the new level by interpolation from the coarser level</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="comment">// Note that internal to FillCoarsePatch we will convert velocity to momentum,</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="comment">//      then interpolate momentum, then convert momentum back to velocity</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="comment">// Also note that FillCoarsePatch is hard-wired to act only on lev_new at coarse and fine</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <a class="code" href="classERF.html#ac4497025ab94461899960ee067c2c72a">FillCoarsePatch</a>(lev, time);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160; </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="comment">// Initialize the integrator class</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <a class="code" href="classERF.html#a3cf7cb2e51eb7b69cb4079ffc6722459">dt_mri_ratio</a>[lev] = <a class="code" href="classERF.html#a3cf7cb2e51eb7b69cb4079ffc6722459">dt_mri_ratio</a>[lev-1];</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <a class="code" href="classERF.html#a5600f8ce250d4811012719fdf5e85f00">initialize_integrator</a>(lev, <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>]);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160; </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="comment">// If we are making a new level then the FillPatcher for this level hasn&#39;t been allocated yet</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keywordflow">if</span> (lev &gt; 0 &amp;&amp; <a class="code" href="classERF.html#ad9084179f7384e10a519989ffd51fd34">cf_width</a> &gt;= 0) {</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        <a class="code" href="classERF.html#adc284f421c5fd9dd15c0e5cbe4ff5fc8">Construct_ERFFillPatchers</a>(lev);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;           <a class="code" href="classERF.html#ac0951404aa6802aad7a3be6b7375dfa2">Define_ERFFillPatchers</a>(lev);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    }</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160; </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="comment">// Create the SurfaceLayer arrays at this (new) level</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[Orientation(Direction::z,Orientation::low)] == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9af69483cb4bb9623dc65e76ce5bd0a3d5">ERF_BC::surface_layer</a>) {</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        <span class="keywordtype">int</span> nlevs = finest_level+1;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        Vector&lt;MultiFab*&gt; mfv_old = {&amp;<a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], &amp;<a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                                     &amp;<a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>], &amp;<a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>]};</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <a class="code" href="classERF.html#ac50bb696daf587e13f9a1e57c687375e">m_SurfaceLayer</a>-&gt;make_SurfaceLayer_at_level(lev,nlevs,</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                                                   mfv_old, <a class="code" href="classERF.html#a71629ae2fda396472198691b75d83b2e">Theta_prim</a>[lev], <a class="code" href="classERF.html#a521d1faf157e3bccc86c0f26ee923576">Qv_prim</a>[lev],</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                                                   <a class="code" href="classERF.html#a57d8432920785f8e58cf11a3232d76b5">Qr_prim</a>[lev], <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev],</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                                                   <a class="code" href="classERF.html#aef05cf88e9e9d2b56112336761493977">Hwave</a>[lev].get(), <a class="code" href="classERF.html#ad67b414a1a8b5bab6edeaf574f922825">Lwave</a>[lev].get(), <a class="code" href="classERF.html#a327d704704abd516be19339cb2d226f9">eddyDiffs_lev</a>[lev].get(),</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                                                   <a class="code" href="classERF.html#ad03da3399e893728741fac33100ce476">lsm_data</a>[lev], <a class="code" href="classERF.html#aa5f6a6ceae0087393f386649d8bbbc31">lsm_flux</a>[lev], <a class="code" href="classERF.html#a5a5395054a212d8f3fc577562c14b66e">sst_lev</a>[lev], <a class="code" href="classERF.html#af89fb8b555dde334c978cdfd3fcd9d07">tsk_lev</a>[lev], <a class="code" href="classERF.html#a3f3e29874221e43e13e2a431e77e0e4e">lmask_lev</a>[lev]);</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    }</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160; </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="preprocessor">#ifdef ERF_USE_PARTICLES</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="comment">// particleData.Redistribute();</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_a419510fced05e9afc05c466beeeb66f7"><div class="ttname"><a href="classERF.html#a419510fced05e9afc05c466beeeb66f7">ERF::update_diffusive_arrays</a></div><div class="ttdeci">void update_diffusive_arrays(int lev, const amrex::BoxArray &amp;ba, const amrex::DistributionMapping &amp;dm)</div><div class="ttdef"><b>Definition:</b> ERF_MakeNewArrays.cpp:424</div></div>
<div class="ttc" id="aclassERF_html_a5600f8ce250d4811012719fdf5e85f00"><div class="ttname"><a href="classERF.html#a5600f8ce250d4811012719fdf5e85f00">ERF::initialize_integrator</a></div><div class="ttdeci">void initialize_integrator(int lev, amrex::MultiFab &amp;cons_mf, amrex::MultiFab &amp;vel_mf)</div><div class="ttdef"><b>Definition:</b> ERF_MakeNewArrays.cpp:630</div></div>
<div class="ttc" id="aclassERF_html_a7dba7f9e6bd3f6898fac9ac2efcec692"><div class="ttname"><a href="classERF.html#a7dba7f9e6bd3f6898fac9ac2efcec692">ERF::update_terrain_arrays</a></div><div class="ttdeci">void update_terrain_arrays(int lev)</div><div class="ttdef"><b>Definition:</b> ERF_MakeNewArrays.cpp:619</div></div>
<div class="ttc" id="aclassERF_html_a8f50cd1ba85fbf9ae0579a56ba06eb1b"><div class="ttname"><a href="classERF.html#a8f50cd1ba85fbf9ae0579a56ba06eb1b">ERF::init_zphys</a></div><div class="ttdeci">void init_zphys(int lev, amrex::Real time)</div><div class="ttdef"><b>Definition:</b> ERF_MakeNewArrays.cpp:514</div></div>
<div class="ttc" id="aclassERF_html_aaf237fbe118d80f149295c0579608579"><div class="ttname"><a href="classERF.html#aaf237fbe118d80f149295c0579608579">ERF::init_stuff</a></div><div class="ttdeci">void init_stuff(int lev, const amrex::BoxArray &amp;ba, const amrex::DistributionMapping &amp;dm, amrex::Vector&lt; amrex::MultiFab &gt; &amp;lev_new, amrex::Vector&lt; amrex::MultiFab &gt; &amp;lev_old, amrex::MultiFab &amp;tmp_base_state, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;tmp_zphys_nd)</div><div class="ttdef"><b>Definition:</b> ERF_MakeNewArrays.cpp:24</div></div>
<div class="ttc" id="aclassERF_html_ac0951404aa6802aad7a3be6b7375dfa2"><div class="ttname"><a href="classERF.html#ac0951404aa6802aad7a3be6b7375dfa2">ERF::Define_ERFFillPatchers</a></div><div class="ttdeci">void Define_ERFFillPatchers(int lev)</div><div class="ttdef"><b>Definition:</b> ERF.cpp:2207</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aaf10bbf8c9a5dbc257a88c4c1b650fee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf10bbf8c9a5dbc257a88c4c1b650fee">&#9670;&nbsp;</a></span>MakeNewLevelFromScratch()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::MakeNewLevelFromScratch </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::BoxArray &amp;&#160;</td>
          <td class="paramname"><em>ba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::DistributionMapping &amp;&#160;</td>
          <td class="paramname"><em>dm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;{</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    BoxArray ba;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    DistributionMapping dm;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    Box domain(Geom(0).Domain());</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="keywordflow">if</span> (lev == 0 &amp;&amp; <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>.empty() &amp;&amp;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        (max_grid_size[0][0] &gt;= domain.length(0)) &amp;&amp;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        (max_grid_size[0][1] &gt;= domain.length(1)) &amp;&amp;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        ba_in.size() != ParallelDescriptor::NProcs())</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    {</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        <span class="comment">// We only decompose in z if max_grid_size_z indicates we should</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        <span class="keywordtype">bool</span> decompose_in_z = (max_grid_size[0][2] &lt; domain.length(2));</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        ba = <a class="code" href="ERF__ChopGrids_8cpp.html#a140e3056fee7f1dcd5a295d2efdaf0b2">ERFPostProcessBaseGrids</a>(Geom(0).Domain(),decompose_in_z);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        dm = DistributionMapping(ba);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        ba = ba_in;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        dm = dm_in;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    }</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="comment">// Define grids[lev] to be ba</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    SetBoxArray(lev, ba);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="comment">// Define dmap[lev] to be dm</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    SetDistributionMap(lev, dm);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a43d0b17f6e155691a1e9474526df3af5">verbose</a>) {</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        amrex::Print() &lt;&lt;<span class="stringliteral">&quot; BA FROM SCRATCH AT LEVEL &quot;</span> &lt;&lt; lev &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; ba &lt;&lt; std::endl;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    }</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keywordflow">if</span> (lev == 0) <a class="code" href="classERF.html#a618e8fdff3239cc79d4145d02b1ecaa2">init_bcs</a>();</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> == TerrainType::EB ||</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;         <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> == TerrainType::ImmersedForcing)</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <span class="keyword">const</span> amrex::EB2::IndexSpace&amp; ebis = amrex::EB2::IndexSpace::top();</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <span class="keyword">const</span> EB2::Level&amp; eb_level = ebis.getLevel(geom[lev]);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> == TerrainType::EB) {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;            <a class="code" href="classERF.html#a32317cbd11fb55fe60a00c0925189859">eb</a>[lev]-&gt;make_all_factories(lev, geom[lev], grids[lev], dmap[lev], eb_level);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> == TerrainType::ImmersedForcing) {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;            <a class="code" href="classERF.html#a32317cbd11fb55fe60a00c0925189859">eb</a>[lev]-&gt;make_cc_factory(lev, geom[lev], grids[lev], dmap[lev], eb_level);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        }</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <span class="comment">// m_factory[lev] = std::make_unique&lt;FabFactory&lt;FArrayBox&gt;&gt;();</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    }</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keyword">auto</span>&amp; lev_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev];</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keyword">auto</span>&amp; lev_old = <a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev];</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="comment">//********************************************************************************************</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="comment">// This allocates all kinds of things, including but not limited to: solution arrays,</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="comment">//      terrain arrays, metric terms and base state.</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="comment">// *******************************************************************************************</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <a class="code" href="classERF.html#aaf237fbe118d80f149295c0579608579">init_stuff</a>(lev, ba, dm, lev_new, lev_old, <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev], <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev]);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="comment">//********************************************************************************************</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">// Land Surface Model</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="comment">// *******************************************************************************************</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordtype">int</span> lsm_size  = <a class="code" href="classERF.html#ae0e9a78f120ba632d78cbf23c97b851c">lsm</a>.<a class="code" href="classLandSurface.html#a2652af07555cc98d15d3516371fa42e6">Get_Data_Size</a>();</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <a class="code" href="classERF.html#ad03da3399e893728741fac33100ce476">lsm_data</a>[lev].resize(lsm_size);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <a class="code" href="classERF.html#aa5f6a6ceae0087393f386649d8bbbc31">lsm_flux</a>[lev].resize(lsm_size);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <a class="code" href="classERF.html#ae0e9a78f120ba632d78cbf23c97b851c">lsm</a>.<a class="code" href="classLandSurface.html#ae2087847b83c6a9e4453ccaa110134ce">Define</a>(lev, <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a43c1741535574c7e6f4fe6bf90552f31">lsm_type</a> != LandSurfaceType::None)</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <a class="code" href="classERF.html#ae0e9a78f120ba632d78cbf23c97b851c">lsm</a>.<a class="code" href="classLandSurface.html#aac1216f5c2758361ddc016442f3c67cd">Init</a>(lev, <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], Geom(lev), 0.0); <span class="comment">// dummy dt value</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    }</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> mvar(0); mvar&lt;<a class="code" href="classERF.html#ad03da3399e893728741fac33100ce476">lsm_data</a>[lev].size(); ++mvar) {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <a class="code" href="classERF.html#ad03da3399e893728741fac33100ce476">lsm_data</a>[lev][mvar] = <a class="code" href="classERF.html#ae0e9a78f120ba632d78cbf23c97b851c">lsm</a>.<a class="code" href="classLandSurface.html#af125bc0c5860b3564afdfce10ec253ea">Get_Data_Ptr</a>(lev,mvar);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <a class="code" href="classERF.html#aa5f6a6ceae0087393f386649d8bbbc31">lsm_flux</a>[lev][mvar] = <a class="code" href="classERF.html#ae0e9a78f120ba632d78cbf23c97b851c">lsm</a>.<a class="code" href="classLandSurface.html#a967a4b0772dc721d0242d38613ac430e">Get_Flux_Ptr</a>(lev,mvar);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    }</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="comment">// Build the data structures for calculating diffusive/turbulent terms</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <a class="code" href="classERF.html#a419510fced05e9afc05c466beeeb66f7">update_diffusive_arrays</a>(lev, ba, dm);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="comment">// Build the data structures for holding sea surface temps and skin temps</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <a class="code" href="classERF.html#a5a5395054a212d8f3fc577562c14b66e">sst_lev</a>[lev].resize(1);     <a class="code" href="classERF.html#a5a5395054a212d8f3fc577562c14b66e">sst_lev</a>[lev][0] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <a class="code" href="classERF.html#af89fb8b555dde334c978cdfd3fcd9d07">tsk_lev</a>[lev].resize(1);     <a class="code" href="classERF.html#af89fb8b555dde334c978cdfd3fcd9d07">tsk_lev</a>[lev][0] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="comment">// Thin immersed body</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="comment">// *******************************************************************************************</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <a class="code" href="classERF.html#af4f87fb01d61c18d8eb85ac5ac159785">init_thin_body</a>(lev, ba, dm);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="comment">// Initialize the integrator class</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <a class="code" href="classERF.html#a5600f8ce250d4811012719fdf5e85f00">initialize_integrator</a>(lev, lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>]);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="comment">// Initialize the data itself</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="comment">// If (init_type == InitType::WRFInput) then we are initializing terrain and the initial data in</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="comment">//                                      the same call so we must call init_only before update_terrain_arrays</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="comment">// If (init_type != InitType::WRFInput) then we want to initialize the terrain before the initial data</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="comment">//                                      since we may need to use the grid information before constructing</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="comment">//                                      initial idealized data</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>.empty()) {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <span class="keywordflow">if</span> ( (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac1ddc9c301ac98689bf3b7b7184b24e1">init_type</a> == InitType::WRFInput) || (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac1ddc9c301ac98689bf3b7b7184b24e1">init_type</a> == InitType::Metgrid) )</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            AMREX_ALWAYS_ASSERT(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> == TerrainType::StaticFittedMesh);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            <a class="code" href="classERF.html#a80981e20939a6a38ba17478da2253ff1">init_only</a>(lev, <a class="code" href="classERF.html#aa0c07f31b23d977646b8161e5473fab5">start_time</a>);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            <a class="code" href="classERF.html#a8f50cd1ba85fbf9ae0579a56ba06eb1b">init_zphys</a>(lev, time);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            <a class="code" href="classERF.html#a7dba7f9e6bd3f6898fac9ac2efcec692">update_terrain_arrays</a>(lev);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            <a class="code" href="classERF.html#ac81ec7f74a1be1c4a1e6e15e08385ed5">make_physbcs</a>(lev);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            <a class="code" href="classERF.html#a8f50cd1ba85fbf9ae0579a56ba06eb1b">init_zphys</a>(lev, time);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            <a class="code" href="classERF.html#a7dba7f9e6bd3f6898fac9ac2efcec692">update_terrain_arrays</a>(lev);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            <span class="comment">// Note that for init_type != InitType::WRFInput and != InitType::Metgrid,</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            <span class="comment">// make_physbcs is called inside init_only</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            <a class="code" href="classERF.html#a80981e20939a6a38ba17478da2253ff1">init_only</a>(lev, <a class="code" href="classERF.html#aa0c07f31b23d977646b8161e5473fab5">start_time</a>);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        }</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <span class="comment">// if restarting and nudging from input sounding, load the input sounding files</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="keywordflow">if</span> (lev == 0 &amp;&amp; <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac1ddc9c301ac98689bf3b7b7184b24e1">init_type</a> == InitType::Input_Sounding &amp;&amp; <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a5a9eef80b6339778c29acb7fb87dd9f1">nudging_from_input_sounding</a>)</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a83572d8dfad51158945b4a5ab06b2f72">input_sounding_data</a>.<a class="code" href="structInputSoundingData.html#a704d3ca6f9b6a480ad2f8c5e4b4e32f1">input_sounding_file</a>.empty()) {</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                Error(<span class="stringliteral">&quot;input_sounding file name must be provided via input&quot;</span>);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            }</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            <a class="code" href="classERF.html#a83572d8dfad51158945b4a5ab06b2f72">input_sounding_data</a>.<a class="code" href="structInputSoundingData.html#a42fe67445aa283176274575444cbf7ef">resize_arrays</a>();</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            <span class="comment">// this will interpolate the input profiles to the nominal height levels</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            <span class="comment">// (ranging from 0 to the domain top)</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; <a class="code" href="classERF.html#a83572d8dfad51158945b4a5ab06b2f72">input_sounding_data</a>.<a class="code" href="structInputSoundingData.html#a5655f2f77d75c1b8a2abd92a0b264813">n_sounding_files</a>; n++) {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                <a class="code" href="classERF.html#a83572d8dfad51158945b4a5ab06b2f72">input_sounding_data</a>.<a class="code" href="structInputSoundingData.html#a6742e8e0e37fd817097963bbd965692c">read_from_file</a>(geom[lev], <a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[lev], n);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            <span class="comment">// this will calculate the hydrostatically balanced density and pressure</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            <span class="comment">// profiles following WRF ideal.exe</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a2eb81c590271b429f132103c9af25830">init_sounding_ideal</a>) <a class="code" href="classERF.html#a83572d8dfad51158945b4a5ab06b2f72">input_sounding_data</a>.<a class="code" href="structInputSoundingData.html#a830608de7ca272770d8ddb659d65eb31">calc_rho_p</a>(0);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        }</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="comment">// We re-create terrain_blanking on restart rather than storing it in the checkpoint</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> == TerrainType::ImmersedForcing) {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            <span class="keywordtype">int</span> ngrow = <a class="code" href="classERF.html#aaad87d9eb7e20af21deb83d72f94801c">ComputeGhostCells</a>(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>) + 2;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            <a class="code" href="classERF.html#a4a18cc3befd0911ccb011f9bb3b2efc2">terrain_blanking</a>[lev]-&gt;setVal(1.0);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            MultiFab::Subtract(*<a class="code" href="classERF.html#a4a18cc3befd0911ccb011f9bb3b2efc2">terrain_blanking</a>[lev], <a class="code" href="classERF.html#ad024dd413ab20e5d6f69c1f96e5b78a3">EBFactory</a>(lev).getVolFrac(), 0, 0, 1, ngrow);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            <a class="code" href="classERF.html#a4a18cc3befd0911ccb011f9bb3b2efc2">terrain_blanking</a>[lev]-&gt;FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    }</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;     <span class="comment">// Read in tables needed for windfarm simulations</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="comment">// fill in Nturb multifab - number of turbines in each mesh cell</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="comment">// write out the vtk files for wind turbine location and/or</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="comment">// actuator disks</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="preprocessor">    #ifdef ERF_USE_WINDFARM</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        init_windfarm(lev);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="comment">// Build the data structures for canopy model (depends upon z_phys)</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>.empty()) {</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aed9118172b234c3a0069a78776d09baa">do_forest_drag</a>) {</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            <a class="code" href="classERF.html#a8b181e6ed0bb62d79e4a62555210abc9">m_forest_drag</a>[lev]-&gt;define_drag_field(ba, dm, geom[lev], <a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[lev].get(), <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev].get());</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        }</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    }</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="comment">//********************************************************************************************</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="comment">// Create wall distance field for RANS model (depends upon z_phys)</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="comment">// *******************************************************************************************</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa53b017d79e0067923180a0aa59367b4">turbChoice</a>[lev].rans_type != RANSType::None) {</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <span class="comment">// Handle bottom boundary</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <a class="code" href="classERF.html#a984c145a81739ab4c7f8fd03a334d239">poisson_wall_dist</a>(lev);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <span class="comment">// Correct the wall distance for immersed bodies</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a94de4907b3d6742071d5542b60e8f393">have_zero_flux_faces</a>) {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            <a class="code" href="ERF__ThinBodyWallDist_8cpp.html#ac7d883d31653c6ddcbb78bebbdf9339c">thinbody_wall_dist</a>(<a class="code" href="classERF.html#a0276b556fdefec8b99be95846a3a35fe">walldist</a>[lev],</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                               <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a7a086b9e2aabb65d2e5e9053e7bd6018">zero_xflux</a>,</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                               <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a118575fe302e72fcd231e77be6d117a9">zero_yflux</a>,</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                               <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a7da4e5242e05aeba4822b71fab596954">zero_zflux</a>,</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                               geom[lev],</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                               <a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[lev]);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        }</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    }</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160; </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="comment">//********************************************************************************************</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="comment">// Microphysics</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="comment">// *******************************************************************************************</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordtype">int</span> q_size  = <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;Get_Qmoist_Size(lev);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <a class="code" href="classERF.html#ae00126a9c2738bf6a6cbbe77321c9cfc">qmoist</a>[lev].resize(q_size);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;Define(lev, <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> != MoistureType::None)</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    {</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;Init(lev, <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                    grids[lev], Geom(lev), 0.0,</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                    <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev], <a class="code" href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">detJ_cc</a>[lev]); <span class="comment">// dummy dt value</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    }</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> mvar(0); mvar&lt;<a class="code" href="classERF.html#ae00126a9c2738bf6a6cbbe77321c9cfc">qmoist</a>[lev].size(); ++mvar) {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <a class="code" href="classERF.html#ae00126a9c2738bf6a6cbbe77321c9cfc">qmoist</a>[lev][mvar] = <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;Get_Qmoist_Ptr(lev,mvar);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    }</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="comment">//********************************************************************************************</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="comment">// Radiation</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="comment">// *******************************************************************************************</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a31c93846e0129221632347d2378e881d">rad_type</a> != RadiationType::None)</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    {</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <a class="code" href="classERF.html#a609b41a1de9c6b28f23dcdc6843f9ef5">rad</a>[lev]-&gt;Init(geom[lev], ba, &amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>]);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    }</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="comment">// If we are making a new level then the FillPatcher for this level hasn&#39;t been allocated yet</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordflow">if</span> (lev &gt; 0 &amp;&amp; <a class="code" href="classERF.html#ad9084179f7384e10a519989ffd51fd34">cf_width</a> &gt;= 0) {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <a class="code" href="classERF.html#adc284f421c5fd9dd15c0e5cbe4ff5fc8">Construct_ERFFillPatchers</a>(lev);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;           <a class="code" href="classERF.html#ac0951404aa6802aad7a3be6b7375dfa2">Define_ERFFillPatchers</a>(lev);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    }</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="preprocessor">#ifdef ERF_USE_PARTICLES</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>.empty()) {</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <span class="keywordflow">if</span> (lev == 0) {</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            initializeTracers((ParGDBBase*)GetParGDB(),<a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            particleData.Redistribute();</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        }</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    }</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;}</div>
<div class="ttc" id="aERF__ChopGrids_8cpp_html_a140e3056fee7f1dcd5a295d2efdaf0b2"><div class="ttname"><a href="ERF__ChopGrids_8cpp.html#a140e3056fee7f1dcd5a295d2efdaf0b2">ERFPostProcessBaseGrids</a></div><div class="ttdeci">BoxArray ERFPostProcessBaseGrids(const Box &amp;domain, bool decompose_in_z)</div><div class="ttdef"><b>Definition:</b> ERF_ChopGrids.cpp:6</div></div>
<div class="ttc" id="aERF__ThinBodyWallDist_8cpp_html_ac7d883d31653c6ddcbb78bebbdf9339c"><div class="ttname"><a href="ERF__ThinBodyWallDist_8cpp.html#ac7d883d31653c6ddcbb78bebbdf9339c">thinbody_wall_dist</a></div><div class="ttdeci">void thinbody_wall_dist(std::unique_ptr&lt; MultiFab &gt; &amp;wdist, Vector&lt; IntVect &gt; &amp;xfaces, Vector&lt; IntVect &gt; &amp;yfaces, Vector&lt; IntVect &gt; &amp;zfaces, const Geometry &amp;geomdata, std::unique_ptr&lt; MultiFab &gt; &amp;z_phys_cc)</div><div class="ttdef"><b>Definition:</b> ERF_ThinBodyWallDist.cpp:12</div></div>
<div class="ttc" id="aclassERF_html_a80981e20939a6a38ba17478da2253ff1"><div class="ttname"><a href="classERF.html#a80981e20939a6a38ba17478da2253ff1">ERF::init_only</a></div><div class="ttdeci">void init_only(int lev, amrex::Real time)</div><div class="ttdef"><b>Definition:</b> ERF.cpp:1529</div></div>
<div class="ttc" id="aclassERF_html_a984c145a81739ab4c7f8fd03a334d239"><div class="ttname"><a href="classERF.html#a984c145a81739ab4c7f8fd03a334d239">ERF::poisson_wall_dist</a></div><div class="ttdeci">void poisson_wall_dist(int lev)</div><div class="ttdef"><b>Definition:</b> ERF_PoissonWallDist.cpp:20</div></div>
<div class="ttc" id="aclassERF_html_af4f87fb01d61c18d8eb85ac5ac159785"><div class="ttname"><a href="classERF.html#af4f87fb01d61c18d8eb85ac5ac159785">ERF::init_thin_body</a></div><div class="ttdeci">void init_thin_body(int lev, const amrex::BoxArray &amp;ba, const amrex::DistributionMapping &amp;dm)</div><div class="ttdef"><b>Definition:</b> ERF_MakeNewLevel.cpp:640</div></div>
<div class="ttc" id="aclassLandSurface_html_a2652af07555cc98d15d3516371fa42e6"><div class="ttname"><a href="classLandSurface.html#a2652af07555cc98d15d3516371fa42e6">LandSurface::Get_Data_Size</a></div><div class="ttdeci">int Get_Data_Size()</div><div class="ttdef"><b>Definition:</b> ERF_LandSurface.H:92</div></div>
<div class="ttc" id="aclassLandSurface_html_a967a4b0772dc721d0242d38613ac430e"><div class="ttname"><a href="classLandSurface.html#a967a4b0772dc721d0242d38613ac430e">LandSurface::Get_Flux_Ptr</a></div><div class="ttdeci">amrex::MultiFab * Get_Flux_Ptr(const int &amp;lev, const int &amp;varIdx)</div><div class="ttdef"><b>Definition:</b> ERF_LandSurface.H:86</div></div>
<div class="ttc" id="aclassLandSurface_html_aac1216f5c2758361ddc016442f3c67cd"><div class="ttname"><a href="classLandSurface.html#aac1216f5c2758361ddc016442f3c67cd">LandSurface::Init</a></div><div class="ttdeci">void Init(const int &amp;lev, const amrex::MultiFab &amp;cons_in, const amrex::Geometry &amp;geom, const amrex::Real &amp;dt_advance)</div><div class="ttdef"><b>Definition:</b> ERF_LandSurface.H:43</div></div>
<div class="ttc" id="aclassLandSurface_html_ae2087847b83c6a9e4453ccaa110134ce"><div class="ttname"><a href="classLandSurface.html#ae2087847b83c6a9e4453ccaa110134ce">LandSurface::Define</a></div><div class="ttdeci">void Define(const int &amp;lev, SolverChoice &amp;sc)</div><div class="ttdef"><b>Definition:</b> ERF_LandSurface.H:36</div></div>
<div class="ttc" id="aclassLandSurface_html_af125bc0c5860b3564afdfce10ec253ea"><div class="ttname"><a href="classLandSurface.html#af125bc0c5860b3564afdfce10ec253ea">LandSurface::Get_Data_Ptr</a></div><div class="ttdeci">amrex::MultiFab * Get_Data_Ptr(const int &amp;lev, const int &amp;varIdx)</div><div class="ttdef"><b>Definition:</b> ERF_LandSurface.H:83</div></div>
<div class="ttc" id="astructSolverChoice_html_a5a9eef80b6339778c29acb7fb87dd9f1"><div class="ttname"><a href="structSolverChoice.html#a5a9eef80b6339778c29acb7fb87dd9f1">SolverChoice::nudging_from_input_sounding</a></div><div class="ttdeci">bool nudging_from_input_sounding</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:782</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_aaf10bbf8c9a5dbc257a88c4c1b650fee_cgraph.png" border="0" usemap="#aclassERF_aaf10bbf8c9a5dbc257a88c4c1b650fee_cgraph" alt=""/></div>
<map name="aclassERF_aaf10bbf8c9a5dbc257a88c4c1b650fee_cgraph" id="aclassERF_aaf10bbf8c9a5dbc257a88c4c1b650fee_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,240,57"/>
<area shape="rect" href="ERF__ChopGrids_8cpp.html#a140e3056fee7f1dcd5a295d2efdaf0b2" title=" " alt="" coords="288,5,479,32"/>
<area shape="rect" href="ERF__ThinBodyWallDist_8cpp.html#ac7d883d31653c6ddcbb78bebbdf9339c" title=" " alt="" coords="311,56,455,83"/>
</map>
</div>

</div>
</div>
<a id="a758170966de01c9030c39a3840d29395"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a758170966de01c9030c39a3840d29395">&#9670;&nbsp;</a></span>MakeVTKFilename()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string ERF::MakeVTKFilename </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nstep</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                              {</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="comment">// Ensure output directory exists</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <span class="keyword">const</span> std::string dir = <span class="stringliteral">&quot;Output_HurricaneTracker&quot;</span>;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="keywordflow">if</span> (!fs::exists(dir)) {</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        fs::create_directory(dir);</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    }</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160; </div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="comment">// Construct filename with zero-padded step</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    std::ostringstream oss;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="keywordflow">if</span>(nstep==0){</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        oss &lt;&lt; dir &lt;&lt; <span class="stringliteral">&quot;/hurricane_track_&quot;</span> &lt;&lt; std::setw(7) &lt;&lt; std::setfill(<span class="charliteral">&#39;0&#39;</span>) &lt;&lt; nstep &lt;&lt; <span class="stringliteral">&quot;.vtk&quot;</span>;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        oss &lt;&lt; dir &lt;&lt; <span class="stringliteral">&quot;/hurricane_track_&quot;</span> &lt;&lt; std::setw(7) &lt;&lt; std::setfill(<span class="charliteral">&#39;0&#39;</span>) &lt;&lt; nstep+1 &lt;&lt; <span class="stringliteral">&quot;.vtk&quot;</span>;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    }</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160; </div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <span class="keywordflow">return</span> oss.str();</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4601db3087123d6a13e492f742b30d57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4601db3087123d6a13e492f742b30d57">&#9670;&nbsp;</a></span>nghost_eb_basic()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ERF::nghost_eb_basic </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;    { <span class="keywordflow">return</span> 5; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aae2f7aa83a893d93b92761cd311f4790"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae2f7aa83a893d93b92761cd311f4790">&#9670;&nbsp;</a></span>nghost_eb_full()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ERF::nghost_eb_full </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;    { <span class="keywordflow">return</span> 4; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aaa99507cc3dcb872b74a5491355cd4aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa99507cc3dcb872b74a5491355cd4aa">&#9670;&nbsp;</a></span>nghost_eb_volume()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ERF::nghost_eb_volume </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    { <span class="keywordflow">return</span> 5; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac1238c1616826c66df1dfd9076e6a3da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1238c1616826c66df1dfd9076e6a3da">&#9670;&nbsp;</a></span>NumDataLogs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">AMREX_FORCE_INLINE int ERF::NumDataLogs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;    {</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classERF.html#a1cade630b005dbcc0f644987ef3db287">datalog</a>.size();</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="acf7926f64e3747680861aba9afe5d219"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf7926f64e3747680861aba9afe5d219">&#9670;&nbsp;</a></span>NumDerDataLogs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">AMREX_FORCE_INLINE int ERF::NumDerDataLogs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    {</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classERF.html#ab33e7fff801543a43961ca6d7cac818f">der_datalog</a>.size();</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a14f922bdc3a0f23c087afa32c67ac119"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14f922bdc3a0f23c087afa32c67ac119">&#9670;&nbsp;</a></span>NumSampleLineLogs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">AMREX_FORCE_INLINE int ERF::NumSampleLineLogs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    {</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classERF.html#a4990f1796b65ec8ee602f177a66afc3e">samplelinelog</a>.size();</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a70d78ca624acf09d8faab9a2d51264d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70d78ca624acf09d8faab9a2d51264d9">&#9670;&nbsp;</a></span>NumSampleLines()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">AMREX_FORCE_INLINE int ERF::NumSampleLines </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;    {</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classERF.html#a0fa1582bb13357895d2aba91b695624a">sampleline</a>.size();</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a41324a4b5610fde725fe721550b23c85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41324a4b5610fde725fe721550b23c85">&#9670;&nbsp;</a></span>NumSamplePointLogs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">AMREX_FORCE_INLINE int ERF::NumSamplePointLogs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;    {</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classERF.html#a9737ddb0de6b9e8a5b17c109d5ad3e08">sampleptlog</a>.size();</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5bc7dd2c7e1ebf65b7dc1d9bf0dfb36f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5bc7dd2c7e1ebf65b7dc1d9bf0dfb36f">&#9670;&nbsp;</a></span>NumSamplePoints()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">AMREX_FORCE_INLINE int ERF::NumSamplePoints </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    {</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classERF.html#ae8a57b7fbf5a67c99d04b7d4f43ad100">samplepoint</a>.size();</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a72fcc41d6f5225e9ca3b8c9111ff37e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72fcc41d6f5225e9ca3b8c9111ff37e7">&#9670;&nbsp;</a></span>operator=() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classERF.html">ERF</a>&amp; ERF::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classERF.html">ERF</a> &amp;&#160;</td>
          <td class="paramname"><em>other</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="abbc40e6fe700b80e3666dd3723624f05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abbc40e6fe700b80e3666dd3723624f05">&#9670;&nbsp;</a></span>operator=() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classERF.html">ERF</a>&amp; ERF::operator= </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classERF.html">ERF</a> &amp;&amp;&#160;</td>
          <td class="paramname"><em>other</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ad71a033b3fd107465a8621eaf7c77b28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad71a033b3fd107465a8621eaf7c77b28">&#9670;&nbsp;</a></span>ParameterSanityChecks()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::ParameterSanityChecks </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;{</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;    AMREX_ALWAYS_ASSERT(<a class="code" href="classERF.html#a89f605d1a1eae06a7c79f9b6b65c637f">cfl</a> &gt; 0. || <a class="code" href="classERF.html#a393b540493795b8c6ee0f64634b8b815">fixed_dt</a>[0] &gt; 0.);</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160; </div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;    <span class="comment">// We don&#39;t allow use_real_bcs to be true if init_type is not either InitType::WRFInput or InitType::Metgrid</span></div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;    AMREX_ALWAYS_ASSERT( !<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ad57b63939b19e90b87dd61d3f293b0d7">use_real_bcs</a> ||</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;                        ((<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac1ddc9c301ac98689bf3b7b7184b24e1">init_type</a> == InitType::WRFInput) || (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac1ddc9c301ac98689bf3b7b7184b24e1">init_type</a> == InitType::Metgrid)) );</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160; </div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;    AMREX_ALWAYS_ASSERT(<a class="code" href="classERF.html#abb15119348ad5399947bc8883084b230">real_width</a> &gt;= 0);</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;    AMREX_ALWAYS_ASSERT(<a class="code" href="classERF.html#acab120bb9324e7298534d765c447d703">real_set_width</a> &gt;= 0);</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;    AMREX_ALWAYS_ASSERT(<a class="code" href="classERF.html#abb15119348ad5399947bc8883084b230">real_width</a> &gt;= <a class="code" href="classERF.html#acab120bb9324e7298534d765c447d703">real_set_width</a>);</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160; </div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ad9084179f7384e10a519989ffd51fd34">cf_width</a> &lt; 0 || <a class="code" href="classERF.html#a1e3e2855b6e811596226c167573ad62d">cf_set_width</a> &lt; 0 || <a class="code" href="classERF.html#ad9084179f7384e10a519989ffd51fd34">cf_width</a> &lt; <a class="code" href="classERF.html#a1e3e2855b6e811596226c167573ad62d">cf_set_width</a>) {</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;        Abort(<span class="stringliteral">&quot;You must set cf_width &gt;= cf_set_width &gt;= 0&quot;</span>);</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;    }</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;    <span class="keywordflow">if</span> (max_level &gt; 0 &amp;&amp; <a class="code" href="classERF.html#a1e3e2855b6e811596226c167573ad62d">cf_set_width</a> &gt; 0) {</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 1; lev &lt;= max_level; lev++) {</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a1e3e2855b6e811596226c167573ad62d">cf_set_width</a>%ref_ratio[lev-1][0] != 0 ||</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;                <a class="code" href="classERF.html#a1e3e2855b6e811596226c167573ad62d">cf_set_width</a>%ref_ratio[lev-1][1] != 0 ||</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;                <a class="code" href="classERF.html#a1e3e2855b6e811596226c167573ad62d">cf_set_width</a>%ref_ratio[lev-1][2] != 0 ) {</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;                Abort(<span class="stringliteral">&quot;You must set cf_width to be a multiple of ref_ratio&quot;</span>);</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;            }</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;        }</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;    }</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160; </div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;    <span class="comment">// If fixed_mri_dt_ratio is set, it must be even</span></div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ad2e1a979c0ad68e87eaee349beb7e9fd">fixed_mri_dt_ratio</a> &gt; 0 &amp;&amp; (<a class="code" href="classERF.html#ad2e1a979c0ad68e87eaee349beb7e9fd">fixed_mri_dt_ratio</a>%2 != 0) )</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;    {</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;        Abort(<span class="stringliteral">&quot;If you specify fixed_mri_dt_ratio, it must be even&quot;</span>);</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;    }</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160; </div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= max_level; lev++)</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;    {</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;        <span class="comment">// We ignore fixed_fast_dt if not substepping</span></div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a7c414e2fb7c53479a2d21bb3a2d4099e">substepping_type</a>[lev] == SubsteppingType::None) {</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;            <a class="code" href="classERF.html#a4f3f43c6304a0a3ae78c42d54c05ee26">fixed_fast_dt</a>[lev] = -1.0;</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;        }</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160; </div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;        <span class="comment">// If both fixed_dt and fast_dt are specified, their ratio must be an even integer</span></div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a393b540493795b8c6ee0f64634b8b815">fixed_dt</a>[lev] &gt; 0. &amp;&amp; <a class="code" href="classERF.html#a4f3f43c6304a0a3ae78c42d54c05ee26">fixed_fast_dt</a>[lev] &gt; 0. &amp;&amp; <a class="code" href="classERF.html#ad2e1a979c0ad68e87eaee349beb7e9fd">fixed_mri_dt_ratio</a> &lt;= 0)</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;        {</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;            Real eps = 1.e-12;</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;            <span class="keywordtype">int</span> ratio = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( ( (1.0+eps) * <a class="code" href="classERF.html#a393b540493795b8c6ee0f64634b8b815">fixed_dt</a>[lev] ) / <a class="code" href="classERF.html#a4f3f43c6304a0a3ae78c42d54c05ee26">fixed_fast_dt</a>[lev] );</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a393b540493795b8c6ee0f64634b8b815">fixed_dt</a>[lev] / <a class="code" href="classERF.html#a4f3f43c6304a0a3ae78c42d54c05ee26">fixed_fast_dt</a>[lev] != ratio)</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;            {</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;                Abort(<span class="stringliteral">&quot;Ratio of fixed_dt to fixed_fast_dt must be an even integer&quot;</span>);</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;            }</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;        }</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160; </div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;        <span class="comment">// If all three are specified, they must be consistent</span></div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a393b540493795b8c6ee0f64634b8b815">fixed_dt</a>[lev] &gt; 0. &amp;&amp; <a class="code" href="classERF.html#a4f3f43c6304a0a3ae78c42d54c05ee26">fixed_fast_dt</a>[lev] &gt; 0. &amp;&amp;  <a class="code" href="classERF.html#ad2e1a979c0ad68e87eaee349beb7e9fd">fixed_mri_dt_ratio</a> &gt; 0)</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;        {</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a393b540493795b8c6ee0f64634b8b815">fixed_dt</a>[lev] / <a class="code" href="classERF.html#a4f3f43c6304a0a3ae78c42d54c05ee26">fixed_fast_dt</a>[lev] != <a class="code" href="classERF.html#ad2e1a979c0ad68e87eaee349beb7e9fd">fixed_mri_dt_ratio</a>)</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;            {</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;                Abort(<span class="stringliteral">&quot;Dt is over-specfied&quot;</span>);</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;            }</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;        }</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;    } <span class="comment">// lev</span></div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160; </div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#af976afa61859c07e6249963edc367c2d">coupling_type</a> == CouplingType::TwoWay &amp;&amp; <a class="code" href="classERF.html#ad9084179f7384e10a519989ffd51fd34">cf_width</a> &gt; 0) {</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;        Abort(<span class="stringliteral">&quot;For two-way coupling you must set cf_width = 0&quot;</span>);</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;    }</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_acab120bb9324e7298534d765c447d703"><div class="ttname"><a href="classERF.html#acab120bb9324e7298534d765c447d703">ERF::real_set_width</a></div><div class="ttdeci">int real_set_width</div><div class="ttdef"><b>Definition:</b> ERF.H:1051</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a54f6c5d799e51521ad10bb57d29d0c44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54f6c5d799e51521ad10bb57d29d0c44">&#9670;&nbsp;</a></span>PlotFileName()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ERF::PlotFileName </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a2dcd22cb915d923c687f60267f44542b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2dcd22cb915d923c687f60267f44542b">&#9670;&nbsp;</a></span>PlotFileVarNames()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Vector&lt; std::string &gt; ERF::PlotFileVarNames </td>
          <td>(</td>
          <td class="paramtype">amrex::Vector&lt; std::string &gt;&#160;</td>
          <td class="paramname"><em>plot_var_names</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;{</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    Vector&lt;std::string&gt; names;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160; </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    names.insert(names.end(), plot_var_names.begin(), plot_var_names.end());</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keywordflow">return</span> names;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a984c145a81739ab4c7f8fd03a334d239"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a984c145a81739ab4c7f8fd03a334d239">&#9670;&nbsp;</a></span>poisson_wall_dist()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::poisson_wall_dist </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculate wall distances using the Poisson equation</p>
<p>The zlo boundary is assumed to correspond to the land surface. If there are no boundary walls, then the other use case is to calculate wall distances for immersed boundaries (embedded or thin body).</p>
<p>See Tucker, P. G. (2003). Differential equation-based wall distance computation for DES and RANS. Journal of Computational Physics, 190(1), 229–248. <a href="https://doi.org/10.1016/S0021-9991(03)00272-9">https://doi.org/10.1016/S0021-9991(03)00272-9</a> </p>
<div class="fragment"><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;{</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    BL_PROFILE(<span class="stringliteral">&quot;ERF::poisson_wall_dist()&quot;</span>);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160; </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="keywordtype">bool</span> havewall{<span class="keyword">false</span>};</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    Orientation zlo(Direction::z, Orientation::low);</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="keywordflow">if</span> ( ( <a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[zlo] == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9af69483cb4bb9623dc65e76ce5bd0a3d5">ERF_BC::surface_layer</a>                      ) ||</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;         ( <a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[zlo] == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9acb8c716b8d9b499d9bc323d8f8a410d3">ERF_BC::no_slip_wall</a>                       ) )<span class="comment">/*||</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">         ((phys_bc_type[zlo] == ERF_BC::slip_wall) &amp;&amp; (dom_hi.z &gt; dom_lo.z)) )*/</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    {</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        havewall = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    }</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span>&amp; geomdata = geom[lev];</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keywordflow">if</span> (havewall) {</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a1952672901901b0b3a628f2298dc72c2">mesh_type</a> == MeshType::ConstantDz) {</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">// Comment this out to test the wall dist calc in the trivial case:</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">//#if 0</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;            Print() &lt;&lt; <span class="stringliteral">&quot;Directly calculating direct wall distance for constant dz&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;            <span class="keyword">const</span> Real* prob_lo = geomdata.ProbLo();</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;            <span class="keyword">const</span> Real* dx = geomdata.CellSize();</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;            <span class="keywordflow">for</span> (MFIter mfi(*<a class="code" href="classERF.html#a0276b556fdefec8b99be95846a3a35fe">walldist</a>[lev]); mfi.isValid(); ++mfi) {</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.validbox();</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;                <span class="keyword">auto</span> dist_arr = <a class="code" href="classERF.html#a0276b556fdefec8b99be95846a3a35fe">walldist</a>[lev]-&gt;array(mfi);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;                ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) {</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;                    dist_arr(i, j, k) = prob_lo[2] + (k + 0.5) * dx[2];</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                });</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;            }</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">//#endif</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a1952672901901b0b3a628f2298dc72c2">mesh_type</a> == MeshType::StretchedDz) {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;            <span class="comment">// TODO: Handle this trivial case</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;            Error(<span class="stringliteral">&quot;Wall dist calc not implemented with grid stretching yet&quot;</span>);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;            <span class="comment">// TODO</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            Error(<span class="stringliteral">&quot;Wall dist calc not implemented over terrain yet&quot;</span>);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        }</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    }</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    Print() &lt;&lt; <span class="stringliteral">&quot;Calculating Poisson wall distance&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="comment">// Make sure the solver only sees the levels over which we are solving</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    BoxArray nba = <a class="code" href="classERF.html#a0276b556fdefec8b99be95846a3a35fe">walldist</a>[lev]-&gt;boxArray();</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    nba.surroundingNodes();</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    Vector&lt;Geometry&gt;          geom_tmp; geom_tmp.push_back(geom[lev]);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    Vector&lt;BoxArray&gt;            ba_tmp;   ba_tmp.push_back(nba);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    Vector&lt;DistributionMapping&gt; dm_tmp;   dm_tmp.push_back(<a class="code" href="classERF.html#a0276b556fdefec8b99be95846a3a35fe">walldist</a>[lev]-&gt;DistributionMap());</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    Vector&lt;MultiFab&gt; rhs;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    Vector&lt;MultiFab&gt; phi;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> == TerrainType::EB) {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        amrex::Error(<span class="stringliteral">&quot;Wall dist calc not implemented for EB&quot;</span>);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        rhs.resize(1);   rhs[0].define(ba_tmp[0], dm_tmp[0], 1, 0);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        phi.resize(1);   phi[0].define(ba_tmp[0], dm_tmp[0], 1, 1);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    }</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    rhs[0].setVal(-1.0);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="comment">// Define an overset mask to set dirichlet nodes on walls</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    iMultiFab mask(ba_tmp[0], dm_tmp[0], 1, 0);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    Vector&lt;const iMultiFab*&gt; overset_mask = {&amp;mask};</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span> <a class="code" href="ERF__DiffSetup_8H.html#a2987796b2d40db9890dd3497cc7e20ca">dom_lo</a> = lbound(geom[lev].Domain());</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span> <a class="code" href="ERF__DiffSetup_8H.html#a0f2c81fa9e8171e1116919f8b1ae0b28">dom_hi</a> = ubound(geom[lev].Domain());</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="comment">// Initialize phi</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="comment">// (It is essential that we do this in order to fill the corners; this is</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="comment">// used if we include blanking.)</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    phi[0].setVal(0.0);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="comment">// Interior boundaries are marked with phi=0</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="comment">// Overset mask is 0/1: 1 means the node is an unknown. 0 means it&#39;s known.</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    mask.setVal(1);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a94de4907b3d6742071d5542b60e8f393">have_zero_flux_faces</a>) {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        Warning(<span class="stringliteral">&quot;Poisson distance is inaccurate for bodies in open domains that are small compared to the domain size, skipping&quot;</span>);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="preprocessor">#if 0</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        Gpu::DeviceVector&lt;IntVect&gt; xfacelist, yfacelist, zfacelist;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        xfacelist.resize(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a7a086b9e2aabb65d2e5e9053e7bd6018">zero_xflux</a>.size());</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        yfacelist.resize(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a118575fe302e72fcd231e77be6d117a9">zero_yflux</a>.size());</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        zfacelist.resize(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a7da4e5242e05aeba4822b71fab596954">zero_zflux</a>.size());</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="keywordflow">if</span> (xfacelist.size() &gt; 0) {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            Gpu::copy(amrex::Gpu::hostToDevice,</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                      <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a7a086b9e2aabb65d2e5e9053e7bd6018">zero_xflux</a>.begin(),</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                      <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a7a086b9e2aabb65d2e5e9053e7bd6018">zero_xflux</a>.end(),</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                      xfacelist.begin());</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            Print() &lt;&lt; <span class="stringliteral">&quot;  masking interior xfaces&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        }</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <span class="keywordflow">if</span> (yfacelist.size() &gt; 0) {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            Gpu::copy(amrex::Gpu::hostToDevice,</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                      <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a118575fe302e72fcd231e77be6d117a9">zero_yflux</a>.begin(),</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                      <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a118575fe302e72fcd231e77be6d117a9">zero_yflux</a>.end(),</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                      yfacelist.begin());</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            Print() &lt;&lt; <span class="stringliteral">&quot;  masking interior yfaces&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        }</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <span class="keywordflow">if</span> (zfacelist.size() &gt; 0) {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            Gpu::copy(amrex::Gpu::hostToDevice,</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                      <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a7da4e5242e05aeba4822b71fab596954">zero_zflux</a>.begin(),</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                      <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a7da4e5242e05aeba4822b71fab596954">zero_zflux</a>.end(),</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                      zfacelist.begin());</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            Print() &lt;&lt; <span class="stringliteral">&quot;  masking interior zfaces&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        }</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="keywordflow">for</span> (MFIter mfi(phi[0]); mfi.isValid(); ++mfi) {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            <span class="keyword">const</span> Box&amp; bx = mfi.validbox();</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            <span class="keyword">auto</span> phi_arr  = phi[0].array(mfi);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            <span class="keyword">auto</span> mask_arr = mask.array(mfi);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            <span class="keywordflow">if</span> (xfacelist.size() &gt; 0) {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iface=0; iface &lt; xfacelist.size(); ++iface) {</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                        <span class="keywordflow">if</span> ((i == xfacelist[iface][0]) &amp;&amp;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                            (j == xfacelist[iface][1]) &amp;&amp;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                            (k == xfacelist[iface][2]))</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                        {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                            mask_arr(i, j  , k  ) = 0;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                            mask_arr(i, j  , k+1) = 0;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                            mask_arr(i, j+1, k  ) = 0;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                            mask_arr(i, j+1, k+1) = 0;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                        }</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                    }</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                });</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            }</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            <span class="keywordflow">if</span> (yfacelist.size() &gt; 0) {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iface=0; iface &lt; yfacelist.size(); ++iface) {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                        <span class="keywordflow">if</span> ((i == yfacelist[iface][0]) &amp;&amp;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                            (j == yfacelist[iface][1]) &amp;&amp;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                            (k == yfacelist[iface][2]))</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                        {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                            mask_arr(i  , j, k  ) = 0;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                            mask_arr(i  , j, k+1) = 0;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                            mask_arr(i+1, j, k  ) = 0;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                            mask_arr(i+1, j, k+1) = 0;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                        }</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                    }</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                });</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            }</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            <span class="keywordflow">if</span> (zfacelist.size() &gt; 0) {</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) {</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iface=0; iface &lt; zfacelist.size(); ++iface) {</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                        <span class="keywordflow">if</span> ((i == xfacelist[iface][0]) &amp;&amp;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                            (j == xfacelist[iface][1]) &amp;&amp;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                            (k == xfacelist[iface][2]))</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                        {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                            mask_arr(i  , j  , k) = 0;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                            mask_arr(i  , j+1, k) = 0;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                            mask_arr(i+1, j  , k) = 0;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                            mask_arr(i+1, j+1, k) = 0;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                        }</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                    }</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                });</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        }</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="comment">// Setup BCs, with solid domain boundaries being dirichlet</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    amrex::Array&lt;amrex::LinOpBCType,AMREX_SPACEDIM&gt; bc3d_lo, bc3d_hi;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dir = 0; dir &lt; AMREX_SPACEDIM; ++dir) {</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <span class="keywordflow">if</span> (geom[0].isPeriodic(dir)) {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            bc3d_lo[dir] = LinOpBCType::Periodic;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            bc3d_hi[dir] = LinOpBCType::Periodic;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            bc3d_lo[dir] = LinOpBCType::Neumann;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            bc3d_hi[dir] = LinOpBCType::Neumann;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        }</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    }</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordflow">if</span> (havewall) {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        Print() &lt;&lt; <span class="stringliteral">&quot;  Poisson zlo BC is dirichlet&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        bc3d_lo[2] = LinOpBCType::Dirichlet;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    }</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    Print() &lt;&lt; <span class="stringliteral">&quot;  bc lo : &quot;</span> &lt;&lt; bc3d_lo &lt;&lt; std::endl;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    Print() &lt;&lt; <span class="stringliteral">&quot;  bc hi : &quot;</span> &lt;&lt; bc3d_hi &lt;&lt; std::endl;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aaadbd092e9e176b7f088c7992c866c6e">advChoice</a>.<a class="code" href="structAdvChoice.html#a94de4907b3d6742071d5542b60e8f393">have_zero_flux_faces</a> &amp;&amp; !havewall) {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        Error(<span class="stringliteral">&quot;No solid boundaries in the computational domain&quot;</span>);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    }</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    LPInfo info;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">/* Nodal solver cannot have hidden dimensions */</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="preprocessor">#if 0</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="comment">// Allow a hidden direction if the domain is one cell wide</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ERF__DiffSetup_8H.html#a2987796b2d40db9890dd3497cc7e20ca">dom_lo</a>.x == <a class="code" href="ERF__DiffSetup_8H.html#a0f2c81fa9e8171e1116919f8b1ae0b28">dom_hi</a>.x) {</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        info.setHiddenDirection(0);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        Print() &lt;&lt; <span class="stringliteral">&quot;  domain is 2D in yz&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="ERF__DiffSetup_8H.html#a2987796b2d40db9890dd3497cc7e20ca">dom_lo</a>.y == <a class="code" href="ERF__DiffSetup_8H.html#a0f2c81fa9e8171e1116919f8b1ae0b28">dom_hi</a>.y) {</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        info.setHiddenDirection(1);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        Print() &lt;&lt; <span class="stringliteral">&quot;  domain is 2D in xz&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="ERF__DiffSetup_8H.html#a2987796b2d40db9890dd3497cc7e20ca">dom_lo</a>.z == <a class="code" href="ERF__DiffSetup_8H.html#a0f2c81fa9e8171e1116919f8b1ae0b28">dom_hi</a>.z) {</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        info.setHiddenDirection(2);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        Print() &lt;&lt; <span class="stringliteral">&quot;  domain is 2D in xy&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    }</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="comment">// Solve nodal masked Poisson problem with MLMG</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="comment">// TODO: different solver for terrain?</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keyword">const</span> Real reltol = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a238b0871f38f8b134ff3fe5af0d05479">poisson_reltol</a>;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keyword">const</span> Real abstol = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ad7f586d62fb0872ba0340fb03d462c64">poisson_abstol</a>;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    Real sigma = 1.0;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    Vector&lt;EBFArrayBoxFactory const*&gt; factory_vec = { &amp;<a class="code" href="classERF.html#ad024dd413ab20e5d6f69c1f96e5b78a3">EBFactory</a>(lev) };</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    MLNodeLaplacian mlpoisson(geom_tmp, ba_tmp, dm_tmp, info, factory_vec, sigma);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    mlpoisson.setDomainBC(bc3d_lo, bc3d_hi);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordflow">if</span> (lev &gt; 0) {</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        mlpoisson.setCoarseFineBC(<span class="keyword">nullptr</span>, ref_ratio[lev-1], LinOpBCType::Neumann);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    }</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160; </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    mlpoisson.setLevelBC(0, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    mlpoisson.setOversetMask(0, mask);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="comment">// Solve</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    MLMG mlmg(mlpoisson);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="keywordtype">int</span> max_iter = 100;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    mlmg.setMaxIter(max_iter);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    mlmg.setVerbose(<a class="code" href="classERF.html#a2c4e27d6b7928c7081f17e63d0834200">mg_verbose</a>);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    mlmg.setBottomVerbose(0);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    mlmg.solve(GetVecOfPtrs(phi),</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;               GetVecOfConstPtrs(rhs),</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;               reltol, abstol);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="comment">// Now overwrite with periodic fill outside domain and fine-fine fill inside</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    phi[0].FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160; </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="comment">// Compute grad(phi) to get distances</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="comment">// - Note that phi is nodal and walldist is cell-centered</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="comment">// - TODO: include terrain metrics for dphi/dz</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keywordflow">for</span> (MFIter mfi(*<a class="code" href="classERF.html#a0276b556fdefec8b99be95846a3a35fe">walldist</a>[lev]); mfi.isValid(); ++mfi) {</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <span class="keyword">const</span> Box&amp; bx = mfi.validbox();</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> invCellSize = geomdata.InvCellSizeArray();</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        <span class="keyword">auto</span> <span class="keyword">const</span>&amp; phi_arr = phi[0].const_array(mfi);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <span class="keyword">auto</span> dist_arr = <a class="code" href="classERF.html#a0276b556fdefec8b99be95846a3a35fe">walldist</a>[lev]-&gt;array(mfi);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            Real dpdx{0}, dpdy{0}, dpdz{0};</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            <span class="comment">// dphi/dx</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="ERF__DiffSetup_8H.html#a2987796b2d40db9890dd3497cc7e20ca">dom_lo</a>.x != <a class="code" href="ERF__DiffSetup_8H.html#a0f2c81fa9e8171e1116919f8b1ae0b28">dom_hi</a>.x) {</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                dpdx = 0.25 * invCellSize[0] * (</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                        (phi_arr(i+1, j  , k  ) - phi_arr(i, j  , k  ))</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                      + (phi_arr(i+1, j  , k+1) - phi_arr(i, j  , k+1))</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                      + (phi_arr(i+1, j+1, k  ) - phi_arr(i, j+1, k  ))</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                      + (phi_arr(i+1, j+1, k+1) - phi_arr(i, j+1, k+1)) );</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;            }</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;            <span class="comment">// dphi/dy</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            <a class="code" href="ERF__DiffQKEAdjustment_8H.html#ad212ca7498a026ec3f73cef6a5f29738">if</a> (<a class="code" href="ERF__DiffSetup_8H.html#a2987796b2d40db9890dd3497cc7e20ca">dom_lo</a>.y != <a class="code" href="ERF__DiffSetup_8H.html#a0f2c81fa9e8171e1116919f8b1ae0b28">dom_hi</a>.y) {</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                dpdy = 0.25 * invCellSize[1] * (</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                        (phi_arr(i  , j+1, k  ) - phi_arr(i  , j, k  ))</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                      + (phi_arr(i  , j+1, k+1) - phi_arr(i  , j, k+1))</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                      + (phi_arr(i+1, j+1, k  ) - phi_arr(i+1, j, k  ))</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                      + (phi_arr(i+1, j+1, k+1) - phi_arr(i+1, j, k+1)) );</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            }</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160; </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            <span class="comment">// dphi/dz</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            <a class="code" href="ERF__DiffQKEAdjustment_8H.html#ad212ca7498a026ec3f73cef6a5f29738">if</a> (<a class="code" href="ERF__DiffSetup_8H.html#a2987796b2d40db9890dd3497cc7e20ca">dom_lo</a>.z != <a class="code" href="ERF__DiffSetup_8H.html#a0f2c81fa9e8171e1116919f8b1ae0b28">dom_hi</a>.z) {</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                dpdz = 0.25 * invCellSize[2] * (</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                        (phi_arr(i  , j  , k+1) - phi_arr(i  , j  , k))</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                      + (phi_arr(i  , j+1, k+1) - phi_arr(i  , j+1, k))</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                      + (phi_arr(i+1, j  , k+1) - phi_arr(i+1, j  , k))</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                      + (phi_arr(i+1, j+1, k+1) - phi_arr(i+1, j+1, k)) );</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            }</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            Real dp_dot_dp = dpdx*dpdx + dpdy*dpdy + dpdz*dpdz;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            Real phi_avg = 0.125 * (</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                    phi_arr(i  , j  , k  ) + phi_arr(i  , j  , k+1) + phi_arr(i  , j+1, k  ) + phi_arr(i  , j+1, k+1)</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                  + phi_arr(i+1, j  , k  ) + phi_arr(i+1, j  , k+1) + phi_arr(i+1, j+1, k  ) + phi_arr(i+1, j+1, k+1) );</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            dist_arr(i, j, k) = -std::sqrt(dp_dot_dp) + std::sqrt(dp_dot_dp + 2*phi_avg);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            <span class="comment">// DEBUG: output phi instead</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            <span class="comment">//dist_arr(i, j, k) = phi_arr(i, j, k);</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        });</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    }</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;}</div>
<div class="ttc" id="aERF__DiffQKEAdjustment_8H_html_ad212ca7498a026ec3f73cef6a5f29738"><div class="ttname"><a href="ERF__DiffQKEAdjustment_8H.html#ad212ca7498a026ec3f73cef6a5f29738">if</a></div><div class="ttdeci">if(l_use_mynn &amp;&amp;start_comp&lt;=RhoKE_comp &amp;&amp;end_comp &gt;=RhoKE_comp)</div><div class="ttdef"><b>Definition:</b> ERF_DiffQKEAdjustment.H:2</div></div>
<div class="ttc" id="aclassERF_html_a2c4e27d6b7928c7081f17e63d0834200"><div class="ttname"><a href="classERF.html#a2c4e27d6b7928c7081f17e63d0834200">ERF::mg_verbose</a></div><div class="ttdeci">static int mg_verbose</div><div class="ttdef"><b>Definition:</b> ERF.H:1028</div></div>
<div class="ttc" id="astructSolverChoice_html_a238b0871f38f8b134ff3fe5af0d05479"><div class="ttname"><a href="structSolverChoice.html#a238b0871f38f8b134ff3fe5af0d05479">SolverChoice::poisson_reltol</a></div><div class="ttdeci">amrex::Real poisson_reltol</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:729</div></div>
<div class="ttc" id="astructSolverChoice_html_ad7f586d62fb0872ba0340fb03d462c64"><div class="ttname"><a href="structSolverChoice.html#ad7f586d62fb0872ba0340fb03d462c64">SolverChoice::poisson_abstol</a></div><div class="ttdeci">amrex::Real poisson_abstol</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:728</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a984c145a81739ab4c7f8fd03a334d239_cgraph.png" border="0" usemap="#aclassERF_a984c145a81739ab4c7f8fd03a334d239_cgraph" alt=""/></div>
<map name="aclassERF_a984c145a81739ab4c7f8fd03a334d239_cgraph" id="aclassERF_a984c145a81739ab4c7f8fd03a334d239_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,175,32"/>
<area shape="rect" href="ERF__DiffQKEAdjustment_8H.html#ad212ca7498a026ec3f73cef6a5f29738" title=" " alt="" coords="223,5,261,32"/>
<area shape="rect" href="ERF__PBLModels_8H.html#a7482fcce3f236c59ab56a71405060813" title=" " alt="" coords="309,5,500,32"/>
<area shape="rect" href="ERF__PBLModels_8H.html#af84ec6ece6fad0da9e21461e60f58b2c" title=" " alt="" coords="548,5,777,32"/>
<area shape="rect" href="ERF__Thetav_8H.html#a560eb559ee1d5b8dceaae23f4f4581d5" title=" " alt="" coords="825,5,892,32"/>
</map>
</div>

</div>
</div>
<a id="a58f6683aff0fbe6949bfe8b49275a8b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58f6683aff0fbe6949bfe8b49275a8b3">&#9670;&nbsp;</a></span>post_timestep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::post_timestep </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nstep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>dt_lev</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;{</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    BL_PROFILE(<span class="stringliteral">&quot;ERF::post_timestep()&quot;</span>);</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160; </div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="preprocessor">#ifdef ERF_USE_PARTICLES</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    particleData.Redistribute();</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160; </div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#af976afa61859c07e6249963edc367c2d">coupling_type</a> == CouplingType::TwoWay)</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    {</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        <span class="keywordtype">int</span> ncomp = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[0][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nComp();</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = finest_level-1; lev &gt;= 0; lev--)</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        {</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;            <span class="comment">// The quantity that is conserved is not (rho S), but rather (rho S / m^2) where</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;            <span class="comment">// m is the map scale factor at cell centers</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;            <span class="comment">// Here we pre-divide (rho S) by m^2 before refluxing</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;            <span class="keywordflow">for</span> (MFIter mfi(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], TilingIfNotGPU()); mfi.isValid(); ++mfi) {</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                <span class="keyword">const</span> Array4&lt;      Real&gt; cons_arr = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].array(mfi);</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                <span class="keyword">const</span> Array4&lt;const Real&gt;  mfx_arr = <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85bac2a428daaf1a1b398630fa8cec7f115b">MapFacType::m_x</a>]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                <span class="keyword">const</span> Array4&lt;const Real&gt;  mfy_arr = <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85ba9612b6816e2fb7dc3ad56d6bc1fb7df8">MapFacType::m_y</a>]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="structSolverChoice.html#a1952672901901b0b3a628f2298dc72c2">SolverChoice::mesh_type</a> == MeshType::ConstantDz) {</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                    ParallelFor(bx, ncomp, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k, <span class="keywordtype">int</span> n) noexcept</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                    {</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                        cons_arr(i,j,k,n) /= (mfx_arr(i,j,0)*mfy_arr(i,j,0));</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                    });</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                    <span class="keyword">const</span> Array4&lt;const Real&gt;   detJ_arr = <a class="code" href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">detJ_cc</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                    ParallelFor(bx, ncomp, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k, <span class="keywordtype">int</span> n) noexcept</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                    {</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                        cons_arr(i,j,k,n) *= detJ_arr(i,j,k) / (mfx_arr(i,j,0)*mfy_arr(i,j,0));</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                    });</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                }</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;            } <span class="comment">// mfi</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160; </div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;            <span class="comment">// This call refluxes all &quot;slow&quot; cell-centered variables</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;            <span class="comment">// (i.e. not density or (rho theta) or velocities) from the lev/lev+1 interface onto lev</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;            <a class="code" href="classERF.html#a4d6d990d8111c170692b1e9cc0e918b8">getAdvFluxReg</a>(lev+1)-&gt;Reflux(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], 2, 2, ncomp-2);</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160; </div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;            <span class="comment">// Here we multiply (rho S) by m^2 after refluxing</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;            <span class="keywordflow">for</span> (MFIter mfi(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], TilingIfNotGPU()); mfi.isValid(); ++mfi) {</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                <span class="keyword">const</span> Array4&lt;      Real&gt;   cons_arr = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].array(mfi);</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                <span class="keyword">const</span> Array4&lt;const Real&gt;  mfx_arr = <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85bac2a428daaf1a1b398630fa8cec7f115b">MapFacType::m_x</a>]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                <span class="keyword">const</span> Array4&lt;const Real&gt;  mfy_arr = <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85ba9612b6816e2fb7dc3ad56d6bc1fb7df8">MapFacType::m_y</a>]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="structSolverChoice.html#a1952672901901b0b3a628f2298dc72c2">SolverChoice::mesh_type</a> == MeshType::ConstantDz) {</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                    ParallelFor(bx, ncomp, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k, <span class="keywordtype">int</span> n) noexcept</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                    {</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                        cons_arr(i,j,k,n) *= (mfx_arr(i,j,0)*mfy_arr(i,j,0));</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                    });</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                    <span class="keyword">const</span> Array4&lt;const Real&gt;   detJ_arr = <a class="code" href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">detJ_cc</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                    ParallelFor(bx, ncomp, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k, <span class="keywordtype">int</span> n) noexcept</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;                    {</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                        cons_arr(i,j,k,n) *= (mfx_arr(i,j,0)*mfy_arr(i,j,0)) / detJ_arr(i,j,k);</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                    });</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                }</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;            } <span class="comment">// mfi</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160; </div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;            <span class="comment">// We need to do this before anything else because refluxing changes the</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;            <span class="comment">// values of coarse cells underneath fine grids with the assumption they&#39;ll</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;            <span class="comment">// be over-written by averaging down</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;            <span class="keywordtype">int</span> src_comp;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa7be0d60ce3de3441d44082cc1b725ec">anelastic</a>[lev]) {</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                src_comp = 1;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                src_comp = 0;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;            }</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;            <span class="keywordtype">int</span> num_comp = ncomp - src_comp;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;            <a class="code" href="classERF.html#ae17524f168760cf435685a08d97480e7">AverageDownTo</a>(lev,src_comp,num_comp);</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        }</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    }</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160; </div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ad4c61fad53912d1e8d0f774d365bcf0f">is_it_time_for_action</a>(nstep, time, dt_lev0, <a class="code" href="classERF.html#a5232e98479611a24fe97994640c61faa">sum_interval</a>, <a class="code" href="classERF.html#a1cf2ba396f4404724824516da4c4a084">sum_per</a>)) {</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        <a class="code" href="classERF.html#a922892a05ee0c5bccd210a3e5a8599e1">sum_integrated_quantities</a>(time);</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        <a class="code" href="classERF.html#a91c184ac7e5889fe785aa846112ce2e6">sum_derived_quantities</a>(time);</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        <a class="code" href="classERF.html#a3e5b26e9aeb49e5318eb6cb68ed2ee97">sum_energy_quantities</a>(time);</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    }</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160; </div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#abfd94767b3721755632c45a5ef290544">pert_type</a> == PerturbationType::Source ||</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#abfd94767b3721755632c45a5ef290544">pert_type</a> == PerturbationType::Direct ||</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#abfd94767b3721755632c45a5ef290544">pert_type</a> == PerturbationType::CPM) {</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ad4c61fad53912d1e8d0f774d365bcf0f">is_it_time_for_action</a>(nstep, time, dt_lev0, <a class="code" href="classERF.html#a52761522e295887435c10853d8c7dc37">pert_interval</a>, -1.)) {</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;            <a class="code" href="classERF.html#ac1b9cce4a3c1736c4af78f6b0e2143ce">turbPert</a>.<a class="code" href="structTurbulentPerturbation.html#aa7c1ce943bf06d347d762131ec0c24cf">debug</a>(time);</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        }</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    }</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160; </div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a633cd0b44d2e38f02c23e953aecd69eb">profile_int</a> &gt; 0 &amp;&amp; (nstep+1) % <a class="code" href="classERF.html#a633cd0b44d2e38f02c23e953aecd69eb">profile_int</a> == 0) {</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a65f19c55c8d3669445866a1c3bbb628d">destag_profiles</a>) {</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;            <span class="comment">// all variables cell-centered</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;            <a class="code" href="classERF.html#a55eae94c5363e227b571739738bb26b7">write_1D_profiles</a>(time);</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;            <span class="comment">// some variables staggered</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;            <a class="code" href="classERF.html#a39efa3a0f3ae3deb7a43f4ce110ee49a">write_1D_profiles_stag</a>(time);</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        }</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    }</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160; </div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a31c93846e0129221632347d2378e881d">rad_type</a> != RadiationType::None)</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    {</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a9194db6f65f3cfa366010648eaa4affd">rad_datalog_int</a> &gt; 0 &amp;&amp; (nstep+1) % <a class="code" href="classERF.html#a9194db6f65f3cfa366010648eaa4affd">rad_datalog_int</a> == 0) {</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a609b41a1de9c6b28f23dcdc6843f9ef5">rad</a>[0]-&gt;hasDatalog()) {</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                <a class="code" href="classERF.html#a609b41a1de9c6b28f23dcdc6843f9ef5">rad</a>[0]-&gt;WriteDataLog(time);</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;            }</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        }</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    }</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160; </div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ad17ff2753e754ff3eb1330612b820b5f">output_1d_column</a>) {</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="preprocessor">#ifdef ERF_USE_NETCDF</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ad4c61fad53912d1e8d0f774d365bcf0f">is_it_time_for_action</a>(nstep, time, dt_lev0, <a class="code" href="classERF.html#afa0bef6d3146788302b81c0d4f4802d1">column_interval</a>, <a class="code" href="classERF.html#a7b0175190c6fcf829c7f2841f729b12a">column_per</a>))</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;      {</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;         <span class="keywordtype">int</span> lev_column = 0;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = finest_level; lev &gt;= 0; lev--)</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;         {</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;            Real dx_lev = geom[lev].CellSize(0);</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;            Real dy_lev = geom[lev].CellSize(1);</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;            <span class="keywordtype">int</span> i_lev = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(std::floor(<a class="code" href="classERF.html#a930b7d48218b3fc41d8719b50b3f6086">column_loc_x</a> / dx_lev));</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;            <span class="keywordtype">int</span> j_lev = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(std::floor(<a class="code" href="classERF.html#a2b911f3a5a324813b1ff4462df6044a6">column_loc_y</a> / dy_lev));</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;            <span class="keywordflow">if</span> (grids[lev].contains(IntVect(i_lev,j_lev,0))) lev_column = lev;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;         }</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;         writeToNCColumnFile(lev_column, <a class="code" href="classERF.html#a48bba6b1c1b39940b09aefbe56311e2f">column_file_name</a>, <a class="code" href="classERF.html#a930b7d48218b3fc41d8719b50b3f6086">column_loc_x</a>, <a class="code" href="classERF.html#a2b911f3a5a324813b1ff4462df6044a6">column_loc_y</a>, time);</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;      }</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;      Abort(<span class="stringliteral">&quot;To output 1D column files ERF must be compiled with NetCDF&quot;</span>);</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    }</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160; </div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a7c448670f7a5cadd6fe56f7e615c9eb6">output_bndry_planes</a>)</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    {</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ad4c61fad53912d1e8d0f774d365bcf0f">is_it_time_for_action</a>(<a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[0], time, dt_lev0, <a class="code" href="classERF.html#aab4575d8fb57595a2f1aaf088c60447a">bndry_output_planes_interval</a>, <a class="code" href="classERF.html#a5f99e949c83d86507e003ae556cf7c22">bndry_output_planes_per</a>) &amp;&amp;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;          time &gt;= <a class="code" href="classERF.html#a87e58f16f44a6cb35d6983ed3fe7d3c1">bndry_output_planes_start_time</a>)</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;      {</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;         <span class="keywordtype">bool</span> is_moist = (<a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;Get_Qstate_Moist_Size() &gt; 0);</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;         <a class="code" href="classERF.html#aa53035f34ba133b86172e180abda4209">m_w2d</a>-&gt;write_planes(<a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[0], time, <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>, is_moist);</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;      }</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    }</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160; </div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <span class="comment">// Write plane/line sampler data</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ad4c61fad53912d1e8d0f774d365bcf0f">is_it_time_for_action</a>(nstep+1, time, dt_lev0, <a class="code" href="classERF.html#ad13532a7eebe8a7473dfe5ed9a828fe8">sampler_interval</a>, <a class="code" href="classERF.html#a8bfff875038f8c24055067117e192960">sampler_per</a>) &amp;&amp; (<a class="code" href="classERF.html#a83ad7f8f4cf9920a6798f3b931355a2f">data_sampler</a>) ) {</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        <a class="code" href="classERF.html#a83ad7f8f4cf9920a6798f3b931355a2f">data_sampler</a>-&gt;get_sample_data(geom, <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>);</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        <a class="code" href="classERF.html#a83ad7f8f4cf9920a6798f3b931355a2f">data_sampler</a>-&gt;write_sample_data(<a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>, <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>, ref_ratio, geom);</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    }</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160; </div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    <span class="comment">// Moving terrain</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> == TerrainType::MovingFittedMesh )</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    {</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = finest_level; lev &gt;= 0; lev--)</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;      {</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        <span class="comment">// Copy z_phs_nd and detJ_cc at end of timestep</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;        MultiFab::Copy(*<a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev], *<a class="code" href="classERF.html#a4ef635c22e72c715f5703a6b95a7abe5">z_phys_nd_new</a>[lev], 0, 0, 1, <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev]-&gt;nGrowVect());</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        MultiFab::Copy(  *<a class="code" href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">detJ_cc</a>[lev],   *<a class="code" href="classERF.html#ae39bf64c5306b1dd939d82d9df728daa">detJ_cc_new</a>[lev], 0, 0, 1,   <a class="code" href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">detJ_cc</a>[lev]-&gt;nGrowVect());</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;        MultiFab::Copy(<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev],<a class="code" href="classERF.html#a37b2a4257df8ff53d4450de47f16ace1">base_state_new</a>[lev],0,0,<a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91a088c1232c30770df1105d3cdf66ee582">BaseState::num_comps</a>,<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].nGrowVect());</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160; </div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;        <a class="code" href="ERF__TerrainMetrics_8cpp.html#acc28d890df44cf0082a848c057042178">make_zcc</a>(geom[lev],*<a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev],*<a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[lev]);</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;      }</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    }</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160; </div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    <span class="keywordtype">bool</span> is_hurricane_tracker_io=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    ParmParse <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>(<span class="stringliteral">&quot;erf&quot;</span>);</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;is_hurricane_tracker_io&quot;</span>, is_hurricane_tracker_io);</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160; </div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    <span class="keywordflow">if</span>(is_hurricane_tracker_io) {</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        <span class="keywordflow">if</span>(nstep == 0 or (nstep+1)%<a class="code" href="classERF.html#a57cfb4bfead8525174646964992c7e69">m_plot_int_1</a> == 0){</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;            std::string filename = <a class="code" href="classERF.html#a758170966de01c9030c39a3840d29395">MakeVTKFilename</a>(nstep);</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;            Real velmag_threshold = 1e10;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;            <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;hurr_track_io_velmag_greater_than&quot;</span>, velmag_threshold);</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;            <span class="keywordflow">if</span>(velmag_threshold==1e10) {</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                Abort(<span class="stringliteral">&quot;As hurricane tracking IO is active using erf.is_hurricane_tracker_io = true&quot;</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                      <span class="stringliteral">&quot; there needs to be an input erf.hurr_track_io_velmag_greater_than which specifies the&quot;</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                      <span class="stringliteral">&quot; magnitude of velocity above which cells will be tagged for refinement.&quot;</span>);</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;            }</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;            <span class="keywordtype">int</span> levc=finest_level;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;            MultiFab&amp; U_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[levc][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>];</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;            MultiFab&amp; V_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[levc][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>];</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;            MultiFab&amp; W_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[levc][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>];</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160; </div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;            <a class="code" href="classERF.html#a2710f0ac329fa022dd2df41679998b3b">HurricaneTracker</a>(levc, U_new, V_new, W_new, velmag_threshold, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;            <span class="keywordflow">if</span> (ParallelDescriptor::IOProcessor()) {</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                <a class="code" href="classERF.html#ad3613d455e3c246e5addf88054fa41db">WriteVTKPolyline</a>(filename,<a class="code" href="classERF.html#a90e949ea154768582dd0aff3d691b0db">hurricane_track_xy</a>);</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;            }</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        }</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    }</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;} <span class="comment">// post_timestep</span></div>
<div class="ttc" id="aERF__TerrainMetrics_8cpp_html_acc28d890df44cf0082a848c057042178"><div class="ttname"><a href="ERF__TerrainMetrics_8cpp.html#acc28d890df44cf0082a848c057042178">make_zcc</a></div><div class="ttdeci">void make_zcc(const Geometry &amp;geom, MultiFab &amp;z_phys_nd, MultiFab &amp;z_phys_cc)</div><div class="ttdef"><b>Definition:</b> ERF_TerrainMetrics.cpp:623</div></div>
<div class="ttc" id="aclassERF_html_a2b911f3a5a324813b1ff4462df6044a6"><div class="ttname"><a href="classERF.html#a2b911f3a5a324813b1ff4462df6044a6">ERF::column_loc_y</a></div><div class="ttdeci">static amrex::Real column_loc_y</div><div class="ttdef"><b>Definition:</b> ERF.H:1086</div></div>
<div class="ttc" id="aclassERF_html_a48bba6b1c1b39940b09aefbe56311e2f"><div class="ttname"><a href="classERF.html#a48bba6b1c1b39940b09aefbe56311e2f">ERF::column_file_name</a></div><div class="ttdeci">static std::string column_file_name</div><div class="ttdef"><b>Definition:</b> ERF.H:1087</div></div>
<div class="ttc" id="aclassERF_html_a4d6d990d8111c170692b1e9cc0e918b8"><div class="ttname"><a href="classERF.html#a4d6d990d8111c170692b1e9cc0e918b8">ERF::getAdvFluxReg</a></div><div class="ttdeci">AMREX_FORCE_INLINE amrex::YAFluxRegister * getAdvFluxReg(int lev)</div><div class="ttdef"><b>Definition:</b> ERF.H:1230</div></div>
<div class="ttc" id="aclassERF_html_a5f99e949c83d86507e003ae556cf7c22"><div class="ttname"><a href="classERF.html#a5f99e949c83d86507e003ae556cf7c22">ERF::bndry_output_planes_per</a></div><div class="ttdeci">static amrex::Real bndry_output_planes_per</div><div class="ttdef"><b>Definition:</b> ERF.H:1092</div></div>
<div class="ttc" id="aclassERF_html_a758170966de01c9030c39a3840d29395"><div class="ttname"><a href="classERF.html#a758170966de01c9030c39a3840d29395">ERF::MakeVTKFilename</a></div><div class="ttdeci">std::string MakeVTKFilename(int nstep)</div><div class="ttdef"><b>Definition:</b> ERF_Write1DProfiles.cpp:574</div></div>
<div class="ttc" id="aclassERF_html_a7b0175190c6fcf829c7f2841f729b12a"><div class="ttname"><a href="classERF.html#a7b0175190c6fcf829c7f2841f729b12a">ERF::column_per</a></div><div class="ttdeci">static amrex::Real column_per</div><div class="ttdef"><b>Definition:</b> ERF.H:1084</div></div>
<div class="ttc" id="aclassERF_html_a8bfff875038f8c24055067117e192960"><div class="ttname"><a href="classERF.html#a8bfff875038f8c24055067117e192960">ERF::sampler_per</a></div><div class="ttdeci">amrex::Real sampler_per</div><div class="ttdef"><b>Definition:</b> ERF.H:1411</div></div>
<div class="ttc" id="aclassERF_html_a930b7d48218b3fc41d8719b50b3f6086"><div class="ttname"><a href="classERF.html#a930b7d48218b3fc41d8719b50b3f6086">ERF::column_loc_x</a></div><div class="ttdeci">static amrex::Real column_loc_x</div><div class="ttdef"><b>Definition:</b> ERF.H:1085</div></div>
<div class="ttc" id="aclassERF_html_aab4575d8fb57595a2f1aaf088c60447a"><div class="ttname"><a href="classERF.html#aab4575d8fb57595a2f1aaf088c60447a">ERF::bndry_output_planes_interval</a></div><div class="ttdeci">static int bndry_output_planes_interval</div><div class="ttdef"><b>Definition:</b> ERF.H:1091</div></div>
<div class="ttc" id="aclassERF_html_ad13532a7eebe8a7473dfe5ed9a828fe8"><div class="ttname"><a href="classERF.html#ad13532a7eebe8a7473dfe5ed9a828fe8">ERF::sampler_interval</a></div><div class="ttdeci">int sampler_interval</div><div class="ttdef"><b>Definition:</b> ERF.H:1410</div></div>
<div class="ttc" id="aclassERF_html_ad17ff2753e754ff3eb1330612b820b5f"><div class="ttname"><a href="classERF.html#ad17ff2753e754ff3eb1330612b820b5f">ERF::output_1d_column</a></div><div class="ttdeci">static int output_1d_column</div><div class="ttdef"><b>Definition:</b> ERF.H:1082</div></div>
<div class="ttc" id="aclassERF_html_ad3613d455e3c246e5addf88054fa41db"><div class="ttname"><a href="classERF.html#ad3613d455e3c246e5addf88054fa41db">ERF::WriteVTKPolyline</a></div><div class="ttdeci">void WriteVTKPolyline(const std::string &amp;filename, amrex::Vector&lt; std::array&lt; amrex::Real, 2 &gt;&gt; &amp;points_xy)</div><div class="ttdef"><b>Definition:</b> ERF_Write1DProfiles.cpp:593</div></div>
<div class="ttc" id="aclassERF_html_afa0bef6d3146788302b81c0d4f4802d1"><div class="ttname"><a href="classERF.html#afa0bef6d3146788302b81c0d4f4802d1">ERF::column_interval</a></div><div class="ttdeci">static int column_interval</div><div class="ttdef"><b>Definition:</b> ERF.H:1083</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a58f6683aff0fbe6949bfe8b49275a8b3_cgraph.png" border="0" usemap="#aclassERF_a58f6683aff0fbe6949bfe8b49275a8b3_cgraph" alt=""/></div>
<map name="aclassERF_a58f6683aff0fbe6949bfe8b49275a8b3_cgraph" id="aclassERF_a58f6683aff0fbe6949bfe8b49275a8b3_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,152,57"/>
<area shape="rect" href="ERF__TerrainMetrics_8cpp.html#acc28d890df44cf0082a848c057042178" title=" " alt="" coords="200,5,287,32"/>
<area shape="rect" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469" title=" " alt="" coords="224,56,263,83"/>
</map>
</div>

</div>
</div>
<a id="adca0cddd75f33ecb5fb8e0ef9601dae4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adca0cddd75f33ecb5fb8e0ef9601dae4">&#9670;&nbsp;</a></span>post_update()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::post_update </td>
          <td>(</td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>state_mf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Geometry &amp;&#160;</td>
          <td class="paramname"><em>geom</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a1a8eb6bc00080cdbd8df28f6a321ac72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a8eb6bc00080cdbd8df28f6a321ac72">&#9670;&nbsp;</a></span>print_banner()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::print_banner </td>
          <td>(</td>
          <td class="paramtype">MPI_Comm&#160;</td>
          <td class="paramname"><em>comm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                     : <span class="stringliteral">&quot; &lt;&lt; msg &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="stringliteral">}</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="stringliteral">void ERF::print_banner (MPI_Comm comm, std::ostream&amp; out)</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="stringliteral">{</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="stringliteral">#ifdef AMREX_USE_MPI</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="stringliteral">    int irank = 0;</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="stringliteral">    int num_ranks = 1;</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="stringliteral">    MPI_Comm_size(comm, &amp;num_ranks);</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="stringliteral">    MPI_Comm_rank(comm, &amp;irank);</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="stringliteral">    // Only root process does the printing</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="stringliteral">    if (irank != 0) return;</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="stringliteral">#else</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="stringliteral">    amrex::ignore_unused(comm);</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="stringliteral">#endif</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="stringliteral">    auto etime = std::chrono::system_clock::now();</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="stringliteral">    auto etimet = std::chrono::system_clock::to_time_t(etime);</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="stringliteral">#ifndef _WIN32</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="stringliteral">    char time_buf[64];</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="stringliteral">    ctime_r(&amp;etimet, time_buf);</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="stringliteral">    const std::string tstamp(time_buf);</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="stringliteral">#else</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="stringliteral">    char* time_buf = new char[64];</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="stringliteral">    ctime_s(time_buf, 64, &amp;etimet);</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="stringliteral">    const std::string tstamp(time_buf);</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="stringliteral">#endif</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="stringliteral">    const char* githash1 = amrex::buildInfoGetGitHash(1);</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="stringliteral">    const char* githash2 = amrex::buildInfoGetGitHash(2);</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="stringliteral">    // clang-format off</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="stringliteral">    out &lt;&lt; dbl_line</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="stringliteral">        &lt;&lt; &quot;</span>                <a class="code" href="classERF.html#a30129012dd367825e5e4fd1406694f58">ERF</a> (https:<span class="comment">//github.com/erf-model/ERF)&quot;</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        &lt;&lt; std::endl &lt;&lt; std::endl</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;  ERF Git SHA      :: &quot;</span> &lt;&lt; githash1 &lt;&lt; std::endl</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;  AMReX Git SHA    :: &quot;</span> &lt;&lt; githash2 &lt;&lt; std::endl</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;  AMReX version    :: &quot;</span> &lt;&lt; amrex::Version() &lt;&lt; std::endl &lt;&lt; std::endl</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;  Exec. time       :: &quot;</span> &lt;&lt; tstamp</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;  Build time       :: &quot;</span> &lt;&lt; <a class="code" href="namespaceamrex.html#a8f794ff24efbc4b60058492d1a073c78">amrex::buildInfoGetBuildDate</a>() &lt;&lt; std::endl</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;  C++ compiler     :: &quot;</span> &lt;&lt; <a class="code" href="namespaceamrex.html#a9d270ec83f99e836cca454cac4e0af5e">amrex::buildInfoGetComp</a>()</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="namespaceamrex.html#aab3ca155f0d0a6d198817df9c35352f8">amrex::buildInfoGetCompVersion</a>() &lt;&lt; std::endl &lt;&lt; std::endl</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;  MPI              :: &quot;</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;#ifdef AMREX_USE_MPI</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;ON    (Num. ranks = &quot;</span> &lt;&lt; num_ranks &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;#<span class="keywordflow">else</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;OFF &quot;</span> &lt;&lt; std::endl</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;#endif</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;  GPU              :: &quot;</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;#ifdef AMREX_USE_GPU</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;ON    &quot;</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;#<span class="keywordflow">if</span> defined(AMREX_USE_CUDA)</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;(Backend: CUDA)&quot;</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;#elif defined(AMREX_USE_HIP)</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;(Backend: HIP)&quot;</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;#elif defined(AMREX_USE_SYCL)</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;(Backend: SYCL)&quot;</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;#endif</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        &lt;&lt; std::endl</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;#<span class="keywordflow">else</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;OFF&quot;</span> &lt;&lt; std::endl</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;#endif</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;  OpenMP           :: &quot;</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;#ifdef AMREX_USE_OMP</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;ON    (Num. threads = &quot;</span> &lt;&lt; omp_get_max_threads() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;#<span class="keywordflow">else</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;OFF&quot;</span> &lt;&lt; std::endl</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;#endif</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        &lt;&lt; std::endl;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="ttc" id="aclassERF_html_a30129012dd367825e5e4fd1406694f58"><div class="ttname"><a href="classERF.html#a30129012dd367825e5e4fd1406694f58">ERF::ERF</a></div><div class="ttdeci">ERF()</div><div class="ttdef"><b>Definition:</b> ERF.cpp:92</div></div>
<div class="ttc" id="anamespaceamrex_html_a8f794ff24efbc4b60058492d1a073c78"><div class="ttname"><a href="namespaceamrex.html#a8f794ff24efbc4b60058492d1a073c78">amrex::buildInfoGetBuildDate</a></div><div class="ttdeci">const char * buildInfoGetBuildDate()</div></div>
<div class="ttc" id="anamespaceamrex_html_a9d270ec83f99e836cca454cac4e0af5e"><div class="ttname"><a href="namespaceamrex.html#a9d270ec83f99e836cca454cac4e0af5e">amrex::buildInfoGetComp</a></div><div class="ttdeci">const char * buildInfoGetComp()</div></div>
<div class="ttc" id="anamespaceamrex_html_aab3ca155f0d0a6d198817df9c35352f8"><div class="ttname"><a href="namespaceamrex.html#aab3ca155f0d0a6d198817df9c35352f8">amrex::buildInfoGetCompVersion</a></div><div class="ttdeci">const char * buildInfoGetCompVersion()</div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a1a8eb6bc00080cdbd8df28f6a321ac72_icgraph.png" border="0" usemap="#aclassERF_a1a8eb6bc00080cdbd8df28f6a321ac72_icgraph" alt=""/></div>
<map name="aclassERF_a1a8eb6bc00080cdbd8df28f6a321ac72_icgraph" id="aclassERF_a1a8eb6bc00080cdbd8df28f6a321ac72_icgraph">
<area shape="rect" title=" " alt="" coords="108,5,244,32"/>
<area shape="rect" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,60,32"/>
</map>
</div>

</div>
</div>
<a id="addc510dbf758a33cc095d64a9b17076c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addc510dbf758a33cc095d64a9b17076c">&#9670;&nbsp;</a></span>print_error()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::print_error </td>
          <td>(</td>
          <td class="paramtype">MPI_Comm&#160;</td>
          <td class="paramname"><em>comm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        :</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    input_file   : Input file with simulation settings</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;Optional:</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    param=value  : Overrides <span class="keywordflow">for</span> parameters during runtime</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;)doc<span class="stringliteral">&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="stringliteral">}</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="stringliteral">void ERF::print_error (MPI_Comm comm, const std::string&amp; msg)</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="stringliteral">{</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="stringliteral">#ifdef AMREX_USE_MPI</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="stringliteral">    int irank = 0;</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="stringliteral">    int num_ranks = 1;</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="stringliteral">    MPI_Comm_size(comm, &amp;num_ranks);</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="stringliteral">    MPI_Comm_rank(comm, &amp;irank);</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="stringliteral"></span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_addc510dbf758a33cc095d64a9b17076c_icgraph.png" border="0" usemap="#aclassERF_addc510dbf758a33cc095d64a9b17076c_icgraph" alt=""/></div>
<map name="aclassERF_addc510dbf758a33cc095d64a9b17076c_icgraph" id="aclassERF_addc510dbf758a33cc095d64a9b17076c_icgraph">
<area shape="rect" title=" " alt="" coords="108,5,231,32"/>
<area shape="rect" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,60,32"/>
</map>
</div>

</div>
</div>
<a id="afa432756254529fb37b921088f0960d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa432756254529fb37b921088f0960d2">&#9670;&nbsp;</a></span>print_summary()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void ERF::print_summary </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a15af18ae136cf3a11bb63fe0cf3924c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15af18ae136cf3a11bb63fe0cf3924c8">&#9670;&nbsp;</a></span>print_tpls()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::print_tpls </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>out</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                      :<span class="comment">//github.com/erf-model/ERF/blob/development/LICENSE for details. &quot;</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        &lt;&lt; dash_line &lt;&lt; std::endl;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="comment">// clang-format on</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;}</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classERF.html#a15af18ae136cf3a11bb63fe0cf3924c8">ERF::print_tpls</a> (std::ostream&amp; out)</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;{</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    amrex::Vector&lt;std::string&gt; tpls;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="preprocessor">#ifdef ERF_USE_NETCDF</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    tpls.push_back(std::string(<span class="stringliteral">&quot;NetCDF    &quot;</span>) + NC_VERSION);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="preprocessor">#ifdef AMREX_USE_SUNDIALS</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    tpls.push_back(std::string(<span class="stringliteral">&quot;SUNDIALS     &quot;</span>) + SUNDIALS_VERSION);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordflow">if</span> (!tpls.empty()) {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        out &lt;&lt; <span class="stringliteral">&quot;  Enabled third-party libraries: &quot;</span>;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; val : tpls) {</div>
<div class="ttc" id="aclassERF_html_a15af18ae136cf3a11bb63fe0cf3924c8"><div class="ttname"><a href="classERF.html#a15af18ae136cf3a11bb63fe0cf3924c8">ERF::print_tpls</a></div><div class="ttdeci">static void print_tpls(std::ostream &amp;)</div><div class="ttdef"><b>Definition:</b> ERF_ConsoleIO.cpp:137</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aeaeb11001478b0635ef0fe3baa396df1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeaeb11001478b0635ef0fe3baa396df1">&#9670;&nbsp;</a></span>print_usage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::print_usage </td>
          <td>(</td>
          <td class="paramtype">MPI_Comm&#160;</td>
          <td class="paramname"><em>comm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;{</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#ifdef AMREX_USE_MPI</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keywordtype">int</span> irank = 0;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="keywordtype">int</span> num_ranks = 1;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    MPI_Comm_size(comm, &amp;num_ranks);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    MPI_Comm_rank(comm, &amp;irank);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="comment">// Only root process does the printing</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keywordflow">if</span> (irank != 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    amrex::ignore_unused(comm);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    out &lt;&lt; R<span class="stringliteral">&quot;doc(Usage:</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="stringliteral">    ERF3d.*.ex &lt;input_file&gt; [param=value] [param=value] ...</span></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_aeaeb11001478b0635ef0fe3baa396df1_icgraph.png" border="0" usemap="#aclassERF_aeaeb11001478b0635ef0fe3baa396df1_icgraph" alt=""/></div>
<map name="aclassERF_aeaeb11001478b0635ef0fe3baa396df1_icgraph" id="aclassERF_aeaeb11001478b0635ef0fe3baa396df1_icgraph">
<area shape="rect" title=" " alt="" coords="108,5,239,32"/>
<area shape="rect" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,60,32"/>
</map>
</div>

</div>
</div>
<a id="adff3b3740b634d2cda1b148f3f3ce2ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adff3b3740b634d2cda1b148f3f3ce2ae">&#9670;&nbsp;</a></span>project_momenta()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::project_momenta </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Vector&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>vars</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Project the single-level momenta to enforce the anelastic constraint Note that the level may or may not be level 0. </p>
<div class="fragment"><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;{</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    BL_PROFILE(<span class="stringliteral">&quot;ERF::project_momenta()&quot;</span>);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="comment">// Make sure the solver only sees the levels over which we are solving</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    Vector&lt;BoxArray&gt;            ba_tmp;   ba_tmp.push_back(mom_mf[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].boxArray());</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    Vector&lt;DistributionMapping&gt; dm_tmp;   dm_tmp.push_back(mom_mf[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].DistributionMap());</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    Vector&lt;Geometry&gt;          geom_tmp; geom_tmp.push_back(geom[lev]);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    MultiFab r_hse(<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev], make_alias, <a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91abc888a343d4fcc4fc4ffb79c6ac7cb93">BaseState::r0_comp</a>, 1);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    Vector&lt;MultiFab&gt; rhs;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    Vector&lt;MultiFab&gt; phi;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> == TerrainType::EB)</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    {</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        rhs.resize(1); rhs[0].define(ba_tmp[0], dm_tmp[0], 1, 0, MFInfo(), <a class="code" href="classERF.html#ad024dd413ab20e5d6f69c1f96e5b78a3">EBFactory</a>(lev));</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        phi.resize(1); phi[0].define(ba_tmp[0], dm_tmp[0], 1, 1, MFInfo(), <a class="code" href="classERF.html#ad024dd413ab20e5d6f69c1f96e5b78a3">EBFactory</a>(lev));</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        rhs.resize(1); rhs[0].define(ba_tmp[0], dm_tmp[0], 1, 0);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        phi.resize(1); phi[0].define(ba_tmp[0], dm_tmp[0], 1, 1);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    }</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keyword">auto</span> dxInv = geom[lev].InvCellSizeArray();</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="comment">// Inflow on an x-face -- note only the normal velocity is used in the projection</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[0] == <span class="stringliteral">&quot;Inflow&quot;</span> || <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[3] == <span class="stringliteral">&quot;Inflow&quot;</span>) {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;            (*<a class="code" href="classERF.html#a64e55e5ae9df06433146db657eb9e72e">physbcs_u</a>[lev])(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                            IntVect{1,0,0},<a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev],<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aab1782753c68aaad8632b0a7d575e57f4">BCVars::xvel_bc</a>,<span class="keyword">false</span>);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        }</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="comment">// Inflow on a  y-face -- note only the normal velocity is used in the projection</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[1] == <span class="stringliteral">&quot;Inflow&quot;</span> || <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[4] == <span class="stringliteral">&quot;Inflow&quot;</span>) {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        (*<a class="code" href="classERF.html#a79231b5cfd4576a742e46ae0082b5121">physbcs_v</a>[lev])(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                          IntVect{0,1,0},<a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev],<a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aa98ad22810fdfe9e585bc6481fc12454e">BCVars::yvel_bc</a>,<span class="keyword">false</span>);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[0] == <span class="stringliteral">&quot;Inflow&quot;</span> || <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[3] == <span class="stringliteral">&quot;Inflow&quot;</span> ||</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[1] == <span class="stringliteral">&quot;Inflow&quot;</span> || <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[4] == <span class="stringliteral">&quot;Inflow&quot;</span>) {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            <a class="code" href="ERF__Utils_8H.html#a5e2e36af19c0192915a2ca721c0cded4">VelocityToMomentum</a>(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>], IntVect{0},</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                               <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>], IntVect{0},</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                               <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>], IntVect{0},</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                               <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                               mom_mf[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269af661293a5a71ca532c214929b98c0bad">IntVars::xmom</a>],</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                               mom_mf[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269a2e60798bc45154a8f905b1aa228a24e5">IntVars::ymom</a>],</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                               mom_mf[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269aaab25f707cae69bfadac2abcd17a2188">IntVars::zmom</a>],</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                               Geom(lev).Domain(),</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                               <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    }</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="comment">// If !fixed_density, we must convert (rho u) which came in</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="comment">// to (rho0 u) which is what we will project</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa40fbbbb9a91d853a2d8290dbd728b48">fixed_density</a>) {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <a class="code" href="ERF__ConvertForProjection_8cpp.html#a652f25f5fd8c87cfe45b61fc878a281f">ConvertForProjection</a>(mom_mf[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], r_hse,</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                             mom_mf[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269af661293a5a71ca532c214929b98c0bad">IntVars::xmom</a>],</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                             mom_mf[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269a2e60798bc45154a8f905b1aa228a24e5">IntVars::ymom</a>],</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                             mom_mf[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269aaab25f707cae69bfadac2abcd17a2188">IntVars::zmom</a>],</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                             Geom(lev).Domain(),</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                             <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    }</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="comment">// Now convert the rho0w MultiFab to hold Omega rather than rhow</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a1952672901901b0b3a628f2298dc72c2">mesh_type</a> == MeshType::VariableDz)</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <span class="keywordflow">for</span> ( MFIter mfi(rhs[0],TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; rho0u_arr = mom_mf[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269af661293a5a71ca532c214929b98c0bad">IntVars::xmom</a>].const_array(mfi);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; rho0v_arr = mom_mf[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269a2e60798bc45154a8f905b1aa228a24e5">IntVars::ymom</a>].const_array(mfi);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            <span class="keyword">const</span> Array4&lt;Real      &gt;&amp; rho0w_arr = mom_mf[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269aaab25f707cae69bfadac2abcd17a2188">IntVars::zmom</a>].array(mfi);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            <span class="keyword">const</span> Array4&lt;Real const&gt;&amp;     z_nd = <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            <span class="keyword">const</span> Array4&lt;Real const&gt;&amp;     mf_u =  <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85baa4b935f173fee2d487101e302a5cfe18">MapFacType::u_x</a>]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            <span class="keyword">const</span> Array4&lt;Real const&gt;&amp;     mf_v =  <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85ba90990e92021688dbfd1cec52b03fd182">MapFacType::v_y</a>]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            <span class="comment">// Define Omega from (rho0 W) but store it in the same array</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            Box tbz = mfi.nodaltilebox(2);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            ParallelFor(tbz, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                <span class="keywordflow">if</span> (k == 0) {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                    rho0w_arr(i,j,k) = Real(0.0);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                    Real rho0w = rho0w_arr(i,j,k);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                    rho0w_arr(i,j,k) = <a class="code" href="ERF__TerrainMetrics_8H.html#a00a82ef863424210898550c6abb4d055">OmegaFromW</a>(i,j,k,rho0w,</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                                                  rho0u_arr,rho0v_arr,</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                                                  mf_u,mf_v,z_nd,dxInv);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                }</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            });</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        } <span class="comment">// mfi</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    }</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="comment">// Compute divergence which will form RHS</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="comment">// Note that we replace &quot;rho0w&quot; with the contravariant momentum, Omega</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    Array&lt;MultiFab const*, AMREX_SPACEDIM&gt; rho0_u_const;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    rho0_u_const[0] = &amp;mom_mf[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269af661293a5a71ca532c214929b98c0bad">IntVars::xmom</a>];</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    rho0_u_const[1] = &amp;mom_mf[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269a2e60798bc45154a8f905b1aa228a24e5">IntVars::ymom</a>];</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    rho0_u_const[2] = &amp;mom_mf[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269aaab25f707cae69bfadac2abcd17a2188">IntVars::zmom</a>];</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <a class="code" href="classERF.html#a757e8303ce8ed936c05f559349f10aa5">compute_divergence</a>(lev, rhs[0], rho0_u_const, geom_tmp[0]);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a1952672901901b0b3a628f2298dc72c2">mesh_type</a> == MeshType::VariableDz) {</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        MultiFab::Multiply(rhs[0], *<a class="code" href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">detJ_cc</a>[lev], 0, 0, 1, 0);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    }</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    Real rhsnorm = rhs[0].norm0();</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    Real rhssum  = rhs[0].sum();</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a2c4e27d6b7928c7081f17e63d0834200">mg_verbose</a> &gt; 0) {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        Print() &lt;&lt; <span class="stringliteral">&quot;Max/L2 norm of divergence before solve at level &quot;</span> &lt;&lt; lev &lt;&lt; <span class="stringliteral">&quot; : &quot;</span> &lt;&lt; rhsnorm &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; rhs[0].norm2() &lt;&lt; <span class="stringliteral">&quot; and sum &quot;</span> &lt;&lt; rhssum &lt;&lt; std::endl;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    }</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="comment">// No need to build the solver if RHS == 0</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordflow">if</span> (rhsnorm &lt;= <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ad7f586d62fb0872ba0340fb03d462c64">poisson_abstol</a>) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="comment">// Initialize phi to 0</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="comment">// (It is essential that we do this in order to fill the corners; these are never</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="comment">//  used but the Saxpy requires the values to be initialized.)</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    phi[0].setVal(0.0);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    Real start_step = <span class="keyword">static_cast&lt;</span>Real<span class="keyword">&gt;</span>(ParallelDescriptor::second());</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="comment">// Allocate fluxes</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    Vector&lt;Array&lt;MultiFab,AMREX_SPACEDIM&gt; &gt; fluxes;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    fluxes.resize(1);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idim = 0; idim &lt; AMREX_SPACEDIM; ++idim) {</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> == TerrainType::EB) {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            fluxes[0][idim].define(convert(ba_tmp[0], IntVect::TheDimensionVector(idim)), dm_tmp[0], 1, 0, MFInfo(), <a class="code" href="classERF.html#ad024dd413ab20e5d6f69c1f96e5b78a3">EBFactory</a>(lev));</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            fluxes[0][idim].define(convert(ba_tmp[0], IntVect::TheDimensionVector(idim)), dm_tmp[0], 1, 0);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    }</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="comment">// Choose the solver and solve</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="comment">// EB</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> == TerrainType::EB) {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <a class="code" href="classERF.html#aa31ae8bd097ec65d711070aedf11a14a">solve_with_EB_mlmg</a>(lev, rhs, phi, fluxes);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="preprocessor">#ifdef ERF_USE_FFT</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        Box my_region(ba_tmp[0].minimalBox());</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <span class="keywordtype">bool</span> boxes_make_rectangle = (my_region.numPts() == ba_tmp[0].numPts());</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="comment">// No terrain or grid stretching</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a1952672901901b0b3a628f2298dc72c2">mesh_type</a> == MeshType::ConstantDz) {</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="preprocessor">#ifdef ERF_USE_FFT</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a35e6065478296fac62affbf8f53b8c23">use_fft</a>) {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            <span class="keywordflow">if</span> (boxes_make_rectangle) {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                solve_with_fft(lev, rhs[0], phi[0], fluxes[0]);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                amrex::Warning(<span class="stringliteral">&quot;FFT won&#39;t work unless the union of boxes is rectangular: defaulting to MLMG&quot;</span>);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                <a class="code" href="classERF.html#a8a7c7fe95147d8772047aa0772a09564">solve_with_mlmg</a>(lev, rhs, phi, fluxes);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            }</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            <a class="code" href="classERF.html#a8a7c7fe95147d8772047aa0772a09564">solve_with_mlmg</a>(lev, rhs, phi, fluxes);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        }</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a35e6065478296fac62affbf8f53b8c23">use_fft</a>) {</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            amrex::Warning(<span class="stringliteral">&quot;You set use_fft=true but didn&#39;t build with USE_FFT = TRUE; defaulting to MLMG&quot;</span>);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        }</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <a class="code" href="classERF.html#a8a7c7fe95147d8772047aa0772a09564">solve_with_mlmg</a>(lev, rhs, phi, fluxes);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    } <span class="comment">// No terrain or grid stretching</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="comment">// Grid stretching (flat terrain)</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a1952672901901b0b3a628f2298dc72c2">mesh_type</a> == MeshType::StretchedDz) {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="preprocessor">#ifndef ERF_USE_FFT</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        amrex::Abort(<span class="stringliteral">&quot;Rebuild with USE_FFT = TRUE so you can use the FFT solver&quot;</span>);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <span class="keywordflow">if</span> (!boxes_make_rectangle) {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            amrex::Abort(<span class="stringliteral">&quot;FFT won&#39;t work unless the union of boxes is rectangular&quot;</span>);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classERF.html#a35e6065478296fac62affbf8f53b8c23">use_fft</a>) {</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                amrex::Warning(<span class="stringliteral">&quot;Using FFT even though you didn&#39;t set use_fft to true; it&#39;s the best choice&quot;</span>);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            }</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            solve_with_fft(lev, rhs[0], phi[0], fluxes[0]);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        }</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    } <span class="comment">// grid stretching</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160; </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="comment">// General terrain</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a1952672901901b0b3a628f2298dc72c2">mesh_type</a> == MeshType::VariableDz) {</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="preprocessor">#ifdef ERF_USE_FFT</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <span class="keywordflow">if</span> (!boxes_make_rectangle) {</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            amrex::Abort(<span class="stringliteral">&quot;FFT preconditioner for GMRES won&#39;t work unless the union of boxes is rectangular&quot;</span>);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            <a class="code" href="classERF.html#a9866c7874624259ffcfc6edf46dd58ec">solve_with_gmres</a>(lev, rhs, phi, fluxes);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        }</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        amrex::Abort(<span class="stringliteral">&quot;Rebuild with USE_FFT = TRUE so you can use the FFT preconditioner for GMRES&quot;</span>);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    } <span class="comment">// general terrain</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    } <span class="comment">// not EB</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="comment">// Print time in solve</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    Real end_step = <span class="keyword">static_cast&lt;</span>Real<span class="keyword">&gt;</span>(ParallelDescriptor::second());</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a2c4e27d6b7928c7081f17e63d0834200">mg_verbose</a> &gt; 0) {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Time in solve &quot;</span> &lt;&lt; end_step - start_step &lt;&lt; std::endl;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    }</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="comment">// Subtract dt grad(phi) from the momenta (rho0u, rho0v, Omega)</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    MultiFab::Add(mom_mf[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269af661293a5a71ca532c214929b98c0bad">IntVars::xmom</a>],fluxes[0][0],0,0,1,0);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    MultiFab::Add(mom_mf[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269a2e60798bc45154a8f905b1aa228a24e5">IntVars::ymom</a>],fluxes[0][1],0,0,1,0);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    MultiFab::Add(mom_mf[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269aaab25f707cae69bfadac2abcd17a2188">IntVars::zmom</a>],fluxes[0][2],0,0,1,0);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="comment">// Define gradp from fluxes -- note that fluxes is dt * change in Gp</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    MultiFab::Saxpy(<a class="code" href="classERF.html#a29ce17220e488eb840abc53966c34d46">gradp</a>[lev][<a class="code" href="namespaceGpVars.html#ac972418cf9113d552b162715dae54ebdaecfb8189072456062c3c29c137ec2323">GpVars::gpx</a>],-1.0/l_dt,fluxes[0][0],0,0,1,0);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    MultiFab::Saxpy(<a class="code" href="classERF.html#a29ce17220e488eb840abc53966c34d46">gradp</a>[lev][<a class="code" href="namespaceGpVars.html#ac972418cf9113d552b162715dae54ebda8b32fb9218fd4f10ccc5736e6a61a72d">GpVars::gpy</a>],-1.0/l_dt,fluxes[0][1],0,0,1,0);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    MultiFab::Saxpy(<a class="code" href="classERF.html#a29ce17220e488eb840abc53966c34d46">gradp</a>[lev][<a class="code" href="namespaceGpVars.html#ac972418cf9113d552b162715dae54ebda7490c53ed57352abcd4a219cd12bf517">GpVars::gpz</a>],-1.0/l_dt,fluxes[0][2],0,0,1,0);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <a class="code" href="classERF.html#a29ce17220e488eb840abc53966c34d46">gradp</a>[lev][<a class="code" href="namespaceGpVars.html#ac972418cf9113d552b162715dae54ebdaecfb8189072456062c3c29c137ec2323">GpVars::gpx</a>].FillBoundary(geom_tmp[0].periodicity());</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <a class="code" href="classERF.html#a29ce17220e488eb840abc53966c34d46">gradp</a>[lev][<a class="code" href="namespaceGpVars.html#ac972418cf9113d552b162715dae54ebda8b32fb9218fd4f10ccc5736e6a61a72d">GpVars::gpy</a>].FillBoundary(geom_tmp[0].periodicity());</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <a class="code" href="classERF.html#a29ce17220e488eb840abc53966c34d46">gradp</a>[lev][<a class="code" href="namespaceGpVars.html#ac972418cf9113d552b162715dae54ebda7490c53ed57352abcd4a219cd12bf517">GpVars::gpz</a>].FillBoundary(geom_tmp[0].periodicity());</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="comment">// This call is only to verify the divergence after the solve</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="comment">// It is important we do this before computing the rho0w_arr from Omega back to rho0w</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="comment">// THIS IS SIMPLY VERIFYING THE DIVERGENCE AFTER THE SOLVE</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a2c4e27d6b7928c7081f17e63d0834200">mg_verbose</a> &gt; 0)</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    {</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <a class="code" href="classERF.html#a757e8303ce8ed936c05f559349f10aa5">compute_divergence</a>(lev, rhs[0], rho0_u_const, geom_tmp[0]);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160; </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a1952672901901b0b3a628f2298dc72c2">mesh_type</a> == MeshType::VariableDz) {</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            MultiFab::Multiply(rhs[0], *<a class="code" href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">detJ_cc</a>[lev], 0, 0, 1, 0);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        }</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160; </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        Print() &lt;&lt; <span class="stringliteral">&quot;Max/L2 norm of divergence  after solve at level &quot;</span> &lt;&lt; lev &lt;&lt; <span class="stringliteral">&quot; : &quot;</span> &lt;&lt; rhs[0].norm0() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                    rhs[0].norm2() &lt;&lt; <span class="stringliteral">&quot; and sum &quot;</span> &lt;&lt; rhssum &lt;&lt; std::endl;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160; </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="preprocessor">#if 0</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;         <span class="comment">// FOR DEBUGGING ONLY</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;         <span class="keywordflow">for</span> ( MFIter mfi(rhs[0],TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;         {</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; rhs_arr = rhs[0].const_array(mfi);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;            Box bx = mfi.validbox();</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            ParallelFor(bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept {</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                <span class="keywordflow">if</span> (std::abs(rhs_arr(i,j,k)) &gt; 1.e-10) {</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                    amrex::AllPrint() &lt;&lt; <span class="stringliteral">&quot;RHS AFTER SOLVE AT &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                                          IntVect(i,j,k) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; rhs_arr(i,j,k) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                }</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;            });</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;         } <span class="comment">// mfi</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    } <span class="comment">// mg_verbose</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="comment">// Now convert the rho0w MultiFab back to holding (rho0w) rather than Omega</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a1952672901901b0b3a628f2298dc72c2">mesh_type</a> == MeshType::VariableDz)</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    {</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        <span class="keywordflow">for</span> (MFIter mfi(mom_mf[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        {</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;             Box tbz = mfi.nodaltilebox(2);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;             <span class="keyword">const</span> Array4&lt;Real      &gt;&amp; rho0u_arr = mom_mf[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269af661293a5a71ca532c214929b98c0bad">IntVars::xmom</a>].array(mfi);</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;             <span class="keyword">const</span> Array4&lt;Real      &gt;&amp; rho0v_arr = mom_mf[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269a2e60798bc45154a8f905b1aa228a24e5">IntVars::ymom</a>].array(mfi);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;             <span class="keyword">const</span> Array4&lt;Real      &gt;&amp; rho0w_arr = mom_mf[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269aaab25f707cae69bfadac2abcd17a2188">IntVars::zmom</a>].array(mfi);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;             <span class="keyword">const</span> Array4&lt;Real const&gt;&amp;      z_nd = <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;             <span class="keyword">const</span> Array4&lt;Real const&gt;&amp;      mf_u =  <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85baa4b935f173fee2d487101e302a5cfe18">MapFacType::u_x</a>]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;             <span class="keyword">const</span> Array4&lt;Real const&gt;&amp;      mf_v =  <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85ba90990e92021688dbfd1cec52b03fd182">MapFacType::v_y</a>]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;             ParallelFor(tbz, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept {</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                 Real <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa93264ee6dc9b23e994674a68250a2f16">omega</a> = rho0w_arr(i,j,k);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                 rho0w_arr(i,j,k) = <a class="code" href="ERF__TerrainMetrics_8H.html#afb56736aeb87667ff92b696d787b432a">WFromOmega</a>(i,j,k,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa93264ee6dc9b23e994674a68250a2f16">omega</a>,</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                                               rho0u_arr,rho0v_arr,</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                                               mf_u,mf_v,z_nd,dxInv);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;             });</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        } <span class="comment">// mfi</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    }</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160; </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="comment">// If !fixed_density, we must convert (rho0 u) back</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="comment">// to (rho0 u) which is what we will pass back out</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa40fbbbb9a91d853a2d8290dbd728b48">fixed_density</a>) {</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <a class="code" href="ERF__ConvertForProjection_8cpp.html#a652f25f5fd8c87cfe45b61fc878a281f">ConvertForProjection</a>(r_hse, mom_mf[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                             mom_mf[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269af661293a5a71ca532c214929b98c0bad">IntVars::xmom</a>],</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                             mom_mf[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269a2e60798bc45154a8f905b1aa228a24e5">IntVars::ymom</a>],</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                             mom_mf[<a class="code" href="namespaceIntVars.html#a52282f730c54deb760c414b54a12a269aaab25f707cae69bfadac2abcd17a2188">IntVars::zmom</a>],</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                             Geom(lev).Domain(),</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                             <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    }</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="comment">// Update pressure variable with phi -- note that phi is dt * change in pressure</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    MultiFab::Saxpy(<a class="code" href="classERF.html#a0c5206542d4193bb687f5271be6fe5e5">pp_inc</a>[lev], 1.0/l_dt, phi[0],0,0,1,1);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;}</div>
<div class="ttc" id="aERF__ConvertForProjection_8cpp_html_a652f25f5fd8c87cfe45b61fc878a281f"><div class="ttname"><a href="ERF__ConvertForProjection_8cpp.html#a652f25f5fd8c87cfe45b61fc878a281f">ConvertForProjection</a></div><div class="ttdeci">void ConvertForProjection(const MultiFab &amp;den_div, const MultiFab &amp;den_mlt, MultiFab &amp;xmom, MultiFab &amp;ymom, MultiFab &amp;zmom, const Box &amp;domain, const Vector&lt; BCRec &gt; &amp;domain_bcs_type_h)</div><div class="ttdef"><b>Definition:</b> ERF_ConvertForProjection.cpp:25</div></div>
<div class="ttc" id="aERF__TerrainMetrics_8H_html_a00a82ef863424210898550c6abb4d055"><div class="ttname"><a href="ERF__TerrainMetrics_8H.html#a00a82ef863424210898550c6abb4d055">OmegaFromW</a></div><div class="ttdeci">AMREX_GPU_DEVICE AMREX_FORCE_INLINE amrex::Real OmegaFromW(int &amp;i, int &amp;j, int &amp;k, amrex::Real w, const amrex::Array4&lt; const amrex::Real &gt; &amp;u_arr, const amrex::Array4&lt; const amrex::Real &gt; &amp;v_arr, const amrex::Array4&lt; const amrex::Real &gt; &amp;mf_u, const amrex::Array4&lt; const amrex::Real &gt; &amp;mf_v, const amrex::Array4&lt; const amrex::Real &gt; &amp;z_nd, const amrex::GpuArray&lt; amrex::Real, AMREX_SPACEDIM &gt; &amp;dxInv)</div><div class="ttdef"><b>Definition:</b> ERF_TerrainMetrics.H:415</div></div>
<div class="ttc" id="aERF__TerrainMetrics_8H_html_afb56736aeb87667ff92b696d787b432a"><div class="ttname"><a href="ERF__TerrainMetrics_8H.html#afb56736aeb87667ff92b696d787b432a">WFromOmega</a></div><div class="ttdeci">AMREX_GPU_DEVICE AMREX_FORCE_INLINE amrex::Real WFromOmega(int &amp;i, int &amp;j, int &amp;k, amrex::Real omega, const amrex::Array4&lt; const amrex::Real &gt; &amp;u_arr, const amrex::Array4&lt; const amrex::Real &gt; &amp;v_arr, const amrex::Array4&lt; const amrex::Real &gt; &amp;mf_u, const amrex::Array4&lt; const amrex::Real &gt; &amp;mf_v, const amrex::Array4&lt; const amrex::Real &gt; &amp;z_nd, const amrex::GpuArray&lt; amrex::Real, AMREX_SPACEDIM &gt; &amp;dxInv)</div><div class="ttdef"><b>Definition:</b> ERF_TerrainMetrics.H:465</div></div>
<div class="ttc" id="aclassERF_html_a35e6065478296fac62affbf8f53b8c23"><div class="ttname"><a href="classERF.html#a35e6065478296fac62affbf8f53b8c23">ERF::use_fft</a></div><div class="ttdeci">static bool use_fft</div><div class="ttdef"><b>Definition:</b> ERF.H:1029</div></div>
<div class="ttc" id="aclassERF_html_a757e8303ce8ed936c05f559349f10aa5"><div class="ttname"><a href="classERF.html#a757e8303ce8ed936c05f559349f10aa5">ERF::compute_divergence</a></div><div class="ttdeci">void compute_divergence(int lev, amrex::MultiFab &amp;rhs, amrex::Array&lt; amrex::MultiFab const *, AMREX_SPACEDIM &gt; rho0_u_const, amrex::Geometry const &amp;geom_at_lev)</div><div class="ttdef"><b>Definition:</b> ERF_ComputeDivergence.cpp:10</div></div>
<div class="ttc" id="aclassERF_html_a8a7c7fe95147d8772047aa0772a09564"><div class="ttname"><a href="classERF.html#a8a7c7fe95147d8772047aa0772a09564">ERF::solve_with_mlmg</a></div><div class="ttdeci">void solve_with_mlmg(int lev, amrex::Vector&lt; amrex::MultiFab &gt; &amp;rhs, amrex::Vector&lt; amrex::MultiFab &gt; &amp;p, amrex::Vector&lt; amrex::Array&lt; amrex::MultiFab, AMREX_SPACEDIM &gt;&gt; &amp;fluxes)</div><div class="ttdef"><b>Definition:</b> ERF_SolveWithMLMG.cpp:40</div></div>
<div class="ttc" id="aclassERF_html_a9866c7874624259ffcfc6edf46dd58ec"><div class="ttname"><a href="classERF.html#a9866c7874624259ffcfc6edf46dd58ec">ERF::solve_with_gmres</a></div><div class="ttdeci">void solve_with_gmres(int lev, amrex::Vector&lt; amrex::MultiFab &gt; &amp;rhs, amrex::Vector&lt; amrex::MultiFab &gt; &amp;p, amrex::Vector&lt; amrex::Array&lt; amrex::MultiFab, AMREX_SPACEDIM &gt;&gt; &amp;fluxes)</div><div class="ttdef"><b>Definition:</b> ERF_SolveWithGMRES.cpp:12</div></div>
<div class="ttc" id="aclassERF_html_aa31ae8bd097ec65d711070aedf11a14a"><div class="ttname"><a href="classERF.html#aa31ae8bd097ec65d711070aedf11a14a">ERF::solve_with_EB_mlmg</a></div><div class="ttdeci">void solve_with_EB_mlmg(int lev, amrex::Vector&lt; amrex::MultiFab &gt; &amp;rhs, amrex::Vector&lt; amrex::MultiFab &gt; &amp;p, amrex::Vector&lt; amrex::Array&lt; amrex::MultiFab, AMREX_SPACEDIM &gt;&gt; &amp;fluxes)</div><div class="ttdef"><b>Definition:</b> ERF_SolveWithEBMLMG.cpp:19</div></div>
<div class="ttc" id="anamespaceMicVar__Morr_html_ab6f5948b8eeb029d684e7b7d19cfc5daa93264ee6dc9b23e994674a68250a2f16"><div class="ttname"><a href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa93264ee6dc9b23e994674a68250a2f16">MicVar_Morr::omega</a></div><div class="ttdeci">@ omega</div><div class="ttdef"><b>Definition:</b> ERF_Morrison.H:53</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_adff3b3740b634d2cda1b148f3f3ce2ae_cgraph.png" border="0" usemap="#aclassERF_adff3b3740b634d2cda1b148f3f3ce2ae_cgraph" alt=""/></div>
<map name="aclassERF_adff3b3740b634d2cda1b148f3f3ce2ae_cgraph" id="aclassERF_adff3b3740b634d2cda1b148f3f3ce2ae_cgraph">
<area shape="rect" title=" " alt="" coords="5,81,175,108"/>
<area shape="rect" href="ERF__ConvertForProjection_8cpp.html#a652f25f5fd8c87cfe45b61fc878a281f" title=" " alt="" coords="225,5,383,32"/>
<area shape="rect" href="ERF__TerrainMetrics_8H.html#a00a82ef863424210898550c6abb4d055" title=" " alt="" coords="247,56,361,83"/>
<area shape="rect" href="ERF__Utils_8H.html#a5e2e36af19c0192915a2ca721c0cded4" title=" " alt="" coords="223,107,385,133"/>
<area shape="rect" href="ERF__TerrainMetrics_8H.html#afb56736aeb87667ff92b696d787b432a" title=" " alt="" coords="247,157,361,184"/>
<area shape="rect" href="ERF__TerrainMetrics_8H.html#ab0d4aa15ebfd9b62f71ba54057b2f8f5" title=" " alt="" coords="433,107,593,133"/>
</map>
</div>

</div>
</div>
<a id="a8a60eec7b73429ba7bd98341bc4f5a6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a60eec7b73429ba7bd98341bc4f5a6d">&#9670;&nbsp;</a></span>project_velocity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::project_velocity </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Project the single-level velocity field to enforce the anelastic constraint Note that the level may or may not be level 0. </p>
<div class="fragment"><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;{</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    BL_PROFILE(<span class="stringliteral">&quot;ERF::project_velocity()&quot;</span>);</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    <a class="code" href="ERF__Utils_8H.html#a5e2e36af19c0192915a2ca721c0cded4">VelocityToMomentum</a>(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>], IntVect{0},</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;                       <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>], IntVect{0},</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;                       <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>], IntVect{0},</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;                       <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;                       <a class="code" href="classERF.html#a01f3db32272f53dc68025f0a98195e57">rU_new</a>[lev], <a class="code" href="classERF.html#a54e37988486ef96e55e84bd8e91bb688">rV_new</a>[lev], <a class="code" href="classERF.html#aa46c0b0d20525aed10f447923e54dde7">rW_new</a>[lev],</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;                       Geom(lev).Domain(), <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>);</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160; </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    Vector&lt;MultiFab&gt; tmp_mom;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    tmp_mom.push_back(MultiFab(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],make_alias,0,1));</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    tmp_mom.push_back(MultiFab(<a class="code" href="classERF.html#a01f3db32272f53dc68025f0a98195e57">rU_new</a>[lev],make_alias,0,1));</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    tmp_mom.push_back(MultiFab(<a class="code" href="classERF.html#a54e37988486ef96e55e84bd8e91bb688">rV_new</a>[lev],make_alias,0,1));</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    tmp_mom.push_back(MultiFab(<a class="code" href="classERF.html#aa46c0b0d20525aed10f447923e54dde7">rW_new</a>[lev],make_alias,0,1));</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <a class="code" href="classERF.html#adff3b3740b634d2cda1b148f3f3ce2ae">project_momenta</a>(lev, l_dt, tmp_mom);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <a class="code" href="ERF__MomentumToVelocity_8cpp.html#a4909cdce4c261c6dae5564fb714881ea">MomentumToVelocity</a>(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;                       <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;                       <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>],</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;                       <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;                       <a class="code" href="classERF.html#a01f3db32272f53dc68025f0a98195e57">rU_new</a>[lev], <a class="code" href="classERF.html#a54e37988486ef96e55e84bd8e91bb688">rV_new</a>[lev], <a class="code" href="classERF.html#aa46c0b0d20525aed10f447923e54dde7">rW_new</a>[lev],</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;                       Geom(lev).Domain(), <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; }</div>
<div class="ttc" id="aclassERF_html_adff3b3740b634d2cda1b148f3f3ce2ae"><div class="ttname"><a href="classERF.html#adff3b3740b634d2cda1b148f3f3ce2ae">ERF::project_momenta</a></div><div class="ttdeci">void project_momenta(int lev, amrex::Real dt, amrex::Vector&lt; amrex::MultiFab &gt; &amp;vars)</div><div class="ttdef"><b>Definition:</b> ERF_PoissonSolve.cpp:41</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a8a60eec7b73429ba7bd98341bc4f5a6d_cgraph.png" border="0" usemap="#aclassERF_a8a60eec7b73429ba7bd98341bc4f5a6d_cgraph" alt=""/></div>
<map name="aclassERF_a8a60eec7b73429ba7bd98341bc4f5a6d_cgraph" id="aclassERF_a8a60eec7b73429ba7bd98341bc4f5a6d_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,164,57"/>
<area shape="rect" href="ERF__MomentumToVelocity_8cpp.html#a4909cdce4c261c6dae5564fb714881ea" title=" " alt="" coords="212,5,375,32"/>
<area shape="rect" href="ERF__Utils_8H.html#a5e2e36af19c0192915a2ca721c0cded4" title=" " alt="" coords="212,56,375,83"/>
</map>
</div>

</div>
</div>
<a id="a2f36ab3750aa760fb621b40294e0f6c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f36ab3750aa760fb621b40294e0f6c6">&#9670;&nbsp;</a></span>project_velocity_tb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::project_velocity_tb </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Vector&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>vars</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Project the single-level velocity field to enforce incompressibility with a thin body </p>
<div class="fragment"><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;{</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    BL_PROFILE(<span class="stringliteral">&quot;ERF::project_velocity_tb()&quot;</span>);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    AMREX_ALWAYS_ASSERT(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a1952672901901b0b3a628f2298dc72c2">mesh_type</a> == MeshType::ConstantDz);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="comment">// Make sure the solver only sees the levels over which we are solving</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    Vector&lt;BoxArray&gt;            ba_tmp;   ba_tmp.push_back(vmf[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].boxArray());</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    Vector&lt;DistributionMapping&gt; dm_tmp;   dm_tmp.push_back(vmf[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].DistributionMap());</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    Vector&lt;Geometry&gt;          geom_tmp; geom_tmp.push_back(geom[lev]);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="comment">// Use the default settings</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    LPInfo info;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    std::unique_ptr&lt;MLPoisson&gt; p_mlpoisson;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#if 0</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="keywordflow">if</span> (overset_imask[0]) {</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        <span class="comment">// Add overset mask around thin body</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        p_mlpoisson = std::make_unique&lt;MLPoisson&gt;(geom, grids, dmap, GetVecOfConstPtrs(overset_imask), info);</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    }</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        <span class="comment">// Use the default settings</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        p_mlpoisson = std::make_unique&lt;MLPoisson&gt;(geom_tmp, ba_tmp, dm_tmp, info);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    }</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keyword">auto</span> bclo = <a class="code" href="classERF.html#a57580311d47c9fd5e27ba156d287c169">get_projection_bc</a>(Orientation::low);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keyword">auto</span> bchi = <a class="code" href="classERF.html#a57580311d47c9fd5e27ba156d287c169">get_projection_bc</a>(Orientation::high);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordtype">bool</span> need_adjust_rhs = (<a class="code" href="classERF.html#a8279f37ed1b99d9111c49c7b3f854c47">projection_has_dirichlet</a>(bclo) || <a class="code" href="classERF.html#a8279f37ed1b99d9111c49c7b3f854c47">projection_has_dirichlet</a>(bchi)) ? <span class="keyword">false</span> : <span class="keyword">true</span>;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    p_mlpoisson-&gt;setDomainBC(bclo, bchi);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="keywordflow">if</span> (lev &gt; 0) {</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        p_mlpoisson-&gt;setCoarseFineBC(<span class="keyword">nullptr</span>, ref_ratio[lev-1], LinOpBCType::Neumann);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    }</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    p_mlpoisson-&gt;setLevelBC(0, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    Vector&lt;MultiFab&gt; rhs;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    Vector&lt;MultiFab&gt; phi;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    Vector&lt;Array&lt;MultiFab,AMREX_SPACEDIM&gt; &gt; fluxes;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    Vector&lt;Array&lt;MultiFab,AMREX_SPACEDIM&gt; &gt; deltaf; <span class="comment">// f^* - f^{n-1}</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    Vector&lt;Array&lt;MultiFab,AMREX_SPACEDIM&gt; &gt; u_plus_dtdf; <span class="comment">// u + dt*deltaf</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="comment">// Used to pass array of const MFs to ComputeDivergence</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    Array&lt;MultiFab const*, AMREX_SPACEDIM&gt; u;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    rhs.resize(1);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    phi.resize(1);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    fluxes.resize(1);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    deltaf.resize(1);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    u_plus_dtdf.resize(1);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    rhs[0].define(ba_tmp[0], dm_tmp[0], 1, 0);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    phi[0].define(ba_tmp[0], dm_tmp[0], 1, 0);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    rhs[0].setVal(0.0);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    phi[0].setVal(0.0);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idim = 0; idim &lt; AMREX_SPACEDIM; ++idim) {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;             fluxes[0][idim].define(convert(ba_tmp[0], IntVect::TheDimensionVector(idim)), dm_tmp[0], 1, 0);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        u_plus_dtdf[0][idim].define(convert(ba_tmp[0], IntVect::TheDimensionVector(idim)), dm_tmp[0], 1, 0);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;             deltaf[0][idim].define(convert(ba_tmp[0], IntVect::TheDimensionVector(idim)), dm_tmp[0], 1, 0);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;             deltaf[0][idim].setVal(0.0); <span class="comment">// start with f^* == f^{n-1}</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    }</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="preprocessor">#if 0</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="comment">// DEBUG</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    u[0] = &amp;(vmf[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>]);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    u[1] = &amp;(vmf[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>]);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    u[2] = &amp;(vmf[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>]);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    computeDivergence(rhs[0], u, geom[0]);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    Print() &lt;&lt; <span class="stringliteral">&quot;Max norm of divergence before solve at level 0 : &quot;</span> &lt;&lt; rhs[0].norm0() &lt;&lt; std::endl;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> itp = 0; itp &lt; <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a3b9fef36e4613507eef87379c2c9bf03">ncorr</a>; ++itp)</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    {</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <span class="comment">// Calculate u + dt*deltaf</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idim = 0; idim &lt; 3; ++idim) {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            MultiFab::Copy(u_plus_dtdf[0][idim], deltaf[0][idim], 0, 0, 1, 0);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            u_plus_dtdf[0][0].mult(-l_dt,0,1,0);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        }</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        MultiFab::Add(u_plus_dtdf[0][0], vmf[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>], 0, 0, 1, 0);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        MultiFab::Add(u_plus_dtdf[0][1], vmf[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>], 0, 0, 1, 0);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        MultiFab::Add(u_plus_dtdf[0][2], vmf[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>], 0, 0, 1, 0);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        u[0] = &amp;(u_plus_dtdf[0][0]);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        u[1] = &amp;(u_plus_dtdf[0][1]);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        u[2] = &amp;(u_plus_dtdf[0][2]);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        computeDivergence(rhs[0], u, geom_tmp[0]);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="preprocessor">#if 0</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="comment">// DEBUG</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="keywordflow">if</span> (itp==0) {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            <span class="keywordflow">for</span> (MFIter mfi(rhs[0], TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; divU = rhs[0].const_array(mfi);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; uarr = vmf[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].const_array(mfi);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; varr = vmf[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].const_array(mfi);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; warr = vmf[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].const_array(mfi);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                    <span class="keywordflow">if</span> ((i&gt;=120) &amp;&amp; (i&lt;=139) &amp;&amp; (j==0) &amp;&amp; ((k&gt;=127)&amp;&amp;(k&lt;=128))) {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                        amrex::AllPrint() &lt;&lt; <span class="stringliteral">&quot;before project div&quot;</span>&lt;&lt;IntVect(i,j,k)&lt;&lt;<span class="stringliteral">&quot; = &quot;</span>&lt;&lt; divU(i,j,k)</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot; u: &quot;</span> &lt;&lt; uarr(i,j,k) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; uarr(i+1,j,k)</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot; v: &quot;</span> &lt;&lt; varr(i,j,k) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; varr(i,j+1,k)</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot; w: &quot;</span> &lt;&lt; warr(i,j,k) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; warr(i,j,k+1)</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                    }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                });</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            }</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        }</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="comment">// If all Neumann BCs, adjust RHS to make sure we can converge</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="keywordflow">if</span> (need_adjust_rhs) {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            Real <a class="code" href="ERF__ReadBndryPlanes_8cpp.html#a63d3125f6fd361f61d697799f46da817">offset</a> = <a class="code" href="classERF.html#ad156903a5d71364b5fb5884000f28a8a">volWgtSumMF</a>(lev, rhs[0], 0, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            <span class="comment">// amrex::Print() &lt;&lt; &quot;Poisson solvability offset = &quot; &lt;&lt; offset &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            rhs[0].plus(-<a class="code" href="ERF__ReadBndryPlanes_8cpp.html#a63d3125f6fd361f61d697799f46da817">offset</a>, 0, 1);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        }</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <span class="comment">// Initialize phi to 0</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        phi[0].setVal(0.0);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        MLMG mlmg(*p_mlpoisson);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="keywordtype">int</span> max_iter = 100;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        mlmg.setMaxIter(max_iter);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        mlmg.setVerbose(<a class="code" href="classERF.html#a2c4e27d6b7928c7081f17e63d0834200">mg_verbose</a>);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="comment">//mlmg.setBottomVerbose(mg_verbose);</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160; </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="comment">// solve for dt*p</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        mlmg.solve(GetVecOfPtrs(phi),</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                   GetVecOfConstPtrs(rhs),</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                   <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a238b0871f38f8b134ff3fe5af0d05479">poisson_reltol</a>,</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                   <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ad7f586d62fb0872ba0340fb03d462c64">poisson_abstol</a>);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        mlmg.getFluxes(GetVecOfArrOfPtrs(fluxes));</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="comment">// Calculate new intermediate body force with updated gradp</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a5b9b8d719a87a6940f611c6a30e8ccf5">thin_xforce</a>[lev]) {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            MultiFab::Copy(   deltaf[0][0], fluxes[0][0], 0, 0, 1, 0);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            <a class="code" href="ERF__Utils_8H.html#acbc6116a3309adf87b7dc24242dc50ec">ApplyInvertedMask</a>(deltaf[0][0], *<a class="code" href="classERF.html#af044f075df34caa2a530aa13e1801a5b">xflux_imask</a>[0]);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        }</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a18c1142552120bbd22987f34995ee939">thin_yforce</a>[lev]) {</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            MultiFab::Copy(   deltaf[0][1], fluxes[0][1], 0, 0, 1, 0);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            <a class="code" href="ERF__Utils_8H.html#acbc6116a3309adf87b7dc24242dc50ec">ApplyInvertedMask</a>(deltaf[0][1], *<a class="code" href="classERF.html#aa4448d06a3e4fe9740927a636030939d">yflux_imask</a>[0]);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        }</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a56a23d298bc66218bf257d0e793e341f">thin_zforce</a>[lev]) {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            MultiFab::Copy(   deltaf[0][2], fluxes[0][2], 0, 0, 1, 0);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            <a class="code" href="ERF__Utils_8H.html#acbc6116a3309adf87b7dc24242dc50ec">ApplyInvertedMask</a>(deltaf[0][2], *<a class="code" href="classERF.html#ada098767690d194f89717b0deb3adeac">zflux_imask</a>[0]);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        }</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <span class="comment">// DEBUG</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="comment">//        for (MFIter mfi(rhs[0], TilingIfNotGPU()); mfi.isValid(); ++mfi)</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="comment">//        {</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="comment">//            const Box&amp; bx = mfi.tilebox();</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="comment">//            const Array4&lt;Real const&gt;&amp; dfz_arr = deltaf[0][2].const_array(mfi);</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="comment">//            ParallelFor(bx, [=] AMREX_GPU_DEVICE(int i, int j, int k) noexcept</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <span class="comment">//            {</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="comment">//                if ((i&gt;=120) &amp;&amp; (i&lt;=139) &amp;&amp; (j==0) &amp;&amp; (k==128)) {</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="comment">//                    amrex::AllPrint()</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <span class="comment">//                        &lt;&lt; &quot; piter&quot; &lt;&lt; itp</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="comment">//                        &lt;&lt; &quot; dfz&quot;&lt;&lt;IntVect(i,j,k)&lt;&lt;&quot; = &quot;&lt;&lt; dfz_arr(i,j,k)</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <span class="comment">//                        &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="comment">//                }</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <span class="comment">//            });</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="comment">//        }</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <span class="comment">// Update pressure variable with phi -- note that phi is change in pressure, not the full pressure</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        MultiFab::Saxpy(<a class="code" href="classERF.html#a0c5206542d4193bb687f5271be6fe5e5">pp_inc</a>[lev], 1.0, phi[0],0,0,1,0);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        <span class="comment">// Subtract grad(phi) from the velocity components</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        Real beta = 1.0;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        MultiFab::Saxpy(vmf[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>], beta, fluxes[0][0], 0, 0, 1, 0);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        MultiFab::Saxpy(vmf[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>], beta, fluxes[0][1], 0, 0, 1, 0);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        MultiFab::Saxpy(vmf[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>], beta, fluxes[0][2], 0, 0, 1, 0);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a5b9b8d719a87a6940f611c6a30e8ccf5">thin_xforce</a>[lev]) {</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            <a class="code" href="ERF__Utils_8H.html#acebead6f3a33cb7737a1fea98341c3ae">ApplyMask</a>(vmf[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>], *<a class="code" href="classERF.html#af044f075df34caa2a530aa13e1801a5b">xflux_imask</a>[0]);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        }</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a18c1142552120bbd22987f34995ee939">thin_yforce</a>[lev]) {</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            <a class="code" href="ERF__Utils_8H.html#acebead6f3a33cb7737a1fea98341c3ae">ApplyMask</a>(vmf[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>], *<a class="code" href="classERF.html#aa4448d06a3e4fe9740927a636030939d">yflux_imask</a>[0]);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        }</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a56a23d298bc66218bf257d0e793e341f">thin_zforce</a>[lev]) {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            <a class="code" href="ERF__Utils_8H.html#acebead6f3a33cb7737a1fea98341c3ae">ApplyMask</a>(vmf[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>], *<a class="code" href="classERF.html#ada098767690d194f89717b0deb3adeac">zflux_imask</a>[0]);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        }</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    } <span class="comment">// itp: pressure-force iterations</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="comment">// Define gradp from fluxes -- note that fluxes is dt * change in Gp</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    MultiFab::Saxpy(<a class="code" href="classERF.html#a29ce17220e488eb840abc53966c34d46">gradp</a>[lev][<a class="code" href="namespaceGpVars.html#ac972418cf9113d552b162715dae54ebdaecfb8189072456062c3c29c137ec2323">GpVars::gpx</a>],-1.0/l_dt,fluxes[0][0],0,0,1,0);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    MultiFab::Saxpy(<a class="code" href="classERF.html#a29ce17220e488eb840abc53966c34d46">gradp</a>[lev][<a class="code" href="namespaceGpVars.html#ac972418cf9113d552b162715dae54ebda8b32fb9218fd4f10ccc5736e6a61a72d">GpVars::gpy</a>],-1.0/l_dt,fluxes[0][1],0,0,1,0);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    MultiFab::Saxpy(<a class="code" href="classERF.html#a29ce17220e488eb840abc53966c34d46">gradp</a>[lev][<a class="code" href="namespaceGpVars.html#ac972418cf9113d552b162715dae54ebda7490c53ed57352abcd4a219cd12bf517">GpVars::gpz</a>],-1.0/l_dt,fluxes[0][2],0,0,1,0);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160; </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <a class="code" href="classERF.html#a29ce17220e488eb840abc53966c34d46">gradp</a>[lev][<a class="code" href="namespaceGpVars.html#ac972418cf9113d552b162715dae54ebdaecfb8189072456062c3c29c137ec2323">GpVars::gpx</a>].FillBoundary(geom_tmp[0].periodicity());</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <a class="code" href="classERF.html#a29ce17220e488eb840abc53966c34d46">gradp</a>[lev][<a class="code" href="namespaceGpVars.html#ac972418cf9113d552b162715dae54ebda8b32fb9218fd4f10ccc5736e6a61a72d">GpVars::gpy</a>].FillBoundary(geom_tmp[0].periodicity());</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <a class="code" href="classERF.html#a29ce17220e488eb840abc53966c34d46">gradp</a>[lev][<a class="code" href="namespaceGpVars.html#ac972418cf9113d552b162715dae54ebda7490c53ed57352abcd4a219cd12bf517">GpVars::gpz</a>].FillBoundary(geom_tmp[0].periodicity());</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="comment">// Subtract grad(phi) from the velocity components</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">//    Real beta = 1.0;</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">//    for (int ilev = lev_min; ilev &lt;= lev_max; ++ilev) {</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">//        MultiFab::Saxpy(vmf[Vars::xvel], beta, fluxes[0][0], 0, 0, 1, 0);</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">//        MultiFab::Saxpy(vmf[Vars::yvel], beta, fluxes[0][1], 0, 0, 1, 0);</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">//        MultiFab::Saxpy(vmf[Vars::zvel], beta, fluxes[0][2], 0, 0, 1, 0);</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">//        if (thin_xforce[lev]) {</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">//            ApplyMask(vmf[Vars::xvel], *xflux_imask[0]);</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">//        }</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">//        if (thin_yforce[lev]) {</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">//            ApplyMask(vmf[Vars::yvel], *yflux_imask[0]);</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">//        }</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">//        if (thin_zforce[lev]) {</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">//            ApplyMask(vmf[Vars::zvel], *zflux_imask[0]);</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">//        }</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">//    }</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="preprocessor">#if 0</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="comment">// Confirm that the velocity is now divergence free</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    u[0] = &amp;(vmf[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>]);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    u[1] = &amp;(vmf[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>]);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    u[2] = &amp;(vmf[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>]);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    computeDivergence(rhs[0], u, geom_tmp[0]);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    Print() &lt;&lt; <span class="stringliteral">&quot;Max norm of divergence after solve at level &quot;</span> &lt;&lt; lev &lt;&lt; <span class="stringliteral">&quot; : &quot;</span> &lt;&lt; rhs[0].norm0() &lt;&lt; std::endl;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;}</div>
<div class="ttc" id="aERF__ReadBndryPlanes_8cpp_html_a63d3125f6fd361f61d697799f46da817"><div class="ttname"><a href="ERF__ReadBndryPlanes_8cpp.html#a63d3125f6fd361f61d697799f46da817">offset</a></div><div class="ttdeci">AMREX_FORCE_INLINE IntVect offset(const int face_dir, const int normal)</div><div class="ttdef"><b>Definition:</b> ERF_ReadBndryPlanes.cpp:28</div></div>
<div class="ttc" id="aERF__Utils_8H_html_acbc6116a3309adf87b7dc24242dc50ec"><div class="ttname"><a href="ERF__Utils_8H.html#acbc6116a3309adf87b7dc24242dc50ec">ApplyInvertedMask</a></div><div class="ttdeci">AMREX_GPU_HOST AMREX_FORCE_INLINE void ApplyInvertedMask(amrex::MultiFab &amp;dst, const amrex::iMultiFab &amp;imask, const int nghost=0)</div><div class="ttdef"><b>Definition:</b> ERF_Utils.H:409</div></div>
<div class="ttc" id="aclassERF_html_a57580311d47c9fd5e27ba156d287c169"><div class="ttname"><a href="classERF.html#a57580311d47c9fd5e27ba156d287c169">ERF::get_projection_bc</a></div><div class="ttdeci">amrex::Array&lt; amrex::LinOpBCType, AMREX_SPACEDIM &gt; get_projection_bc(amrex::Orientation::Side side) const noexcept</div><div class="ttdef"><b>Definition:</b> ERF_SolveWithMLMG.cpp:17</div></div>
<div class="ttc" id="aclassERF_html_a8279f37ed1b99d9111c49c7b3f854c47"><div class="ttname"><a href="classERF.html#a8279f37ed1b99d9111c49c7b3f854c47">ERF::projection_has_dirichlet</a></div><div class="ttdeci">bool projection_has_dirichlet(amrex::Array&lt; amrex::LinOpBCType, AMREX_SPACEDIM &gt; bcs) const</div><div class="ttdef"><b>Definition:</b> ERF_PoissonSolve_tb.cpp:8</div></div>
<div class="ttc" id="aclassERF_html_ad156903a5d71364b5fb5884000f28a8a"><div class="ttname"><a href="classERF.html#ad156903a5d71364b5fb5884000f28a8a">ERF::volWgtSumMF</a></div><div class="ttdeci">amrex::Real volWgtSumMF(int lev, const amrex::MultiFab &amp;mf, int comp, bool finemask)</div><div class="ttdef"><b>Definition:</b> ERF_WriteScalarProfiles.cpp:651</div></div>
<div class="ttc" id="astructSolverChoice_html_a3b9fef36e4613507eef87379c2c9bf03"><div class="ttname"><a href="structSolverChoice.html#a3b9fef36e4613507eef87379c2c9bf03">SolverChoice::ncorr</a></div><div class="ttdeci">int ncorr</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:727</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a2f36ab3750aa760fb621b40294e0f6c6_cgraph.png" border="0" usemap="#aclassERF_a2f36ab3750aa760fb621b40294e0f6c6_cgraph" alt=""/></div>
<map name="aclassERF_a2f36ab3750aa760fb621b40294e0f6c6_cgraph" id="aclassERF_a2f36ab3750aa760fb621b40294e0f6c6_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,184,83"/>
<area shape="rect" href="ERF__Utils_8H.html#acbc6116a3309adf87b7dc24242dc50ec" title=" " alt="" coords="232,5,380,32"/>
<area shape="rect" href="ERF__Utils_8H.html#acebead6f3a33cb7737a1fea98341c3ae" title=" " alt="" coords="259,56,353,83"/>
<area shape="rect" href="ERF__ReadBndryPlanes_8cpp.html#a63d3125f6fd361f61d697799f46da817" title=" " alt="" coords="277,107,335,133"/>
</map>
</div>

</div>
</div>
<a id="a8279f37ed1b99d9111c49c7b3f854c47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8279f37ed1b99d9111c49c7b3f854c47">&#9670;&nbsp;</a></span>projection_has_dirichlet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ERF::projection_has_dirichlet </td>
          <td>(</td>
          <td class="paramtype">amrex::Array&lt; amrex::LinOpBCType, AMREX_SPACEDIM &gt;&#160;</td>
          <td class="paramname"><em>bcs</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;{</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dir = 0; dir &lt; AMREX_SPACEDIM; ++dir) {</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;        <span class="keywordflow">if</span> (bcs[dir] == LinOpBCType::Dirichlet) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    }</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af285247b24b173cd851fe49799d17f42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af285247b24b173cd851fe49799d17f42">&#9670;&nbsp;</a></span>ReadCheckpointFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::ReadCheckpointFile </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="classERF.html">ERF</a> function for reading data from a checkpoint file during restart. </p>
<div class="fragment"><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;{</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    Print() &lt;&lt; <span class="stringliteral">&quot;Restart from native checkpoint &quot;</span> &lt;&lt; <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160; </div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="comment">// Header</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    std::string File(<a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a> + <span class="stringliteral">&quot;/Header&quot;</span>);</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160; </div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    VisMF::IO_Buffer io_buffer(VisMF::GetIOBufferSize());</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    Vector&lt;char&gt; fileCharPtr;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    ParallelDescriptor::ReadAndBcastFile(File, fileCharPtr);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    std::string fileCharPtrString(fileCharPtr.dataPtr());</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    std::istringstream is(fileCharPtrString, std::istringstream::in);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160; </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    std::string line, word;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160; </div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="keywordtype">int</span> chk_ncomp_cons, chk_ncomp;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160; </div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="comment">// read in title line</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    std::getline(is, line);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160; </div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="comment">// read in finest_level</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    is &gt;&gt; finest_level;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <a class="code" href="classERF.html#aaee255b031e63bd9b5807f6612739dbd">GotoNextLine</a>(is);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160; </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="comment">// read the number of components</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="comment">// for each variable we store</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160; </div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="comment">// conservative, cell-centered vars</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    is &gt;&gt; chk_ncomp_cons;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <a class="code" href="classERF.html#aaee255b031e63bd9b5807f6612739dbd">GotoNextLine</a>(is);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160; </div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="comment">// x-velocity on faces</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    is &gt;&gt; chk_ncomp;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <a class="code" href="classERF.html#aaee255b031e63bd9b5807f6612739dbd">GotoNextLine</a>(is);</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    AMREX_ASSERT(chk_ncomp == 1);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160; </div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="comment">// y-velocity on faces</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    is &gt;&gt; chk_ncomp;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <a class="code" href="classERF.html#aaee255b031e63bd9b5807f6612739dbd">GotoNextLine</a>(is);</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    AMREX_ASSERT(chk_ncomp == 1);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160; </div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="comment">// z-velocity on faces</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    is &gt;&gt; chk_ncomp;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <a class="code" href="classERF.html#aaee255b031e63bd9b5807f6612739dbd">GotoNextLine</a>(is);</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    AMREX_ASSERT(chk_ncomp == 1);</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160; </div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="comment">// read in array of istep</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    std::getline(is, line);</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    {</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        std::istringstream lis(line);</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <span class="keywordflow">while</span> (lis &gt;&gt; word) {</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[i++] = std::stoi(word);</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        }</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    }</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160; </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="comment">// read in array of dt</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    std::getline(is, line);</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    {</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        std::istringstream lis(line);</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        <span class="keywordflow">while</span> (lis &gt;&gt; word) {</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;            <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[i++] = std::stod(word);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        }</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    }</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160; </div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="comment">// read in array of t_new</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    std::getline(is, line);</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    {</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        std::istringstream lis(line);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        <span class="keywordflow">while</span> (lis &gt;&gt; word) {</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;            <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[i++] = std::stod(word);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        }</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    }</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160; </div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        <span class="comment">// read in level &#39;lev&#39; BoxArray from Header</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        BoxArray ba;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        ba.readFrom(is);</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        <a class="code" href="classERF.html#aaee255b031e63bd9b5807f6612739dbd">GotoNextLine</a>(is);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160; </div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        <span class="comment">// create a distribution mapping</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        DistributionMapping dm { ba, ParallelDescriptor::NProcs() };</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160; </div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        <a class="code" href="classERF.html#aaf10bbf8c9a5dbc257a88c4c1b650fee">MakeNewLevelFromScratch</a> (lev, <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev], ba, dm);</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    }</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160; </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="comment">// ncomp is only valid after we MakeNewLevelFromScratch (asks micro how many vars)</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="comment">// NOTE: Data is written over ncomp, so check that we match the header file</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="keywordtype">int</span> ncomp_cons = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[0][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nComp();</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160; </div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="comment">// NOTE: QKE was removed so this is for backward compatibility</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    AMREX_ASSERT((chk_ncomp_cons==ncomp_cons) || ((chk_ncomp_cons-1)==ncomp_cons));</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="comment">// See if we have a written separate file that tells how many components and how many ghost cells</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="comment">// we have of the base state</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="comment">// If we can&#39;t find the file, then set the number of components to the original number = 3</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="keywordtype">int</span> ncomp_base_to_read = 3;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    IntVect ng_base = IntVect{1};</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    {</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;         std::string BaseStateFile(<a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a> + <span class="stringliteral">&quot;/num_base_state_comps&quot;</span>);</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160; </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;         <span class="keywordflow">if</span> (amrex::FileExists(BaseStateFile))</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;         {</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;             Vector&lt;char&gt; BaseStatefileCharPtr;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;             ParallelDescriptor::ReadAndBcastFile(BaseStateFile, BaseStatefileCharPtr);</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;             std::string BaseStatefileCharPtrString(BaseStatefileCharPtr.dataPtr());</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160; </div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;             <span class="comment">// We set this to the default value of 3 but allow it be larger if th0 and qv0 were written</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;             std::istringstream isb(BaseStatefileCharPtrString, std::istringstream::in);</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;             isb &gt;&gt; ncomp_base_to_read;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;             isb &gt;&gt; ng_base;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;         }</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    }</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160; </div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="comment">// read in the MultiFab data</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev)</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    {</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        <span class="comment">// NOTE: For backward compatibility (chk file has QKE)</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        <span class="keywordflow">if</span> ((chk_ncomp_cons-1)==ncomp_cons) {</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;            MultiFab <a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">cons</a>(grids[lev],dmap[lev],chk_ncomp_cons,0);</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;            VisMF::Read(<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">cons</a>, MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;Cell&quot;</span>));</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160; </div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;            <span class="comment">// Copy up to RhoKE_comp</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;            MultiFab::Copy(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">cons</a>,0,0,(<a class="code" href="ERF__IndexDefines_8H.html#ae15721db2cb4c2ab4732afe226bbba64">RhoKE_comp</a>+1),0);</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160; </div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;            <span class="comment">// Only if we have a PBL model do we need to copy QKE is src to KE in dst</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;            <span class="keywordflow">if</span> ( (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa53b017d79e0067923180a0aa59367b4">turbChoice</a>[lev].pbl_type == PBLType::MYNN25) ||</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                 (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa53b017d79e0067923180a0aa59367b4">turbChoice</a>[lev].pbl_type == PBLType::MYNNEDMF) ) {</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                MultiFab::Copy(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">cons</a>,(<a class="code" href="ERF__IndexDefines_8H.html#ae15721db2cb4c2ab4732afe226bbba64">RhoKE_comp</a>+1),<a class="code" href="ERF__IndexDefines_8H.html#ae15721db2cb4c2ab4732afe226bbba64">RhoKE_comp</a>,1,0);</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].mult(0.5,<a class="code" href="ERF__IndexDefines_8H.html#ae15721db2cb4c2ab4732afe226bbba64">RhoKE_comp</a>,1,0);</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;            }</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160; </div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;            <span class="comment">// Copy other components</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;            <span class="keywordtype">int</span> ncomp_remainder = ncomp_cons - (<a class="code" href="ERF__IndexDefines_8H.html#ae15721db2cb4c2ab4732afe226bbba64">RhoKE_comp</a> + 1);</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;            MultiFab::Copy(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">cons</a>,(<a class="code" href="ERF__IndexDefines_8H.html#ae15721db2cb4c2ab4732afe226bbba64">RhoKE_comp</a>+2),(<a class="code" href="ERF__IndexDefines_8H.html#ae15721db2cb4c2ab4732afe226bbba64">RhoKE_comp</a>+1),ncomp_remainder,0);</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160; </div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;            <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].setBndry(1.0e34);</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;            MultiFab <a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">cons</a>(grids[lev],dmap[lev],ncomp_cons,0);</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;            VisMF::Read(<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">cons</a>, MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;Cell&quot;</span>));</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;            MultiFab::Copy(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">cons</a>,0,0,ncomp_cons,0);</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;            <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].setBndry(1.0e34);</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        }</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160; </div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        MultiFab <a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">xvel</a>(convert(grids[lev],IntVect(1,0,0)),dmap[lev],1,0);</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        VisMF::Read(<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">xvel</a>, MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;XFace&quot;</span>));</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        MultiFab::Copy(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">xvel</a>,0,0,1,0);</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].setBndry(1.0e34);</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160; </div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        MultiFab <a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">yvel</a>(convert(grids[lev],IntVect(0,1,0)),dmap[lev],1,0);</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        VisMF::Read(<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">yvel</a>, MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;YFace&quot;</span>));</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        MultiFab::Copy(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">yvel</a>,0,0,1,0);</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].setBndry(1.0e34);</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160; </div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        MultiFab <a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">zvel</a>(convert(grids[lev],IntVect(0,0,1)),dmap[lev],1,0);</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        VisMF::Read(<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">zvel</a>, MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;ZFace&quot;</span>));</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        MultiFab::Copy(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>],<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">zvel</a>,0,0,1,0);</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].setBndry(1.0e34);</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160; </div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        <span class="comment">// Note that we read the ghost cells of the base state (unlike above)</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160; </div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        <span class="comment">// The original base state only had 3 components and 1 ghost cell -- we read this</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        <span class="comment">// here to be consistent with the old style</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        MultiFab base(grids[lev],dmap[lev],ncomp_base_to_read,ng_base);</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        VisMF::Read(base, MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;BaseState&quot;</span>));</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160; </div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        MultiFab::Copy(<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev],base,0,0,ncomp_base_to_read,ng_base);</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160; </div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        <span class="comment">// Create theta0 from p0, rh0</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        <span class="keywordflow">if</span> (ncomp_base_to_read &lt; 4) {</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;            <span class="keywordflow">for</span> (MFIter mfi(<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev],TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;            {</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                <span class="comment">// We only compute theta_0 on valid cells since we will impose domain BC&#39;s after restart</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                Array4&lt;Real&gt; <span class="keyword">const</span>&amp; fab = <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].array(mfi);</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                ParallelFor(bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                {</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                    fab(i,j,k,<a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91aaf394bbf6aa8da56fc479f2ed5a2a372">BaseState::th0_comp</a>) = <a class="code" href="ERF__EOS_8H.html#a3cc0ee7727b26e21a97acfc2ad2e6d4d">getRhoThetagivenP</a>(fab(i,j,k,<a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91aa8253dc5484f2621e0bf8d51d98d635e">BaseState::p0_comp</a>))</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                                                     / fab(i,j,k,<a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91abc888a343d4fcc4fc4ffb79c6ac7cb93">BaseState::r0_comp</a>);</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                });</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;            }</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        }</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        <span class="comment">// Default theta0 to 0</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        <span class="keywordflow">if</span> (ncomp_base_to_read &lt; 5) {</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;            <span class="keywordflow">for</span> (MFIter mfi(<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev],TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;            {</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                <span class="comment">// We only compute theta_0 on valid cells since we will impose domain BC&#39;s after restart</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                Array4&lt;Real&gt; <span class="keyword">const</span>&amp; fab = <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].array(mfi);</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                ParallelFor(bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                {</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                    fab(i,j,k,<a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91a246ae4776111c528e79c6ad9f2ca9560">BaseState::qv0_comp</a>) = 0.0;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                });</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;            }</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        }</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160; </div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structSolverChoice.html#a1952672901901b0b3a628f2298dc72c2">SolverChoice::mesh_type</a> != MeshType::ConstantDz)  {</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;           <span class="comment">// Note that we also read the ghost cells of z_phys_nd</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;           IntVect <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a> = <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev]-&gt;nGrowVect();</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;           MultiFab z_height(convert(grids[lev],IntVect(1,1,1)),dmap[lev],1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;           VisMF::Read(z_height, MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;Z_Phys_nd&quot;</span>));</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;           MultiFab::Copy(*<a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev],z_height,0,0,1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;           <a class="code" href="classERF.html#a7dba7f9e6bd3f6898fac9ac2efcec692">update_terrain_arrays</a>(lev);</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        }</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160; </div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        <span class="comment">// Read in the moisture model restart variables</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        std::vector&lt;int&gt; qmoist_indices;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        std::vector&lt;std::string&gt; qmoist_names;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;Get_Qmoist_Restart_Vars(lev, <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>, qmoist_indices, qmoist_names);</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        <span class="keywordtype">int</span> qmoist_nvar = qmoist_indices.size();</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> var = 0; var &lt; qmoist_nvar; var++) {</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> ncomp  = 1;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;            IntVect ng_moist = <a class="code" href="classERF.html#ae00126a9c2738bf6a6cbbe77321c9cfc">qmoist</a>[lev][qmoist_indices[var]]-&gt;nGrowVect();</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;            MultiFab moist_vars(grids[lev],dmap[lev],ncomp,ng_moist);</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;            VisMF::Read(moist_vars, amrex::MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, qmoist_names[var]));</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;            MultiFab::Copy(*(<a class="code" href="classERF.html#ae00126a9c2738bf6a6cbbe77321c9cfc">qmoist</a>[lev][qmoist_indices[var]]),moist_vars,0,0,ncomp,ng_moist);</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        }</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160; </div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="preprocessor">#if defined(ERF_USE_WINDFARM)</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac0a723e8797cdc0fe06b3fc781fca645">windfarm_type</a> == WindFarmType::Fitch or</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;           <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac0a723e8797cdc0fe06b3fc781fca645">windfarm_type</a> == WindFarmType::EWP or</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;           <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac0a723e8797cdc0fe06b3fc781fca645">windfarm_type</a> == WindFarmType::SimpleAD){</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;            IntVect <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a> = Nturb[lev].nGrowVect();</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;            MultiFab mf_Nturb(grids[lev],dmap[lev],1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;            VisMF::Read(mf_Nturb, amrex::MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;NumTurb&quot;</span>));</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;            MultiFab::Copy(Nturb[lev],mf_Nturb,0,0,1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        }</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160; </div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a43c1741535574c7e6f4fe6bf90552f31">lsm_type</a> != LandSurfaceType::None) {</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> mvar(0); mvar&lt;<a class="code" href="classERF.html#ad03da3399e893728741fac33100ce476">lsm_data</a>[lev].size(); ++mvar) {</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                BoxArray ba = <a class="code" href="classERF.html#ad03da3399e893728741fac33100ce476">lsm_data</a>[lev][mvar]-&gt;boxArray();</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                DistributionMapping dm = <a class="code" href="classERF.html#ad03da3399e893728741fac33100ce476">lsm_data</a>[lev][mvar]-&gt;DistributionMap();</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                IntVect <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a> = <a class="code" href="classERF.html#ad03da3399e893728741fac33100ce476">lsm_data</a>[lev][mvar]-&gt;nGrowVect();</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                <span class="keywordtype">int</span> nvar = <a class="code" href="classERF.html#ad03da3399e893728741fac33100ce476">lsm_data</a>[lev][mvar]-&gt;nComp();</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                MultiFab lsm_vars(ba,dm,nvar,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                VisMF::Read(lsm_vars, MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;LsmVars&quot;</span>));</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                MultiFab::Copy(*(<a class="code" href="classERF.html#ad03da3399e893728741fac33100ce476">lsm_data</a>[lev][mvar]),lsm_vars,0,0,nvar,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;            }</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        }</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160; </div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160; </div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        IntVect <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a> = <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85bac2a428daaf1a1b398630fa8cec7f115b">MapFacType::m_x</a>]-&gt;nGrowVect();</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        MultiFab mf_m(<a class="code" href="classERF.html#a268a79187ae9a115e601957f8b06cd42">ba2d</a>[lev],dmap[lev],1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160; </div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        std::string MapFacMFileName(<a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a> + <span class="stringliteral">&quot;/Level_0/MapFactor_mx_H&quot;</span>);</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        <span class="keywordflow">if</span> (amrex::FileExists(MapFacMFileName)) {</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;            VisMF::Read(mf_m, MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;MapFactor_mx&quot;</span>));</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;            VisMF::Read(mf_m, MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;MapFactor_m&quot;</span>));</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        }</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        MultiFab::Copy(*<a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85bac2a428daaf1a1b398630fa8cec7f115b">MapFacType::m_x</a>],mf_m,0,0,1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160; </div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="preprocessor">#if 0</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85bac2a428daaf1a1b398630fa8cec7f115b">MapFacType::m_x</a> != <a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85ba9612b6816e2fb7dc3ad56d6bc1fb7df8">MapFacType::m_y</a>) {</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;            VisMF::Read(mf_m, MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;MapFactor_my&quot;</span>));</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;            MultiFab::Copy(*<a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85ba9612b6816e2fb7dc3ad56d6bc1fb7df8">MapFacType::m_y</a>],mf_m,0,0,1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        }</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160; </div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;        <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a> = <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85baa4b935f173fee2d487101e302a5cfe18">MapFacType::u_x</a>]-&gt;nGrowVect();</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        MultiFab mf_u(convert(<a class="code" href="classERF.html#a268a79187ae9a115e601957f8b06cd42">ba2d</a>[lev],IntVect(1,0,0)),dmap[lev],1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160; </div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;        std::string MapFacUFileName(<a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a> + <span class="stringliteral">&quot;/Level_0/MapFactor_ux_H&quot;</span>);</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;        <span class="keywordflow">if</span> (amrex::FileExists(MapFacUFileName)) {</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;            VisMF::Read(mf_u, MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;MapFactor_ux&quot;</span>));</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;            VisMF::Read(mf_u, MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;MapFactor_u&quot;</span>));</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        }</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        MultiFab::Copy(*<a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85baa4b935f173fee2d487101e302a5cfe18">MapFacType::u_x</a>],mf_u,0,0,1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160; </div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="preprocessor">#if 0</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85baa4b935f173fee2d487101e302a5cfe18">MapFacType::u_x</a> != <a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85ba784971ba75d56c0d71c4bc08c5ddc1f3">MapFacType::u_y</a>) {</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;            VisMF::Read(mf_u, MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;MapFactor_uy&quot;</span>));</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;            MultiFab::Copy(*<a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85ba784971ba75d56c0d71c4bc08c5ddc1f3">MapFacType::u_y</a>],mf_u,0,0,1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        }</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160; </div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a> = <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85ba21e22c79b875be81696b36a623690388">MapFacType::v_x</a>]-&gt;nGrowVect();</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        MultiFab mf_v(convert(<a class="code" href="classERF.html#a268a79187ae9a115e601957f8b06cd42">ba2d</a>[lev],IntVect(0,1,0)),dmap[lev],1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160; </div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        std::string MapFacVFileName(<a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a> + <span class="stringliteral">&quot;/Level_0/MapFactor_vx_H&quot;</span>);</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        <span class="keywordflow">if</span> (amrex::FileExists(MapFacVFileName)) {</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;            VisMF::Read(mf_v, MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;MapFactor_vx&quot;</span>));</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;            VisMF::Read(mf_v, MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;MapFactor_v&quot;</span>));</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        }</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        MultiFab::Copy(*<a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85ba21e22c79b875be81696b36a623690388">MapFacType::v_x</a>],mf_v,0,0,1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160; </div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="preprocessor">#if 0</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85ba21e22c79b875be81696b36a623690388">MapFacType::v_x</a> != <a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85ba90990e92021688dbfd1cec52b03fd182">MapFacType::v_y</a>) {</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;            VisMF::Read(mf_v, MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;MapFactor_vy&quot;</span>));</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;            MultiFab::Copy(*<a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85ba90990e92021688dbfd1cec52b03fd182">MapFacType::v_y</a>],mf_v,0,0,1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;        }</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160; </div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160; </div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        <span class="comment">// NOTE: We read MOST data in ReadCheckpointFileMOST (see below)!</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160; </div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;        <span class="comment">// See if we wrote out SST data</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        std::string FirstSSTFileName(<a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a> + <span class="stringliteral">&quot;/Level_0/SST_0_H&quot;</span>);</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        <span class="keywordflow">if</span> (amrex::FileExists(FirstSSTFileName))</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        {</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;            amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Reading SST data&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;            <span class="keywordtype">int</span> ntimes = 1;</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;            <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a> = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nGrowVect(); <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>[2]=0;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;            MultiFab sst_at_t(<a class="code" href="classERF.html#a268a79187ae9a115e601957f8b06cd42">ba2d</a>[lev],dmap[lev],1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;            <a class="code" href="classERF.html#a5a5395054a212d8f3fc577562c14b66e">sst_lev</a>[lev][0] = std::make_unique&lt;MultiFab&gt;(<a class="code" href="classERF.html#a268a79187ae9a115e601957f8b06cd42">ba2d</a>[lev],dmap[lev],1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nt(0); nt&lt;ntimes; ++nt) {</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                VisMF::Read(sst_at_t, MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>,</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                                                             <span class="stringliteral">&quot;SST_&quot;</span> + std::to_string(nt)));</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                MultiFab::Copy(*<a class="code" href="classERF.html#a5a5395054a212d8f3fc577562c14b66e">sst_lev</a>[lev][nt],sst_at_t,0,0,1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;            }</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        }</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160; </div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;        <span class="comment">// See if we wrote out TSK data</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;        std::string FirstTSKFileName(<a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a> + <span class="stringliteral">&quot;/Level_0/TSK_0_H&quot;</span>);</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        <span class="keywordflow">if</span> (amrex::FileExists(FirstTSKFileName))</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;        {</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;            amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Reading TSK data&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;            <span class="keywordtype">int</span> ntimes = 1;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;            <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a> = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nGrowVect(); <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>[2]=0;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;            MultiFab tsk_at_t(<a class="code" href="classERF.html#a268a79187ae9a115e601957f8b06cd42">ba2d</a>[lev],dmap[lev],1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;            <a class="code" href="classERF.html#af89fb8b555dde334c978cdfd3fcd9d07">tsk_lev</a>[lev][0] = std::make_unique&lt;MultiFab&gt;(<a class="code" href="classERF.html#a268a79187ae9a115e601957f8b06cd42">ba2d</a>[lev],dmap[lev],1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nt(0); nt&lt;ntimes; ++nt) {</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                VisMF::Read(tsk_at_t, MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>,</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                                                             <span class="stringliteral">&quot;TSK_&quot;</span> + std::to_string(nt)));</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                MultiFab::Copy(*<a class="code" href="classERF.html#af89fb8b555dde334c978cdfd3fcd9d07">tsk_lev</a>[lev][nt],tsk_at_t,0,0,1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;            }</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;        }</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160; </div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        std::string LMaskFileName(<a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a> + <span class="stringliteral">&quot;/Level_0/LMASK_0_H&quot;</span>);</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        <span class="keywordflow">if</span> (amrex::FileExists(LMaskFileName))</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        {</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;            amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Reading LMASK data&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;            <span class="keywordtype">int</span> ntimes = 1;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;            <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a> = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nGrowVect(); <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>[2]=0;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;            MultiFab lmask_at_t(<a class="code" href="classERF.html#a268a79187ae9a115e601957f8b06cd42">ba2d</a>[lev],dmap[lev],1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nt(0); nt&lt;ntimes; ++nt) {</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                VisMF::Read(lmask_at_t, MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>,</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                                                              <span class="stringliteral">&quot;LMASK_&quot;</span> + std::to_string(nt)));</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                <span class="keywordflow">for</span> (MFIter mfi(lmask_at_t); mfi.isValid(); ++mfi) {</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                    <span class="keyword">const</span> Box&amp; bx = mfi.growntilebox();</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                    Array4&lt;int&gt;  <span class="keyword">const</span>&amp; dst_arr = <a class="code" href="classERF.html#a3f3e29874221e43e13e2a431e77e0e4e">lmask_lev</a>[lev][nt]-&gt;array(mfi);</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                    Array4&lt;Real&gt; <span class="keyword">const</span>&amp; src_arr = lmask_at_t.array(mfi);</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                    ParallelFor(bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                    {</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                        dst_arr(i,j,k) = int(src_arr(i,j,k));</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                    });</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                }</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;            }</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;            <span class="comment">// Allow idealized cases over water, used to set lmask</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;            ParmParse <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>(<span class="stringliteral">&quot;erf&quot;</span>);</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;            <span class="keywordtype">int</span> is_land;</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;is_land&quot;</span>, is_land, lev)) {</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                <span class="keywordflow">if</span> (is_land == 1) {</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                    amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Level &quot;</span> &lt;&lt; lev &lt;&lt; <span class="stringliteral">&quot; is land&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (is_land == 0) {</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                    amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Level &quot;</span> &lt;&lt; lev &lt;&lt; <span class="stringliteral">&quot; is water&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                    Error(<span class="stringliteral">&quot;is_land should be 0 or 1&quot;</span>);</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                }</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                <a class="code" href="classERF.html#a3f3e29874221e43e13e2a431e77e0e4e">lmask_lev</a>[lev][0]-&gt;setVal(is_land);</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                <span class="comment">// Default to land everywhere if not specified</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                <a class="code" href="classERF.html#a3f3e29874221e43e13e2a431e77e0e4e">lmask_lev</a>[lev][0]-&gt;setVal(1);</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;            }</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;            <a class="code" href="classERF.html#a3f3e29874221e43e13e2a431e77e0e4e">lmask_lev</a>[lev][0]-&gt;FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        }</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160; </div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="preprocessor">#ifdef ERF_USE_NETCDF</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        IntVect ngv = <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>; ngv[2] = 0;</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160; </div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        <span class="comment">// Read lat/lon if it exists</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ae2c963893d0c53465ac84c0bd8998a38">has_lat_lon</a>) {</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;            amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Reading Lat/Lon variables&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;            MultiFab lat(<a class="code" href="classERF.html#a268a79187ae9a115e601957f8b06cd42">ba2d</a>[lev],dmap[lev],1,ngv);</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;            MultiFab lon(<a class="code" href="classERF.html#a268a79187ae9a115e601957f8b06cd42">ba2d</a>[lev],dmap[lev],1,ngv);</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;            VisMF::Read(lat, MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;LAT&quot;</span>));</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;            VisMF::Read(lon, MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;LON&quot;</span>));</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;            lat_m[lev] = std::make_unique&lt;MultiFab&gt;(<a class="code" href="classERF.html#a268a79187ae9a115e601957f8b06cd42">ba2d</a>[lev],dmap[lev],1,ngv);</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;            lon_m[lev] = std::make_unique&lt;MultiFab&gt;(<a class="code" href="classERF.html#a268a79187ae9a115e601957f8b06cd42">ba2d</a>[lev],dmap[lev],1,ngv);</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;            MultiFab::Copy(*lat_m[lev],lat,0,0,1,ngv);</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;            MultiFab::Copy(*lon_m[lev],lon,0,0,1,ngv);</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;        }</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160; </div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        <span class="comment">// Read sinPhi and cosPhi if it exists</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa54aafe316efc6cf474326d690fb2fbf">variable_coriolis</a>) {</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;            amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Reading Coriolis factors&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;            MultiFab sphi(<a class="code" href="classERF.html#a268a79187ae9a115e601957f8b06cd42">ba2d</a>[lev],dmap[lev],1,ngv);</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;            MultiFab cphi(<a class="code" href="classERF.html#a268a79187ae9a115e601957f8b06cd42">ba2d</a>[lev],dmap[lev],1,ngv);</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;            VisMF::Read(sphi, MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;SinPhi&quot;</span>));</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;            VisMF::Read(cphi, MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;CosPhi&quot;</span>));</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;            <a class="code" href="classERF.html#ab54f3fc49bad059469da4e34c82296a6">sinPhi_m</a>[lev] = std::make_unique&lt;MultiFab&gt;(<a class="code" href="classERF.html#a268a79187ae9a115e601957f8b06cd42">ba2d</a>[lev],dmap[lev],1,ngv);</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;            <a class="code" href="classERF.html#ad6a92272a5ad07f176892de07353f268">cosPhi_m</a>[lev] = std::make_unique&lt;MultiFab&gt;(<a class="code" href="classERF.html#a268a79187ae9a115e601957f8b06cd42">ba2d</a>[lev],dmap[lev],1,ngv);</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;            MultiFab::Copy(*<a class="code" href="classERF.html#ab54f3fc49bad059469da4e34c82296a6">sinPhi_m</a>[lev],sphi,0,0,1,ngv);</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;            MultiFab::Copy(*<a class="code" href="classERF.html#ad6a92272a5ad07f176892de07353f268">cosPhi_m</a>[lev],cphi,0,0,1,ngv);</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        }</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160; </div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ad57b63939b19e90b87dd61d3f293b0d7">use_real_bcs</a> &amp;&amp; <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac1ddc9c301ac98689bf3b7b7184b24e1">init_type</a> == InitType::WRFInput) {</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;            MultiFab tmp1d(<a class="code" href="classERF.html#a8c051cb96bfa9ff26929441978aa2a96">ba1d</a>[lev],dmap[lev],1,ngv);</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;            MultiFab tmp2d(<a class="code" href="classERF.html#a268a79187ae9a115e601957f8b06cd42">ba2d</a>[lev],dmap[lev],1,ngv);</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160; </div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;            VisMF::Read(tmp1d, MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;C1H&quot;</span>));</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;            MultiFab::Copy(*<a class="code" href="classERF.html#a8839af37a73c4c2e76bf978a05275ca9">mf_C1H</a>[lev],tmp1d,0,0,1,ngv);</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160; </div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;            VisMF::Read(tmp1d, MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;C2H&quot;</span>));</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;            MultiFab::Copy(*<a class="code" href="classERF.html#ad473e8e616ea3f7bf7bf922a0fe16208">mf_C2H</a>[lev],tmp1d,0,0,1,ngv);</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160; </div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;            VisMF::Read(tmp2d, MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;MUB&quot;</span>));</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;            MultiFab::Copy(*<a class="code" href="classERF.html#aed4ae5792dd32adf56d3c052ce79437f">mf_MUB</a>[lev],tmp2d,0,0,1,ngv);</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        }</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160; </div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    } <span class="comment">// for lev</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160; </div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;<span class="preprocessor">#ifdef ERF_USE_PARTICLES</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    restartTracers((ParGDBBase*)GetParGDB(),<a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>);</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classMicrophysics.html#ac10e6fce2e6cb49373d56ca0e1a5b366">Microphysics::modelType</a>(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a>) == MoistureModelType::Lagrangian) {</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;        <span class="keyword">dynamic_cast&lt;</span>LagrangianMicrophysics&amp;<span class="keyword">&gt;</span>(*micro).restartParticles((ParGDBBase*)GetParGDB(),<a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>);</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    }</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160; </div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;<span class="preprocessor">#if 0</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;<span class="preprocessor">#ifdef ERF_USE_NETCDF</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <span class="comment">// Read bdy_data files</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    <span class="keywordflow">if</span> ( ((<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac1ddc9c301ac98689bf3b7b7184b24e1">init_type</a>==InitType::WRFInput) || (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac1ddc9c301ac98689bf3b7b7184b24e1">init_type</a>==InitType::Metgrid)) &amp;&amp;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;         <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ad57b63939b19e90b87dd61d3f293b0d7">use_real_bcs</a> )</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    {</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;        <span class="keywordtype">int</span> ioproc = ParallelDescriptor::IOProcessorNumber();  <span class="comment">// I/O rank</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        <span class="keywordtype">int</span> num_time;</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        <span class="keywordtype">int</span> num_var;</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;        Vector&lt;Box&gt; bx_v;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;        <span class="keywordflow">if</span> (ParallelDescriptor::IOProcessor()) {</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;            <span class="comment">// Open header file and read from it</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;            std::ifstream bdy_h_file(MultiFabFileFullPrefix(0, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;bdy_H&quot;</span>));</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;            bdy_h_file &gt;&gt; num_time;</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;            bdy_h_file &gt;&gt; num_var;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;            bdy_h_file &gt;&gt; start_bdy_time;</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;            bdy_h_file &gt;&gt; bdy_time_interval;</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;            bdy_h_file &gt;&gt; <a class="code" href="classERF.html#abb15119348ad5399947bc8883084b230">real_width</a>;</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;            bx_v.resize(4*num_var);</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ivar(0); ivar&lt;num_var; ++ivar) {</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                bdy_h_file &gt;&gt; bx_v[4*ivar  ];</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                bdy_h_file &gt;&gt; bx_v[4*ivar+1];</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                bdy_h_file &gt;&gt; bx_v[4*ivar+2];</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                bdy_h_file &gt;&gt; bx_v[4*ivar+3];</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;            }</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160; </div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;            <span class="comment">// IO size the FABs</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;            bdy_data_xlo.resize(num_time);</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;            bdy_data_xhi.resize(num_time);</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;            bdy_data_ylo.resize(num_time);</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;            bdy_data_yhi.resize(num_time);</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> itime(0); itime&lt;num_time; ++itime) {</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                bdy_data_xlo[itime].resize(num_var);</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;                bdy_data_xhi[itime].resize(num_var);</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                bdy_data_ylo[itime].resize(num_var);</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                bdy_data_yhi[itime].resize(num_var);</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ivar(0); ivar&lt;num_var; ++ivar) {</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;                    bdy_data_xlo[itime][ivar].resize(bx_v[4*ivar  ]);</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                    bdy_data_xhi[itime][ivar].resize(bx_v[4*ivar+1]);</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;                    bdy_data_ylo[itime][ivar].resize(bx_v[4*ivar+2]);</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;                    bdy_data_yhi[itime][ivar].resize(bx_v[4*ivar+3]);</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;                }</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;            }</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160; </div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;            <span class="comment">// Open data file and read from it</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;            std::ifstream bdy_d_file(MultiFabFileFullPrefix(0, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;bdy_D&quot;</span>));</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> itime(0); itime&lt;num_time; ++itime) {</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ivar(0); ivar&lt;num_var; ++ivar) {</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;                    bdy_data_xlo[itime][ivar].readFrom(bdy_d_file);</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                    bdy_data_xhi[itime][ivar].readFrom(bdy_d_file);</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;                    bdy_data_ylo[itime][ivar].readFrom(bdy_d_file);</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                    bdy_data_yhi[itime][ivar].readFrom(bdy_d_file);</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                }</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;            }</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;        } <span class="comment">// IO</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160; </div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;        <span class="comment">// Broadcast the data</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;        ParallelDescriptor::Barrier();</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        ParallelDescriptor::Bcast(&amp;start_bdy_time,1,ioproc);</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;        ParallelDescriptor::Bcast(&amp;bdy_time_interval,1,ioproc);</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;        ParallelDescriptor::Bcast(&amp;<a class="code" href="classERF.html#abb15119348ad5399947bc8883084b230">real_width</a>,1,ioproc);</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        ParallelDescriptor::Bcast(&amp;num_time,1,ioproc);</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        ParallelDescriptor::Bcast(&amp;num_var,1,ioproc);</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160; </div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;        <span class="comment">// Everyone size their boxes</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;        bx_v.resize(4*num_var);</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160; </div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;        ParallelDescriptor::Bcast(bx_v.dataPtr(),bx_v.size(),ioproc);</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160; </div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;        <span class="comment">// Everyone but IO size their FABs</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;        <span class="keywordflow">if</span> (!ParallelDescriptor::IOProcessor()) {</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;          bdy_data_xlo.resize(num_time);</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;          bdy_data_xhi.resize(num_time);</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;          bdy_data_ylo.resize(num_time);</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;          bdy_data_yhi.resize(num_time);</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> itime(0); itime&lt;num_time; ++itime) {</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;            bdy_data_xlo[itime].resize(num_var);</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;            bdy_data_xhi[itime].resize(num_var);</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;            bdy_data_ylo[itime].resize(num_var);</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;            bdy_data_yhi[itime].resize(num_var);</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ivar(0); ivar&lt;num_var; ++ivar) {</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;              bdy_data_xlo[itime][ivar].resize(bx_v[4*ivar  ]);</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;              bdy_data_xhi[itime][ivar].resize(bx_v[4*ivar+1]);</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;              bdy_data_ylo[itime][ivar].resize(bx_v[4*ivar+2]);</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;              bdy_data_yhi[itime][ivar].resize(bx_v[4*ivar+3]);</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;            }</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;          }</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;        }</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160; </div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> itime(0); itime&lt;num_time; ++itime) {</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ivar(0); ivar&lt;num_var; ++ivar) {</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                ParallelDescriptor::Bcast(bdy_data_xlo[itime][ivar].dataPtr(),bdy_data_xlo[itime][ivar].box().numPts(),ioproc);</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                ParallelDescriptor::Bcast(bdy_data_xhi[itime][ivar].dataPtr(),bdy_data_xhi[itime][ivar].box().numPts(),ioproc);</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                ParallelDescriptor::Bcast(bdy_data_ylo[itime][ivar].dataPtr(),bdy_data_ylo[itime][ivar].box().numPts(),ioproc);</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;                ParallelDescriptor::Bcast(bdy_data_yhi[itime][ivar].dataPtr(),bdy_data_yhi[itime][ivar].box().numPts(),ioproc);</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;            }</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;        }</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    } <span class="comment">// init_type == WRFInput or Metgrid</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_aaee255b031e63bd9b5807f6612739dbd"><div class="ttname"><a href="classERF.html#aaee255b031e63bd9b5807f6612739dbd">ERF::GotoNextLine</a></div><div class="ttdeci">static void GotoNextLine(std::istream &amp;is)</div><div class="ttdef"><b>Definition:</b> ERF_Checkpoint.cpp:16</div></div>
<div class="ttc" id="aclassERF_html_aaf10bbf8c9a5dbc257a88c4c1b650fee"><div class="ttname"><a href="classERF.html#aaf10bbf8c9a5dbc257a88c4c1b650fee">ERF::MakeNewLevelFromScratch</a></div><div class="ttdeci">void MakeNewLevelFromScratch(int lev, amrex::Real time, const amrex::BoxArray &amp;ba, const amrex::DistributionMapping &amp;dm) override</div><div class="ttdef"><b>Definition:</b> ERF_MakeNewLevel.cpp:25</div></div>
<div class="ttc" id="astructSolverChoice_html_aa54aafe316efc6cf474326d690fb2fbf"><div class="ttname"><a href="structSolverChoice.html#aa54aafe316efc6cf474326d690fb2fbf">SolverChoice::variable_coriolis</a></div><div class="ttdeci">bool variable_coriolis</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:817</div></div>
<div class="ttc" id="astructSolverChoice_html_ae2c963893d0c53465ac84c0bd8998a38"><div class="ttname"><a href="structSolverChoice.html#ae2c963893d0c53465ac84c0bd8998a38">SolverChoice::has_lat_lon</a></div><div class="ttdeci">bool has_lat_lon</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:816</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_af285247b24b173cd851fe49799d17f42_cgraph.png" border="0" usemap="#aclassERF_af285247b24b173cd851fe49799d17f42_cgraph" alt=""/></div>
<map name="aclassERF_af285247b24b173cd851fe49799d17f42_cgraph" id="aclassERF_af285247b24b173cd851fe49799d17f42_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,188,83"/>
<area shape="rect" href="ERF__EOS_8H.html#a3cc0ee7727b26e21a97acfc2ad2e6d4d" title=" " alt="" coords="255,5,404,32"/>
<area shape="rect" href="classMicrophysics.html#ac10e6fce2e6cb49373d56ca0e1a5b366" title="query if a specified moisture model is Eulerian or Lagrangian" alt="" coords="236,56,423,83"/>
<area shape="rect" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469" title=" " alt="" coords="310,107,349,133"/>
</map>
</div>

</div>
</div>
<a id="afdd04d6a1c2103e654f0cb6eda62436d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afdd04d6a1c2103e654f0cb6eda62436d">&#9670;&nbsp;</a></span>ReadCheckpointFileSurfaceLayer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::ReadCheckpointFileSurfaceLayer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="classERF.html">ERF</a> function for reading additional data for MOST from a checkpoint file during restart.</p>
<p>This is called after the ABLMost object is instantiated. </p>
<div class="fragment"><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;{</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev)</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    {</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Reading MOST variables&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160; </div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;        IntVect <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a> = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nGrowVect(); <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>[2]=0;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;        MultiFab  m_var(<a class="code" href="classERF.html#a268a79187ae9a115e601957f8b06cd42">ba2d</a>[lev],dmap[lev],1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;        MultiFab* dst = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160; </div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;        <span class="comment">// U*</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;        std::string UstarFileName(<a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a> + <span class="stringliteral">&quot;/Level_0/Ustar_H&quot;</span>);</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;        <span class="keywordflow">if</span> (amrex::FileExists(UstarFileName)) {</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;            dst = <a class="code" href="classERF.html#ac50bb696daf587e13f9a1e57c687375e">m_SurfaceLayer</a>-&gt;get_u_star(lev);</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;            VisMF::Read(m_var, MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;Ustar&quot;</span>));</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;            MultiFab::Copy(*dst,m_var,0,0,1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        }</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160; </div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;        <span class="comment">// W*</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;        std::string WstarFileName(<a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a> + <span class="stringliteral">&quot;/Level_0/Wstar_H&quot;</span>);</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;        <span class="keywordflow">if</span> (amrex::FileExists(WstarFileName)) {</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;            dst = <a class="code" href="classERF.html#ac50bb696daf587e13f9a1e57c687375e">m_SurfaceLayer</a>-&gt;get_w_star(lev);</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;            VisMF::Read(m_var, MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;Wstar&quot;</span>));</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;            MultiFab::Copy(*dst,m_var,0,0,1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        }</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160; </div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        <span class="comment">// T*</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;        std::string TstarFileName(<a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a> + <span class="stringliteral">&quot;/Level_0/Tstar_H&quot;</span>);</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;        <span class="keywordflow">if</span> (amrex::FileExists(TstarFileName)) {</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;            dst = <a class="code" href="classERF.html#ac50bb696daf587e13f9a1e57c687375e">m_SurfaceLayer</a>-&gt;get_t_star(lev);</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;            VisMF::Read(m_var, MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;Tstar&quot;</span>));</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;            MultiFab::Copy(*dst,m_var,0,0,1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        }</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160; </div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        <span class="comment">// Q*</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;        std::string QstarFileName(<a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a> + <span class="stringliteral">&quot;/Level_0/Qstar_H&quot;</span>);</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;        <span class="keywordflow">if</span> (amrex::FileExists(QstarFileName)) {</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;            dst = <a class="code" href="classERF.html#ac50bb696daf587e13f9a1e57c687375e">m_SurfaceLayer</a>-&gt;get_q_star(lev);</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;            VisMF::Read(m_var, MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;Qstar&quot;</span>));</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;            MultiFab::Copy(*dst,m_var,0,0,1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;        }</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160; </div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;        <span class="comment">// Olen</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;        std::string OlenFileName(<a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a> + <span class="stringliteral">&quot;/Level_0/Olen_H&quot;</span>);</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;        <span class="keywordflow">if</span> (amrex::FileExists(OlenFileName)) {</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;            dst = <a class="code" href="classERF.html#ac50bb696daf587e13f9a1e57c687375e">m_SurfaceLayer</a>-&gt;get_olen(lev);</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;            VisMF::Read(m_var, MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;Olen&quot;</span>));</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;            MultiFab::Copy(*dst,m_var,0,0,1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        }</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160; </div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;        <span class="comment">// PBLH</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;        std::string PBLHFileName(<a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a> + <span class="stringliteral">&quot;/Level_0/PBLH_H&quot;</span>);</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;        <span class="keywordflow">if</span> (amrex::FileExists(PBLHFileName)) {</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;            dst = <a class="code" href="classERF.html#ac50bb696daf587e13f9a1e57c687375e">m_SurfaceLayer</a>-&gt;get_pblh(lev);</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;            VisMF::Read(m_var, MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;PBLH&quot;</span>));</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;            MultiFab::Copy(*dst,m_var,0,0,1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;        }</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160; </div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        <span class="comment">// Z0</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;        std::string Z0FileName(<a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a> + <span class="stringliteral">&quot;/Level_0/Z0_H&quot;</span>);</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;        <span class="keywordflow">if</span> (amrex::FileExists(Z0FileName)) {</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;            VisMF::Read(m_var, MultiFabFileFullPrefix(lev, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;Z0&quot;</span>));</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;            <span class="keywordflow">for</span> (amrex::MFIter mfi(m_var); mfi.isValid(); ++mfi) {</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.growntilebox();</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;                FArrayBox* most_z0 = (<a class="code" href="classERF.html#ac50bb696daf587e13f9a1e57c687375e">m_SurfaceLayer</a>-&gt;get_z0(lev));</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;                most_z0-&gt;copy&lt;RunOn::Device&gt;(m_var[mfi], bx);</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;            }</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;        }</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    }</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2d39cd3bdc3d90609ad3b14e266d190a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d39cd3bdc3d90609ad3b14e266d190a">&#9670;&nbsp;</a></span>ReadParameters()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::ReadParameters </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;{</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;    {</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;        ParmParse <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>;  <span class="comment">// Traditionally, max_step and stop_time do not have prefix.</span></div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;max_step&quot;</span>, <a class="code" href="classERF.html#a0634154e8e58379c495c3e7fe7c5e4d6">max_step</a>);</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160; </div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;        std::string start_datetime, stop_datetime;</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;start_datetime&quot;</span>, start_datetime)) {</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;            <a class="code" href="classERF.html#aa0c07f31b23d977646b8161e5473fab5">start_time</a> = <a class="code" href="ERF__EpochTime_8H.html#a370a1cca0113b3529a59c031ff71ffb8">getEpochTime</a>(start_datetime, <a class="code" href="classERF.html#a85bb96a0b6593ee192a04ceef62abdf6">datetime_format</a>);</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#aa0c07f31b23d977646b8161e5473fab5">start_time</a> == -1.0) {</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;               amrex::Abort(<span class="stringliteral">&quot;Invalid start_datetime string!&quot;</span>);</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;            }</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;stop_datetime&quot;</span>, stop_datetime)) {</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;                <a class="code" href="classERF.html#a405556a52bef334ab68294c1a540e107">stop_time</a> = <a class="code" href="ERF__EpochTime_8H.html#a370a1cca0113b3529a59c031ff71ffb8">getEpochTime</a>(stop_datetime, <a class="code" href="classERF.html#a85bb96a0b6593ee192a04ceef62abdf6">datetime_format</a>);</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a405556a52bef334ab68294c1a540e107">stop_time</a> == -1.0) {</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;                    amrex::Abort(<span class="stringliteral">&quot;Invalid stop_datetime string!&quot;</span>);</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;                }</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;            }</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;            <a class="code" href="classERF.html#a90e3592862d7330b39a11399d34a3539">use_datetime</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;            <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;stop_time&quot;</span>, <a class="code" href="classERF.html#a405556a52bef334ab68294c1a540e107">stop_time</a>);</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;            <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;start_time&quot;</span>, <a class="code" href="classERF.html#aa0c07f31b23d977646b8161e5473fab5">start_time</a>); <span class="comment">// This is optional, it defaults to 0</span></div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;        }</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;    }</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160; </div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;    ParmParse <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>(<a class="code" href="classERF.html#a59df30e7a5537c8543bb00772bd98b58">pp_prefix</a>);</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;    ParmParse pp_amr(<span class="stringliteral">&quot;amr&quot;</span>);</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;    {</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;regrid_level_0_on_restart&quot;</span>, <a class="code" href="classERF.html#a833c301baf4bb3ee3c944faad7bf6ee7">regrid_level_0_on_restart</a>);</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;regrid_int&quot;</span>, <a class="code" href="classERF.html#a3937527f96c81674fa38dc34ed24f3f5">regrid_int</a>);</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;check_file&quot;</span>, <a class="code" href="classERF.html#ae701564fbe3da5bbd88587e5a08eca4e">check_file</a>);</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160; </div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;        <span class="comment">// The regression tests use &quot;amr.restart&quot; and &quot;amr.m_check_int&quot; so we allow</span></div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;        <span class="comment">//    for those or &quot;erf.restart&quot; / &quot;erf.m_check_int&quot; with the former taking</span></div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;        <span class="comment">//    precedence if both are specified</span></div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;check_int&quot;</span>, <a class="code" href="classERF.html#a69a3f925e95ec4244b0257f9de16d65a">m_check_int</a>);</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;check_per&quot;</span>, <a class="code" href="classERF.html#a5fbf17cfc8d9e5b994783e05ec3594b2">m_check_per</a>);</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;        pp_amr.query(<span class="stringliteral">&quot;check_int&quot;</span>, <a class="code" href="classERF.html#a69a3f925e95ec4244b0257f9de16d65a">m_check_int</a>);</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;        pp_amr.query(<span class="stringliteral">&quot;check_per&quot;</span>, <a class="code" href="classERF.html#a5fbf17cfc8d9e5b994783e05ec3594b2">m_check_per</a>);</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160; </div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;restart&quot;</span>, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>);</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;        pp_amr.query(<span class="stringliteral">&quot;restart&quot;</span>, <a class="code" href="classERF.html#a8e758060d3dede9694fbfcabddc17169">restart_chkfile</a>);</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160; </div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;        <span class="comment">// Verbosity</span></div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;v&quot;</span>, <a class="code" href="classERF.html#a43d0b17f6e155691a1e9474526df3af5">verbose</a>);</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;mg_v&quot;</span>, <a class="code" href="classERF.html#a2c4e27d6b7928c7081f17e63d0834200">mg_verbose</a>);</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;use_fft&quot;</span>, <a class="code" href="classERF.html#a35e6065478296fac62affbf8f53b8c23">use_fft</a>);</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;<span class="preprocessor">#ifndef ERF_USE_FFT</span></div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a35e6065478296fac62affbf8f53b8c23">use_fft</a>) {</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;            amrex::Abort(<span class="stringliteral">&quot;You must build with USE_FFT in order to set use_fft = true in your inputs file&quot;</span>);</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;        }</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160; </div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;        <span class="comment">// Frequency of diagnostic output</span></div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;sum_interval&quot;</span>, <a class="code" href="classERF.html#a5232e98479611a24fe97994640c61faa">sum_interval</a>);</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;sum_period&quot;</span>  , <a class="code" href="classERF.html#a1cf2ba396f4404724824516da4c4a084">sum_per</a>);</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160; </div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;pert_interval&quot;</span>, <a class="code" href="classERF.html#a52761522e295887435c10853d8c7dc37">pert_interval</a>);</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160; </div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;        <span class="comment">// Time step controls</span></div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;cfl&quot;</span>, <a class="code" href="classERF.html#a89f605d1a1eae06a7c79f9b6b65c637f">cfl</a>);</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;substepping_cfl&quot;</span>, <a class="code" href="classERF.html#addc2ee5eba2264ae2b2475970b0b8c2d">sub_cfl</a>);</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;init_shrink&quot;</span>, <a class="code" href="classERF.html#ad353aa9e275612ff2110c5a1405c1176">init_shrink</a>);</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;change_max&quot;</span>, <a class="code" href="classERF.html#ae16d413b172bb3b3400af6d5cb236fd4">change_max</a>);</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;dt_max_initial&quot;</span>, <a class="code" href="classERF.html#ad4b3bb9d744fb5dde65a21951b86e132">dt_max_initial</a>);</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;dt_max&quot;</span>, <a class="code" href="classERF.html#a3ec36cbd96abc7ac706fee7007ae9aeb">dt_max</a>);</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160; </div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;        <a class="code" href="classERF.html#a393b540493795b8c6ee0f64634b8b815">fixed_dt</a>.resize(max_level+1,-1.);</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;        <a class="code" href="classERF.html#a4f3f43c6304a0a3ae78c42d54c05ee26">fixed_fast_dt</a>.resize(max_level+1,-1.);</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160; </div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;fixed_dt&quot;</span>, <a class="code" href="classERF.html#a393b540493795b8c6ee0f64634b8b815">fixed_dt</a>[0]);</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;fixed_fast_dt&quot;</span>, <a class="code" href="classERF.html#a4f3f43c6304a0a3ae78c42d54c05ee26">fixed_fast_dt</a>[0]);</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160; </div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 1; lev &lt;= max_level; lev++)</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;        {</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;            <a class="code" href="classERF.html#a393b540493795b8c6ee0f64634b8b815">fixed_dt</a>[lev]      = <a class="code" href="classERF.html#a393b540493795b8c6ee0f64634b8b815">fixed_dt</a>[lev-1]      / <span class="keyword">static_cast&lt;</span>Real<span class="keyword">&gt;</span>(MaxRefRatio(lev-1));</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;            <a class="code" href="classERF.html#a4f3f43c6304a0a3ae78c42d54c05ee26">fixed_fast_dt</a>[lev] = <a class="code" href="classERF.html#a4f3f43c6304a0a3ae78c42d54c05ee26">fixed_fast_dt</a>[lev-1] / <span class="keyword">static_cast&lt;</span>Real<span class="keyword">&gt;</span>(MaxRefRatio(lev-1));</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;        }</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160; </div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;fixed_mri_dt_ratio&quot;</span>, <a class="code" href="classERF.html#ad2e1a979c0ad68e87eaee349beb7e9fd">fixed_mri_dt_ratio</a>);</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160; </div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;        <span class="comment">// We use this to keep track of how many boxes we read in from WRF initialization</span></div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;        <a class="code" href="classERF.html#a610a988f46e0496e6dbd0471ae817f75">num_files_at_level</a>.resize(max_level+1,0);</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160; </div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;        <span class="comment">// We use this to keep track of how many boxes are specified thru the refinement indicators</span></div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;        <a class="code" href="classERF.html#adcd9f23975ffa605247b41d391c2a2f0">num_boxes_at_level</a>.resize(max_level+1,0);</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;            <a class="code" href="classERF.html#a050dbd236c9bf246554a53008e09f683">boxes_at_level</a>.resize(max_level+1);</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160; </div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;        <span class="comment">// We always have exactly one file at level 0</span></div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;        <a class="code" href="classERF.html#adcd9f23975ffa605247b41d391c2a2f0">num_boxes_at_level</a>[0] = 1;</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;        <a class="code" href="classERF.html#a050dbd236c9bf246554a53008e09f683">boxes_at_level</a>[0].resize(1);</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;        <a class="code" href="classERF.html#a050dbd236c9bf246554a53008e09f683">boxes_at_level</a>[0][0] = geom[0].Domain();</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160; </div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;<span class="preprocessor">#ifdef ERF_USE_NETCDF</span></div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;        <a class="code" href="classERF.html#a7ef14f6028b577eba70aef46b508be19">nc_init_file</a>.resize(max_level+1);</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160; </div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;        <span class="comment">// NetCDF wrfinput initialization files -- possibly multiple files at each of multiple levels</span></div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;        <span class="comment">//        but we always have exactly one file at level 0</span></div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= max_level; lev++) {</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;            <span class="keyword">const</span> std::string nc_file_names = Concatenate(<span class="stringliteral">&quot;nc_init_file_&quot;</span>,lev,1);</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.contains(nc_file_names.c_str())) {</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;                <span class="keywordtype">int</span> num_files = <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.countval(nc_file_names.c_str());</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;                <a class="code" href="classERF.html#a610a988f46e0496e6dbd0471ae817f75">num_files_at_level</a>[lev] = num_files;</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;                <a class="code" href="classERF.html#a7ef14f6028b577eba70aef46b508be19">nc_init_file</a>[lev].resize(num_files);</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;                <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.queryarr(nc_file_names.c_str(), <a class="code" href="classERF.html#a7ef14f6028b577eba70aef46b508be19">nc_init_file</a>[lev],0,num_files);</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; num_files; j++) {</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;                    Print() &lt;&lt; <span class="stringliteral">&quot;Reading NC init file names at level &quot;</span> &lt;&lt; lev &lt;&lt; <span class="stringliteral">&quot; and index &quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot; : &quot;</span> &lt;&lt; <a class="code" href="classERF.html#a7ef14f6028b577eba70aef46b508be19">nc_init_file</a>[lev][j] &lt;&lt; std::endl;</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;                } <span class="comment">// j</span></div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;            } <span class="comment">// if pp.contains</span></div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;        } <span class="comment">// lev</span></div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160; </div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;        <span class="comment">// NetCDF wrfbdy lateral boundary file</span></div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;nc_bdy_file&quot;</span>, <a class="code" href="classERF.html#a7e9040f32464f1a6dee6e0384393451d">nc_bdy_file</a>)) {</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;            Print() &lt;&lt; <span class="stringliteral">&quot;Reading NC bdy file name &quot;</span> &lt;&lt; <a class="code" href="classERF.html#a7e9040f32464f1a6dee6e0384393451d">nc_bdy_file</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;        }</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160; </div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;        <span class="comment">// NetCDF wrflow lateral boundary file</span></div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;nc_low_file&quot;</span>, <a class="code" href="classERF.html#ad4c8a68d25ec78f9944bf3123fafd93e">nc_low_file</a>)) {</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;            Print() &lt;&lt; <span class="stringliteral">&quot;Reading NC low file name &quot;</span> &lt;&lt; <a class="code" href="classERF.html#ad4c8a68d25ec78f9944bf3123fafd93e">nc_low_file</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;        }</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160; </div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160; </div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;        <span class="comment">// Flag to trigger initialization from input_sounding like WRF&#39;s ideal.exe</span></div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;init_sounding_ideal&quot;</span>, <a class="code" href="classERF.html#a2eb81c590271b429f132103c9af25830">init_sounding_ideal</a>);</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160; </div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;        <span class="comment">// Options for vertical interpolation of met_em*.nc data.</span></div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;metgrid_debug_quiescent&quot;</span>,  <a class="code" href="classERF.html#a64c81ad5cd1b7d21c2e597b92596f113">metgrid_debug_quiescent</a>);</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;metgrid_debug_isothermal&quot;</span>, <a class="code" href="classERF.html#ab08081c75e6d926825071630f2adddab">metgrid_debug_isothermal</a>);</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;metgrid_debug_dry&quot;</span>,        <a class="code" href="classERF.html#aaaa067c46e79ca3635d138750642b78d">metgrid_debug_dry</a>);</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;metgrid_debug_psfc&quot;</span>,       <a class="code" href="classERF.html#ad256f0610d54caef208e2b2569a5aa82">metgrid_debug_psfc</a>);</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;metgrid_debug_msf&quot;</span>,        <a class="code" href="classERF.html#a079811bdd498e155326a851e0c12f850">metgrid_debug_msf</a>);</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;metgrid_interp_theta&quot;</span>,     <a class="code" href="classERF.html#a7eac012575590fe374a8d4b5d9061546">metgrid_interp_theta</a>);</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;metgrid_basic_linear&quot;</span>,     <a class="code" href="classERF.html#a04831a5a6bf49d8386d362379db84358">metgrid_basic_linear</a>);</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;metgrid_use_below_sfc&quot;</span>,    <a class="code" href="classERF.html#a8eb60483e48302db4706d3b90c0ae8e4">metgrid_use_below_sfc</a>);</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;metgrid_use_sfc&quot;</span>,          <a class="code" href="classERF.html#a5d2fe657db8c3614db3e797566a49d68">metgrid_use_sfc</a>);</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;metgrid_retain_sfc&quot;</span>,       <a class="code" href="classERF.html#a51e327479a5c37c694bbf14eb8bce94f">metgrid_retain_sfc</a>);</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;metgrid_proximity&quot;</span>,        <a class="code" href="classERF.html#a95182a17e10556dde659d4dd891a4ed3">metgrid_proximity</a>);</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;metgrid_order&quot;</span>,            <a class="code" href="classERF.html#af27fd93c086c23ab8c754e63e1a0c425">metgrid_order</a>);</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;metgrid_force_sfc_k&quot;</span>,      <a class="code" href="classERF.html#a8767bdb5ac5b0a796dc478dc417e1606">metgrid_force_sfc_k</a>);</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160; </div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;        <span class="comment">// Set default to FullState for now ... later we will try Perturbation</span></div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;        <a class="code" href="classERF.html#a812912653fe0d8ab1342bfef4793dd0e">interpolation_type</a> = StateInterpType::FullState;</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query_enum_case_insensitive(<span class="stringliteral">&quot;interpolation_type&quot;</span>  ,<a class="code" href="classERF.html#a812912653fe0d8ab1342bfef4793dd0e">interpolation_type</a>);</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160; </div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;        PlotFileType plotfile_type_temp = PlotFileType::None;</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query_enum_case_insensitive(<span class="stringliteral">&quot;plotfile_type&quot;</span>  ,plotfile_type_temp);</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query_enum_case_insensitive(<span class="stringliteral">&quot;plotfile_type_1&quot;</span>,<a class="code" href="classERF.html#a184511b7b9b7d4beef453f5d5d679c54">plotfile_type_1</a>);</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query_enum_case_insensitive(<span class="stringliteral">&quot;plotfile_type_2&quot;</span>,<a class="code" href="classERF.html#a980e94505df2ee0925612b004126df77">plotfile_type_2</a>);</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;        <span class="comment">// This option is for backward consistency -- if only plotfile_type is set,</span></div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;        <span class="comment">//     then it will be used for both 1 and 2 if and only if they are not set</span></div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;        <span class="comment">// Default is native amrex if no type is specified</span></div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;        <span class="keywordflow">if</span> (plotfile_type_temp == PlotFileType::None) {</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a184511b7b9b7d4beef453f5d5d679c54">plotfile_type_1</a> == PlotFileType::None) {</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;                <a class="code" href="classERF.html#a184511b7b9b7d4beef453f5d5d679c54">plotfile_type_1</a>  = PlotFileType::Amrex;</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;            }</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a980e94505df2ee0925612b004126df77">plotfile_type_2</a> == PlotFileType::None) {</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;                <a class="code" href="classERF.html#a980e94505df2ee0925612b004126df77">plotfile_type_2</a>  = PlotFileType::Amrex;</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;            }</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a184511b7b9b7d4beef453f5d5d679c54">plotfile_type_1</a> == PlotFileType::None) {</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;                <a class="code" href="classERF.html#a184511b7b9b7d4beef453f5d5d679c54">plotfile_type_1</a>  = plotfile_type_temp;</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;                amrex::Abort(<span class="stringliteral">&quot;You must set either plotfile_type or plotfile_type_1, not both&quot;</span>);</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;            }</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a980e94505df2ee0925612b004126df77">plotfile_type_2</a> == PlotFileType::None) {</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;                <a class="code" href="classERF.html#a980e94505df2ee0925612b004126df77">plotfile_type_2</a>  = plotfile_type_temp;</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;                amrex::Abort(<span class="stringliteral">&quot;You must set either plotfile_type or plotfile_type_2, not both&quot;</span>);</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;            }</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;        }</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;<span class="preprocessor">#ifndef ERF_USE_NETCDF</span></div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a184511b7b9b7d4beef453f5d5d679c54">plotfile_type_1</a> == PlotFileType::Netcdf ||</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;            <a class="code" href="classERF.html#a980e94505df2ee0925612b004126df77">plotfile_type_2</a> == PlotFileType::Netcdf) {</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;            amrex::Abort(<span class="stringliteral">&quot;Plotfile type = Netcdf is not allowed without USE_NETCDF = TRUE&quot;</span>);</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;        }</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160; </div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;plot_file_1&quot;</span>,   <a class="code" href="classERF.html#aa54aaa938a18d34caa4d86e977647899">plot_file_1</a>);</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;plot_file_2&quot;</span>,   <a class="code" href="classERF.html#a18fa84b06132715757d97ec38678aa2c">plot_file_2</a>);</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;plot_int_1&quot;</span> , <a class="code" href="classERF.html#a57cfb4bfead8525174646964992c7e69">m_plot_int_1</a>);</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;plot_int_2&quot;</span> , <a class="code" href="classERF.html#ad3311c9ceacd17f34bdb5e03cefa33b3">m_plot_int_2</a>);</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;plot_per_1&quot;</span>,  <a class="code" href="classERF.html#a3167adc9518cce649a90ab82e9f9c85d">m_plot_per_1</a>);</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;plot_per_2&quot;</span>,  <a class="code" href="classERF.html#aff879a9c686293a10a3a03027b765c51">m_plot_per_2</a>);</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160; </div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;subvol_file&quot;</span>,   <a class="code" href="classERF.html#a9183a64262ae944d9b3968c57de9652f">subvol_file</a>);</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;subvol_int&quot;</span> , <a class="code" href="classERF.html#a2420086cf8dc54d9507c40358930f521">m_subvol_int</a>);</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;subvol_per&quot;</span> , <a class="code" href="classERF.html#a595273f0f44d0e481a2da65263e5c2ae">m_subvol_per</a>);</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160; </div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;expand_plotvars_to_unif_rr&quot;</span>,<a class="code" href="classERF.html#adb272adf862040a2f1a6226c57c35627">m_expand_plotvars_to_unif_rr</a>);</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160; </div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;plot_face_vels&quot;</span>,<a class="code" href="classERF.html#a367a3daba5d844efbed84c52e647cea6">m_plot_face_vels</a>);</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160; </div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;        <span class="keywordflow">if</span> ( (<a class="code" href="classERF.html#a57cfb4bfead8525174646964992c7e69">m_plot_int_1</a> &gt; 0 &amp;&amp; <a class="code" href="classERF.html#a3167adc9518cce649a90ab82e9f9c85d">m_plot_per_1</a> &gt; 0) ||</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;             (<a class="code" href="classERF.html#ad3311c9ceacd17f34bdb5e03cefa33b3">m_plot_int_2</a> &gt; 0 &amp;&amp; <a class="code" href="classERF.html#aff879a9c686293a10a3a03027b765c51">m_plot_per_2</a> &gt; 0.) ) {</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;            Abort(<span class="stringliteral">&quot;Must choose only one of plot_int or plot_per&quot;</span>);</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;        }</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160; </div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;profile_int&quot;</span>, <a class="code" href="classERF.html#a633cd0b44d2e38f02c23e953aecd69eb">profile_int</a>);</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;destag_profiles&quot;</span>, <a class="code" href="classERF.html#a65f19c55c8d3669445866a1c3bbb628d">destag_profiles</a>);</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160; </div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;plot_lsm&quot;</span>, <a class="code" href="classERF.html#afc653b103aa26c56acafed85cdd95f52">plot_lsm</a>);</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;<span class="preprocessor">#ifdef ERF_USE_RRTMGP</span></div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;plot_rad&quot;</span>, <a class="code" href="classERF.html#a34f2eb136e6747a7e6461fb95e50076e">plot_rad</a>);</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;profile_rad_int&quot;</span>, <a class="code" href="classERF.html#a9194db6f65f3cfa366010648eaa4affd">rad_datalog_int</a>);</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160; </div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;output_1d_column&quot;</span>, <a class="code" href="classERF.html#ad17ff2753e754ff3eb1330612b820b5f">output_1d_column</a>);</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;column_per&quot;</span>, <a class="code" href="classERF.html#a7b0175190c6fcf829c7f2841f729b12a">column_per</a>);</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;column_interval&quot;</span>, <a class="code" href="classERF.html#afa0bef6d3146788302b81c0d4f4802d1">column_interval</a>);</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;column_loc_x&quot;</span>, <a class="code" href="classERF.html#a930b7d48218b3fc41d8719b50b3f6086">column_loc_x</a>);</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;column_loc_y&quot;</span>, <a class="code" href="classERF.html#a2b911f3a5a324813b1ff4462df6044a6">column_loc_y</a>);</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;column_file_name&quot;</span>, <a class="code" href="classERF.html#a48bba6b1c1b39940b09aefbe56311e2f">column_file_name</a>);</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160; </div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;        <span class="comment">// Sampler output frequency</span></div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;sampler_per&quot;</span>, <a class="code" href="classERF.html#a8bfff875038f8c24055067117e192960">sampler_per</a>);</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;sampler_interval&quot;</span>, <a class="code" href="classERF.html#ad13532a7eebe8a7473dfe5ed9a828fe8">sampler_interval</a>);</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160; </div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;        <span class="comment">// Specify information about outputting planes of data</span></div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;output_bndry_planes&quot;</span>, <a class="code" href="classERF.html#a7c448670f7a5cadd6fe56f7e615c9eb6">output_bndry_planes</a>);</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;bndry_output_planes_interval&quot;</span>, <a class="code" href="classERF.html#aab4575d8fb57595a2f1aaf088c60447a">bndry_output_planes_interval</a>);</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;bndry_output_planes_per&quot;</span>, <a class="code" href="classERF.html#a5f99e949c83d86507e003ae556cf7c22">bndry_output_planes_per</a>);</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;bndry_output_start_time&quot;</span>, <a class="code" href="classERF.html#a87e58f16f44a6cb35d6983ed3fe7d3c1">bndry_output_planes_start_time</a>);</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160; </div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;        <span class="comment">// Specify whether ingest boundary planes of data</span></div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;input_bndry_planes&quot;</span>, <a class="code" href="classERF.html#a80ad08512968ec45635df68abe66b1fc">input_bndry_planes</a>);</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160; </div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;        <span class="comment">// Query the set and total widths for wrfbdy interior ghost cells</span></div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;real_width&quot;</span>, <a class="code" href="classERF.html#abb15119348ad5399947bc8883084b230">real_width</a>);</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;real_set_width&quot;</span>, <a class="code" href="classERF.html#acab120bb9324e7298534d765c447d703">real_set_width</a>);</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160; </div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;        <span class="comment">// Query the set and total widths for crse-fine interior ghost cells</span></div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;cf_width&quot;</span>, <a class="code" href="classERF.html#ad9084179f7384e10a519989ffd51fd34">cf_width</a>);</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;cf_set_width&quot;</span>, <a class="code" href="classERF.html#a1e3e2855b6e811596226c167573ad62d">cf_set_width</a>);</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160; </div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;        <span class="comment">// AmrMesh iterate on grids?</span></div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;        <span class="keywordtype">bool</span> iterate(<span class="keyword">true</span>);</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;        pp_amr.query(<span class="stringliteral">&quot;iterate_grids&quot;</span>,iterate);</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;        <span class="keywordflow">if</span> (!iterate) SetIterateToFalse();</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;    }</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160; </div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;<span class="preprocessor">#ifdef ERF_USE_PARTICLES</span></div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;    readTracersParams();</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160; </div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;    <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a76659aa69edd3370626e3648cbead9be">init_params</a>(max_level,<a class="code" href="classERF.html#a59df30e7a5537c8543bb00772bd98b58">pp_prefix</a>);</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160; </div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;<span class="preprocessor">#ifndef ERF_USE_NETCDF</span></div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;    AMREX_ALWAYS_ASSERT_WITH_MESSAGE(( (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac1ddc9c301ac98689bf3b7b7184b24e1">init_type</a> != InitType::WRFInput) &amp;&amp;</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;                                       (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac1ddc9c301ac98689bf3b7b7184b24e1">init_type</a> != InitType::Metgrid ) &amp;&amp;</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;                                       (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac1ddc9c301ac98689bf3b7b7184b24e1">init_type</a> != InitType::NCFile  )  ),</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;                                     <span class="stringliteral">&quot;init_type cannot be &#39;WRFInput&#39;, &#39;MetGrid&#39; or &#39;NCFile&#39; if we don&#39;t build with netcdf!&quot;</span>);</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160; </div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;    <span class="comment">// Query the canopy model file name</span></div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;    std::string forestfile;</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;    <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aed9118172b234c3a0069a78776d09baa">do_forest_drag</a> = <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.query(<span class="stringliteral">&quot;forest_file&quot;</span>, forestfile);</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aed9118172b234c3a0069a78776d09baa">do_forest_drag</a>) {</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= max_level; ++lev) {</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;            <a class="code" href="classERF.html#a8b181e6ed0bb62d79e4a62555210abc9">m_forest_drag</a>[lev] = std::make_unique&lt;ForestDrag&gt;(forestfile);</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;        }</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;    }</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160; </div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;    <span class="comment">// If init from WRFInput or Metgrid make sure a valid file name is present</span></div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac1ddc9c301ac98689bf3b7b7184b24e1">init_type</a> == InitType::WRFInput) ||</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;        (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac1ddc9c301ac98689bf3b7b7184b24e1">init_type</a> == InitType::Metgrid)  ||</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;        (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac1ddc9c301ac98689bf3b7b7184b24e1">init_type</a> == InitType::NCFile) ) {</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= max_level; lev++) {</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;            <span class="keywordtype">int</span> num_files = <a class="code" href="classERF.html#a7ef14f6028b577eba70aef46b508be19">nc_init_file</a>[lev].size();</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;            AMREX_ALWAYS_ASSERT_WITH_MESSAGE(num_files&gt;0, <span class="stringliteral">&quot;A file name must be present for init type WRFInput, Metgrid or NCFile.&quot;</span>);</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; num_files; j++) {</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;                AMREX_ALWAYS_ASSERT_WITH_MESSAGE(!<a class="code" href="classERF.html#a7ef14f6028b577eba70aef46b508be19">nc_init_file</a>[lev][j].empty(), <span class="stringliteral">&quot;Valid file name must be present for init type WRFInput, Metgrid or NCFile.&quot;</span>);</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;            } <span class="comment">//j</span></div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;        } <span class="comment">// lev</span></div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;    } <span class="comment">// InitType</span></div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160; </div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;    <span class="comment">// What type of land surface model to use</span></div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;    <span class="comment">// NOTE: Must be checked after init_params</span></div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a43c1741535574c7e6f4fe6bf90552f31">lsm_type</a> == LandSurfaceType::SLM) {</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;        <a class="code" href="classERF.html#ae0e9a78f120ba632d78cbf23c97b851c">lsm</a>.<a class="code" href="classLandSurface.html#a91df3382b60a6566b78a23c87b46f065">SetModel</a>&lt;<a class="code" href="classSLM.html">SLM</a>&gt;();</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;        Print() &lt;&lt; <span class="stringliteral">&quot;SLM land surface model!\n&quot;</span>;</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a43c1741535574c7e6f4fe6bf90552f31">lsm_type</a> == LandSurfaceType::MM5) {</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;        <a class="code" href="classERF.html#ae0e9a78f120ba632d78cbf23c97b851c">lsm</a>.<a class="code" href="classLandSurface.html#a91df3382b60a6566b78a23c87b46f065">SetModel</a>&lt;<a class="code" href="classMM5.html">MM5</a>&gt;();</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;        Print() &lt;&lt; <span class="stringliteral">&quot;MM5 land surface model!\n&quot;</span>;</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;<span class="preprocessor">#ifdef ERF_USE_NOAH</span></div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a43c1741535574c7e6f4fe6bf90552f31">lsm_type</a> == LandSurfaceType::NOAH) {</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;        <a class="code" href="classERF.html#ae0e9a78f120ba632d78cbf23c97b851c">lsm</a>.<a class="code" href="classLandSurface.html#a91df3382b60a6566b78a23c87b46f065">SetModel</a>&lt;<a class="code" href="classNOAH.html">NOAH</a>&gt;();</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;        Print() &lt;&lt; <span class="stringliteral">&quot;NOAH land surface model!\n&quot;</span>;</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a43c1741535574c7e6f4fe6bf90552f31">lsm_type</a> == LandSurfaceType::None) {</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;        <a class="code" href="classERF.html#ae0e9a78f120ba632d78cbf23c97b851c">lsm</a>.<a class="code" href="classLandSurface.html#a91df3382b60a6566b78a23c87b46f065">SetModel</a>&lt;<a class="code" href="classNullSurf.html">NullSurf</a>&gt;();</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;        Print() &lt;&lt; <span class="stringliteral">&quot;Null land surface model!\n&quot;</span>;</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;        Abort(<span class="stringliteral">&quot;Dont know this LandSurfaceType!&quot;</span>) ;</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;    }</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160; </div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a43d0b17f6e155691a1e9474526df3af5">verbose</a> &gt; 0) {</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;        <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a1f02eb4a7e9ce2f0c675e8cbcc2de671">display</a>(max_level,<a class="code" href="classERF.html#a59df30e7a5537c8543bb00772bd98b58">pp_prefix</a>);</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;    }</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160; </div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;    <a class="code" href="classERF.html#ad71a033b3fd107465a8621eaf7c77b28">ParameterSanityChecks</a>();</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;}</div>
<div class="ttc" id="aERF__EpochTime_8H_html_a370a1cca0113b3529a59c031ff71ffb8"><div class="ttname"><a href="ERF__EpochTime_8H.html#a370a1cca0113b3529a59c031ff71ffb8">getEpochTime</a></div><div class="ttdeci">AMREX_FORCE_INLINE std::time_t getEpochTime(const std::string &amp;dateTime, const std::string &amp;dateTimeFormat)</div><div class="ttdef"><b>Definition:</b> ERF_EpochTime.H:14</div></div>
<div class="ttc" id="aclassERF_html_a04831a5a6bf49d8386d362379db84358"><div class="ttname"><a href="classERF.html#a04831a5a6bf49d8386d362379db84358">ERF::metgrid_basic_linear</a></div><div class="ttdeci">bool metgrid_basic_linear</div><div class="ttdef"><b>Definition:</b> ERF.H:1067</div></div>
<div class="ttc" id="aclassERF_html_a050dbd236c9bf246554a53008e09f683"><div class="ttname"><a href="classERF.html#a050dbd236c9bf246554a53008e09f683">ERF::boxes_at_level</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; amrex::Box &gt; &gt; boxes_at_level</div><div class="ttdef"><b>Definition:</b> ERF.H:693</div></div>
<div class="ttc" id="aclassERF_html_a079811bdd498e155326a851e0c12f850"><div class="ttname"><a href="classERF.html#a079811bdd498e155326a851e0c12f850">ERF::metgrid_debug_msf</a></div><div class="ttdeci">bool metgrid_debug_msf</div><div class="ttdef"><b>Definition:</b> ERF.H:1065</div></div>
<div class="ttc" id="aclassERF_html_a18fa84b06132715757d97ec38678aa2c"><div class="ttname"><a href="classERF.html#a18fa84b06132715757d97ec38678aa2c">ERF::plot_file_2</a></div><div class="ttdeci">std::string plot_file_2</div><div class="ttdef"><b>Definition:</b> ERF.H:927</div></div>
<div class="ttc" id="aclassERF_html_a34f2eb136e6747a7e6461fb95e50076e"><div class="ttname"><a href="classERF.html#a34f2eb136e6747a7e6461fb95e50076e">ERF::plot_rad</a></div><div class="ttdeci">bool plot_rad</div><div class="ttdef"><b>Definition:</b> ERF.H:772</div></div>
<div class="ttc" id="aclassERF_html_a367a3daba5d844efbed84c52e647cea6"><div class="ttname"><a href="classERF.html#a367a3daba5d844efbed84c52e647cea6">ERF::m_plot_face_vels</a></div><div class="ttdeci">bool m_plot_face_vels</div><div class="ttdef"><b>Definition:</b> ERF.H:936</div></div>
<div class="ttc" id="aclassERF_html_a3937527f96c81674fa38dc34ed24f3f5"><div class="ttname"><a href="classERF.html#a3937527f96c81674fa38dc34ed24f3f5">ERF::regrid_int</a></div><div class="ttdeci">int regrid_int</div><div class="ttdef"><b>Definition:</b> ERF.H:919</div></div>
<div class="ttc" id="aclassERF_html_a51e327479a5c37c694bbf14eb8bce94f"><div class="ttname"><a href="classERF.html#a51e327479a5c37c694bbf14eb8bce94f">ERF::metgrid_retain_sfc</a></div><div class="ttdeci">bool metgrid_retain_sfc</div><div class="ttdef"><b>Definition:</b> ERF.H:1070</div></div>
<div class="ttc" id="aclassERF_html_a5d2fe657db8c3614db3e797566a49d68"><div class="ttname"><a href="classERF.html#a5d2fe657db8c3614db3e797566a49d68">ERF::metgrid_use_sfc</a></div><div class="ttdeci">bool metgrid_use_sfc</div><div class="ttdef"><b>Definition:</b> ERF.H:1069</div></div>
<div class="ttc" id="aclassERF_html_a610a988f46e0496e6dbd0471ae817f75"><div class="ttname"><a href="classERF.html#a610a988f46e0496e6dbd0471ae817f75">ERF::num_files_at_level</a></div><div class="ttdeci">amrex::Vector&lt; int &gt; num_files_at_level</div><div class="ttdef"><b>Definition:</b> ERF.H:692</div></div>
<div class="ttc" id="aclassERF_html_a64c81ad5cd1b7d21c2e597b92596f113"><div class="ttname"><a href="classERF.html#a64c81ad5cd1b7d21c2e597b92596f113">ERF::metgrid_debug_quiescent</a></div><div class="ttdeci">bool metgrid_debug_quiescent</div><div class="ttdef"><b>Definition:</b> ERF.H:1061</div></div>
<div class="ttc" id="aclassERF_html_a7eac012575590fe374a8d4b5d9061546"><div class="ttname"><a href="classERF.html#a7eac012575590fe374a8d4b5d9061546">ERF::metgrid_interp_theta</a></div><div class="ttdeci">bool metgrid_interp_theta</div><div class="ttdef"><b>Definition:</b> ERF.H:1066</div></div>
<div class="ttc" id="aclassERF_html_a7ef14f6028b577eba70aef46b508be19"><div class="ttname"><a href="classERF.html#a7ef14f6028b577eba70aef46b508be19">ERF::nc_init_file</a></div><div class="ttdeci">static amrex::Vector&lt; amrex::Vector&lt; std::string &gt; &gt; nc_init_file</div><div class="ttdef"><b>Definition:</b> ERF.H:1046</div></div>
<div class="ttc" id="aclassERF_html_a833c301baf4bb3ee3c944faad7bf6ee7"><div class="ttname"><a href="classERF.html#a833c301baf4bb3ee3c944faad7bf6ee7">ERF::regrid_level_0_on_restart</a></div><div class="ttdeci">bool regrid_level_0_on_restart</div><div class="ttdef"><b>Definition:</b> ERF.H:923</div></div>
<div class="ttc" id="aclassERF_html_a8767bdb5ac5b0a796dc478dc417e1606"><div class="ttname"><a href="classERF.html#a8767bdb5ac5b0a796dc478dc417e1606">ERF::metgrid_force_sfc_k</a></div><div class="ttdeci">int metgrid_force_sfc_k</div><div class="ttdef"><b>Definition:</b> ERF.H:1073</div></div>
<div class="ttc" id="aclassERF_html_a8eb60483e48302db4706d3b90c0ae8e4"><div class="ttname"><a href="classERF.html#a8eb60483e48302db4706d3b90c0ae8e4">ERF::metgrid_use_below_sfc</a></div><div class="ttdeci">bool metgrid_use_below_sfc</div><div class="ttdef"><b>Definition:</b> ERF.H:1068</div></div>
<div class="ttc" id="aclassERF_html_a9183a64262ae944d9b3968c57de9652f"><div class="ttname"><a href="classERF.html#a9183a64262ae944d9b3968c57de9652f">ERF::subvol_file</a></div><div class="ttdeci">std::string subvol_file</div><div class="ttdef"><b>Definition:</b> ERF.H:928</div></div>
<div class="ttc" id="aclassERF_html_a95182a17e10556dde659d4dd891a4ed3"><div class="ttname"><a href="classERF.html#a95182a17e10556dde659d4dd891a4ed3">ERF::metgrid_proximity</a></div><div class="ttdeci">amrex::Real metgrid_proximity</div><div class="ttdef"><b>Definition:</b> ERF.H:1071</div></div>
<div class="ttc" id="aclassERF_html_aa54aaa938a18d34caa4d86e977647899"><div class="ttname"><a href="classERF.html#aa54aaa938a18d34caa4d86e977647899">ERF::plot_file_1</a></div><div class="ttdeci">std::string plot_file_1</div><div class="ttdef"><b>Definition:</b> ERF.H:926</div></div>
<div class="ttc" id="aclassERF_html_aaaa067c46e79ca3635d138750642b78d"><div class="ttname"><a href="classERF.html#aaaa067c46e79ca3635d138750642b78d">ERF::metgrid_debug_dry</a></div><div class="ttdeci">bool metgrid_debug_dry</div><div class="ttdef"><b>Definition:</b> ERF.H:1063</div></div>
<div class="ttc" id="aclassERF_html_ab08081c75e6d926825071630f2adddab"><div class="ttname"><a href="classERF.html#ab08081c75e6d926825071630f2adddab">ERF::metgrid_debug_isothermal</a></div><div class="ttdeci">bool metgrid_debug_isothermal</div><div class="ttdef"><b>Definition:</b> ERF.H:1062</div></div>
<div class="ttc" id="aclassERF_html_ad256f0610d54caef208e2b2569a5aa82"><div class="ttname"><a href="classERF.html#ad256f0610d54caef208e2b2569a5aa82">ERF::metgrid_debug_psfc</a></div><div class="ttdeci">bool metgrid_debug_psfc</div><div class="ttdef"><b>Definition:</b> ERF.H:1064</div></div>
<div class="ttc" id="aclassERF_html_ad4c8a68d25ec78f9944bf3123fafd93e"><div class="ttname"><a href="classERF.html#ad4c8a68d25ec78f9944bf3123fafd93e">ERF::nc_low_file</a></div><div class="ttdeci">static std::string nc_low_file</div><div class="ttdef"><b>Definition:</b> ERF.H:1054</div></div>
<div class="ttc" id="aclassERF_html_ad71a033b3fd107465a8621eaf7c77b28"><div class="ttname"><a href="classERF.html#ad71a033b3fd107465a8621eaf7c77b28">ERF::ParameterSanityChecks</a></div><div class="ttdeci">void ParameterSanityChecks()</div><div class="ttdef"><b>Definition:</b> ERF.cpp:1962</div></div>
<div class="ttc" id="aclassERF_html_adb272adf862040a2f1a6226c57c35627"><div class="ttname"><a href="classERF.html#adb272adf862040a2f1a6226c57c35627">ERF::m_expand_plotvars_to_unif_rr</a></div><div class="ttdeci">bool m_expand_plotvars_to_unif_rr</div><div class="ttdef"><b>Definition:</b> ERF.H:929</div></div>
<div class="ttc" id="aclassERF_html_adcd9f23975ffa605247b41d391c2a2f0"><div class="ttname"><a href="classERF.html#adcd9f23975ffa605247b41d391c2a2f0">ERF::num_boxes_at_level</a></div><div class="ttdeci">amrex::Vector&lt; int &gt; num_boxes_at_level</div><div class="ttdef"><b>Definition:</b> ERF.H:691</div></div>
<div class="ttc" id="aclassERF_html_ae701564fbe3da5bbd88587e5a08eca4e"><div class="ttname"><a href="classERF.html#ae701564fbe3da5bbd88587e5a08eca4e">ERF::check_file</a></div><div class="ttdeci">std::string check_file</div><div class="ttdef"><b>Definition:</b> ERF.H:945</div></div>
<div class="ttc" id="aclassERF_html_af27fd93c086c23ab8c754e63e1a0c425"><div class="ttname"><a href="classERF.html#af27fd93c086c23ab8c754e63e1a0c425">ERF::metgrid_order</a></div><div class="ttdeci">int metgrid_order</div><div class="ttdef"><b>Definition:</b> ERF.H:1072</div></div>
<div class="ttc" id="aclassERF_html_afc653b103aa26c56acafed85cdd95f52"><div class="ttname"><a href="classERF.html#afc653b103aa26c56acafed85cdd95f52">ERF::plot_lsm</a></div><div class="ttdeci">bool plot_lsm</div><div class="ttdef"><b>Definition:</b> ERF.H:938</div></div>
<div class="ttc" id="aclassLandSurface_html_a91df3382b60a6566b78a23c87b46f065"><div class="ttname"><a href="classLandSurface.html#a91df3382b60a6566b78a23c87b46f065">LandSurface::SetModel</a></div><div class="ttdeci">void SetModel()</div><div class="ttdef"><b>Definition:</b> ERF_LandSurface.H:28</div></div>
<div class="ttc" id="aclassMM5_html"><div class="ttname"><a href="classMM5.html">MM5</a></div><div class="ttdef"><b>Definition:</b> ERF_MM5.H:26</div></div>
<div class="ttc" id="aclassNOAH_html"><div class="ttname"><a href="classNOAH.html">NOAH</a></div><div class="ttdef"><b>Definition:</b> ERF_NOAH.H:30</div></div>
<div class="ttc" id="aclassNullSurf_html"><div class="ttname"><a href="classNullSurf.html">NullSurf</a></div><div class="ttdef"><b>Definition:</b> ERF_NullSurf.H:8</div></div>
<div class="ttc" id="aclassSLM_html"><div class="ttname"><a href="classSLM.html">SLM</a></div><div class="ttdef"><b>Definition:</b> ERF_SLM.H:26</div></div>
<div class="ttc" id="astructSolverChoice_html_a1f02eb4a7e9ce2f0c675e8cbcc2de671"><div class="ttname"><a href="structSolverChoice.html#a1f02eb4a7e9ce2f0c675e8cbcc2de671">SolverChoice::display</a></div><div class="ttdeci">void display(int max_level, std::string pp_prefix)</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:542</div></div>
<div class="ttc" id="astructSolverChoice_html_a76659aa69edd3370626e3648cbead9be"><div class="ttname"><a href="structSolverChoice.html#a76659aa69edd3370626e3648cbead9be">SolverChoice::init_params</a></div><div class="ttdeci">void init_params(int max_level, std::string pp_prefix)</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:101</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a2d39cd3bdc3d90609ad3b14e266d190a_cgraph.png" border="0" usemap="#aclassERF_a2d39cd3bdc3d90609ad3b14e266d190a_cgraph" alt=""/></div>
<map name="aclassERF_a2d39cd3bdc3d90609ad3b14e266d190a_cgraph" id="aclassERF_a2d39cd3bdc3d90609ad3b14e266d190a_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,167,57"/>
<area shape="rect" href="ERF__EpochTime_8H.html#a370a1cca0113b3529a59c031ff71ffb8" title=" " alt="" coords="215,5,329,32"/>
<area shape="rect" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469" title=" " alt="" coords="253,56,291,83"/>
</map>
</div>

</div>
</div>
<a id="aa90c9756f684404f8b69b8a23568b535"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa90c9756f684404f8b69b8a23568b535">&#9670;&nbsp;</a></span>refinement_criteria_setup()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::refinement_criteria_setup </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Function to define the refinement criteria based on user input </p>
<div class="fragment"><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;{</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordflow">if</span> (max_level &gt; 0)</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    {</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        ParmParse <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>(<a class="code" href="classERF.html#a59df30e7a5537c8543bb00772bd98b58">pp_prefix</a>);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        Vector&lt;std::string&gt; refinement_indicators;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.queryarr(<span class="stringliteral">&quot;refinement_indicators&quot;</span>,refinement_indicators,0,<a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.countval(<span class="stringliteral">&quot;refinement_indicators&quot;</span>));</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;refinement_indicators.size(); ++i)</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            std::string ref_prefix = <a class="code" href="classERF.html#a59df30e7a5537c8543bb00772bd98b58">pp_prefix</a> + <span class="stringliteral">&quot;.&quot;</span> + refinement_indicators[i];</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            ParmParse ppr(ref_prefix);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            RealBox realbox;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            <span class="keywordtype">int</span> lev_for_box;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            <span class="keywordtype">int</span> num_real_lo = ppr.countval(<span class="stringliteral">&quot;in_box_lo&quot;</span>);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            <span class="keywordtype">int</span> num_indx_lo = ppr.countval(<span class="stringliteral">&quot;in_box_lo_indices&quot;</span>);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            <span class="keywordtype">int</span> num_real_hi = ppr.countval(<span class="stringliteral">&quot;in_box_hi&quot;</span>);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            <span class="keywordtype">int</span> num_indx_hi = ppr.countval(<span class="stringliteral">&quot;in_box_hi_indices&quot;</span>);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            AMREX_ALWAYS_ASSERT(num_real_lo == num_real_hi);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            AMREX_ALWAYS_ASSERT(num_indx_lo == num_indx_hi);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            <span class="keywordflow">if</span> ( !((num_real_lo &gt;= AMREX_SPACEDIM-1 &amp;&amp; num_indx_lo == 0) ||</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                   (num_indx_lo &gt;= AMREX_SPACEDIM-1 &amp;&amp; num_real_lo == 0) ||</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                   (num_indx_lo ==              0   &amp;&amp; num_real_lo == 0)) )</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                amrex::Abort(<span class="stringliteral">&quot;Must only specify box for refinement using real OR index space&quot;</span>);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            }</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            <span class="keywordflow">if</span> (num_real_lo &gt; 0) {</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                std::vector&lt;Real&gt; rbox_lo(3), rbox_hi(3);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                ppr.get(<span class="stringliteral">&quot;max_level&quot;</span>,lev_for_box);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                <span class="keywordflow">if</span> (lev_for_box &lt;= max_level)</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                    <span class="keywordflow">if</span> (n_error_buf[0] != IntVect::TheZeroVector()) {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                        amrex::Abort(<span class="stringliteral">&quot;Don&#39;t use n_error_buf &gt; 0 when setting the box explicitly&quot;</span>);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                    }</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                    <span class="keyword">const</span> Real* plo = geom[lev_for_box].ProbLo();</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                    <span class="keyword">const</span> Real* phi = geom[lev_for_box].ProbHi();</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                    ppr.getarr(<span class="stringliteral">&quot;in_box_lo&quot;</span>,rbox_lo,0,num_real_lo);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                    ppr.getarr(<span class="stringliteral">&quot;in_box_hi&quot;</span>,rbox_hi,0,num_real_hi);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                    <span class="keywordflow">if</span> (rbox_lo[0] &lt; plo[0]) rbox_lo[0] = plo[0];</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                    <span class="keywordflow">if</span> (rbox_lo[1] &lt; plo[1]) rbox_lo[1] = plo[1];</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                    <span class="keywordflow">if</span> (rbox_hi[0] &gt; phi[0]) rbox_hi[0] = phi[0];</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                    <span class="keywordflow">if</span> (rbox_hi[1] &gt; phi[1]) rbox_hi[1] = phi[1];</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                    <span class="keywordflow">if</span> (num_real_lo &lt; AMREX_SPACEDIM) {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                        rbox_lo[2] = plo[2];</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                        rbox_hi[2] = phi[2];</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                    }</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                    realbox = RealBox(&amp;(rbox_lo[0]),&amp;(rbox_hi[0]));</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                    Print() &lt;&lt; <span class="stringliteral">&quot;Realbox read in and intersected laterally with domain is &quot;</span> &lt;&lt; realbox &lt;&lt; std::endl;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                    <a class="code" href="classERF.html#adcd9f23975ffa605247b41d391c2a2f0">num_boxes_at_level</a>[lev_for_box] += 1;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                    <span class="keywordtype">int</span> ilo, jlo, klo;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                    <span class="keywordtype">int</span> ihi, jhi, khi;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                    <span class="keyword">const</span> <span class="keyword">auto</span>* dx  = geom[lev_for_box].CellSize();</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                    ilo = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>((rbox_lo[0] - plo[0])/dx[0]);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                    jlo = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>((rbox_lo[1] - plo[1])/dx[1]);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                    ihi = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>((rbox_hi[0] - plo[0])/dx[0]-1);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                    jhi = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>((rbox_hi[1] - plo[1])/dx[1]-1);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="structSolverChoice.html#a1952672901901b0b3a628f2298dc72c2">SolverChoice::mesh_type</a> != MeshType::ConstantDz) {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                        <span class="comment">// Search for k indices corresponding to nominal grid</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                        <span class="comment">// AGL heights</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                        <span class="keyword">const</span> Box&amp; domain = geom[lev_for_box].Domain();</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                        klo = domain.smallEnd(2) - 1;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                        khi = domain.smallEnd(2) - 1;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                        <span class="keywordflow">if</span> (rbox_lo[2] &lt;= <a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[lev_for_box][domain.smallEnd(2)])</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                        {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                            klo = domain.smallEnd(2);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                        }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                        {</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=domain.smallEnd(2); k&lt;=domain.bigEnd(2)+1; ++k) {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                                <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[lev_for_box][k] &gt; rbox_lo[2]) {</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                                    klo = k-1;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                                }</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                            }</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                        }</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                        AMREX_ASSERT(klo &gt;= domain.smallEnd(2));</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                        <span class="keywordflow">if</span> (rbox_hi[2] &gt;= <a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[lev_for_box][domain.bigEnd(2)+1])</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                        {</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                            khi = domain.bigEnd(2);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                        }</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                        {</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=klo+1; k&lt;=domain.bigEnd(2)+1; ++k) {</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                                <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[lev_for_box][k] &gt; rbox_hi[2]) {</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                                    khi = k-1;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                                }</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                            }</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                        }</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                        AMREX_ASSERT((khi &lt;= domain.bigEnd(2)) &amp;&amp; (khi &gt; klo));</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                        <span class="comment">// Need to update realbox because tagging is based on</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                        <span class="comment">// the initial _un_deformed grid</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                        realbox = RealBox(plo[0]+ ilo   *dx[0], plo[1]+ jlo   *dx[1], plo[2]+ klo   *dx[2],</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                                          plo[0]+(ihi+1)*dx[0], plo[1]+(jhi+1)*dx[1], plo[2]+(khi+1)*dx[2]);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                        klo = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>((rbox_lo[2] - plo[2])/dx[2]);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                        khi = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>((rbox_hi[2] - plo[2])/dx[2]-1);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                    }</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                    Box bx(IntVect(ilo,jlo,klo),IntVect(ihi,jhi,khi));</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                    <span class="keywordflow">if</span> ( (ilo%ref_ratio[lev_for_box-1][0] != 0) || ((ihi+1)%ref_ratio[lev_for_box-1][0] != 0) ||</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                         (jlo%ref_ratio[lev_for_box-1][1] != 0) || ((jhi+1)%ref_ratio[lev_for_box-1][1] != 0) ||</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                         (klo%ref_ratio[lev_for_box-1][2] != 0) || ((khi+1)%ref_ratio[lev_for_box-1][2] != 0) )</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                    {</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Box : &quot;</span> &lt;&lt; bx &lt;&lt; std::endl;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;RealBox : &quot;</span> &lt;&lt; realbox &lt;&lt; std::endl;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;ilo, ihi+1, jlo, jhi+1, klo, khi+1 by ref_ratio : &quot;</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                                       &lt;&lt; ilo%ref_ratio[lev_for_box-1][0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; (ihi+1)%ref_ratio[lev_for_box-1][0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                                       &lt;&lt; jlo%ref_ratio[lev_for_box-1][1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; (jhi+1)%ref_ratio[lev_for_box-1][1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                                       &lt;&lt; klo%ref_ratio[lev_for_box-1][2] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; (khi+1)%ref_ratio[lev_for_box-1][2] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                        amrex::Error(<span class="stringliteral">&quot;Fine box is not legit with this ref_ratio&quot;</span>);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                    }</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                    <a class="code" href="classERF.html#a050dbd236c9bf246554a53008e09f683">boxes_at_level</a>[lev_for_box].push_back(bx);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                    Print() &lt;&lt; <span class="stringliteral">&quot;Saving in &#39;boxes at level&#39; as &quot;</span> &lt;&lt; bx &lt;&lt; std::endl;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                } <span class="comment">// lev</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac1ddc9c301ac98689bf3b7b7184b24e1">init_type</a> == InitType::WRFInput) {</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#adcd9f23975ffa605247b41d391c2a2f0">num_boxes_at_level</a>[lev_for_box] != <a class="code" href="classERF.html#a610a988f46e0496e6dbd0471ae817f75">num_files_at_level</a>[lev_for_box]) {</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                        amrex::Error(<span class="stringliteral">&quot;Number of boxes doesn&#39;t match number of input files&quot;</span>);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160; </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                    }</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                }</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160; </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (num_indx_lo &gt; 0) {</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                std::vector&lt;int&gt; box_lo(3), box_hi(3);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                ppr.get(<span class="stringliteral">&quot;max_level&quot;</span>,lev_for_box);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                <span class="keywordflow">if</span> (lev_for_box &lt;= max_level)</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                {</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                    <span class="keywordflow">if</span> (n_error_buf[0] != IntVect::TheZeroVector()) {</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                        amrex::Abort(<span class="stringliteral">&quot;Don&#39;t use n_error_buf &gt; 0 when setting the box explicitly&quot;</span>);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                    }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160; </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                    ppr.getarr(<span class="stringliteral">&quot;in_box_lo_indices&quot;</span>,box_lo,0,AMREX_SPACEDIM);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                    ppr.getarr(<span class="stringliteral">&quot;in_box_hi_indices&quot;</span>,box_hi,0,AMREX_SPACEDIM);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                    Box bx(IntVect(box_lo[0],box_lo[1],box_lo[2]),IntVect(box_hi[0],box_hi[1],box_hi[2]));</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                    amrex::Print() &lt;&lt; <span class="stringliteral">&quot;BOX &quot;</span> &lt;&lt; bx &lt;&lt; std::endl;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                    <span class="keyword">const</span> <span class="keyword">auto</span>* dx  = geom[lev_for_box].CellSize();</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                    <span class="keyword">const</span> Real* plo = geom[lev_for_box].ProbLo();</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                    realbox = RealBox(plo[0]+ box_lo[0]   *dx[0], plo[1]+ box_lo[1]   *dx[1], plo[2]+ box_lo[2]   *dx[2],</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                                      plo[0]+(box_hi[0]+1)*dx[0], plo[1]+(box_hi[1]+1)*dx[1], plo[2]+(box_hi[2]+1)*dx[2]);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                    Print() &lt;&lt; <span class="stringliteral">&quot;Reading &quot;</span> &lt;&lt; bx &lt;&lt; <span class="stringliteral">&quot; at level &quot;</span> &lt;&lt; lev_for_box &lt;&lt; std::endl;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                    <a class="code" href="classERF.html#adcd9f23975ffa605247b41d391c2a2f0">num_boxes_at_level</a>[lev_for_box] += 1;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                    <span class="keywordflow">if</span> ( (box_lo[0]%ref_ratio[lev_for_box-1][0] != 0) || ((box_hi[0]+1)%ref_ratio[lev_for_box-1][0] != 0) ||</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                         (box_lo[1]%ref_ratio[lev_for_box-1][1] != 0) || ((box_hi[1]+1)%ref_ratio[lev_for_box-1][1] != 0) ||</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                         (box_lo[2]%ref_ratio[lev_for_box-1][2] != 0) || ((box_hi[2]+1)%ref_ratio[lev_for_box-1][2] != 0) )</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                         amrex::Error(<span class="stringliteral">&quot;Fine box is not legit with this ref_ratio&quot;</span>);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                    <a class="code" href="classERF.html#a050dbd236c9bf246554a53008e09f683">boxes_at_level</a>[lev_for_box].push_back(bx);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                    Print() &lt;&lt; <span class="stringliteral">&quot;Saving in &#39;boxes at level&#39; as &quot;</span> &lt;&lt; bx &lt;&lt; std::endl;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                } <span class="comment">// lev</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac1ddc9c301ac98689bf3b7b7184b24e1">init_type</a> == InitType::WRFInput) {</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#adcd9f23975ffa605247b41d391c2a2f0">num_boxes_at_level</a>[lev_for_box] != <a class="code" href="classERF.html#a610a988f46e0496e6dbd0471ae817f75">num_files_at_level</a>[lev_for_box]) {</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                        amrex::Error(<span class="stringliteral">&quot;Number of boxes doesn&#39;t match number of input files&quot;</span>);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                    }</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                }</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            }</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            AMRErrorTagInfo info;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160; </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            <span class="keywordflow">if</span> (realbox.ok()) {</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                info.SetRealBox(realbox);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;            }</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            <span class="keywordflow">if</span> (ppr.countval(<span class="stringliteral">&quot;start_time&quot;</span>) &gt; 0) {</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                Real ref_min_time; ppr.get(<span class="stringliteral">&quot;start_time&quot;</span>,ref_min_time);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                info.SetMinTime(ref_min_time);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            }</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;            <span class="keywordflow">if</span> (ppr.countval(<span class="stringliteral">&quot;end_time&quot;</span>) &gt; 0) {</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                Real ref_max_time; ppr.get(<span class="stringliteral">&quot;end_time&quot;</span>,ref_max_time);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                info.SetMaxTime(ref_max_time);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            }</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            <span class="keywordflow">if</span> (ppr.countval(<span class="stringliteral">&quot;max_level&quot;</span>) &gt; 0) {</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                <span class="keywordtype">int</span> ref_max_level; ppr.get(<span class="stringliteral">&quot;max_level&quot;</span>,ref_max_level);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                info.SetMaxLevel(ref_max_level);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            }</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            <span class="keywordflow">if</span> (ppr.countval(<span class="stringliteral">&quot;value_greater&quot;</span>)) {</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                <span class="keywordtype">int</span> num_val = ppr.countval(<span class="stringliteral">&quot;value_greater&quot;</span>);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                Vector&lt;Real&gt; value(num_val);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                ppr.getarr(<span class="stringliteral">&quot;value_greater&quot;</span>,value,0,num_val);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                std::string field; ppr.get(<span class="stringliteral">&quot;field_name&quot;</span>,field);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                <a class="code" href="classERF.html#ac81b3dfd7c6f21ba8479834e2ff1e652">ref_tags</a>.push_back(AMRErrorTag(value,AMRErrorTag::GREATER,field,info));</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            }</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ppr.countval(<span class="stringliteral">&quot;value_less&quot;</span>)) {</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                <span class="keywordtype">int</span> num_val = ppr.countval(<span class="stringliteral">&quot;value_less&quot;</span>);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                Vector&lt;Real&gt; value(num_val);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                ppr.getarr(<span class="stringliteral">&quot;value_less&quot;</span>,value,0,num_val);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                std::string field; ppr.get(<span class="stringliteral">&quot;field_name&quot;</span>,field);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                <a class="code" href="classERF.html#ac81b3dfd7c6f21ba8479834e2ff1e652">ref_tags</a>.push_back(AMRErrorTag(value,AMRErrorTag::LESS,field,info));</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;            }</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ppr.countval(<span class="stringliteral">&quot;adjacent_difference_greater&quot;</span>)) {</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                <span class="keywordtype">int</span> num_val = ppr.countval(<span class="stringliteral">&quot;adjacent_difference_greater&quot;</span>);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                Vector&lt;Real&gt; value(num_val);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                ppr.getarr(<span class="stringliteral">&quot;adjacent_difference_greater&quot;</span>,value,0,num_val);</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                std::string field; ppr.get(<span class="stringliteral">&quot;field_name&quot;</span>,field);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                <a class="code" href="classERF.html#ac81b3dfd7c6f21ba8479834e2ff1e652">ref_tags</a>.push_back(AMRErrorTag(value,AMRErrorTag::GRAD,field,info));</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;            }</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (realbox.ok())</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            {</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                <a class="code" href="classERF.html#ac81b3dfd7c6f21ba8479834e2ff1e652">ref_tags</a>.push_back(AMRErrorTag(info));</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                Abort(std::string(<span class="stringliteral">&quot;Unrecognized refinement indicator for &quot;</span> + refinement_indicators[i]).c_str());</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;            }</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        } <span class="comment">// loop over criteria</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    } <span class="comment">// if max_level &gt; 0</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_aa90c9756f684404f8b69b8a23568b535_cgraph.png" border="0" usemap="#aclassERF_aa90c9756f684404f8b69b8a23568b535_cgraph" alt=""/></div>
<map name="aclassERF_aa90c9756f684404f8b69b8a23568b535_cgraph" id="aclassERF_aa90c9756f684404f8b69b8a23568b535_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,184,47"/>
<area shape="rect" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469" title=" " alt="" coords="232,13,271,39"/>
</map>
</div>

</div>
</div>
<a id="a691172d44ab3e8b4d6fb18c068cc1ab4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a691172d44ab3e8b4d6fb18c068cc1ab4">&#9670;&nbsp;</a></span>remake_zphys()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::remake_zphys </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>temp_zphys_nd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;{</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="keywordflow">if</span> (lev &gt; 0)</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    {</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        <span class="comment">// First interpolate from coarser level</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        <span class="comment">// NOTE: this interpolater assumes that ALL ghost cells of the coarse MultiFab</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        <span class="comment">//       have been pre-filled - this includes ghost cells both inside and outside</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        <span class="comment">//       the domain</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        InterpFromCoarseLevel(*temp_zphys_nd, <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev]-&gt;nGrowVect(),</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                              IntVect(0,0,0), <span class="comment">// do not fill ghost cells outside the domain</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                              *<a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev-1], 0, 0, 1,</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                              geom[lev-1], geom[lev],</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                              refRatio(lev-1), &amp;node_bilinear_interp,</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                              <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>, <a class="code" href="namespaceBCVars.html#a00367571247ba920989360b94c156f4aaaf601346b01655b32acf66d07b856aec">BCVars::cons_bc</a>);</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160; </div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        <span class="comment">// This recomputes the fine values using the bottom terrain at the fine resolution,</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        <span class="comment">//    and also fills values of z_phys_nd outside the domain</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        <a class="code" href="ERF__TerrainMetrics_8cpp.html#a9addf6b6f85760dd0d43acd9a52fe66c">make_terrain_fitted_coords</a>(lev,geom[lev],*temp_zphys_nd,<a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[lev],<a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>);</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160; </div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        std::swap(temp_zphys_nd, <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev]);</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160; </div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    } <span class="comment">// lev &gt; 0</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160; </div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> == TerrainType::ImmersedForcing) {</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        <span class="comment">// This assumes we have already remade the EBGeometry</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        <a class="code" href="classERF.html#a4a18cc3befd0911ccb011f9bb3b2efc2">terrain_blanking</a>[lev]-&gt;setVal(1.0);</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        MultiFab::Subtract(*<a class="code" href="classERF.html#a4a18cc3befd0911ccb011f9bb3b2efc2">terrain_blanking</a>[lev], <a class="code" href="classERF.html#ad024dd413ab20e5d6f69c1f96e5b78a3">EBFactory</a>(lev).getVolFrac(), 0, 0, 1, <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev]-&gt;nGrowVect());</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    }</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a691172d44ab3e8b4d6fb18c068cc1ab4_cgraph.png" border="0" usemap="#aclassERF_a691172d44ab3e8b4d6fb18c068cc1ab4_cgraph" alt=""/></div>
<map name="aclassERF_a691172d44ab3e8b4d6fb18c068cc1ab4_cgraph" id="aclassERF_a691172d44ab3e8b4d6fb18c068cc1ab4_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,153,57"/>
<area shape="rect" href="ERF__TerrainMetrics_8cpp.html#a9addf6b6f85760dd0d43acd9a52fe66c" title=" " alt="" coords="201,23,351,65"/>
<area shape="rect" href="ERF__ChopGrids_8cpp.html#a6fe49eeaa200ab6ab8ae0a6e048f3ded" title=" " alt="" coords="431,5,537,32"/>
<area shape="rect" href="ERF__TerrainMetrics_8cpp.html#ac59abef116a0b274b84ab3d89771ef22" title=" " alt="" coords="399,56,569,83"/>
<area shape="rect" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469" title=" " alt="" coords="617,56,656,83"/>
</map>
</div>

</div>
</div>
<a id="aae7a3a76e08e54c618cf79b30ed2d73d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae7a3a76e08e54c618cf79b30ed2d73d">&#9670;&nbsp;</a></span>RemakeLevel()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::RemakeLevel </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::BoxArray &amp;&#160;</td>
          <td class="paramname"><em>ba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::DistributionMapping &amp;&#160;</td>
          <td class="paramname"><em>dm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;{</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a43d0b17f6e155691a1e9474526df3af5">verbose</a>) {</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        amrex::Print() &lt;&lt;<span class="stringliteral">&quot; REMAKING WITH NEW BA AT LEVEL &quot;</span> &lt;&lt; lev &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; ba &lt;&lt; std::endl;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    }</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160; </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    AMREX_ALWAYS_ASSERT(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> != TerrainType::MovingFittedMesh);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160; </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    BoxArray            ba_old(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].boxArray());</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    DistributionMapping dm_old(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].DistributionMap());</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a43d0b17f6e155691a1e9474526df3af5">verbose</a>) {</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        amrex::Print() &lt;&lt;<span class="stringliteral">&quot;               OLD BA AT LEVEL &quot;</span> &lt;&lt; lev &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; ba_old &lt;&lt; std::endl;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    }</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160; </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="keywordtype">int</span>     ncomp_cons  = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nComp();</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    IntVect ngrow_state = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nGrowVect();</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160; </div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="keywordtype">int</span> ngrow_vels = <a class="code" href="classERF.html#aaad87d9eb7e20af21deb83d72f94801c">ComputeGhostCells</a>(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160; </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    Vector&lt;MultiFab&gt; temp_lev_new(<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a5deccaa24d5e74279425d7749f7d1494">Vars::NumTypes</a>);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    Vector&lt;MultiFab&gt; temp_lev_old(<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a5deccaa24d5e74279425d7749f7d1494">Vars::NumTypes</a>);</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    MultiFab temp_base_state;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160; </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    std::unique_ptr&lt;MultiFab&gt; temp_zphys_nd;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160; </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="comment">//********************************************************************************************</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="comment">// This allocates all kinds of things, including but not limited to: solution arrays,</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="comment">//      terrain arrays and metrics, and base state.</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="comment">// *******************************************************************************************</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <a class="code" href="classERF.html#aaf237fbe118d80f149295c0579608579">init_stuff</a>(lev, ba, dm, temp_lev_new, temp_lev_old, temp_base_state, temp_zphys_nd);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="comment">// Build the data structures for terrain-related quantities</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> == TerrainType::EB ||</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;         <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> == TerrainType::ImmersedForcing)</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    {</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        <span class="keyword">const</span> amrex::EB2::IndexSpace&amp; ebis = amrex::EB2::IndexSpace::top();</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        <span class="keyword">const</span> EB2::Level&amp; eb_level = ebis.getLevel(geom[lev]);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> == TerrainType::EB) {</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;            <a class="code" href="classERF.html#a32317cbd11fb55fe60a00c0925189859">eb</a>[lev]-&gt;make_all_factories(lev, geom[lev], ba, dm, eb_level);</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> == TerrainType::ImmersedForcing) {</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            <a class="code" href="classERF.html#a32317cbd11fb55fe60a00c0925189859">eb</a>[lev]-&gt;make_cc_factory(lev, geom[lev], ba, dm, eb_level);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        }</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    }</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <a class="code" href="classERF.html#a691172d44ab3e8b4d6fb18c068cc1ab4">remake_zphys</a>(lev, time, temp_zphys_nd);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <a class="code" href="classERF.html#a7dba7f9e6bd3f6898fac9ac2efcec692">update_terrain_arrays</a>(lev);</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160; </div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="comment">// Make sure that detJ and z_phys_cc are the average of the data on a finer level if there is one</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structSolverChoice.html#a1952672901901b0b3a628f2298dc72c2">SolverChoice::mesh_type</a> != MeshType::ConstantDz) {</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> crse_lev = lev-1; crse_lev &gt;= 0; crse_lev--) {</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;            average_down(  *<a class="code" href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">detJ_cc</a>[crse_lev+1],   *<a class="code" href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">detJ_cc</a>[crse_lev], 0, 1, refRatio(crse_lev));</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;            average_down(*<a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[crse_lev+1], *<a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[crse_lev], 0, 1, refRatio(crse_lev));</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        }</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    }</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160; </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="comment">// Build the data structures for canopy model (depends upon z_phys)</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aed9118172b234c3a0069a78776d09baa">do_forest_drag</a>) {</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        <a class="code" href="classERF.html#a8b181e6ed0bb62d79e4a62555210abc9">m_forest_drag</a>[lev]-&gt;define_drag_field(ba, dm, geom[lev], <a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[lev].get(), <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev].get());</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    }</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160; </div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="comment">// *****************************************************************************************************</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="comment">// Create the physbcs objects (after initializing the terrain but before calling FillCoarsePatch</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="comment">// *****************************************************************************************************</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <a class="code" href="classERF.html#ac81ec7f74a1be1c4a1e6e15e08385ed5">make_physbcs</a>(lev);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160; </div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="comment">// Update the base state at this level by interpolation from coarser level AND copy</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="comment">//    from previous (pre-regrid) base_state array</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="keywordflow">if</span> (lev &gt; 0) {</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        Interpolater* mapper = &amp;cell_cons_interp;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160; </div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        Vector&lt;MultiFab*&gt; fmf = {&amp;<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev  ], &amp;<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev  ]};</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        Vector&lt;MultiFab*&gt; cmf = {&amp;<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev-1], &amp;<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev-1]};</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        Vector&lt;Real&gt; ftime    = {time, time};</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        Vector&lt;Real&gt; ctime    = {time, time};</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160; </div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        <span class="comment">// Call FillPatch which ASSUMES that all ghost cells at lev-1 have already been filled</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        FillPatchTwoLevels(temp_base_state, temp_base_state.nGrowVect(), IntVect(0,0,0),</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                           time, cmf, ctime, fmf, ftime,</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                           0, 0, temp_base_state.nComp(), geom[lev-1], geom[lev],</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                           refRatio(lev-1), mapper, <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>,</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                           <a class="code" href="namespaceBaseBCVars.html#a5dc17426e44fb9fc3f4606bf2a49c39fa130fa0d9896caf6fa4bd2af4e74a5bf6">BaseBCVars::rho0_bc_comp</a>);</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160; </div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        <span class="comment">// Impose bc&#39;s outside the domain</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        (*<a class="code" href="classERF.html#af4e7dc93dae16aa2cc94bbb20b699a6f">physbcs_base</a>[lev])(temp_base_state,0,temp_base_state.nComp(),<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].nGrowVect());</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160; </div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        <span class="comment">// *************************************************************************************************</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        <span class="comment">// This will fill the temporary MultiFabs with data from vars_new</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        <span class="comment">// NOTE: the momenta here are only used as scratch space, the momenta themselves are not fillpatched</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        <span class="comment">// NOTE: we must create the new base state before calling FillPatch because we will</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        <span class="comment">//       interpolate perturbational quantities</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        <span class="comment">// *************************************************************************************************</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        <a class="code" href="classERF.html#afded764725240c356faffa97dddbe03d">FillPatch</a>(lev, time, {&amp;temp_lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],&amp;temp_lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                              &amp;temp_lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],&amp;temp_lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>]},</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                             {&amp;temp_lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],&amp;<a class="code" href="classERF.html#a01f3db32272f53dc68025f0a98195e57">rU_new</a>[lev],&amp;<a class="code" href="classERF.html#a54e37988486ef96e55e84bd8e91bb688">rV_new</a>[lev],&amp;<a class="code" href="classERF.html#aa46c0b0d20525aed10f447923e54dde7">rW_new</a>[lev]},</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                             <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev], temp_base_state, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        temp_base_state.ParallelCopy(<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev],0,0,<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].nComp(),</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                                     <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].nGrowVect(),<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].nGrowVect());</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        temp_lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].ParallelCopy(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],0,0,ncomp_cons,ngrow_state,ngrow_state);</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        temp_lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].ParallelCopy(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],0,0,         1,ngrow_vels,ngrow_vels);</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        temp_lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>].ParallelCopy(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],0,0,         1,ngrow_vels,ngrow_vels);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160; </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        temp_lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].setVal(0.);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        temp_lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].ParallelCopy(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>],0,0,         1,</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                                              IntVect(ngrow_vels,ngrow_vels,0),IntVect(ngrow_vels,ngrow_vels,0));</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    }</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160; </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="comment">// Now swap the pointers since we needed both old and new in the FillPatch</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    std::swap(temp_base_state, <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev]);</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160; </div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="comment">// Copy from new into old just in case</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    MultiFab::Copy(temp_lev_old[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],temp_lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],0,0,ncomp_cons,ngrow_state);</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    MultiFab::Copy(temp_lev_old[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],temp_lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],0,0,         1,ngrow_vels);</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    MultiFab::Copy(temp_lev_old[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],temp_lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],0,0,         1,ngrow_vels);</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    MultiFab::Copy(temp_lev_old[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>],temp_lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>],0,0,         1,IntVect(ngrow_vels,ngrow_vels,0));</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160; </div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="comment">// Now swap the pointers</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> var_idx = 0; var_idx &lt; <a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a5deccaa24d5e74279425d7749f7d1494">Vars::NumTypes</a>; ++var_idx) {</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        std::swap(temp_lev_new[var_idx], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][var_idx]);</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        std::swap(temp_lev_old[var_idx], <a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev][var_idx]);</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    }</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160; </div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev] = time;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <a class="code" href="classERF.html#a7085d7d5fc94a0f84efc06957267d58e">t_old</a>[lev] = time - 1.e200;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160; </div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="comment">// Build the data structures for calculating diffusive/turbulent terms</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <a class="code" href="classERF.html#a419510fced05e9afc05c466beeeb66f7">update_diffusive_arrays</a>(lev, ba, dm);</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160; </div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="comment">//********************************************************************************************</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="comment">// Microphysics</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="comment">// *******************************************************************************************</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="keywordtype">int</span> q_size = <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;Get_Qmoist_Size(lev);</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <a class="code" href="classERF.html#ae00126a9c2738bf6a6cbbe77321c9cfc">qmoist</a>[lev].resize(q_size);</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;Define(lev, <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>);</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> != MoistureType::None)</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    {</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;Init(lev, <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                    grids[lev], Geom(lev), 0.0,</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                    <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev], <a class="code" href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">detJ_cc</a>[lev]); <span class="comment">// dummy dt value</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    }</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> mvar(0); mvar&lt;<a class="code" href="classERF.html#ae00126a9c2738bf6a6cbbe77321c9cfc">qmoist</a>[lev].size(); ++mvar) {</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        <a class="code" href="classERF.html#ae00126a9c2738bf6a6cbbe77321c9cfc">qmoist</a>[lev][mvar] = <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;Get_Qmoist_Ptr(lev,mvar);</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    }</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160; </div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="comment">// Initialize the integrator class</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <a class="code" href="classERF.html#a5600f8ce250d4811012719fdf5e85f00">initialize_integrator</a>(lev, <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>]);</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160; </div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="comment">// We need to re-define the FillPatcher if the grids have changed</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="keywordflow">if</span> (lev &gt; 0 &amp;&amp; <a class="code" href="classERF.html#ad9084179f7384e10a519989ffd51fd34">cf_width</a> &gt;= 0) {</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        <span class="keywordtype">bool</span> ba_changed = (ba != ba_old);</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        <span class="keywordtype">bool</span> dm_changed = (dm != dm_old);</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        <span class="keywordflow">if</span> (ba_changed || dm_changed) {</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;          <a class="code" href="classERF.html#ac0951404aa6802aad7a3be6b7375dfa2">Define_ERFFillPatchers</a>(lev);</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        }</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    }</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160; </div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <span class="comment">// Update the SurfaceLayer arrays at this level</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ae6df94c25ac21bf6a2e856a9901e3a15">phys_bc_type</a>[Orientation(Direction::z,Orientation::low)] == <a class="code" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9af69483cb4bb9623dc65e76ce5bd0a3d5">ERF_BC::surface_layer</a>) {</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        <span class="keywordtype">int</span> nlevs = finest_level+1;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        Vector&lt;MultiFab*&gt; mfv_old = {&amp;<a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], &amp;<a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                                     &amp;<a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>], &amp;<a class="code" href="classERF.html#af31e928baa970a1507dfb0233b352542">vars_old</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>]};</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        <a class="code" href="classERF.html#ac50bb696daf587e13f9a1e57c687375e">m_SurfaceLayer</a>-&gt;make_SurfaceLayer_at_level(lev,nlevs,</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                                                   mfv_old, <a class="code" href="classERF.html#a71629ae2fda396472198691b75d83b2e">Theta_prim</a>[lev], <a class="code" href="classERF.html#a521d1faf157e3bccc86c0f26ee923576">Qv_prim</a>[lev],</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                                                   <a class="code" href="classERF.html#a57d8432920785f8e58cf11a3232d76b5">Qr_prim</a>[lev], <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev],</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                                                   <a class="code" href="classERF.html#aef05cf88e9e9d2b56112336761493977">Hwave</a>[lev].get(),<a class="code" href="classERF.html#ad67b414a1a8b5bab6edeaf574f922825">Lwave</a>[lev].get(),<a class="code" href="classERF.html#a327d704704abd516be19339cb2d226f9">eddyDiffs_lev</a>[lev].get(),</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                                                   <a class="code" href="classERF.html#ad03da3399e893728741fac33100ce476">lsm_data</a>[lev], <a class="code" href="classERF.html#aa5f6a6ceae0087393f386649d8bbbc31">lsm_flux</a>[lev], <a class="code" href="classERF.html#a5a5395054a212d8f3fc577562c14b66e">sst_lev</a>[lev], <a class="code" href="classERF.html#af89fb8b555dde334c978cdfd3fcd9d07">tsk_lev</a>[lev], <a class="code" href="classERF.html#a3f3e29874221e43e13e2a431e77e0e4e">lmask_lev</a>[lev]);</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    }</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160; </div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="comment">// These calls are done in AmrCore::regrid if this is a regrid at lev &gt; 0</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="comment">// For a level 0 regrid we must explicitly do them here</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <span class="keywordflow">if</span> (lev == 0) {</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        <span class="comment">// Define grids[lev] to be ba</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        SetBoxArray(lev, ba);</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160; </div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        <span class="comment">// Define dmap[lev] to be dm</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        SetDistributionMap(lev, dm);</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    }</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160; </div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="preprocessor">#ifdef ERF_USE_PARTICLES</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    particleData.Redistribute();</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_a691172d44ab3e8b4d6fb18c068cc1ab4"><div class="ttname"><a href="classERF.html#a691172d44ab3e8b4d6fb18c068cc1ab4">ERF::remake_zphys</a></div><div class="ttdeci">void remake_zphys(int lev, amrex::Real time, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;temp_zphys_nd)</div><div class="ttdef"><b>Definition:</b> ERF_MakeNewArrays.cpp:585</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a530d2ce59e6fd46e9fb00e4d11eaf737"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a530d2ce59e6fd46e9fb00e4d11eaf737">&#9670;&nbsp;</a></span>restart()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::restart </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;{</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;    <a class="code" href="classERF.html#af285247b24b173cd851fe49799d17f42">ReadCheckpointFile</a>();</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160; </div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;    <span class="comment">// We set this here so that we don&#39;t over-write the checkpoint file we just started from</span></div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    <a class="code" href="classERF.html#a02722d16f3c26efe590702200f1296d7">last_check_file_step</a> = <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[0];</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160; </div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a833c301baf4bb3ee3c944faad7bf6ee7">regrid_level_0_on_restart</a>) {</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;        <span class="comment">// Coarsening before we split the grids ensures that each resulting</span></div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;        <span class="comment">// grid will have an even number of cells in each direction.</span></div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;        BoxArray new_ba(amrex::coarsen(Geom(0).Domain(),2));</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;        <span class="comment">// Now split up into list of grids within max_grid_size[0] limit.</span></div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;        new_ba.maxSize(max_grid_size[0]/2);</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;        <span class="comment">// Now refine these boxes back to level 0.</span></div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;        new_ba.refine(2);</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160; </div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;        <span class="keywordflow">if</span> (refine_grid_layout) {</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;            ChopGrids(0, new_ba, ParallelDescriptor::NProcs());</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;        }</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160; </div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;        <span class="keywordflow">if</span> (new_ba != grids[0]) {</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;            DistributionMapping new_dm(new_ba);</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;            <a class="code" href="classERF.html#aae7a3a76e08e54c618cf79b30ed2d73d">RemakeLevel</a>(0,<a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0],new_ba,new_dm);</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;        }</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;    }</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_aae7a3a76e08e54c618cf79b30ed2d73d"><div class="ttname"><a href="classERF.html#aae7a3a76e08e54c618cf79b30ed2d73d">ERF::RemakeLevel</a></div><div class="ttdeci">void RemakeLevel(int lev, amrex::Real time, const amrex::BoxArray &amp;ba, const amrex::DistributionMapping &amp;dm) override</div><div class="ttdef"><b>Definition:</b> ERF_MakeNewLevel.cpp:396</div></div>
<div class="ttc" id="aclassERF_html_af285247b24b173cd851fe49799d17f42"><div class="ttname"><a href="classERF.html#af285247b24b173cd851fe49799d17f42">ERF::ReadCheckpointFile</a></div><div class="ttdeci">void ReadCheckpointFile()</div><div class="ttdef"><b>Definition:</b> ERF_Checkpoint.cpp:419</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afb798c72ea4fde6f4da8d01a24c8c165"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb798c72ea4fde6f4da8d01a24c8c165">&#9670;&nbsp;</a></span>sample_lines()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::sample_lines </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::IntVect&#160;</td>
          <td class="paramname"><em>cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>mf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Utility function for sampling data along a line along the z-dimension at the (x,y) indices specified and writes it to an output file.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lev</td><td>Current level </td></tr>
    <tr><td class="paramname">time</td><td>Current time </td></tr>
    <tr><td class="paramname">cell</td><td>IntVect containing the x,y-dimension indices to sample along z </td></tr>
    <tr><td class="paramname">mf</td><td>MultiFab from which we sample the data </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;{</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <span class="keywordtype">int</span> ifile = 0;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160; </div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> ncomp = mf.nComp(); <span class="comment">// cell-centered state vars</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160; </div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    MultiFab mf_vels(grids[lev], dmap[lev], AMREX_SPACEDIM, 0);</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    average_face_to_cellcenter(mf_vels, 0,</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                               Array&lt;const MultiFab*,3&gt;{&amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],&amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],&amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>]});</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160; </div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <span class="comment">// Sample the data at a line (in direction &quot;dir&quot;) in space</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="comment">// In this case we sample in the vertical direction so dir = 2</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <span class="comment">// The &quot;k&quot; value of &quot;cell&quot; is ignored</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="keywordtype">int</span> dir = 2;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    MultiFab my_line       = get_line_data(mf,              dir, cell);</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    MultiFab my_line_vels  = get_line_data(mf_vels,         dir, cell);</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    MultiFab my_line_tau11 = get_line_data(*<a class="code" href="classERF.html#a3d4a3ed54fb357c02e6494461f182aa1">Tau</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248baab4c45b861caaf89b0842306117db7bc">TauType::tau11</a>], dir, cell);</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    MultiFab my_line_tau12 = get_line_data(*<a class="code" href="classERF.html#a3d4a3ed54fb357c02e6494461f182aa1">Tau</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248ba0a0d169ca6b3a0da988c65f1c284ba99">TauType::tau12</a>], dir, cell);</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    MultiFab my_line_tau13 = get_line_data(*<a class="code" href="classERF.html#a3d4a3ed54fb357c02e6494461f182aa1">Tau</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248baf5fa13cfd781cde0d363f337d7e76d7e">TauType::tau13</a>], dir, cell);</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    MultiFab my_line_tau22 = get_line_data(*<a class="code" href="classERF.html#a3d4a3ed54fb357c02e6494461f182aa1">Tau</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248ba822e4f59780df9310afede8535eac286">TauType::tau22</a>], dir, cell);</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    MultiFab my_line_tau23 = get_line_data(*<a class="code" href="classERF.html#a3d4a3ed54fb357c02e6494461f182aa1">Tau</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248ba181b302bd0f99081c3c22fa38e1f8b73">TauType::tau23</a>], dir, cell);</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    MultiFab my_line_tau33 = get_line_data(*<a class="code" href="classERF.html#a3d4a3ed54fb357c02e6494461f182aa1">Tau</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248ba1edaba247488baa9858b879f19ea09b7">TauType::tau33</a>], dir, cell);</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160; </div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="keywordflow">for</span> (MFIter mfi(my_line, <span class="keyword">false</span>); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    {</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        <span class="comment">// HERE DO WHATEVER YOU WANT TO THE DATA BEFORE WRITING</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160; </div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        std::ostream&amp; sample_log = <a class="code" href="classERF.html#aa559426d0435e669b04148c58b20caef">SampleLineLog</a>(ifile);</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        <span class="keywordflow">if</span> (sample_log.good()) {</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;          sample_log &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; std::setprecision(<a class="code" href="classERF.html#aefeb0bde962c9f53aba32e4ab59b4958">datprecision</a>) &lt;&lt; time;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;          <span class="keyword">const</span> <span class="keyword">auto</span>&amp; my_line_arr = my_line[0].const_array();</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;          <span class="keyword">const</span> <span class="keyword">auto</span>&amp; my_line_vels_arr = my_line_vels[0].const_array();</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;          <span class="keyword">const</span> <span class="keyword">auto</span>&amp; my_line_tau11_arr = my_line_tau11[0].const_array();</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;          <span class="keyword">const</span> <span class="keyword">auto</span>&amp; my_line_tau12_arr = my_line_tau12[0].const_array();</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;          <span class="keyword">const</span> <span class="keyword">auto</span>&amp; my_line_tau13_arr = my_line_tau13[0].const_array();</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;          <span class="keyword">const</span> <span class="keyword">auto</span>&amp; my_line_tau22_arr = my_line_tau22[0].const_array();</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;          <span class="keyword">const</span> <span class="keyword">auto</span>&amp; my_line_tau23_arr = my_line_tau23[0].const_array();</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;          <span class="keyword">const</span> <span class="keyword">auto</span>&amp; my_line_tau33_arr = my_line_tau33[0].const_array();</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;          <span class="keyword">const</span> Box&amp;  my_box = my_line[0].box();</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">int</span> klo = my_box.smallEnd(2);</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">int</span> khi = my_box.bigEnd(2);</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;          <span class="keywordtype">int</span> i = cell[0];</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;          <span class="keywordtype">int</span> j = cell[1];</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; ncomp; n++) {</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = klo; k &lt;= khi; k++) {</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                  sample_log &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; std::setprecision(<a class="code" href="classERF.html#aefeb0bde962c9f53aba32e4ab59b4958">datprecision</a>) &lt;&lt; my_line_arr(i,j,k,n);</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;              }</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;          }</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; AMREX_SPACEDIM; n++) {</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = klo; k &lt;= khi; k++) {</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                  sample_log &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; std::setprecision(<a class="code" href="classERF.html#aefeb0bde962c9f53aba32e4ab59b4958">datprecision</a>) &lt;&lt; my_line_vels_arr(i,j,k,n);</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;              }</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;          }</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = klo; k &lt;= khi; k++) {</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;              sample_log &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; std::setprecision(<a class="code" href="classERF.html#aefeb0bde962c9f53aba32e4ab59b4958">datprecision</a>) &lt;&lt; my_line_tau11_arr(i,j,k);</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;          }</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = klo; k &lt;= khi; k++) {</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;              sample_log &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; std::setprecision(<a class="code" href="classERF.html#aefeb0bde962c9f53aba32e4ab59b4958">datprecision</a>) &lt;&lt; my_line_tau12_arr(i,j,k);</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;          }</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = klo; k &lt;= khi; k++) {</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;              sample_log &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; std::setprecision(<a class="code" href="classERF.html#aefeb0bde962c9f53aba32e4ab59b4958">datprecision</a>) &lt;&lt; my_line_tau13_arr(i,j,k);</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;          }</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = klo; k &lt;= khi; k++) {</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;              sample_log &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; std::setprecision(<a class="code" href="classERF.html#aefeb0bde962c9f53aba32e4ab59b4958">datprecision</a>) &lt;&lt; my_line_tau22_arr(i,j,k);</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;          }</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = klo; k &lt;= khi; k++) {</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;              sample_log &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; std::setprecision(<a class="code" href="classERF.html#aefeb0bde962c9f53aba32e4ab59b4958">datprecision</a>) &lt;&lt; my_line_tau23_arr(i,j,k);</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;          }</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = klo; k &lt;= khi; k++) {</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;              sample_log &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; std::setprecision(<a class="code" href="classERF.html#aefeb0bde962c9f53aba32e4ab59b4958">datprecision</a>) &lt;&lt; my_line_tau33_arr(i,j,k);</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;          }</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;          sample_log &lt;&lt; std::endl;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;        } <span class="comment">// if good</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    } <span class="comment">// mfi</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_a8b1cdf332a93c6b0889fd309e43f9a91"><div class="ttname"><a href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">ERF::datwidth</a></div><div class="ttdeci">const int datwidth</div><div class="ttdef"><b>Definition:</b> ERF.H:885</div></div>
<div class="ttc" id="aclassERF_html_aa559426d0435e669b04148c58b20caef"><div class="ttname"><a href="classERF.html#aa559426d0435e669b04148c58b20caef">ERF::SampleLineLog</a></div><div class="ttdeci">AMREX_FORCE_INLINE std::ostream &amp; SampleLineLog(int i)</div><div class="ttdef"><b>Definition:</b> ERF.H:1280</div></div>
<div class="ttc" id="aclassERF_html_aefeb0bde962c9f53aba32e4ab59b4958"><div class="ttname"><a href="classERF.html#aefeb0bde962c9f53aba32e4ab59b4958">ERF::datprecision</a></div><div class="ttdeci">const int datprecision</div><div class="ttdef"><b>Definition:</b> ERF.H:886</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa28182226262c67cfd686d35bfeabcad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa28182226262c67cfd686d35bfeabcad">&#9670;&nbsp;</a></span>sample_points()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::sample_points </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::IntVect&#160;</td>
          <td class="paramname"><em>cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>mf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Utility function for sampling MultiFab data at a specified cell index.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lev</td><td>Level for the associated MultiFab data </td></tr>
    <tr><td class="paramname">time</td><td>Current time </td></tr>
    <tr><td class="paramname">cell</td><td>IntVect containing the indexes for the cell where we want to sample </td></tr>
    <tr><td class="paramname">mf</td><td>MultiFab from which we wish to sample data </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;{</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="keywordtype">int</span> ifile = 0;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160; </div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="comment">// Sample the data at a single point in space</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="keywordtype">int</span> ncomp = mf.nComp();</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    Vector&lt;Real&gt; my_point = get_cell_data(mf, cell);</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160; </div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="keywordflow">if</span> (!my_point.empty()) {</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160; </div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        <span class="comment">// HERE DO WHATEVER YOU WANT TO THE DATA BEFORE WRITING</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160; </div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        std::ostream&amp; sample_log = <a class="code" href="classERF.html#af5f6c32cc5463e52901f21117d3156c7">SamplePointLog</a>(ifile);</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        <span class="keywordflow">if</span> (sample_log.good()) {</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;          sample_log &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; time;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ncomp; ++i)</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;          {</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;              sample_log &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; my_point[i];</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;          }</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;          sample_log &lt;&lt; std::endl;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        } <span class="comment">// if good</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    } <span class="comment">// only write from processor that holds the cell</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_af5f6c32cc5463e52901f21117d3156c7"><div class="ttname"><a href="classERF.html#af5f6c32cc5463e52901f21117d3156c7">ERF::SamplePointLog</a></div><div class="ttdeci">AMREX_FORCE_INLINE std::ostream &amp; SamplePointLog(int i)</div><div class="ttdef"><b>Definition:</b> ERF.H:1266</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a54357e2f81f3d7d3a9189a3e21283e6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54357e2f81f3d7d3a9189a3e21283e6b">&#9670;&nbsp;</a></span>SampleLine()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::IntVect&amp; ERF::SampleLine </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    {</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classERF.html#a0fa1582bb13357895d2aba91b695624a">sampleline</a>[i];</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa559426d0435e669b04148c58b20caef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa559426d0435e669b04148c58b20caef">&#9670;&nbsp;</a></span>SampleLineLog()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">AMREX_FORCE_INLINE std::ostream&amp; ERF::SampleLineLog </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;    {</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;        <span class="keywordflow">return</span> *<a class="code" href="classERF.html#a4990f1796b65ec8ee602f177a66afc3e">samplelinelog</a>[i];</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a59eae161173111d66e88dc3acc65b552"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59eae161173111d66e88dc3acc65b552">&#9670;&nbsp;</a></span>SampleLineLogName()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ERF::SampleLineLogName </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The filename of the ith samplelinelog file. </p>
<div class="fragment"><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classERF.html#a0553967f1131860bb8ecb47c0f192eaa">samplelinelogname</a>[i]; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9095d1b641b4d7f32ca5acb679786891"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9095d1b641b4d7f32ca5acb679786891">&#9670;&nbsp;</a></span>SamplePoint()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::IntVect&amp; ERF::SamplePoint </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    {</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classERF.html#ae8a57b7fbf5a67c99d04b7d4f43ad100">samplepoint</a>[i];</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="af5f6c32cc5463e52901f21117d3156c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5f6c32cc5463e52901f21117d3156c7">&#9670;&nbsp;</a></span>SamplePointLog()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">AMREX_FORCE_INLINE std::ostream&amp; ERF::SamplePointLog </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;    {</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;        <span class="keywordflow">return</span> *<a class="code" href="classERF.html#a9737ddb0de6b9e8a5b17c109d5ad3e08">sampleptlog</a>[i];</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa87242f053bfae4efb2a7698ef417ab9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa87242f053bfae4efb2a7698ef417ab9">&#9670;&nbsp;</a></span>SamplePointLogName()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ERF::SamplePointLogName </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The filename of the ith sampleptlog file. </p>
<div class="fragment"><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classERF.html#a8fbfa8bb47c0a3b53e244081aa1e8ad3">sampleptlogname</a>[i]; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1fcb440c67da60c86372aec1fe871cb7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1fcb440c67da60c86372aec1fe871cb7">&#9670;&nbsp;</a></span>setPlotVariables()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::setPlotVariables </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>pp_plot_var_names</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>plot_var_names</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;{</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    ParmParse <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>(<a class="code" href="classERF.html#a59df30e7a5537c8543bb00772bd98b58">pp_prefix</a>);</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.contains(pp_plot_var_names.c_str()))</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    {</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        std::string nm;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        <span class="keywordtype">int</span> nPltVars = <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.countval(pp_plot_var_names.c_str());</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nPltVars; i++)</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        {</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;            <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.get(pp_plot_var_names.c_str(), nm, i);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;            <span class="comment">// Add the named variable to our list of plot variables</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;            <span class="comment">// if it is not already in the list</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, nm)) {</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;                plot_var_names.push_back(nm);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;            }</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        }</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        <span class="comment">// The default is to add none of the variables to the list</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        plot_var_names.clear();</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    }</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="comment">// Get state variables in the same order as we define them,</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="comment">// since they may be in any order in the input list</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    Vector&lt;std::string&gt; tmp_plot_names;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classERF.html#afd8cd5a477754776135befa668fdd0c9">cons_names</a>.size(); ++i) {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <a class="code" href="classERF.html#afd8cd5a477754776135befa668fdd0c9">cons_names</a>[i]) ) {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> == MoistureType::None) {</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classERF.html#afd8cd5a477754776135befa668fdd0c9">cons_names</a>[i] != <span class="stringliteral">&quot;rhoQ1&quot;</span> &amp;&amp; <a class="code" href="classERF.html#afd8cd5a477754776135befa668fdd0c9">cons_names</a>[i] != <span class="stringliteral">&quot;rhoQ2&quot;</span> &amp;&amp; <a class="code" href="classERF.html#afd8cd5a477754776135befa668fdd0c9">cons_names</a>[i] != <span class="stringliteral">&quot;rhoQ3&quot;</span> &amp;&amp;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                    <a class="code" href="classERF.html#afd8cd5a477754776135befa668fdd0c9">cons_names</a>[i] != <span class="stringliteral">&quot;rhoQ4&quot;</span> &amp;&amp; <a class="code" href="classERF.html#afd8cd5a477754776135befa668fdd0c9">cons_names</a>[i] != <span class="stringliteral">&quot;rhoQ5&quot;</span> &amp;&amp; <a class="code" href="classERF.html#afd8cd5a477754776135befa668fdd0c9">cons_names</a>[i] != <span class="stringliteral">&quot;rhoQ6&quot;</span>)</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                    tmp_plot_names.push_back(<a class="code" href="classERF.html#afd8cd5a477754776135befa668fdd0c9">cons_names</a>[i]);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                }</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> == MoistureType::Kessler) { <span class="comment">// allow rhoQ1, rhoQ2, rhoQ3</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classERF.html#afd8cd5a477754776135befa668fdd0c9">cons_names</a>[i] != <span class="stringliteral">&quot;rhoQ4&quot;</span> &amp;&amp; <a class="code" href="classERF.html#afd8cd5a477754776135befa668fdd0c9">cons_names</a>[i] != <span class="stringliteral">&quot;rhoQ5&quot;</span> &amp;&amp; <a class="code" href="classERF.html#afd8cd5a477754776135befa668fdd0c9">cons_names</a>[i] != <span class="stringliteral">&quot;rhoQ6&quot;</span>)</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                    tmp_plot_names.push_back(<a class="code" href="classERF.html#afd8cd5a477754776135befa668fdd0c9">cons_names</a>[i]);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                }</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> == MoistureType::SatAdj) ||</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                        (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> == MoistureType::SAM_NoPrecip_NoIce) ||</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                        (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> == MoistureType::Kessler_NoRain) ) { <span class="comment">// allow rhoQ1, rhoQ2</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classERF.html#afd8cd5a477754776135befa668fdd0c9">cons_names</a>[i] != <span class="stringliteral">&quot;rhoQ3&quot;</span> &amp;&amp; <a class="code" href="classERF.html#afd8cd5a477754776135befa668fdd0c9">cons_names</a>[i] != <span class="stringliteral">&quot;rhoQ4&quot;</span> &amp;&amp;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                    <a class="code" href="classERF.html#afd8cd5a477754776135befa668fdd0c9">cons_names</a>[i] != <span class="stringliteral">&quot;rhoQ5&quot;</span> &amp;&amp; <a class="code" href="classERF.html#afd8cd5a477754776135befa668fdd0c9">cons_names</a>[i] != <span class="stringliteral">&quot;rhoQ6&quot;</span>)</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                    tmp_plot_names.push_back(<a class="code" href="classERF.html#afd8cd5a477754776135befa668fdd0c9">cons_names</a>[i]);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                }</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> == MoistureType::Morrison_NoIce) ||</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                        (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> == MoistureType::SAM_NoIce     ) ) { <span class="comment">// allow rhoQ1, rhoQ2, rhoQ4</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classERF.html#afd8cd5a477754776135befa668fdd0c9">cons_names</a>[i] != <span class="stringliteral">&quot;rhoQ3&quot;</span> &amp;&amp; <a class="code" href="classERF.html#afd8cd5a477754776135befa668fdd0c9">cons_names</a>[i] != <span class="stringliteral">&quot;rhoQ5&quot;</span> &amp;&amp; <a class="code" href="classERF.html#afd8cd5a477754776135befa668fdd0c9">cons_names</a>[i] != <span class="stringliteral">&quot;rhoQ6&quot;</span>)</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                    tmp_plot_names.push_back(<a class="code" href="classERF.html#afd8cd5a477754776135befa668fdd0c9">cons_names</a>[i]);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                }</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            } <span class="keywordflow">else</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                <span class="comment">// For moisture_type SAM and Morrison we have all six variables</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                tmp_plot_names.push_back(<a class="code" href="classERF.html#afd8cd5a477754776135befa668fdd0c9">cons_names</a>[i]);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;            }</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        }</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    }</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="comment">// check for velocity since it&#39;s not in cons_names</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="comment">// if we are asked for any velocity component, we will need them all</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;x_velocity&quot;</span>) ||</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;y_velocity&quot;</span>) ||</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;z_velocity&quot;</span>)) {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        tmp_plot_names.push_back(<span class="stringliteral">&quot;x_velocity&quot;</span>);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        tmp_plot_names.push_back(<span class="stringliteral">&quot;y_velocity&quot;</span>);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        tmp_plot_names.push_back(<span class="stringliteral">&quot;z_velocity&quot;</span>);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    }</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="comment">// If the model we are running doesn&#39;t have the variable listed in the inputs file,</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="comment">//     just ignore it rather than aborting</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a>.size(); ++i) {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <a class="code" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a>[i]) ) {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            <span class="keywordtype">bool</span> ok_to_add = ( (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> == TerrainType::ImmersedForcing) ||</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                               (<a class="code" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a>[i] != <span class="stringliteral">&quot;terrain_IB_mask&quot;</span>) );</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;            ok_to_add     &amp;= ( (<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">SolverChoice::terrain_type</a> == TerrainType::StaticFittedMesh) ||</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                               (<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">SolverChoice::terrain_type</a> == TerrainType::MovingFittedMesh) ||</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                               (<a class="code" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a>[i] != <span class="stringliteral">&quot;detJ&quot;</span>) );</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;            ok_to_add     &amp;= ( (<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">SolverChoice::terrain_type</a> == TerrainType::StaticFittedMesh) ||</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                               (<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">SolverChoice::terrain_type</a> == TerrainType::MovingFittedMesh) ||</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                               (<a class="code" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a>[i] != <span class="stringliteral">&quot;z_phys&quot;</span>) );</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="preprocessor">#ifndef ERF_USE_WINDFARM</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            ok_to_add     &amp;= (<a class="code" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a>[i] != <span class="stringliteral">&quot;SMark0&quot;</span> &amp;&amp; <a class="code" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a>[i] != <span class="stringliteral">&quot;SMark1&quot;</span>);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            <span class="keywordflow">if</span> (ok_to_add)</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> == MoistureType::None) { <span class="comment">// no moist quantities allowed</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a>[i] != <span class="stringliteral">&quot;qv&quot;</span> &amp;&amp; <a class="code" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a>[i] != <span class="stringliteral">&quot;qc&quot;</span>    &amp;&amp; <a class="code" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a>[i] != <span class="stringliteral">&quot;qrain&quot;</span>  &amp;&amp;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                        <a class="code" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a>[i] != <span class="stringliteral">&quot;qi&quot;</span> &amp;&amp; <a class="code" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a>[i] != <span class="stringliteral">&quot;qsnow&quot;</span> &amp;&amp; <a class="code" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a>[i] != <span class="stringliteral">&quot;qgraup&quot;</span> &amp;&amp;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                        <a class="code" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a>[i] != <span class="stringliteral">&quot;rain_accum&quot;</span> &amp;&amp; <a class="code" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a>[i] != <span class="stringliteral">&quot;snow_accum&quot;</span> &amp;&amp; <a class="code" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a>[i] != <span class="stringliteral">&quot;graup_accum&quot;</span>)</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                    {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                        tmp_plot_names.push_back(<a class="code" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a>[i]);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                    }</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> == MoistureType::Kessler       ) ||</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                            (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> == MoistureType::Morrison_NoIce) ||</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                            (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> == MoistureType::SAM_NoIce     ) ) { <span class="comment">// allow qv, qc, qrain</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a>[i] != <span class="stringliteral">&quot;qi&quot;</span> &amp;&amp; <a class="code" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a>[i] != <span class="stringliteral">&quot;qsnow&quot;</span> &amp;&amp; <a class="code" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a>[i] != <span class="stringliteral">&quot;qgraup&quot;</span> &amp;&amp;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                        <a class="code" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a>[i] != <span class="stringliteral">&quot;snow_accum&quot;</span> &amp;&amp; <a class="code" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a>[i] != <span class="stringliteral">&quot;graup_accum&quot;</span>)</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                    {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                        tmp_plot_names.push_back(<a class="code" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a>[i]);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                    }</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> == MoistureType::SatAdj) ||</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                            (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> == MoistureType::SAM_NoPrecip_NoIce) ||</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                            (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> == MoistureType::Kessler_NoRain) ) { <span class="comment">// allow qv, qc</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a>[i] != <span class="stringliteral">&quot;qrain&quot;</span>  &amp;&amp;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                        <a class="code" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a>[i] != <span class="stringliteral">&quot;qi&quot;</span> &amp;&amp; <a class="code" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a>[i] != <span class="stringliteral">&quot;qsnow&quot;</span> &amp;&amp; <a class="code" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a>[i] != <span class="stringliteral">&quot;qgraup&quot;</span> &amp;&amp;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                        <a class="code" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a>[i] != <span class="stringliteral">&quot;rain_accum&quot;</span> &amp;&amp; <a class="code" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a>[i] != <span class="stringliteral">&quot;snow_accum&quot;</span> &amp;&amp; <a class="code" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a>[i] != <span class="stringliteral">&quot;graup_accum&quot;</span>)</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                    {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                        tmp_plot_names.push_back(<a class="code" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a>[i]);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                    }</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                } <span class="keywordflow">else</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                    <span class="comment">// For moisture_type SAM and Morrison we have all moist quantities</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                    tmp_plot_names.push_back(<a class="code" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a>[i]);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                }</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            } <span class="comment">// use_terrain?</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        } <span class="comment">// hasElement</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    }</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160; </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="preprocessor">#ifdef ERF_USE_WINDFARM</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a>.size(); ++i) {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <a class="code" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a>[i]) ) {</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac0a723e8797cdc0fe06b3fc781fca645">windfarm_type</a> == WindFarmType::Fitch or <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac0a723e8797cdc0fe06b3fc781fca645">windfarm_type</a> == WindFarmType::EWP) {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a>[i] == <span class="stringliteral">&quot;num_turb&quot;</span> or <a class="code" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a>[i] == <span class="stringliteral">&quot;SMark0&quot;</span>) {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                    tmp_plot_names.push_back(<a class="code" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a>[i]);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                }</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            }</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            <span class="keywordflow">if</span>( <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac0a723e8797cdc0fe06b3fc781fca645">windfarm_type</a> == WindFarmType::SimpleAD or</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac0a723e8797cdc0fe06b3fc781fca645">windfarm_type</a> == WindFarmType::GeneralAD ) {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a>[i] == <span class="stringliteral">&quot;num_turb&quot;</span> or <a class="code" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a>[i] == <span class="stringliteral">&quot;SMark0&quot;</span> or <a class="code" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a>[i] == <span class="stringliteral">&quot;SMark1&quot;</span>) {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                    tmp_plot_names.push_back(<a class="code" href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">derived_names</a>[i]);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                }</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            }</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        }</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    }</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="preprocessor">#ifdef ERF_USE_PARTICLES</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; particles_namelist( particleData.getNamesUnalloc() );</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = particles_namelist.cbegin(); it != particles_namelist.cend(); ++it) {</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        std::string tmp( (*it)+<span class="stringliteral">&quot;_count&quot;</span> );</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, tmp) ) {</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            tmp_plot_names.push_back(tmp);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        }</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    }</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    plot_var_names = tmp_plot_names;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_a9fc0f6e6ca35036d2e3a36dd42e66435"><div class="ttname"><a href="classERF.html#a9fc0f6e6ca35036d2e3a36dd42e66435">ERF::derived_names</a></div><div class="ttdeci">const amrex::Vector&lt; std::string &gt; derived_names</div><div class="ttdef"><b>Definition:</b> ERF.H:956</div></div>
<div class="ttc" id="aclassERF_html_afd8cd5a477754776135befa668fdd0c9"><div class="ttname"><a href="classERF.html#afd8cd5a477754776135befa668fdd0c9">ERF::cons_names</a></div><div class="ttdeci">const amrex::Vector&lt; std::string &gt; cons_names</div><div class="ttdef"><b>Definition:</b> ERF.H:951</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a1fcb440c67da60c86372aec1fe871cb7_cgraph.png" border="0" usemap="#aclassERF_a1fcb440c67da60c86372aec1fe871cb7_cgraph" alt=""/></div>
<map name="aclassERF_a1fcb440c67da60c86372aec1fe871cb7_cgraph" id="aclassERF_a1fcb440c67da60c86372aec1fe871cb7_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,164,57"/>
<area shape="rect" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67" title=" " alt="" coords="212,5,375,32"/>
<area shape="rect" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469" title=" " alt="" coords="274,56,313,83"/>
</map>
</div>

</div>
</div>
<a id="a0877d5a0263641c13b92d2d16f47b689"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0877d5a0263641c13b92d2d16f47b689">&#9670;&nbsp;</a></span>setRayleighRefFromSounding()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::setRayleighRefFromSounding </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>restarting</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set Rayleigh mean profiles from input sounding. </p>
<p>Sets the Rayleigh Damping averaged quantities from an externally supplied input sounding data file.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">restarting</td><td>Boolean parameter that indicates whether we are currently restarting from a checkpoint file. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;{</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="comment">// If we are restarting then we haven&#39;t read the input_sounding file yet</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="comment">//    so we need to read it here</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="comment">// TODO: should we store this information in the checkpoint file instead?</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keywordflow">if</span> (restarting) {</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <a class="code" href="classERF.html#a83572d8dfad51158945b4a5ab06b2f72">input_sounding_data</a>.<a class="code" href="structInputSoundingData.html#a42fe67445aa283176274575444cbf7ef">resize_arrays</a>();</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; <a class="code" href="classERF.html#a83572d8dfad51158945b4a5ab06b2f72">input_sounding_data</a>.<a class="code" href="structInputSoundingData.html#a5655f2f77d75c1b8a2abd92a0b264813">n_sounding_files</a>; n++) {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;            <a class="code" href="classERF.html#a83572d8dfad51158945b4a5ab06b2f72">input_sounding_data</a>.<a class="code" href="structInputSoundingData.html#a6742e8e0e37fd817097963bbd965692c">read_from_file</a>(geom[0], <a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[0], n);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        }</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    }</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keyword">const</span> Real* z_inp_sound     = <a class="code" href="classERF.html#a83572d8dfad51158945b4a5ab06b2f72">input_sounding_data</a>.<a class="code" href="structInputSoundingData.html#a9f73eb54af79291b72454e2840455b71">z_inp_sound</a>[0].dataPtr();</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keyword">const</span> Real* U_inp_sound     = <a class="code" href="classERF.html#a83572d8dfad51158945b4a5ab06b2f72">input_sounding_data</a>.<a class="code" href="structInputSoundingData.html#acaca35a2682754cb6faa44e1958fba8b">U_inp_sound</a>[0].dataPtr();</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keyword">const</span> Real* V_inp_sound     = <a class="code" href="classERF.html#a83572d8dfad51158945b4a5ab06b2f72">input_sounding_data</a>.<a class="code" href="structInputSoundingData.html#adba2e69559670861133145572ed6aa2a">V_inp_sound</a>[0].dataPtr();</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keyword">const</span> Real* theta_inp_sound = <a class="code" href="classERF.html#a83572d8dfad51158945b4a5ab06b2f72">input_sounding_data</a>.<a class="code" href="structInputSoundingData.html#a7cde9c67da9ade1d385047732b106943">theta_inp_sound</a>[0].dataPtr();</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span>   inp_sound_size  = <a class="code" href="classERF.html#a83572d8dfad51158945b4a5ab06b2f72">input_sounding_data</a>.<a class="code" href="structInputSoundingData.html#ae67ebe7a35af74165a1d2e7ee31a1bbc">size</a>(0);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordtype">int</span> refine_fac{1};</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; lev++)</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> klo = geom[lev].Domain().smallEnd(2);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> khi = geom[lev].Domain().bigEnd(2);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> Nz = khi - klo + 1;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        Vector&lt;Real&gt; zcc(Nz);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        Vector&lt;Real&gt; zlevels_sub(<a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[0].begin()+klo/refine_fac,</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                                 <a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[0].begin()+khi/refine_fac+2);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <a class="code" href="ERF__Interpolation__1D_8H.html#af71b362e58803c8c29aa5127adcf645f">expand_and_interpolate_1d</a>(zcc, zlevels_sub, refine_fac, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="preprocessor">#if 0</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        amrex::AllPrint() &lt;&lt; <span class="stringliteral">&quot;lev=&quot;</span>&lt;&lt;lev&lt;&lt;<span class="stringliteral">&quot; : (refine_fac=&quot;</span>&lt;&lt;refine_fac&lt;&lt;<span class="stringliteral">&quot;,klo=&quot;</span>&lt;&lt;klo&lt;&lt;<span class="stringliteral">&quot;,khi=&quot;</span>&lt;&lt;khi&lt;&lt;<span class="stringliteral">&quot;) &quot;</span>;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; zlevels_sub.size(); k++) { amrex::AllPrint() &lt;&lt; zlevels_sub[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>; }</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        amrex::AllPrint() &lt;&lt; <span class="stringliteral">&quot; --&gt; &quot;</span>;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; Nz; k++) { amrex::AllPrint() &lt;&lt; zcc[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>; }</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        amrex::AllPrint() &lt;&lt; std::endl;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; Nz; k++)</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            <a class="code" href="classERF.html#ad9939824ea7b7d06ab252fed28d5a911">h_rayleigh_ptrs</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a3d2cdf8cea6cb933d4ce759c1ff1b948">Rayleigh::ubar</a>][k]     = <a class="code" href="ERF__Interpolation__1D_8H.html#a803d0d35d4ca4791556cbe02bbf51cbb">interpolate_1d</a>(z_inp_sound, U_inp_sound, zcc[k], inp_sound_size);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            <a class="code" href="classERF.html#ad9939824ea7b7d06ab252fed28d5a911">h_rayleigh_ptrs</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239acb08c6a1b8bca5e9e4ef6162aef2cfa4">Rayleigh::vbar</a>][k]     = <a class="code" href="ERF__Interpolation__1D_8H.html#a803d0d35d4ca4791556cbe02bbf51cbb">interpolate_1d</a>(z_inp_sound, V_inp_sound, zcc[k], inp_sound_size);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            <a class="code" href="classERF.html#ad9939824ea7b7d06ab252fed28d5a911">h_rayleigh_ptrs</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a3d8bd6001a2421b06c3ec4e9f2dcdffd">Rayleigh::wbar</a>][k]     = Real(0.0);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            <a class="code" href="classERF.html#ad9939824ea7b7d06ab252fed28d5a911">h_rayleigh_ptrs</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239ae41e9f65f26ee3b04db07f2db7f28bdb">Rayleigh::thetabar</a>][k] = <a class="code" href="ERF__Interpolation__1D_8H.html#a803d0d35d4ca4791556cbe02bbf51cbb">interpolate_1d</a>(z_inp_sound, theta_inp_sound, zcc[k], inp_sound_size);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        }</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <span class="comment">// Copy from host version to device version</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        Gpu::copy(Gpu::hostToDevice, <a class="code" href="classERF.html#ad9939824ea7b7d06ab252fed28d5a911">h_rayleigh_ptrs</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a3d2cdf8cea6cb933d4ce759c1ff1b948">Rayleigh::ubar</a>].begin(), <a class="code" href="classERF.html#ad9939824ea7b7d06ab252fed28d5a911">h_rayleigh_ptrs</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a3d2cdf8cea6cb933d4ce759c1ff1b948">Rayleigh::ubar</a>].end(),</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                         <a class="code" href="classERF.html#ad598bde8e728479faaa7c2820096b47a">d_rayleigh_ptrs</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a3d2cdf8cea6cb933d4ce759c1ff1b948">Rayleigh::ubar</a>].begin());</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        Gpu::copy(Gpu::hostToDevice, <a class="code" href="classERF.html#ad9939824ea7b7d06ab252fed28d5a911">h_rayleigh_ptrs</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239acb08c6a1b8bca5e9e4ef6162aef2cfa4">Rayleigh::vbar</a>].begin(), <a class="code" href="classERF.html#ad9939824ea7b7d06ab252fed28d5a911">h_rayleigh_ptrs</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239acb08c6a1b8bca5e9e4ef6162aef2cfa4">Rayleigh::vbar</a>].end(),</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                         <a class="code" href="classERF.html#ad598bde8e728479faaa7c2820096b47a">d_rayleigh_ptrs</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239acb08c6a1b8bca5e9e4ef6162aef2cfa4">Rayleigh::vbar</a>].begin());</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        Gpu::copy(Gpu::hostToDevice, <a class="code" href="classERF.html#ad9939824ea7b7d06ab252fed28d5a911">h_rayleigh_ptrs</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a3d8bd6001a2421b06c3ec4e9f2dcdffd">Rayleigh::wbar</a>].begin(), <a class="code" href="classERF.html#ad9939824ea7b7d06ab252fed28d5a911">h_rayleigh_ptrs</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a3d8bd6001a2421b06c3ec4e9f2dcdffd">Rayleigh::wbar</a>].end(),</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                         <a class="code" href="classERF.html#ad598bde8e728479faaa7c2820096b47a">d_rayleigh_ptrs</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239a3d8bd6001a2421b06c3ec4e9f2dcdffd">Rayleigh::wbar</a>].begin());</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        Gpu::copy(Gpu::hostToDevice, <a class="code" href="classERF.html#ad9939824ea7b7d06ab252fed28d5a911">h_rayleigh_ptrs</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239ae41e9f65f26ee3b04db07f2db7f28bdb">Rayleigh::thetabar</a>].begin(), <a class="code" href="classERF.html#ad9939824ea7b7d06ab252fed28d5a911">h_rayleigh_ptrs</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239ae41e9f65f26ee3b04db07f2db7f28bdb">Rayleigh::thetabar</a>].end(),</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                         <a class="code" href="classERF.html#ad598bde8e728479faaa7c2820096b47a">d_rayleigh_ptrs</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a3856c8a2f055327ada182186bfd70239ae41e9f65f26ee3b04db07f2db7f28bdb">Rayleigh::thetabar</a>].begin());</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        refine_fac *= ref_ratio[lev][2];</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    }</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;}</div>
<div class="ttc" id="aERF__Interpolation__1D_8H_html_af71b362e58803c8c29aa5127adcf645f"><div class="ttname"><a href="ERF__Interpolation__1D_8H.html#af71b362e58803c8c29aa5127adcf645f">expand_and_interpolate_1d</a></div><div class="ttdeci">AMREX_FORCE_INLINE void expand_and_interpolate_1d(amrex::Vector&lt; amrex::Real &gt; &amp;znew, const amrex::Vector&lt; amrex::Real &gt; &amp;zorig, int refine_fac, bool destag=false)</div><div class="ttdef"><b>Definition:</b> ERF_Interpolation_1D.H:85</div></div>
<div class="ttc" id="astructInputSoundingData_html_a7cde9c67da9ade1d385047732b106943"><div class="ttname"><a href="structInputSoundingData.html#a7cde9c67da9ade1d385047732b106943">InputSoundingData::theta_inp_sound</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; amrex::Real &gt; &gt; theta_inp_sound</div><div class="ttdef"><b>Definition:</b> ERF_InputSoundingData.H:323</div></div>
<div class="ttc" id="astructInputSoundingData_html_a9f73eb54af79291b72454e2840455b71"><div class="ttname"><a href="structInputSoundingData.html#a9f73eb54af79291b72454e2840455b71">InputSoundingData::z_inp_sound</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; amrex::Real &gt; &gt; z_inp_sound</div><div class="ttdef"><b>Definition:</b> ERF_InputSoundingData.H:323</div></div>
<div class="ttc" id="astructInputSoundingData_html_acaca35a2682754cb6faa44e1958fba8b"><div class="ttname"><a href="structInputSoundingData.html#acaca35a2682754cb6faa44e1958fba8b">InputSoundingData::U_inp_sound</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; amrex::Real &gt; &gt; U_inp_sound</div><div class="ttdef"><b>Definition:</b> ERF_InputSoundingData.H:323</div></div>
<div class="ttc" id="astructInputSoundingData_html_adba2e69559670861133145572ed6aa2a"><div class="ttname"><a href="structInputSoundingData.html#adba2e69559670861133145572ed6aa2a">InputSoundingData::V_inp_sound</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Vector&lt; amrex::Real &gt; &gt; V_inp_sound</div><div class="ttdef"><b>Definition:</b> ERF_InputSoundingData.H:323</div></div>
<div class="ttc" id="astructInputSoundingData_html_ae67ebe7a35af74165a1d2e7ee31a1bbc"><div class="ttname"><a href="structInputSoundingData.html#ae67ebe7a35af74165a1d2e7ee31a1bbc">InputSoundingData::size</a></div><div class="ttdeci">int size(int itime) const</div><div class="ttdef"><b>Definition:</b> ERF_InputSoundingData.H:300</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a0877d5a0263641c13b92d2d16f47b689_cgraph.png" border="0" usemap="#aclassERF_a0877d5a0263641c13b92d2d16f47b689_cgraph" alt=""/></div>
<map name="aclassERF_a0877d5a0263641c13b92d2d16f47b689_cgraph" id="aclassERF_a0877d5a0263641c13b92d2d16f47b689_cgraph">
<area shape="rect" title="Set Rayleigh mean profiles from input sounding." alt="" coords="5,31,252,57"/>
<area shape="rect" href="ERF__Interpolation__1D_8H.html#af71b362e58803c8c29aa5127adcf645f" title=" " alt="" coords="300,5,503,32"/>
<area shape="rect" href="ERF__Interpolation__1D_8H.html#a803d0d35d4ca4791556cbe02bbf51cbb" title=" " alt="" coords="343,56,459,83"/>
</map>
</div>

</div>
</div>
<a id="a2486b49bb0d7917f812318822e42a03c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2486b49bb0d7917f812318822e42a03c">&#9670;&nbsp;</a></span>setRecordDataInfo()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::setRecordDataInfo </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>filename</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;    {</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;        <span class="keywordflow">if</span> (amrex::ParallelDescriptor::IOProcessor())</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;        {</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;            <a class="code" href="classERF.html#a1cade630b005dbcc0f644987ef3db287">datalog</a>[i] = std::make_unique&lt;std::fstream&gt;();</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;            <a class="code" href="classERF.html#a1cade630b005dbcc0f644987ef3db287">datalog</a>[i]-&gt;open(filename.c_str(),std::ios::out|std::ios::app);</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classERF.html#a1cade630b005dbcc0f644987ef3db287">datalog</a>[i]-&gt;good()) {</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;                amrex::FileOpenFailed(filename);</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;            }</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;        }</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;        amrex::ParallelDescriptor::Barrier(<span class="stringliteral">&quot;ERF::setRecordDataInfo&quot;</span>);</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a967434ca06be557118b7a4a27a0b6f1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a967434ca06be557118b7a4a27a0b6f1f">&#9670;&nbsp;</a></span>setRecordDerDataInfo()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::setRecordDerDataInfo </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>filename</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;    {</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;        <span class="keywordflow">if</span> (amrex::ParallelDescriptor::IOProcessor())</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;        {</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;            <a class="code" href="classERF.html#ab33e7fff801543a43961ca6d7cac818f">der_datalog</a>[i] = std::make_unique&lt;std::fstream&gt;();</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;            <a class="code" href="classERF.html#ab33e7fff801543a43961ca6d7cac818f">der_datalog</a>[i]-&gt;open(filename.c_str(),std::ios::out|std::ios::app);</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classERF.html#ab33e7fff801543a43961ca6d7cac818f">der_datalog</a>[i]-&gt;good()) {</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;                amrex::FileOpenFailed(filename);</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;            }</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;        }</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;        amrex::ParallelDescriptor::Barrier(<span class="stringliteral">&quot;ERF::setRecordDerDataInfo&quot;</span>);</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac1a50d2d5abc5bd1d51417583184ac52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1a50d2d5abc5bd1d51417583184ac52">&#9670;&nbsp;</a></span>setRecordEnergyDataInfo()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::setRecordEnergyDataInfo </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>filename</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;    {</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;        <span class="keywordflow">if</span> (amrex::ParallelDescriptor::IOProcessor())</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;        {</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;            <a class="code" href="classERF.html#ab546bcca3968440c6c24097f59b87f23">tot_e_datalog</a>[i] = std::make_unique&lt;std::fstream&gt;();</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;            <a class="code" href="classERF.html#ab546bcca3968440c6c24097f59b87f23">tot_e_datalog</a>[i]-&gt;open(filename.c_str(),std::ios::out|std::ios::app);</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classERF.html#ab546bcca3968440c6c24097f59b87f23">tot_e_datalog</a>[i]-&gt;good()) {</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;                amrex::FileOpenFailed(filename);</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;            }</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;        }</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;        amrex::ParallelDescriptor::Barrier(<span class="stringliteral">&quot;ERF::setRecordEnergyDataInfo&quot;</span>);</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae1a8856961aaee53016122facba03dbe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1a8856961aaee53016122facba03dbe">&#9670;&nbsp;</a></span>setRecordSampleLineInfo()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::setRecordSampleLineInfo </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::IntVect &amp;&#160;</td>
          <td class="paramname"><em>cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>filename</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    {</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;        amrex::MultiFab dummy(grids[lev],dmap[lev],1,0);</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;        <span class="keywordflow">for</span> (amrex::MFIter mfi(dummy); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;        {</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;            <span class="keyword">const</span> amrex::Box&amp; bx = mfi.validbox();</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;            <span class="keywordflow">if</span> (bx.contains(cell)) {</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;                <a class="code" href="classERF.html#a4990f1796b65ec8ee602f177a66afc3e">samplelinelog</a>[i] = std::make_unique&lt;std::fstream&gt;();</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;                <a class="code" href="classERF.html#a4990f1796b65ec8ee602f177a66afc3e">samplelinelog</a>[i]-&gt;open(filename.c_str(),std::ios::out|std::ios::app);</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="classERF.html#a4990f1796b65ec8ee602f177a66afc3e">samplelinelog</a>[i]-&gt;good()) {</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;                    amrex::FileOpenFailed(filename);</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;                }</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;            }</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;        }</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;        amrex::ParallelDescriptor::Barrier(<span class="stringliteral">&quot;ERF::setRecordSampleLineInfo&quot;</span>);</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="af8d930dce1b926ecc3bdc6787dd47818"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8d930dce1b926ecc3bdc6787dd47818">&#9670;&nbsp;</a></span>setRecordSamplePointInfo()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::setRecordSamplePointInfo </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::IntVect &amp;&#160;</td>
          <td class="paramname"><em>cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>filename</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;    {</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;        amrex::MultiFab dummy(grids[lev],dmap[lev],1,0);</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;        <span class="keywordflow">for</span> (amrex::MFIter mfi(dummy); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;        {</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;            <span class="keyword">const</span> amrex::Box&amp; bx = mfi.validbox();</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;            <span class="keywordflow">if</span> (bx.contains(cell)) {</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;                <a class="code" href="classERF.html#a9737ddb0de6b9e8a5b17c109d5ad3e08">sampleptlog</a>[i] = std::make_unique&lt;std::fstream&gt;();</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;                <a class="code" href="classERF.html#a9737ddb0de6b9e8a5b17c109d5ad3e08">sampleptlog</a>[i]-&gt;open(filename.c_str(),std::ios::out|std::ios::app);</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="classERF.html#a9737ddb0de6b9e8a5b17c109d5ad3e08">sampleptlog</a>[i]-&gt;good()) {</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;                    amrex::FileOpenFailed(filename);</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;                }</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;            }</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;        }</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;        amrex::ParallelDescriptor::Barrier(<span class="stringliteral">&quot;ERF::setRecordSamplePointInfo&quot;</span>);</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae27a45d751287a887769df20dea60633"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae27a45d751287a887769df20dea60633">&#9670;&nbsp;</a></span>setSpongeRefFromSounding()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::setSpongeRefFromSounding </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>restarting</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set sponge mean profiles from input sounding. </p>
<p>Sets the sponge damping averaged quantities from an externally supplied input sponge data file.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">restarting</td><td>Boolean parameter that indicates whether we are currently restarting from a checkpoint file. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;{</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="comment">// If we are restarting then we haven&#39;t read the input_sponge file yet</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="comment">//    so we need to read it here</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="comment">// TODO: should we store this information in the checkpoint file instead?</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keywordflow">if</span> (restarting) {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <a class="code" href="classERF.html#a8cb877a46fd94b5294425299dcb9cbaf">input_sponge_data</a>.<a class="code" href="structInputSpongeData.html#a75a39e770aef38396af5f31cda9879fc">read_from_file</a>(geom[0], <a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[0]);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    }</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keyword">const</span> Real* z_inp_sponge     = <a class="code" href="classERF.html#a8cb877a46fd94b5294425299dcb9cbaf">input_sponge_data</a>.<a class="code" href="structInputSpongeData.html#ae430ab35b7ded846911bd26b0d984155">z_inp_sponge</a>.dataPtr();</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keyword">const</span> Real* U_inp_sponge     = <a class="code" href="classERF.html#a8cb877a46fd94b5294425299dcb9cbaf">input_sponge_data</a>.<a class="code" href="structInputSpongeData.html#aece8029ec7a192a21d88a796ada8e917">U_inp_sponge</a>.dataPtr();</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keyword">const</span> Real* V_inp_sponge     = <a class="code" href="classERF.html#a8cb877a46fd94b5294425299dcb9cbaf">input_sponge_data</a>.<a class="code" href="structInputSpongeData.html#a8cc25a2bbb25e676dadc57cf3e8f6db1">V_inp_sponge</a>.dataPtr();</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span>   inp_sponge_size  = <a class="code" href="classERF.html#a8cb877a46fd94b5294425299dcb9cbaf">input_sponge_data</a>.<a class="code" href="structInputSpongeData.html#aff9684faaf6b3a26494766819e4ba6dd">size</a>();</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; lev++)</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> khi = geom[lev].Domain().bigEnd()[2];</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        Vector&lt;Real&gt; zcc(khi+1);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[lev]) {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            <span class="comment">// use_terrain=1</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;            <span class="comment">// calculate the damping strength based on the max height at each k</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            <a class="code" href="ERF__ParFunctions_8H.html#ae0f0ec55ed7951e173987f3e511f082e">reduce_to_max_per_height</a>(zcc, <a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[lev]);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            <span class="keyword">const</span> <span class="keyword">auto</span> *<span class="keyword">const</span> prob_lo = geom[lev].ProbLo();</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            <span class="keyword">const</span> <span class="keyword">auto</span> *<span class="keyword">const</span> dx = geom[lev].CellSize();</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt;= khi; k++)</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;            {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                zcc[k] = prob_lo[2] + (k+0.5) * dx[2];</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            }</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        }</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt;= khi; k++)</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            <a class="code" href="classERF.html#a20a0f0d26791321eb4bbba6baee9f159">h_sponge_ptrs</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a5bebd9ff4e2455172deca3b399214fcbac159d9fae0d25be7ce907e1feb87cdaa">Sponge::ubar_sponge</a>][k] = <a class="code" href="ERF__Interpolation__1D_8H.html#a803d0d35d4ca4791556cbe02bbf51cbb">interpolate_1d</a>(z_inp_sponge, U_inp_sponge, zcc[k], inp_sponge_size);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            <a class="code" href="classERF.html#a20a0f0d26791321eb4bbba6baee9f159">h_sponge_ptrs</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a5bebd9ff4e2455172deca3b399214fcbaad1bdec1c0213a18483e81bcb4926964">Sponge::vbar_sponge</a>][k] = <a class="code" href="ERF__Interpolation__1D_8H.html#a803d0d35d4ca4791556cbe02bbf51cbb">interpolate_1d</a>(z_inp_sponge, V_inp_sponge, zcc[k], inp_sponge_size);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        }</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="comment">// Copy from host version to device version</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        Gpu::copy(Gpu::hostToDevice, <a class="code" href="classERF.html#a20a0f0d26791321eb4bbba6baee9f159">h_sponge_ptrs</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a5bebd9ff4e2455172deca3b399214fcbac159d9fae0d25be7ce907e1feb87cdaa">Sponge::ubar_sponge</a>].begin(), <a class="code" href="classERF.html#a20a0f0d26791321eb4bbba6baee9f159">h_sponge_ptrs</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a5bebd9ff4e2455172deca3b399214fcbac159d9fae0d25be7ce907e1feb87cdaa">Sponge::ubar_sponge</a>].end(),</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                         <a class="code" href="classERF.html#a3b9bcb54c278dfec6027e9727cc01bc5">d_sponge_ptrs</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a5bebd9ff4e2455172deca3b399214fcbac159d9fae0d25be7ce907e1feb87cdaa">Sponge::ubar_sponge</a>].begin());</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        Gpu::copy(Gpu::hostToDevice, <a class="code" href="classERF.html#a20a0f0d26791321eb4bbba6baee9f159">h_sponge_ptrs</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a5bebd9ff4e2455172deca3b399214fcbaad1bdec1c0213a18483e81bcb4926964">Sponge::vbar_sponge</a>].begin(), <a class="code" href="classERF.html#a20a0f0d26791321eb4bbba6baee9f159">h_sponge_ptrs</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a5bebd9ff4e2455172deca3b399214fcbaad1bdec1c0213a18483e81bcb4926964">Sponge::vbar_sponge</a>].end(),</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                         <a class="code" href="classERF.html#a3b9bcb54c278dfec6027e9727cc01bc5">d_sponge_ptrs</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a5bebd9ff4e2455172deca3b399214fcbaad1bdec1c0213a18483e81bcb4926964">Sponge::vbar_sponge</a>].begin());</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    }</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;}</div>
<div class="ttc" id="aERF__ParFunctions_8H_html_ae0f0ec55ed7951e173987f3e511f082e"><div class="ttname"><a href="ERF__ParFunctions_8H.html#ae0f0ec55ed7951e173987f3e511f082e">reduce_to_max_per_height</a></div><div class="ttdeci">AMREX_FORCE_INLINE void reduce_to_max_per_height(amrex::Vector&lt; amrex::Real &gt; &amp;v, std::unique_ptr&lt; amrex::MultiFab &gt; &amp;mf)</div><div class="ttdef"><b>Definition:</b> ERF_ParFunctions.H:8</div></div>
<div class="ttc" id="astructInputSpongeData_html_a8cc25a2bbb25e676dadc57cf3e8f6db1"><div class="ttname"><a href="structInputSpongeData.html#a8cc25a2bbb25e676dadc57cf3e8f6db1">InputSpongeData::V_inp_sponge</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Real &gt; V_inp_sponge</div><div class="ttdef"><b>Definition:</b> ERF_InputSpongeData.H:114</div></div>
<div class="ttc" id="astructInputSpongeData_html_ae430ab35b7ded846911bd26b0d984155"><div class="ttname"><a href="structInputSpongeData.html#ae430ab35b7ded846911bd26b0d984155">InputSpongeData::z_inp_sponge</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Real &gt; z_inp_sponge</div><div class="ttdef"><b>Definition:</b> ERF_InputSpongeData.H:114</div></div>
<div class="ttc" id="astructInputSpongeData_html_aece8029ec7a192a21d88a796ada8e917"><div class="ttname"><a href="structInputSpongeData.html#aece8029ec7a192a21d88a796ada8e917">InputSpongeData::U_inp_sponge</a></div><div class="ttdeci">amrex::Vector&lt; amrex::Real &gt; U_inp_sponge</div><div class="ttdef"><b>Definition:</b> ERF_InputSpongeData.H:114</div></div>
<div class="ttc" id="astructInputSpongeData_html_aff9684faaf6b3a26494766819e4ba6dd"><div class="ttname"><a href="structInputSpongeData.html#aff9684faaf6b3a26494766819e4ba6dd">InputSpongeData::size</a></div><div class="ttdeci">int size() const</div><div class="ttdef"><b>Definition:</b> ERF_InputSpongeData.H:102</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_ae27a45d751287a887769df20dea60633_cgraph.png" border="0" usemap="#aclassERF_ae27a45d751287a887769df20dea60633_cgraph" alt=""/></div>
<map name="aclassERF_ae27a45d751287a887769df20dea60633_cgraph" id="aclassERF_ae27a45d751287a887769df20dea60633_cgraph">
<area shape="rect" title="Set sponge mean profiles from input sounding." alt="" coords="5,31,243,57"/>
<area shape="rect" href="ERF__Interpolation__1D_8H.html#a803d0d35d4ca4791556cbe02bbf51cbb" title=" " alt="" coords="332,5,448,32"/>
<area shape="rect" href="ERF__ParFunctions_8H.html#ae0f0ec55ed7951e173987f3e511f082e" title=" " alt="" coords="291,56,489,83"/>
</map>
</div>

</div>
</div>
<a id="aa31ae8bd097ec65d711070aedf11a14a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa31ae8bd097ec65d711070aedf11a14a">&#9670;&nbsp;</a></span>solve_with_EB_mlmg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::solve_with_EB_mlmg </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Vector&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Vector&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Vector&lt; amrex::Array&lt; amrex::MultiFab, AMREX_SPACEDIM &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>fluxes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Solve the Poisson equation using EB_enabled MLMG Note that the level may or may not be level 0. </p>
<div class="fragment"><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;{</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    BL_PROFILE(<span class="stringliteral">&quot;ERF::solve_with_EB_mlmg()&quot;</span>);</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span> <a class="code" href="ERF__DiffSetup_8H.html#a2987796b2d40db9890dd3497cc7e20ca">dom_lo</a> = lbound(geom[lev].Domain());</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span> <a class="code" href="ERF__DiffSetup_8H.html#a0f2c81fa9e8171e1116919f8b1ae0b28">dom_hi</a> = ubound(geom[lev].Domain());</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    LPInfo info;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="comment">// Allow a hidden direction if the domain is one cell wide in any lateral direction</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ERF__DiffSetup_8H.html#a2987796b2d40db9890dd3497cc7e20ca">dom_lo</a>.x == <a class="code" href="ERF__DiffSetup_8H.html#a0f2c81fa9e8171e1116919f8b1ae0b28">dom_hi</a>.x) {</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        info.setHiddenDirection(0);</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="ERF__DiffSetup_8H.html#a2987796b2d40db9890dd3497cc7e20ca">dom_lo</a>.y == <a class="code" href="ERF__DiffSetup_8H.html#a0f2c81fa9e8171e1116919f8b1ae0b28">dom_hi</a>.y) {</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        info.setHiddenDirection(1);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    }</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="comment">// Make sure the solver only sees the levels over which we are solving</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    Vector&lt;BoxArray&gt;            ba_tmp;   ba_tmp.push_back(rhs[0].boxArray());</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    Vector&lt;DistributionMapping&gt; dm_tmp;   dm_tmp.push_back(rhs[0].DistributionMap());</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    Vector&lt;Geometry&gt;          geom_tmp; geom_tmp.push_back(geom[lev]);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keyword">auto</span> bclo = <a class="code" href="classERF.html#a57580311d47c9fd5e27ba156d287c169">get_projection_bc</a>(Orientation::low);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="keyword">auto</span> bchi = <a class="code" href="classERF.html#a57580311d47c9fd5e27ba156d287c169">get_projection_bc</a>(Orientation::high);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="comment">// amrex::Print() &lt;&lt; &quot;BCLO &quot; &lt;&lt; bclo[0] &lt;&lt; &quot; &quot; &lt;&lt; bclo[1] &lt;&lt; &quot; &quot; &lt;&lt; bclo[2] &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="comment">// amrex::Print() &lt;&lt; &quot;BCHI &quot; &lt;&lt; bchi[0] &lt;&lt; &quot; &quot; &lt;&lt; bchi[1] &lt;&lt; &quot; &quot; &lt;&lt; bchi[2] &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    Real reltol = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a238b0871f38f8b134ff3fe5af0d05479">poisson_reltol</a>;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    Real abstol = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ad7f586d62fb0872ba0340fb03d462c64">poisson_abstol</a>;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="comment">// Multigrid solve</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    MLEBABecLap mleb (geom_tmp, ba_tmp, dm_tmp, info, {&amp;<a class="code" href="classERF.html#ad024dd413ab20e5d6f69c1f96e5b78a3">EBFactory</a>(lev)});</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    mleb.setMaxOrder(2);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    mleb.setDomainBC(bclo, bchi);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    mleb.setLevelBC(0, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="comment">// This sets A = 0, B = 1 so that</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="comment">// the operator A alpha - b del dot beta grad to b</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="comment">// becomes  - del dot beta grad</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    mleb.setScalars(0.0, 1.0);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    Array&lt;MultiFab,AMREX_SPACEDIM&gt; bcoef;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idim = 0; idim &lt; AMREX_SPACEDIM; ++idim) {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        bcoef[idim].define(convert(ba_tmp[0],IntVect::TheDimensionVector(idim)),</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                            dm_tmp[0], 1, 0, MFInfo(), <a class="code" href="classERF.html#ad024dd413ab20e5d6f69c1f96e5b78a3">EBFactory</a>(lev));</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        bcoef[idim].setVal(-1.0);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    }</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    mleb.setBCoeffs(0, amrex::GetArrOfConstPtrs(bcoef));</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    MLMG mlmg(mleb);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordtype">int</span> max_iter = 100;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    mlmg.setMaxIter(max_iter);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    mlmg.setVerbose(<a class="code" href="classERF.html#a2c4e27d6b7928c7081f17e63d0834200">mg_verbose</a>);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    mlmg.setBottomVerbose(0);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    mlmg.solve(GetVecOfPtrs(phi), GetVecOfConstPtrs(rhs), reltol, abstol);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    mlmg.getFluxes(GetVecOfArrOfPtrs(fluxes));</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <a class="code" href="classERF.html#a4bc2457e48cf3347af7c600a07982006">ImposeBCsOnPhi</a>(lev,phi[0]);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="comment">// This arises because we solve MINUS del dot beta grad phi = div (rho u)</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    fluxes[0][0].mult(-1.);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    fluxes[0][1].mult(-1.);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    fluxes[0][2].mult(-1.);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_a4bc2457e48cf3347af7c600a07982006"><div class="ttname"><a href="classERF.html#a4bc2457e48cf3347af7c600a07982006">ERF::ImposeBCsOnPhi</a></div><div class="ttdeci">void ImposeBCsOnPhi(int lev, amrex::MultiFab &amp;phi)</div><div class="ttdef"><b>Definition:</b> ERF_ImposeBCsOnPhi.cpp:12</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9866c7874624259ffcfc6edf46dd58ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9866c7874624259ffcfc6edf46dd58ec">&#9670;&nbsp;</a></span>solve_with_gmres()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::solve_with_gmres </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Vector&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Vector&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Vector&lt; amrex::Array&lt; amrex::MultiFab, AMREX_SPACEDIM &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>fluxes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Solve the Poisson equation using FFT-preconditioned GMRES </p>
<div class="fragment"><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;{</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#ifdef ERF_USE_FFT</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    BL_PROFILE(<span class="stringliteral">&quot;ERF::solve_with_gmres()&quot;</span>);</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160; </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    Real reltol = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a238b0871f38f8b134ff3fe5af0d05479">poisson_reltol</a>;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    Real abstol = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ad7f586d62fb0872ba0340fb03d462c64">poisson_abstol</a>;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    amrex::GMRES&lt;MultiFab, TerrainPoisson&gt; gmsolver;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    TerrainPoisson tp(geom[lev], rhs[0].boxArray(), rhs[0].DistributionMap(), <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>,</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;                      <a class="code" href="classERF.html#a6600f30f1043a4c5e62b5cdd05f0a99f">stretched_dz_d</a>[lev], *<a class="code" href="classERF.html#a93bc9185c89cbeaceffaf40b8cf4a75c">ax</a>[lev], *<a class="code" href="classERF.html#ade870f983d113c64406bdcb8a9194044">ay</a>[lev], <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev].get());</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    gmsolver.define(tp);</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    gmsolver.setVerbose(<a class="code" href="classERF.html#a2c4e27d6b7928c7081f17e63d0834200">mg_verbose</a>);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    gmsolver.setRestartLength(50);</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    tp.usePrecond(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    gmsolver.solve(phi[0], rhs[0], reltol, abstol);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    tp.getFluxes(phi[0], fluxes[0]);</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    amrex::ignore_unused(lev, rhs, phi, fluxes);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="comment">// Impose bc&#39;s on pprime</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <a class="code" href="classERF.html#a4bc2457e48cf3347af7c600a07982006">ImposeBCsOnPhi</a>(lev, phi[0]);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8a7c7fe95147d8772047aa0772a09564"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a7c7fe95147d8772047aa0772a09564">&#9670;&nbsp;</a></span>solve_with_mlmg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::solve_with_mlmg </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Vector&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Vector&lt; amrex::MultiFab &gt; &amp;&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Vector&lt; amrex::Array&lt; amrex::MultiFab, AMREX_SPACEDIM &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>fluxes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Solve the Poisson equation using MLMG Note that the level may or may not be level 0. </p>
<div class="fragment"><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;{</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    BL_PROFILE(<span class="stringliteral">&quot;ERF::solve_with_mlmg()&quot;</span>);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span> <a class="code" href="ERF__DiffSetup_8H.html#a2987796b2d40db9890dd3497cc7e20ca">dom_lo</a> = lbound(geom[lev].Domain());</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span> <a class="code" href="ERF__DiffSetup_8H.html#a0f2c81fa9e8171e1116919f8b1ae0b28">dom_hi</a> = ubound(geom[lev].Domain());</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    LPInfo info;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="comment">// Allow a hidden direction if the domain is one cell wide in any lateral direction</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ERF__DiffSetup_8H.html#a2987796b2d40db9890dd3497cc7e20ca">dom_lo</a>.x == <a class="code" href="ERF__DiffSetup_8H.html#a0f2c81fa9e8171e1116919f8b1ae0b28">dom_hi</a>.x) {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        info.setHiddenDirection(0);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="ERF__DiffSetup_8H.html#a2987796b2d40db9890dd3497cc7e20ca">dom_lo</a>.y == <a class="code" href="ERF__DiffSetup_8H.html#a0f2c81fa9e8171e1116919f8b1ae0b28">dom_hi</a>.y) {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        info.setHiddenDirection(1);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    }</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="comment">// Make sure the solver only sees the levels over which we are solving</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    Vector&lt;BoxArray&gt;            ba_tmp;   ba_tmp.push_back(rhs[0].boxArray());</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    Vector&lt;DistributionMapping&gt; dm_tmp;   dm_tmp.push_back(rhs[0].DistributionMap());</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    Vector&lt;Geometry&gt;          geom_tmp; geom_tmp.push_back(geom[lev]);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keyword">auto</span> bclo = <a class="code" href="classERF.html#a57580311d47c9fd5e27ba156d287c169">get_projection_bc</a>(Orientation::low);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keyword">auto</span> bchi = <a class="code" href="classERF.html#a57580311d47c9fd5e27ba156d287c169">get_projection_bc</a>(Orientation::high);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="comment">// amrex::Print() &lt;&lt; &quot;BCLO &quot; &lt;&lt; bclo[0] &lt;&lt; &quot; &quot; &lt;&lt; bclo[1] &lt;&lt; &quot; &quot; &lt;&lt; bclo[2] &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="comment">// amrex::Print() &lt;&lt; &quot;BCHI &quot; &lt;&lt; bchi[0] &lt;&lt; &quot; &quot; &lt;&lt; bchi[1] &lt;&lt; &quot; &quot; &lt;&lt; bchi[2] &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    Real reltol = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a238b0871f38f8b134ff3fe5af0d05479">poisson_reltol</a>;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    Real abstol = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ad7f586d62fb0872ba0340fb03d462c64">poisson_abstol</a>;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="comment">// Multigrid solve</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    MLPoisson mlpoisson(geom_tmp, ba_tmp, dm_tmp, info);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    mlpoisson.setDomainBC(bclo, bchi);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordflow">if</span> (lev &gt; 0) {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        mlpoisson.setCoarseFineBC(<span class="keyword">nullptr</span>, ref_ratio[lev-1], LinOpBCType::Neumann);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    }</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    mlpoisson.setLevelBC(0, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="comment">// Use low order for outflow at physical boundaries</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    mlpoisson.setMaxOrder(2);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    MLMG mlmg(mlpoisson);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keywordtype">int</span> max_iter = 100;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    mlmg.setMaxIter(max_iter);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    mlmg.setVerbose(<a class="code" href="classERF.html#a2c4e27d6b7928c7081f17e63d0834200">mg_verbose</a>);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    mlmg.setBottomVerbose(0);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    mlmg.solve(GetVecOfPtrs(phi),</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;               GetVecOfConstPtrs(rhs),</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;               reltol, abstol);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    mlmg.getFluxes(GetVecOfArrOfPtrs(fluxes));</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="comment">// Impose bc&#39;s on pprime</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="comment">// ****************************************************************************</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <a class="code" href="classERF.html#a4bc2457e48cf3347af7c600a07982006">ImposeBCsOnPhi</a>(lev, phi[0]);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a91c184ac7e5889fe785aa846112ce2e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91c184ac7e5889fe785aa846112ce2e6">&#9670;&nbsp;</a></span>sum_derived_quantities()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::sum_derived_quantities </td>
          <td>(</td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;{</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a43d0b17f6e155691a1e9474526df3af5">verbose</a> &lt;= 0 || <a class="code" href="classERF.html#acf7926f64e3747680861aba9afe5d219">NumDerDataLogs</a>() &lt;= 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordtype">int</span> lev = 0;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    AMREX_ALWAYS_ASSERT(lev == 0);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="comment">// ************************************************************************</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="comment">// WARNING: we are not filling ghost cells other than periodic outside the domain</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="comment">// ************************************************************************</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    MultiFab mf_cc_vel(grids[lev], dmap[lev], AMREX_SPACEDIM, IntVect(1,1,1));</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    mf_cc_vel.setVal(0.); <span class="comment">// We just do this to avoid uninitialized values</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="comment">// Average all three components of velocity (on faces) to the cell center</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    average_face_to_cellcenter(mf_cc_vel,0,</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                               Array&lt;const MultiFab*,3&gt;{&amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                                                        &amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                                                        &amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>]});</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    mf_cc_vel.FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keywordflow">if</span> (!geom[lev].isPeriodic(0) || !geom[lev].isPeriodic(1) || !geom[lev].isPeriodic(2)) {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        amrex::Warning(<span class="stringliteral">&quot;Ghost cells outside non-periodic physical boundaries are not filled -- vel set to 0 there&quot;</span>);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    }</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    MultiFab r_wted_magvelsq(grids[lev], dmap[lev], AMREX_SPACEDIM, IntVect(0,0,0));</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    MultiFab unwted_magvelsq(grids[lev], dmap[lev], AMREX_SPACEDIM, IntVect(0,0,0));</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    MultiFab     enstrophysq(grids[lev], dmap[lev], AMREX_SPACEDIM, IntVect(1,1,1));</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    MultiFab        theta_mf(grids[lev], dmap[lev], AMREX_SPACEDIM, IntVect(0,0,0));</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="preprocessor">#pragma omp parallel if (amrex::Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="keywordflow">for</span> (MFIter mfi(unwted_magvelsq, TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <span class="keyword">auto</span>&amp; src_fab = mf_cc_vel[mfi];</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <span class="keyword">auto</span>&amp; dest1_fab = unwted_magvelsq[mfi];</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <a class="code" href="namespacederived.html#a9118d89c9fb844952c2cb55661c15a3e">derived::erf_dermagvelsq</a>(bx, dest1_fab, 0, 1, src_fab, Geom(lev), <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0], <span class="keyword">nullptr</span>, lev);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <span class="keyword">auto</span>&amp; dest2_fab = enstrophysq[mfi];</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <a class="code" href="namespacederived.html#a9c2ed59aaacbee455c81838aef86035d">derived::erf_derenstrophysq</a>(bx, dest2_fab, 0, 1, src_fab, Geom(lev), <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0], <span class="keyword">nullptr</span>, lev);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    }</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="comment">// Copy the MF holding 1/2(u^2 + v^2 + w^2) into the MF that will hold 1/2 rho (u^2 + v^2 + w^2)d</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    MultiFab::Copy(r_wted_magvelsq, unwted_magvelsq, 0, 0, 1, 0);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="comment">// Multiply the MF holding 1/2(u^2 + v^2 + w^2) by rho to get  1/2 rho (u^2 + v^2 + w^2)</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    MultiFab::Multiply(r_wted_magvelsq, <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], 0, 0, 1, 0);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="comment">// Copy the MF holding (rho theta) into &quot;theta_mf&quot;</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    MultiFab::Copy(theta_mf, <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], <a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>, 0, 1, 0);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="comment">// Divide (rho theta) by rho to get theta in the MF &quot;theta_mf&quot;</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    MultiFab::Divide(theta_mf, <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], <a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>, 0, 1, 0);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    Real  unwted_avg = <a class="code" href="classERF.html#ad156903a5d71364b5fb5884000f28a8a">volWgtSumMF</a>(lev, unwted_magvelsq, 0, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    Real  r_wted_avg = <a class="code" href="classERF.html#ad156903a5d71364b5fb5884000f28a8a">volWgtSumMF</a>(lev, r_wted_magvelsq, 0, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    Real enstrsq_avg = <a class="code" href="classERF.html#ad156903a5d71364b5fb5884000f28a8a">volWgtSumMF</a>(lev, enstrophysq,     0, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    Real   theta_avg = <a class="code" href="classERF.html#ad156903a5d71364b5fb5884000f28a8a">volWgtSumMF</a>(lev, theta_mf,        0, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="comment">// Get volume including terrain (consistent with volWgtSumMF routine)</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    MultiFab volume(grids[lev], dmap[lev], 1, 0);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span>&amp; dx = geom[lev].CellSizeArray();</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    Real cell_vol  = dx[0]*dx[1]*dx[2];</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    volume.setVal(cell_vol);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structSolverChoice.html#a1952672901901b0b3a628f2298dc72c2">SolverChoice::mesh_type</a> != MeshType::ConstantDz) {</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        MultiFab::Multiply(volume, *<a class="code" href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">detJ_cc</a>[lev], 0, 0, 1, 0);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    }</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="preprocessor">#pragma omp parallel if (amrex::Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordflow">for</span> (MFIter mfi(volume, TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    {</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        <span class="keyword">const</span> Box&amp; tbx  = mfi.tilebox();</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <span class="keyword">auto</span> dst        = volume.array(mfi);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span>&amp; mfx = <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85bac2a428daaf1a1b398630fa8cec7f115b">MapFacType::m_x</a>]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span>&amp; mfy = <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85ba9612b6816e2fb7dc3ad56d6bc1fb7df8">MapFacType::m_y</a>]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        ParallelFor(tbx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        {</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            dst(i,j,k) /= (mfx(i,j,0)*mfy(i,j,0));</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        });</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    }</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    Real vol = volume.sum();</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;     unwted_avg /= vol;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;     r_wted_avg /= vol;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    enstrsq_avg /= vol;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      theta_avg /= vol;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> nfoo = 4;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    Real foo[nfoo] = {unwted_avg,r_wted_avg,enstrsq_avg,theta_avg};</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="preprocessor">#ifdef AMREX_LAZY</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    Lazy::QueueReduction([=]() <span class="keyword">mutable</span> {</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    ParallelDescriptor::ReduceRealSum(</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        foo, nfoo, ParallelDescriptor::IOProcessorNumber());</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      <span class="keywordflow">if</span> (ParallelDescriptor::IOProcessor()) {</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        unwted_avg  = foo[i++];</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        r_wted_avg  = foo[i++];</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        enstrsq_avg = foo[i++];</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;          theta_avg = foo[i++];</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        std::ostream&amp; data_log_der = <a class="code" href="classERF.html#a07b6ef88ba692152c19381858e2a639e">DerDataLog</a>(0);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160; </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <span class="keywordflow">if</span> (time == 0.0) {</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            data_log_der &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; <span class="stringliteral">&quot;          time&quot;</span>;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            data_log_der &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; <span class="stringliteral">&quot;        ke_den&quot;</span>;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            data_log_der &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; <span class="stringliteral">&quot;         velsq&quot;</span>;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            data_log_der &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; <span class="stringliteral">&quot;     enstrophy&quot;</span>;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            data_log_der &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; <span class="stringliteral">&quot;    int_energy&quot;</span>;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            data_log_der &lt;&lt; std::endl;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        }</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        data_log_der &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; std::setprecision(<a class="code" href="classERF.html#a2307b817178b00e5cc38c0e163da0a39">timeprecision</a>) &lt;&lt; time;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        data_log_der &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; std::setprecision(<a class="code" href="classERF.html#aefeb0bde962c9f53aba32e4ab59b4958">datprecision</a>)  &lt;&lt;  unwted_avg;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        data_log_der &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; std::setprecision(<a class="code" href="classERF.html#aefeb0bde962c9f53aba32e4ab59b4958">datprecision</a>)  &lt;&lt;  r_wted_avg;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        data_log_der &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; std::setprecision(<a class="code" href="classERF.html#aefeb0bde962c9f53aba32e4ab59b4958">datprecision</a>)  &lt;&lt; enstrsq_avg;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        data_log_der &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; std::setprecision(<a class="code" href="classERF.html#aefeb0bde962c9f53aba32e4ab59b4958">datprecision</a>)  &lt;&lt;   theta_avg;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        data_log_der &lt;&lt; std::endl;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160; </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      } <span class="comment">// if IOProcessor</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="preprocessor">#ifdef AMREX_LAZY</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    }</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_a07b6ef88ba692152c19381858e2a639e"><div class="ttname"><a href="classERF.html#a07b6ef88ba692152c19381858e2a639e">ERF::DerDataLog</a></div><div class="ttdeci">AMREX_FORCE_INLINE std::ostream &amp; DerDataLog(int i)</div><div class="ttdef"><b>Definition:</b> ERF.H:1244</div></div>
<div class="ttc" id="aclassERF_html_acf7926f64e3747680861aba9afe5d219"><div class="ttname"><a href="classERF.html#acf7926f64e3747680861aba9afe5d219">ERF::NumDerDataLogs</a></div><div class="ttdeci">AMREX_FORCE_INLINE int NumDerDataLogs() noexcept</div><div class="ttdef"><b>Definition:</b> ERF.H:1258</div></div>
<div class="ttc" id="anamespacederived_html_a9118d89c9fb844952c2cb55661c15a3e"><div class="ttname"><a href="namespacederived.html#a9118d89c9fb844952c2cb55661c15a3e">derived::erf_dermagvelsq</a></div><div class="ttdeci">void erf_dermagvelsq(const amrex::Box &amp;bx, amrex::FArrayBox &amp;derfab, int dcomp, int ncomp, const amrex::FArrayBox &amp;datfab, const amrex::Geometry &amp;, amrex::Real, const int *, const int)</div><div class="ttdef"><b>Definition:</b> ERF_Derive.cpp:346</div></div>
<div class="ttc" id="anamespacederived_html_a9c2ed59aaacbee455c81838aef86035d"><div class="ttname"><a href="namespacederived.html#a9c2ed59aaacbee455c81838aef86035d">derived::erf_derenstrophysq</a></div><div class="ttdeci">void erf_derenstrophysq(const amrex::Box &amp;bx, amrex::FArrayBox &amp;derfab, int dcomp, int ncomp, const amrex::FArrayBox &amp;datfab, const amrex::Geometry &amp;geomdata, amrex::Real, const int *, const int)</div><div class="ttdef"><b>Definition:</b> ERF_Derive.cpp:284</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a91c184ac7e5889fe785aa846112ce2e6_cgraph.png" border="0" usemap="#aclassERF_a91c184ac7e5889fe785aa846112ce2e6_cgraph" alt=""/></div>
<map name="aclassERF_a91c184ac7e5889fe785aa846112ce2e6_cgraph" id="aclassERF_a91c184ac7e5889fe785aa846112ce2e6_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,216,57"/>
<area shape="rect" href="namespacederived.html#a9c2ed59aaacbee455c81838aef86035d" title=" " alt="" coords="264,5,469,32"/>
<area shape="rect" href="namespacederived.html#a9118d89c9fb844952c2cb55661c15a3e" title=" " alt="" coords="272,56,461,83"/>
</map>
</div>

</div>
</div>
<a id="a3e5b26e9aeb49e5318eb6cb68ed2ee97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e5b26e9aeb49e5318eb6cb68ed2ee97">&#9670;&nbsp;</a></span>sum_energy_quantities()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::sum_energy_quantities </td>
          <td>(</td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;{</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keywordflow">if</span> ( (<a class="code" href="classERF.html#a43d0b17f6e155691a1e9474526df3af5">verbose</a> &lt;= 0) || (<a class="code" href="classERF.html#ab546bcca3968440c6c24097f59b87f23">tot_e_datalog</a>.size() &lt; 1) ) { <span class="keywordflow">return</span>; }</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160; </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="keywordtype">int</span> lev = 0;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160; </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    AMREX_ALWAYS_ASSERT(lev == 0);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="comment">// ************************************************************************</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="comment">// WARNING: we are not filling ghost cells other than periodic outside the domain</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="comment">// ************************************************************************</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160; </div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    MultiFab mf_cc_vel(grids[lev], dmap[lev], AMREX_SPACEDIM, IntVect(1,1,1));</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    mf_cc_vel.setVal(0.); <span class="comment">// We just do this to avoid uninitialized values</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="comment">// Average all three components of velocity (on faces) to the cell center</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    average_face_to_cellcenter(mf_cc_vel,0,</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                               Array&lt;const MultiFab*,3&gt;{&amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                                                        &amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                                                        &amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>]});</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    mf_cc_vel.FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160; </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keywordflow">if</span> (!geom[lev].isPeriodic(0) || !geom[lev].isPeriodic(1) || !geom[lev].isPeriodic(2)) {</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        amrex::Warning(<span class="stringliteral">&quot;Ghost cells outside non-periodic physical boundaries are not filled -- vel set to 0 there&quot;</span>);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    }</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160; </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    MultiFab tot_mass  (grids[lev], dmap[lev], AMREX_SPACEDIM, IntVect(0,0,0));</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    MultiFab tot_energy(grids[lev], dmap[lev], AMREX_SPACEDIM, IntVect(0,0,0));</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160; </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span>&amp; dx = geom[lev].CellSizeArray();</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keywordtype">bool</span> is_moist = (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> != MoistureType::None);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160; </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="preprocessor">#pragma omp parallel if (amrex::Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keywordflow">for</span> (MFIter mfi(tot_mass, TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    {</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160; </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        <span class="keyword">const</span> Array4&lt;Real&gt;&amp; cc_vel_arr     = mf_cc_vel.array(mfi);</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        <span class="keyword">const</span> Array4&lt;Real&gt;&amp; tot_mass_arr   = tot_mass.array(mfi);</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <span class="keyword">const</span> Array4&lt;Real&gt;&amp; tot_energy_arr = tot_energy.array(mfi);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <span class="keyword">const</span> Array4&lt;const Real&gt;&amp; cons_arr = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].const_array(mfi);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <span class="keyword">const</span> Array4&lt;const Real&gt;&amp; z_arr    = (<a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev]) ? <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev]-&gt;const_array(mfi) :</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                                                                Array4&lt;const Real&gt;{};</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        ParallelFor(bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        {</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            Real Qv   = (is_moist) ? cons_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#aa965e9988f14d5d2a5aef4a942168a15">RhoQ1_comp</a>) : 0.0;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            Real Qc   = (is_moist) ? cons_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#a3bf0a4783e82ba30db2b7c0a332c2f16">RhoQ2_comp</a>) : 0.0;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            Real Qt   = Qv + Qc;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            Real Rhod = cons_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            Real Rhot = Rhod * (1.0 + Qt);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            Real Temp = <a class="code" href="ERF__EOS_8H.html#a65cf1718b7a1fcc56cb16685642543da">getTgivenRandRTh</a>(Rhod, cons_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>), Qv);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;            Real TKE  = 0.5 * ( cc_vel_arr(i,j,k,0)*cc_vel_arr(i,j,k,0)</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                              + cc_vel_arr(i,j,k,1)*cc_vel_arr(i,j,k,1)</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                              + cc_vel_arr(i,j,k,2)*cc_vel_arr(i,j,k,2) );</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;            Real zval = (z_arr) ? z_arr(i,j,k) : Real(k)*dx[2];</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160; </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;            Real Cv   = <a class="code" href="ERF__Constants_8H.html#a1ee33e063343c8fb15ed025c456ebd46">Cp_d</a> - <a class="code" href="ERF__Constants_8H.html#aeb133d0ac46d639050313ce36187e870">R_d</a>;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;            Real Cvv  = <a class="code" href="ERF__Constants_8H.html#aea1cea8d633adb36e2ea5018925b68ee">Cp_v</a> - <a class="code" href="ERF__Constants_8H.html#a0ab59ff21ef0b178fde0843394f5674a">R_v</a>;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;            Real Cpv  = <a class="code" href="ERF__Constants_8H.html#aea1cea8d633adb36e2ea5018925b68ee">Cp_v</a>;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160; </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            tot_mass_arr(i,j,k)   = Rhot;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            tot_energy_arr(i,j,k) = Rhod * ( (Cv + Cvv*Qv + Cpv*Qc)*Temp - <a class="code" href="ERF__Constants_8H.html#aee80ef06f62b6528b776d02de062cdd5">L_v</a>*Qc</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                                           + (1.0 + Qt)*TKE + (1.0 + Qt)*<a class="code" href="ERF__Constants_8H.html#ac2d0c304ab1117368778efcda612de43">CONST_GRAV</a>*zval );</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160; </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        });</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160; </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    }</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160; </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    Real  tot_mass_avg   = <a class="code" href="classERF.html#ad156903a5d71364b5fb5884000f28a8a">volWgtSumMF</a>(lev, tot_mass  , 0, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    Real  tot_energy_avg = <a class="code" href="classERF.html#ad156903a5d71364b5fb5884000f28a8a">volWgtSumMF</a>(lev, tot_energy, 0, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160; </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="comment">// Get volume including terrain (consistent with volWgtSumMF routine)</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    MultiFab volume(grids[lev], dmap[lev], 1, 0);</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    Real cell_vol  = dx[0]*dx[1]*dx[2];</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    volume.setVal(cell_vol);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structSolverChoice.html#a1952672901901b0b3a628f2298dc72c2">SolverChoice::mesh_type</a> != MeshType::ConstantDz) {</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        MultiFab::Multiply(volume, *<a class="code" href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">detJ_cc</a>[lev], 0, 0, 1, 0);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    }</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="preprocessor">#pragma omp parallel if (amrex::Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="keywordflow">for</span> (MFIter mfi(volume, TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    {</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        <span class="keyword">const</span> Box&amp; tbx  = mfi.tilebox();</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        <span class="keyword">auto</span> dst        = volume.array(mfi);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span>&amp; mfx = <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85bac2a428daaf1a1b398630fa8cec7f115b">MapFacType::m_x</a>]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span>&amp; mfy = <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85ba9612b6816e2fb7dc3ad56d6bc1fb7df8">MapFacType::m_y</a>]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        ParallelFor(tbx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        {</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            dst(i,j,k) /= (mfx(i,j,0)*mfy(i,j,0));</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        });</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    }</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    Real vol = volume.sum();</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160; </div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="comment">// Divide by the volume</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    tot_mass_avg   /= vol;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    tot_energy_avg /= vol;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> nfoo = 2;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    Real foo[nfoo] = {tot_mass_avg,tot_energy_avg};</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="preprocessor">#ifdef AMREX_LAZY</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    Lazy::QueueReduction([=]() <span class="keyword">mutable</span> {</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    ParallelDescriptor::ReduceRealSum(</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        foo, nfoo, ParallelDescriptor::IOProcessorNumber());</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160; </div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      <span class="keywordflow">if</span> (ParallelDescriptor::IOProcessor()) {</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        tot_mass_avg   = foo[i++];</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        tot_energy_avg = foo[i++];</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160; </div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        std::ostream&amp; data_log_energy = *<a class="code" href="classERF.html#ab546bcca3968440c6c24097f59b87f23">tot_e_datalog</a>[0];</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160; </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        <span class="keywordflow">if</span> (time == 0.0) {</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;            data_log_energy &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; <span class="stringliteral">&quot;          time&quot;</span>;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;            data_log_energy &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; <span class="stringliteral">&quot;      tot_mass&quot;</span>;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;            data_log_energy &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; <span class="stringliteral">&quot;    tot_energy&quot;</span>;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;            data_log_energy &lt;&lt; std::endl;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        }</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        data_log_energy &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; std::setprecision(<a class="code" href="classERF.html#a2307b817178b00e5cc38c0e163da0a39">timeprecision</a>) &lt;&lt; time;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        data_log_energy &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; std::setprecision(<a class="code" href="classERF.html#aefeb0bde962c9f53aba32e4ab59b4958">datprecision</a>)  &lt;&lt; tot_mass_avg;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        data_log_energy &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; std::setprecision(<a class="code" href="classERF.html#aefeb0bde962c9f53aba32e4ab59b4958">datprecision</a>)  &lt;&lt; tot_energy_avg;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        data_log_energy &lt;&lt; std::endl;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160; </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      } <span class="comment">// if IOProcessor</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="preprocessor">#ifdef AMREX_LAZY</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    }</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;}</div>
<div class="ttc" id="aERF__Constants_8H_html_a0ab59ff21ef0b178fde0843394f5674a"><div class="ttname"><a href="ERF__Constants_8H.html#a0ab59ff21ef0b178fde0843394f5674a">R_v</a></div><div class="ttdeci">constexpr amrex::Real R_v</div><div class="ttdef"><b>Definition:</b> ERF_Constants.H:11</div></div>
<div class="ttc" id="aERF__Constants_8H_html_a1ee33e063343c8fb15ed025c456ebd46"><div class="ttname"><a href="ERF__Constants_8H.html#a1ee33e063343c8fb15ed025c456ebd46">Cp_d</a></div><div class="ttdeci">constexpr amrex::Real Cp_d</div><div class="ttdef"><b>Definition:</b> ERF_Constants.H:12</div></div>
<div class="ttc" id="aERF__Constants_8H_html_ac2d0c304ab1117368778efcda612de43"><div class="ttname"><a href="ERF__Constants_8H.html#ac2d0c304ab1117368778efcda612de43">CONST_GRAV</a></div><div class="ttdeci">constexpr amrex::Real CONST_GRAV</div><div class="ttdef"><b>Definition:</b> ERF_Constants.H:21</div></div>
<div class="ttc" id="aERF__Constants_8H_html_aea1cea8d633adb36e2ea5018925b68ee"><div class="ttname"><a href="ERF__Constants_8H.html#aea1cea8d633adb36e2ea5018925b68ee">Cp_v</a></div><div class="ttdeci">constexpr amrex::Real Cp_v</div><div class="ttdef"><b>Definition:</b> ERF_Constants.H:13</div></div>
<div class="ttc" id="aERF__Constants_8H_html_aeb133d0ac46d639050313ce36187e870"><div class="ttname"><a href="ERF__Constants_8H.html#aeb133d0ac46d639050313ce36187e870">R_d</a></div><div class="ttdeci">constexpr amrex::Real R_d</div><div class="ttdef"><b>Definition:</b> ERF_Constants.H:10</div></div>
<div class="ttc" id="aERF__Constants_8H_html_aee80ef06f62b6528b776d02de062cdd5"><div class="ttname"><a href="ERF__Constants_8H.html#aee80ef06f62b6528b776d02de062cdd5">L_v</a></div><div class="ttdeci">constexpr amrex::Real L_v</div><div class="ttdef"><b>Definition:</b> ERF_Constants.H:16</div></div>
<div class="ttc" id="aERF__EOS_8H_html_a65cf1718b7a1fcc56cb16685642543da"><div class="ttname"><a href="ERF__EOS_8H.html#a65cf1718b7a1fcc56cb16685642543da">getTgivenRandRTh</a></div><div class="ttdeci">AMREX_GPU_HOST_DEVICE AMREX_FORCE_INLINE amrex::Real getTgivenRandRTh(const amrex::Real rho, const amrex::Real rhotheta, const amrex::Real qv=0.0)</div><div class="ttdef"><b>Definition:</b> ERF_EOS.H:46</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a3e5b26e9aeb49e5318eb6cb68ed2ee97_cgraph.png" border="0" usemap="#aclassERF_a3e5b26e9aeb49e5318eb6cb68ed2ee97_cgraph" alt=""/></div>
<map name="aclassERF_a3e5b26e9aeb49e5318eb6cb68ed2ee97_cgraph" id="aclassERF_a3e5b26e9aeb49e5318eb6cb68ed2ee97_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,212,32"/>
<area shape="rect" href="ERF__EOS_8H.html#a65cf1718b7a1fcc56cb16685642543da" title=" " alt="" coords="260,5,404,32"/>
</map>
</div>

</div>
</div>
<a id="a922892a05ee0c5bccd210a3e5a8599e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a922892a05ee0c5bccd210a3e5a8599e1">&#9670;&nbsp;</a></span>sum_integrated_quantities()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::sum_integrated_quantities </td>
          <td>(</td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Computes the integrated quantities on the grid such as the total scalar and total mass quantities. Prints and writes to output file.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">time</td><td>Current time </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;{</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    BL_PROFILE(<span class="stringliteral">&quot;ERF::sum_integrated_quantities()&quot;</span>);</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a43d0b17f6e155691a1e9474526df3af5">verbose</a> &lt;= 0)</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <span class="comment">// Single level sum</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    Real mass_sl;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="comment">// Multilevel sums</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    Real mass_ml = 0.0;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    Real rhth_ml = 0.0;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    Real scal_ml = 0.0;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    Real mois_ml = 0.0;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#if 1</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    mass_sl = <a class="code" href="classERF.html#ad156903a5d71364b5fb5884000f28a8a">volWgtSumMF</a>(0,<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[0][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>,<span class="keyword">false</span>);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; lev++) {</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        mass_ml += <a class="code" href="classERF.html#ad156903a5d71364b5fb5884000f28a8a">volWgtSumMF</a>(lev,<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>,<span class="keyword">true</span>);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    }</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; lev++) {</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        MultiFab pert_dens(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].boxArray(),</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;                           <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].DistributionMap(),</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                           1,0);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        MultiFab r_hse (<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev], make_alias, <a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91abc888a343d4fcc4fc4ffb79c6ac7cb93">BaseState::r0_comp</a>, 1);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        <span class="keywordflow">for</span> ( MFIter mfi(pert_dens,TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        {</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;            <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;            <span class="keyword">const</span> Array4&lt;Real      &gt;&amp; pert_dens_arr = pert_dens.array(mfi);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;            <span class="keyword">const</span> Array4&lt;Real const&gt;&amp;         S_arr = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].const_array(mfi);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;            <span class="keyword">const</span> Array4&lt;Real const&gt;&amp;        r0_arr = r_hse.const_array(mfi);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;            ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept {</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;                pert_dens_arr(i, j, k, 0) = S_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>) - r0_arr(i,j,k);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;            });</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        }</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <span class="keywordflow">if</span> (lev == 0) {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;            mass_sl = <a class="code" href="classERF.html#ad156903a5d71364b5fb5884000f28a8a">volWgtSumMF</a>(0,pert_dens,0,<span class="keyword">false</span>);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        }</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        mass_ml += <a class="code" href="classERF.html#ad156903a5d71364b5fb5884000f28a8a">volWgtSumMF</a>(lev,pert_dens,0,<span class="keyword">true</span>);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    } <span class="comment">// lev</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    Real rhth_sl = <a class="code" href="classERF.html#ad156903a5d71364b5fb5884000f28a8a">volWgtSumMF</a>(0,<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[0][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], <a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>,<span class="keyword">false</span>);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    Real scal_sl = <a class="code" href="classERF.html#ad156903a5d71364b5fb5884000f28a8a">volWgtSumMF</a>(0,<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[0][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],<a class="code" href="ERF__IndexDefines_8H.html#a0296f21cd48e5d8236c62ae4ce319b2f">RhoScalar_comp</a>,<span class="keyword">false</span>);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    Real mois_sl = 0.0;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> != MoistureType::None) {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <span class="keywordtype">int</span> n_qstate_moist = <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;Get_Qstate_Moist_Size();</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> qoff(0); qoff&lt;n_qstate_moist; ++qoff) {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;            mois_sl += <a class="code" href="classERF.html#ad156903a5d71364b5fb5884000f28a8a">volWgtSumMF</a>(0,<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[0][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],<a class="code" href="ERF__IndexDefines_8H.html#aa965e9988f14d5d2a5aef4a942168a15">RhoQ1_comp</a>+qoff,<span class="keyword">false</span>);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        }</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    }</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; lev++) {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        rhth_ml += <a class="code" href="classERF.html#ad156903a5d71364b5fb5884000f28a8a">volWgtSumMF</a>(lev,<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], <a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>,<span class="keyword">true</span>);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        scal_ml += <a class="code" href="classERF.html#ad156903a5d71364b5fb5884000f28a8a">volWgtSumMF</a>(lev,<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],<a class="code" href="ERF__IndexDefines_8H.html#a0296f21cd48e5d8236c62ae4ce319b2f">RhoScalar_comp</a>,<span class="keyword">true</span>);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> != MoistureType::None) {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            <span class="keywordtype">int</span> n_qstate_moist = <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;Get_Qstate_Moist_Size();</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> qoff(0); qoff&lt;n_qstate_moist; ++qoff) {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                mois_ml += <a class="code" href="classERF.html#ad156903a5d71364b5fb5884000f28a8a">volWgtSumMF</a>(lev,<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],<a class="code" href="ERF__IndexDefines_8H.html#aa965e9988f14d5d2a5aef4a942168a15">RhoQ1_comp</a>+qoff,<span class="keyword">false</span>);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        }</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    Gpu::HostVector&lt;Real&gt; h_avg_ustar; h_avg_ustar.resize(1);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    Gpu::HostVector&lt;Real&gt; h_avg_tstar; h_avg_tstar.resize(1);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    Gpu::HostVector&lt;Real&gt; h_avg_olen; h_avg_olen.resize(1);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="classERF.html#ac50bb696daf587e13f9a1e57c687375e">m_SurfaceLayer</a> != <span class="keyword">nullptr</span>) &amp;&amp; (<a class="code" href="classERF.html#ac1238c1616826c66df1dfd9076e6a3da">NumDataLogs</a>() &gt; 0)) {</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        Box domain = geom[0].Domain();</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <span class="keywordtype">int</span> zdir = 2;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        h_avg_ustar = sumToLine(*<a class="code" href="classERF.html#ac50bb696daf587e13f9a1e57c687375e">m_SurfaceLayer</a>-&gt;get_u_star(0),0,1,domain,zdir);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        h_avg_tstar = sumToLine(*<a class="code" href="classERF.html#ac50bb696daf587e13f9a1e57c687375e">m_SurfaceLayer</a>-&gt;get_t_star(0),0,1,domain,zdir);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        h_avg_olen  = sumToLine(*<a class="code" href="classERF.html#ac50bb696daf587e13f9a1e57c687375e">m_SurfaceLayer</a>-&gt;get_olen(0)  ,0,1,domain,zdir);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="comment">// Divide by the total number of cells we are averaging over</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        Real area_z = <span class="keyword">static_cast&lt;</span>Real<span class="keyword">&gt;</span>(domain.length(0)*domain.length(1));</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        h_avg_ustar[0] /= area_z;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        h_avg_tstar[0] /= area_z;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        h_avg_olen[0]  /= area_z;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        h_avg_ustar[0] = 0.;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        h_avg_tstar[0] = 0.;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        h_avg_olen[0]  = 0.;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    }</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> nfoo = 8;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    Real foo[nfoo] = {mass_sl,rhth_sl,scal_sl,mois_sl,mass_ml,rhth_ml,scal_ml,mois_ml};</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="preprocessor">#ifdef AMREX_LAZY</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    Lazy::QueueReduction([=]() <span class="keyword">mutable</span> {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    ParallelDescriptor::ReduceRealSum(</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        foo, nfoo, ParallelDescriptor::IOProcessorNumber());</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      <span class="keywordflow">if</span> (ParallelDescriptor::IOProcessor()) {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        mass_sl = foo[i++];</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        rhth_sl = foo[i++];</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        scal_sl = foo[i++];</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        mois_sl = foo[i++];</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        mass_ml = foo[i++];</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        rhth_ml = foo[i++];</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        scal_ml = foo[i++];</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        mois_ml = foo[i++];</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        Print() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        Print() &lt;&lt; <span class="stringliteral">&quot;TIME= &quot;</span> &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; std::setprecision(<a class="code" href="classERF.html#a2307b817178b00e5cc38c0e163da0a39">timeprecision</a>) &lt;&lt; std::left &lt;&lt; time &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <span class="keywordflow">if</span> (finest_level ==  0) {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="preprocessor">#if 1</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;           Print() &lt;&lt; <span class="stringliteral">&quot; MASS       = &quot;</span> &lt;&lt; mass_sl &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;           Print() &lt;&lt; <span class="stringliteral">&quot; PERT MASS  = &quot;</span> &lt;&lt; mass_sl &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;           Print() &lt;&lt; <span class="stringliteral">&quot; RHO THETA  = &quot;</span> &lt;&lt; rhth_sl &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;           Print() &lt;&lt; <span class="stringliteral">&quot; RHO SCALAR = &quot;</span> &lt;&lt; scal_sl &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;           Print() &lt;&lt; <span class="stringliteral">&quot; RHO QTOTAL = &quot;</span> &lt;&lt; mois_sl &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="preprocessor">#if 1</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;           Print() &lt;&lt; <span class="stringliteral">&quot; MASS       SL/ML = &quot;</span> &lt;&lt; mass_sl &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; mass_ml &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;           Print() &lt;&lt; <span class="stringliteral">&quot; PERT MASS  SL/ML = &quot;</span> &lt;&lt; mass_sl &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; mass_ml &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;           Print() &lt;&lt; <span class="stringliteral">&quot; RHO THETA  SL/ML = &quot;</span> &lt;&lt; rhth_sl &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; rhth_ml &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;           Print() &lt;&lt; <span class="stringliteral">&quot; RHO SCALAR SL/ML = &quot;</span> &lt;&lt; scal_sl &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; scal_ml &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;           Print() &lt;&lt; <span class="stringliteral">&quot; RHO QTOTAL SL/ML = &quot;</span> &lt;&lt; mois_sl &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; mois_ml &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        }</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="comment">// The first data log only holds scalars</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ac1238c1616826c66df1dfd9076e6a3da">NumDataLogs</a>() &gt; 0)</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            <span class="keywordtype">int</span> n_d = 0;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            std::ostream&amp; data_log1 = <a class="code" href="classERF.html#aa2c3ee1910008b828b9da79ccdfe3871">DataLog</a>(n_d);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            <span class="keywordflow">if</span> (data_log1.good()) {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                <span class="keywordflow">if</span> (time == 0.0) {</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                    data_log1 &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; <span class="stringliteral">&quot;          time&quot;</span>;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                    data_log1 &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; <span class="stringliteral">&quot;          u_star&quot;</span>;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                    data_log1 &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; <span class="stringliteral">&quot;          t_star&quot;</span>;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                    data_log1 &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; <span class="stringliteral">&quot;          olen&quot;</span>;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                    data_log1 &lt;&lt; std::endl;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                } <span class="comment">// time = 0</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;              <span class="comment">// Write the quantities at this time</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;              data_log1 &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; std::setprecision(<a class="code" href="classERF.html#a2307b817178b00e5cc38c0e163da0a39">timeprecision</a>) &lt;&lt; time;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;              data_log1 &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; std::setprecision(<a class="code" href="classERF.html#aefeb0bde962c9f53aba32e4ab59b4958">datprecision</a>)  &lt;&lt; h_avg_ustar[0];</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;              data_log1 &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; std::setprecision(<a class="code" href="classERF.html#aefeb0bde962c9f53aba32e4ab59b4958">datprecision</a>)  &lt;&lt; h_avg_tstar[0];</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;              data_log1 &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; std::setprecision(<a class="code" href="classERF.html#aefeb0bde962c9f53aba32e4ab59b4958">datprecision</a>)  &lt;&lt; h_avg_olen[0];</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;              data_log1 &lt;&lt; std::endl;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            } <span class="comment">// if good</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        } <span class="comment">// loop over i</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      } <span class="comment">// if IOProcessor</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="preprocessor">#ifdef AMREX_LAZY</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    });</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="comment">// This is just an alias for convenience</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keywordtype">int</span> lev = 0;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a41324a4b5610fde725fe721550b23c85">NumSamplePointLogs</a>() &gt; 0 &amp;&amp; <a class="code" href="classERF.html#a5bc7dd2c7e1ebf65b7dc1d9bf0dfb36f">NumSamplePoints</a>() &gt; 0) {</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classERF.html#a5bc7dd2c7e1ebf65b7dc1d9bf0dfb36f">NumSamplePoints</a>(); ++i)</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            <a class="code" href="classERF.html#aa28182226262c67cfd686d35bfeabcad">sample_points</a>(lev, time, <a class="code" href="classERF.html#a9095d1b641b4d7f32ca5acb679786891">SamplePoint</a>(i), <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>]);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        }</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    }</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a14f922bdc3a0f23c087afa32c67ac119">NumSampleLineLogs</a>() &gt; 0 &amp;&amp; <a class="code" href="classERF.html#a70d78ca624acf09d8faab9a2d51264d9">NumSampleLines</a>() &gt; 0) {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classERF.html#a70d78ca624acf09d8faab9a2d51264d9">NumSampleLines</a>(); ++i)</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            <a class="code" href="classERF.html#afb798c72ea4fde6f4da8d01a24c8c165">sample_lines</a>(lev, time, <a class="code" href="classERF.html#a54357e2f81f3d7d3a9189a3e21283e6b">SampleLine</a>(i), <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>]);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        }</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    }</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_a14f922bdc3a0f23c087afa32c67ac119"><div class="ttname"><a href="classERF.html#a14f922bdc3a0f23c087afa32c67ac119">ERF::NumSampleLineLogs</a></div><div class="ttdeci">AMREX_FORCE_INLINE int NumSampleLineLogs() noexcept</div><div class="ttdef"><b>Definition:</b> ERF.H:1287</div></div>
<div class="ttc" id="aclassERF_html_a41324a4b5610fde725fe721550b23c85"><div class="ttname"><a href="classERF.html#a41324a4b5610fde725fe721550b23c85">ERF::NumSamplePointLogs</a></div><div class="ttdeci">AMREX_FORCE_INLINE int NumSamplePointLogs() noexcept</div><div class="ttdef"><b>Definition:</b> ERF.H:1273</div></div>
<div class="ttc" id="aclassERF_html_a54357e2f81f3d7d3a9189a3e21283e6b"><div class="ttname"><a href="classERF.html#a54357e2f81f3d7d3a9189a3e21283e6b">ERF::SampleLine</a></div><div class="ttdeci">amrex::IntVect &amp; SampleLine(int i)</div><div class="ttdef"><b>Definition:</b> ERF.H:1306</div></div>
<div class="ttc" id="aclassERF_html_a5bc7dd2c7e1ebf65b7dc1d9bf0dfb36f"><div class="ttname"><a href="classERF.html#a5bc7dd2c7e1ebf65b7dc1d9bf0dfb36f">ERF::NumSamplePoints</a></div><div class="ttdeci">AMREX_FORCE_INLINE int NumSamplePoints() noexcept</div><div class="ttdef"><b>Definition:</b> ERF.H:1300</div></div>
<div class="ttc" id="aclassERF_html_a70d78ca624acf09d8faab9a2d51264d9"><div class="ttname"><a href="classERF.html#a70d78ca624acf09d8faab9a2d51264d9">ERF::NumSampleLines</a></div><div class="ttdeci">AMREX_FORCE_INLINE int NumSampleLines() noexcept</div><div class="ttdef"><b>Definition:</b> ERF.H:1313</div></div>
<div class="ttc" id="aclassERF_html_a9095d1b641b4d7f32ca5acb679786891"><div class="ttname"><a href="classERF.html#a9095d1b641b4d7f32ca5acb679786891">ERF::SamplePoint</a></div><div class="ttdeci">amrex::IntVect &amp; SamplePoint(int i)</div><div class="ttdef"><b>Definition:</b> ERF.H:1293</div></div>
<div class="ttc" id="aclassERF_html_aa28182226262c67cfd686d35bfeabcad"><div class="ttname"><a href="classERF.html#aa28182226262c67cfd686d35bfeabcad">ERF::sample_points</a></div><div class="ttdeci">void sample_points(int lev, amrex::Real time, amrex::IntVect cell, amrex::MultiFab &amp;mf)</div><div class="ttdef"><b>Definition:</b> ERF_WriteScalarProfiles.cpp:527</div></div>
<div class="ttc" id="aclassERF_html_aa2c3ee1910008b828b9da79ccdfe3871"><div class="ttname"><a href="classERF.html#aa2c3ee1910008b828b9da79ccdfe3871">ERF::DataLog</a></div><div class="ttdeci">AMREX_FORCE_INLINE std::ostream &amp; DataLog(int i)</div><div class="ttdef"><b>Definition:</b> ERF.H:1237</div></div>
<div class="ttc" id="aclassERF_html_ac1238c1616826c66df1dfd9076e6a3da"><div class="ttname"><a href="classERF.html#ac1238c1616826c66df1dfd9076e6a3da">ERF::NumDataLogs</a></div><div class="ttdeci">AMREX_FORCE_INLINE int NumDataLogs() noexcept</div><div class="ttdef"><b>Definition:</b> ERF.H:1251</div></div>
<div class="ttc" id="aclassERF_html_afb798c72ea4fde6f4da8d01a24c8c165"><div class="ttname"><a href="classERF.html#afb798c72ea4fde6f4da8d01a24c8c165">ERF::sample_lines</a></div><div class="ttdeci">void sample_lines(int lev, amrex::Real time, amrex::IntVect cell, amrex::MultiFab &amp;mf)</div><div class="ttdef"><b>Definition:</b> ERF_WriteScalarProfiles.cpp:563</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aff397ccf7eb99c51d7c705a35e85ec5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff397ccf7eb99c51d7c705a35e85ec5f">&#9670;&nbsp;</a></span>timeStep()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::timeStep </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iteration</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Function that coordinates the evolution across levels &ndash; this calls Advance to do the actual advance at this level, then recursively calls itself at finer levels</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">lev</td><td>level of refinement (coarsest level is 0) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">time</td><td>start time for time advance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iteration</td><td>time step counter </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;{</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <span class="comment">// We need to FillPatch the coarse level before assessing whether to regrid</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="comment">// We have not done the swap yet so we fill the &quot;new&quot; which will become the &quot;old&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    MultiFab&amp; S_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>];</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    MultiFab&amp; U_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>];</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    MultiFab&amp; V_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>];</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    MultiFab&amp; W_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>];</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#ifdef ERF_USE_NETCDF</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="comment">// Since we now only read in a subset of the time slices in wrfbdy we need to check</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="comment">//       whether it&#39;s time to read in more</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ad57b63939b19e90b87dd61d3f293b0d7">use_real_bcs</a> &amp;&amp; (lev==0)) {</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        Real dT = bdy_time_interval;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        Real time_since_start_old = time - start_bdy_time;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        <span class="keywordtype">int</span> n_time_old = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( time_since_start_old /  dT);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        Real time_since_start_new = time + <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[lev] - start_bdy_time;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        <span class="keywordtype">int</span> n_time_new = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( time_since_start_new /  dT);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        <span class="keywordtype">int</span> ntimes = bdy_data_xlo.size();</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> itime = 0; itime &lt; ntimes; itime++)</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        {</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;            <span class="comment">//if (bdy_data_xlo[itime].size() &gt; 0) {</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;            <span class="comment">//    amrex::Print() &lt;&lt; &quot;HAVE  DATA AT TIME &quot; &lt;&lt; itime &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;            <span class="comment">//} else {</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;            <span class="comment">//    amrex::Print() &lt;&lt; &quot; NO   DATA AT TIME &quot; &lt;&lt; itime &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;            <span class="comment">//}</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;            <span class="keywordtype">bool</span> clear_itime = (itime &lt; n_time_old);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;            <span class="keywordflow">if</span> (clear_itime &amp;&amp; bdy_data_xlo[itime].size() &gt; 0) {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                bdy_data_xlo[itime].clear();</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                <span class="comment">//amrex::Print() &lt;&lt; &quot;CLEAR  DATA AT TIME &quot; &lt;&lt; itime &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            }</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;            <span class="keywordtype">bool</span> need_itime = (itime &gt;= n_time_old &amp;&amp; itime &lt;= n_time_new+1);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;            <span class="comment">//if (need_itime) amrex::Print()  &lt;&lt; &quot;NEED  DATA AT TIME &quot; &lt;&lt; itime &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;            <span class="keywordflow">if</span> (bdy_data_xlo[itime].size() == 0 &amp;&amp; need_itime) {</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;               read_from_wrfbdy(itime,<a class="code" href="classERF.html#a7e9040f32464f1a6dee6e0384393451d">nc_bdy_file</a>,geom[0].Domain(),</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                                bdy_data_xlo,bdy_data_xhi,bdy_data_ylo,bdy_data_yhi,</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                                <a class="code" href="classERF.html#abb15119348ad5399947bc8883084b230">real_width</a>);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;               <span class="keywordtype">bool</span> use_moist = (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> != MoistureType::None);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;               convert_all_wrfbdy_data(itime, geom[0].Domain(), bdy_data_xlo, bdy_data_xhi, bdy_data_ylo, bdy_data_yhi,</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                                   *<a class="code" href="classERF.html#aed4ae5792dd32adf56d3c052ce79437f">mf_MUB</a>[lev], *<a class="code" href="classERF.html#a8839af37a73c4c2e76bf978a05275ca9">mf_C1H</a>[lev], *<a class="code" href="classERF.html#ad473e8e616ea3f7bf7bf922a0fe16208">mf_C2H</a>[lev],</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                                   <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                                   geom[lev], use_moist);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;           }</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        } <span class="comment">// itime</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    } <span class="comment">// use_real_bcs &amp;&amp; lev == 0</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="comment">// NOTE: the momenta here are not fillpatched (they are only used as scratch space)</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keywordflow">if</span> (lev == 0) {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <a class="code" href="classERF.html#afded764725240c356faffa97dddbe03d">FillPatch</a>(lev, time, {&amp;S_new, &amp;U_new, &amp;V_new, &amp;W_new});</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (lev &lt; finest_level) {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <a class="code" href="classERF.html#afded764725240c356faffa97dddbe03d">FillPatch</a>(lev, time, {&amp;S_new, &amp;U_new, &amp;V_new, &amp;W_new},</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                             {&amp;S_new, &amp;<a class="code" href="classERF.html#a01f3db32272f53dc68025f0a98195e57">rU_new</a>[lev], &amp;<a class="code" href="classERF.html#a54e37988486ef96e55e84bd8e91bb688">rV_new</a>[lev], &amp;<a class="code" href="classERF.html#aa46c0b0d20525aed10f447923e54dde7">rW_new</a>[lev]},</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                             <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev], <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev]);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    }</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a3937527f96c81674fa38dc34ed24f3f5">regrid_int</a> &gt; 0)  <span class="comment">// We may need to regrid</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <span class="comment">// help keep track of whether a level was already regridded</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="comment">// from a coarser level call to regrid</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <span class="keyword">static</span> Vector&lt;int&gt; last_regrid_step(max_level+1, 0);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <span class="comment">// regrid changes level &quot;lev+1&quot; so we don&#39;t regrid on max_level</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="comment">// also make sure we don&#39;t regrid fine levels again if</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <span class="comment">// it was taken care of during a coarser regrid</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="keywordflow">if</span> (lev &lt; max_level)</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            <span class="keywordflow">if</span> ( (<a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[lev] % <a class="code" href="classERF.html#a3937527f96c81674fa38dc34ed24f3f5">regrid_int</a> == 0) &amp;&amp; (<a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[lev] &gt; last_regrid_step[lev]) )</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            {</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                <span class="comment">// regrid could add newly refine levels (if finest_level &lt; max_level)</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                <span class="comment">// so we save the previous finest level index</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                <span class="keywordtype">int</span> old_finest = finest_level;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                regrid(lev, time);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="preprocessor">#ifdef ERF_USE_PARTICLES</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                <span class="keywordflow">if</span> (finest_level != old_finest) {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                    particleData.Redistribute();</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                <span class="comment">// mark that we have regridded this level already</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = lev; k &lt;= finest_level; ++k) {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                    last_regrid_step[k] = <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[k];</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                }</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                <span class="comment">// if there are newly created levels, set the time step</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = old_finest+1; k &lt;= finest_level; ++k) {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                    <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[k] = <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[k-1] / MaxRefRatio(k-1);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                }</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            } <span class="comment">// if</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        } <span class="comment">// lev</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    }</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="comment">// Update what we call &quot;old&quot; and &quot;new&quot; time</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <a class="code" href="classERF.html#a7085d7d5fc94a0f84efc06957267d58e">t_old</a>[lev] = <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev];</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev] += <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[lev];</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordflow">if</span> (Verbose()) {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;[Level &quot;</span> &lt;&lt; lev &lt;&lt; <span class="stringliteral">&quot; step &quot;</span> &lt;&lt; <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[lev]+1 &lt;&lt; <span class="stringliteral">&quot;] &quot;</span>;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        amrex::Print() &lt;&lt; std::setprecision(<a class="code" href="classERF.html#a2307b817178b00e5cc38c0e163da0a39">timeprecision</a>)</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot;ADVANCE from time = &quot;</span> &lt;&lt; <a class="code" href="classERF.html#a7085d7d5fc94a0f84efc06957267d58e">t_old</a>[lev] &lt;&lt; <span class="stringliteral">&quot; to &quot;</span> &lt;&lt; <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev]</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot; with dt = &quot;</span> &lt;&lt; <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[lev] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    }</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="preprocessor">#ifdef ERF_USE_WW3_COUPLING</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    amrex::Print() &lt;&lt;  <span class="stringliteral">&quot; About to call send_to_ww3 from ERF_Timestep&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    send_to_ww3(lev);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    amrex::Print() &lt;&lt;  <span class="stringliteral">&quot; About to call read_waves from ERF_Timestep&quot;</span>  &lt;&lt; std::endl;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    read_waves(lev);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="comment">//send_to_ww3(lev);</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="comment">//read_waves(lev);</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="comment">//send_to_ww3(lev);</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="comment">// Advance a single level for a single time step</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <a class="code" href="classERF.html#a47413fe5588f7dd71a1d5087a9e804f9">Advance</a>(lev, time, <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[lev], <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[lev], <a class="code" href="classERF.html#aa3db2dd1b65310c66c4038650c22aaee">nsubsteps</a>[lev]);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    ++<a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[lev];</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordflow">if</span> (Verbose()) {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;[Level &quot;</span> &lt;&lt; lev &lt;&lt; <span class="stringliteral">&quot; step &quot;</span> &lt;&lt; <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[lev] &lt;&lt; <span class="stringliteral">&quot;] &quot;</span>;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Advanced &quot;</span> &lt;&lt; CountCells(lev) &lt;&lt; <span class="stringliteral">&quot; cells&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    }</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordflow">if</span> (lev &lt; finest_level)</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="comment">// recursive call for next-finer level</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt;= <a class="code" href="classERF.html#aa3db2dd1b65310c66c4038650c22aaee">nsubsteps</a>[lev+1]; ++i)</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            Real strt_time_for_fine = time + (i-1)*<a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[lev+1];</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            <a class="code" href="classERF.html#aff397ccf7eb99c51d7c705a35e85ec5f">timeStep</a>(lev+1, strt_time_for_fine, i);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        }</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    }</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a43d0b17f6e155691a1e9474526df3af5">verbose</a> &amp;&amp; lev == 0 &amp;&amp; <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> != MoistureType::None) {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Cloud fraction &quot;</span> &lt;&lt; time &lt;&lt; <span class="stringliteral">&quot;  &quot;</span> &lt;&lt; <a class="code" href="classERF.html#a0f6effb7eeed11385b20e4bbf516b459">cloud_fraction</a>(time) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    }</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_a0f6effb7eeed11385b20e4bbf516b459"><div class="ttname"><a href="classERF.html#a0f6effb7eeed11385b20e4bbf516b459">ERF::cloud_fraction</a></div><div class="ttdeci">amrex::Real cloud_fraction(amrex::Real time)</div><div class="ttdef"><b>Definition:</b> ERF_WriteScalarProfiles.cpp:451</div></div>
<div class="ttc" id="aclassERF_html_a47413fe5588f7dd71a1d5087a9e804f9"><div class="ttname"><a href="classERF.html#a47413fe5588f7dd71a1d5087a9e804f9">ERF::Advance</a></div><div class="ttdeci">void Advance(int lev, amrex::Real time, amrex::Real dt_lev, int iteration, int ncycle)</div><div class="ttdef"><b>Definition:</b> ERF_Advance.cpp:23</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afb76c0633e2ba944c543e7a03a5e9424"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb76c0633e2ba944c543e7a03a5e9424">&#9670;&nbsp;</a></span>turbPert_amplitude()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::turbPert_amplitude </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;{</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="comment">// Accessing data</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keyword">auto</span>&amp; lev_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev];</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="comment">// Creating local data</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="keywordtype">int</span> ncons = lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nComp();</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    MultiFab cons_data(lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], make_alias, 0, ncons);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="comment">// Defining BoxArray type</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keyword">auto</span> m_ixtype = cons_data.boxArray().ixType();</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#pragma omp parallel if (amrex::Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordflow">for</span> (MFIter mfi(lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], <a class="code" href="ERF__TileNoZ_8H.html#a8da113f1d5603f7297fe1d03e5013f00">TileNoZ</a>()); mfi.isValid(); ++mfi) {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        <span class="keyword">const</span> Box &amp;bx  = mfi.validbox();</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> &amp;cons_pert_arr = cons_data.array(mfi); <span class="comment">// Address of perturbation array</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <span class="keyword">const</span> amrex::Array4&lt;const amrex::Real&gt; &amp;pert_cell = <a class="code" href="classERF.html#ac1b9cce4a3c1736c4af78f6b0e2143ce">turbPert</a>.<a class="code" href="structTurbulentPerturbation.html#a0bc940e3c9b5cd1ebcf866aaa344cfed">pb_cell</a>[lev].array(mfi); <span class="comment">// per-cell perturbation stored in structure</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <a class="code" href="classERF.html#ac1b9cce4a3c1736c4af78f6b0e2143ce">turbPert</a>.<a class="code" href="structTurbulentPerturbation.html#adcb414231654ad9f5232a1a3377c30f2">apply_tpi</a>(lev, bx, <a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>, m_ixtype, cons_pert_arr, pert_cell);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    } <span class="comment">// mfi</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_afb76c0633e2ba944c543e7a03a5e9424_cgraph.png" border="0" usemap="#aclassERF_afb76c0633e2ba944c543e7a03a5e9424_cgraph" alt=""/></div>
<map name="aclassERF_afb76c0633e2ba944c543e7a03a5e9424_cgraph" id="aclassERF_afb76c0633e2ba944c543e7a03a5e9424_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,184,32"/>
<area shape="rect" href="ERF__TileNoZ_8H.html#a8da113f1d5603f7297fe1d03e5013f00" title=" " alt="" coords="232,5,305,32"/>
</map>
</div>

</div>
</div>
<a id="aa89efe0abf37918ce3f212fb0e26f1bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa89efe0abf37918ce3f212fb0e26f1bc">&#9670;&nbsp;</a></span>turbPert_update()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::turbPert_update </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real&#160;</td>
          <td class="paramname"><em>dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;{</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    <span class="comment">// Accessing data</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    <span class="keyword">auto</span>&amp; lev_new = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev];</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <span class="comment">// Create aliases to state data to pass to calc_tpi_update</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <span class="keywordtype">int</span> ncons = lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nComp();</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    MultiFab cons_data(lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], make_alias, 0, ncons);</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    MultiFab xvel_data(lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>], make_alias, 0, 1);</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    MultiFab yvel_data(lev_new[<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>], make_alias, 0, 1);</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="comment">// Computing perturbation update time</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <a class="code" href="classERF.html#ac1b9cce4a3c1736c4af78f6b0e2143ce">turbPert</a>.<a class="code" href="structTurbulentPerturbation.html#a5e6200f8b6bea3c4944dccc6c7285102">calc_tpi_update</a>(lev, local_dt, xvel_data, yvel_data, cons_data);</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    Print() &lt;&lt; <span class="stringliteral">&quot;Successfully initialized turbulent perturbation update time and amplitude with type: &quot;</span>&lt;&lt; <a class="code" href="classERF.html#ac1b9cce4a3c1736c4af78f6b0e2143ce">turbPert</a>.<a class="code" href="structTurbulentPerturbation.html#ad0d78e0adbb21ae36f4483dd30e15d58">pt_type</a> &lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;}</div>
<div class="ttc" id="astructTurbulentPerturbation_html_ad0d78e0adbb21ae36f4483dd30e15d58"><div class="ttname"><a href="structTurbulentPerturbation.html#ad0d78e0adbb21ae36f4483dd30e15d58">TurbulentPerturbation::pt_type</a></div><div class="ttdeci">int pt_type</div><div class="ttdef"><b>Definition:</b> ERF_TurbPertStruct.H:638</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a419510fced05e9afc05c466beeeb66f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a419510fced05e9afc05c466beeeb66f7">&#9670;&nbsp;</a></span>update_diffusive_arrays()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::update_diffusive_arrays </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::BoxArray &amp;&#160;</td>
          <td class="paramname"><em>ba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::DistributionMapping &amp;&#160;</td>
          <td class="paramname"><em>dm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;{</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="comment">// Diffusive terms</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="comment">// ********************************************************************************************</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="keywordtype">bool</span> l_use_terrain = (<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">SolverChoice::terrain_type</a> != TerrainType::None);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="keywordtype">bool</span> l_use_kturb   = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa53b017d79e0067923180a0aa59367b4">turbChoice</a>[lev].use_kturb;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="keywordtype">bool</span> l_use_diff    = ( (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a396122e87a3d15c4ec8666d7dd18c095">diffChoice</a>.<a class="code" href="structDiffChoice.html#aed5c75ec58e358a735d97869147b2baf">molec_diff_type</a> != <a class="code" href="ERF__DiffStruct_8H.html#a84e6bfbbb8e490790c506939b364f735a6adf97f83acf6453d4a6a4b1070f3754">MolecDiffType::None</a>) ||</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                           l_use_kturb );</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="keywordtype">bool</span> l_need_SmnSmn = <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa53b017d79e0067923180a0aa59367b4">turbChoice</a>[lev].use_keqn;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keywordtype">bool</span> l_use_moist   = (  <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> != MoistureType::None  );</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="keywordtype">bool</span> l_rotate      = (  <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ae6a9fda53f08dbed04adb4c63dc3176e">use_rotate_surface_flux</a>  );</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160; </div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    BoxArray ba12 = convert(ba, IntVect(1,1,0));</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    BoxArray ba13 = convert(ba, IntVect(1,0,1));</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    BoxArray ba23 = convert(ba, IntVect(0,1,1));</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160; </div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <a class="code" href="classERF.html#a3d4a3ed54fb357c02e6494461f182aa1">Tau</a>[lev].resize(9);</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160; </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keywordflow">if</span> (l_use_diff) {</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        <span class="comment">// NOTE: We require ghost cells in the vertical when allowing grids that don&#39;t</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        <span class="comment">//       cover the entire vertical extent of the domain at this level</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++) {</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;            <a class="code" href="classERF.html#a3d4a3ed54fb357c02e6494461f182aa1">Tau</a>[lev][i] = std::make_unique&lt;MultiFab&gt;( ba  , dm, 1, IntVect(1,1,1) );</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        }</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <a class="code" href="classERF.html#a3d4a3ed54fb357c02e6494461f182aa1">Tau</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248ba0a0d169ca6b3a0da988c65f1c284ba99">TauType::tau12</a>] = std::make_unique&lt;MultiFab&gt;( ba12, dm, 1, IntVect(1,1,1) );</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        <a class="code" href="classERF.html#a3d4a3ed54fb357c02e6494461f182aa1">Tau</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248baf5fa13cfd781cde0d363f337d7e76d7e">TauType::tau13</a>] = std::make_unique&lt;MultiFab&gt;( ba13, dm, 1, IntVect(1,1,1) );</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        <a class="code" href="classERF.html#a3d4a3ed54fb357c02e6494461f182aa1">Tau</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248ba181b302bd0f99081c3c22fa38e1f8b73">TauType::tau23</a>] = std::make_unique&lt;MultiFab&gt;( ba23, dm, 1, IntVect(1,1,1) );</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        <span class="keywordflow">if</span> (l_use_terrain) {</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            <a class="code" href="classERF.html#a3d4a3ed54fb357c02e6494461f182aa1">Tau</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248bad6968d5de54faf0f6a42e5629f76f391">TauType::tau21</a>] = std::make_unique&lt;MultiFab&gt;( ba12, dm, 1, IntVect(1,1,1) );</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;            <a class="code" href="classERF.html#a3d4a3ed54fb357c02e6494461f182aa1">Tau</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248bacec8728fd270452c9985e46f971d6935">TauType::tau31</a>] = std::make_unique&lt;MultiFab&gt;( ba13, dm, 1, IntVect(1,1,1) );</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;            <a class="code" href="classERF.html#a3d4a3ed54fb357c02e6494461f182aa1">Tau</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248babcbe024a60f6921af0060fd096ac8307">TauType::tau32</a>] = std::make_unique&lt;MultiFab&gt;( ba23, dm, 1, IntVect(1,1,1) );</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;            <a class="code" href="classERF.html#a3d4a3ed54fb357c02e6494461f182aa1">Tau</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248bad6968d5de54faf0f6a42e5629f76f391">TauType::tau21</a>] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            <a class="code" href="classERF.html#a3d4a3ed54fb357c02e6494461f182aa1">Tau</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248bacec8728fd270452c9985e46f971d6935">TauType::tau31</a>] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;            <a class="code" href="classERF.html#a3d4a3ed54fb357c02e6494461f182aa1">Tau</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a09df0fe8e0778d7f1052a97aa214248babcbe024a60f6921af0060fd096ac8307">TauType::tau32</a>] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        }</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <a class="code" href="classERF.html#a25174b4ae6cfcac8f7d183ce5c9fe67b">SFS_hfx1_lev</a>[lev] = std::make_unique&lt;MultiFab&gt;( convert(ba,IntVect(1,0,0)), dm, 1, IntVect(1,1,1) );</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        <a class="code" href="classERF.html#acb607b2e675b45fdcabc09b640ce5ae2">SFS_hfx2_lev</a>[lev] = std::make_unique&lt;MultiFab&gt;( convert(ba,IntVect(0,1,0)), dm, 1, IntVect(1,1,1) );</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        <a class="code" href="classERF.html#a1a2e3faf5dd90ad2f9ded28b486f3b46">SFS_hfx3_lev</a>[lev] = std::make_unique&lt;MultiFab&gt;( convert(ba,IntVect(0,0,1)), dm, 1, IntVect(1,1,1) );</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        <a class="code" href="classERF.html#a6e1ad417e3bd062468d74830b65911fb">SFS_diss_lev</a>[lev] = std::make_unique&lt;MultiFab&gt;( ba  , dm, 1, IntVect(1,1,1) );</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        <a class="code" href="classERF.html#a25174b4ae6cfcac8f7d183ce5c9fe67b">SFS_hfx1_lev</a>[lev]-&gt;setVal(0.);</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        <a class="code" href="classERF.html#acb607b2e675b45fdcabc09b640ce5ae2">SFS_hfx2_lev</a>[lev]-&gt;setVal(0.);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        <a class="code" href="classERF.html#a1a2e3faf5dd90ad2f9ded28b486f3b46">SFS_hfx3_lev</a>[lev]-&gt;setVal(0.);</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        <a class="code" href="classERF.html#a6e1ad417e3bd062468d74830b65911fb">SFS_diss_lev</a>[lev]-&gt;setVal(0.);</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <span class="keywordflow">if</span> (l_use_moist) {</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            <a class="code" href="classERF.html#a101ceb89b1a249efeea3f4e8052bc8c0">SFS_q1fx3_lev</a>[lev] = std::make_unique&lt;MultiFab&gt;( convert(ba,IntVect(0,0,1)), dm, 1, IntVect(1,1,1) );</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            <a class="code" href="classERF.html#a3ea10ef7383e594b6ee5e7a9ad67607b">SFS_q2fx3_lev</a>[lev] = std::make_unique&lt;MultiFab&gt;( convert(ba,IntVect(0,0,1)), dm, 1, IntVect(1,1,1) );</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            <a class="code" href="classERF.html#a101ceb89b1a249efeea3f4e8052bc8c0">SFS_q1fx3_lev</a>[lev]-&gt;setVal(0.0);</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;            <a class="code" href="classERF.html#a3ea10ef7383e594b6ee5e7a9ad67607b">SFS_q2fx3_lev</a>[lev]-&gt;setVal(0.0);</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;            <span class="keywordflow">if</span> (l_rotate) {</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                <a class="code" href="classERF.html#ae0316d5ae567a2da8439d204bace12ce">SFS_q1fx1_lev</a>[lev] = std::make_unique&lt;MultiFab&gt;( convert(ba,IntVect(1,0,0)), dm, 1, IntVect(1,1,1) );</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                <a class="code" href="classERF.html#a53fab1172ec3f01356355f8cda0919fe">SFS_q1fx2_lev</a>[lev] = std::make_unique&lt;MultiFab&gt;( convert(ba,IntVect(0,1,0)), dm, 1, IntVect(1,1,1) );</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                <a class="code" href="classERF.html#ae0316d5ae567a2da8439d204bace12ce">SFS_q1fx1_lev</a>[lev]-&gt;setVal(0.0);</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                <a class="code" href="classERF.html#a53fab1172ec3f01356355f8cda0919fe">SFS_q1fx2_lev</a>[lev]-&gt;setVal(0.0);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                <a class="code" href="classERF.html#ae0316d5ae567a2da8439d204bace12ce">SFS_q1fx1_lev</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                <a class="code" href="classERF.html#a53fab1172ec3f01356355f8cda0919fe">SFS_q1fx2_lev</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;            }</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;            <a class="code" href="classERF.html#ae0316d5ae567a2da8439d204bace12ce">SFS_q1fx1_lev</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;            <a class="code" href="classERF.html#a53fab1172ec3f01356355f8cda0919fe">SFS_q1fx2_lev</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;            <a class="code" href="classERF.html#a101ceb89b1a249efeea3f4e8052bc8c0">SFS_q1fx3_lev</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;            <a class="code" href="classERF.html#a3ea10ef7383e594b6ee5e7a9ad67607b">SFS_q2fx3_lev</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        }</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 9; i++) {</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;            <a class="code" href="classERF.html#a3d4a3ed54fb357c02e6494461f182aa1">Tau</a>[lev][i] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        }</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        <a class="code" href="classERF.html#a25174b4ae6cfcac8f7d183ce5c9fe67b">SFS_hfx1_lev</a>[lev] = <span class="keyword">nullptr</span>; <a class="code" href="classERF.html#acb607b2e675b45fdcabc09b640ce5ae2">SFS_hfx2_lev</a>[lev] = <span class="keyword">nullptr</span>; <a class="code" href="classERF.html#a1a2e3faf5dd90ad2f9ded28b486f3b46">SFS_hfx3_lev</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        <a class="code" href="classERF.html#a6e1ad417e3bd062468d74830b65911fb">SFS_diss_lev</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    }</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160; </div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="keywordflow">if</span> (l_use_kturb) {</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        <a class="code" href="classERF.html#a327d704704abd516be19339cb2d226f9">eddyDiffs_lev</a>[lev] = std::make_unique&lt;MultiFab&gt;(ba, dm, <a class="code" href="namespaceEddyDiff.html#a3f912b3dbcd18dd6f4f0a85815a3ce47aa3900ab375460932d825b615bb532446">EddyDiff::NumDiffs</a>, 2);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        <a class="code" href="classERF.html#a327d704704abd516be19339cb2d226f9">eddyDiffs_lev</a>[lev]-&gt;setVal(0.0);</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        <span class="keywordflow">if</span>(l_need_SmnSmn) {</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;            <a class="code" href="classERF.html#a9faaa96a7c270d2b2b062d9f30f19711">SmnSmn_lev</a>[lev] = std::make_unique&lt;MultiFab&gt;( ba, dm, 1, 0 );</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;            <a class="code" href="classERF.html#a9faaa96a7c270d2b2b062d9f30f19711">SmnSmn_lev</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        }</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        <a class="code" href="classERF.html#a327d704704abd516be19339cb2d226f9">eddyDiffs_lev</a>[lev] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        <a class="code" href="classERF.html#a9faaa96a7c270d2b2b062d9f30f19711">SmnSmn_lev</a>[lev]    = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    }</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;}</div>
<div class="ttc" id="anamespaceEddyDiff_html_a3f912b3dbcd18dd6f4f0a85815a3ce47aa3900ab375460932d825b615bb532446"><div class="ttname"><a href="namespaceEddyDiff.html#a3f912b3dbcd18dd6f4f0a85815a3ce47aa3900ab375460932d825b615bb532446">EddyDiff::NumDiffs</a></div><div class="ttdeci">@ NumDiffs</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:181</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7dba7f9e6bd3f6898fac9ac2efcec692"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7dba7f9e6bd3f6898fac9ac2efcec692">&#9670;&nbsp;</a></span>update_terrain_arrays()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::update_terrain_arrays </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;{</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structSolverChoice.html#a1952672901901b0b3a628f2298dc72c2">SolverChoice::mesh_type</a> == MeshType::StretchedDz ||</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        <a class="code" href="structSolverChoice.html#a1952672901901b0b3a628f2298dc72c2">SolverChoice::mesh_type</a> == MeshType::VariableDz) {</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        <a class="code" href="ERF__TerrainMetrics_8cpp.html#a9c1ecbedddfe464d9db02960e5422564">make_J</a>(geom[lev],*<a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev],*<a class="code" href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">detJ_cc</a>[lev]);</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        <a class="code" href="ERF__TerrainMetrics_8cpp.html#a920c175414adfaaa26687bfb8e7585bb">make_areas</a>(geom[lev],*<a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev],*<a class="code" href="classERF.html#a93bc9185c89cbeaceffaf40b8cf4a75c">ax</a>[lev],*<a class="code" href="classERF.html#ade870f983d113c64406bdcb8a9194044">ay</a>[lev],*<a class="code" href="classERF.html#a391914523e66645f7e947cefcd19c011">az</a>[lev]);</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        <a class="code" href="ERF__TerrainMetrics_8cpp.html#acc28d890df44cf0082a848c057042178">make_zcc</a>(geom[lev],*<a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev],*<a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[lev]);</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    }</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;}</div>
<div class="ttc" id="aERF__TerrainMetrics_8cpp_html_a920c175414adfaaa26687bfb8e7585bb"><div class="ttname"><a href="ERF__TerrainMetrics_8cpp.html#a920c175414adfaaa26687bfb8e7585bb">make_areas</a></div><div class="ttdeci">void make_areas(const Geometry &amp;geom, MultiFab &amp;z_phys_nd, MultiFab &amp;ax, MultiFab &amp;ay, MultiFab &amp;az)</div><div class="ttdef"><b>Definition:</b> ERF_TerrainMetrics.cpp:558</div></div>
<div class="ttc" id="aERF__TerrainMetrics_8cpp_html_a9c1ecbedddfe464d9db02960e5422564"><div class="ttname"><a href="ERF__TerrainMetrics_8cpp.html#a9c1ecbedddfe464d9db02960e5422564">make_J</a></div><div class="ttdeci">void make_J(const Geometry &amp;geom, MultiFab &amp;z_phys_nd, MultiFab &amp;detJ_cc)</div><div class="ttdef"><b>Definition:</b> ERF_TerrainMetrics.cpp:520</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a7dba7f9e6bd3f6898fac9ac2efcec692_cgraph.png" border="0" usemap="#aclassERF_a7dba7f9e6bd3f6898fac9ac2efcec692_cgraph" alt=""/></div>
<map name="aclassERF_a7dba7f9e6bd3f6898fac9ac2efcec692_cgraph" id="aclassERF_a7dba7f9e6bd3f6898fac9ac2efcec692_cgraph">
<area shape="rect" title=" " alt="" coords="5,49,155,90"/>
<area shape="rect" href="ERF__TerrainMetrics_8cpp.html#a920c175414adfaaa26687bfb8e7585bb" title=" " alt="" coords="203,5,304,32"/>
<area shape="rect" href="ERF__TerrainMetrics_8cpp.html#a9c1ecbedddfe464d9db02960e5422564" title=" " alt="" coords="219,56,288,83"/>
<area shape="rect" href="ERF__TerrainMetrics_8cpp.html#acc28d890df44cf0082a848c057042178" title=" " alt="" coords="210,107,297,133"/>
</map>
</div>

</div>
</div>
<a id="ad156903a5d71364b5fb5884000f28a8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad156903a5d71364b5fb5884000f28a8a">&#9670;&nbsp;</a></span>volWgtSumMF()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Real ERF::volWgtSumMF </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::MultiFab &amp;&#160;</td>
          <td class="paramname"><em>mf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>comp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>finemask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Utility function for computing a volume weighted sum of MultiFab data for a single component</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lev</td><td>Current level </td></tr>
    <tr><td class="paramname">mf</td><td>MultiFab on which we do the volume weighted sum </td></tr>
    <tr><td class="paramname">comp</td><td>Index of the component we want to sum </td></tr>
    <tr><td class="paramname">local</td><td>Boolean sets whether or not to reduce the sum over the domain (false) or compute sums local to each MPI rank (true) </td></tr>
    <tr><td class="paramname">finemask</td><td>If a finer level is available, determines whether we mask fine data </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;{</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    BL_PROFILE(<span class="stringliteral">&quot;ERF::volWgtSumMF()&quot;</span>);</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160; </div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    Real sum = 0.0;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    MultiFab tmp(grids[lev], dmap[lev], 1, 0);</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    MultiFab::Copy(tmp, mf, comp, 0, 1, 0);</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160; </div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <span class="comment">// The quantity that is conserved is not (rho S), but rather (rho S / m^2) where</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <span class="comment">// m is the map scale factor at cell centers</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <span class="keywordflow">for</span> (MFIter mfi(tmp, TilingIfNotGPU()); mfi.isValid(); ++mfi) {</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        <span class="keyword">const</span> Box&amp; bx   = mfi.tilebox();</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span>  dst = tmp.array(mfi);</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span>&amp; mfx = <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85bac2a428daaf1a1b398630fa8cec7f115b">MapFacType::m_x</a>]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span>&amp; mfy = <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85ba9612b6816e2fb7dc3ad56d6bc1fb7df8">MapFacType::m_y</a>]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        ParallelFor(bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        {</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;            dst(i,j,k) /= (mfx(i,j,0)*mfy(i,j,0));</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        });</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    } <span class="comment">// mfi</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160; </div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <span class="keywordflow">if</span> (lev &lt; finest_level &amp;&amp; finemask) {</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        <span class="keyword">const</span> MultiFab&amp; mask = <a class="code" href="classERF.html#af46289079e053a6d74ddef0bf1a5d8a3">build_fine_mask</a>(lev+1);</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        MultiFab::Multiply(tmp, mask, 0, 0, 1, 0);</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    }</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160; </div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="comment">// Get volume including terrain (consistent with volWgtSumMF routine)</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    MultiFab volume(grids[lev], dmap[lev], 1, 0);</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span>&amp; dx = geom[lev].CellSizeArray();</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    Real cell_vol  = dx[0]*dx[1]*dx[2];</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    volume.setVal(cell_vol);</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structSolverChoice.html#a1952672901901b0b3a628f2298dc72c2">SolverChoice::mesh_type</a> != MeshType::ConstantDz) {</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        MultiFab::Multiply(volume, *<a class="code" href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">detJ_cc</a>[lev], 0, 0, 1, 0);</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    }</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="preprocessor">#pragma omp parallel if (amrex::Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <span class="keywordflow">for</span> (MFIter mfi(volume, TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    {</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        <span class="keyword">const</span> Box&amp; tbx  = mfi.tilebox();</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        <span class="keyword">auto</span> dst        = volume.array(mfi);</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span>&amp; mfx = <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85bac2a428daaf1a1b398630fa8cec7f115b">MapFacType::m_x</a>]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span>&amp; mfy = <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85ba9612b6816e2fb7dc3ad56d6bc1fb7df8">MapFacType::m_y</a>]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        ParallelFor(tbx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        {</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;            dst(i,j,k) /= (mfx(i,j,0)*mfy(i,j,0));</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        });</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    }</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160; </div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="comment">// Note that when we send in local = true, NO ParallelAllReduce::Sum</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <span class="comment">//      is called inside the Dot product -- we will do that before we print</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <span class="keywordtype">bool</span> local = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    sum = MultiFab::Dot(tmp, 0, volume, 0, 1, 0, local);</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160; </div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <span class="keywordflow">return</span> sum;</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_af46289079e053a6d74ddef0bf1a5d8a3"><div class="ttname"><a href="classERF.html#af46289079e053a6d74ddef0bf1a5d8a3">ERF::build_fine_mask</a></div><div class="ttdeci">amrex::MultiFab &amp; build_fine_mask(int lev)</div><div class="ttdef"><b>Definition:</b> ERF_WriteScalarProfiles.cpp:721</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a55eae94c5363e227b571739738bb26b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55eae94c5363e227b571739738bb26b7">&#9670;&nbsp;</a></span>write_1D_profiles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::write_1D_profiles </td>
          <td>(</td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Writes 1-dimensional averaged quantities as profiles to output log files at the given time.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">time</td><td>Current time </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;{</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    BL_PROFILE(<span class="stringliteral">&quot;ERF::write_1D_profiles()&quot;</span>);</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ac1238c1616826c66df1dfd9076e6a3da">NumDataLogs</a>() &gt; 1)</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    {</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;        <span class="comment">// Define the 1d arrays we will need</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;        Gpu::HostVector&lt;Real&gt; h_avg_u, h_avg_v, h_avg_w;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;        Gpu::HostVector&lt;Real&gt; h_avg_rho, h_avg_th, h_avg_ksgs, h_avg_Kmv, h_avg_Khv;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;        Gpu::HostVector&lt;Real&gt; h_avg_qv, h_avg_qc, h_avg_qr, h_avg_wqv, h_avg_wqc, h_avg_wqr, h_avg_qi, h_avg_qs, h_avg_qg;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        Gpu::HostVector&lt;Real&gt; h_avg_wthv;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        Gpu::HostVector&lt;Real&gt; h_avg_uth, h_avg_vth, h_avg_wth, h_avg_thth;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        Gpu::HostVector&lt;Real&gt; h_avg_uu, h_avg_uv, h_avg_uw, h_avg_vv, h_avg_vw, h_avg_ww;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        Gpu::HostVector&lt;Real&gt; h_avg_uiuiu, h_avg_uiuiv, h_avg_uiuiw;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        Gpu::HostVector&lt;Real&gt; h_avg_p, h_avg_pu, h_avg_pv, h_avg_pw;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        Gpu::HostVector&lt;Real&gt; h_avg_tau11, h_avg_tau12, h_avg_tau13, h_avg_tau22, h_avg_tau23, h_avg_tau33;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        Gpu::HostVector&lt;Real&gt; h_avg_sgshfx, h_avg_sgsq1fx, h_avg_sgsq2fx, h_avg_sgsdiss; <span class="comment">// only output tau_{theta,w} and epsilon for now</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ac1238c1616826c66df1dfd9076e6a3da">NumDataLogs</a>() &gt; 1) {</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;            <a class="code" href="classERF.html#ab5b66549344d8b04b126fa0ef16c7ca2">derive_diag_profiles</a>(time,</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;                                 h_avg_u, h_avg_v, h_avg_w,</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;                                 h_avg_rho, h_avg_th, h_avg_ksgs,</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;                                 h_avg_Kmv, h_avg_Khv,</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                                 h_avg_qv, h_avg_qc, h_avg_qr,</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;                                 h_avg_wqv, h_avg_wqc, h_avg_wqr,</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;                                 h_avg_qi, h_avg_qs, h_avg_qg,</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;                                 h_avg_uu, h_avg_uv, h_avg_uw, h_avg_vv, h_avg_vw, h_avg_ww,</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;                                 h_avg_uth, h_avg_vth, h_avg_wth, h_avg_thth,</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;                                 h_avg_uiuiu, h_avg_uiuiv, h_avg_uiuiw,</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;                                 h_avg_p, h_avg_pu, h_avg_pv, h_avg_pw,</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                                 h_avg_wthv);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        }</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ac1238c1616826c66df1dfd9076e6a3da">NumDataLogs</a>() &gt; 3 &amp;&amp; time &gt; 0.) {</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;            <a class="code" href="classERF.html#ad7886dcab90f37a8fcc91ede0c68b6cb">derive_stress_profiles</a>(h_avg_tau11, h_avg_tau12, h_avg_tau13,</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                                   h_avg_tau22, h_avg_tau23, h_avg_tau33,</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                                   h_avg_sgshfx, h_avg_sgsq1fx, h_avg_sgsq2fx,</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                                   h_avg_sgsdiss);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        }</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <span class="keywordtype">int</span> hu_size =  h_avg_u.size();</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <span class="keyword">auto</span> <span class="keyword">const</span>&amp; dx = geom[0].CellSizeArray();</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <span class="keywordflow">if</span> (ParallelDescriptor::IOProcessor()) {</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ac1238c1616826c66df1dfd9076e6a3da">NumDataLogs</a>() &gt; 1) {</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                std::ostream&amp; data_log1 = <a class="code" href="classERF.html#aa2c3ee1910008b828b9da79ccdfe3871">DataLog</a>(1);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                <span class="keywordflow">if</span> (data_log1.good()) {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                  <span class="comment">// Write the quantities at this time</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; hu_size; k++) {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                      Real <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a>;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                      <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[0].size() &gt; 1) {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                          <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> = 0.5 * (<a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[0][k] + <a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[0][k+1]);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                          <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> = (k + 0.5)* dx[2];</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                      }</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                      data_log1 &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; std::setprecision(<a class="code" href="classERF.html#a2307b817178b00e5cc38c0e163da0a39">timeprecision</a>) &lt;&lt; time &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                                &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; std::setprecision(<a class="code" href="classERF.html#aefeb0bde962c9f53aba32e4ab59b4958">datprecision</a>) &lt;&lt; <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                                &lt;&lt; h_avg_u[k]   &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_v[k]   &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_w[k]     &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                                &lt;&lt; h_avg_rho[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_th[k]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_ksgs[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                                &lt;&lt; h_avg_Kmv[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_Khv[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                                &lt;&lt; h_avg_qv[k]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_qc[k]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_qr[k]    &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                                &lt;&lt; h_avg_qi[k]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_qs[k]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_qg[k]</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                  } <span class="comment">// loop over z</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                } <span class="comment">// if good</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;            } <span class="comment">// NumDataLogs</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ac1238c1616826c66df1dfd9076e6a3da">NumDataLogs</a>() &gt; 2) {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                std::ostream&amp; data_log2 = <a class="code" href="classERF.html#aa2c3ee1910008b828b9da79ccdfe3871">DataLog</a>(2);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                <span class="keywordflow">if</span> (data_log2.good()) {</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                  <span class="comment">// Write the perturbational quantities at this time</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; hu_size; k++) {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                      Real <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a>;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                      <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[0].size() &gt; 1) {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                          <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> = 0.5 * (<a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[0][k] + <a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[0][k+1]);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                          <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> = (k + 0.5)* dx[2];</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                      }</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                      Real thv = h_avg_th[k] * (1 + 0.61*h_avg_qv[k] - h_avg_qc[k] - h_avg_qr[k]);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                      data_log2 &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; std::setprecision(<a class="code" href="classERF.html#a2307b817178b00e5cc38c0e163da0a39">timeprecision</a>) &lt;&lt; time &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                                &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; std::setprecision(<a class="code" href="classERF.html#aefeb0bde962c9f53aba32e4ab59b4958">datprecision</a>) &lt;&lt; <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                                &lt;&lt; h_avg_uu[k]   - h_avg_u[k]*h_avg_u[k]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                                &lt;&lt; h_avg_uv[k]   - h_avg_u[k]*h_avg_v[k]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                                &lt;&lt; h_avg_uw[k]   - h_avg_u[k]*h_avg_w[k]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                                &lt;&lt; h_avg_vv[k]   - h_avg_v[k]*h_avg_v[k]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                                &lt;&lt; h_avg_vw[k]   - h_avg_v[k]*h_avg_w[k]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                                &lt;&lt; h_avg_ww[k]   - h_avg_w[k]*h_avg_w[k]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                                &lt;&lt; h_avg_uth[k]  - h_avg_u[k]*h_avg_th[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                                &lt;&lt; h_avg_vth[k]  - h_avg_v[k]*h_avg_th[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                                &lt;&lt; h_avg_wth[k]  - h_avg_w[k]*h_avg_th[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                                &lt;&lt; h_avg_thth[k] - h_avg_th[k]*h_avg_th[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                                <span class="comment">// Note: &lt;u&#39;_i u&#39;_i u&#39;_j&gt; =   &lt;u_i u_i u_j&gt;</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                                <span class="comment">//                        -   &lt;u_i u_i&gt; * &lt;u_j&gt;</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                                <span class="comment">//                        - 2*&lt;u_i&gt; * &lt;u_i u_j&gt;</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                                <span class="comment">//                        + 2*&lt;u_i&gt;*&lt;u_i&gt; * &lt;u_j&gt;</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                                &lt;&lt; h_avg_uiuiu[k]</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                                 - (h_avg_uu[k] + h_avg_vv[k] + h_avg_ww[k])*h_avg_u[k]</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                                 - 2*(h_avg_u[k]*h_avg_uu[k] + h_avg_v[k]*h_avg_uv[k] + h_avg_w[k]*h_avg_uw[k])</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                                 + 2*(h_avg_u[k]*h_avg_u[k] + h_avg_v[k]*h_avg_v[k] + h_avg_w[k]*h_avg_w[k])*h_avg_u[k]</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                                   &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// (u&#39;_i u&#39;_i)u&#39;</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                                &lt;&lt; h_avg_uiuiv[k]</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                                 - (h_avg_uu[k] + h_avg_vv[k] + h_avg_ww[k])*h_avg_v[k]</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                                 - 2*(h_avg_u[k]*h_avg_uv[k] + h_avg_v[k]*h_avg_vv[k] + h_avg_w[k]*h_avg_vw[k])</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                                 + 2*(h_avg_u[k]*h_avg_u[k] + h_avg_v[k]*h_avg_v[k] + h_avg_w[k]*h_avg_w[k])*h_avg_v[k]</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                                   &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// (u&#39;_i u&#39;_i)v&#39;</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                                &lt;&lt; h_avg_uiuiw[k]</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                                 - (h_avg_uu[k] + h_avg_vv[k] + h_avg_ww[k])*h_avg_w[k]</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                                 - 2*(h_avg_u[k]*h_avg_uw[k] + h_avg_v[k]*h_avg_vw[k] + h_avg_w[k]*h_avg_ww[k])</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                                 + 2*(h_avg_u[k]*h_avg_u[k] + h_avg_v[k]*h_avg_v[k] + h_avg_w[k]*h_avg_w[k])*h_avg_w[k]</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                                   &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// (u&#39;_i u&#39;_i)w&#39;</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                                &lt;&lt; h_avg_pu[k]   - h_avg_p[k]*h_avg_u[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                                &lt;&lt; h_avg_pv[k]   - h_avg_p[k]*h_avg_v[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                                &lt;&lt; h_avg_pw[k]   - h_avg_p[k]*h_avg_w[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                                &lt;&lt; h_avg_wqv[k]  - h_avg_qv[k]*h_avg_w[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                                &lt;&lt; h_avg_wqc[k]  - h_avg_qc[k]*h_avg_w[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                                &lt;&lt; h_avg_wqr[k]  - h_avg_qr[k]*h_avg_w[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                                &lt;&lt; h_avg_wthv[k] - h_avg_w[k]*thv</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                  } <span class="comment">// loop over z</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                } <span class="comment">// if good</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            } <span class="comment">// NumDataLogs</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ac1238c1616826c66df1dfd9076e6a3da">NumDataLogs</a>() &gt; 3 &amp;&amp; time &gt; 0.) {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                std::ostream&amp; data_log3 = <a class="code" href="classERF.html#aa2c3ee1910008b828b9da79ccdfe3871">DataLog</a>(3);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                <span class="keywordflow">if</span> (data_log3.good()) {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                  <span class="comment">// Write the average stresses</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; hu_size; k++) {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                      Real <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a>;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                      <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[0].size() &gt; 1) {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                          <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> = 0.5 * (<a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[0][k] + <a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[0][k+1]);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                          <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> = (k + 0.5)* dx[2];</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                      }</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                      data_log3 &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; std::setprecision(<a class="code" href="classERF.html#a2307b817178b00e5cc38c0e163da0a39">timeprecision</a>) &lt;&lt; time &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                                &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; std::setprecision(<a class="code" href="classERF.html#aefeb0bde962c9f53aba32e4ab59b4958">datprecision</a>) &lt;&lt; <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                                &lt;&lt; h_avg_tau11[k]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_tau12[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_tau13[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                                &lt;&lt; h_avg_tau22[k]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_tau23[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_tau33[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                                &lt;&lt; h_avg_sgshfx[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                                &lt;&lt; h_avg_sgsq1fx[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_sgsq2fx[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                                &lt;&lt; h_avg_sgsdiss[k]</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                  } <span class="comment">// loop over z</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                } <span class="comment">// if good</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            } <span class="comment">// if (NumDataLogs() &gt; 3)</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        } <span class="comment">// if IOProcessor</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    } <span class="comment">// if (NumDataLogs() &gt; 1)</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_ab5b66549344d8b04b126fa0ef16c7ca2"><div class="ttname"><a href="classERF.html#ab5b66549344d8b04b126fa0ef16c7ca2">ERF::derive_diag_profiles</a></div><div class="ttdeci">void derive_diag_profiles(amrex::Real time, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_u, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_v, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_w, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_rho, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_th, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_ksgs, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_Kmv, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_Khv, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_qv, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_qc, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_qr, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_wqv, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_wqc, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_wqr, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_qi, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_qs, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_qg, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_uu, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_uv, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_uw, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_vv, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_vw, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_ww, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_uth, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_vth, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_wth, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_thth, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_ku, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_kv, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_kw, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_p, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_pu, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_pv, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_pw, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_wthv)</div><div class="ttdef"><b>Definition:</b> ERF_Write1DProfiles.cpp:190</div></div>
<div class="ttc" id="aclassERF_html_ad7886dcab90f37a8fcc91ede0c68b6cb"><div class="ttname"><a href="classERF.html#ad7886dcab90f37a8fcc91ede0c68b6cb">ERF::derive_stress_profiles</a></div><div class="ttdeci">void derive_stress_profiles(amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_tau11, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_tau12, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_tau13, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_tau22, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_tau23, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_tau33, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_hfx3, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_q1fx3, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_q2fx3, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_diss)</div><div class="ttdef"><b>Definition:</b> ERF_Write1DProfiles.cpp:475</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a39efa3a0f3ae3deb7a43f4ce110ee49a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39efa3a0f3ae3deb7a43f4ce110ee49a">&#9670;&nbsp;</a></span>write_1D_profiles_stag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::write_1D_profiles_stag </td>
          <td>(</td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Writes 1-dimensional averaged quantities as profiles to output log files at the given time.</p>
<p>Quantities are output at their native grid locations. Therefore, w and associated flux quantities &lt;(•)'w'&gt;, tau13, and tau23 (where '•' includes u, v, p, theta, ...) will be output at staggered heights (i.e., coincident with z faces) rather than cell-center heights to avoid performing additional averaging. Unstaggered (i.e., cell-centered) quantities are output alongside staggered quantities at the lower cell faces in the log file; these quantities will have a zero value at the big end, corresponding to k=Nz+1.</p>
<p>The structure of file should follow <a class="el" href="ERF__Write1DProfiles_8cpp.html">ERF_Write1DProfiles.cpp</a></p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">time</td><td>Current time </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;{</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    BL_PROFILE(<span class="stringliteral">&quot;ERF::write_1D_profiles()&quot;</span>);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ac1238c1616826c66df1dfd9076e6a3da">NumDataLogs</a>() &gt; 1)</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    {</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        <span class="comment">// Define the 1d arrays we will need</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        Gpu::HostVector&lt;Real&gt; h_avg_u, h_avg_v, h_avg_w;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        Gpu::HostVector&lt;Real&gt; h_avg_rho, h_avg_th, h_avg_ksgs, h_avg_Kmv, h_avg_Khv;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        Gpu::HostVector&lt;Real&gt; h_avg_qv, h_avg_qc, h_avg_qr, h_avg_wqv, h_avg_wqc, h_avg_wqr, h_avg_qi, h_avg_qs, h_avg_qg;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        Gpu::HostVector&lt;Real&gt; h_avg_wthv;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        Gpu::HostVector&lt;Real&gt; h_avg_uth, h_avg_vth, h_avg_wth, h_avg_thth;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        Gpu::HostVector&lt;Real&gt; h_avg_uu, h_avg_uv, h_avg_uw, h_avg_vv, h_avg_vw, h_avg_ww;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        Gpu::HostVector&lt;Real&gt; h_avg_uiuiu, h_avg_uiuiv, h_avg_uiuiw;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        Gpu::HostVector&lt;Real&gt; h_avg_p, h_avg_pu, h_avg_pv, h_avg_pw;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        Gpu::HostVector&lt;Real&gt; h_avg_tau11, h_avg_tau12, h_avg_tau13, h_avg_tau22, h_avg_tau23, h_avg_tau33;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        Gpu::HostVector&lt;Real&gt; h_avg_sgshfx, h_avg_sgsq1fx, h_avg_sgsq2fx, h_avg_sgsdiss; <span class="comment">// only output tau_{theta,w} and epsilon for now</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ac1238c1616826c66df1dfd9076e6a3da">NumDataLogs</a>() &gt; 1) {</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;            <a class="code" href="classERF.html#a8b93b715895b00e86e7db653d2a7284a">derive_diag_profiles_stag</a>(time,</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;                                      h_avg_u, h_avg_v, h_avg_w,</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;                                      h_avg_rho, h_avg_th, h_avg_ksgs,</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                                      h_avg_Kmv, h_avg_Khv,</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;                                      h_avg_qv, h_avg_qc, h_avg_qr,</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;                                      h_avg_wqv, h_avg_wqc, h_avg_wqr,</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;                                      h_avg_qi, h_avg_qs, h_avg_qg,</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                                      h_avg_uu, h_avg_uv, h_avg_uw, h_avg_vv, h_avg_vw, h_avg_ww,</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                                      h_avg_uth, h_avg_vth, h_avg_wth, h_avg_thth,</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                                      h_avg_uiuiu, h_avg_uiuiv, h_avg_uiuiw,</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                                      h_avg_p, h_avg_pu, h_avg_pv, h_avg_pw,</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                                      h_avg_wthv);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        }</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ac1238c1616826c66df1dfd9076e6a3da">NumDataLogs</a>() &gt; 3 &amp;&amp; time &gt; 0.) {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;            <a class="code" href="classERF.html#ae09680325ba108583147eb2e254a266e">derive_stress_profiles_stag</a>(h_avg_tau11, h_avg_tau12, h_avg_tau13,</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                                        h_avg_tau22, h_avg_tau23, h_avg_tau33,</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                                        h_avg_sgshfx, h_avg_sgsq1fx, h_avg_sgsq2fx,</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                                        h_avg_sgsdiss);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        }</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <span class="keywordtype">int</span> unstag_size =  h_avg_w.size() - 1; <span class="comment">// _un_staggered heights</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <span class="keyword">auto</span> <span class="keyword">const</span>&amp; dx = geom[0].CellSizeArray();</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <span class="keywordflow">if</span> (ParallelDescriptor::IOProcessor()) {</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ac1238c1616826c66df1dfd9076e6a3da">NumDataLogs</a>() &gt; 1) {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                std::ostream&amp; data_log1 = <a class="code" href="classERF.html#aa2c3ee1910008b828b9da79ccdfe3871">DataLog</a>(1);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                <span class="keywordflow">if</span> (data_log1.good()) {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                  <span class="comment">// Write the quantities at this time</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; unstag_size; k++) {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                      Real <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> = (<a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[0].size() &gt; 1) ? <a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[0][k] : k * dx[2];</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                      data_log1 &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; std::setprecision(<a class="code" href="classERF.html#a2307b817178b00e5cc38c0e163da0a39">timeprecision</a>) &lt;&lt; time &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                                &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; std::setprecision(<a class="code" href="classERF.html#aefeb0bde962c9f53aba32e4ab59b4958">datprecision</a>) &lt;&lt; <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                                &lt;&lt; h_avg_u[k]   &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_v[k]   &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_w[k]     &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                                &lt;&lt; h_avg_rho[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_th[k]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_ksgs[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                                &lt;&lt; h_avg_Kmv[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_Khv[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                                &lt;&lt; h_avg_qv[k]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_qc[k]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_qr[k]    &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                                &lt;&lt; h_avg_qi[k]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_qs[k]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_qg[k]</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                  } <span class="comment">// loop over z</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                  <span class="comment">// Write top face values</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                  Real <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> = (<a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[0].size() &gt; 1) ? <a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[0][unstag_size] : unstag_size * dx[2];</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                  data_log1 &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; std::setprecision(<a class="code" href="classERF.html#a2307b817178b00e5cc38c0e163da0a39">timeprecision</a>) &lt;&lt; time &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                            &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; std::setprecision(<a class="code" href="classERF.html#aefeb0bde962c9f53aba32e4ab59b4958">datprecision</a>) &lt;&lt; <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                            &lt;&lt; 0 &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; 0 &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_w[unstag_size] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                            &lt;&lt; 0 &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; 0 &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; 0 &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// rho, theta, ksgs</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                            &lt;&lt; 0 &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; 0 &lt;&lt; <span class="stringliteral">&quot; &quot;</span>             <span class="comment">// Kmv, Khv</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                            &lt;&lt; 0 &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; 0 &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; 0 &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// qv, qc, qr</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                            &lt;&lt; 0 &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; 0 &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; 0        <span class="comment">// qi, qs, qg</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                } <span class="comment">// if good</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            } <span class="comment">// NumDataLogs</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ac1238c1616826c66df1dfd9076e6a3da">NumDataLogs</a>() &gt; 2) {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                std::ostream&amp; data_log2 = <a class="code" href="classERF.html#aa2c3ee1910008b828b9da79ccdfe3871">DataLog</a>(2);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                <span class="keywordflow">if</span> (data_log2.good()) {</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                  <span class="comment">// Write the perturbational quantities at this time</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                  <span class="comment">// For surface values (k=0), assume w = uw = vw = ww = 0</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                  Real w_cc  = h_avg_w[1] / 2;  <span class="comment">// w at first cell center</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                  Real uw_cc = h_avg_uw[1] / 2; <span class="comment">// u*w at first cell center</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                  Real vw_cc = h_avg_vw[1] / 2; <span class="comment">// v*w at first cell center</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                  Real ww_cc = h_avg_ww[1] / 2; <span class="comment">// w*w at first cell center</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                  data_log2 &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; std::setprecision(<a class="code" href="classERF.html#a2307b817178b00e5cc38c0e163da0a39">timeprecision</a>) &lt;&lt; time &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                            &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; std::setprecision(<a class="code" href="classERF.html#aefeb0bde962c9f53aba32e4ab59b4958">datprecision</a>) &lt;&lt; 0 &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                            &lt;&lt; h_avg_uu[0]   - h_avg_u[0]*h_avg_u[0]   &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// u&#39;u&#39;</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                            &lt;&lt; h_avg_uv[0]   - h_avg_u[0]*h_avg_v[0]   &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// u&#39;v&#39;</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                            &lt;&lt; 0                                       &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// u&#39;w&#39;</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                            &lt;&lt; h_avg_vv[0]   - h_avg_v[0]*h_avg_v[0]   &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// v&#39;v&#39;</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                            &lt;&lt; 0                                       &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// v&#39;w&#39;</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                            &lt;&lt; 0                                       &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// w&#39;w&#39;</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                            &lt;&lt; h_avg_uth[0]  - h_avg_u[0]*h_avg_th[0]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// u&#39;th&#39;</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                            &lt;&lt; h_avg_vth[0]  - h_avg_v[0]*h_avg_th[0]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// v&#39;th&#39;</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                            &lt;&lt; 0                                       &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// w&#39;th&#39;</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                            &lt;&lt; h_avg_thth[0] - h_avg_th[0]*h_avg_th[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// th&#39;th&#39;</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                            &lt;&lt; h_avg_uiuiu[0]</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                             - (h_avg_uu[0] + h_avg_vv[0] + ww_cc)*h_avg_u[0]</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                             - 2*(h_avg_u[0]*h_avg_uu[0] + h_avg_v[0]*h_avg_uv[0] + w_cc*uw_cc)</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                             + 2*(h_avg_u[0]*h_avg_u[0] + h_avg_v[0]*h_avg_v[0] + w_cc*w_cc)*h_avg_u[0]</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                               &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// (u&#39;_i u&#39;_i)u&#39;</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                            &lt;&lt; h_avg_uiuiv[0]</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                             - (h_avg_uu[0] + h_avg_vv[0] + ww_cc)*h_avg_v[0]</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                             - 2*(h_avg_u[0]*h_avg_uv[0] + h_avg_v[0]*h_avg_vv[0] + w_cc*vw_cc)</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                             + 2*(h_avg_u[0]*h_avg_u[0] + h_avg_v[0]*h_avg_v[0] + w_cc*w_cc)*h_avg_v[0]</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                               &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// (u&#39;_i u&#39;_i)v&#39;</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                            &lt;&lt; 0 &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// (u&#39;_i u&#39;_i)w&#39;</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                            &lt;&lt; h_avg_pu[0]   - h_avg_p[0]*h_avg_u[0]   &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// p&#39;u&#39;</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                            &lt;&lt; h_avg_pv[0]   - h_avg_p[0]*h_avg_v[0]   &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// p&#39;v&#39;</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                            &lt;&lt; 0                                       &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// p&#39;w&#39;</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                            &lt;&lt; 0                                       &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// qv&#39;w&#39;</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                            &lt;&lt; 0                                       &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// qc&#39;w&#39;</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                            &lt;&lt; 0                                       &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// qr&#39;w&#39;</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                            &lt;&lt; 0                                              <span class="comment">// thv&#39;w&#39;</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                  <span class="comment">// For internal values, interpolate scalar quantities to faces</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 1; k &lt; unstag_size; k++) {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                      Real <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> = (<a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[0].size() &gt; 1) ? <a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[0][k] : k * dx[2];</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                      Real uface  = 0.5*(h_avg_u[k]  + h_avg_u[k-1]);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                      Real vface  = 0.5*(h_avg_v[k]  + h_avg_v[k-1]);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                      Real thface = 0.5*(h_avg_th[k] + h_avg_th[k-1]);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                      Real pface  = 0.5*(h_avg_p[k]  + h_avg_p[k-1]);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                      Real qvface = 0.5*(h_avg_qv[k] + h_avg_qv[k-1]);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                      Real qcface = 0.5*(h_avg_qc[k] + h_avg_qc[k-1]);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                      Real qrface = 0.5*(h_avg_qr[k] + h_avg_qr[k-1]);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                      Real uuface = 0.5*(h_avg_uu[k] + h_avg_uu[k-1]);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                      Real vvface = 0.5*(h_avg_vv[k] + h_avg_vv[k-1]);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                      Real thvface = thface * (1 + 0.61*qvface - qcface - qrface);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                      w_cc   = 0.5*(h_avg_w[k-1]  + h_avg_w[k]);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                      uw_cc  = 0.5*(h_avg_uw[k-1] + h_avg_uw[k]);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                      vw_cc  = 0.5*(h_avg_vw[k-1] + h_avg_vw[k]);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                      ww_cc  = 0.5*(h_avg_ww[k-1] + h_avg_ww[k]);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                      data_log2 &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; std::setprecision(<a class="code" href="classERF.html#a2307b817178b00e5cc38c0e163da0a39">timeprecision</a>) &lt;&lt; time &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                                &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; std::setprecision(<a class="code" href="classERF.html#aefeb0bde962c9f53aba32e4ab59b4958">datprecision</a>) &lt;&lt; <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                                &lt;&lt; h_avg_uu[k]   - h_avg_u[k]*h_avg_u[k]   &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// u&#39;u&#39;</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                                &lt;&lt; h_avg_uv[k]   - h_avg_u[k]*h_avg_v[k]   &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// u&#39;v&#39;</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                                &lt;&lt; h_avg_uw[k]   -      uface*h_avg_w[k]   &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// u&#39;w&#39;</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                                &lt;&lt; h_avg_vv[k]   - h_avg_v[k]*h_avg_v[k]   &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// v&#39;v&#39;</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                                &lt;&lt; h_avg_vw[k]   -      vface*h_avg_w[k]   &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// v&#39;w&#39;</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                                &lt;&lt; h_avg_ww[k]   - h_avg_w[k]*h_avg_w[k]   &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// w&#39;w&#39;</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                                &lt;&lt; h_avg_uth[k]  - h_avg_u[k]*h_avg_th[k]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// u&#39;th&#39;</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                                &lt;&lt; h_avg_vth[k]  - h_avg_v[k]*h_avg_th[k]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// v&#39;th&#39;</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                                &lt;&lt; h_avg_wth[k]  - h_avg_w[k]*thface       &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// w&#39;th&#39;</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                                &lt;&lt; h_avg_thth[k] - h_avg_th[k]*h_avg_th[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// th&#39;th&#39;</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                                <span class="comment">// Note: &lt;u&#39;_i u&#39;_i u&#39;_j&gt; =   &lt;u_i u_i u_j&gt;</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                                <span class="comment">//                        -   &lt;u_i u_i&gt; * &lt;u_j&gt;</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                                <span class="comment">//                        - 2*&lt;u_i&gt; * &lt;u_i u_j&gt;</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                                <span class="comment">//                        + 2*&lt;u_i&gt;*&lt;u_i&gt; * &lt;u_j&gt;</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                                &lt;&lt; h_avg_uiuiu[k]</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                                 - (h_avg_uu[k] + h_avg_vv[k] + ww_cc)*h_avg_u[k]</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                                 - 2*(h_avg_u[k]*h_avg_uu[k] + h_avg_v[k]*h_avg_uv[k] + w_cc*uw_cc)</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                                 + 2*(h_avg_u[k]*h_avg_u[k] + h_avg_v[k]*h_avg_v[k] + w_cc*w_cc)*h_avg_u[k]</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                                   &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// cell-centered (u&#39;_i u&#39;_i)u&#39;</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                                &lt;&lt; h_avg_uiuiv[k]</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                                 - (h_avg_uu[k] + h_avg_vv[k] + ww_cc)*h_avg_v[k]</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                                 - 2*(h_avg_u[k]*h_avg_uv[k] + h_avg_v[k]*h_avg_vv[k] + w_cc*vw_cc)</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                                 + 2*(h_avg_u[k]*h_avg_u[k] + h_avg_v[k]*h_avg_v[k] + w_cc*w_cc)*h_avg_v[k]</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                                   &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// cell-centered (u&#39;_i u&#39;_i)v&#39;</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                                &lt;&lt; h_avg_uiuiw[k]</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                                 - (uuface + vvface + h_avg_ww[k])*h_avg_w[k]</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                                 - 2*(uface*h_avg_uw[k] + vface*h_avg_vw[k] + h_avg_w[k]*h_avg_ww[k])</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                                 + 2*(uface*uface + vface*vface + h_avg_w[k]*h_avg_w[k])*h_avg_w[k]</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                                   &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// face-centered (u&#39;_i u&#39;_i)w&#39;</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                                &lt;&lt; h_avg_pu[k]   - h_avg_p[k]*h_avg_u[k]   &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// cell-centered p&#39;u&#39;</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                                &lt;&lt; h_avg_pv[k]   - h_avg_p[k]*h_avg_v[k]   &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// cell-centered p&#39;v&#39;</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                                &lt;&lt; h_avg_pw[k]   -      pface*h_avg_w[k]   &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// face-centered p&#39;w&#39;</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                                &lt;&lt; h_avg_wqv[k]  -     qvface*h_avg_w[k]   &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                                &lt;&lt; h_avg_wqc[k]  -     qcface*h_avg_w[k]   &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                                &lt;&lt; h_avg_wqr[k]  -     qrface*h_avg_w[k]   &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                                &lt;&lt; h_avg_wthv[k] -    thvface*h_avg_w[k]</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                  } <span class="comment">// loop over z</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                  <span class="comment">// Write top face values, extrapolating scalar quantities</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">int</span> k = unstag_size;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                  Real uface  = 1.5*h_avg_u[k-1]  - 0.5*h_avg_u[k-2];</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                  Real vface  = 1.5*h_avg_v[k-1]  - 0.5*h_avg_v[k-2];</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                  Real thface = 1.5*h_avg_th[k-1] - 0.5*h_avg_th[k-2];</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                  Real pface  = 1.5*h_avg_p[k-1]  - 0.5*h_avg_p[k-2];</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                  Real qvface = 1.5*h_avg_qv[k-1] - 0.5*h_avg_qv[k-2];</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                  Real qcface = 1.5*h_avg_qc[k-1] - 0.5*h_avg_qc[k-2];</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                  Real qrface = 1.5*h_avg_qr[k-1] - 0.5*h_avg_qr[k-2];</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                  Real uuface = 1.5*h_avg_uu[k-1] - 0.5*h_avg_uu[k-2];</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                  Real vvface = 1.5*h_avg_vv[k-1] - 0.5*h_avg_vv[k-2];</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                  Real thvface = thface * (1 + 0.61*qvface - qcface - qrface);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                  Real <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> = (<a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[0].size() &gt; 1) ? <a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[0][unstag_size] : unstag_size * dx[2];</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                  data_log2 &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; std::setprecision(<a class="code" href="classERF.html#a2307b817178b00e5cc38c0e163da0a39">timeprecision</a>) &lt;&lt; time &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                            &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; std::setprecision(<a class="code" href="classERF.html#aefeb0bde962c9f53aba32e4ab59b4958">datprecision</a>) &lt;&lt; <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                            &lt;&lt; 0                                     &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// u&#39;u&#39;</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                            &lt;&lt; 0                                     &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// u&#39;v&#39;</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                            &lt;&lt; h_avg_uw[k]   -      uface*h_avg_w[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// u&#39;w&#39;</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                            &lt;&lt; 0                                     &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// v&#39;v&#39;</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                            &lt;&lt; h_avg_vw[k]   -      vface*h_avg_w[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// v&#39;w&#39;</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                            &lt;&lt; h_avg_ww[k]   - h_avg_w[k]*h_avg_w[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// w&#39;w&#39;</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                            &lt;&lt; 0                                     &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// u&#39;th&#39;</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                            &lt;&lt; 0                                     &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// v&#39;th&#39;</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                            &lt;&lt; h_avg_wth[k]  -     thface*h_avg_w[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// w&#39;th&#39;</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                            &lt;&lt; 0                                     &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// th&#39;th&#39;</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                            &lt;&lt; 0                                     &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// (u&#39;_i u&#39;_i)u&#39;</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                            &lt;&lt; 0                                     &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// (u&#39;_i u&#39;_i)v&#39;</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                            &lt;&lt; h_avg_uiuiw[k]</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                             - (uuface + vvface + h_avg_ww[k])*h_avg_w[k]</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                             - 2*(uface*h_avg_uw[k] + vface*h_avg_vw[k] + h_avg_w[k]*h_avg_ww[k])</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                             + 2*(uface*uface + vface*vface + h_avg_w[k]*h_avg_w[k])*h_avg_w[k]</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                               &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// (u&#39;_i u&#39;_i)w&#39;</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                            &lt;&lt; 0                                     &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// pu&#39;</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                            &lt;&lt; 0                                     &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// pv&#39;</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                            &lt;&lt; h_avg_pw[k]   -      pface*h_avg_w[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> <span class="comment">// pw&#39;</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                            &lt;&lt; h_avg_wqv[k]  -     qvface*h_avg_w[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                            &lt;&lt; h_avg_wqc[k]  -     qcface*h_avg_w[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                            &lt;&lt; h_avg_wqr[k]  -     qrface*h_avg_w[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                            &lt;&lt; h_avg_wthv[k] -    thvface*h_avg_w[k]</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                } <span class="comment">// if good</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            } <span class="comment">// NumDataLogs</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ac1238c1616826c66df1dfd9076e6a3da">NumDataLogs</a>() &gt; 3 &amp;&amp; time &gt; 0.) {</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                std::ostream&amp; data_log3 = <a class="code" href="classERF.html#aa2c3ee1910008b828b9da79ccdfe3871">DataLog</a>(3);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                <span class="keywordflow">if</span> (data_log3.good()) {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                  <span class="comment">// Write the average stresses</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; unstag_size; k++) {</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                      Real <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> = (<a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[0].size() &gt; 1) ? <a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[0][k] : k * dx[2];</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                      data_log3 &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; std::setprecision(<a class="code" href="classERF.html#a2307b817178b00e5cc38c0e163da0a39">timeprecision</a>) &lt;&lt; time &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                                &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; std::setprecision(<a class="code" href="classERF.html#aefeb0bde962c9f53aba32e4ab59b4958">datprecision</a>) &lt;&lt; <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                                &lt;&lt; h_avg_tau11[k]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_tau12[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_tau13[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                                &lt;&lt; h_avg_tau22[k]  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_tau23[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_tau33[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                                &lt;&lt; h_avg_sgshfx[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                                &lt;&lt; h_avg_sgsq1fx[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_sgsq2fx[k] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                                &lt;&lt; h_avg_sgsdiss[k]</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                                &lt;&lt; std::endl;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                  } <span class="comment">// loop over z</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                  <span class="comment">// Write top face values</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                  Real NANval = 0.0;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                  Real <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> = (<a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[0].size() &gt; 1) ? <a class="code" href="classERF.html#ace4f0c79f84075dd7a43bd2b0ede1a9b">zlevels_stag</a>[0][unstag_size] : unstag_size * dx[2];</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                  data_log3 &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; std::setprecision(<a class="code" href="classERF.html#a2307b817178b00e5cc38c0e163da0a39">timeprecision</a>) &lt;&lt; time &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                            &lt;&lt; std::setw(<a class="code" href="classERF.html#a8b1cdf332a93c6b0889fd309e43f9a91">datwidth</a>) &lt;&lt; std::setprecision(<a class="code" href="classERF.html#aefeb0bde962c9f53aba32e4ab59b4958">datprecision</a>) &lt;&lt; <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                            &lt;&lt; NANval &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; NANval &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_tau13[unstag_size] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                            &lt;&lt; NANval &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_tau23[unstag_size] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; NANval &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                            &lt;&lt; h_avg_sgshfx[unstag_size] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                            &lt;&lt; h_avg_sgsq1fx[unstag_size] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; h_avg_sgsq2fx[unstag_size] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                            &lt;&lt; NANval</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                } <span class="comment">// if good</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            } <span class="comment">// if (NumDataLogs() &gt; 3)</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        } <span class="comment">// if IOProcessor</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    } <span class="comment">// if (NumDataLogs() &gt; 1)</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_a8b93b715895b00e86e7db653d2a7284a"><div class="ttname"><a href="classERF.html#a8b93b715895b00e86e7db653d2a7284a">ERF::derive_diag_profiles_stag</a></div><div class="ttdeci">void derive_diag_profiles_stag(amrex::Real time, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_u, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_v, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_w, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_rho, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_th, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_ksgs, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_Kmv, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_Khv, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_qv, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_qc, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_qr, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_wqv, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_wqc, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_wqr, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_qi, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_qs, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_qg, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_uu, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_uv, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_uw, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_vv, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_vw, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_ww, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_uth, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_vth, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_wth, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_thth, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_ku, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_kv, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_kw, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_p, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_pu, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_pv, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_pw, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_wthv)</div><div class="ttdef"><b>Definition:</b> ERF_Write1DProfiles_stag.cpp:296</div></div>
<div class="ttc" id="aclassERF_html_ae09680325ba108583147eb2e254a266e"><div class="ttname"><a href="classERF.html#ae09680325ba108583147eb2e254a266e">ERF::derive_stress_profiles_stag</a></div><div class="ttdeci">void derive_stress_profiles_stag(amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_tau11, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_tau12, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_tau13, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_tau22, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_tau23, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_tau33, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_hfx3, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_q1fx3, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_q2fx3, amrex::Gpu::HostVector&lt; amrex::Real &gt; &amp;h_avg_diss)</div><div class="ttdef"><b>Definition:</b> ERF_Write1DProfiles_stag.cpp:605</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae6afed5b3a72ca80ccf0d791b08516aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6afed5b3a72ca80ccf0d791b08516aa">&#9670;&nbsp;</a></span>writeBuildInfo()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::writeBuildInfo </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>os</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;{</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    std::string PrettyLine = std::string(78, <span class="charliteral">&#39;=&#39;</span>) + <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    std::string OtherLine = std::string(78, <span class="charliteral">&#39;-&#39;</span>) + <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    std::string SkipSpace = std::string(8, <span class="charliteral">&#39; &#39;</span>);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="comment">// build information</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    os &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot; ERF Build Information\n&quot;</span>;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    os &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;build date:    &quot;</span> &lt;&lt; <a class="code" href="namespaceamrex.html#a8f794ff24efbc4b60058492d1a073c78">buildInfoGetBuildDate</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;build machine: &quot;</span> &lt;&lt; buildInfoGetBuildMachine() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;build dir:     &quot;</span> &lt;&lt; buildInfoGetBuildDir() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;AMReX dir:     &quot;</span> &lt;&lt; buildInfoGetAMReXDir() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;COMP:          &quot;</span> &lt;&lt; <a class="code" href="namespaceamrex.html#a9d270ec83f99e836cca454cac4e0af5e">buildInfoGetComp</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;COMP version:  &quot;</span> &lt;&lt; <a class="code" href="namespaceamrex.html#aab3ca155f0d0a6d198817df9c35352f8">buildInfoGetCompVersion</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;C++ compiler:  &quot;</span> &lt;&lt; buildInfoGetCXXName() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;C++ flags:     &quot;</span> &lt;&lt; buildInfoGetCXXFlags() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;Link flags:    &quot;</span> &lt;&lt; buildInfoGetLinkFlags() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;Libraries:     &quot;</span> &lt;&lt; buildInfoGetLibraries() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 1; n &lt;= buildInfoGetNumModules(); n++) {</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      os &lt;&lt; buildInfoGetModuleName(n) &lt;&lt; <span class="stringliteral">&quot;: &quot;</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;         &lt;&lt; buildInfoGetModuleVal(n) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    }</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span>* githash1 = <a class="code" href="namespaceamrex.html#afa2dbdd17ead719f97272c9a0a2b0f8a">buildInfoGetGitHash</a>(1);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span>* githash2 = <a class="code" href="namespaceamrex.html#afa2dbdd17ead719f97272c9a0a2b0f8a">buildInfoGetGitHash</a>(2);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keywordflow">if</span> (strlen(githash1) &gt; 0) {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;ERF       git hash: &quot;</span> &lt;&lt; githash1 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    }</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordflow">if</span> (strlen(githash2) &gt; 0) {</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;AMReX       git hash: &quot;</span> &lt;&lt; githash2 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    }</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span>* buildgithash = buildInfoGetBuildGitHash();</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span>* buildgitname = buildInfoGetBuildGitName();</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordflow">if</span> (strlen(buildgithash) &gt; 0) {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      os &lt;&lt; buildgitname &lt;&lt; <span class="stringliteral">&quot; git hash: &quot;</span> &lt;&lt; buildgithash &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot; ERF Compile time variables: \n&quot;</span>;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot; ERF Defines: \n&quot;</span>;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    os &lt;&lt; std::setw(35) &lt;&lt; std::left &lt;&lt; <span class="stringliteral">&quot;_OPENMP &quot;</span> &lt;&lt; std::setw(6) &lt;&lt; <span class="stringliteral">&quot;ON&quot;</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;       &lt;&lt; std::endl;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    os &lt;&lt; std::setw(35) &lt;&lt; std::left &lt;&lt; <span class="stringliteral">&quot;_OPENMP &quot;</span> &lt;&lt; std::setw(6) &lt;&lt; <span class="stringliteral">&quot;OFF&quot;</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;       &lt;&lt; std::endl;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="preprocessor">#ifdef MPI_VERSION</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    os &lt;&lt; std::setw(35) &lt;&lt; std::left &lt;&lt; <span class="stringliteral">&quot;MPI_VERSION &quot;</span> &lt;&lt; std::setw(6)</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;       &lt;&lt; MPI_VERSION &lt;&lt; std::endl;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    os &lt;&lt; std::setw(35) &lt;&lt; std::left &lt;&lt; <span class="stringliteral">&quot;MPI_VERSION &quot;</span> &lt;&lt; std::setw(6)</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;       &lt;&lt; <span class="stringliteral">&quot;UNDEFINED&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160; </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="preprocessor">#ifdef MPI_SUBVERSION</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    os &lt;&lt; std::setw(35) &lt;&lt; std::left &lt;&lt; <span class="stringliteral">&quot;MPI_SUBVERSION &quot;</span> &lt;&lt; std::setw(6)</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;       &lt;&lt; MPI_SUBVERSION &lt;&lt; std::endl;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    os &lt;&lt; std::setw(35) &lt;&lt; std::left &lt;&lt; <span class="stringliteral">&quot;MPI_SUBVERSION &quot;</span> &lt;&lt; std::setw(6)</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;       &lt;&lt; <span class="stringliteral">&quot;UNDEFINED&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_ae6afed5b3a72ca80ccf0d791b08516aa_cgraph.png" border="0" usemap="#aclassERF_ae6afed5b3a72ca80ccf0d791b08516aa_cgraph" alt=""/></div>
<map name="aclassERF_ae6afed5b3a72ca80ccf0d791b08516aa_cgraph" id="aclassERF_ae6afed5b3a72ca80ccf0d791b08516aa_cgraph">
<area shape="rect" title=" " alt="" coords="5,81,151,108"/>
<area shape="rect" href="namespaceamrex.html#a8f794ff24efbc4b60058492d1a073c78" title=" " alt="" coords="210,5,426,32"/>
<area shape="rect" href="namespaceamrex.html#a9d270ec83f99e836cca454cac4e0af5e" title=" " alt="" coords="223,56,413,83"/>
<area shape="rect" href="namespaceamrex.html#aab3ca155f0d0a6d198817df9c35352f8" title=" " alt="" coords="199,107,437,133"/>
<area shape="rect" href="namespaceamrex.html#afa2dbdd17ead719f97272c9a0a2b0f8a" title=" " alt="" coords="216,157,420,184"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_ae6afed5b3a72ca80ccf0d791b08516aa_icgraph.png" border="0" usemap="#aclassERF_ae6afed5b3a72ca80ccf0d791b08516aa_icgraph" alt=""/></div>
<map name="aclassERF_ae6afed5b3a72ca80ccf0d791b08516aa_icgraph" id="aclassERF_ae6afed5b3a72ca80ccf0d791b08516aa_icgraph">
<area shape="rect" title=" " alt="" coords="108,5,253,32"/>
<area shape="rect" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,60,32"/>
</map>
</div>

</div>
</div>
<a id="ad101fd46096db2d6b21544bfede6551f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad101fd46096db2d6b21544bfede6551f">&#9670;&nbsp;</a></span>WriteCheckpointFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::WriteCheckpointFile </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="classERF.html">ERF</a> function for writing a checkpoint file. </p>
<div class="fragment"><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;{</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="comment">// chk00010            write a checkpoint file with this root directory</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="comment">// chk00010/Header     this contains information you need to save (e.g., finest_level, t_new, etc.) and also</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="comment">//                     the BoxArrays at each level</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="comment">// chk00010/Level_0/</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="comment">// chk00010/Level_1/</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="comment">// etc.                these subdirectories will hold the MultiFab data at each level of refinement</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="comment">// checkpoint file name, e.g., chk00010</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keyword">const</span> std::string&amp; checkpointname = Concatenate(<a class="code" href="classERF.html#ae701564fbe3da5bbd88587e5a08eca4e">check_file</a>,<a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[0],5);</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    Print() &lt;&lt; <span class="stringliteral">&quot;Writing native checkpoint &quot;</span> &lt;&lt; checkpointname &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> nlevels = finest_level+1;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="comment">// ---- prebuild a hierarchy of directories</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="comment">// ---- dirName is built first.  if dirName exists, it is renamed.  then build</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="comment">// ---- dirName/subDirPrefix_0 .. dirName/subDirPrefix_nlevels-1</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="comment">// ---- if callBarrier is true, call ParallelDescriptor::Barrier()</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="comment">// ---- after all directories are built</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="comment">// ---- ParallelDescriptor::IOProcessor() creates the directories</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    PreBuildDirectorHierarchy(checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, nlevels, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="keywordtype">int</span> ncomp_cons = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[0][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nComp();</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="comment">// write Header file</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordflow">if</span> (ParallelDescriptor::IOProcessor()) {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;       std::string HeaderFileName(checkpointname + <span class="stringliteral">&quot;/Header&quot;</span>);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;       VisMF::IO_Buffer io_buffer(VisMF::IO_Buffer_Size);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;       std::ofstream HeaderFile;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;       HeaderFile.rdbuf()-&gt;pubsetbuf(io_buffer.dataPtr(), io_buffer.size());</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;       HeaderFile.open(HeaderFileName.c_str(), std::ofstream::out   |</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                                               std::ofstream::trunc |</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                                               std::ofstream::binary);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;       <span class="keywordflow">if</span>(! HeaderFile.good()) {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;           FileOpenFailed(HeaderFileName);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;       }</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;       HeaderFile.precision(17);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;       <span class="comment">// write out title line</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;       HeaderFile &lt;&lt; <span class="stringliteral">&quot;Checkpoint file for ERF\n&quot;</span>;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;       <span class="comment">// write out finest_level</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;       HeaderFile &lt;&lt; finest_level &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;       <span class="comment">// write the number of components</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;       <span class="comment">// for each variable we store</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;       <span class="comment">// conservative, cell-centered vars</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;       HeaderFile &lt;&lt; ncomp_cons &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;       <span class="comment">// x-velocity on faces</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;       HeaderFile &lt;&lt; 1 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;       <span class="comment">// y-velocity on faces</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;       HeaderFile &lt;&lt; 1 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;       <span class="comment">// z-velocity on faces</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;       HeaderFile &lt;&lt; 1 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;       <span class="comment">// write out array of istep</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>.size(); ++i) {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;           HeaderFile &lt;&lt; <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;       }</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;       HeaderFile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;       <span class="comment">// write out array of dt</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>.size(); ++i) {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;           HeaderFile &lt;&lt; <a class="code" href="classERF.html#ad34bae243fdb6c3029f5abe4fb4bca2d">dt</a>[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;       }</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;       HeaderFile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;       <span class="comment">// write out array of t_new</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>.size(); ++i) {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;           HeaderFile &lt;&lt; <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;       }</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;       HeaderFile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;       <span class="comment">// write the BoxArray at each level</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;           boxArray(lev).writeOn(HeaderFile);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;           HeaderFile &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;       }</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;       <span class="comment">// Write separate file that tells how many components we have of the base state</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;       std::string BaseStateFileName(checkpointname + <span class="stringliteral">&quot;/num_base_state_comps&quot;</span>);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;       std::ofstream BaseStateFile;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;       BaseStateFile.open(BaseStateFileName.c_str(), std::ofstream::out   |</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                                                     std::ofstream::trunc |</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                                                     std::ofstream::binary);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;       <span class="keywordflow">if</span>(! BaseStateFile.good()) {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;           FileOpenFailed(BaseStateFileName);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;       } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;           <span class="comment">// write out number of components in base state</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;           BaseStateFile &lt;&lt; <a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91a088c1232c30770df1105d3cdf66ee582">BaseState::num_comps</a>      &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;           BaseStateFile &lt;&lt; <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[0].nGrowVect() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;       }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;   }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="comment">// write the MultiFab data to, e.g., chk00010/Level_0/</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="comment">// Here we make copies of the MultiFab with no ghost cells</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev)</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        MultiFab <a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">cons</a>(grids[lev],dmap[lev],ncomp_cons,0);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        MultiFab::Copy(<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">cons</a>,<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],0,0,ncomp_cons,0);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        VisMF::Write(<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">cons</a>, MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;Cell&quot;</span>));</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        MultiFab <a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">xvel</a>(convert(grids[lev],IntVect(1,0,0)),dmap[lev],1,0);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        MultiFab::Copy(<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">xvel</a>,<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],0,0,1,0);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        VisMF::Write(<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">xvel</a>, MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;XFace&quot;</span>));</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        MultiFab <a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">yvel</a>(convert(grids[lev],IntVect(0,1,0)),dmap[lev],1,0);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        MultiFab::Copy(<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">yvel</a>,<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],0,0,1,0);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        VisMF::Write(<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">yvel</a>, MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;YFace&quot;</span>));</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        MultiFab <a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">zvel</a>(convert(grids[lev],IntVect(0,0,1)),dmap[lev],1,0);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        MultiFab::Copy(<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">zvel</a>,<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>],0,0,1,0);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        VisMF::Write(<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">zvel</a>, MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;ZFace&quot;</span>));</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="comment">// Note that we write the ghost cells of the base state (unlike above)</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        IntVect ng_base = <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].nGrowVect();</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="keywordtype">int</span>  ncomp_base = <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev].nComp();</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        MultiFab base(grids[lev],dmap[lev],ncomp_base,ng_base);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        MultiFab::Copy(base,<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev],0,0,ncomp_base,ng_base);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        VisMF::Write(base, MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;BaseState&quot;</span>));</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structSolverChoice.html#a1952672901901b0b3a628f2298dc72c2">SolverChoice::mesh_type</a> != MeshType::ConstantDz)  {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            <span class="comment">// Note that we also write the ghost cells of z_phys_nd</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            IntVect <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a> = <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev]-&gt;nGrowVect();</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            MultiFab z_height(convert(grids[lev],IntVect(1,1,1)),dmap[lev],1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            MultiFab::Copy(z_height,*<a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev],0,0,1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            VisMF::Write(z_height, MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;Z_Phys_nd&quot;</span>));</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        }</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <span class="comment">// We must read and write qmoist with ghost cells because we don&#39;t directly impose BCs on these vars</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <span class="comment">// Write the moisture model restart variables</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        std::vector&lt;int&gt; qmoist_indices;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        std::vector&lt;std::string&gt; qmoist_names;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;Get_Qmoist_Restart_Vars(lev, <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>, qmoist_indices, qmoist_names);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="keywordtype">int</span> qmoist_nvar = qmoist_indices.size();</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> var = 0; var &lt; qmoist_nvar; var++) {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> ncomp  = 1;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            IntVect ng_moist = <a class="code" href="classERF.html#ae00126a9c2738bf6a6cbbe77321c9cfc">qmoist</a>[lev][qmoist_indices[var]]-&gt;nGrowVect();</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            MultiFab moist_vars(grids[lev],dmap[lev],ncomp,ng_moist);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            MultiFab::Copy(moist_vars,*(<a class="code" href="classERF.html#ae00126a9c2738bf6a6cbbe77321c9cfc">qmoist</a>[lev][qmoist_indices[var]]),0,0,ncomp,ng_moist);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            VisMF::Write(moist_vars, amrex::MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, qmoist_names[var]));</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        }</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="preprocessor">#if defined(ERF_USE_WINDFARM)</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac0a723e8797cdc0fe06b3fc781fca645">windfarm_type</a> == WindFarmType::Fitch or</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;           <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac0a723e8797cdc0fe06b3fc781fca645">windfarm_type</a> == WindFarmType::EWP or</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;           <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac0a723e8797cdc0fe06b3fc781fca645">windfarm_type</a> == WindFarmType::SimpleAD){</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            IntVect ng_turb = Nturb[lev].nGrowVect();</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            MultiFab mf_Nturb(grids[lev],dmap[lev],1,ng_turb);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            MultiFab::Copy(mf_Nturb,Nturb[lev],0,0,1,ng_turb);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            VisMF::Write(mf_Nturb, amrex::MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;NumTurb&quot;</span>));</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        }</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a43c1741535574c7e6f4fe6bf90552f31">lsm_type</a> != LandSurfaceType::None) {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> mvar(0); mvar&lt;<a class="code" href="classERF.html#ad03da3399e893728741fac33100ce476">lsm_data</a>[lev].size(); ++mvar) {</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                BoxArray ba = <a class="code" href="classERF.html#ad03da3399e893728741fac33100ce476">lsm_data</a>[lev][mvar]-&gt;boxArray();</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                DistributionMapping dm = <a class="code" href="classERF.html#ad03da3399e893728741fac33100ce476">lsm_data</a>[lev][mvar]-&gt;DistributionMap();</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                IntVect <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a> = <a class="code" href="classERF.html#ad03da3399e893728741fac33100ce476">lsm_data</a>[lev][mvar]-&gt;nGrowVect();</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                <span class="keywordtype">int</span> nvar = <a class="code" href="classERF.html#ad03da3399e893728741fac33100ce476">lsm_data</a>[lev][mvar]-&gt;nComp();</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                MultiFab lsm_vars(ba,dm,nvar,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                MultiFab::Copy(lsm_vars,*(<a class="code" href="classERF.html#ad03da3399e893728741fac33100ce476">lsm_data</a>[lev][mvar]),0,0,nvar,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                VisMF::Write(lsm_vars, MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;LsmVars&quot;</span>));</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            }</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        }</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        IntVect <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a> = <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85bac2a428daaf1a1b398630fa8cec7f115b">MapFacType::m_x</a>]-&gt;nGrowVect();</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        MultiFab mf_m(<a class="code" href="classERF.html#a268a79187ae9a115e601957f8b06cd42">ba2d</a>[lev],dmap[lev],1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        MultiFab::Copy(mf_m,*<a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85bac2a428daaf1a1b398630fa8cec7f115b">MapFacType::m_x</a>],0,0,1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        VisMF::Write(mf_m, MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;MapFactor_mx&quot;</span>));</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="preprocessor">#if 0</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85bac2a428daaf1a1b398630fa8cec7f115b">MapFacType::m_x</a> != <a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85ba9612b6816e2fb7dc3ad56d6bc1fb7df8">MapFacType::m_y</a>) {</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            MultiFab::Copy(mf_m,*<a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85ba9612b6816e2fb7dc3ad56d6bc1fb7df8">MapFacType::m_y</a>],0,0,1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            VisMF::Write(mf_m, MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;MapFactor_my&quot;</span>));</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        }</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a> = <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85baa4b935f173fee2d487101e302a5cfe18">MapFacType::u_x</a>]-&gt;nGrowVect();</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        MultiFab mf_u(convert(<a class="code" href="classERF.html#a268a79187ae9a115e601957f8b06cd42">ba2d</a>[lev],IntVect(1,0,0)),dmap[lev],1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        MultiFab::Copy(mf_u,*<a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85baa4b935f173fee2d487101e302a5cfe18">MapFacType::u_x</a>],0,0,1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        VisMF::Write(mf_u, MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;MapFactor_ux&quot;</span>));</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="preprocessor">#if 0</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85bac2a428daaf1a1b398630fa8cec7f115b">MapFacType::m_x</a> != <a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85ba9612b6816e2fb7dc3ad56d6bc1fb7df8">MapFacType::m_y</a>) {</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            MultiFab::Copy(mf_u,*<a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85ba784971ba75d56c0d71c4bc08c5ddc1f3">MapFacType::u_y</a>],0,0,1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            VisMF::Write(mf_u, MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;MapFactor_uy&quot;</span>));</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        }</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a> = <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85ba21e22c79b875be81696b36a623690388">MapFacType::v_x</a>]-&gt;nGrowVect();</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        MultiFab mf_v(convert(<a class="code" href="classERF.html#a268a79187ae9a115e601957f8b06cd42">ba2d</a>[lev],IntVect(0,1,0)),dmap[lev],1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        MultiFab::Copy(mf_v,*<a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85ba21e22c79b875be81696b36a623690388">MapFacType::v_x</a>],0,0,1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        VisMF::Write(mf_v, MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;MapFactor_vx&quot;</span>));</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="preprocessor">#if 0</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85bac2a428daaf1a1b398630fa8cec7f115b">MapFacType::m_x</a> != <a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85ba9612b6816e2fb7dc3ad56d6bc1fb7df8">MapFacType::m_y</a>) {</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            MultiFab::Copy(mf_v,*<a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85ba90990e92021688dbfd1cec52b03fd182">MapFacType::v_y</a>],0,0,1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            VisMF::Write(mf_v, MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;MapFactor_vy&quot;</span>));</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ac50bb696daf587e13f9a1e57c687375e">m_SurfaceLayer</a>)  {</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Writing SurfaceLayer variables&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a> = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nGrowVect(); <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>[2]=0;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            MultiFab   m_var(<a class="code" href="classERF.html#a268a79187ae9a115e601957f8b06cd42">ba2d</a>[lev],dmap[lev],1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            MultiFab* src = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            <span class="comment">// U*</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            src = <a class="code" href="classERF.html#ac50bb696daf587e13f9a1e57c687375e">m_SurfaceLayer</a>-&gt;get_u_star(lev);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            MultiFab::Copy(m_var,*src,0,0,1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            VisMF::Write(m_var, MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;Ustar&quot;</span>));</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            <span class="comment">// W*</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            src = <a class="code" href="classERF.html#ac50bb696daf587e13f9a1e57c687375e">m_SurfaceLayer</a>-&gt;get_w_star(lev);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            MultiFab::Copy(m_var,*src,0,0,1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            VisMF::Write(m_var, MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;Wstar&quot;</span>));</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            <span class="comment">// T*</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            src = <a class="code" href="classERF.html#ac50bb696daf587e13f9a1e57c687375e">m_SurfaceLayer</a>-&gt;get_t_star(lev);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            MultiFab::Copy(m_var,*src,0,0,1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            VisMF::Write(m_var, MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;Tstar&quot;</span>));</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            <span class="comment">// Q*</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            src = <a class="code" href="classERF.html#ac50bb696daf587e13f9a1e57c687375e">m_SurfaceLayer</a>-&gt;get_q_star(lev);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            MultiFab::Copy(m_var,*src,0,0,1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;            VisMF::Write(m_var, MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;Qstar&quot;</span>));</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            <span class="comment">// Olen</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            src = <a class="code" href="classERF.html#ac50bb696daf587e13f9a1e57c687375e">m_SurfaceLayer</a>-&gt;get_olen(lev);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            MultiFab::Copy(m_var,*src,0,0,1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            VisMF::Write(m_var, MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;Olen&quot;</span>));</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            <span class="comment">// PBLH</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            src = <a class="code" href="classERF.html#ac50bb696daf587e13f9a1e57c687375e">m_SurfaceLayer</a>-&gt;get_pblh(lev);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            MultiFab::Copy(m_var,*src,0,0,1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            VisMF::Write(m_var, MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;PBLH&quot;</span>));</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            <span class="comment">// Z0</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            <span class="keywordflow">for</span> (MFIter mfi(m_var); mfi.isValid(); ++mfi) {</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.growntilebox();</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                Array4&lt;const Real&gt; <span class="keyword">const</span>&amp; fab_arr = <a class="code" href="classERF.html#ac50bb696daf587e13f9a1e57c687375e">m_SurfaceLayer</a>-&gt;get_z0(lev)-&gt;const_array();</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                Array4&lt;      Real&gt; <span class="keyword">const</span>&amp;  mv_arr = m_var.array(mfi);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                ParallelFor(bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) {</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                    mv_arr(i,j,k) = fab_arr(i,j,k);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                });</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            VisMF::Write(m_var, MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;Z0&quot;</span>));</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        }</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160; </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a5a5395054a212d8f3fc577562c14b66e">sst_lev</a>[lev][0]) {</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            <span class="keywordtype">int</span> ntimes = 1;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a> = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nGrowVect(); <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>[2]=0;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            MultiFab sst_at_t(<a class="code" href="classERF.html#a268a79187ae9a115e601957f8b06cd42">ba2d</a>[lev],dmap[lev],1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nt(0); nt&lt;ntimes; ++nt) {</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                MultiFab::Copy(sst_at_t,*<a class="code" href="classERF.html#a5a5395054a212d8f3fc577562c14b66e">sst_lev</a>[lev][nt],0,0,1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                VisMF::Write(sst_at_t, MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>,</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                                                             <span class="stringliteral">&quot;SST_&quot;</span> + std::to_string(nt)));</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            }</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        }</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#af89fb8b555dde334c978cdfd3fcd9d07">tsk_lev</a>[lev][0]) {</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            <span class="keywordtype">int</span> ntimes = 1;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a> = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nGrowVect(); <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>[2]=0;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            MultiFab tsk_at_t(<a class="code" href="classERF.html#a268a79187ae9a115e601957f8b06cd42">ba2d</a>[lev],dmap[lev],1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nt(0); nt&lt;ntimes; ++nt) {</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                MultiFab::Copy(tsk_at_t,*<a class="code" href="classERF.html#af89fb8b555dde334c978cdfd3fcd9d07">tsk_lev</a>[lev][nt],0,0,1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                VisMF::Write(tsk_at_t, MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>,</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                                                             <span class="stringliteral">&quot;TSK_&quot;</span> + std::to_string(nt)));</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            }</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        }</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160; </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            <span class="keywordtype">int</span> ntimes = 1;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a> = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nGrowVect(); <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>[2]=0;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            MultiFab lmask_at_t(<a class="code" href="classERF.html#a268a79187ae9a115e601957f8b06cd42">ba2d</a>[lev],dmap[lev],1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nt(0); nt&lt;ntimes; ++nt) {</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                <span class="keywordflow">for</span> (MFIter mfi(lmask_at_t); mfi.isValid(); ++mfi) {</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                    <span class="keyword">const</span> Box&amp; bx = mfi.growntilebox();</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                    Array4&lt;int&gt;  <span class="keyword">const</span>&amp; src_arr = <a class="code" href="classERF.html#a3f3e29874221e43e13e2a431e77e0e4e">lmask_lev</a>[lev][nt]-&gt;array(mfi);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                    Array4&lt;Real&gt; <span class="keyword">const</span>&amp; dst_arr = lmask_at_t.array(mfi);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                    ParallelFor(bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                    {</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                        dst_arr(i,j,k) = Real(src_arr(i,j,k));</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                    });</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                }</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                VisMF::Write(lmask_at_t, MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>,</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                                                              <span class="stringliteral">&quot;LMASK_&quot;</span> + std::to_string(nt)));</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            }</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        }</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="preprocessor">#ifdef ERF_USE_NETCDF</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        IntVect ngv = <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>; ngv[2] = 0;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <span class="comment">// Write lat/lon if it exists</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        <span class="keywordflow">if</span> (lat_m[lev] &amp;&amp; lon_m[lev] &amp;&amp; <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ae2c963893d0c53465ac84c0bd8998a38">has_lat_lon</a>) {</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Writing Lat/Lon variables&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            MultiFab lat(<a class="code" href="classERF.html#a268a79187ae9a115e601957f8b06cd42">ba2d</a>[lev],dmap[lev],1,ngv);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            MultiFab lon(<a class="code" href="classERF.html#a268a79187ae9a115e601957f8b06cd42">ba2d</a>[lev],dmap[lev],1,ngv);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            MultiFab::Copy(lat,*lat_m[lev],0,0,1,ngv);</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            MultiFab::Copy(lon,*lon_m[lev],0,0,1,ngv);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            VisMF::Write(lat, MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;LAT&quot;</span>));</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            VisMF::Write(lon, MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;LON&quot;</span>));</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        }</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160; </div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        <span class="comment">// Write sinPhi and cosPhi if it exists</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#ad6a92272a5ad07f176892de07353f268">cosPhi_m</a>[lev] &amp;&amp; <a class="code" href="classERF.html#ab54f3fc49bad059469da4e34c82296a6">sinPhi_m</a>[lev] &amp;&amp; <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa54aafe316efc6cf474326d690fb2fbf">variable_coriolis</a>) {</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Writing Coriolis factors&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            MultiFab sphi(<a class="code" href="classERF.html#a268a79187ae9a115e601957f8b06cd42">ba2d</a>[lev],dmap[lev],1,ngv);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            MultiFab cphi(<a class="code" href="classERF.html#a268a79187ae9a115e601957f8b06cd42">ba2d</a>[lev],dmap[lev],1,ngv);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            MultiFab::Copy(sphi,*<a class="code" href="classERF.html#ab54f3fc49bad059469da4e34c82296a6">sinPhi_m</a>[lev],0,0,1,ngv);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;            MultiFab::Copy(cphi,*<a class="code" href="classERF.html#ad6a92272a5ad07f176892de07353f268">cosPhi_m</a>[lev],0,0,1,ngv);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            VisMF::Write(sphi, MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;SinPhi&quot;</span>));</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            VisMF::Write(cphi, MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;CosPhi&quot;</span>));</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        }</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160; </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ad57b63939b19e90b87dd61d3f293b0d7">use_real_bcs</a> &amp;&amp; <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac1ddc9c301ac98689bf3b7b7184b24e1">init_type</a> == InitType::WRFInput) {</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;            MultiFab tmp1d(<a class="code" href="classERF.html#a8c051cb96bfa9ff26929441978aa2a96">ba1d</a>[lev],dmap[lev],1,ngv);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;            MultiFab tmp2d(<a class="code" href="classERF.html#a268a79187ae9a115e601957f8b06cd42">ba2d</a>[lev],dmap[lev],1,ngv);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160; </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            MultiFab::Copy(tmp1d,*<a class="code" href="classERF.html#a8839af37a73c4c2e76bf978a05275ca9">mf_C1H</a>[lev],0,0,1,ngv);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            VisMF::Write(tmp1d, MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;C1H&quot;</span>));</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160; </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            MultiFab::Copy(tmp1d,*<a class="code" href="classERF.html#ad473e8e616ea3f7bf7bf922a0fe16208">mf_C2H</a>[lev],0,0,1,ngv);</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            VisMF::Write(tmp1d, MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;C2H&quot;</span>));</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160; </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;            MultiFab::Copy(tmp2d,*<a class="code" href="classERF.html#aed4ae5792dd32adf56d3c052ce79437f">mf_MUB</a>[lev],0,0,1,ngv);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            VisMF::Write(tmp2d, MultiFabFileFullPrefix(lev, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;MUB&quot;</span>));</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        }</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    } <span class="comment">// for lev</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160; </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="preprocessor">#ifdef ERF_USE_PARTICLES</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;   particleData.Checkpoint(checkpointname);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160; </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="preprocessor">#if 0</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="preprocessor">#ifdef ERF_USE_NETCDF</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;   <span class="comment">// Write bdy_data files</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;   <span class="keywordflow">if</span> ( ParallelDescriptor::IOProcessor() &amp;&amp;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        ((<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac1ddc9c301ac98689bf3b7b7184b24e1">init_type</a>==InitType::WRFInput) || (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac1ddc9c301ac98689bf3b7b7184b24e1">init_type</a>==InitType::Metgrid)) &amp;&amp;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;         <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ad57b63939b19e90b87dd61d3f293b0d7">use_real_bcs</a> )</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;   {</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;       <span class="comment">// Vector dimensions</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;       <span class="keywordtype">int</span> num_time = bdy_data_xlo.size();</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;       <span class="keywordtype">int</span> num_var  = bdy_data_xlo[0].size();</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160; </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;       <span class="comment">// Open header file and write to it</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;       std::ofstream bdy_h_file(MultiFabFileFullPrefix(0, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;bdy_H&quot;</span>));</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;       bdy_h_file &lt;&lt; std::setprecision(1) &lt;&lt; std::fixed;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;       bdy_h_file &lt;&lt; num_time &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;       bdy_h_file &lt;&lt; num_var  &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;       bdy_h_file &lt;&lt; start_bdy_time &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;       bdy_h_file &lt;&lt; bdy_time_interval &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;       bdy_h_file &lt;&lt; <a class="code" href="classERF.html#abb15119348ad5399947bc8883084b230">real_width</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ivar(0); ivar&lt;num_var; ++ivar) {</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;           bdy_h_file &lt;&lt; bdy_data_xlo[0][ivar].box() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;           bdy_h_file &lt;&lt; bdy_data_xhi[0][ivar].box() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;           bdy_h_file &lt;&lt; bdy_data_ylo[0][ivar].box() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;           bdy_h_file &lt;&lt; bdy_data_yhi[0][ivar].box() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;       }</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160; </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;       <span class="comment">// Open data file and write to it</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;       std::ofstream bdy_d_file(MultiFabFileFullPrefix(0, checkpointname, <span class="stringliteral">&quot;Level_&quot;</span>, <span class="stringliteral">&quot;bdy_D&quot;</span>));</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> itime(0); itime&lt;num_time; ++itime) {</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;           <span class="keywordflow">if</span> (bdy_data_xlo[itime].size() &gt; 0) {</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ivar(0); ivar&lt;num_var; ++ivar) {</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                   bdy_data_xlo[itime][ivar].writeOn(bdy_d_file,0,1);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                   bdy_data_xhi[itime][ivar].writeOn(bdy_d_file,0,1);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                   bdy_data_ylo[itime][ivar].writeOn(bdy_d_file,0,1);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                   bdy_data_yhi[itime][ivar].writeOn(bdy_d_file,0,1);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;               }</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;           }</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;       }</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;   }</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160; </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3a918bd26ed0c1dc2efa75c2586ff664"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a918bd26ed0c1dc2efa75c2586ff664">&#9670;&nbsp;</a></span>WriteGenericPlotfileHeaderWithTerrain()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::WriteGenericPlotfileHeaderWithTerrain </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>HeaderFile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlevels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Vector&lt; amrex::BoxArray &gt; &amp;&#160;</td>
          <td class="paramname"><em>bArray</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>varnames</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Vector&lt; amrex::Geometry &gt; &amp;&#160;</td>
          <td class="paramname"><em>my_geom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Vector&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>level_steps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Vector&lt; amrex::IntVect &gt; &amp;&#160;</td>
          <td class="paramname"><em>my_ref_ratio</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>versionName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>levelPrefix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>mfPrefix</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;{</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;    AMREX_ALWAYS_ASSERT(nlevels &lt;= bArray.size());</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;    AMREX_ALWAYS_ASSERT(nlevels &lt;= my_ref_ratio.size()+1);</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;    AMREX_ALWAYS_ASSERT(nlevels &lt;= level_steps.size());</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160; </div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;    HeaderFile.precision(17);</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160; </div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;    <span class="comment">// ---- this is the generic plot file type name</span></div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;    HeaderFile &lt;&lt; versionName &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160; </div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    HeaderFile &lt;&lt; varnames.size() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160; </div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ivar = 0; ivar &lt; varnames.size(); ++ivar) {</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;        HeaderFile &lt;&lt; varnames[ivar] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;    }</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;    HeaderFile &lt;&lt; AMREX_SPACEDIM &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;    HeaderFile &lt;&lt; my_time &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;    HeaderFile &lt;&lt; finest_level &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; ++i) {</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;        HeaderFile &lt;&lt; my_geom[0].ProbLo(i) &lt;&lt; <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;    }</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;    HeaderFile &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; AMREX_SPACEDIM; ++i) {</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;        HeaderFile &lt;&lt; my_geom[0].ProbHi(i) &lt;&lt; <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;    }</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;    HeaderFile &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; finest_level; ++i) {</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;        HeaderFile &lt;&lt; my_ref_ratio[i][0] &lt;&lt; <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;    }</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;    HeaderFile &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= finest_level; ++i) {</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;        HeaderFile &lt;&lt; my_geom[i].Domain() &lt;&lt; <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;    }</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;    HeaderFile &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= finest_level; ++i) {</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;        HeaderFile &lt;&lt; level_steps[i] &lt;&lt; <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;    }</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;    HeaderFile &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= finest_level; ++i) {</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; AMREX_SPACEDIM; ++k) {</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;            HeaderFile &lt;&lt; my_geom[i].CellSize()[k] &lt;&lt; <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;        }</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;        HeaderFile &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;    }</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;    HeaderFile &lt;&lt; (int) my_geom[0].<a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01">Coord</a>() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;    HeaderFile &lt;&lt; <span class="stringliteral">&quot;0\n&quot;</span>;</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160; </div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> level = 0; level &lt;= finest_level; ++level) {</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;        HeaderFile &lt;&lt; level &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; bArray[level].size() &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; my_time &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;        HeaderFile &lt;&lt; level_steps[level] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160; </div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;        <span class="keyword">const</span> IntVect&amp; domain_lo = my_geom[level].Domain().smallEnd();</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; bArray[level].size(); ++i)</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;        {</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;            <span class="comment">// Need to shift because the RealBox ctor we call takes the</span></div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;            <span class="comment">// physical location of index (0,0,0).  This does not affect</span></div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;            <span class="comment">// the usual cases where the domain index starts with 0.</span></div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;            <span class="keyword">const</span> Box&amp; b = shift(bArray[level][i], -domain_lo);</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;            RealBox loc = RealBox(b, my_geom[level].CellSize(), my_geom[level].ProbLo());</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; AMREX_SPACEDIM; ++n) {</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;                HeaderFile &lt;&lt; loc.lo(n) &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; loc.hi(n) &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;            }</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;        }</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160; </div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;        HeaderFile &lt;&lt; MultiFabHeaderPath(level, levelPrefix, mfPrefix) &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    }</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;    HeaderFile &lt;&lt; <span class="stringliteral">&quot;1&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;    HeaderFile &lt;&lt; <span class="stringliteral">&quot;3&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;    HeaderFile &lt;&lt; <span class="stringliteral">&quot;amrexvec_nu_x&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;    HeaderFile &lt;&lt; <span class="stringliteral">&quot;amrexvec_nu_y&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;    HeaderFile &lt;&lt; <span class="stringliteral">&quot;amrexvec_nu_z&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;    std::string mf_nodal_prefix = <span class="stringliteral">&quot;Nu_nd&quot;</span>;</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> level = 0; level &lt;= finest_level; ++level) {</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;        HeaderFile &lt;&lt; MultiFabHeaderPath(level, levelPrefix, mf_nodal_prefix) &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;    }</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;}</div>
<div class="ttc" id="aERF__DataStruct_8H_html_a627f1f843904477f763577ad1460de01"><div class="ttname"><a href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01">Coord</a></div><div class="ttdeci">Coord</div><div class="ttdef"><b>Definition:</b> ERF_DataStruct.H:81</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa2d8099655a8779836e63e3e98ea4372"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2d8099655a8779836e63e3e98ea4372">&#9670;&nbsp;</a></span>writeJobInfo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::writeJobInfo </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>dir</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;{</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    <span class="comment">// job_info file with details about the run</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    std::ofstream jobInfoFile;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    std::string FullPathJobInfoFile = dir;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    FullPathJobInfoFile += <span class="stringliteral">&quot;/job_info&quot;</span>;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    jobInfoFile.open(FullPathJobInfoFile.c_str(), std::ios::out);</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    std::string PrettyLine = <span class="stringliteral">&quot;===================================================&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;      <span class="stringliteral">&quot;============================\n&quot;</span>;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    std::string OtherLine = <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;      <span class="stringliteral">&quot;----------------------------\n&quot;</span>;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    std::string SkipSpace = <span class="stringliteral">&quot;        &quot;</span>;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="comment">// job information</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot; ERF Job Information\n&quot;</span>;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;inputs file: &quot;</span> &lt;&lt; <a class="code" href="ERF__WriteJobInfo_8cpp.html#aabaa127a3a319c1b86090d6c88568965">inputs_name</a> &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;number of MPI processes: &quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;                &lt;&lt; ParallelDescriptor::NProcs() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;number of threads:       &quot;</span> &lt;&lt; omp_get_max_threads() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;CPU time used since start of simulation (CPU-hours): &quot;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;                &lt;&lt; <a class="code" href="classERF.html#ae0597da6edf955cd138e52fd00380ff2">getCPUTime</a>() / 3600.0;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="comment">// plotfile information</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot; Plotfile Information\n&quot;</span>;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    time_t now = time(<span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="comment">// Convert now to tm struct for local timezone</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    tm* localtm = localtime(&amp;now);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;output data / time: &quot;</span> &lt;&lt; asctime(localtm);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    std::string currentDir = FileSystem::CurrentPath();</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;output dir:         &quot;</span> &lt;&lt; currentDir &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="comment">// build information</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot; Build Information\n&quot;</span>;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;build date:    &quot;</span> &lt;&lt; <a class="code" href="namespaceamrex.html#a8f794ff24efbc4b60058492d1a073c78">buildInfoGetBuildDate</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;build machine: &quot;</span> &lt;&lt; buildInfoGetBuildMachine() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;build dir:     &quot;</span> &lt;&lt; buildInfoGetBuildDir() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;AMReX dir:     &quot;</span> &lt;&lt; buildInfoGetAMReXDir() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;COMP:          &quot;</span> &lt;&lt; <a class="code" href="namespaceamrex.html#a9d270ec83f99e836cca454cac4e0af5e">buildInfoGetComp</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;COMP version:  &quot;</span> &lt;&lt; <a class="code" href="namespaceamrex.html#aab3ca155f0d0a6d198817df9c35352f8">buildInfoGetCompVersion</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 1; n &lt;= buildInfoGetNumModules(); n++) {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      jobInfoFile &lt;&lt; buildInfoGetModuleName(n) &lt;&lt; <span class="stringliteral">&quot;: &quot;</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                  &lt;&lt; buildInfoGetModuleVal(n) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span>* githash1 = <a class="code" href="namespaceamrex.html#afa2dbdd17ead719f97272c9a0a2b0f8a">buildInfoGetGitHash</a>(1);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span>* githash2 = <a class="code" href="namespaceamrex.html#afa2dbdd17ead719f97272c9a0a2b0f8a">buildInfoGetGitHash</a>(2);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keywordflow">if</span> (strlen(githash1) &gt; 0) {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      jobInfoFile &lt;&lt; <span class="stringliteral">&quot;ERF       git hash: &quot;</span> &lt;&lt; githash1 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    }</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keywordflow">if</span> (strlen(githash2) &gt; 0) {</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      jobInfoFile &lt;&lt; <span class="stringliteral">&quot;AMReX       git hash: &quot;</span> &lt;&lt; githash2 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    }</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span>* buildgithash = buildInfoGetBuildGitHash();</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span>* buildgitname = buildInfoGetBuildGitName();</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordflow">if</span> (strlen(buildgithash) &gt; 0) {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      jobInfoFile &lt;&lt; buildgitname &lt;&lt; <span class="stringliteral">&quot; git hash: &quot;</span> &lt;&lt; buildgithash &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    }</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="comment">// grid information</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot; Grid Information\n&quot;</span>;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordtype">int</span> f_lev = finest_level;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= f_lev; i++) {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      jobInfoFile &lt;&lt; <span class="stringliteral">&quot; level: &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      jobInfoFile &lt;&lt; <span class="stringliteral">&quot;   number of boxes = &quot;</span> &lt;&lt; grids[i].size() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      jobInfoFile &lt;&lt; <span class="stringliteral">&quot;   maximum zones   = &quot;</span>;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; AMREX_SPACEDIM; n++) {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        jobInfoFile &lt;&lt; geom[i].Domain().length(n) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      }</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    }</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot; Boundary conditions\n&quot;</span>;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;   -x: &quot;</span> &lt;&lt; <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[0] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;   +x: &quot;</span> &lt;&lt; <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[3] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;   -y: &quot;</span> &lt;&lt; <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[1] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;   +y: &quot;</span> &lt;&lt; <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[4] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;   -z: &quot;</span> &lt;&lt; <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[2] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;   +z: &quot;</span> &lt;&lt; <a class="code" href="classERF.html#ae5968f1bed602fa87cdd5cb7905b7e5e">domain_bc_type</a>[5] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="comment">// runtime parameters</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    jobInfoFile &lt;&lt; <span class="stringliteral">&quot; Inputs File Parameters\n&quot;</span>;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    jobInfoFile &lt;&lt; PrettyLine;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    ParmParse::dumpTable(jobInfoFile, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    jobInfoFile.close();</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;}</div>
<div class="ttc" id="aERF__WriteJobInfo_8cpp_html_aabaa127a3a319c1b86090d6c88568965"><div class="ttname"><a href="ERF__WriteJobInfo_8cpp.html#aabaa127a3a319c1b86090d6c88568965">inputs_name</a></div><div class="ttdeci">std::string inputs_name</div><div class="ttdef"><b>Definition:</b> main.cpp:14</div></div>
<div class="ttc" id="aclassERF_html_ae0597da6edf955cd138e52fd00380ff2"><div class="ttname"><a href="classERF.html#ae0597da6edf955cd138e52fd00380ff2">ERF::getCPUTime</a></div><div class="ttdeci">static amrex::Real getCPUTime()</div><div class="ttdef"><b>Definition:</b> ERF.H:1322</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_aa2d8099655a8779836e63e3e98ea4372_cgraph.png" border="0" usemap="#aclassERF_aa2d8099655a8779836e63e3e98ea4372_cgraph" alt=""/></div>
<map name="aclassERF_aa2d8099655a8779836e63e3e98ea4372_cgraph" id="aclassERF_aa2d8099655a8779836e63e3e98ea4372_cgraph">
<area shape="rect" title=" " alt="" coords="5,81,137,108"/>
<area shape="rect" href="namespaceamrex.html#a8f794ff24efbc4b60058492d1a073c78" title=" " alt="" coords="197,5,413,32"/>
<area shape="rect" href="namespaceamrex.html#a9d270ec83f99e836cca454cac4e0af5e" title=" " alt="" coords="209,56,400,83"/>
<area shape="rect" href="namespaceamrex.html#aab3ca155f0d0a6d198817df9c35352f8" title=" " alt="" coords="185,107,424,133"/>
<area shape="rect" href="namespaceamrex.html#afa2dbdd17ead719f97272c9a0a2b0f8a" title=" " alt="" coords="203,157,407,184"/>
</map>
</div>

</div>
</div>
<a id="a61510e69bdaee84a01cf33943b043a5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61510e69bdaee84a01cf33943b043a5c">&#9670;&nbsp;</a></span>WriteMultiLevelPlotfileWithTerrain()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::WriteMultiLevelPlotfileWithTerrain </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>plotfilename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlevels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Vector&lt; const amrex::MultiFab * &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Vector&lt; const amrex::MultiFab * &gt; &amp;&#160;</td>
          <td class="paramname"><em>mf_nd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>varnames</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Vector&lt; amrex::Geometry &gt; &amp;&#160;</td>
          <td class="paramname"><em>my_geom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Real&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Vector&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>level_steps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Vector&lt; amrex::IntVect &gt; &amp;&#160;</td>
          <td class="paramname"><em>my_ref_ratio</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>versionName</em> = <code>&quot;HyperCLaw-V1.1&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>levelPrefix</em> = <code>&quot;Level_&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>mfPrefix</em> = <code>&quot;Cell&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>extra_dirs</em> = <code>amrex::Vector&lt;std::string&gt;()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;{</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;    BL_PROFILE(<span class="stringliteral">&quot;WriteMultiLevelPlotfileWithTerrain()&quot;</span>);</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160; </div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;    AMREX_ALWAYS_ASSERT(nlevels &lt;= mf.size());</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;    AMREX_ALWAYS_ASSERT(nlevels &lt;= <a class="code" href="namespacemodule__mp__morr__two__moment.html#a649e184a5c5c6d2eef72a390c18eb4e4">rr</a>.size()+1);</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;    AMREX_ALWAYS_ASSERT(nlevels &lt;= level_steps.size());</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;    AMREX_ALWAYS_ASSERT(mf[0]-&gt;nComp() == varnames.size());</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160; </div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;    <span class="keywordtype">bool</span> callBarrier(<span class="keyword">false</span>);</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;    PreBuildDirectorHierarchy(plotfilename, levelPrefix, nlevels, callBarrier);</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    <span class="keywordflow">if</span> (!extra_dirs.empty()) {</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; d : extra_dirs) {</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;            <span class="keyword">const</span> std::string ed = plotfilename+<span class="stringliteral">&quot;/&quot;</span>+d;</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;            PreBuildDirectorHierarchy(ed, levelPrefix, nlevels, callBarrier);</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;        }</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;    }</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;    ParallelDescriptor::Barrier();</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160; </div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;    <span class="keywordflow">if</span> (ParallelDescriptor::MyProc() == ParallelDescriptor::NProcs()-1) {</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;        Vector&lt;BoxArray&gt; boxArrays(nlevels);</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> level(0); level &lt; boxArrays.size(); ++level) {</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;            boxArrays[level] = mf[level]-&gt;boxArray();</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;        }</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160; </div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;        <span class="keyword">auto</span> f = [=]() {</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;            VisMF::IO_Buffer io_buffer(VisMF::IO_Buffer_Size);</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;            std::string HeaderFileName(plotfilename + <span class="stringliteral">&quot;/Header&quot;</span>);</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;            std::ofstream HeaderFile;</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;            HeaderFile.rdbuf()-&gt;pubsetbuf(io_buffer.dataPtr(), io_buffer.size());</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;            HeaderFile.open(HeaderFileName.c_str(), std::ofstream::out   |</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;                                                    std::ofstream::trunc |</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;                                                    std::ofstream::binary);</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;            <span class="keywordflow">if</span>( ! HeaderFile.good()) FileOpenFailed(HeaderFileName);</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;            <a class="code" href="classERF.html#a3a918bd26ed0c1dc2efa75c2586ff664">WriteGenericPlotfileHeaderWithTerrain</a>(HeaderFile, nlevels, boxArrays, varnames,</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;                                                  my_geom, time, level_steps, <a class="code" href="namespacemodule__mp__morr__two__moment.html#a649e184a5c5c6d2eef72a390c18eb4e4">rr</a>, versionName,</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;                                                  levelPrefix, mfPrefix);</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;        };</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160; </div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;        <span class="keywordflow">if</span> (AsyncOut::UseAsyncOut()) {</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;            AsyncOut::Submit(std::move(f));</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;            f();</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;        }</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    }</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160; </div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;    std::string mf_nodal_prefix = <span class="stringliteral">&quot;Nu_nd&quot;</span>;</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> level = 0; level &lt;= finest_level; ++level)</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;    {</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;        <span class="keywordflow">if</span> (AsyncOut::UseAsyncOut()) {</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;            VisMF::AsyncWrite(*mf[level],</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;                              MultiFabFileFullPrefix(level, plotfilename, levelPrefix, mfPrefix),</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;                              <span class="keyword">true</span>);</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;            VisMF::AsyncWrite(*mf_nd[level],</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;                              MultiFabFileFullPrefix(level, plotfilename, levelPrefix, mf_nodal_prefix),</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;                              <span class="keyword">true</span>);</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;            <span class="keyword">const</span> MultiFab* data;</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;            std::unique_ptr&lt;MultiFab&gt; mf_tmp;</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;            <span class="keywordflow">if</span> (mf[level]-&gt;nGrowVect() != 0) {</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;                mf_tmp = std::make_unique&lt;MultiFab&gt;(mf[level]-&gt;boxArray(),</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;                                                    mf[level]-&gt;DistributionMap(),</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;                                                    mf[level]-&gt;nComp(), 0, MFInfo(),</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;                                                    mf[level]-&gt;Factory());</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;                MultiFab::Copy(*mf_tmp, *mf[level], 0, 0, mf[level]-&gt;nComp(), 0);</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;                data = mf_tmp.get();</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;                data = mf[level];</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;            }</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;            VisMF::Write(*data        , MultiFabFileFullPrefix(level, plotfilename, levelPrefix, mfPrefix));</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;            VisMF::Write(*mf_nd[level], MultiFabFileFullPrefix(level, plotfilename, levelPrefix, mf_nodal_prefix));</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;        }</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;    }</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;}</div>
<div class="ttc" id="aclassERF_html_a3a918bd26ed0c1dc2efa75c2586ff664"><div class="ttname"><a href="classERF.html#a3a918bd26ed0c1dc2efa75c2586ff664">ERF::WriteGenericPlotfileHeaderWithTerrain</a></div><div class="ttdeci">void WriteGenericPlotfileHeaderWithTerrain(std::ostream &amp;HeaderFile, int nlevels, const amrex::Vector&lt; amrex::BoxArray &gt; &amp;bArray, const amrex::Vector&lt; std::string &gt; &amp;varnames, const amrex::Vector&lt; amrex::Geometry &gt; &amp;my_geom, amrex::Real time, const amrex::Vector&lt; int &gt; &amp;level_steps, const amrex::Vector&lt; amrex::IntVect &gt; &amp;my_ref_ratio, const std::string &amp;versionName, const std::string &amp;levelPrefix, const std::string &amp;mfPrefix) const</div><div class="ttdef"><b>Definition:</b> ERF_Plotfile.cpp:1666</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a31b92a0c6fa4e19ff90feef3611f5f06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31b92a0c6fa4e19ff90feef3611f5f06">&#9670;&nbsp;</a></span>WriteMyEBSurface()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::WriteMyEBSurface </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;{</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;  <span class="keyword">using namespace </span><a class="code" href="namespaceamrex.html">amrex</a>;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160; </div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;  amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Writing the geometry to a vtp file.\n&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160; </div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;  <span class="comment">// Only write at the finest level!</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;  <span class="keywordtype">int</span> lev = finest_level;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;  BoxArray &amp; ba            = grids[lev];</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;  DistributionMapping &amp; dm = dmap[lev];</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  <span class="keyword">const</span> EBFArrayBoxFactory* ebfact = &amp;<a class="code" href="classERF.html#ad024dd413ab20e5d6f69c1f96e5b78a3">EBFactory</a>(lev);</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  WriteEBSurface(ba,dm,Geom(lev),ebfact);</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;}</div>
<div class="ttc" id="anamespaceamrex_html"><div class="ttname"><a href="namespaceamrex.html">amrex</a></div><div class="ttdef"><b>Definition:</b> ERF_ConsoleIO.cpp:12</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a31b92a0c6fa4e19ff90feef3611f5f06_cgraph.png" border="0" usemap="#aclassERF_a31b92a0c6fa4e19ff90feef3611f5f06_cgraph" alt=""/></div>
<map name="aclassERF_a31b92a0c6fa4e19ff90feef3611f5f06_cgraph" id="aclassERF_a31b92a0c6fa4e19ff90feef3611f5f06_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,180,32"/>
<area shape="rect" href="classERF.html#ad024dd413ab20e5d6f69c1f96e5b78a3" title=" " alt="" coords="228,5,347,32"/>
</map>
</div>

</div>
</div>
<a id="af2e4de4eaa0f93149c1aefd58dc7068a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2e4de4eaa0f93149c1aefd58dc7068a">&#9670;&nbsp;</a></span>writeNow()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ERF::writeNow </td>
          <td>(</td>
          <td class="paramtype">const amrex::Real&#160;</td>
          <td class="paramname"><em>cur_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nstep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>plot_int</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const amrex::Real&#160;</td>
          <td class="paramname"><em>plot_per</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;{</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;    <span class="keywordtype">bool</span> write_now = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160; </div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;    <span class="keywordflow">if</span> ( plot_int &gt; 0 &amp;&amp; (nstep % plot_int == 0) ) {</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;        write_now = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160; </div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (plot_per &gt; 0.0) {</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160; </div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;        <span class="comment">// Check to see if we&#39;ve crossed a plot_per interval by comparing</span></div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;        <span class="comment">// the number of intervals that have elapsed for both the current</span></div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;        <span class="comment">// time and the time at the beginning of this timestep.</span></div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160; </div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;        <span class="keyword">const</span> Real eps = <a class="code" href="namespacemodule__model__constants.html#a8aff14ee510fe368c6991bc969cb5721">std::numeric_limits&lt;Real&gt;::epsilon</a>() * Real(10.0) * std::abs(cur_time);</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160; </div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;        <span class="keywordtype">int</span> num_per_old = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(std::floor((cur_time-eps-dt_lev) / plot_per));</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;        <span class="keywordtype">int</span> num_per_new = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(std::floor((cur_time-eps       ) / plot_per));</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160; </div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;        <span class="comment">// Before using these, however, we must test for the case where we&#39;re</span></div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;        <span class="comment">// within machine epsilon of the next interval. In that case, increment</span></div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;        <span class="comment">// the counter, because we have indeed reached the next plot_per interval</span></div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;        <span class="comment">// at this point.</span></div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160; </div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;        <span class="keyword">const</span> Real next_plot_time = (num_per_old + 1) * plot_per;</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160; </div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;        <span class="keywordflow">if</span> ((num_per_new == num_per_old) &amp;&amp; std::abs(cur_time - next_plot_time) &lt;= eps)</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;        {</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;            num_per_new += 1;</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;        }</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160; </div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;        <span class="comment">// Similarly, we have to account for the case where the old time is within</span></div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;        <span class="comment">// machine epsilon of the beginning of this interval, so that we don&#39;t double</span></div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;        <span class="comment">// count that time threshold -- we already plotted at that time on the last timestep.</span></div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160; </div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;        <span class="keywordflow">if</span> ((num_per_new != num_per_old) &amp;&amp; std::abs((cur_time - dt_lev) - next_plot_time) &lt;= eps)</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;            num_per_old += 1;</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160; </div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;        <span class="keywordflow">if</span> (num_per_old != num_per_new)</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;            write_now = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;    }</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;    <span class="keywordflow">return</span> write_now;</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;}</div>
<div class="ttc" id="anamespacemodule__model__constants_html_a8aff14ee510fe368c6991bc969cb5721"><div class="ttname"><a href="namespacemodule__model__constants.html#a8aff14ee510fe368c6991bc969cb5721">module_model_constants::epsilon</a></div><div class="ttdeci">real(c_double), parameter epsilon</div><div class="ttdef"><b>Definition:</b> ERF_module_model_constants.F90:12</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a98cccb83ca76c44d6ae583d051e76faf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98cccb83ca76c44d6ae583d051e76faf">&#9670;&nbsp;</a></span>WritePlotFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::WritePlotFile </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>which</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PlotFileType&#160;</td>
          <td class="paramname"><em>plotfile_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Vector&lt; std::string &gt;&#160;</td>
          <td class="paramname"><em>plot_var_names</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;{</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keyword">const</span> Vector&lt;std::string&gt; varnames = <a class="code" href="classERF.html#a2dcd22cb915d923c687f60267f44542b">PlotFileVarNames</a>(plot_var_names);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> ncomp_mf = varnames.size();</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keywordtype">int</span> ncomp_cons = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[0][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nComp();</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keywordflow">if</span> (ncomp_mf == 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="comment">// We Fillpatch here because some of the derived quantities require derivatives</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="comment">//     which require ghost cells to be filled.  We do not need to call FillPatcher</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="comment">//     because we don&#39;t need to set interior fine points.</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="comment">// NOTE: the momenta here are only used as scratch space, the momenta themselves are not fillpatched</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="comment">// Level 0 FilLPatch</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <a class="code" href="classERF.html#afded764725240c356faffa97dddbe03d">FillPatch</a>(0, <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0], {&amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[0][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], &amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[0][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                            &amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[0][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>], &amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[0][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>]});</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 1; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <span class="keywordtype">bool</span> fillset = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <a class="code" href="classERF.html#afded764725240c356faffa97dddbe03d">FillPatch</a>(lev, <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev], {&amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], &amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                                    &amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>], &amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>]},</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                                   {&amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                                    &amp;<a class="code" href="classERF.html#a01f3db32272f53dc68025f0a98195e57">rU_new</a>[lev], &amp;<a class="code" href="classERF.html#a54e37988486ef96e55e84bd8e91bb688">rV_new</a>[lev], &amp;<a class="code" href="classERF.html#aa46c0b0d20525aed10f447923e54dde7">rW_new</a>[lev]},</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                                    <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev], <a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev], fillset);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    }</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="comment">// Get qmoist pointers if using moisture</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keywordtype">bool</span> use_moisture = (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> != MoistureType::None);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> mvar(0); mvar&lt;<a class="code" href="classERF.html#ae00126a9c2738bf6a6cbbe77321c9cfc">qmoist</a>[lev].size(); ++mvar) {</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            <a class="code" href="classERF.html#ae00126a9c2738bf6a6cbbe77321c9cfc">qmoist</a>[lev][mvar] = <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;Get_Qmoist_Ptr(lev,mvar);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        }</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    }</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160; </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="comment">// Vector of MultiFabs for cell-centered data</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    Vector&lt;MultiFab&gt; mf(finest_level+1);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        mf[lev].define(grids[lev], dmap[lev], ncomp_mf, 0);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    }</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160; </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="comment">// Vector of MultiFabs for nodal data</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    Vector&lt;MultiFab&gt; mf_nd(finest_level+1);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="structSolverChoice.html#a1952672901901b0b3a628f2298dc72c2">SolverChoice::mesh_type</a> != MeshType::ConstantDz) {</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            BoxArray nodal_grids(grids[lev]); nodal_grids.surroundingNodes();</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            mf_nd[lev].define(nodal_grids, dmap[lev], 3, 0);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            mf_nd[lev].setVal(0.);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        }</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160; </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="comment">// Vector of MultiFabs for face-centered velocity</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    Vector&lt;MultiFab&gt; mf_u(finest_level+1);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    Vector&lt;MultiFab&gt; mf_v(finest_level+1);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    Vector&lt;MultiFab&gt; mf_w(finest_level+1);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a367a3daba5d844efbed84c52e647cea6">m_plot_face_vels</a>) {</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            BoxArray grid_stag_u(grids[lev]); grid_stag_u.surroundingNodes(0);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            BoxArray grid_stag_v(grids[lev]); grid_stag_v.surroundingNodes(1);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            BoxArray grid_stag_w(grids[lev]); grid_stag_w.surroundingNodes(2);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            mf_u[lev].define(grid_stag_u, dmap[lev], 1, 0);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            mf_v[lev].define(grid_stag_v, dmap[lev], 1, 0);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            mf_w[lev].define(grid_stag_w, dmap[lev], 1, 0);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;            MultiFab::Copy(mf_u[lev],<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],0,0,1,0);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;            MultiFab::Copy(mf_v[lev],<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],0,0,1,0);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;            MultiFab::Copy(mf_w[lev],<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>],0,0,1,0);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        }</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    }</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160; </div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="comment">// Array of MultiFabs for cell-centered velocity</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    Vector&lt;MultiFab&gt; mf_cc_vel(finest_level+1);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;x_velocity&quot;</span> ) ||</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        <a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;y_velocity&quot;</span> ) ||</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        <a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;z_velocity&quot;</span> ) ||</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        <a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;magvel&quot;</span>     ) ||</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;vorticity_x&quot;</span>) ||</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        <a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;vorticity_y&quot;</span>) ||</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        <a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;vorticity_z&quot;</span>) ) {</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            mf_cc_vel[lev].define(grids[lev], dmap[lev], AMREX_SPACEDIM, IntVect(1,1,1));</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            mf_cc_vel[lev].setVal(-1.e20);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            average_face_to_cellcenter(mf_cc_vel[lev],0,</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                                       Array&lt;const MultiFab*,3&gt;{&amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                                                                &amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                                                                &amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>]});</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        } <span class="comment">// lev</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    } <span class="comment">// if (vel or vort)</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160; </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="comment">// We need ghost cells if computing vorticity</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;vorticity_x&quot;</span>)||</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;         <a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;vorticity_y&quot;</span>) ||</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;         <a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;vorticity_z&quot;</span>) )</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    {</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        amrex::Interpolater* mapper = &amp;cell_cons_interp;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 1; lev &lt;= finest_level; ++lev)</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        {</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            Vector&lt;MultiFab*&gt; fmf = {&amp;(mf_cc_vel[lev]), &amp;(mf_cc_vel[lev])};</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;            Vector&lt;Real&gt; ftime    = {<a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev], <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev]};</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            Vector&lt;MultiFab*&gt; cmf = {&amp;mf_cc_vel[lev-1], &amp;mf_cc_vel[lev-1]};</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            Vector&lt;Real&gt; ctime    = {<a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev], <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev]};</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160; </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;            <a class="code" href="classERF.html#a0857fa7f21e3077bb8bd7808023a6d09">FillBdyCCVels</a>(mf_cc_vel,lev-1);</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160; </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            <span class="comment">// Call FillPatch which ASSUMES that all ghost cells at lev-1 have already been filled</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            FillPatchTwoLevels(mf_cc_vel[lev], mf_cc_vel[lev].nGrowVect(), IntVect(0,0,0),</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                               <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev], cmf, ctime, fmf, ftime,</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                               0, 0, mf_cc_vel[lev].nComp(), geom[lev-1], geom[lev],</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                               refRatio(lev-1), mapper, <a class="code" href="classERF.html#a574521986a6e403159f83c8b8123ba90">domain_bcs_type</a>,</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                               <a class="code" href="namespaceBaseBCVars.html#a5dc17426e44fb9fc3f4606bf2a49c39fa130fa0d9896caf6fa4bd2af4e74a5bf6">BaseBCVars::rho0_bc_comp</a>);</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        } <span class="comment">// lev</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        <a class="code" href="classERF.html#a0857fa7f21e3077bb8bd7808023a6d09">FillBdyCCVels</a>(mf_cc_vel);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    } <span class="comment">// if (vort)</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160; </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev)</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    {</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <span class="keywordtype">int</span> mf_comp = 0;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160; </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        BoxArray ba(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].boxArray());</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        DistributionMapping dm = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].DistributionMap();</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160; </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        <span class="comment">// First, copy any of the conserved state variables into the output plotfile</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classERF.html#afd8cd5a477754776135befa668fdd0c9">cons_names</a>.size(); ++i) {</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <a class="code" href="classERF.html#afd8cd5a477754776135befa668fdd0c9">cons_names</a>[i])) {</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                MultiFab::Copy(mf[lev],<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],i,mf_comp,1,0);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                mf_comp++;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;            }</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        }</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160; </div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <span class="comment">// Next, check for velocities</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;x_velocity&quot;</span>)) {</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            MultiFab::Copy(mf[lev], mf_cc_vel[lev], 0, mf_comp, 1, 0);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            mf_comp += 1;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        }</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;y_velocity&quot;</span>)) {</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;            MultiFab::Copy(mf[lev], mf_cc_vel[lev], 1, mf_comp, 1, 0);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;            mf_comp += 1;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        }</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;z_velocity&quot;</span>)) {</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;            MultiFab::Copy(mf[lev], mf_cc_vel[lev], 2, mf_comp, 1, 0);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;            mf_comp += 1;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        }</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        <span class="comment">// Finally, check for any derived quantities and compute them, inserting</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        <span class="comment">// them into our output multifab</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        <span class="keyword">auto</span> calculate_derived = [&amp;](<span class="keyword">const</span> std::string&amp; der_name,</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                                     MultiFab&amp; src_mf,</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                                     decltype(<a class="code" href="namespacederived.html#a7fb98e12fceaa6f691dfef83db453757">derived::erf_dernull</a>)&amp; der_function)</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        {</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, der_name)) {</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                MultiFab dmf(mf[lev], make_alias, mf_comp, 1);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="preprocessor">#pragma omp parallel if (amrex::Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                <span class="keywordflow">for</span> (MFIter mfi(dmf, TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                {</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                    <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                    <span class="keyword">auto</span>&amp; dfab = dmf[mfi];</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                    <span class="keyword">auto</span>&amp; sfab = src_mf[mfi];</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                    der_function(bx, dfab, 0, 1, sfab, Geom(lev), <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0], <span class="keyword">nullptr</span>, lev);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                }</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160; </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                mf_comp++;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;            }</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        };</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160; </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <span class="keywordtype">bool</span> ismoist = (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> != MoistureType::None);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160; </div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        <span class="comment">// Note: All derived variables must be computed in order of &quot;derived_names&quot; defined in ERF.H</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        calculate_derived(<span class="stringliteral">&quot;soundspeed&quot;</span>,  <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], <a class="code" href="namespacederived.html#afe57e0f13e2e24c73d0ed373a9cd0d09">derived::erf_dersoundspeed</a>);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        <span class="keywordflow">if</span> (ismoist) {</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;            calculate_derived(<span class="stringliteral">&quot;temp&quot;</span>,        <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], <a class="code" href="namespacederived.html#add1791d7423c133ba6e7ab55975cf34f">derived::erf_dermoisttemp</a>);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;            calculate_derived(<span class="stringliteral">&quot;temp&quot;</span>,        <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], <a class="code" href="namespacederived.html#a8d96f91847cec51636c122ab27a5f8a2">derived::erf_dertemp</a>);</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        }</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        calculate_derived(<span class="stringliteral">&quot;theta&quot;</span>,       <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], <a class="code" href="namespacederived.html#adc3c787125484205e4fc7cd85c25ab6c">derived::erf_dertheta</a>);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        calculate_derived(<span class="stringliteral">&quot;KE&quot;</span>,          <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], <a class="code" href="namespacederived.html#acc3f245c73a0826afc9e7626f12126d3">derived::erf_derKE</a>);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        calculate_derived(<span class="stringliteral">&quot;scalar&quot;</span>,      <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], <a class="code" href="namespacederived.html#a37560f4d3e2c7c10f64d41db2ce76a06">derived::erf_derscalar</a>);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        calculate_derived(<span class="stringliteral">&quot;vorticity_x&quot;</span>, mf_cc_vel[lev]           , <a class="code" href="namespacederived.html#a0a37dd4fa4a044e34891e6222d06654c">derived::erf_dervortx</a>);</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        calculate_derived(<span class="stringliteral">&quot;vorticity_y&quot;</span>, mf_cc_vel[lev]           , <a class="code" href="namespacederived.html#a2a85aedf7c75ca416dbb931559c4b21e">derived::erf_dervorty</a>);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        calculate_derived(<span class="stringliteral">&quot;vorticity_z&quot;</span>, mf_cc_vel[lev]           , <a class="code" href="namespacederived.html#a8bc196f7dfb365c426b0b7e720e479e2">derived::erf_dervortz</a>);</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        calculate_derived(<span class="stringliteral">&quot;magvel&quot;</span>     , mf_cc_vel[lev]           , <a class="code" href="namespacederived.html#a5186c6ea33e82af321f529242a615dc2">derived::erf_dermagvel</a>);</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        MultiFab  r_hse(<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev], make_alias, <a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91abc888a343d4fcc4fc4ffb79c6ac7cb93">BaseState::r0_comp</a> , 1);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        MultiFab  p_hse(<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev], make_alias, <a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91aa8253dc5484f2621e0bf8d51d98d635e">BaseState::p0_comp</a> , 1);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        MultiFab th_hse(<a class="code" href="classERF.html#a4c1fae5e620fcd64cc9ede73715e3b7c">base_state</a>[lev], make_alias, <a class="code" href="namespaceBaseState.html#a6f8dc3597225ea7941dad615e7f22e91aaf394bbf6aa8da56fc479f2ed5a2a372">BaseState::th0_comp</a>, 1);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160; </div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        MultiFab pressure;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160; </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa7be0d60ce3de3441d44082cc1b725ec">anelastic</a>[lev] == 0) {</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;pressure&quot;</span>)  ||</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                <a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;pert_pres&quot;</span>) ||</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                <a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;dpdx&quot;</span>)      ||</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                <a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;dpdy&quot;</span>)      ||</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                <a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;dpdz&quot;</span>))</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;            {</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                <span class="keywordtype">int</span> <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a> = (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;dpdx&quot;</span>) || <a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;dpdy&quot;</span>) ||</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                          <a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;dpdz&quot;</span>)) ? 1 : 0;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160; </div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                <span class="comment">// Allocate space for pressure</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                pressure.define(ba,dm,1,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>);</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160; </div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a> &gt; 0) {</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                    <span class="comment">// Default to p_hse as a way of filling ghost cells at domain boundaries</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                    MultiFab::Copy(pressure,p_hse,0,0,1,1);</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                }</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="preprocessor">#pragma omp parallel if (amrex::Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                <span class="keywordflow">for</span> ( MFIter mfi(mf[lev],TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                {</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                    <span class="keyword">const</span> Box&amp; gbx = mfi.growntilebox(IntVect(<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>,<a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa281c2ff050bdb2a9349d3408926af821">ng</a>,0));</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160; </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                    <span class="keyword">const</span> Array4&lt;Real      &gt;&amp; p_arr = pressure.array(mfi);</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                    <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; S_arr = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].const_array(mfi);</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">int</span> ncomp = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nComp();</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160; </div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                    ParallelFor(gbx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                    {</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                        Real qv_for_p = (use_moisture &amp;&amp; (ncomp &gt; <a class="code" href="ERF__IndexDefines_8H.html#aa965e9988f14d5d2a5aef4a942168a15">RhoQ1_comp</a>)) ? S_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#aa965e9988f14d5d2a5aef4a942168a15">RhoQ1_comp</a>)/S_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>) : 0;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                        <span class="keyword">const</span> Real rhotheta = S_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                        p_arr(i, j, k) = <a class="code" href="ERF__EOS_8H.html#a08354ab110fb9e873bce9250b4f4b46e">getPgivenRTh</a>(rhotheta,qv_for_p);</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                    });</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;               } <span class="comment">// mfi</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;               pressure.FillBoundary(geom[lev].periodicity());</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;            } <span class="comment">// compute compressible pressure</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        } <span class="comment">// not anelastic</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;            <span class="comment">// Copy p_hse into pressure if using anelastic</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;            pressure.define(ba,dm,1,0);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;            MultiFab::Copy(pressure,p_hse,0,0,1,0);</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        }</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160; </div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;divU&quot;</span>))</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        {</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;            <span class="comment">// TODO TODO TODO  -- we need to convert w to omega here!!</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;            MultiFab dmf(mf[lev], make_alias, mf_comp, 1);</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;            Array&lt;MultiFab const*, AMREX_SPACEDIM&gt; u;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;            u[0] = &amp;(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>]);</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;            u[1] = &amp;(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>]);</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;            u[2] = &amp;(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>]);</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;            <a class="code" href="classERF.html#a757e8303ce8ed936c05f559349f10aa5">compute_divergence</a> (lev, dmf, u, geom[lev]);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;            mf_comp += 1;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        }</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160; </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;pres_hse&quot;</span>))</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        {</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;            MultiFab::Copy(mf[lev],p_hse,0,mf_comp,1,0);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;            mf_comp += 1;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        }</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;dens_hse&quot;</span>))</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        {</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;            MultiFab::Copy(mf[lev],r_hse,0,mf_comp,1,0);</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;            mf_comp += 1;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        }</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;theta_hse&quot;</span>))</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        {</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;            MultiFab::Copy(mf[lev],th_hse,0,mf_comp,1,0);</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;            mf_comp += 1;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        }</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160; </div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;pressure&quot;</span>))</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        {</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa7be0d60ce3de3441d44082cc1b725ec">anelastic</a>[lev] == 1) {</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                MultiFab::Copy(mf[lev], p_hse, 0, mf_comp, 1, 0);</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                MultiFab::Copy(mf[lev], pressure, 0, mf_comp, 1, 0);</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;            }</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160; </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;            mf_comp += 1;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        } <span class="comment">// pressure</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160; </div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;pert_pres&quot;</span>))</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        {</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa7be0d60ce3de3441d44082cc1b725ec">anelastic</a>[lev] == 1) {</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                MultiFab::Copy(mf[lev], <a class="code" href="classERF.html#a0c5206542d4193bb687f5271be6fe5e5">pp_inc</a>[lev], 0, mf_comp, 1, 0);</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                MultiFab::Copy(mf[lev], pressure, 0, mf_comp, 1, 0);</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                MultiFab::Subtract(mf[lev],p_hse,0,mf_comp,1,IntVect{0});</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;            }</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;            mf_comp += 1;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        }</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160; </div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;pert_dens&quot;</span>))</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        {</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="preprocessor">#pragma omp parallel if (amrex::Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;            <span class="keywordflow">for</span> ( MFIter mfi(mf[lev],TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;            {</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                <span class="keyword">const</span> Array4&lt;Real&gt;&amp; derdat  = mf[lev].array(mfi);</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; S_arr = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].const_array(mfi);</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; r0_arr = r_hse.const_array(mfi);</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept {</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                    derdat(i, j, k, mf_comp) = S_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>) - r0_arr(i,j,k);</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                });</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;            }</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;            mf_comp ++;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        }</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160; </div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;eq_pot_temp&quot;</span>))</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        {</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="preprocessor">#pragma omp parallel if (amrex::Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;            <span class="keywordflow">for</span> ( MFIter mfi(mf[lev],TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;            {</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                <span class="keyword">const</span> Array4&lt;Real&gt;&amp; derdat  = mf[lev].array(mfi);</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; S_arr = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].const_array(mfi);</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; p_arr = pressure.const_array(mfi);</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">int</span> ncomp = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].nComp();</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept {</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                    Real <a class="code" href="namespaceMicVar__Kess.html#ad5e2303f8f4cbf19829306f4a72d61a7af099273d19f4b8cdca199c5177231e35">qv</a> = (use_moisture &amp;&amp; (ncomp &gt; <a class="code" href="ERF__IndexDefines_8H.html#aa965e9988f14d5d2a5aef4a942168a15">RhoQ1_comp</a>)) ? S_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#aa965e9988f14d5d2a5aef4a942168a15">RhoQ1_comp</a>)/S_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>) : 0.0;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                    Real <a class="code" href="namespaceMicVar__SatAdj.html#ac2be1e5fc951d23f27b621bed9836c16aea3777efcbbb3712ce373924287c2cb3">qc</a> = (use_moisture &amp;&amp; (ncomp &gt; <a class="code" href="ERF__IndexDefines_8H.html#a3bf0a4783e82ba30db2b7c0a332c2f16">RhoQ2_comp</a>)) ? S_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#a3bf0a4783e82ba30db2b7c0a332c2f16">RhoQ2_comp</a>)/S_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>) : 0.0;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                    Real <a class="code" href="namespaceRealBdyVars.html#a2827de2ca16290ba8c0d89dee276eccca8ecd2dbb16824e5c68db7daf2254fc79">T</a> = <a class="code" href="ERF__EOS_8H.html#a65cf1718b7a1fcc56cb16685642543da">getTgivenRandRTh</a>(S_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>), S_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>), <a class="code" href="namespaceMicVar__Kess.html#ad5e2303f8f4cbf19829306f4a72d61a7af099273d19f4b8cdca199c5177231e35">qv</a>);</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                    Real fac = <a class="code" href="ERF__Constants_8H.html#a1ee33e063343c8fb15ed025c456ebd46">Cp_d</a> + <a class="code" href="ERF__Constants_8H.html#acecae1da25fb8c8d32d1f175e18df41f">Cp_l</a>*(<a class="code" href="namespaceMicVar__Kess.html#ad5e2303f8f4cbf19829306f4a72d61a7af099273d19f4b8cdca199c5177231e35">qv</a> + <a class="code" href="namespaceMicVar__SatAdj.html#ac2be1e5fc951d23f27b621bed9836c16aea3777efcbbb3712ce373924287c2cb3">qc</a>);</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                    Real pv = <a class="code" href="ERF__MicrophysicsUtils_8H.html#a16a390366e7e68ca35fdac4cad824428">erf_esatw</a>(<a class="code" href="namespaceRealBdyVars.html#a2827de2ca16290ba8c0d89dee276eccca8ecd2dbb16824e5c68db7daf2254fc79">T</a>)*100.0;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160; </div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                    derdat(i, j, k, mf_comp) = <a class="code" href="namespaceRealBdyVars.html#a2827de2ca16290ba8c0d89dee276eccca8ecd2dbb16824e5c68db7daf2254fc79">T</a>*std::pow((p_arr(i,j,k) - pv)/<a class="code" href="ERF__Constants_8H.html#a994fea25f28c33c2e8f1e9c63d5b8b56">p_0</a>, -<a class="code" href="ERF__Constants_8H.html#aeb133d0ac46d639050313ce36187e870">R_d</a>/fac)*std::exp(<a class="code" href="ERF__Constants_8H.html#aee80ef06f62b6528b776d02de062cdd5">L_v</a>*<a class="code" href="namespaceMicVar__Kess.html#ad5e2303f8f4cbf19829306f4a72d61a7af099273d19f4b8cdca199c5177231e35">qv</a>/(fac*<a class="code" href="namespaceRealBdyVars.html#a2827de2ca16290ba8c0d89dee276eccca8ecd2dbb16824e5c68db7daf2254fc79">T</a>)) ;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                });</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;            }</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;            mf_comp ++;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        }</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160; </div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;terrain_IB_mask&quot;</span>))</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        {</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            MultiFab* terrain_blank = <a class="code" href="classERF.html#a4a18cc3befd0911ccb011f9bb3b2efc2">terrain_blanking</a>[lev].get();</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;            MultiFab::Copy(mf[lev],*terrain_blank,0,mf_comp,1,0);</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;            mf_comp ++;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        }</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160; </div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="preprocessor">#ifdef ERF_USE_WINDFARM</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;num_turb&quot;</span>) and</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;             (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac0a723e8797cdc0fe06b3fc781fca645">windfarm_type</a> == WindFarmType::Fitch or <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac0a723e8797cdc0fe06b3fc781fca645">windfarm_type</a> == WindFarmType::EWP or</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;              <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac0a723e8797cdc0fe06b3fc781fca645">windfarm_type</a> == WindFarmType::SimpleAD or <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac0a723e8797cdc0fe06b3fc781fca645">windfarm_type</a> == WindFarmType::GeneralAD) )</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        {</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;            MultiFab::Copy(mf[lev],Nturb[lev],0,mf_comp,1,0);</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;            mf_comp ++;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        }</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160; </div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;SMark0&quot;</span>) and</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;             (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac0a723e8797cdc0fe06b3fc781fca645">windfarm_type</a> == WindFarmType::Fitch or <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac0a723e8797cdc0fe06b3fc781fca645">windfarm_type</a> == WindFarmType::EWP or</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;              <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac0a723e8797cdc0fe06b3fc781fca645">windfarm_type</a> == WindFarmType::SimpleAD or <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac0a723e8797cdc0fe06b3fc781fca645">windfarm_type</a> == WindFarmType::GeneralAD) )</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        {</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;            MultiFab::Copy(mf[lev],SMark[lev],0,mf_comp,1,0);</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;            mf_comp ++;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        }</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160; </div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;SMark1&quot;</span>) and</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;           (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac0a723e8797cdc0fe06b3fc781fca645">windfarm_type</a> == WindFarmType::SimpleAD or <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ac0a723e8797cdc0fe06b3fc781fca645">windfarm_type</a> == WindFarmType::GeneralAD))</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        {</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;            MultiFab::Copy(mf[lev],SMark[lev],1,mf_comp,1,0);</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;            mf_comp ++;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        }</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160; </div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160; </div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        <span class="comment">// **********************************************************************************************</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        <span class="comment">// Allocate space if we are computing any pressure gradients</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        <span class="comment">// **********************************************************************************************</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160; </div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        Vector&lt;MultiFab&gt; gradp_temp;  gradp_temp.resize(AMREX_SPACEDIM);</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;dpdx&quot;</span>)       ||</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;            <a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;dpdy&quot;</span>)       ||</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;            <a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;dpdz&quot;</span>)       ||</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;            <a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;pres_hse_x&quot;</span>) ||</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;            <a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;pres_hse_y&quot;</span>))</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        {</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;            gradp_temp[<a class="code" href="namespaceGpVars.html#ac972418cf9113d552b162715dae54ebdaecfb8189072456062c3c29c137ec2323">GpVars::gpx</a>].define(convert(ba, IntVect(1,0,0)), dm, 1, 1); gradp_temp[<a class="code" href="namespaceGpVars.html#ac972418cf9113d552b162715dae54ebdaecfb8189072456062c3c29c137ec2323">GpVars::gpx</a>].setVal(0.);</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;            gradp_temp[<a class="code" href="namespaceGpVars.html#ac972418cf9113d552b162715dae54ebda8b32fb9218fd4f10ccc5736e6a61a72d">GpVars::gpy</a>].define(convert(ba, IntVect(0,1,0)), dm, 1, 1); gradp_temp[<a class="code" href="namespaceGpVars.html#ac972418cf9113d552b162715dae54ebda8b32fb9218fd4f10ccc5736e6a61a72d">GpVars::gpy</a>].setVal(0.);</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;            gradp_temp[<a class="code" href="namespaceGpVars.html#ac972418cf9113d552b162715dae54ebda7490c53ed57352abcd4a219cd12bf517">GpVars::gpz</a>].define(convert(ba, IntVect(0,0,1)), dm, 1, 1); gradp_temp[<a class="code" href="namespaceGpVars.html#ac972418cf9113d552b162715dae54ebda7490c53ed57352abcd4a219cd12bf517">GpVars::gpz</a>].setVal(0.);</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        }</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160; </div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        <span class="comment">// **********************************************************************************************</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        <span class="comment">// These are based on computing gradient of full pressure</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        <span class="comment">// **********************************************************************************************</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160; </div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa7be0d60ce3de3441d44082cc1b725ec">anelastic</a>[lev] == 0) {</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;            <span class="keywordflow">if</span> ( (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;dpdx&quot;</span>)) ||</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                 (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;dpdy&quot;</span>)) ||</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                 (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;dpdz&quot;</span>)) ) {</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                BCRec <span class="keyword">const</span>* bcrec_ptr = <a class="code" href="classERF.html#a8a99e22b1111c803e31b4afd5fcdea60">domain_bcs_type_d</a>.data();</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                <a class="code" href="ERF__MakeGradP_8cpp.html#a77a5a7eae63c5896960f8953a277cfe0">compute_gradp</a>(pressure, geom[lev], *<a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev].get(), *<a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[lev].get(), bcrec_ptr, <a class="code" href="classERF.html#a2ae1074c3047ab0eb8286f73f5d4be0e">get_eb</a>(lev), gradp_temp, <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>);</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;            }</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        }</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160; </div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;dpdx&quot;</span>))</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;        {</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;            <span class="keywordflow">for</span> ( MFIter mfi(mf[lev],TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;            {</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                <span class="keyword">const</span> Array4&lt;Real      &gt;&amp;   derdat  = mf[lev].array(mfi);</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp;   gpx_arr = (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa7be0d60ce3de3441d44082cc1b725ec">anelastic</a>[lev] == 1) ?</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                      <a class="code" href="classERF.html#a29ce17220e488eb840abc53966c34d46">gradp</a>[lev][<a class="code" href="namespaceGpVars.html#ac972418cf9113d552b162715dae54ebdaecfb8189072456062c3c29c137ec2323">GpVars::gpx</a>].array(mfi) : gradp_temp[<a class="code" href="namespaceGpVars.html#ac972418cf9113d552b162715dae54ebdaecfb8189072456062c3c29c137ec2323">GpVars::gpx</a>].array(mfi);</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; mf_mx_arr = <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85bac2a428daaf1a1b398630fa8cec7f115b">MapFacType::m_x</a>]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept {</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                    derdat(i ,j ,k, mf_comp) = 0.5 * (gpx_arr(i+1,j,k) + gpx_arr(i,j,k)) * mf_mx_arr(i,j,0);</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                });</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;            }</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;            mf_comp ++;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        } <span class="comment">// dpdx</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;dpdy&quot;</span>))</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        {</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;            <span class="keywordflow">for</span> ( MFIter mfi(mf[lev],TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;            {</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                <span class="keyword">const</span> Array4&lt;Real      &gt;&amp;   derdat  = mf[lev].array(mfi);</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp;   gpy_arr = (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa7be0d60ce3de3441d44082cc1b725ec">anelastic</a>[lev] == 1) ?</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                      <a class="code" href="classERF.html#a29ce17220e488eb840abc53966c34d46">gradp</a>[lev][<a class="code" href="namespaceGpVars.html#ac972418cf9113d552b162715dae54ebda8b32fb9218fd4f10ccc5736e6a61a72d">GpVars::gpy</a>].array(mfi) : gradp_temp[<a class="code" href="namespaceGpVars.html#ac972418cf9113d552b162715dae54ebda8b32fb9218fd4f10ccc5736e6a61a72d">GpVars::gpy</a>].array(mfi);</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; mf_my_arr = <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85ba9612b6816e2fb7dc3ad56d6bc1fb7df8">MapFacType::m_y</a>]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept {</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                    derdat(i ,j ,k, mf_comp) = 0.5 * (gpy_arr(i,j+1,k) + gpy_arr(i,j,k)) * mf_my_arr(i,j,0);</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                });</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;            }</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;            mf_comp ++;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        } <span class="comment">// dpdy</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;dpdz&quot;</span>))</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        {</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;            <span class="keywordflow">for</span> ( MFIter mfi(mf[lev],TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;            {</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                <span class="keyword">const</span> Array4&lt;Real      &gt;&amp;  derdat  = mf[lev].array(mfi);</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp;  gpz_arr = (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aa7be0d60ce3de3441d44082cc1b725ec">anelastic</a>[lev] == 1) ?</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                      <a class="code" href="classERF.html#a29ce17220e488eb840abc53966c34d46">gradp</a>[lev][<a class="code" href="namespaceGpVars.html#ac972418cf9113d552b162715dae54ebda7490c53ed57352abcd4a219cd12bf517">GpVars::gpz</a>].array(mfi) : gradp_temp[<a class="code" href="namespaceGpVars.html#ac972418cf9113d552b162715dae54ebda7490c53ed57352abcd4a219cd12bf517">GpVars::gpz</a>].array(mfi);</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept {</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                    derdat(i ,j ,k, mf_comp) = 0.5 * (gpz_arr(i,j,k+1) + gpz_arr(i,j,k));</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                });</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;            }</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;            mf_comp ++;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        } <span class="comment">// dpdz</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160; </div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        <span class="comment">// **********************************************************************************************</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        <span class="comment">// These are based on computing gradient of basestate pressure</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        <span class="comment">// **********************************************************************************************</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160; </div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        <span class="keywordflow">if</span> ( (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;pres_hse_x&quot;</span>)) ||</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;             (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;pres_hse_y&quot;</span>)) ) {</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;            BCRec <span class="keyword">const</span>* bcrec_ptr = <a class="code" href="classERF.html#a8a99e22b1111c803e31b4afd5fcdea60">domain_bcs_type_d</a>.data();</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;            <a class="code" href="ERF__MakeGradP_8cpp.html#a77a5a7eae63c5896960f8953a277cfe0">compute_gradp</a>(p_hse, geom[lev], *<a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev].get(), *<a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[lev].get(), bcrec_ptr, <a class="code" href="classERF.html#a2ae1074c3047ab0eb8286f73f5d4be0e">get_eb</a>(lev), gradp_temp, <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>);</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        }</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160; </div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;pres_hse_x&quot;</span>))</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        {</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;            <span class="keywordflow">for</span> ( MFIter mfi(mf[lev],TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;            {</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                <span class="keyword">const</span> Array4&lt;Real      &gt;&amp;  derdat  = mf[lev].array(mfi);</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp;  gpx_arr = gradp_temp[0].array(mfi);</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; mf_mx_arr = <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85bac2a428daaf1a1b398630fa8cec7f115b">MapFacType::m_x</a>]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept {</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                    derdat(i ,j ,k, mf_comp) = 0.5 * (gpx_arr(i+1,j,k) + gpx_arr(i,j,k)) * mf_mx_arr(i,j,0);</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                });</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;            }</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;            mf_comp += 1;</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        } <span class="comment">// pres_hse_x</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160; </div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;pres_hse_y&quot;</span>))</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        {</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;            <span class="keywordflow">for</span> ( MFIter mfi(mf[lev],TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;            {</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                <span class="keyword">const</span> Array4&lt;Real      &gt;&amp;  derdat  = mf[lev].array(mfi);</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp;  gpy_arr = gradp_temp[1].array(mfi);</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; mf_my_arr = <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85ba9612b6816e2fb7dc3ad56d6bc1fb7df8">MapFacType::m_y</a>]-&gt;const_array(mfi);</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept {</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                    derdat(i ,j ,k, mf_comp) = 0.5 * (gpy_arr(i,j+1,k) + gpy_arr(i,j,k)) * mf_my_arr(i,j,0);</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                });</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;            }</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;            mf_comp += 1;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;        } <span class="comment">// pres_hse_y</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160; </div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;        <span class="comment">// **********************************************************************************************</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;        <span class="comment">// Metric terms</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        <span class="comment">// **********************************************************************************************</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160; </div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structSolverChoice.html#a1952672901901b0b3a628f2298dc72c2">SolverChoice::mesh_type</a> != MeshType::ConstantDz) {</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;z_phys&quot;</span>))</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;            {</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                MultiFab::Copy(mf[lev],*<a class="code" href="classERF.html#a31be0f1ae705c52c8ccc520369013284">z_phys_cc</a>[lev],0,mf_comp,1,0);</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                mf_comp ++;</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;            }</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160; </div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;detJ&quot;</span>))</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;            {</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                MultiFab::Copy(mf[lev],*<a class="code" href="classERF.html#a30f8b851ed29d38695d44cff257f14e6">detJ_cc</a>[lev],0,mf_comp,1,0);</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                mf_comp ++;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;            }</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;        } <span class="comment">// use_terrain</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160; </div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;mapfac&quot;</span>)) {</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="preprocessor">#pragma omp parallel if (amrex::Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;            <span class="keywordflow">for</span> ( MFIter mfi(mf[lev],TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;            {</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                <span class="keyword">const</span> Array4&lt;Real&gt;&amp; derdat = mf[lev].array(mfi);</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                <span class="keyword">const</span> Array4&lt;Real&gt;&amp; mf_m   = <a class="code" href="classERF.html#a07e1772db360d39195824a6237bca9aa">mapfac</a>[lev][<a class="code" href="ERF__DataStruct_8H.html#a61bff79effb7ee8f045654684246b85bac2a428daaf1a1b398630fa8cec7f115b">MapFacType::m_x</a>]-&gt;array(mfi);</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept {</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                   derdat(i ,j ,k, mf_comp) = mf_m(i,j,0);</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                });</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;            }</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;            mf_comp ++;</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;        }</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160; </div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="preprocessor">#ifdef ERF_USE_NETCDF</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ad57b63939b19e90b87dd61d3f293b0d7">use_real_bcs</a>) {</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;lat_m&quot;</span>)) {</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="preprocessor">#pragma omp parallel if (amrex::Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                <span class="keywordflow">for</span> ( MFIter mfi(mf[lev],TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                {</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                    <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                    <span class="keyword">const</span> Array4&lt;Real&gt;&amp; derdat = mf[lev].array(mfi);</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                    <span class="keyword">const</span> Array4&lt;Real&gt;&amp; data   = lat_m[lev]-&gt;array(mfi);</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                    ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept {</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                       derdat(i, j, k, mf_comp) = data(i,j,0);</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                    });</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                }</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                mf_comp ++;</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;            } <span class="comment">// lat_m</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160; </div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;lon_m&quot;</span>)) {</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;<span class="preprocessor">#pragma omp parallel if (amrex::Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                <span class="keywordflow">for</span> ( MFIter mfi(mf[lev],TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                {</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                    <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                    <span class="keyword">const</span> Array4&lt;Real&gt;&amp; derdat = mf[lev].array(mfi);</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                    <span class="keyword">const</span> Array4&lt;Real&gt;&amp; data   = lon_m[lev]-&gt;array(mfi);</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                    ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept {</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                       derdat(i, j, k, mf_comp) = data(i,j,0);</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                    });</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                }</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                mf_comp ++;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;            } <span class="comment">// lon_m</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        } <span class="comment">// use_real_bcs</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160; </div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160; </div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#af3119a4089367206db9fc3a17664e874">time_avg_vel</a>) {</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;u_t_avg&quot;</span>)) {</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="preprocessor">#pragma omp parallel if (amrex::Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                <span class="keywordflow">for</span> ( MFIter mfi(mf[lev],TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                {</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                    <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                    <span class="keyword">const</span> Array4&lt;Real&gt;&amp; derdat = mf[lev].array(mfi);</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                    <span class="keyword">const</span> Array4&lt;Real&gt;&amp; data   = <a class="code" href="classERF.html#a3e146164ca6929ec6d4984b6a3f43c81">vel_t_avg</a>[lev]-&gt;array(mfi);</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                    <span class="keyword">const</span> Real norm = <a class="code" href="classERF.html#a6837423e9248e923fcaa1987b59d8160">t_avg_cnt</a>[lev];</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                    ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                    {</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                        derdat(i ,j ,k, mf_comp) = data(i,j,k,0) / norm;</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                    });</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                }</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                mf_comp ++;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;            }</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160; </div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;v_t_avg&quot;</span>)) {</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<span class="preprocessor">#pragma omp parallel if (amrex::Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                <span class="keywordflow">for</span> ( MFIter mfi(mf[lev],TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                {</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                    <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                    <span class="keyword">const</span> Array4&lt;Real&gt;&amp; derdat = mf[lev].array(mfi);</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;                    <span class="keyword">const</span> Array4&lt;Real&gt;&amp; data   = <a class="code" href="classERF.html#a3e146164ca6929ec6d4984b6a3f43c81">vel_t_avg</a>[lev]-&gt;array(mfi);</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;                    <span class="keyword">const</span> Real norm = <a class="code" href="classERF.html#a6837423e9248e923fcaa1987b59d8160">t_avg_cnt</a>[lev];</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                    ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;                    {</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                        derdat(i ,j ,k, mf_comp) = data(i,j,k,1) / norm;</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                    });</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;                }</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                mf_comp ++;</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;            }</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160; </div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;w_t_avg&quot;</span>)) {</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;<span class="preprocessor">#pragma omp parallel if (amrex::Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                <span class="keywordflow">for</span> ( MFIter mfi(mf[lev],TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                {</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                    <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                    <span class="keyword">const</span> Array4&lt;Real&gt;&amp; derdat = mf[lev].array(mfi);</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                    <span class="keyword">const</span> Array4&lt;Real&gt;&amp; data   = <a class="code" href="classERF.html#a3e146164ca6929ec6d4984b6a3f43c81">vel_t_avg</a>[lev]-&gt;array(mfi);</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                    <span class="keyword">const</span> Real norm = <a class="code" href="classERF.html#a6837423e9248e923fcaa1987b59d8160">t_avg_cnt</a>[lev];</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                    ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                    {</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                        derdat(i ,j ,k, mf_comp) = data(i,j,k,2) / norm;</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                    });</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;                }</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;                mf_comp ++;</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;            }</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160; </div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;umag_t_avg&quot;</span>)) {</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="preprocessor">#pragma omp parallel if (amrex::Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                <span class="keywordflow">for</span> ( MFIter mfi(mf[lev],TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;                {</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                    <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                    <span class="keyword">const</span> Array4&lt;Real&gt;&amp; derdat = mf[lev].array(mfi);</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                    <span class="keyword">const</span> Array4&lt;Real&gt;&amp; data   = <a class="code" href="classERF.html#a3e146164ca6929ec6d4984b6a3f43c81">vel_t_avg</a>[lev]-&gt;array(mfi);</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                    <span class="keyword">const</span> Real norm = <a class="code" href="classERF.html#a6837423e9248e923fcaa1987b59d8160">t_avg_cnt</a>[lev];</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                    ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                    {</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                        derdat(i ,j ,k, mf_comp) = data(i,j,k,3) / norm;</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                    });</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                }</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                mf_comp ++;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;            }</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;        }</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160; </div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;nut&quot;</span>)) {</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;            MultiFab dmf(mf[lev], make_alias, mf_comp, 1);</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;            MultiFab cmf(<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], make_alias, 0, 1); <span class="comment">// to provide rho only</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="preprocessor">#pragma omp parallel if (amrex::Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;            <span class="keywordflow">for</span> (MFIter mfi(dmf, TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;            {</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;                <span class="keyword">auto</span>       prim = dmf[mfi].array();</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                <span class="keyword">auto</span> <span class="keyword">const</span> <a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">cons</a> = cmf[mfi].const_array();</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;                <span class="keyword">auto</span> <span class="keyword">const</span> diff = (*<a class="code" href="classERF.html#a327d704704abd516be19339cb2d226f9">eddyDiffs_lev</a>[lev])[mfi].const_array();</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;                ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;                {</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                    <span class="keyword">const</span> Real <a class="code" href="namespaceMicVar__Kess.html#ad5e2303f8f4cbf19829306f4a72d61a7a89de8c3bfc941080efb960e5119fbd61">rho</a> = <a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">cons</a>(i, j, k, <a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>);</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                    <span class="keyword">const</span> Real Kmv = diff(i, j, k, <a class="code" href="namespaceEddyDiff.html#a3f912b3dbcd18dd6f4f0a85815a3ce47a61ed124b350a1b26da1bd26aebfa5f82">EddyDiff::Mom_v</a>);</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;                    prim(i,j,k) = Kmv / <a class="code" href="namespaceMicVar__Kess.html#ad5e2303f8f4cbf19829306f4a72d61a7a89de8c3bfc941080efb960e5119fbd61">rho</a>;</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                });</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;            }</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160; </div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;            mf_comp++;</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        }</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160; </div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;Kmv&quot;</span>)) {</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;            MultiFab::Copy(mf[lev],*<a class="code" href="classERF.html#a327d704704abd516be19339cb2d226f9">eddyDiffs_lev</a>[lev],<a class="code" href="namespaceEddyDiff.html#a3f912b3dbcd18dd6f4f0a85815a3ce47a61ed124b350a1b26da1bd26aebfa5f82">EddyDiff::Mom_v</a>,mf_comp,1,0);</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;            mf_comp ++;</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        }</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;Kmh&quot;</span>)) {</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;            MultiFab::Copy(mf[lev],*<a class="code" href="classERF.html#a327d704704abd516be19339cb2d226f9">eddyDiffs_lev</a>[lev],<a class="code" href="namespaceEddyDiff.html#a3f912b3dbcd18dd6f4f0a85815a3ce47a2e96e6d5e84e7d7b9857e73159dfbe2b">EddyDiff::Mom_h</a>,mf_comp,1,0);</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;            mf_comp ++;</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        }</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;Khv&quot;</span>)) {</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;            MultiFab::Copy(mf[lev],*<a class="code" href="classERF.html#a327d704704abd516be19339cb2d226f9">eddyDiffs_lev</a>[lev],<a class="code" href="namespaceEddyDiff.html#a3f912b3dbcd18dd6f4f0a85815a3ce47a0af64d676c5c6f4312eb892f9a7a46cd">EddyDiff::Theta_v</a>,mf_comp,1,0);</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;            mf_comp ++;</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        }</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;Khh&quot;</span>)) {</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;            MultiFab::Copy(mf[lev],*<a class="code" href="classERF.html#a327d704704abd516be19339cb2d226f9">eddyDiffs_lev</a>[lev],<a class="code" href="namespaceEddyDiff.html#a3f912b3dbcd18dd6f4f0a85815a3ce47ad0cfc6c50b43867895cbc2c02eb2b99a">EddyDiff::Theta_h</a>,mf_comp,1,0);</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;            mf_comp ++;</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;        }</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;Lturb&quot;</span>)) {</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;            MultiFab::Copy(mf[lev],*<a class="code" href="classERF.html#a327d704704abd516be19339cb2d226f9">eddyDiffs_lev</a>[lev],<a class="code" href="namespaceEddyDiff.html#a3f912b3dbcd18dd6f4f0a85815a3ce47a1fd996857fe3699ac7f9454e88d6ae76">EddyDiff::Turb_lengthscale</a>,mf_comp,1,0);</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;            mf_comp ++;</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;        }</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;walldist&quot;</span>)) {</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;            MultiFab::Copy(mf[lev],*<a class="code" href="classERF.html#a0276b556fdefec8b99be95846a3a35fe">walldist</a>[lev],0,mf_comp,1,0);</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;            mf_comp ++;</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;        }</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;diss&quot;</span>)) {</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;            MultiFab::Copy(mf[lev],*<a class="code" href="classERF.html#a6e1ad417e3bd062468d74830b65911fb">SFS_diss_lev</a>[lev],0,mf_comp,1,0);</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;            mf_comp ++;</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;        }</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160; </div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;        <span class="comment">// TODO: The size of the q variables can vary with different</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;        <span class="comment">//       moisture models. Therefore, certain components may</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;        <span class="comment">//       reside at different indices. For example, Kessler is</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;        <span class="comment">//       warm but precipitating. This puts qp at index 3.</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;        <span class="comment">//       However, SAM is cold and precipitating so qp is index 4.</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;        <span class="comment">//       Need to built an external enum struct or a better pathway.</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160; </div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;        <span class="comment">// NOTE: Protect against accessing non-existent data</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;        <span class="keywordflow">if</span> (use_moisture) {</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;            <span class="keywordtype">int</span> n_qstate_moist   = <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;Get_Qstate_Moist_Size();</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160; </div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;            <span class="comment">// Moist density</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;moist_density&quot;</span>))</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;            {</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                <span class="keywordtype">int</span> n_start = <a class="code" href="ERF__IndexDefines_8H.html#aa965e9988f14d5d2a5aef4a942168a15">RhoQ1_comp</a>; <span class="comment">// qv</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;                <span class="keywordtype">int</span> n_end   = <a class="code" href="ERF__IndexDefines_8H.html#a3bf0a4783e82ba30db2b7c0a332c2f16">RhoQ2_comp</a>; <span class="comment">// qc</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                <span class="keywordflow">if</span> (n_qstate_moist &gt; 3) n_end = <a class="code" href="ERF__IndexDefines_8H.html#a49fe20d81f4d923a4a6ec4eb1652072b">RhoQ3_comp</a>; <span class="comment">// qi</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                MultiFab::Copy(  mf[lev], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], <a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>, mf_comp, 1, 0);</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n_comp(n_start); n_comp &lt;= n_end; ++n_comp) {</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;                    MultiFab::Add(mf[lev], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], n_comp, mf_comp, 1, 0);</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;                }</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                mf_comp += 1;</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;            }</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160; </div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;qv&quot;</span>) &amp;&amp; (n_qstate_moist &gt;= 1))</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;            {</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;                MultiFab::Copy(  mf[lev], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], <a class="code" href="ERF__IndexDefines_8H.html#aa965e9988f14d5d2a5aef4a942168a15">RhoQ1_comp</a>, mf_comp, 1, 0);</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                MultiFab::Divide(mf[lev], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], <a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>  , mf_comp, 1, 0);</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                mf_comp += 1;</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;            }</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160; </div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;qc&quot;</span>) &amp;&amp; (n_qstate_moist &gt;= 2))</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;            {</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;                MultiFab::Copy(  mf[lev], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], <a class="code" href="ERF__IndexDefines_8H.html#a3bf0a4783e82ba30db2b7c0a332c2f16">RhoQ2_comp</a>, mf_comp, 1, 0);</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;                MultiFab::Divide(mf[lev], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], <a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>  , mf_comp, 1, 0);</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;                mf_comp += 1;</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;            }</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160; </div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;qi&quot;</span>) &amp;&amp; (n_qstate_moist &gt;= 4))</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;            {</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;                MultiFab::Copy(  mf[lev], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], <a class="code" href="ERF__IndexDefines_8H.html#a49fe20d81f4d923a4a6ec4eb1652072b">RhoQ3_comp</a>, mf_comp, 1, 0);</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                MultiFab::Divide(mf[lev], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], <a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>  , mf_comp, 1, 0);</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                mf_comp += 1;</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;            }</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160; </div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;qrain&quot;</span>) &amp;&amp; (n_qstate_moist &gt;= 3))</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;            {</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;                <span class="keywordtype">int</span> n_start = (n_qstate_moist &gt; 3) ? <a class="code" href="ERF__IndexDefines_8H.html#a28c5deab9008c0999c26affeff2fa6da">RhoQ4_comp</a> : <a class="code" href="ERF__IndexDefines_8H.html#a49fe20d81f4d923a4a6ec4eb1652072b">RhoQ3_comp</a>;</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                MultiFab::Copy(  mf[lev], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], n_start , mf_comp, 1, 0);</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                MultiFab::Divide(mf[lev], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], <a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>, mf_comp, 1, 0);</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;                mf_comp += 1;</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;            }</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160; </div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;qsnow&quot;</span>) &amp;&amp; (n_qstate_moist &gt;= 5))</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;            {</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;                MultiFab::Copy(  mf[lev], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], <a class="code" href="ERF__IndexDefines_8H.html#ac46d015fd5b1ee0060bbaf22e79113e7">RhoQ5_comp</a>, mf_comp, 1, 0);</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;                MultiFab::Divide(mf[lev], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],   <a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>, mf_comp, 1, 0);</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;                mf_comp += 1;</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;            }</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160; </div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;qgraup&quot;</span>) &amp;&amp; (n_qstate_moist &gt;= 6))</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;            {</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;                MultiFab::Copy(  mf[lev], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], <a class="code" href="ERF__IndexDefines_8H.html#aae057dae5f599b944184a0ecf7801064">RhoQ6_comp</a>, mf_comp, 1, 0);</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;                MultiFab::Divide(mf[lev], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>],   <a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>, mf_comp, 1, 0);</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;                mf_comp += 1;</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;            }</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160; </div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;            <span class="comment">// Precipitating + non-precipitating components</span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;            <span class="comment">//--------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;qt&quot;</span>))</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;            {</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;                <span class="keywordtype">int</span> n_start = <a class="code" href="ERF__IndexDefines_8H.html#aa965e9988f14d5d2a5aef4a942168a15">RhoQ1_comp</a>; <span class="comment">// qv</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;                <span class="keywordtype">int</span> n_end   = n_start + n_qstate_moist;</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                MultiFab::Copy(mf[lev], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], n_start, mf_comp, 1, 0);</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n_comp(n_start+1); n_comp &lt; n_end; ++n_comp) {</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;                    MultiFab::Add(mf[lev], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], n_comp, mf_comp, 1, 0);</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;                }</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;                MultiFab::Divide(mf[lev], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], <a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>  , mf_comp, 1, 0);</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                mf_comp += 1;</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;            }</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160; </div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;            <span class="comment">// Non-precipitating components</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;            <span class="comment">//--------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;qn&quot;</span>))</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;            {</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;                <span class="keywordtype">int</span> n_start = <a class="code" href="ERF__IndexDefines_8H.html#aa965e9988f14d5d2a5aef4a942168a15">RhoQ1_comp</a>; <span class="comment">// qv</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;                <span class="keywordtype">int</span> n_end   = <a class="code" href="ERF__IndexDefines_8H.html#a3bf0a4783e82ba30db2b7c0a332c2f16">RhoQ2_comp</a>; <span class="comment">// qc</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;                <span class="keywordflow">if</span> (n_qstate_moist &gt; 3) n_end = <a class="code" href="ERF__IndexDefines_8H.html#a49fe20d81f4d923a4a6ec4eb1652072b">RhoQ3_comp</a>; <span class="comment">// qi</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;                MultiFab::Copy(  mf[lev], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], n_start, mf_comp, 1, 0);</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n_comp(n_start+1); n_comp &lt;= n_end; ++n_comp) {</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;                    MultiFab::Add(mf[lev], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], n_comp, mf_comp, 1, 0);</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;                }</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;                MultiFab::Divide(mf[lev], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], <a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>  , mf_comp, 1, 0);</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;                mf_comp += 1;</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;            }</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160; </div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;            <span class="comment">// Precipitating components</span></div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;            <span class="comment">//--------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;qp&quot;</span>) &amp;&amp; (n_qstate_moist &gt;= 3))</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;            {</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;                <span class="keywordtype">int</span> n_start = (n_qstate_moist &gt; 3) ? <a class="code" href="ERF__IndexDefines_8H.html#a28c5deab9008c0999c26affeff2fa6da">RhoQ4_comp</a> : <a class="code" href="ERF__IndexDefines_8H.html#a49fe20d81f4d923a4a6ec4eb1652072b">RhoQ3_comp</a>;</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                <span class="keywordtype">int</span> n_end   = ncomp_cons - 1;</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                MultiFab::Copy(  mf[lev], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], n_start, mf_comp, 1, 0);</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n_comp(n_start+1); n_comp &lt;= n_end; ++n_comp) {</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                    MultiFab::Add(  mf[lev], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], n_comp, mf_comp, 1, 0);</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                }</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;                MultiFab::Divide(mf[lev], <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>], <a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>  , mf_comp, 1, 0);</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                mf_comp += 1;</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;            }</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160; </div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;qsat&quot;</span>))</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;            {</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="preprocessor">#pragma omp parallel if (amrex::Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                <span class="keywordflow">for</span> ( MFIter mfi(mf[lev],TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;                {</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;                    <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;                    <span class="keyword">const</span> Array4&lt;Real&gt;&amp; derdat  = mf[lev].array(mfi);</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;                    <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; p_arr = pressure.array(mfi);</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;                    <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; S_arr = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].const_array(mfi);</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;                    ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;                    {</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;                        Real <a class="code" href="namespaceMicVar__Kess.html#ad5e2303f8f4cbf19829306f4a72d61a7af099273d19f4b8cdca199c5177231e35">qv</a> = S_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#aa965e9988f14d5d2a5aef4a942168a15">RhoQ1_comp</a>) / S_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>);</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;                        Real <a class="code" href="namespaceRealBdyVars.html#a2827de2ca16290ba8c0d89dee276eccca8ecd2dbb16824e5c68db7daf2254fc79">T</a>  = <a class="code" href="ERF__EOS_8H.html#a65cf1718b7a1fcc56cb16685642543da">getTgivenRandRTh</a>(S_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#a27dcc910aeb002a0fd44727954dc0e49">Rho_comp</a>), S_arr(i,j,k,<a class="code" href="ERF__IndexDefines_8H.html#a28f96fd04e1ff08fa7a8f53ccde0f877">RhoTheta_comp</a>), <a class="code" href="namespaceMicVar__Kess.html#ad5e2303f8f4cbf19829306f4a72d61a7af099273d19f4b8cdca199c5177231e35">qv</a>);</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;                        Real p  = p_arr(i,j,k) * Real(0.01);</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;                        <a class="code" href="ERF__MicrophysicsUtils_8H.html#a8e4b0c6ed8b95c2040dc0c9e8fcb8615">erf_qsatw</a>(<a class="code" href="namespaceRealBdyVars.html#a2827de2ca16290ba8c0d89dee276eccca8ecd2dbb16824e5c68db7daf2254fc79">T</a>, p, derdat(i,j,k,mf_comp));</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;                    });</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;                }</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;                mf_comp ++;</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;            }</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160; </div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;            <span class="keywordflow">if</span> ( (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> == MoistureType::Kessler) ||</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;                 (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> == MoistureType::Morrison_NoIce) ||</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;                 (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> == MoistureType::SAM_NoIce) )</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;            {</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;                <span class="keywordtype">int</span> <a class="code" href="ERF__ReadBndryPlanes_8cpp.html#a63d3125f6fd361f61d697799f46da817">offset</a> = (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> == MoistureType::Morrison_NoIce) ? 5 : 0;</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;rain_accum&quot;</span>))</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;                {</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;                    MultiFab::Copy(mf[lev],*(<a class="code" href="classERF.html#ae00126a9c2738bf6a6cbbe77321c9cfc">qmoist</a>[lev][<a class="code" href="ERF__ReadBndryPlanes_8cpp.html#a63d3125f6fd361f61d697799f46da817">offset</a>]),0,mf_comp,1,0);</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;                    mf_comp += 1;</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;                }</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;            }</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> == MoistureType::SAM) ||</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;                      (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> == MoistureType::Morrison) )</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;            {</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                <span class="keywordtype">int</span> <a class="code" href="ERF__ReadBndryPlanes_8cpp.html#a63d3125f6fd361f61d697799f46da817">offset</a> = (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#aacbfbe6f4a3040db3efdc6dbf8fa291b">moisture_type</a> == MoistureType::Morrison) ? 5 : 0;</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;rain_accum&quot;</span>))</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;                {</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;                    MultiFab::Copy(mf[lev],*(<a class="code" href="classERF.html#ae00126a9c2738bf6a6cbbe77321c9cfc">qmoist</a>[lev][<a class="code" href="ERF__ReadBndryPlanes_8cpp.html#a63d3125f6fd361f61d697799f46da817">offset</a>]),0,mf_comp,1,0);</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;                    mf_comp += 1;</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;                }</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;snow_accum&quot;</span>))</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                {</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;                    MultiFab::Copy(mf[lev],*(<a class="code" href="classERF.html#ae00126a9c2738bf6a6cbbe77321c9cfc">qmoist</a>[lev][<a class="code" href="ERF__ReadBndryPlanes_8cpp.html#a63d3125f6fd361f61d697799f46da817">offset</a>+1]),0,mf_comp,1,0);</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;                    mf_comp += 1;</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;                }</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;graup_accum&quot;</span>))</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;                {</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;                    MultiFab::Copy(mf[lev],*(<a class="code" href="classERF.html#ae00126a9c2738bf6a6cbbe77321c9cfc">qmoist</a>[lev][<a class="code" href="ERF__ReadBndryPlanes_8cpp.html#a63d3125f6fd361f61d697799f46da817">offset</a>+2]),0,mf_comp,1,0);</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;                    mf_comp += 1;</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;                }</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;            }</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;        } <span class="comment">// use_moisture</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160; </div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;<span class="preprocessor">#ifdef ERF_USE_PARTICLES</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span>&amp; particles_namelist( particleData.getNames() );</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;        <span class="keywordflow">for</span> (ParticlesNamesVector::size_type i = 0; i &lt; particles_namelist.size(); i++) {</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, std::string(particles_namelist[i]+<span class="stringliteral">&quot;_count&quot;</span>))) {</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;                MultiFab temp_dat(mf[lev].boxArray(), mf[lev].DistributionMap(), 1, 0);</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;                temp_dat.setVal(0);</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;                particleData[particles_namelist[i]]-&gt;Increment(temp_dat, lev);</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;                MultiFab::Copy(mf[lev], temp_dat, 0, mf_comp, 1, 0);</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;                mf_comp += 1;</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;            }</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;        }</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160; </div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;        Vector&lt;std::string&gt; particle_mesh_plot_names(0);</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;        particleData.GetMeshPlotVarNames( particle_mesh_plot_names );</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; particle_mesh_plot_names.size(); i++) {</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;            std::string plot_var_name(particle_mesh_plot_names[i]);</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, plot_var_name) ) {</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;                MultiFab temp_dat(mf[lev].boxArray(), mf[lev].DistributionMap(), 1, 1);</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;                temp_dat.setVal(0);</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;                particleData.GetMeshPlotVar(plot_var_name, temp_dat, lev);</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;                MultiFab::Copy(mf[lev], temp_dat, 0, mf_comp, 1, 0);</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;                mf_comp += 1;</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;            }</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;        }</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160; </div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;        {</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;            Vector&lt;std::string&gt; microphysics_plot_names;</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;            <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;GetPlotVarNames(microphysics_plot_names);</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; plot_name : microphysics_plot_names) {</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, plot_name)) {</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;                    MultiFab temp_dat(mf[lev].boxArray(), mf[lev].DistributionMap(), 1, 1);</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;                    temp_dat.setVal(0);</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;                    <a class="code" href="classERF.html#a4b7277d54649219f31fe286eee9d415a">micro</a>-&gt;GetPlotVar(plot_name, temp_dat, lev);</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;                    MultiFab::Copy(mf[lev], temp_dat, 0, mf_comp, 1, 0);</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;                    mf_comp += 1;</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;                }</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;            }</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;        }</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160; </div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;volfrac&quot;</span>)) {</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;            <span class="keywordflow">if</span> ( <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> == TerrainType::EB ||</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;                 <a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> == TerrainType::ImmersedForcing)</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;            {</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;                MultiFab::Copy(mf[lev], <a class="code" href="classERF.html#ad024dd413ab20e5d6f69c1f96e5b78a3">EBFactory</a>(lev).getVolFrac(), 0, mf_comp, 1, 0);</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;                mf[lev].setVal(1.0, mf_comp, 1, 0);</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;            }</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;            mf_comp += 1;</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;        }</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160; </div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;<span class="preprocessor">#ifdef ERF_COMPUTE_ERROR</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;        <span class="comment">// Next, check for error in velocities and if desired, output them -- note we output none or all, not just some</span></div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;xvel_err&quot;</span>) ||</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;            <a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;yvel_err&quot;</span>) ||</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;            <a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;zvel_err&quot;</span>))</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;        {</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;            <span class="comment">// Moving terrain ANALYTICAL</span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;            Real H           = geom[lev].ProbHi()[2];</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;            Real Ampl        = 0.16;</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;            Real wavelength  = 100.;</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;            Real kp          = 2. * <a class="code" href="ERF__Constants_8H.html#a988c4efd6fd0d855e241e77a73191428">PI</a> / wavelength;</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;            Real <a class="code" href="namespacemodule__model__constants.html#a1f0c74f0fd17b1b38de53299cadb3fdf">g</a>           = <a class="code" href="ERF__Constants_8H.html#ac2d0c304ab1117368778efcda612de43">CONST_GRAV</a>;</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;            Real <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa93264ee6dc9b23e994674a68250a2f16">omega</a>       = std::sqrt(<a class="code" href="namespacemodule__model__constants.html#a1f0c74f0fd17b1b38de53299cadb3fdf">g</a> * kp);</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;            Real omega_t     = <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa93264ee6dc9b23e994674a68250a2f16">omega</a> * <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev];</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160; </div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;            <span class="keyword">const</span> <span class="keyword">auto</span> dx = geom[lev].CellSizeArray();</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160; </div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;<span class="preprocessor">#pragma omp parallel if (amrex::Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;            <span class="keywordflow">for</span> (MFIter mfi(mf[lev], TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;            {</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.validbox();</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;                Box <a class="code" href="ERF__DiffSetup_8H.html#a853a144267414a8a59c87f80ca5c958c">xbx</a>(bx); <a class="code" href="ERF__DiffSetup_8H.html#a853a144267414a8a59c87f80ca5c958c">xbx</a>.surroundingNodes(0);</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;                <span class="keyword">const</span> Array4&lt;Real&gt; xvel_arr = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].array(mfi);</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;                <span class="keyword">const</span> Array4&lt;Real&gt; zvel_arr = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].array(mfi);</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160; </div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; z_nd = <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160; </div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;                ParallelFor(<a class="code" href="ERF__DiffSetup_8H.html#a853a144267414a8a59c87f80ca5c958c">xbx</a>, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;                {</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;                    Real <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01a9dd4e461268c8034f5c8564e155c67a6">x</a> = i * dx[0];</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;                    Real <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> = 0.25 * (z_nd(i,j,k) + z_nd(i,j+1,k) + z_nd(i,j,k+1) + z_nd(i,j+1,k+1));</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160; </div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;                    Real z_base = Ampl * std::sin(kp * <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01a9dd4e461268c8034f5c8564e155c67a6">x</a> - omega_t);</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;                    <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> -= z_base;</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160; </div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;                    Real fac = std::cosh( kp * (<a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> - H) ) / std::sinh(kp * H);</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160; </div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;                    xvel_arr(i,j,k) -= -Ampl * <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa93264ee6dc9b23e994674a68250a2f16">omega</a> * fac * std::sin(kp * <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01a9dd4e461268c8034f5c8564e155c67a6">x</a> - omega_t);</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;                });</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160; </div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;                ParallelFor(bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;                {</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;                    Real <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01a9dd4e461268c8034f5c8564e155c67a6">x</a>   = (i + 0.5) * dx[0];</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;                    Real <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a>   = 0.25 * ( z_nd(i,j,k) + z_nd(i+1,j,k) + z_nd(i,j+1,k) + z_nd(i+1,j+1,k));</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160; </div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;                    Real z_base = Ampl * std::sin(kp * <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01a9dd4e461268c8034f5c8564e155c67a6">x</a> - omega_t);</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;                    <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> -= z_base;</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160; </div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;                    Real fac = std::sinh( kp * (<a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> - H) ) / std::sinh(kp * H);</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160; </div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;                    zvel_arr(i,j,k) -= Ampl * <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa93264ee6dc9b23e994674a68250a2f16">omega</a> * fac * std::cos(kp * <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01a9dd4e461268c8034f5c8564e155c67a6">x</a> - omega_t);</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;                });</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;            }</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160; </div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;            MultiFab temp_mf(mf[lev].boxArray(), mf[lev].DistributionMap(), AMREX_SPACEDIM, 0);</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;            average_face_to_cellcenter(temp_mf,0,</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;                Array&lt;const MultiFab*,3&gt;{&amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],&amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],&amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>]});</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160; </div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;xvel_err&quot;</span>)) {</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;                MultiFab::Copy(mf[lev],temp_mf,0,mf_comp,1,0);</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;                mf_comp += 1;</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;            }</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;yvel_err&quot;</span>)) {</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;                MultiFab::Copy(mf[lev],temp_mf,1,mf_comp,1,0);</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;                mf_comp += 1;</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;            }</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;zvel_err&quot;</span>)) {</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;                MultiFab::Copy(mf[lev],temp_mf,2,mf_comp,1,0);</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;                mf_comp += 1;</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;            }</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160; </div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;            <span class="comment">// Now restore the velocities to what they were</span></div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;<span class="preprocessor">#pragma omp parallel if (amrex::Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;            <span class="keywordflow">for</span> (MFIter mfi(mf[lev], TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;            {</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.validbox();</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;                Box <a class="code" href="ERF__DiffSetup_8H.html#a853a144267414a8a59c87f80ca5c958c">xbx</a>(bx); <a class="code" href="ERF__DiffSetup_8H.html#a853a144267414a8a59c87f80ca5c958c">xbx</a>.surroundingNodes(0);</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160; </div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;                <span class="keyword">const</span> Array4&lt;Real&gt; xvel_arr = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>].array(mfi);</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;                <span class="keyword">const</span> Array4&lt;Real&gt; zvel_arr = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>].array(mfi);</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160; </div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; z_nd = <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160; </div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;                ParallelFor(<a class="code" href="ERF__DiffSetup_8H.html#a853a144267414a8a59c87f80ca5c958c">xbx</a>, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;                {</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;                    Real <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01a9dd4e461268c8034f5c8564e155c67a6">x</a> = i * dx[0];</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;                    Real <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> = 0.25 * (z_nd(i,j,k) + z_nd(i,j+1,k) + z_nd(i,j,k+1) + z_nd(i,j+1,k+1));</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;                    Real z_base = Ampl * std::sin(kp * <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01a9dd4e461268c8034f5c8564e155c67a6">x</a> - omega_t);</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160; </div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;                    <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> -= z_base;</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160; </div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;                    Real fac = std::cosh( kp * (<a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> - H) ) / std::sinh(kp * H);</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;                    xvel_arr(i,j,k) += -Ampl * <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa93264ee6dc9b23e994674a68250a2f16">omega</a> * fac * std::sin(kp * <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01a9dd4e461268c8034f5c8564e155c67a6">x</a> - omega_t);</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;                });</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;                ParallelFor(bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;                {</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;                    Real <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01a9dd4e461268c8034f5c8564e155c67a6">x</a>   = (i + 0.5) * dx[0];</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;                    Real <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a>   = 0.25 * ( z_nd(i,j,k) + z_nd(i+1,j,k) + z_nd(i,j+1,k) + z_nd(i+1,j+1,k));</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;                    Real z_base = Ampl * std::sin(kp * <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01a9dd4e461268c8034f5c8564e155c67a6">x</a> - omega_t);</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160; </div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;                    <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> -= z_base;</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;                    Real fac = std::sinh( kp * (<a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> - H) ) / std::sinh(kp * H);</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160; </div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;                    zvel_arr(i,j,k) += Ampl * <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa93264ee6dc9b23e994674a68250a2f16">omega</a> * fac * std::cos(kp * <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01a9dd4e461268c8034f5c8564e155c67a6">x</a> - omega_t);</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;                });</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;            }</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;        } <span class="comment">// end xvel_err, yvel_err, zvel_err</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160; </div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;pp_err&quot;</span>))</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;        {</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;            <span class="comment">// Moving terrain ANALYTICAL</span></div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;<span class="preprocessor">#pragma omp parallel if (amrex::Gpu::notInLaunchRegion())</span></div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;            <span class="keywordflow">for</span> ( MFIter mfi(mf[lev],TilingIfNotGPU()); mfi.isValid(); ++mfi)</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;            {</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;                <span class="keyword">const</span> Array4&lt;Real&gt;&amp; derdat = mf[lev].array(mfi);</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; p0_arr = p_hse.const_array(mfi);</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; S_arr = <a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a47abe072e12c61d29cde15a509a0664b">Vars::cons</a>].const_array(mfi);</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160; </div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;                <span class="keyword">const</span> <span class="keyword">auto</span> dx = geom[lev].CellSizeArray();</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; z_nd = <a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev]-&gt;const_array(mfi);</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp;  p_arr = pressure.const_array(mfi);</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;                <span class="keyword">const</span> Array4&lt;Real const&gt;&amp; r0_arr = r_hse.const_array(mfi);</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160; </div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;                Real H           = geom[lev].ProbHi()[2];</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;                Real Ampl        = 0.16;</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;                Real wavelength  = 100.;</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;                Real kp          = 2. * <a class="code" href="ERF__Constants_8H.html#a988c4efd6fd0d855e241e77a73191428">PI</a> / wavelength;</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;                Real <a class="code" href="namespacemodule__model__constants.html#a1f0c74f0fd17b1b38de53299cadb3fdf">g</a>           = <a class="code" href="ERF__Constants_8H.html#ac2d0c304ab1117368778efcda612de43">CONST_GRAV</a>;</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;                Real <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa93264ee6dc9b23e994674a68250a2f16">omega</a>       = std::sqrt(<a class="code" href="namespacemodule__model__constants.html#a1f0c74f0fd17b1b38de53299cadb3fdf">g</a> * kp);</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;                Real omega_t     = <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa93264ee6dc9b23e994674a68250a2f16">omega</a> * <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev];</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160; </div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;                ParallelFor(bx, [=] AMREX_GPU_DEVICE(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k) noexcept</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;                {</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;                    derdat(i, j, k, mf_comp) = p_arr(i,j,k) - p0_arr(i,j,k);</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160; </div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;                    Real rho_hse     = r0_arr(i,j,k);</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160; </div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;                    Real <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01a9dd4e461268c8034f5c8564e155c67a6">x</a>   = (i + 0.5) * dx[0];</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;                    Real <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a>   = 0.125 * ( z_nd(i,j,k  ) + z_nd(i+1,j,k  ) + z_nd(i,j+1,k  ) + z_nd(i+1,j+1,k  )</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;                                        +z_nd(i,j,k+1) + z_nd(i+1,j,k+1) + z_nd(i,j+1,k+1) + z_nd(i+1,j+1,k+1) );</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;                    Real z_base = Ampl * std::sin(kp * <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01a9dd4e461268c8034f5c8564e155c67a6">x</a> - omega_t);</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160; </div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;                    <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> -= z_base;</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;                    Real fac = std::cosh( kp * (<a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01afbade9e36a3f36d3d676c1b808451dd7">z</a> - H) ) / std::sinh(kp * H);</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;                    Real pprime_exact = -(Ampl * <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa93264ee6dc9b23e994674a68250a2f16">omega</a> * <a class="code" href="namespaceMicVar__Morr.html#ab6f5948b8eeb029d684e7b7d19cfc5daa93264ee6dc9b23e994674a68250a2f16">omega</a> / kp) * fac *</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;                                              std::sin(kp * <a class="code" href="ERF__DataStruct_8H.html#a627f1f843904477f763577ad1460de01a9dd4e461268c8034f5c8564e155c67a6">x</a> - omega_t) * r0_arr(i,j,k);</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160; </div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;                    derdat(i,j,k,mf_comp) -= pprime_exact;</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;                });</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;            }</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;            mf_comp += 1;</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;        }</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160; </div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#a31c93846e0129221632347d2378e881d">rad_type</a> != RadiationType::None) {</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;qsrc_sw&quot;</span>)) {</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;            MultiFab::Copy(mf[lev], *(<a class="code" href="classERF.html#afa4c3753628a106460dbb708277de511">qheating_rates</a>[lev]), 0, mf_comp, 1, 0);</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;            mf_comp += 1;</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;        }</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67">containerHasElement</a>(plot_var_names, <span class="stringliteral">&quot;qsrc_lw&quot;</span>)) {</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;            MultiFab::Copy(mf[lev], *(<a class="code" href="classERF.html#afa4c3753628a106460dbb708277de511">qheating_rates</a>[lev]), 1, mf_comp, 1, 0);</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;            mf_comp += 1;</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;        }</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    }</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160; </div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    }</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160; </div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> == TerrainType::EB)</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    {</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;            EB_set_covered(mf[lev], 0.0);</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;        }</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;    }</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160; </div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;    <span class="comment">// Fill terrain distortion MF (nu_nd)</span></div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structSolverChoice.html#a1952672901901b0b3a628f2298dc72c2">SolverChoice::mesh_type</a> != MeshType::ConstantDz) {</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev(0); lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;            MultiFab::Copy(mf_nd[lev],*<a class="code" href="classERF.html#a93e63e5af35efa564fd4195e8703f84c">z_phys_nd</a>[lev],0,2,1,0);</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;            Real dz = Geom()[lev].CellSizeArray()[2];</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;            <span class="keywordflow">for</span> (MFIter mfi(mf_nd[lev], TilingIfNotGPU()); mfi.isValid(); ++mfi) {</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;                <span class="keyword">const</span> Box&amp; bx = mfi.tilebox();</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;                Array4&lt;Real&gt; mf_arr = mf_nd[lev].array(mfi);</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;                ParallelFor(bx, [=] AMREX_GPU_DEVICE (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;                {</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;                    mf_arr(i,j,k,2) -= k * dz;</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;                });</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;            }</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;        }</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;    }</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160; </div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;    std::string plotfilename;</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;    std::string plotfilenameU;</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;    std::string plotfilenameV;</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;    std::string plotfilenameW;</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;    <span class="keywordflow">if</span> (which == 1) {</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;       plotfilename = Concatenate(<a class="code" href="classERF.html#aa54aaa938a18d34caa4d86e977647899">plot_file_1</a>, <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[0], 5);</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;       plotfilenameU = Concatenate(<a class="code" href="classERF.html#aa54aaa938a18d34caa4d86e977647899">plot_file_1</a>+<span class="stringliteral">&quot;U&quot;</span>, <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[0], 5);</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;       plotfilenameV = Concatenate(<a class="code" href="classERF.html#aa54aaa938a18d34caa4d86e977647899">plot_file_1</a>+<span class="stringliteral">&quot;V&quot;</span>, <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[0], 5);</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;       plotfilenameW = Concatenate(<a class="code" href="classERF.html#aa54aaa938a18d34caa4d86e977647899">plot_file_1</a>+<span class="stringliteral">&quot;W&quot;</span>, <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[0], 5);</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (which == 2) {</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;       plotfilename = Concatenate(<a class="code" href="classERF.html#a18fa84b06132715757d97ec38678aa2c">plot_file_2</a>, <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[0], 5);</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;       plotfilenameU = Concatenate(<a class="code" href="classERF.html#a18fa84b06132715757d97ec38678aa2c">plot_file_2</a>+<span class="stringliteral">&quot;U&quot;</span>, <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[0], 5);</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;       plotfilenameV = Concatenate(<a class="code" href="classERF.html#a18fa84b06132715757d97ec38678aa2c">plot_file_2</a>+<span class="stringliteral">&quot;V&quot;</span>, <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[0], 5);</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;       plotfilenameW = Concatenate(<a class="code" href="classERF.html#a18fa84b06132715757d97ec38678aa2c">plot_file_2</a>+<span class="stringliteral">&quot;W&quot;</span>, <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[0], 5);</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;    }</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160; </div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;    <span class="comment">// LSM writes it&#39;s own data</span></div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;    <span class="keywordflow">if</span> (which==1 &amp;&amp; <a class="code" href="classERF.html#afc653b103aa26c56acafed85cdd95f52">plot_lsm</a>) {</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;        <a class="code" href="classERF.html#ae0e9a78f120ba632d78cbf23c97b851c">lsm</a>.<a class="code" href="classLandSurface.html#a61290767bd3f0bc65db7a0a344b10899">Plot_Lsm_Data</a>(<a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0], <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>, refRatio());</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;    }</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160; </div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;<span class="preprocessor">#ifdef ERF_USE_RRTMGP</span></div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;<span class="comment">    // write additional RRTMGP data</span></div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;<span class="comment">    // TODO: currently single level only</span></div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;<span class="comment">    if (which==1 &amp;&amp; plot_rad) {</span></div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;<span class="comment">        rad[0]-&gt;writePlotfile(plot_file_1, t_new[0], istep[0]);</span></div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;<span class="comment">    }</span></div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;<span class="comment">    */</span></div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160; </div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;    <span class="comment">// Single level</span></div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;    <span class="keywordflow">if</span> (finest_level == 0)</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    {</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;        <span class="keywordflow">if</span> (plotfile_type == PlotFileType::Amrex)</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;        {</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;            Print() &lt;&lt; <span class="stringliteral">&quot;Writing native plotfile &quot;</span> &lt;&lt; plotfilename &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="structSolverChoice.html#a1952672901901b0b3a628f2298dc72c2">SolverChoice::mesh_type</a> != MeshType::ConstantDz) {</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;                <a class="code" href="classERF.html#a61510e69bdaee84a01cf33943b043a5c">WriteMultiLevelPlotfileWithTerrain</a>(plotfilename, finest_level+1,</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;                                                   GetVecOfConstPtrs(mf),</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;                                                   GetVecOfConstPtrs(mf_nd),</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;                                                   varnames,</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;                                                   Geom(), <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0], <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>, refRatio());</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;                WriteMultiLevelPlotfile(plotfilename, finest_level+1,</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;                                        GetVecOfConstPtrs(mf),</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;                                        varnames,</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;                                        Geom(), <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0], <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>, refRatio());</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;            }</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;            <a class="code" href="classERF.html#aa2d8099655a8779836e63e3e98ea4372">writeJobInfo</a>(plotfilename);</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160; </div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a367a3daba5d844efbed84c52e647cea6">m_plot_face_vels</a>) {</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;                Print() &lt;&lt; <span class="stringliteral">&quot;Writing face velocities&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;                WriteMultiLevelPlotfile(plotfilenameU, finest_level+1,</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;                                        GetVecOfConstPtrs(mf_u),</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;                                        {<span class="stringliteral">&quot;x_velocity_stag&quot;</span>},</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;                                        Geom(), <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0], <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>, refRatio());</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;                WriteMultiLevelPlotfile(plotfilenameV, finest_level+1,</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;                                        GetVecOfConstPtrs(mf_v),</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;                                        {<span class="stringliteral">&quot;y_velocity_stag&quot;</span>},</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;                                        Geom(), <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0], <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>, refRatio());</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;                WriteMultiLevelPlotfile(plotfilenameW, finest_level+1,</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;                                        GetVecOfConstPtrs(mf_w),</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;                                        {<span class="stringliteral">&quot;z_velocity_stag&quot;</span>},</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;                                        Geom(), <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0], <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>, refRatio());</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;            }</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160; </div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;<span class="preprocessor">#ifdef ERF_USE_PARTICLES</span></div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;            particleData.writePlotFile(plotfilename);</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;<span class="preprocessor">#ifdef ERF_USE_NETCDF</span></div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (plotfile_type == PlotFileType::Netcdf) {</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;             AMREX_ALWAYS_ASSERT(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> != TerrainType::StaticFittedMesh);</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;             <span class="keywordtype">int</span> lev   = 0;</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;             <span class="keywordtype">int</span> l_which = 0;</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;             <span class="keyword">const</span> Real* p_lo = geom[lev].ProbLo();</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;             <span class="keyword">const</span> Real* p_hi = geom[lev].ProbHi();</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;             <span class="keyword">const</span> <span class="keyword">auto</span> dx    = geom[lev].CellSize();</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;             <a class="code" href="ERF__NCPlotFile_8cpp.html#ad9a51088de1000816aac4e945c877b84">writeNCPlotFile</a>(lev, l_which, plotfilename, GetVecOfConstPtrs(mf), varnames, <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>,</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;                             {p_lo[0],p_lo[1],p_lo[2]},{p_hi[0],p_hi[1],p_hi[2]}, {dx[0],dx[1],dx[2]},</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;                             geom[lev].Domain(), <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0], start_bdy_time);</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;            <span class="comment">// Here we assume the plotfile_type is PlotFileType::None</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;            Print() &lt;&lt; <span class="stringliteral">&quot;Writing no plotfile since plotfile_type is none&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;        }</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160; </div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;    } <span class="keywordflow">else</span> { <span class="comment">// Multilevel</span></div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160; </div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;        <span class="keywordflow">if</span> (plotfile_type == PlotFileType::Amrex) {</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160; </div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;            <span class="keywordtype">int</span> lev0 = 0;</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;            <span class="keywordtype">int</span> desired_ratio = std::max(std::max(ref_ratio[lev0][0],ref_ratio[lev0][1]),ref_ratio[lev0][2]);</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;            <span class="keywordtype">bool</span> any_ratio_one = ( ( (ref_ratio[lev0][0] == 1) || (ref_ratio[lev0][1] == 1) ) ||</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;                                     (ref_ratio[lev0][2] == 1) );</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 1; lev &lt; finest_level; lev++) {</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;                any_ratio_one = any_ratio_one ||</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;                                     ( ( (ref_ratio[lev][0] == 1) || (ref_ratio[lev][1] == 1) ) ||</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;                                         (ref_ratio[lev][2] == 1) );</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;            }</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160; </div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;            <span class="keywordflow">if</span> (any_ratio_one &amp;&amp; <a class="code" href="classERF.html#adb272adf862040a2f1a6226c57c35627">m_expand_plotvars_to_unif_rr</a>)</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;            {</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;                Vector&lt;IntVect&gt;   r2(finest_level);</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;                Vector&lt;Geometry&gt;  g2(finest_level+1);</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;                Vector&lt;MultiFab&gt; mf2(finest_level+1);</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160; </div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;                mf2[0].define(grids[0], dmap[0], ncomp_mf, 0);</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160; </div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;                <span class="comment">// Copy level 0 as is</span></div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;                MultiFab::Copy(mf2[0],mf[0],0,0,mf[0].nComp(),0);</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160; </div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;                <span class="comment">// Define a new multi-level array of Geometry&#39;s so that we pass the new &quot;domain&quot; at lev &gt; 0</span></div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;                Array&lt;int,AMREX_SPACEDIM&gt; periodicity =</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;                             {Geom()[lev0].isPeriodic(0),Geom()[lev0].isPeriodic(1),Geom()[lev0].isPeriodic(2)};</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;                g2[lev0].define(Geom()[lev0].Domain(),&amp;(Geom()[lev0].ProbDomain()),0,periodicity.data());</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160; </div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;                r2[0] = IntVect(desired_ratio/ref_ratio[lev0][0],</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;                                desired_ratio/ref_ratio[lev0][1],</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;                                desired_ratio/ref_ratio[lev0][2]);</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160; </div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 1; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;                    <span class="keywordflow">if</span> (lev &gt; 1) {</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;                        r2[lev-1][0] = r2[lev-2][0] * desired_ratio / ref_ratio[lev-1][0];</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;                        r2[lev-1][1] = r2[lev-2][1] * desired_ratio / ref_ratio[lev-1][1];</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;                        r2[lev-1][2] = r2[lev-2][2] * desired_ratio / ref_ratio[lev-1][2];</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;                    }</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160; </div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;                    mf2[lev].define(refine(grids[lev],r2[lev-1]), dmap[lev], ncomp_mf, 0);</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160; </div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;                    <span class="comment">// Set the new problem domain</span></div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;                    Box d2(Geom()[lev].Domain());</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;                    d2.refine(r2[lev-1]);</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160; </div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;                    g2[lev].define(d2,&amp;(Geom()[lev].ProbDomain()),0,periodicity.data());</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;                }</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160; </div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;                <span class="comment">// We need to make a temporary that is the size of ncomp_mf</span></div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;                <span class="comment">// in order to not get an out of bounds error</span></div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;                <span class="comment">// even though the values will not be used</span></div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;                Vector&lt;BCRec&gt; temp_domain_bcs_type;</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;                temp_domain_bcs_type.resize(ncomp_mf);</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160; </div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;                <span class="comment">// Do piecewise constant interpolation of mf into mf2</span></div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 1; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;                    Interpolater* mapper_c = &amp;pc_interp;</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;                    InterpFromCoarseLevel(mf2[lev], <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev], mf[lev],</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;                                          0, 0, ncomp_mf,</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;                                          geom[lev], g2[lev],</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;                                          <a class="code" href="ERF__Plotfile_8cpp.html#aeb56b4bca6dfa0e3b81d3f983926e8a2">null_bc_for_fill</a>, 0, <a class="code" href="ERF__Plotfile_8cpp.html#aeb56b4bca6dfa0e3b81d3f983926e8a2">null_bc_for_fill</a>, 0,</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;                                          r2[lev-1], mapper_c, temp_domain_bcs_type, 0);</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;                }</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160; </div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;                <span class="comment">// Define an effective ref_ratio which is isotropic to be passed into WriteMultiLevelPlotfile</span></div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;                Vector&lt;IntVect&gt; <a class="code" href="namespacemodule__mp__morr__two__moment.html#a649e184a5c5c6d2eef72a390c18eb4e4">rr</a>(finest_level);</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt; finest_level; ++lev) {</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;                    <a class="code" href="namespacemodule__mp__morr__two__moment.html#a649e184a5c5c6d2eef72a390c18eb4e4">rr</a>[lev] = IntVect(desired_ratio);</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;                }</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160; </div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;               Print() &lt;&lt; <span class="stringliteral">&quot;Writing plotfile &quot;</span> &lt;&lt; plotfilename &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;               <span class="keywordflow">if</span> (<a class="code" href="structSolverChoice.html#a1952672901901b0b3a628f2298dc72c2">SolverChoice::mesh_type</a> != MeshType::ConstantDz) {</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;                   <a class="code" href="classERF.html#a61510e69bdaee84a01cf33943b043a5c">WriteMultiLevelPlotfileWithTerrain</a>(plotfilename, finest_level+1,</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;                                                      GetVecOfConstPtrs(mf2),</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;                                                      GetVecOfConstPtrs(mf_nd),</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;                                                      varnames,</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;                                                      g2, <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0], <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>, <a class="code" href="namespacemodule__mp__morr__two__moment.html#a649e184a5c5c6d2eef72a390c18eb4e4">rr</a>);</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;               } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;                   WriteMultiLevelPlotfile(plotfilename, finest_level+1,</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;                                           GetVecOfConstPtrs(mf2), varnames,</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;                                           g2, <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0], <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>, <a class="code" href="namespacemodule__mp__morr__two__moment.html#a649e184a5c5c6d2eef72a390c18eb4e4">rr</a>);</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;               }</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160; </div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;               <span class="keywordflow">if</span> (<a class="code" href="structSolverChoice.html#a1952672901901b0b3a628f2298dc72c2">SolverChoice::mesh_type</a> != MeshType::ConstantDz) {</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;                    <a class="code" href="classERF.html#a61510e69bdaee84a01cf33943b043a5c">WriteMultiLevelPlotfileWithTerrain</a>(plotfilename, finest_level+1,</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;                                                       GetVecOfConstPtrs(mf),</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;                                                       GetVecOfConstPtrs(mf_nd),</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;                                                       varnames,</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;                                                       geom, <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0], <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>, ref_ratio);</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;                    WriteMultiLevelPlotfile(plotfilename, finest_level+1,</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;                                            GetVecOfConstPtrs(mf), varnames,</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;                                            geom, <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0], <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>, ref_ratio);</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;                }</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classERF.html#a367a3daba5d844efbed84c52e647cea6">m_plot_face_vels</a>) {</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;                    Print() &lt;&lt; <span class="stringliteral">&quot;Writing face velocities&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;                    WriteMultiLevelPlotfile(plotfilenameU, finest_level+1,</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;                                            GetVecOfConstPtrs(mf_u),</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;                                            {<span class="stringliteral">&quot;x_velocity_stag&quot;</span>},</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;                                            geom, <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0], <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>, ref_ratio);</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;                    WriteMultiLevelPlotfile(plotfilenameV, finest_level+1,</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;                                            GetVecOfConstPtrs(mf_v),</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;                                            {<span class="stringliteral">&quot;y_velocity_stag&quot;</span>},</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;                                            geom, <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0], <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>, ref_ratio);</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;                    WriteMultiLevelPlotfile(plotfilenameW, finest_level+1,</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;                                            GetVecOfConstPtrs(mf_w),</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;                                            {<span class="stringliteral">&quot;z_velocity_stag&quot;</span>},</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;                                            geom, <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0], <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>, ref_ratio);</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;                }</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;            } <span class="comment">// ref_ratio test</span></div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160; </div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;            <a class="code" href="classERF.html#aa2d8099655a8779836e63e3e98ea4372">writeJobInfo</a>(plotfilename);</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160; </div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;<span class="preprocessor">#ifdef ERF_USE_PARTICLES</span></div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;            particleData.writePlotFile(plotfilename);</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160; </div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;<span class="preprocessor">#ifdef ERF_USE_NETCDF</span></div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (plotfile_type == PlotFileType::Netcdf) {</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;             AMREX_ALWAYS_ASSERT(<a class="code" href="classERF.html#a32dd48049e8acbe95decdd4b01b782c4">solverChoice</a>.<a class="code" href="structSolverChoice.html#ab734eb0a5147b93dc6590038b6decc60">terrain_type</a> != TerrainType::StaticFittedMesh);</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt;= finest_level; ++lev) {</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> which_box = 0; which_box &lt; <a class="code" href="classERF.html#adcd9f23975ffa605247b41d391c2a2f0">num_boxes_at_level</a>[lev]; which_box++) {</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;                     Box bounding_region = (lev == 0)  ? geom[lev].Domain() : <a class="code" href="classERF.html#a050dbd236c9bf246554a53008e09f683">boxes_at_level</a>[lev][which_box];</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;                     <span class="keyword">const</span> Real* p_lo = geom[lev].ProbLo();</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;                     <span class="keyword">const</span> Real* p_hi = geom[lev].ProbHi();</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;                     <span class="keyword">const</span> <span class="keyword">auto</span> dx    = geom[lev].CellSizeArray();</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;                     <a class="code" href="ERF__NCPlotFile_8cpp.html#ad9a51088de1000816aac4e945c877b84">writeNCPlotFile</a>(lev, which_box, plotfilename, GetVecOfConstPtrs(mf), varnames, <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>,</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;                                     {p_lo[0],p_lo[1],p_lo[2]},{p_hi[0],p_hi[1],p_hi[2]}, {dx[0],dx[1],dx[2]},</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;                                     bounding_region, <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[0], start_bdy_time);</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;                 }</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;             }</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;        }</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;    } <span class="comment">// end multi-level</span></div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;}</div>
<div class="ttc" id="aERF__Constants_8H_html_a988c4efd6fd0d855e241e77a73191428"><div class="ttname"><a href="ERF__Constants_8H.html#a988c4efd6fd0d855e241e77a73191428">PI</a></div><div class="ttdeci">constexpr amrex::Real PI</div><div class="ttdef"><b>Definition:</b> ERF_Constants.H:6</div></div>
<div class="ttc" id="aERF__Constants_8H_html_acecae1da25fb8c8d32d1f175e18df41f"><div class="ttname"><a href="ERF__Constants_8H.html#acecae1da25fb8c8d32d1f175e18df41f">Cp_l</a></div><div class="ttdeci">constexpr amrex::Real Cp_l</div><div class="ttdef"><b>Definition:</b> ERF_Constants.H:14</div></div>
<div class="ttc" id="aERF__IndexDefines_8H_html_a28c5deab9008c0999c26affeff2fa6da"><div class="ttname"><a href="ERF__IndexDefines_8H.html#a28c5deab9008c0999c26affeff2fa6da">RhoQ4_comp</a></div><div class="ttdeci">#define RhoQ4_comp</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:45</div></div>
<div class="ttc" id="aERF__MakeGradP_8cpp_html_a77a5a7eae63c5896960f8953a277cfe0"><div class="ttname"><a href="ERF__MakeGradP_8cpp.html#a77a5a7eae63c5896960f8953a277cfe0">compute_gradp</a></div><div class="ttdeci">void compute_gradp(const MultiFab &amp;p, const Geometry &amp;geom, MultiFab &amp;z_phys_nd, MultiFab &amp;z_phys_cc, BCRec const *d_bcrec_ptr, const eb_ &amp;ebfact, Vector&lt; MultiFab &gt; &amp;gradp, const SolverChoice &amp;solverChoice)</div><div class="ttdef"><b>Definition:</b> ERF_MakeGradP.cpp:71</div></div>
<div class="ttc" id="aERF__MicrophysicsUtils_8H_html_a16a390366e7e68ca35fdac4cad824428"><div class="ttname"><a href="ERF__MicrophysicsUtils_8H.html#a16a390366e7e68ca35fdac4cad824428">erf_esatw</a></div><div class="ttdeci">AMREX_GPU_HOST_DEVICE AMREX_FORCE_INLINE amrex::Real erf_esatw(amrex::Real t)</div><div class="ttdef"><b>Definition:</b> ERF_MicrophysicsUtils.H:64</div></div>
<div class="ttc" id="aERF__MicrophysicsUtils_8H_html_a8e4b0c6ed8b95c2040dc0c9e8fcb8615"><div class="ttname"><a href="ERF__MicrophysicsUtils_8H.html#a8e4b0c6ed8b95c2040dc0c9e8fcb8615">erf_qsatw</a></div><div class="ttdeci">AMREX_GPU_HOST_DEVICE AMREX_FORCE_INLINE void erf_qsatw(amrex::Real t, amrex::Real p, amrex::Real &amp;qsatw)</div><div class="ttdef"><b>Definition:</b> ERF_MicrophysicsUtils.H:158</div></div>
<div class="ttc" id="aERF__NCPlotFile_8cpp_html_ad9a51088de1000816aac4e945c877b84"><div class="ttname"><a href="ERF__NCPlotFile_8cpp.html#ad9a51088de1000816aac4e945c877b84">writeNCPlotFile</a></div><div class="ttdeci">void writeNCPlotFile(int lev, int which_subdomain, const std::string &amp;dir, const Vector&lt; const MultiFab * &gt; &amp;plotMF, const Vector&lt; std::string &gt; &amp;plot_var_names, const Vector&lt; int &gt; &amp;, Array&lt; Real, AMREX_SPACEDIM &gt; prob_lo, Array&lt; Real, AMREX_SPACEDIM &gt; prob_hi, Array&lt; Real, AMREX_SPACEDIM &gt; dx_in, const Box &amp;subdomain, const Real time, const Real start_bdy_time)</div><div class="ttdef"><b>Definition:</b> ERF_NCPlotFile.cpp:14</div></div>
<div class="ttc" id="aERF__Plotfile_8cpp_html_aeb56b4bca6dfa0e3b81d3f983926e8a2"><div class="ttname"><a href="ERF__Plotfile_8cpp.html#aeb56b4bca6dfa0e3b81d3f983926e8a2">null_bc_for_fill</a></div><div class="ttdeci">PhysBCFunctNoOp null_bc_for_fill</div><div class="ttdef"><b>Definition:</b> ERF_Plotfile.cpp:6</div></div>
<div class="ttc" id="aclassERF_html_a2dcd22cb915d923c687f60267f44542b"><div class="ttname"><a href="classERF.html#a2dcd22cb915d923c687f60267f44542b">ERF::PlotFileVarNames</a></div><div class="ttdeci">static amrex::Vector&lt; std::string &gt; PlotFileVarNames(amrex::Vector&lt; std::string &gt; plot_var_names)</div><div class="ttdef"><b>Definition:</b> ERF_Plotfile.cpp:249</div></div>
<div class="ttc" id="aclassERF_html_a61510e69bdaee84a01cf33943b043a5c"><div class="ttname"><a href="classERF.html#a61510e69bdaee84a01cf33943b043a5c">ERF::WriteMultiLevelPlotfileWithTerrain</a></div><div class="ttdeci">void WriteMultiLevelPlotfileWithTerrain(const std::string &amp;plotfilename, int nlevels, const amrex::Vector&lt; const amrex::MultiFab * &gt; &amp;mf, const amrex::Vector&lt; const amrex::MultiFab * &gt; &amp;mf_nd, const amrex::Vector&lt; std::string &gt; &amp;varnames, const amrex::Vector&lt; amrex::Geometry &gt; &amp;my_geom, amrex::Real time, const amrex::Vector&lt; int &gt; &amp;level_steps, const amrex::Vector&lt; amrex::IntVect &gt; &amp;my_ref_ratio, const std::string &amp;versionName=&quot;HyperCLaw-V1.1&quot;, const std::string &amp;levelPrefix=&quot;Level_&quot;, const std::string &amp;mfPrefix=&quot;Cell&quot;, const amrex::Vector&lt; std::string &gt; &amp;extra_dirs=amrex::Vector&lt; std::string &gt;()) const</div><div class="ttdef"><b>Definition:</b> ERF_Plotfile.cpp:1579</div></div>
<div class="ttc" id="aclassERF_html_aa2d8099655a8779836e63e3e98ea4372"><div class="ttname"><a href="classERF.html#aa2d8099655a8779836e63e3e98ea4372">ERF::writeJobInfo</a></div><div class="ttdeci">void writeJobInfo(const std::string &amp;dir) const</div><div class="ttdef"><b>Definition:</b> ERF_WriteJobInfo.cpp:9</div></div>
<div class="ttc" id="aclassLandSurface_html_a61290767bd3f0bc65db7a0a344b10899"><div class="ttname"><a href="classLandSurface.html#a61290767bd3f0bc65db7a0a344b10899">LandSurface::Plot_Lsm_Data</a></div><div class="ttdeci">void Plot_Lsm_Data(amrex::Real time, const amrex::Vector&lt; int &gt; &amp;level_steps, const amrex::Vector&lt; amrex::IntVect &gt; &amp;ref_ratio)</div><div class="ttdef"><b>Definition:</b> ERF_LandSurface.H:98</div></div>
<div class="ttc" id="anamespaceEddyDiff_html_a3f912b3dbcd18dd6f4f0a85815a3ce47a1fd996857fe3699ac7f9454e88d6ae76"><div class="ttname"><a href="namespaceEddyDiff.html#a3f912b3dbcd18dd6f4f0a85815a3ce47a1fd996857fe3699ac7f9454e88d6ae76">EddyDiff::Turb_lengthscale</a></div><div class="ttdeci">@ Turb_lengthscale</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:180</div></div>
<div class="ttc" id="anamespaceEddyDiff_html_a3f912b3dbcd18dd6f4f0a85815a3ce47a2e96e6d5e84e7d7b9857e73159dfbe2b"><div class="ttname"><a href="namespaceEddyDiff.html#a3f912b3dbcd18dd6f4f0a85815a3ce47a2e96e6d5e84e7d7b9857e73159dfbe2b">EddyDiff::Mom_h</a></div><div class="ttdeci">@ Mom_h</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:170</div></div>
<div class="ttc" id="anamespaceEddyDiff_html_a3f912b3dbcd18dd6f4f0a85815a3ce47ad0cfc6c50b43867895cbc2c02eb2b99a"><div class="ttname"><a href="namespaceEddyDiff.html#a3f912b3dbcd18dd6f4f0a85815a3ce47ad0cfc6c50b43867895cbc2c02eb2b99a">EddyDiff::Theta_h</a></div><div class="ttdeci">@ Theta_h</div><div class="ttdef"><b>Definition:</b> ERF_IndexDefines.H:171</div></div>
<div class="ttc" id="anamespacederived_html_a0a37dd4fa4a044e34891e6222d06654c"><div class="ttname"><a href="namespacederived.html#a0a37dd4fa4a044e34891e6222d06654c">derived::erf_dervortx</a></div><div class="ttdeci">void erf_dervortx(const amrex::Box &amp;bx, amrex::FArrayBox &amp;derfab, int dcomp, int ncomp, const amrex::FArrayBox &amp;datfab, const amrex::Geometry &amp;geomdata, amrex::Real, const int *, const int)</div><div class="ttdef"><b>Definition:</b> ERF_Derive.cpp:200</div></div>
<div class="ttc" id="anamespacederived_html_a2a85aedf7c75ca416dbb931559c4b21e"><div class="ttname"><a href="namespacederived.html#a2a85aedf7c75ca416dbb931559c4b21e">derived::erf_dervorty</a></div><div class="ttdeci">void erf_dervorty(const amrex::Box &amp;bx, amrex::FArrayBox &amp;derfab, int dcomp, int ncomp, const amrex::FArrayBox &amp;datfab, const amrex::Geometry &amp;geomdata, amrex::Real, const int *, const int)</div><div class="ttdef"><b>Definition:</b> ERF_Derive.cpp:228</div></div>
<div class="ttc" id="anamespacederived_html_a5186c6ea33e82af321f529242a615dc2"><div class="ttname"><a href="namespacederived.html#a5186c6ea33e82af321f529242a615dc2">derived::erf_dermagvel</a></div><div class="ttdeci">void erf_dermagvel(const amrex::Box &amp;bx, amrex::FArrayBox &amp;derfab, int dcomp, int ncomp, const amrex::FArrayBox &amp;datfab, const amrex::Geometry &amp;, amrex::Real, const int *, const int)</div><div class="ttdef"><b>Definition:</b> ERF_Derive.cpp:319</div></div>
<div class="ttc" id="anamespacederived_html_a7fb98e12fceaa6f691dfef83db453757"><div class="ttname"><a href="namespacederived.html#a7fb98e12fceaa6f691dfef83db453757">derived::erf_dernull</a></div><div class="ttdeci">void erf_dernull(const Box &amp;, FArrayBox &amp;, int, int, const FArrayBox &amp;, const Geometry &amp;, Real, const int *, const int)</div><div class="ttdef"><b>Definition:</b> ERF_Derive.cpp:39</div></div>
<div class="ttc" id="anamespacederived_html_a8d96f91847cec51636c122ab27a5f8a2"><div class="ttname"><a href="namespacederived.html#a8d96f91847cec51636c122ab27a5f8a2">derived::erf_dertemp</a></div><div class="ttdeci">void erf_dertemp(const Box &amp;bx, FArrayBox &amp;derfab, int, int, const FArrayBox &amp;datfab, const Geometry &amp;, Real, const int *, const int)</div><div class="ttdef"><b>Definition:</b> ERF_Derive.cpp:91</div></div>
<div class="ttc" id="anamespacederived_html_acc3f245c73a0826afc9e7626f12126d3"><div class="ttname"><a href="namespacederived.html#acc3f245c73a0826afc9e7626f12126d3">derived::erf_derKE</a></div><div class="ttdeci">void erf_derKE(const Box &amp;bx, FArrayBox &amp;derfab, int, int, const FArrayBox &amp;datfab, const Geometry &amp;, Real, const int *, const int)</div><div class="ttdef"><b>Definition:</b> ERF_Derive.cpp:186</div></div>
<div class="ttc" id="anamespacederived_html_add1791d7423c133ba6e7ab55975cf34f"><div class="ttname"><a href="namespacederived.html#add1791d7423c133ba6e7ab55975cf34f">derived::erf_dermoisttemp</a></div><div class="ttdeci">void erf_dermoisttemp(const Box &amp;bx, FArrayBox &amp;derfab, int, int, const FArrayBox &amp;datfab, const Geometry &amp;, Real, const int *, const int)</div><div class="ttdef"><b>Definition:</b> ERF_Derive.cpp:113</div></div>
<div class="ttc" id="anamespacederived_html_afe57e0f13e2e24c73d0ed373a9cd0d09"><div class="ttname"><a href="namespacederived.html#afe57e0f13e2e24c73d0ed373a9cd0d09">derived::erf_dersoundspeed</a></div><div class="ttdeci">void erf_dersoundspeed(const Box &amp;bx, FArrayBox &amp;derfab, int, int, const FArrayBox &amp;datfab, const Geometry &amp;, Real, const int *, const int)</div><div class="ttdef"><b>Definition:</b> ERF_Derive.cpp:58</div></div>
<div class="ttc" id="anamespacemodule__model__constants_html_a1f0c74f0fd17b1b38de53299cadb3fdf"><div class="ttname"><a href="namespacemodule__model__constants.html#a1f0c74f0fd17b1b38de53299cadb3fdf">module_model_constants::g</a></div><div class="ttdeci">real(c_double), parameter g</div><div class="ttdef"><b>Definition:</b> ERF_module_model_constants.F90:19</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a98cccb83ca76c44d6ae583d051e76faf_cgraph.png" border="0" usemap="#aclassERF_a98cccb83ca76c44d6ae583d051e76faf_cgraph" alt=""/></div>
<map name="aclassERF_a98cccb83ca76c44d6ae583d051e76faf_cgraph" id="aclassERF_a98cccb83ca76c44d6ae583d051e76faf_cgraph">
<area shape="rect" title=" " alt="" coords="5,537,143,564"/>
<area shape="rect" href="ERF__MakeGradP_8cpp.html#a77a5a7eae63c5896960f8953a277cfe0" title=" " alt="" coords="231,81,353,108"/>
<area shape="rect" href="ERF__Container_8H.html#a1f8554e7b211b0acfc202e8a600e7d67" title=" " alt="" coords="211,132,373,159"/>
<area shape="rect" href="namespacederived.html#acc3f245c73a0826afc9e7626f12126d3" title=" " alt="" coords="221,487,363,513"/>
<area shape="rect" href="namespacederived.html#a5186c6ea33e82af321f529242a615dc2" title=" " alt="" coords="205,233,379,260"/>
<area shape="rect" href="namespacederived.html#add1791d7423c133ba6e7ab55975cf34f" title=" " alt="" coords="194,284,390,311"/>
<area shape="rect" href="ERF__EOS_8H.html#a65cf1718b7a1fcc56cb16685642543da" title=" " alt="" coords="465,284,609,311"/>
<area shape="rect" href="namespacederived.html#a7fb98e12fceaa6f691dfef83db453757" title=" " alt="" coords="217,385,367,412"/>
<area shape="rect" href="namespacederived.html#a37560f4d3e2c7c10f64d41db2ce76a06" title=" " alt="" coords="210,436,374,463"/>
<area shape="rect" href="namespacederived.html#afe57e0f13e2e24c73d0ed373a9cd0d09" title=" " alt="" coords="191,639,393,665"/>
<area shape="rect" href="ERF__EOS_8H.html#a08354ab110fb9e873bce9250b4f4b46e" title=" " alt="" coords="482,613,593,640"/>
<area shape="rect" href="namespacederived.html#a8d96f91847cec51636c122ab27a5f8a2" title=" " alt="" coords="213,183,371,209"/>
<area shape="rect" href="namespacederived.html#adc3c787125484205e4fc7cd85c25ab6c" title=" " alt="" coords="213,537,371,564"/>
<area shape="rect" href="namespacederived.html#a0a37dd4fa4a044e34891e6222d06654c" title=" " alt="" coords="213,689,371,716"/>
<area shape="rect" href="namespacederived.html#a2a85aedf7c75ca416dbb931559c4b21e" title=" " alt="" coords="213,740,371,767"/>
<area shape="rect" href="namespacederived.html#a8bc196f7dfb365c426b0b7e720e479e2" title=" " alt="" coords="213,791,371,817"/>
<area shape="rect" href="ERF__MicrophysicsUtils_8H.html#a16a390366e7e68ca35fdac4cad824428" title=" " alt="" coords="494,867,581,893"/>
<area shape="rect" href="ERF__MicrophysicsUtils_8H.html#a8e4b0c6ed8b95c2040dc0c9e8fcb8615" title=" " alt="" coords="249,841,335,868"/>
<area shape="rect" href="ERF__ReadBndryPlanes_8cpp.html#a63d3125f6fd361f61d697799f46da817" title=" " alt="" coords="263,943,321,969"/>
<area shape="rect" href="ERF__NCPlotFile_8cpp.html#ad9a51088de1000816aac4e945c877b84" title=" " alt="" coords="231,993,353,1020"/>
<area shape="rect" href="ERF__TerrainMetrics_8H.html#a48f57e72ac183fdf1a984f58f3d24ee0" title=" " alt="" coords="443,56,632,83"/>
<area shape="rect" href="classeb__.html#af4353f7a064c08410ba9cb82e67be66f" title=" " alt="" coords="445,107,629,133"/>
<area shape="rect" href="classeb__.html#abfdaa6b21118610551e115d123390be9" title=" " alt="" coords="445,157,629,184"/>
<area shape="rect" href="classeb__.html#a3073f9ff05faf3d2351395ef6d293dae" title=" " alt="" coords="444,5,631,32"/>
<area shape="rect" href="namespacederived.html#a3786c6a8399bc2508bc129337c446af1" title=" " alt="" coords="444,487,631,513"/>
<area shape="rect" href="ERF__MicrophysicsUtils_8H.html#afac5e7caca80647972b208a0248b2ed8" title=" " alt="" coords="716,867,823,893"/>
<area shape="rect" href="classncutils_1_1NCFile.html#a6607bd5f3f75b451e2436ff713931f19" title=" " alt="" coords="441,993,633,1020"/>
<area shape="rect" href="classncutils_1_1NCGroup.html#a3d53c2f625cc6fc286e76c9137b5b1b0" title="Name of this group." alt="" coords="681,1019,857,1045"/>
<area shape="rect" href="classncutils_1_1NCFile.html#aec0e1a7f0f93f2f806c0a0abaae66423" title=" " alt="" coords="687,968,852,995"/>
</map>
</div>

</div>
</div>
<a id="a3849ef0f90b5798c571259313a3d501a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3849ef0f90b5798c571259313a3d501a">&#9670;&nbsp;</a></span>WriteSubvolume()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::WriteSubvolume </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;{</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    ParmParse <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>(<span class="stringliteral">&quot;erf.subvol&quot;</span>);</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160; </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    Vector&lt;Real&gt; origin;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    Vector&lt; int&gt; ncell;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    Vector&lt;Real&gt; delta;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <span class="comment">// **************************************************************</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <span class="comment">// Read in the origin, number of cells in each dir, and resolution</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <span class="comment">// **************************************************************</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.getarr(<span class="stringliteral">&quot;origin&quot;</span>,origin,0,AMREX_SPACEDIM);</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.getarr(<span class="stringliteral">&quot;nxnynz&quot;</span>, ncell,0,AMREX_SPACEDIM);</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.getarr(<span class="stringliteral">&quot;dxdydz&quot;</span>, delta,0,AMREX_SPACEDIM);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160; </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="keywordtype">int</span> lev_for_sub = 0;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="keywordtype">bool</span> found = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= finest_level; i++) {</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        <span class="keywordflow">if</span> (!found) {</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;            <span class="keywordflow">if</span> (almostEqual(delta[0],geom[i].CellSize(0)) &amp;&amp;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;                almostEqual(delta[1],geom[i].CellSize(1)) &amp;&amp;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;                almostEqual(delta[2],geom[i].CellSize(2)) ) {</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;                <span class="comment">// amrex::Print() &lt;&lt; &quot;XDIR &quot; &lt;&lt; delta[0] &lt;&lt; &quot; &quot; &lt;&lt; geom[i].CellSize(0) &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;                <span class="comment">// amrex::Print() &lt;&lt; &quot;YDIR &quot; &lt;&lt; delta[1] &lt;&lt; &quot; &quot; &lt;&lt; geom[i].CellSize(1) &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;                <span class="comment">// amrex::Print() &lt;&lt; &quot;ZDIR &quot; &lt;&lt; delta[2] &lt;&lt; &quot; &quot; &lt;&lt; geom[i].CellSize(2) &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;                amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Resolution specified matches that of level &quot;</span> &lt;&lt; i &lt;&lt; std::endl;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;                found = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;                lev_for_sub = i;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;            }</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        }</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    }</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keywordflow">if</span> (!found) {</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        amrex::Abort(<span class="stringliteral">&quot;Resolution specified for subvol does not match the resolution of any of the levels.&quot;</span>);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    }</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="comment">// **************************************************************</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="comment">// Now that we know which level we&#39;re at, we can figure out which (i,j,k) the origin corresponds to</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="comment">// Note we use 1.0001 as a fudge factor since the division of two reals --&gt; integer will do a floor</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="comment">// **************************************************************</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordtype">int</span> i0 = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>((origin[0] - geom[lev_for_sub].ProbLo(0)) * 1.0001 / delta[0]);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordtype">int</span> j0 = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>((origin[1] - geom[lev_for_sub].ProbLo(1)) * 1.0001 / delta[1]);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordtype">int</span> k0 = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>((origin[2] - geom[lev_for_sub].ProbLo(2)) * 1.0001 / delta[2]);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    found = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordflow">if</span> (almostEqual(geom[lev_for_sub].ProbLo(0)+i0*delta[0],origin[0]) &amp;&amp;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        almostEqual(geom[lev_for_sub].ProbLo(1)+j0*delta[1],origin[1]) &amp;&amp;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        almostEqual(geom[lev_for_sub].ProbLo(2)+k0*delta[2],origin[2]) )</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    {</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Specified origin is the lower left corner of cell &quot;</span> &lt;&lt; IntVect(i0,j0,k0) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        found = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    }</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keywordflow">if</span> (!found) {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        amrex::Abort(<span class="stringliteral">&quot;Origin specified does not correspond to a node at this level.&quot;</span>);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    }</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    Box domain(geom[lev_for_sub].Domain());</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    Box bx(IntVect(i0,j0,k0),IntVect(i0+ncell[0]-1,j0+ncell[1]-1,k0+ncell[2]-1));</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    amrex::Print() &lt;&lt; <span class="stringliteral">&quot;Box requested is &quot;</span> &lt;&lt; bx &lt;&lt; std::endl;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordflow">if</span> (!domain.contains(bx))</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        amrex::Abort(<span class="stringliteral">&quot;Box requested is larger than the existing domain&quot;</span>);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    Vector&lt;int&gt; <a class="code" href="namespacemodule__mp__morr__two__moment.html#a1b93ac76a23f50acf188ad96083d3517">cs</a>(3);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keywordtype">int</span> count = <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.countval(<span class="stringliteral">&quot;chunk_size&quot;</span>);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keywordflow">if</span> (count &gt; 0) {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <a class="code" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469">pp</a>.queryarr(<span class="stringliteral">&quot;chunk_size&quot;</span>,<a class="code" href="namespacemodule__mp__morr__two__moment.html#a1b93ac76a23f50acf188ad96083d3517">cs</a>,0,AMREX_SPACEDIM);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <a class="code" href="namespacemodule__mp__morr__two__moment.html#a1b93ac76a23f50acf188ad96083d3517">cs</a>[0] = max_grid_size[0][0];</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <a class="code" href="namespacemodule__mp__morr__two__moment.html#a1b93ac76a23f50acf188ad96083d3517">cs</a>[1] = max_grid_size[0][1];</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <a class="code" href="namespacemodule__mp__morr__two__moment.html#a1b93ac76a23f50acf188ad96083d3517">cs</a>[2] = max_grid_size[0][2];</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    }</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    IntVect chunk_size(<a class="code" href="namespacemodule__mp__morr__two__moment.html#a1b93ac76a23f50acf188ad96083d3517">cs</a>[0],<a class="code" href="namespacemodule__mp__morr__two__moment.html#a1b93ac76a23f50acf188ad96083d3517">cs</a>[1],<a class="code" href="namespacemodule__mp__morr__two__moment.html#a1b93ac76a23f50acf188ad96083d3517">cs</a>[2]);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    BoxArray ba(bx);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    ba.maxSize(chunk_size);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    amrex::Print() &lt;&lt; <span class="stringliteral">&quot;BoxArray is &quot;</span> &lt;&lt; ba &lt;&lt; std::endl;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordtype">int</span> ncomp_mf = AMREX_SPACEDIM;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    DistributionMapping dm(ba);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    MultiFab mf(ba, dm, ncomp_mf, 0);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    MultiFab mf_cc_vel(grids[lev_for_sub], dmap[lev_for_sub], ncomp_mf, 0);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    average_face_to_cellcenter(mf_cc_vel,0,</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                               Array&lt;const MultiFab*,3&gt;{&amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev_for_sub][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a2a10a6e726515894b07621908abd4c0c">Vars::xvel</a>],</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                                                        &amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev_for_sub][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a81793b83204cfa56d4683bc676fbbfb6">Vars::yvel</a>],</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                                                        &amp;<a class="code" href="classERF.html#a1204ca4dc5d79f5da191ffbe09dfab9b">vars_new</a>[lev_for_sub][<a class="code" href="namespaceVars.html#a3e5e550795a0b745a4e43177e81f8c57a48ee63b17bc216e9661511c33c68bd8b">Vars::zvel</a>]});</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    mf.ParallelCopy(mf_cc_vel,0,0,AMREX_SPACEDIM,0,0);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    std::string subvol_filename = Concatenate(<a class="code" href="classERF.html#a9183a64262ae944d9b3968c57de9652f">subvol_file</a>, <a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[0], 5);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    Vector&lt;std::string&gt; varnames;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    varnames.push_back(<span class="stringliteral">&quot;x_velocity&quot;</span>);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    varnames.push_back(<span class="stringliteral">&quot;y_velocity&quot;</span>);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    varnames.push_back(<span class="stringliteral">&quot;z_velocity&quot;</span>);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    Real time = <a class="code" href="classERF.html#a65741b6379d273c19a25cf48bb947614">t_new</a>[lev_for_sub];</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    amrex::Print() &lt;&lt;<span class="stringliteral">&quot;Writing subvolume into &quot;</span> &lt;&lt; subvol_filename &lt;&lt; std::endl;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    WriteSingleLevelPlotfile(subvol_filename,mf,varnames,geom[lev_for_sub],time,<a class="code" href="classERF.html#aefa640a036c25b7b770e88a5f838eb2a">istep</a>[0]);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;}</div>
<div class="ttc" id="anamespacemodule__mp__morr__two__moment_html_a1b93ac76a23f50acf188ad96083d3517"><div class="ttname"><a href="namespacemodule__mp__morr__two__moment.html#a1b93ac76a23f50acf188ad96083d3517">module_mp_morr_two_moment::cs</a></div><div class="ttdeci">real(c_double), private cs</div><div class="ttdef"><b>Definition:</b> ERF_module_mp_morr_two_moment.F90:202</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classERF_a3849ef0f90b5798c571259313a3d501a_cgraph.png" border="0" usemap="#aclassERF_a3849ef0f90b5798c571259313a3d501a_cgraph" alt=""/></div>
<map name="aclassERF_a3849ef0f90b5798c571259313a3d501a_cgraph" id="aclassERF_a3849ef0f90b5798c571259313a3d501a_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,168,32"/>
<area shape="rect" href="ERF__MicrophysicsUtils_8H.html#ac54f1d17d8842acb42b2312cd353e469" title=" " alt="" coords="216,5,255,32"/>
</map>
</div>

</div>
</div>
<a id="ad3613d455e3c246e5addf88054fa41db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3613d455e3c246e5addf88054fa41db">&#9670;&nbsp;</a></span>WriteVTKPolyline()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERF::WriteVTKPolyline </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">amrex::Vector&lt; std::array&lt; amrex::Real, 2 &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>points_xy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;{</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    std::ofstream vtkfile(filename);</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="keywordflow">if</span> (!vtkfile.is_open()) {</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        std::cerr &lt;&lt; <span class="stringliteral">&quot;Error: Cannot open file &quot;</span> &lt;&lt; filename &lt;&lt; std::endl;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    }</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160; </div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="keywordtype">int</span> num_points = points_xy.size();</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="keywordflow">if</span> (num_points == 0) {</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        vtkfile &lt;&lt; <span class="stringliteral">&quot;# vtk DataFile Version 3.0\n&quot;</span>;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        vtkfile &lt;&lt; <span class="stringliteral">&quot;Hurricane Track\n&quot;</span>;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        vtkfile &lt;&lt; <span class="stringliteral">&quot;ASCII\n&quot;</span>;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        vtkfile &lt;&lt; <span class="stringliteral">&quot;DATASET POLYDATA\n&quot;</span>;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        vtkfile &lt;&lt; <span class="stringliteral">&quot;POINTS &quot;</span> &lt;&lt; num_points &lt;&lt; <span class="stringliteral">&quot; float\n&quot;</span>;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        vtkfile.close();</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    }</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    <span class="keywordflow">if</span> (num_points &lt; 2) {</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        points_xy.push_back(points_xy[0]);</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    }</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    num_points = points_xy.size();</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160; </div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    vtkfile &lt;&lt; <span class="stringliteral">&quot;# vtk DataFile Version 3.0\n&quot;</span>;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    vtkfile &lt;&lt; <span class="stringliteral">&quot;Hurricane Track\n&quot;</span>;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    vtkfile &lt;&lt; <span class="stringliteral">&quot;ASCII\n&quot;</span>;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    vtkfile &lt;&lt; <span class="stringliteral">&quot;DATASET POLYDATA\n&quot;</span>;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160; </div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="comment">// Write points (Z=0 assumed)</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    vtkfile &lt;&lt; <span class="stringliteral">&quot;POINTS &quot;</span> &lt;&lt; num_points &lt;&lt; <span class="stringliteral">&quot; float\n&quot;</span>;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; pt : points_xy) {</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        vtkfile &lt;&lt; pt[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; pt[1] &lt;&lt; <span class="stringliteral">&quot; 10000.0\n&quot;</span>;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    }</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160; </div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="comment">// Write polyline connectivity</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    vtkfile &lt;&lt; <span class="stringliteral">&quot;LINES 1 &quot;</span> &lt;&lt; num_points + 1 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    vtkfile &lt;&lt; num_points &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num_points; ++i) {</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        vtkfile &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    }</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    vtkfile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160; </div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    vtkfile.close();</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a86a0bc8e41668411ee0ab5801d4688a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86a0bc8e41668411ee0ab5801d4688a7">&#9670;&nbsp;</a></span>advflux_reg</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::YAFluxRegister*&gt; ERF::advflux_reg</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classERF.html#a4d6d990d8111c170692b1e9cc0e918b8">getAdvFluxReg()</a>.</p>

</div>
</div>
<a id="a93bc9185c89cbeaceffaf40b8cf4a75c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93bc9185c89cbeaceffaf40b8cf4a75c">&#9670;&nbsp;</a></span>ax</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::ax</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="abe77a4434d27561109ffc666546511dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe77a4434d27561109ffc666546511dc">&#9670;&nbsp;</a></span>ax_src</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::ax_src</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ade870f983d113c64406bdcb8a9194044"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade870f983d113c64406bdcb8a9194044">&#9670;&nbsp;</a></span>ay</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::ay</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aa20bd15dbe2c801bda2d3bfdb5b81eab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa20bd15dbe2c801bda2d3bfdb5b81eab">&#9670;&nbsp;</a></span>ay_src</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::ay_src</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a391914523e66645f7e947cefcd19c011"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a391914523e66645f7e947cefcd19c011">&#9670;&nbsp;</a></span>az</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::az</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ad2d8e37fbdac323eda857e0b8c151852"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2d8e37fbdac323eda857e0b8c151852">&#9670;&nbsp;</a></span>az_src</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::az_src</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a8c051cb96bfa9ff26929441978aa2a96"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c051cb96bfa9ff26929441978aa2a96">&#9670;&nbsp;</a></span>ba1d</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::BoxArray&gt; ERF::ba1d</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a268a79187ae9a115e601957f8b06cd42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a268a79187ae9a115e601957f8b06cd42">&#9670;&nbsp;</a></span>ba2d</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::BoxArray&gt; ERF::ba2d</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a4c1fae5e620fcd64cc9ede73715e3b7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c1fae5e620fcd64cc9ede73715e3b7c">&#9670;&nbsp;</a></span>base_state</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::MultiFab&gt; ERF::base_state</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a37b2a4257df8ff53d4450de47f16ace1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37b2a4257df8ff53d4450de47f16ace1">&#9670;&nbsp;</a></span>base_state_new</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::MultiFab&gt; ERF::base_state_new</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aab4575d8fb57595a2f1aaf088c60447a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab4575d8fb57595a2f1aaf088c60447a">&#9670;&nbsp;</a></span>bndry_output_planes_interval</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::bndry_output_planes_interval = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a5f99e949c83d86507e003ae556cf7c22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f99e949c83d86507e003ae556cf7c22">&#9670;&nbsp;</a></span>bndry_output_planes_per</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Real ERF::bndry_output_planes_per = -1.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a87e58f16f44a6cb35d6983ed3fe7d3c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87e58f16f44a6cb35d6983ed3fe7d3c1">&#9670;&nbsp;</a></span>bndry_output_planes_start_time</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Real ERF::bndry_output_planes_start_time = 0.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a050dbd236c9bf246554a53008e09f683"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a050dbd236c9bf246554a53008e09f683">&#9670;&nbsp;</a></span>boxes_at_level</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Vector&lt;amrex::Box&gt; &gt; ERF::boxes_at_level</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a1e3e2855b6e811596226c167573ad62d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e3e2855b6e811596226c167573ad62d">&#9670;&nbsp;</a></span>cf_set_width</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::cf_set_width {0}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ad9084179f7384e10a519989ffd51fd34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9084179f7384e10a519989ffd51fd34">&#9670;&nbsp;</a></span>cf_width</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::cf_width {0}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a89f605d1a1eae06a7c79f9b6b65c637f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89f605d1a1eae06a7c79f9b6b65c637f">&#9670;&nbsp;</a></span>cfl</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Real ERF::cfl = 0.8</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ae16d413b172bb3b3400af6d5cb236fd4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae16d413b172bb3b3400af6d5cb236fd4">&#9670;&nbsp;</a></span>change_max</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Real ERF::change_max = 1.1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ae701564fbe3da5bbd88587e5a08eca4e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae701564fbe3da5bbd88587e5a08eca4e">&#9670;&nbsp;</a></span>check_file</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ERF::check_file {&quot;chk&quot;}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a48bba6b1c1b39940b09aefbe56311e2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48bba6b1c1b39940b09aefbe56311e2f">&#9670;&nbsp;</a></span>column_file_name</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ERF::column_file_name = &quot;column_data.nc&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="afa0bef6d3146788302b81c0d4f4802d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa0bef6d3146788302b81c0d4f4802d1">&#9670;&nbsp;</a></span>column_interval</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::column_interval = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a930b7d48218b3fc41d8719b50b3f6086"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a930b7d48218b3fc41d8719b50b3f6086">&#9670;&nbsp;</a></span>column_loc_x</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Real ERF::column_loc_x = 0.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a2b911f3a5a324813b1ff4462df6044a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b911f3a5a324813b1ff4462df6044a6">&#9670;&nbsp;</a></span>column_loc_y</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Real ERF::column_loc_y = 0.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a7b0175190c6fcf829c7f2841f729b12a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b0175190c6fcf829c7f2841f729b12a">&#9670;&nbsp;</a></span>column_per</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Real ERF::column_per = -1.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="afd8cd5a477754776135befa668fdd0c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd8cd5a477754776135befa668fdd0c9">&#9670;&nbsp;</a></span>cons_names</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const amrex::Vector&lt;std::string&gt; ERF::cons_names</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">{<span class="stringliteral">&quot;density&quot;</span>, <span class="stringliteral">&quot;rhotheta&quot;</span>, <span class="stringliteral">&quot;rhoKE&quot;</span>, <span class="stringliteral">&quot;rhoadv_0&quot;</span>,</div>
<div class="line">                                                     <span class="stringliteral">&quot;rhoQ1&quot;</span>, <span class="stringliteral">&quot;rhoQ2&quot;</span>, <span class="stringliteral">&quot;rhoQ3&quot;</span>,</div>
<div class="line">                                                     <span class="stringliteral">&quot;rhoQ4&quot;</span>, <span class="stringliteral">&quot;rhoQ5&quot;</span>, <span class="stringliteral">&quot;rhoQ6&quot;</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad6a92272a5ad07f176892de07353f268"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6a92272a5ad07f176892de07353f268">&#9670;&nbsp;</a></span>cosPhi_m</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::cosPhi_m</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a84cf7616e7b3928f08f4bd56112db01e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84cf7616e7b3928f08f4bd56112db01e">&#9670;&nbsp;</a></span>d_havg_density</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Gpu::DeviceVector&lt;amrex::Real&gt; ERF::d_havg_density</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a9a4f076c56f31fbb5e68c09706605a05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a4f076c56f31fbb5e68c09706605a05">&#9670;&nbsp;</a></span>d_havg_pressure</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Gpu::DeviceVector&lt;amrex::Real&gt; ERF::d_havg_pressure</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a8199cc1ec38b9dfd47262ccc7df6a941"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8199cc1ec38b9dfd47262ccc7df6a941">&#9670;&nbsp;</a></span>d_havg_qc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Gpu::DeviceVector&lt;amrex::Real&gt; ERF::d_havg_qc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a2b0085123e02051ac4c2a72e9972e6ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b0085123e02051ac4c2a72e9972e6ee">&#9670;&nbsp;</a></span>d_havg_qv</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Gpu::DeviceVector&lt;amrex::Real&gt; ERF::d_havg_qv</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a20350959b7b3e252ee3a802e7998ca8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20350959b7b3e252ee3a802e7998ca8d">&#9670;&nbsp;</a></span>d_havg_temperature</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Gpu::DeviceVector&lt;amrex::Real&gt; ERF::d_havg_temperature</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ad598bde8e728479faaa7c2820096b47a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad598bde8e728479faaa7c2820096b47a">&#9670;&nbsp;</a></span>d_rayleigh_ptrs</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Vector&lt;amrex::Gpu::DeviceVector&lt;amrex::Real&gt; &gt; &gt; ERF::d_rayleigh_ptrs</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a838687881ef3626f932d0e95ceff0e53"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a838687881ef3626f932d0e95ceff0e53">&#9670;&nbsp;</a></span>d_rhoqt_src</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Gpu::DeviceVector&lt;amrex::Real&gt; &gt; ERF::d_rhoqt_src</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a0c1fdcfbc9cbd6cb13e41d1170b161f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c1fdcfbc9cbd6cb13e41d1170b161f8">&#9670;&nbsp;</a></span>d_rhotheta_src</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Gpu::DeviceVector&lt;amrex::Real&gt; &gt; ERF::d_rhotheta_src</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a3b9bcb54c278dfec6027e9727cc01bc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b9bcb54c278dfec6027e9727cc01bc5">&#9670;&nbsp;</a></span>d_sponge_ptrs</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Vector&lt;amrex::Gpu::DeviceVector&lt;amrex::Real&gt; &gt; &gt; ERF::d_sponge_ptrs</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ac020980af9dbf46be43dd9f7127c06da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac020980af9dbf46be43dd9f7127c06da">&#9670;&nbsp;</a></span>d_u_geos</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Gpu::DeviceVector&lt;amrex::Real&gt; &gt; ERF::d_u_geos</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a7d245afb7b3236b5967902f50bf9000b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d245afb7b3236b5967902f50bf9000b">&#9670;&nbsp;</a></span>d_v_geos</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Gpu::DeviceVector&lt;amrex::Real&gt; &gt; ERF::d_v_geos</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ac94ddee2f501dbcea2a516284b7119b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac94ddee2f501dbcea2a516284b7119b5">&#9670;&nbsp;</a></span>d_w_subsid</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Gpu::DeviceVector&lt;amrex::Real&gt; &gt; ERF::d_w_subsid</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a83ad7f8f4cf9920a6798f3b931355a2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83ad7f8f4cf9920a6798f3b931355a2f">&#9670;&nbsp;</a></span>data_sampler</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classSampleData.html">SampleData</a>&gt; ERF::data_sampler = nullptr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a1cade630b005dbcc0f644987ef3db287"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1cade630b005dbcc0f644987ef3db287">&#9670;&nbsp;</a></span>datalog</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;std::fstream&gt; &gt; ERF::datalog</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classERF.html#aa2c3ee1910008b828b9da79ccdfe3871">DataLog()</a>, <a class="el" href="classERF.html#ac1238c1616826c66df1dfd9076e6a3da">NumDataLogs()</a>, and <a class="el" href="classERF.html#a2486b49bb0d7917f812318822e42a03c">setRecordDataInfo()</a>.</p>

</div>
</div>
<a id="a9248a4eb025c2647e003f838cba52a21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9248a4eb025c2647e003f838cba52a21">&#9670;&nbsp;</a></span>datalogname</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::string&gt; ERF::datalogname</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classERF.html#a16e1f6b8bbb05ae738daf2abe626c159">DataLogName()</a>.</p>

</div>
</div>
<a id="a85bb96a0b6593ee192a04ceef62abdf6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85bb96a0b6593ee192a04ceef62abdf6">&#9670;&nbsp;</a></span>datetime_format</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::string ERF::datetime_format = &quot;%Y-%m-%d %H:%M:%S&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aefeb0bde962c9f53aba32e4ab59b4958"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aefeb0bde962c9f53aba32e4ab59b4958">&#9670;&nbsp;</a></span>datprecision</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const int ERF::datprecision = 6</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a8b1cdf332a93c6b0889fd309e43f9a91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b1cdf332a93c6b0889fd309e43f9a91">&#9670;&nbsp;</a></span>datwidth</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const int ERF::datwidth = 14</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ab33e7fff801543a43961ca6d7cac818f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab33e7fff801543a43961ca6d7cac818f">&#9670;&nbsp;</a></span>der_datalog</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;std::fstream&gt; &gt; ERF::der_datalog</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classERF.html#a07b6ef88ba692152c19381858e2a639e">DerDataLog()</a>, <a class="el" href="classERF.html#acf7926f64e3747680861aba9afe5d219">NumDerDataLogs()</a>, and <a class="el" href="classERF.html#a967434ca06be557118b7a4a27a0b6f1f">setRecordDerDataInfo()</a>.</p>

</div>
</div>
<a id="a9e7650abd3df579a98be0c750aa61ba8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e7650abd3df579a98be0c750aa61ba8">&#9670;&nbsp;</a></span>der_datalogname</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::string&gt; ERF::der_datalogname</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classERF.html#a686848a6c86017d484dc204cee7d979f">DerDataLogName()</a>.</p>

</div>
</div>
<a id="a9fc0f6e6ca35036d2e3a36dd42e66435"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fc0f6e6ca35036d2e3a36dd42e66435">&#9670;&nbsp;</a></span>derived_names</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const amrex::Vector&lt;std::string&gt; ERF::derived_names</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a65f19c55c8d3669445866a1c3bbb628d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65f19c55c8d3669445866a1c3bbb628d">&#9670;&nbsp;</a></span>destag_profiles</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool ERF::destag_profiles = true</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a30f8b851ed29d38695d44cff257f14e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30f8b851ed29d38695d44cff257f14e6">&#9670;&nbsp;</a></span>detJ_cc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::detJ_cc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ae39bf64c5306b1dd939d82d9df728daa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae39bf64c5306b1dd939d82d9df728daa">&#9670;&nbsp;</a></span>detJ_cc_new</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::detJ_cc_new</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a9a411e0ea9d9bdbfab957c8081229091"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a411e0ea9d9bdbfab957c8081229091">&#9670;&nbsp;</a></span>detJ_cc_src</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::detJ_cc_src</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ae5968f1bed602fa87cdd5cb7905b7e5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5968f1bed602fa87cdd5cb7905b7e5e">&#9670;&nbsp;</a></span>domain_bc_type</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Array&lt;std::string,2*AMREX_SPACEDIM&gt; ERF::domain_bc_type</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a574521986a6e403159f83c8b8123ba90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a574521986a6e403159f83c8b8123ba90">&#9670;&nbsp;</a></span>domain_bcs_type</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::BCRec&gt; ERF::domain_bcs_type</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a8a99e22b1111c803e31b4afd5fcdea60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a99e22b1111c803e31b4afd5fcdea60">&#9670;&nbsp;</a></span>domain_bcs_type_d</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Gpu::DeviceVector&lt;amrex::BCRec&gt; ERF::domain_bcs_type_d</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ad34bae243fdb6c3029f5abe4fb4bca2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad34bae243fdb6c3029f5abe4fb4bca2d">&#9670;&nbsp;</a></span>dt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Real&gt; ERF::dt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a3ec36cbd96abc7ac706fee7007ae9aeb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ec36cbd96abc7ac706fee7007ae9aeb">&#9670;&nbsp;</a></span>dt_max</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Real ERF::dt_max = 1e9</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ad4b3bb9d744fb5dde65a21951b86e132"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4b3bb9d744fb5dde65a21951b86e132">&#9670;&nbsp;</a></span>dt_max_initial</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Real ERF::dt_max_initial = 2.0e100</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a3cf7cb2e51eb7b69cb4079ffc6722459"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3cf7cb2e51eb7b69cb4079ffc6722459">&#9670;&nbsp;</a></span>dt_mri_ratio</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;long&gt; ERF::dt_mri_ratio</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a15db5266359edba700f523f16da303a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15db5266359edba700f523f16da303a7">&#9670;&nbsp;</a></span>dz_min</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Real&gt; ERF::dz_min</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a32317cbd11fb55fe60a00c0925189859"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a32317cbd11fb55fe60a00c0925189859">&#9670;&nbsp;</a></span>eb</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;<a class="el" href="classeb__.html">eb_</a>&gt; &gt; ERF::eb</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classERF.html#ad024dd413ab20e5d6f69c1f96e5b78a3">EBFactory()</a>, and <a class="el" href="classERF.html#a2ae1074c3047ab0eb8286f73f5d4be0e">get_eb()</a>.</p>

</div>
</div>
<a id="a327d704704abd516be19339cb2d226f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a327d704704abd516be19339cb2d226f9">&#9670;&nbsp;</a></span>eddyDiffs_lev</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::eddyDiffs_lev</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a83c244120a15f0d9b9bca54e93976428"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83c244120a15f0d9b9bca54e93976428">&#9670;&nbsp;</a></span>fine_mask</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::MultiFab ERF::fine_mask</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="af282e3bdfdad38a0b898ed567ea446ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af282e3bdfdad38a0b898ed567ea446ee">&#9670;&nbsp;</a></span>finished_wave</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool ERF::finished_wave = false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a393b540493795b8c6ee0f64634b8b815"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a393b540493795b8c6ee0f64634b8b815">&#9670;&nbsp;</a></span>fixed_dt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Real&gt; ERF::fixed_dt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a4f3f43c6304a0a3ae78c42d54c05ee26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f3f43c6304a0a3ae78c42d54c05ee26">&#9670;&nbsp;</a></span>fixed_fast_dt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Real&gt; ERF::fixed_fast_dt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ad2e1a979c0ad68e87eaee349beb7e9fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2e1a979c0ad68e87eaee349beb7e9fd">&#9670;&nbsp;</a></span>fixed_mri_dt_ratio</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::fixed_mri_dt_ratio = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a34160ca20fb400ee285664117cb80512"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34160ca20fb400ee285664117cb80512">&#9670;&nbsp;</a></span>FPr_c</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;<a class="el" href="classERFFillPatcher.html">ERFFillPatcher</a>&gt; ERF::FPr_c</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a0ef3455d5b4fc9a178e023b233d389a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ef3455d5b4fc9a178e023b233d389a4">&#9670;&nbsp;</a></span>FPr_u</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;<a class="el" href="classERFFillPatcher.html">ERFFillPatcher</a>&gt; ERF::FPr_u</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a1dc7086aec533a042e6033706845b0c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1dc7086aec533a042e6033706845b0c3">&#9670;&nbsp;</a></span>FPr_v</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;<a class="el" href="classERFFillPatcher.html">ERFFillPatcher</a>&gt; ERF::FPr_v</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ac9a11403c2238d0d1e7b65b2d100dbaf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9a11403c2238d0d1e7b65b2d100dbaf">&#9670;&nbsp;</a></span>FPr_w</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;<a class="el" href="classERFFillPatcher.html">ERFFillPatcher</a>&gt; ERF::FPr_w</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a29ce17220e488eb840abc53966c34d46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29ce17220e488eb840abc53966c34d46">&#9670;&nbsp;</a></span>gradp</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Vector&lt;amrex::MultiFab&gt; &gt; ERF::gradp</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a4dd7c603e65d230105a4f1e0afb4cf8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4dd7c603e65d230105a4f1e0afb4cf8a">&#9670;&nbsp;</a></span>h_havg_density</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Real&gt; ERF::h_havg_density</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a413293737b0021c97b50c62756561446"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a413293737b0021c97b50c62756561446">&#9670;&nbsp;</a></span>h_havg_pressure</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Real&gt; ERF::h_havg_pressure</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a45233bcc95ac50c112b7146595164a8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45233bcc95ac50c112b7146595164a8d">&#9670;&nbsp;</a></span>h_havg_qc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Real&gt; ERF::h_havg_qc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ae8de26569516b41e5dc3cbb3419e891c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8de26569516b41e5dc3cbb3419e891c">&#9670;&nbsp;</a></span>h_havg_qv</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Real&gt; ERF::h_havg_qv</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a9683c7b07c287e57856ee5a9c99917a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9683c7b07c287e57856ee5a9c99917a1">&#9670;&nbsp;</a></span>h_havg_temperature</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Real&gt; ERF::h_havg_temperature</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ad9939824ea7b7d06ab252fed28d5a911"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9939824ea7b7d06ab252fed28d5a911">&#9670;&nbsp;</a></span>h_rayleigh_ptrs</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Vector&lt; amrex::Vector&lt;amrex::Real&gt; &gt; &gt; ERF::h_rayleigh_ptrs</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a3c5eca26a28dda3a981b3581abadfca0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c5eca26a28dda3a981b3581abadfca0">&#9670;&nbsp;</a></span>h_rhoqt_src</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt; amrex::Vector&lt;amrex::Real&gt; &gt; ERF::h_rhoqt_src</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a87aad7caaf3b575734994b47628a2faf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87aad7caaf3b575734994b47628a2faf">&#9670;&nbsp;</a></span>h_rhotheta_src</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt; amrex::Vector&lt;amrex::Real&gt; &gt; ERF::h_rhotheta_src</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a20a0f0d26791321eb4bbba6baee9f159"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20a0f0d26791321eb4bbba6baee9f159">&#9670;&nbsp;</a></span>h_sponge_ptrs</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Vector&lt; amrex::Vector&lt;amrex::Real&gt; &gt; &gt; ERF::h_sponge_ptrs</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a911c70f76cf62f205a1ce152ec4cdb54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a911c70f76cf62f205a1ce152ec4cdb54">&#9670;&nbsp;</a></span>h_u_geos</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt; amrex::Vector&lt;amrex::Real&gt; &gt; ERF::h_u_geos</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a825daede57fae86805edffd85d5d9dab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a825daede57fae86805edffd85d5d9dab">&#9670;&nbsp;</a></span>h_v_geos</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt; amrex::Vector&lt;amrex::Real&gt; &gt; ERF::h_v_geos</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a1a5d0d0b4e8c196f56dfab98f245aff5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a5d0d0b4e8c196f56dfab98f245aff5">&#9670;&nbsp;</a></span>h_w_subsid</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt; amrex::Vector&lt;amrex::Real&gt; &gt; ERF::h_w_subsid</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a90e949ea154768582dd0aff3d691b0db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90e949ea154768582dd0aff3d691b0db">&#9670;&nbsp;</a></span>hurricane_track_xy</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::array&lt;amrex::Real, 2&gt; &gt; ERF::hurricane_track_xy</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aef05cf88e9e9d2b56112336761493977"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef05cf88e9e9d2b56112336761493977">&#9670;&nbsp;</a></span>Hwave</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::Hwave</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a11f2d48d9af9b8f4574975cae06838f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11f2d48d9af9b8f4574975cae06838f1">&#9670;&nbsp;</a></span>Hwave_onegrid</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::Hwave_onegrid</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ad353aa9e275612ff2110c5a1405c1176"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad353aa9e275612ff2110c5a1405c1176">&#9670;&nbsp;</a></span>init_shrink</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Real ERF::init_shrink = 1.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a2eb81c590271b429f132103c9af25830"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2eb81c590271b429f132103c9af25830">&#9670;&nbsp;</a></span>init_sounding_ideal</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool ERF::init_sounding_ideal = false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a80ad08512968ec45635df68abe66b1fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80ad08512968ec45635df68abe66b1fc">&#9670;&nbsp;</a></span>input_bndry_planes</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::input_bndry_planes = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a83572d8dfad51158945b4a5ab06b2f72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83572d8dfad51158945b4a5ab06b2f72">&#9670;&nbsp;</a></span>input_sounding_data</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structInputSoundingData.html">InputSoundingData</a> ERF::input_sounding_data</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a8cb877a46fd94b5294425299dcb9cbaf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8cb877a46fd94b5294425299dcb9cbaf">&#9670;&nbsp;</a></span>input_sponge_data</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structInputSpongeData.html">InputSpongeData</a> ERF::input_sponge_data</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a812912653fe0d8ab1342bfef4793dd0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a812912653fe0d8ab1342bfef4793dd0e">&#9670;&nbsp;</a></span>interpolation_type</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">StateInterpType ERF::interpolation_type</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aefa640a036c25b7b770e88a5f838eb2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aefa640a036c25b7b770e88a5f838eb2a">&#9670;&nbsp;</a></span>istep</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;int&gt; ERF::istep</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a02722d16f3c26efe590702200f1296d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02722d16f3c26efe590702200f1296d7">&#9670;&nbsp;</a></span>last_check_file_step</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::last_check_file_step</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a7d54d3f2317d06a8dfcde4f65cfc3e92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d54d3f2317d06a8dfcde4f65cfc3e92">&#9670;&nbsp;</a></span>last_plot_file_step_1</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::last_plot_file_step_1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a09017292c9943ac2ed20ce7ed5c3c767"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09017292c9943ac2ed20ce7ed5c3c767">&#9670;&nbsp;</a></span>last_plot_file_step_2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::last_plot_file_step_2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a8536c38a2a5f44a5719cad3c44d0d438"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8536c38a2a5f44a5719cad3c44d0d438">&#9670;&nbsp;</a></span>last_subvol</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::last_subvol</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a3f3e29874221e43e13e2a431e77e0e4e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f3e29874221e43e13e2a431e77e0e4e">&#9670;&nbsp;</a></span>lmask_lev</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Vector&lt;std::unique_ptr&lt;amrex::iMultiFab&gt; &gt; &gt; ERF::lmask_lev</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ae0e9a78f120ba632d78cbf23c97b851c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0e9a78f120ba632d78cbf23c97b851c">&#9670;&nbsp;</a></span>lsm</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classLandSurface.html">LandSurface</a> ERF::lsm</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ad03da3399e893728741fac33100ce476"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad03da3399e893728741fac33100ce476">&#9670;&nbsp;</a></span>lsm_data</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Vector&lt;amrex::MultiFab*&gt; &gt; ERF::lsm_data</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aa5f6a6ceae0087393f386649d8bbbc31"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5f6a6ceae0087393f386649d8bbbc31">&#9670;&nbsp;</a></span>lsm_flux</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Vector&lt;amrex::MultiFab*&gt; &gt; ERF::lsm_flux</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ad67b414a1a8b5bab6edeaf574f922825"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad67b414a1a8b5bab6edeaf574f922825">&#9670;&nbsp;</a></span>Lwave</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::Lwave</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a83473e4b18de294a8b97dcdbbf048551"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83473e4b18de294a8b97dcdbbf048551">&#9670;&nbsp;</a></span>Lwave_onegrid</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::Lwave_onegrid</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a27261ba76aa71f1ddbf87bca0ede579f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27261ba76aa71f1ddbf87bca0ede579f">&#9670;&nbsp;</a></span>m_bc_extdir_vals</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Array&lt;amrex::Array&lt;amrex::Real, AMREX_SPACEDIM*2&gt;, AMREX_SPACEDIM+<a class="el" href="ERF__IndexDefines_8H.html#a536619efb901de654431f987753ac67c">NBCVAR_max</a>&gt; ERF::m_bc_extdir_vals</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="af783df8719de2e72e347de5860f71528"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af783df8719de2e72e347de5860f71528">&#9670;&nbsp;</a></span>m_bc_neumann_vals</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Array&lt;amrex::Array&lt;amrex::Real, AMREX_SPACEDIM*2&gt;, AMREX_SPACEDIM+<a class="el" href="ERF__IndexDefines_8H.html#a536619efb901de654431f987753ac67c">NBCVAR_max</a>&gt; ERF::m_bc_neumann_vals</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a69a3f925e95ec4244b0257f9de16d65a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69a3f925e95ec4244b0257f9de16d65a">&#9670;&nbsp;</a></span>m_check_int</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::m_check_int = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a5fbf17cfc8d9e5b994783e05ec3594b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5fbf17cfc8d9e5b994783e05ec3594b2">&#9670;&nbsp;</a></span>m_check_per</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real ERF::m_check_per = -1.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="adb272adf862040a2f1a6226c57c35627"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb272adf862040a2f1a6226c57c35627">&#9670;&nbsp;</a></span>m_expand_plotvars_to_unif_rr</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool ERF::m_expand_plotvars_to_unif_rr = false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a8b181e6ed0bb62d79e4a62555210abc9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b181e6ed0bb62d79e4a62555210abc9">&#9670;&nbsp;</a></span>m_forest_drag</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;<a class="el" href="classForestDrag.html">ForestDrag</a>&gt; &gt; ERF::m_forest_drag</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a367a3daba5d844efbed84c52e647cea6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a367a3daba5d844efbed84c52e647cea6">&#9670;&nbsp;</a></span>m_plot_face_vels</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool ERF::m_plot_face_vels = false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a57cfb4bfead8525174646964992c7e69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57cfb4bfead8525174646964992c7e69">&#9670;&nbsp;</a></span>m_plot_int_1</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::m_plot_int_1 = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ad3311c9ceacd17f34bdb5e03cefa33b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3311c9ceacd17f34bdb5e03cefa33b3">&#9670;&nbsp;</a></span>m_plot_int_2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::m_plot_int_2 = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a3167adc9518cce649a90ab82e9f9c85d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3167adc9518cce649a90ab82e9f9c85d">&#9670;&nbsp;</a></span>m_plot_per_1</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real ERF::m_plot_per_1 = -1.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aff879a9c686293a10a3a03027b765c51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff879a9c686293a10a3a03027b765c51">&#9670;&nbsp;</a></span>m_plot_per_2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real ERF::m_plot_per_2 = -1.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="addf62bfc534515447b94e928ac0b7135"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addf62bfc534515447b94e928ac0b7135">&#9670;&nbsp;</a></span>m_r2d</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classReadBndryPlanes.html">ReadBndryPlanes</a>&gt; ERF::m_r2d = nullptr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a2420086cf8dc54d9507c40358930f521"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2420086cf8dc54d9507c40358930f521">&#9670;&nbsp;</a></span>m_subvol_int</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::m_subvol_int = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a595273f0f44d0e481a2da65263e5c2ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a595273f0f44d0e481a2da65263e5c2ae">&#9670;&nbsp;</a></span>m_subvol_per</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real ERF::m_subvol_per = -1.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ac50bb696daf587e13f9a1e57c687375e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac50bb696daf587e13f9a1e57c687375e">&#9670;&nbsp;</a></span>m_SurfaceLayer</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classSurfaceLayer.html">SurfaceLayer</a>&gt; ERF::m_SurfaceLayer = nullptr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aa53035f34ba133b86172e180abda4209"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa53035f34ba133b86172e180abda4209">&#9670;&nbsp;</a></span>m_w2d</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classWriteBndryPlanes.html">WriteBndryPlanes</a>&gt; ERF::m_w2d = nullptr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a07e1772db360d39195824a6237bca9aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07e1772db360d39195824a6237bca9aa">&#9670;&nbsp;</a></span>mapfac</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; &gt; ERF::mapfac</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a0634154e8e58379c495c3e7fe7c5e4d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0634154e8e58379c495c3e7fe7c5e4d6">&#9670;&nbsp;</a></span>max_step</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::max_step = std::numeric_limits&lt;int&gt;::max()</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a04831a5a6bf49d8386d362379db84358"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04831a5a6bf49d8386d362379db84358">&#9670;&nbsp;</a></span>metgrid_basic_linear</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool ERF::metgrid_basic_linear {false}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aaaa067c46e79ca3635d138750642b78d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaaa067c46e79ca3635d138750642b78d">&#9670;&nbsp;</a></span>metgrid_debug_dry</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool ERF::metgrid_debug_dry {false}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ab08081c75e6d926825071630f2adddab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab08081c75e6d926825071630f2adddab">&#9670;&nbsp;</a></span>metgrid_debug_isothermal</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool ERF::metgrid_debug_isothermal {false}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a079811bdd498e155326a851e0c12f850"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a079811bdd498e155326a851e0c12f850">&#9670;&nbsp;</a></span>metgrid_debug_msf</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool ERF::metgrid_debug_msf {false}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ad256f0610d54caef208e2b2569a5aa82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad256f0610d54caef208e2b2569a5aa82">&#9670;&nbsp;</a></span>metgrid_debug_psfc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool ERF::metgrid_debug_psfc {false}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a64c81ad5cd1b7d21c2e597b92596f113"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64c81ad5cd1b7d21c2e597b92596f113">&#9670;&nbsp;</a></span>metgrid_debug_quiescent</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool ERF::metgrid_debug_quiescent {false}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a8767bdb5ac5b0a796dc478dc417e1606"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8767bdb5ac5b0a796dc478dc417e1606">&#9670;&nbsp;</a></span>metgrid_force_sfc_k</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::metgrid_force_sfc_k {6}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a7eac012575590fe374a8d4b5d9061546"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7eac012575590fe374a8d4b5d9061546">&#9670;&nbsp;</a></span>metgrid_interp_theta</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool ERF::metgrid_interp_theta {false}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="af27fd93c086c23ab8c754e63e1a0c425"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af27fd93c086c23ab8c754e63e1a0c425">&#9670;&nbsp;</a></span>metgrid_order</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::metgrid_order {2}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a95182a17e10556dde659d4dd891a4ed3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95182a17e10556dde659d4dd891a4ed3">&#9670;&nbsp;</a></span>metgrid_proximity</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real ERF::metgrid_proximity {500.0}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a51e327479a5c37c694bbf14eb8bce94f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51e327479a5c37c694bbf14eb8bce94f">&#9670;&nbsp;</a></span>metgrid_retain_sfc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool ERF::metgrid_retain_sfc {false}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a8eb60483e48302db4706d3b90c0ae8e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8eb60483e48302db4706d3b90c0ae8e4">&#9670;&nbsp;</a></span>metgrid_use_below_sfc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool ERF::metgrid_use_below_sfc {true}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a5d2fe657db8c3614db3e797566a49d68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d2fe657db8c3614db3e797566a49d68">&#9670;&nbsp;</a></span>metgrid_use_sfc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool ERF::metgrid_use_sfc {true}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a8839af37a73c4c2e76bf978a05275ca9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8839af37a73c4c2e76bf978a05275ca9">&#9670;&nbsp;</a></span>mf_C1H</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::mf_C1H</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ad473e8e616ea3f7bf7bf922a0fe16208"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad473e8e616ea3f7bf7bf922a0fe16208">&#9670;&nbsp;</a></span>mf_C2H</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::mf_C2H</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aed4ae5792dd32adf56d3c052ce79437f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed4ae5792dd32adf56d3c052ce79437f">&#9670;&nbsp;</a></span>mf_MUB</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::mf_MUB</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a2c4e27d6b7928c7081f17e63d0834200"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c4e27d6b7928c7081f17e63d0834200">&#9670;&nbsp;</a></span>mg_verbose</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::mg_verbose = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a4b7277d54649219f31fe286eee9d415a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b7277d54649219f31fe286eee9d415a">&#9670;&nbsp;</a></span>micro</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classMicrophysics.html">Microphysics</a>&gt; ERF::micro</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a09d0fb2bd609c898a665d9530a744585"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09d0fb2bd609c898a665d9530a744585">&#9670;&nbsp;</a></span>mri_integrator_mem</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;<a class="el" href="classMRISplitIntegrator.html">MRISplitIntegrator</a>&lt;amrex::Vector&lt;amrex::MultiFab&gt; &gt; &gt; &gt; ERF::mri_integrator_mem</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a7e9040f32464f1a6dee6e0384393451d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e9040f32464f1a6dee6e0384393451d">&#9670;&nbsp;</a></span>nc_bdy_file</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ERF::nc_bdy_file</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a7ef14f6028b577eba70aef46b508be19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ef14f6028b577eba70aef46b508be19">&#9670;&nbsp;</a></span>nc_init_file</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Vector&lt; Vector&lt; std::string &gt; &gt; ERF::nc_init_file = {{&quot;&quot;}}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ad4c8a68d25ec78f9944bf3123fafd93e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4c8a68d25ec78f9944bf3123fafd93e">&#9670;&nbsp;</a></span>nc_low_file</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ERF::nc_low_file</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="addf0fb2aae0efaa649c69685a4dcca83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addf0fb2aae0efaa649c69685a4dcca83">&#9670;&nbsp;</a></span>ng_dens_hse</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::ng_dens_hse</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a87dc6c0720462bfd088c909289cdca0b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87dc6c0720462bfd088c909289cdca0b">&#9670;&nbsp;</a></span>ng_pres_hse</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::ng_pres_hse</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aa3db2dd1b65310c66c4038650c22aaee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3db2dd1b65310c66c4038650c22aaee">&#9670;&nbsp;</a></span>nsubsteps</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;int&gt; ERF::nsubsteps</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="adcd9f23975ffa605247b41d391c2a2f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adcd9f23975ffa605247b41d391c2a2f0">&#9670;&nbsp;</a></span>num_boxes_at_level</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;int&gt; ERF::num_boxes_at_level</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a610a988f46e0496e6dbd0471ae817f75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a610a988f46e0496e6dbd0471ae817f75">&#9670;&nbsp;</a></span>num_files_at_level</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;int&gt; ERF::num_files_at_level</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ad17ff2753e754ff3eb1330612b820b5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad17ff2753e754ff3eb1330612b820b5f">&#9670;&nbsp;</a></span>output_1d_column</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::output_1d_column = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a7c448670f7a5cadd6fe56f7e615c9eb6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c448670f7a5cadd6fe56f7e615c9eb6">&#9670;&nbsp;</a></span>output_bndry_planes</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::output_bndry_planes = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a52761522e295887435c10853d8c7dc37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52761522e295887435c10853d8c7dc37">&#9670;&nbsp;</a></span>pert_interval</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::pert_interval = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ae6df94c25ac21bf6a2e856a9901e3a15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6df94c25ac21bf6a2e856a9901e3a15">&#9670;&nbsp;</a></span>phys_bc_type</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::GpuArray&lt;<a class="el" href="ERF__IndexDefines_8H.html#adf340bf1893bad34b2bf452d987d86c9">ERF_BC</a>, AMREX_SPACEDIM*2&gt; ERF::phys_bc_type</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="af4e7dc93dae16aa2cc94bbb20b699a6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4e7dc93dae16aa2cc94bbb20b699a6f">&#9670;&nbsp;</a></span>physbcs_base</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;<a class="el" href="classERFPhysBCFunct__base.html">ERFPhysBCFunct_base</a>&gt; &gt; ERF::physbcs_base</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a2e9b04043853d25f2d76edbc0bed2e72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e9b04043853d25f2d76edbc0bed2e72">&#9670;&nbsp;</a></span>physbcs_cons</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;<a class="el" href="classERFPhysBCFunct__cons.html">ERFPhysBCFunct_cons</a>&gt; &gt; ERF::physbcs_cons</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a64e55e5ae9df06433146db657eb9e72e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64e55e5ae9df06433146db657eb9e72e">&#9670;&nbsp;</a></span>physbcs_u</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;<a class="el" href="classERFPhysBCFunct__u.html">ERFPhysBCFunct_u</a>&gt; &gt; ERF::physbcs_u</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a79231b5cfd4576a742e46ae0082b5121"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79231b5cfd4576a742e46ae0082b5121">&#9670;&nbsp;</a></span>physbcs_v</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;<a class="el" href="classERFPhysBCFunct__v.html">ERFPhysBCFunct_v</a>&gt; &gt; ERF::physbcs_v</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a45c8ecd777f47732993777a0afb8e140"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45c8ecd777f47732993777a0afb8e140">&#9670;&nbsp;</a></span>physbcs_w</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;<a class="el" href="classERFPhysBCFunct__w.html">ERFPhysBCFunct_w</a>&gt; &gt; ERF::physbcs_w</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aa54aaa938a18d34caa4d86e977647899"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa54aaa938a18d34caa4d86e977647899">&#9670;&nbsp;</a></span>plot_file_1</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ERF::plot_file_1 {&quot;plt_1_&quot;}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a18fa84b06132715757d97ec38678aa2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18fa84b06132715757d97ec38678aa2c">&#9670;&nbsp;</a></span>plot_file_2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ERF::plot_file_2 {&quot;plt_2_&quot;}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="adc00038dfe4c332e5d15f621184c69e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc00038dfe4c332e5d15f621184c69e8">&#9670;&nbsp;</a></span>plot_file_on_restart</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::plot_file_on_restart = 1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="afc653b103aa26c56acafed85cdd95f52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc653b103aa26c56acafed85cdd95f52">&#9670;&nbsp;</a></span>plot_lsm</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool ERF::plot_lsm = false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a34f2eb136e6747a7e6461fb95e50076e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34f2eb136e6747a7e6461fb95e50076e">&#9670;&nbsp;</a></span>plot_rad</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool ERF::plot_rad = false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a6865cf87abbb5aab0db00ff3b1ce94ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6865cf87abbb5aab0db00ff3b1ce94ac">&#9670;&nbsp;</a></span>plot_var_names_1</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::string&gt; ERF::plot_var_names_1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a79705c02d6f25fbdcec14ca2432e5da1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79705c02d6f25fbdcec14ca2432e5da1">&#9670;&nbsp;</a></span>plot_var_names_2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::string&gt; ERF::plot_var_names_2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a184511b7b9b7d4beef453f5d5d679c54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a184511b7b9b7d4beef453f5d5d679c54">&#9670;&nbsp;</a></span>plotfile_type_1</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PlotFileType ERF::plotfile_type_1 = PlotFileType::None</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a980e94505df2ee0925612b004126df77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a980e94505df2ee0925612b004126df77">&#9670;&nbsp;</a></span>plotfile_type_2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PlotFileType ERF::plotfile_type_2 = PlotFileType::None</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a0c5206542d4193bb687f5271be6fe5e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c5206542d4193bb687f5271be6fe5e5">&#9670;&nbsp;</a></span>pp_inc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::MultiFab&gt; ERF::pp_inc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a59df30e7a5537c8543bb00772bd98b58"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59df30e7a5537c8543bb00772bd98b58">&#9670;&nbsp;</a></span>pp_prefix</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string ERF::pp_prefix {&quot;erf&quot;}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a1f412097e565c23acb4c17c67db10e22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f412097e565c23acb4c17c67db10e22">&#9670;&nbsp;</a></span>previousCPUTimeUsed</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Real ERF::previousCPUTimeUsed = 0.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classERF.html#ae0597da6edf955cd138e52fd00380ff2">getCPUTime()</a>.</p>

</div>
</div>
<a id="a60e8cb933f237903e3fbcd6376c26db0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60e8cb933f237903e3fbcd6376c26db0">&#9670;&nbsp;</a></span>prob</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classProblemBase.html">ProblemBase</a>&gt; ERF::prob = nullptr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a633cd0b44d2e38f02c23e953aecd69eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a633cd0b44d2e38f02c23e953aecd69eb">&#9670;&nbsp;</a></span>profile_int</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::profile_int = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="afa4c3753628a106460dbb708277de511"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa4c3753628a106460dbb708277de511">&#9670;&nbsp;</a></span>qheating_rates</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::qheating_rates</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ae00126a9c2738bf6a6cbbe77321c9cfc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae00126a9c2738bf6a6cbbe77321c9cfc">&#9670;&nbsp;</a></span>qmoist</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Vector&lt;amrex::MultiFab*&gt; &gt; ERF::qmoist</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a57d8432920785f8e58cf11a3232d76b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57d8432920785f8e58cf11a3232d76b5">&#9670;&nbsp;</a></span>Qr_prim</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::Qr_prim</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a521d1faf157e3bccc86c0f26ee923576"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a521d1faf157e3bccc86c0f26ee923576">&#9670;&nbsp;</a></span>Qv_prim</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::Qv_prim</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a609b41a1de9c6b28f23dcdc6843f9ef5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a609b41a1de9c6b28f23dcdc6843f9ef5">&#9670;&nbsp;</a></span>rad</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;<a class="el" href="classIRadiation.html">IRadiation</a>&gt; &gt; ERF::rad</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a9194db6f65f3cfa366010648eaa4affd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9194db6f65f3cfa366010648eaa4affd">&#9670;&nbsp;</a></span>rad_datalog_int</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::rad_datalog_int = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="acab120bb9324e7298534d765c447d703"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acab120bb9324e7298534d765c447d703">&#9670;&nbsp;</a></span>real_set_width</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::real_set_width {0}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="abb15119348ad5399947bc8883084b230"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb15119348ad5399947bc8883084b230">&#9670;&nbsp;</a></span>real_width</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::real_width {0}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ac81b3dfd7c6f21ba8479834e2ff1e652"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac81b3dfd7c6f21ba8479834e2ff1e652">&#9670;&nbsp;</a></span>ref_tags</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Vector&lt; AMRErrorTag &gt; ERF::ref_tags</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a3937527f96c81674fa38dc34ed24f3f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3937527f96c81674fa38dc34ed24f3f5">&#9670;&nbsp;</a></span>regrid_int</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::regrid_int = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a833c301baf4bb3ee3c944faad7bf6ee7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a833c301baf4bb3ee3c944faad7bf6ee7">&#9670;&nbsp;</a></span>regrid_level_0_on_restart</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool ERF::regrid_level_0_on_restart = false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a8e758060d3dede9694fbfcabddc17169"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e758060d3dede9694fbfcabddc17169">&#9670;&nbsp;</a></span>restart_chkfile</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ERF::restart_chkfile = &quot;&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a01f3db32272f53dc68025f0a98195e57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01f3db32272f53dc68025f0a98195e57">&#9670;&nbsp;</a></span>rU_new</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::MultiFab&gt; ERF::rU_new</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a6eecc44323f77917c95869928284f61d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6eecc44323f77917c95869928284f61d">&#9670;&nbsp;</a></span>rU_old</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::MultiFab&gt; ERF::rU_old</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a54e37988486ef96e55e84bd8e91bb688"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54e37988486ef96e55e84bd8e91bb688">&#9670;&nbsp;</a></span>rV_new</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::MultiFab&gt; ERF::rV_new</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aeb64e3b4def989ce68d873aefeed5e0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb64e3b4def989ce68d873aefeed5e0e">&#9670;&nbsp;</a></span>rV_old</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::MultiFab&gt; ERF::rV_old</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aa46c0b0d20525aed10f447923e54dde7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa46c0b0d20525aed10f447923e54dde7">&#9670;&nbsp;</a></span>rW_new</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::MultiFab&gt; ERF::rW_new</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ac1fa56ec90f44e3cdf487af46804163f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1fa56ec90f44e3cdf487af46804163f">&#9670;&nbsp;</a></span>rW_old</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::MultiFab&gt; ERF::rW_old</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a0fa1582bb13357895d2aba91b695624a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0fa1582bb13357895d2aba91b695624a">&#9670;&nbsp;</a></span>sampleline</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::IntVect&gt; ERF::sampleline</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classERF.html#a70d78ca624acf09d8faab9a2d51264d9">NumSampleLines()</a>, and <a class="el" href="classERF.html#a54357e2f81f3d7d3a9189a3e21283e6b">SampleLine()</a>.</p>

</div>
</div>
<a id="a4990f1796b65ec8ee602f177a66afc3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4990f1796b65ec8ee602f177a66afc3e">&#9670;&nbsp;</a></span>samplelinelog</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;std::fstream&gt; &gt; ERF::samplelinelog</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classERF.html#a14f922bdc3a0f23c087afa32c67ac119">NumSampleLineLogs()</a>, <a class="el" href="classERF.html#aa559426d0435e669b04148c58b20caef">SampleLineLog()</a>, and <a class="el" href="classERF.html#ae1a8856961aaee53016122facba03dbe">setRecordSampleLineInfo()</a>.</p>

</div>
</div>
<a id="a0553967f1131860bb8ecb47c0f192eaa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0553967f1131860bb8ecb47c0f192eaa">&#9670;&nbsp;</a></span>samplelinelogname</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::string&gt; ERF::samplelinelogname</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classERF.html#a59eae161173111d66e88dc3acc65b552">SampleLineLogName()</a>.</p>

</div>
</div>
<a id="ae8a57b7fbf5a67c99d04b7d4f43ad100"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8a57b7fbf5a67c99d04b7d4f43ad100">&#9670;&nbsp;</a></span>samplepoint</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::IntVect&gt; ERF::samplepoint</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classERF.html#a5bc7dd2c7e1ebf65b7dc1d9bf0dfb36f">NumSamplePoints()</a>, and <a class="el" href="classERF.html#a9095d1b641b4d7f32ca5acb679786891">SamplePoint()</a>.</p>

</div>
</div>
<a id="a9737ddb0de6b9e8a5b17c109d5ad3e08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9737ddb0de6b9e8a5b17c109d5ad3e08">&#9670;&nbsp;</a></span>sampleptlog</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;std::fstream&gt; &gt; ERF::sampleptlog</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classERF.html#a41324a4b5610fde725fe721550b23c85">NumSamplePointLogs()</a>, <a class="el" href="classERF.html#af5f6c32cc5463e52901f21117d3156c7">SamplePointLog()</a>, and <a class="el" href="classERF.html#af8d930dce1b926ecc3bdc6787dd47818">setRecordSamplePointInfo()</a>.</p>

</div>
</div>
<a id="a8fbfa8bb47c0a3b53e244081aa1e8ad3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8fbfa8bb47c0a3b53e244081aa1e8ad3">&#9670;&nbsp;</a></span>sampleptlogname</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::string&gt; ERF::sampleptlogname</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classERF.html#aa87242f053bfae4efb2a7698ef417ab9">SamplePointLogName()</a>.</p>

</div>
</div>
<a id="ad13532a7eebe8a7473dfe5ed9a828fe8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad13532a7eebe8a7473dfe5ed9a828fe8">&#9670;&nbsp;</a></span>sampler_interval</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::sampler_interval = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a8bfff875038f8c24055067117e192960"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8bfff875038f8c24055067117e192960">&#9670;&nbsp;</a></span>sampler_per</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real ERF::sampler_per = -1.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a6e1ad417e3bd062468d74830b65911fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e1ad417e3bd062468d74830b65911fb">&#9670;&nbsp;</a></span>SFS_diss_lev</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::SFS_diss_lev</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a25174b4ae6cfcac8f7d183ce5c9fe67b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25174b4ae6cfcac8f7d183ce5c9fe67b">&#9670;&nbsp;</a></span>SFS_hfx1_lev</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::SFS_hfx1_lev</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="acb607b2e675b45fdcabc09b640ce5ae2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb607b2e675b45fdcabc09b640ce5ae2">&#9670;&nbsp;</a></span>SFS_hfx2_lev</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::SFS_hfx2_lev</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a1a2e3faf5dd90ad2f9ded28b486f3b46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a2e3faf5dd90ad2f9ded28b486f3b46">&#9670;&nbsp;</a></span>SFS_hfx3_lev</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::SFS_hfx3_lev</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ae0316d5ae567a2da8439d204bace12ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0316d5ae567a2da8439d204bace12ce">&#9670;&nbsp;</a></span>SFS_q1fx1_lev</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::SFS_q1fx1_lev</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a53fab1172ec3f01356355f8cda0919fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53fab1172ec3f01356355f8cda0919fe">&#9670;&nbsp;</a></span>SFS_q1fx2_lev</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::SFS_q1fx2_lev</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a101ceb89b1a249efeea3f4e8052bc8c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a101ceb89b1a249efeea3f4e8052bc8c0">&#9670;&nbsp;</a></span>SFS_q1fx3_lev</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::SFS_q1fx3_lev</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a3ea10ef7383e594b6ee5e7a9ad67607b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ea10ef7383e594b6ee5e7a9ad67607b">&#9670;&nbsp;</a></span>SFS_q2fx3_lev</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::SFS_q2fx3_lev</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ab54f3fc49bad059469da4e34c82296a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab54f3fc49bad059469da4e34c82296a6">&#9670;&nbsp;</a></span>sinPhi_m</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::sinPhi_m</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a9faaa96a7c270d2b2b062d9f30f19711"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9faaa96a7c270d2b2b062d9f30f19711">&#9670;&nbsp;</a></span>SmnSmn_lev</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::SmnSmn_lev</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a69e6a357fd92f2c2ad9f6e0843372b16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69e6a357fd92f2c2ad9f6e0843372b16">&#9670;&nbsp;</a></span>solar_zenith</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::solar_zenith</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a32dd48049e8acbe95decdd4b01b782c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a32dd48049e8acbe95decdd4b01b782c4">&#9670;&nbsp;</a></span>solverChoice</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structSolverChoice.html">SolverChoice</a> ERF::solverChoice</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a6c570cbcb63ba3b0b09557537310ea46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c570cbcb63ba3b0b09557537310ea46">&#9670;&nbsp;</a></span>sponge_type</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ERF::sponge_type</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a5a5395054a212d8f3fc577562c14b66e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a5395054a212d8f3fc577562c14b66e">&#9670;&nbsp;</a></span>sst_lev</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; &gt; ERF::sst_lev</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aa0c07f31b23d977646b8161e5473fab5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0c07f31b23d977646b8161e5473fab5">&#9670;&nbsp;</a></span>start_time</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real ERF::start_time = 0.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a6d00e1cb76bfbcbada173e092b6accf3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d00e1cb76bfbcbada173e092b6accf3">&#9670;&nbsp;</a></span>startCPUTime</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Real ERF::startCPUTime = 0.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classERF.html#ae0597da6edf955cd138e52fd00380ff2">getCPUTime()</a>.</p>

</div>
</div>
<a id="a405556a52bef334ab68294c1a540e107"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a405556a52bef334ab68294c1a540e107">&#9670;&nbsp;</a></span>stop_time</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Real ERF::stop_time = std::numeric_limits&lt;amrex::Real&gt;::max()</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a6600f30f1043a4c5e62b5cdd05f0a99f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6600f30f1043a4c5e62b5cdd05f0a99f">&#9670;&nbsp;</a></span>stretched_dz_d</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Gpu::DeviceVector&lt;amrex::Real&gt; &gt; ERF::stretched_dz_d</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ad0981b0ff70e6d78acbb7769f7a142b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0981b0ff70e6d78acbb7769f7a142b7">&#9670;&nbsp;</a></span>stretched_dz_h</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Vector&lt;amrex::Real&gt; &gt; ERF::stretched_dz_h</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="addc2ee5eba2264ae2b2475970b0b8c2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addc2ee5eba2264ae2b2475970b0b8c2d">&#9670;&nbsp;</a></span>sub_cfl</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Real ERF::sub_cfl = 1.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a9183a64262ae944d9b3968c57de9652f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9183a64262ae944d9b3968c57de9652f">&#9670;&nbsp;</a></span>subvol_file</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ERF::subvol_file {&quot;subvol&quot;}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a5232e98479611a24fe97994640c61faa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5232e98479611a24fe97994640c61faa">&#9670;&nbsp;</a></span>sum_interval</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::sum_interval = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a1cf2ba396f4404724824516da4c4a084"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1cf2ba396f4404724824516da4c4a084">&#9670;&nbsp;</a></span>sum_per</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Real ERF::sum_per = -1.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a1a3799aabf8337159aa290946fef8404"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a3799aabf8337159aa290946fef8404">&#9670;&nbsp;</a></span>sw_lw_fluxes</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::sw_lw_fluxes</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a6837423e9248e923fcaa1987b59d8160"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6837423e9248e923fcaa1987b59d8160">&#9670;&nbsp;</a></span>t_avg_cnt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Real&gt; ERF::t_avg_cnt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a65741b6379d273c19a25cf48bb947614"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65741b6379d273c19a25cf48bb947614">&#9670;&nbsp;</a></span>t_new</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Real&gt; ERF::t_new</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a7085d7d5fc94a0f84efc06957267d58e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7085d7d5fc94a0f84efc06957267d58e">&#9670;&nbsp;</a></span>t_old</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Real&gt; ERF::t_old</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a3d4a3ed54fb357c02e6494461f182aa1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d4a3ed54fb357c02e6494461f182aa1">&#9670;&nbsp;</a></span>Tau</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; &gt; ERF::Tau</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a4a18cc3befd0911ccb011f9bb3b2efc2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a18cc3befd0911ccb011f9bb3b2efc2">&#9670;&nbsp;</a></span>terrain_blanking</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::terrain_blanking</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a67c86c65b27f8ceee58b5ca989116e14"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67c86c65b27f8ceee58b5ca989116e14">&#9670;&nbsp;</a></span>th_bc_data</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Gpu::DeviceVector&lt;amrex::Real&gt; &gt; ERF::th_bc_data</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a71629ae2fda396472198691b75d83b2e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71629ae2fda396472198691b75d83b2e">&#9670;&nbsp;</a></span>Theta_prim</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::Theta_prim</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a5b9b8d719a87a6940f611c6a30e8ccf5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b9b8d719a87a6940f611c6a30e8ccf5">&#9670;&nbsp;</a></span>thin_xforce</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::thin_xforce</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a18c1142552120bbd22987f34995ee939"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18c1142552120bbd22987f34995ee939">&#9670;&nbsp;</a></span>thin_yforce</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::thin_yforce</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a56a23d298bc66218bf257d0e793e341f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56a23d298bc66218bf257d0e793e341f">&#9670;&nbsp;</a></span>thin_zforce</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::thin_zforce</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a2307b817178b00e5cc38c0e163da0a39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2307b817178b00e5cc38c0e163da0a39">&#9670;&nbsp;</a></span>timeprecision</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const int ERF::timeprecision = 13</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ab546bcca3968440c6c24097f59b87f23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab546bcca3968440c6c24097f59b87f23">&#9670;&nbsp;</a></span>tot_e_datalog</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;std::fstream&gt; &gt; ERF::tot_e_datalog</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classERF.html#ac1a50d2d5abc5bd1d51417583184ac52">setRecordEnergyDataInfo()</a>.</p>

</div>
</div>
<a id="a7bba2a8c0e4d0a0d5a6478301bf6c3fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7bba2a8c0e4d0a0d5a6478301bf6c3fa">&#9670;&nbsp;</a></span>tot_e_datalogname</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::string&gt; ERF::tot_e_datalogname</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="af89fb8b555dde334c978cdfd3fcd9d07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af89fb8b555dde334c978cdfd3fcd9d07">&#9670;&nbsp;</a></span>tsk_lev</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; &gt; ERF::tsk_lev</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ac1b9cce4a3c1736c4af78f6b0e2143ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1b9cce4a3c1736c4af78f6b0e2143ce">&#9670;&nbsp;</a></span>turbPert</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structTurbulentPerturbation.html">TurbulentPerturbation</a> ERF::turbPert</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a90e3592862d7330b39a11399d34a3539"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90e3592862d7330b39a11399d34a3539">&#9670;&nbsp;</a></span>use_datetime</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool ERF::use_datetime = false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a35e6065478296fac62affbf8f53b8c23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35e6065478296fac62affbf8f53b8c23">&#9670;&nbsp;</a></span>use_fft</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool ERF::use_fft = false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a1204ca4dc5d79f5da191ffbe09dfab9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1204ca4dc5d79f5da191ffbe09dfab9b">&#9670;&nbsp;</a></span>vars_new</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Vector&lt;amrex::MultiFab&gt; &gt; ERF::vars_new</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="af31e928baa970a1507dfb0233b352542"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af31e928baa970a1507dfb0233b352542">&#9670;&nbsp;</a></span>vars_old</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Vector&lt;amrex::MultiFab&gt; &gt; ERF::vars_old</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a3e146164ca6929ec6d4984b6a3f43c81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e146164ca6929ec6d4984b6a3f43c81">&#9670;&nbsp;</a></span>vel_t_avg</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::vel_t_avg</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a43d0b17f6e155691a1e9474526df3af5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43d0b17f6e155691a1e9474526df3af5">&#9670;&nbsp;</a></span>verbose</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ERF::verbose = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a0276b556fdefec8b99be95846a3a35fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0276b556fdefec8b99be95846a3a35fe">&#9670;&nbsp;</a></span>walldist</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::walldist</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="af044f075df34caa2a530aa13e1801a5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af044f075df34caa2a530aa13e1801a5b">&#9670;&nbsp;</a></span>xflux_imask</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::iMultiFab&gt; &gt; ERF::xflux_imask</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a902f60d94be5eaf86361d1d5ad942105"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a902f60d94be5eaf86361d1d5ad942105">&#9670;&nbsp;</a></span>xvel_bc_data</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Gpu::DeviceVector&lt;amrex::Real&gt; &gt; ERF::xvel_bc_data</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aa4448d06a3e4fe9740927a636030939d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4448d06a3e4fe9740927a636030939d">&#9670;&nbsp;</a></span>yflux_imask</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::iMultiFab&gt; &gt; ERF::yflux_imask</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ae5e40fcd6dd76c80d0b5b09be5baef97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5e40fcd6dd76c80d0b5b09be5baef97">&#9670;&nbsp;</a></span>yvel_bc_data</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Gpu::DeviceVector&lt;amrex::Real&gt; &gt; ERF::yvel_bc_data</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a31be0f1ae705c52c8ccc520369013284"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31be0f1ae705c52c8ccc520369013284">&#9670;&nbsp;</a></span>z_phys_cc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::z_phys_cc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="abfa333375bd02a72cc80ba1e7552aba5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abfa333375bd02a72cc80ba1e7552aba5">&#9670;&nbsp;</a></span>z_phys_cc_src</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::z_phys_cc_src</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a93e63e5af35efa564fd4195e8703f84c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93e63e5af35efa564fd4195e8703f84c">&#9670;&nbsp;</a></span>z_phys_nd</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::z_phys_nd</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a4ef635c22e72c715f5703a6b95a7abe5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ef635c22e72c715f5703a6b95a7abe5">&#9670;&nbsp;</a></span>z_phys_nd_new</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::z_phys_nd_new</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a30dcf40e8f104fb6b6132805d2eff47c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30dcf40e8f104fb6b6132805d2eff47c">&#9670;&nbsp;</a></span>z_phys_nd_src</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::z_phys_nd_src</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a72a59614c6d5ab840b924c84d5682270"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72a59614c6d5ab840b924c84d5682270">&#9670;&nbsp;</a></span>z_t_rk</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::MultiFab&gt; &gt; ERF::z_t_rk</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ada098767690d194f89717b0deb3adeac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada098767690d194f89717b0deb3adeac">&#9670;&nbsp;</a></span>zflux_imask</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;std::unique_ptr&lt;amrex::iMultiFab&gt; &gt; ERF::zflux_imask</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ace4f0c79f84075dd7a43bd2b0ede1a9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace4f0c79f84075dd7a43bd2b0ede1a9b">&#9670;&nbsp;</a></span>zlevels_stag</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Vector&lt;amrex::Real&gt; &gt; ERF::zlevels_stag</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aaf7e8e28172eebdfe2224e4ee823310d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf7e8e28172eebdfe2224e4ee823310d">&#9670;&nbsp;</a></span>zmom_crse_rhs</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::MultiFab&gt; ERF::zmom_crse_rhs</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ae08c25dcf643c6ef39f27d7dd0cb7423"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae08c25dcf643c6ef39f27d7dd0cb7423">&#9670;&nbsp;</a></span>zvel_bc_data</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::Vector&lt;amrex::Gpu::DeviceVector&lt;amrex::Real&gt; &gt; ERF::zvel_bc_data</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>Source/<a class="el" href="ERF_8H_source.html">ERF.H</a></li>
<li>Source/BoundaryConditions/<a class="el" href="ERF__BoundaryConditionsBndryReg_8cpp.html">ERF_BoundaryConditionsBndryReg.cpp</a></li>
<li>Source/BoundaryConditions/<a class="el" href="ERF__FillBdyCCVels_8cpp.html">ERF_FillBdyCCVels.cpp</a></li>
<li>Source/BoundaryConditions/<a class="el" href="ERF__FillCoarsePatch_8cpp.html">ERF_FillCoarsePatch.cpp</a></li>
<li>Source/BoundaryConditions/<a class="el" href="ERF__FillIntermediatePatch_8cpp.html">ERF_FillIntermediatePatch.cpp</a></li>
<li>Source/EB/<a class="el" href="ERF__EBWriteSurface_8cpp.html">ERF_EBWriteSurface.cpp</a></li>
<li>Source/<a class="el" href="ERF_8cpp.html">ERF.cpp</a></li>
<li>Source/<a class="el" href="ERF__MakeNewArrays_8cpp.html">ERF_MakeNewArrays.cpp</a></li>
<li>Source/<a class="el" href="ERF__MakeNewLevel_8cpp.html">ERF_MakeNewLevel.cpp</a></li>
<li>Source/<a class="el" href="ERF__Tagging_8cpp.html">ERF_Tagging.cpp</a></li>
<li>Source/Initialization/<a class="el" href="ERF__Init1D_8cpp.html">ERF_Init1D.cpp</a></li>
<li>Source/Initialization/<a class="el" href="ERF__InitBCs_8cpp.html">ERF_InitBCs.cpp</a></li>
<li>Source/Initialization/<a class="el" href="ERF__InitCustom_8cpp.html">ERF_InitCustom.cpp</a></li>
<li>Source/Initialization/<a class="el" href="ERF__InitFromHSE_8cpp.html">ERF_InitFromHSE.cpp</a></li>
<li>Source/Initialization/<a class="el" href="ERF__InitFromInputSounding_8cpp.html">ERF_InitFromInputSounding.cpp</a></li>
<li>Source/Initialization/<a class="el" href="ERF__InitGeowind_8cpp.html">ERF_InitGeowind.cpp</a></li>
<li>Source/Initialization/<a class="el" href="ERF__InitRayleigh_8cpp.html">ERF_InitRayleigh.cpp</a></li>
<li>Source/Initialization/<a class="el" href="ERF__InitSponge_8cpp.html">ERF_InitSponge.cpp</a></li>
<li>Source/Initialization/<a class="el" href="ERF__InitTurbPert_8cpp.html">ERF_InitTurbPert.cpp</a></li>
<li>Source/Initialization/<a class="el" href="ERF__InitUniform_8cpp.html">ERF_InitUniform.cpp</a></li>
<li>Source/IO/<a class="el" href="ERF__Checkpoint_8cpp.html">ERF_Checkpoint.cpp</a></li>
<li>Source/IO/<a class="el" href="ERF__ConsoleIO_8cpp.html">ERF_ConsoleIO.cpp</a></li>
<li>Source/IO/<a class="el" href="ERF__Plotfile_8cpp.html">ERF_Plotfile.cpp</a></li>
<li>Source/IO/<a class="el" href="ERF__Write1DProfiles_8cpp.html">ERF_Write1DProfiles.cpp</a></li>
<li>Source/IO/<a class="el" href="ERF__Write1DProfiles__stag_8cpp.html">ERF_Write1DProfiles_stag.cpp</a></li>
<li>Source/IO/<a class="el" href="ERF__WriteJobInfo_8cpp.html">ERF_WriteJobInfo.cpp</a></li>
<li>Source/IO/<a class="el" href="ERF__WriteScalarProfiles_8cpp.html">ERF_WriteScalarProfiles.cpp</a></li>
<li>Source/IO/<a class="el" href="ERF__WriteSubvolume_8cpp.html">ERF_WriteSubvolume.cpp</a></li>
<li>Source/LinearSolvers/<a class="el" href="ERF__ComputeDivergence_8cpp.html">ERF_ComputeDivergence.cpp</a></li>
<li>Source/LinearSolvers/<a class="el" href="ERF__ImposeBCsOnPhi_8cpp.html">ERF_ImposeBCsOnPhi.cpp</a></li>
<li>Source/LinearSolvers/<a class="el" href="ERF__PoissonSolve_8cpp.html">ERF_PoissonSolve.cpp</a></li>
<li>Source/LinearSolvers/<a class="el" href="ERF__PoissonSolve__tb_8cpp.html">ERF_PoissonSolve_tb.cpp</a></li>
<li>Source/LinearSolvers/<a class="el" href="ERF__PoissonWallDist_8cpp.html">ERF_PoissonWallDist.cpp</a></li>
<li>Source/LinearSolvers/<a class="el" href="ERF__SolveWithEBMLMG_8cpp.html">ERF_SolveWithEBMLMG.cpp</a></li>
<li>Source/LinearSolvers/<a class="el" href="ERF__SolveWithGMRES_8cpp.html">ERF_SolveWithGMRES.cpp</a></li>
<li>Source/LinearSolvers/<a class="el" href="ERF__SolveWithMLMG_8cpp.html">ERF_SolveWithMLMG.cpp</a></li>
<li>Source/TimeIntegration/<a class="el" href="ERF__Advance_8cpp.html">ERF_Advance.cpp</a></li>
<li>Source/TimeIntegration/<a class="el" href="ERF__AdvanceDycore_8cpp.html">ERF_AdvanceDycore.cpp</a></li>
<li>Source/TimeIntegration/<a class="el" href="ERF__AdvanceLSM_8cpp.html">ERF_AdvanceLSM.cpp</a></li>
<li>Source/TimeIntegration/<a class="el" href="ERF__AdvanceMicrophysics_8cpp.html">ERF_AdvanceMicrophysics.cpp</a></li>
<li>Source/TimeIntegration/<a class="el" href="ERF__AdvanceRadiation_8cpp.html">ERF_AdvanceRadiation.cpp</a></li>
<li>Source/TimeIntegration/<a class="el" href="ERF__ComputeTimestep_8cpp.html">ERF_ComputeTimestep.cpp</a></li>
<li>Source/TimeIntegration/<a class="el" href="ERF__TimeStep_8cpp.html">ERF_TimeStep.cpp</a></li>
<li>Source/Utils/<a class="el" href="ERF__AverageDown_8cpp.html">ERF_AverageDown.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classERF.html">ERF</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
